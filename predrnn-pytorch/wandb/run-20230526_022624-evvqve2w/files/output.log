load model: /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_6000.ckpt
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr_shift3.npz
train_data_files nums: 84
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset_6hrs/era5_train_2022_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44995251297950745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032834991812705994, decouple_loss:0.0028916392475366592
The modified gen p mean: 0.4491688311100006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034248899668455124, decouple_loss:0.0028698714450001717
The modified gen p mean: 0.4471724033355713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0302506722509861, decouple_loss:0.003423805581405759
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45436811447143555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03106137178838253, decouple_loss:0.00223556743003428
The modified gen p mean: 0.45557546615600586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03079359419643879, decouple_loss:0.002487543039023876
The modified gen p mean: 0.4546988606452942, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03320015221834183, decouple_loss:0.002581582171842456
Iteration: 3, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487745463848114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031683243811130524, decouple_loss:0.0023988077882677317
The modified gen p mean: 0.4544115662574768, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02955247275531292, decouple_loss:0.002236119471490383
The modified gen p mean: 0.4493683874607086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03207702934741974, decouple_loss:0.002185576129704714
Iteration: 4, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447275400161743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0308940839022398, decouple_loss:0.002046158304437995
The modified gen p mean: 0.4480576515197754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030555173754692078, decouple_loss:0.002361530438065529
The modified gen p mean: 0.44703298807144165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03245048597455025, decouple_loss:0.0020895476918667555
Iteration: 5, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449978470802307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029825711622834206, decouple_loss:0.0026577666867524385
The modified gen p mean: 0.44087162613868713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030703675001859665, decouple_loss:0.0022299739066511393
The modified gen p mean: 0.44521328806877136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031107045710086823, decouple_loss:0.0022612952161580324
Iteration: 6, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.440906822681427, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44408780336380005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029514847323298454, decouple_loss:0.0030173962004482746
loss_pred:0.030514439567923546, decouple_loss:0.0025983673986047506
The modified gen p mean: 0.43928036093711853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03083081543445587, decouple_loss:0.0021098796278238297
Iteration: 7, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44015297293663025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029537606984376907, decouple_loss:0.002262233290821314
The modified gen p mean: 0.44059130549430847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030516767874360085, decouple_loss:0.002168502891436219
The modified gen p mean: 0.4395998418331146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03012957237660885, decouple_loss:0.0023296335712075233
Iteration: 8, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439097046852112, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030014436691999435, decouple_loss:0.0025846995413303375
The modified gen p mean: 0.4434666037559509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02894783206284046, decouple_loss:0.00352270994335413
The modified gen p mean: 0.44282448291778564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030973877757787704, decouple_loss:0.0031639845110476017
Iteration: 9, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465867280960083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029924487695097923, decouple_loss:0.002233896404504776
The modified gen p mean: 0.4464784264564514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029570529237389565, decouple_loss:0.002138809533789754
The modified gen p mean: 0.4451275169849396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030369289219379425, decouple_loss:0.0023244298063218594
Iteration: 10, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44451719522476196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031418051570653915, decouple_loss:0.0023178544361144304
The modified gen p mean: 0.44603583216667175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02979799173772335, decouple_loss:0.00229061022400856
The modified gen p mean: 0.44431066513061523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03063584677875042, decouple_loss:0.002127708401530981
2023-05-26 02:31:41 testing...
The modified gen p mean: 0.45360252261161804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033343661576509476, decouple_loss:0.0024327330756932497
The modified gen p mean: 0.4517415463924408, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03373139724135399, decouple_loss:0.002238588174805045
The modified gen p mean: 0.453119158744812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03513549640774727, decouple_loss:0.0023787140380591154
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0341876856982708, avg_mse: 0.046351879835128784
current test mse: 0.046352
At step 10, Best test: 0.046352
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_WV_1_PC_0_EH_0_PS_40_6hrs.ckpt
Iteration: 11, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45145875215530396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029931258410215378, decouple_loss:0.0024452044162899256
The modified gen p mean: 0.4507896900177002, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44848424196243286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02967846393585205, decouple_loss:0.002497764304280281
loss_pred:0.027955632656812668, decouple_loss:0.002286243950948119
Iteration: 12, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44726672768592834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031239701434969902, decouple_loss:0.0019817331340163946
The modified gen p mean: 0.44737765192985535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03062978759407997, decouple_loss:0.002047940157353878
The modified gen p mean: 0.44823241233825684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030443299561738968, decouple_loss:0.00204436294734478
Iteration: 13, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.453753799200058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029848894104361534, decouple_loss:0.002260521287098527
The modified gen p mean: 0.45214980840682983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029548564925789833, decouple_loss:0.0024657936301082373
The modified gen p mean: 0.4478445053100586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029811611399054527, decouple_loss:0.0026370645500719547
Iteration: 14, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486084580421448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02870606631040573, decouple_loss:0.0025543917436152697
The modified gen p mean: 0.448815256357193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030949145555496216, decouple_loss:0.0025314108934253454
The modified gen p mean: 0.4477670192718506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029873142018914223, decouple_loss:0.0026646056212484837
Iteration: 15, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44840380549430847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030459251254796982, decouple_loss:0.002455064794048667
The modified gen p mean: 0.4460720419883728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031172361224889755, decouple_loss:0.002818732289597392
The modified gen p mean: 0.4486532211303711, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029459549114108086, decouple_loss:0.002238625194877386
Iteration: 16, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472813010215759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02937188185751438, decouple_loss:0.002569719683378935
The modified gen p mean: 0.4481082558631897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02934594638645649, decouple_loss:0.0023142199497669935
The modified gen p mean: 0.4432835876941681, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031243236735463142, decouple_loss:0.0019120513461530209
Iteration: 17, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44677460193634033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030633078888058662, decouple_loss:0.001944127376191318
The modified gen p mean: 0.44225436449050903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030977847054600716, decouple_loss:0.0022499794140458107
The modified gen p mean: 0.44719401001930237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02833425998687744, decouple_loss:0.0021881095599383116
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr_shift3.npz
NaN value num: 0
Iteration: 18, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441501796245575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02965901792049408, decouple_loss:0.0028074958827346563
The modified gen p mean: 0.4446239471435547, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44576001167297363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0317966490983963, decouple_loss:0.002094147726893425
loss_pred:0.029606318101286888, decouple_loss:0.0020659056026488543
Iteration: 19, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439973831176758, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03199825808405876, decouple_loss:0.0023913367185741663
The modified gen p mean: 0.44491103291511536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028298644348978996, decouple_loss:0.00235922122374177
The modified gen p mean: 0.4476410448551178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029733486473560333, decouple_loss:0.002338044112548232
Iteration: 20, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478769600391388, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030109615996479988, decouple_loss:0.0022639986127614975
The modified gen p mean: 0.4478782117366791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03100656159222126, decouple_loss:0.002307104179635644
The modified gen p mean: 0.4480525255203247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029429078102111816, decouple_loss:0.0020750053226947784
2023-05-26 02:36:38 testing...
The modified gen p mean: 0.451700359582901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03520435094833374, decouple_loss:0.002566371811553836
The modified gen p mean: 0.45119035243988037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03696713596582413, decouple_loss:0.0024974506814032793
The modified gen p mean: 0.4498611092567444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035074904561042786, decouple_loss:0.0022292521316558123
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.035870350897312164, avg_mse: 0.04908587038516998
current test mse: 0.049086
Iteration: 21, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441213309764862, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031734924763441086, decouple_loss:0.002337006153538823
The modified gen p mean: 0.4457259178161621, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030004972591996193, decouple_loss:0.003454357385635376
The modified gen p mean: 0.44647446274757385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02885216847062111, decouple_loss:0.0021206876263022423
Iteration: 22, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44987577199935913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029639264568686485, decouple_loss:0.002097503049299121
The modified gen p mean: 0.44690486788749695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03011588752269745, decouple_loss:0.002088414505124092
The modified gen p mean: 0.44586148858070374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029254166409373283, decouple_loss:0.0024151718243956566
Iteration: 23, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44610169529914856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03151316940784454, decouple_loss:0.0024211008567363024
The modified gen p mean: 0.4485701620578766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02809266373515129, decouple_loss:0.002438961761072278
The modified gen p mean: 0.45057061314582825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029055947437882423, decouple_loss:0.002257738960906863
Iteration: 24, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45097747445106506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03069179132580757, decouple_loss:0.002133272122591734
The modified gen p mean: 0.45101773738861084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02808648720383644, decouple_loss:0.0026580379344522953
The modified gen p mean: 0.4527273178100586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029221629723906517, decouple_loss:0.0022284432779997587
Iteration: 25, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477478861808777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029719749465584755, decouple_loss:0.0021083129104226828
The modified gen p mean: 0.44835156202316284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03217659145593643, decouple_loss:0.0022274204529821873
The modified gen p mean: 0.4501711130142212, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031522661447525024, decouple_loss:0.002183191478252411
Iteration: 26, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481618106365204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030645500868558884, decouple_loss:0.002370639471337199
The modified gen p mean: 0.4473223090171814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029685314744710922, decouple_loss:0.00228656898252666
The modified gen p mean: 0.4517422318458557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02961540035903454, decouple_loss:0.0020749031100422144
Iteration: 27, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44785359501838684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02970038913190365, decouple_loss:0.0021094854455441236
The modified gen p mean: 0.44697698950767517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029458822682499886, decouple_loss:0.0019646910950541496
The modified gen p mean: 0.44598859548568726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03190850839018822, decouple_loss:0.0020492104813456535
Iteration: 28, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464627504348755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02860051393508911, decouple_loss:0.0022003287449479103
The modified gen p mean: 0.4460467994213104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030793655663728714, decouple_loss:0.0019590335432440042
The modified gen p mean: 0.44574305415153503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02948784828186035, decouple_loss:0.001995484810322523
Iteration: 29, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489143490791321, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029285158962011337, decouple_loss:0.002225275384262204
The modified gen p mean: 0.44604891538619995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028794145211577415, decouple_loss:0.0018984200432896614
The modified gen p mean: 0.4451563358306885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028345778584480286, decouple_loss:0.002227088902145624
Iteration: 30, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482068717479706, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4498077630996704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028212543576955795, decouple_loss:0.003612861502915621
loss_pred:0.02789737656712532, decouple_loss:0.003188916714861989
The modified gen p mean: 0.44776442646980286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028069451451301575, decouple_loss:0.0021905037574470043
2023-05-26 02:40:43 testing...
The modified gen p mean: 0.4526829123497009, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03517172485589981, decouple_loss:0.0023813166189938784
The modified gen p mean: 0.4508550465106964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03484509512782097, decouple_loss:0.002292121294885874
The modified gen p mean: 0.45214909315109253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03688979148864746, decouple_loss:0.0024012657813727856
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03575345128774643, avg_mse: 0.04891505837440491
current test mse: 0.048915
Iteration: 31, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44543081521987915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03094353899359703, decouple_loss:0.0021590888500213623
The modified gen p mean: 0.44834819436073303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028566423803567886, decouple_loss:0.002296572783961892
The modified gen p mean: 0.44652891159057617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03092196397483349, decouple_loss:0.0019319582497701049
Iteration: 32, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480743408203125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0288691408932209, decouple_loss:0.0020929179154336452
The modified gen p mean: 0.4462837874889374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029668228700757027, decouple_loss:0.0021088463254272938
The modified gen p mean: 0.4515521824359894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027778353542089462, decouple_loss:0.002310924930498004
Iteration: 33, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481963813304901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030732521787285805, decouple_loss:0.002173236571252346
The modified gen p mean: 0.44506844878196716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029674535617232323, decouple_loss:0.002404177561402321
The modified gen p mean: 0.44809868931770325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820430137217045, decouple_loss:0.0024371205363422632
Iteration: 34, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45035451650619507, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02995884232223034, decouple_loss:0.0022078321781009436
The modified gen p mean: 0.4494469463825226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02863183431327343, decouple_loss:0.002660341328009963
The modified gen p mean: 0.451591432094574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02921956591308117, decouple_loss:0.0019241629634052515
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr_shift3.npz
NaN value num: 0
Iteration: 35, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459114670753479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02978738583624363, decouple_loss:0.0024347244761884212
The modified gen p mean: 0.4490768015384674, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466990530490875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03034132532775402, decouple_loss:0.0022235314827412367
loss_pred:0.029151609167456627, decouple_loss:0.0019438661402091384
Iteration: 36, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449150025844574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027901194989681244, decouple_loss:0.0020991982892155647
The modified gen p mean: 0.44339293241500854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03006935492157936, decouple_loss:0.002124165650457144
The modified gen p mean: 0.44943293929100037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029109425842761993, decouple_loss:0.00233842758461833
Iteration: 37, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453827142715454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030215030536055565, decouple_loss:0.002279209438711405
The modified gen p mean: 0.44420376420021057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02938506007194519, decouple_loss:0.002648870460689068
The modified gen p mean: 0.45290327072143555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028059283271431923, decouple_loss:0.00309224845841527
Iteration: 38, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459487199783325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027099888771772385, decouple_loss:0.002340367529541254
The modified gen p mean: 0.4515541195869446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027214927598834038, decouple_loss:0.0022049087565392256
The modified gen p mean: 0.44530820846557617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02876516990363598, decouple_loss:0.0019159411313012242
Iteration: 39, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445415735244751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029058022424578667, decouple_loss:0.002199741080403328
The modified gen p mean: 0.4484977126121521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027857638895511627, decouple_loss:0.0023493608459830284
The modified gen p mean: 0.4522531032562256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02741687186062336, decouple_loss:0.002137749455869198
Iteration: 40, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452003836631775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029236409813165665, decouple_loss:0.002235780004411936
The modified gen p mean: 0.4444619417190552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0299695897847414, decouple_loss:0.002281690714880824
The modified gen p mean: 0.44737401604652405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027994142845273018, decouple_loss:0.0023064978886395693
2023-05-26 02:45:28 testing...
The modified gen p mean: 0.4535262882709503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03392153978347778, decouple_loss:0.002312998753041029
The modified gen p mean: 0.45323634147644043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03610504791140556, decouple_loss:0.0022924267686903477
The modified gen p mean: 0.45154163241386414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034053076058626175, decouple_loss:0.002087776083499193
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.034804776310920715, avg_mse: 0.0474858283996582
current test mse: 0.047486
Iteration: 41, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45201289653778076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0288442000746727, decouple_loss:0.002357727847993374
The modified gen p mean: 0.44573307037353516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029814867302775383, decouple_loss:0.002123755868524313
The modified gen p mean: 0.4457745850086212, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029252000153064728, decouple_loss:0.0019211573526263237
Iteration: 42, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514717161655426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02876342460513115, decouple_loss:0.0021999089512974024
The modified gen p mean: 0.44485849142074585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029052941128611565, decouple_loss:0.002086237771436572
The modified gen p mean: 0.44897326827049255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027226688340306282, decouple_loss:0.0022851452231407166
Iteration: 43, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444907605648041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030044689774513245, decouple_loss:0.0018328671576455235
The modified gen p mean: 0.44610288739204407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029117407277226448, decouple_loss:0.002125755650922656
The modified gen p mean: 0.4536035358905792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028293633833527565, decouple_loss:0.0020134239457547665
Iteration: 44, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44708704948425293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027005787938833237, decouple_loss:0.0021558161824941635
The modified gen p mean: 0.4441496729850769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02925943024456501, decouple_loss:0.0023805417586117983
The modified gen p mean: 0.44644254446029663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0296810120344162, decouple_loss:0.0021128205116838217
Iteration: 45, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462279677391052, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028985513374209404, decouple_loss:0.002273554913699627
The modified gen p mean: 0.4495992660522461, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027969978749752045, decouple_loss:0.0018378552049398422
The modified gen p mean: 0.45135563611984253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029399365186691284, decouple_loss:0.0017945868894457817
Iteration: 46, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44910120964050293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028490904718637466, decouple_loss:0.0021515688858926296
The modified gen p mean: 0.452108234167099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732001803815365, decouple_loss:0.0023334771394729614
The modified gen p mean: 0.44542989134788513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02961146831512451, decouple_loss:0.0020474062766879797
Iteration: 47, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469921886920929, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03059091605246067, decouple_loss:0.002388089196756482
The modified gen p mean: 0.4454125761985779, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029223721474409103, decouple_loss:0.0017182433512061834
The modified gen p mean: 0.45350518822669983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722807787358761, decouple_loss:0.0028626115527004004
Iteration: 48, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44812503457069397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02843649312853813, decouple_loss:0.001819041557610035
The modified gen p mean: 0.44503945112228394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029193732887506485, decouple_loss:0.0017313336720690131
The modified gen p mean: 0.4463537037372589, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030090348795056343, decouple_loss:0.002239564899355173
Iteration: 49, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490770399570465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029366521164774895, decouple_loss:0.0020575763192027807
The modified gen p mean: 0.445223867893219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028640681877732277, decouple_loss:0.0025185388512909412
The modified gen p mean: 0.4451146721839905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02900237962603569, decouple_loss:0.0022110294084995985
Iteration: 50, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44529926776885986, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4418730139732361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030264977365732193, decouple_loss:0.0020240889862179756
loss_pred:0.02869906835258007, decouple_loss:0.001685291645117104
The modified gen p mean: 0.44965434074401855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028251050040125847, decouple_loss:0.0024964530020952225
2023-05-26 02:49:35 testing...
The modified gen p mean: 0.4517328143119812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034644965082407, decouple_loss:0.0025223710108548403
The modified gen p mean: 0.4496641457080841, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034378036856651306, decouple_loss:0.0021549146622419357
The modified gen p mean: 0.45097821950912476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03642340749502182, decouple_loss:0.002422937424853444
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.035267140716314316, avg_mse: 0.04824639484286308
current test mse: 0.048246
Iteration: 51, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44621405005455017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0275716669857502, decouple_loss:0.001799182966351509
The modified gen p mean: 0.4499676525592804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026941265910863876, decouple_loss:0.0023017735220491886
The modified gen p mean: 0.4499684274196625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026929225772619247, decouple_loss:0.002285170368850231
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr_shift3.npz
NaN value num: 0
Iteration: 52, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434446394443512, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030474642291665077, decouple_loss:0.0020996977109462023
The modified gen p mean: 0.4475939869880676, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4440397620201111, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02984573319554329, decouple_loss:0.0019166049314662814
loss_pred:0.030389461666345596, decouple_loss:0.0021436961833387613
Iteration: 53, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478588402271271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030493319034576416, decouple_loss:0.002019257051870227
The modified gen p mean: 0.44881221652030945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028930647298693657, decouple_loss:0.002610126044601202
The modified gen p mean: 0.45005786418914795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028946788981556892, decouple_loss:0.0024320988450199366
Iteration: 54, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44667622447013855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02947295270860195, decouple_loss:0.0020262477919459343
The modified gen p mean: 0.44770684838294983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029915673658251762, decouple_loss:0.0019313325174152851
The modified gen p mean: 0.4496578872203827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028720615431666374, decouple_loss:0.00219351751729846
Iteration: 55, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44608739018440247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028852907940745354, decouple_loss:0.0022029855754226446
The modified gen p mean: 0.4483276307582855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029452567920088768, decouple_loss:0.001803373685106635
The modified gen p mean: 0.44546443223953247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028911055997014046, decouple_loss:0.0017542768036946654
Iteration: 56, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44507482647895813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028145840391516685, decouple_loss:0.001898256246931851
The modified gen p mean: 0.45277538895606995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029949145391583443, decouple_loss:0.002064262516796589
The modified gen p mean: 0.44905585050582886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028866425156593323, decouple_loss:0.0022527403198182583
Iteration: 57, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45299986004829407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02844119817018509, decouple_loss:0.0021843903232365847
The modified gen p mean: 0.4488365948200226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0294228233397007, decouple_loss:0.0025863570626825094
The modified gen p mean: 0.4527796804904938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029157530516386032, decouple_loss:0.0022006977815181017
Iteration: 58, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44959384202957153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028178609907627106, decouple_loss:0.0024260093923658133
The modified gen p mean: 0.4535234570503235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029110709205269814, decouple_loss:0.0021776235662400723
The modified gen p mean: 0.4470347762107849, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029955189675092697, decouple_loss:0.0021864380687475204
Iteration: 59, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44995856285095215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02972886711359024, decouple_loss:0.002160098170861602
The modified gen p mean: 0.44610628485679626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030366556718945503, decouple_loss:0.002083033323287964
The modified gen p mean: 0.4485893249511719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029007669538259506, decouple_loss:0.002307659247890115
Iteration: 60, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494709372520447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028453830629587173, decouple_loss:0.002483668038621545
The modified gen p mean: 0.44668295979499817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029635624960064888, decouple_loss:0.002065075095742941
The modified gen p mean: 0.44848576188087463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02955244667828083, decouple_loss:0.0019231645856052637
2023-05-26 02:54:20 testing...
The modified gen p mean: 0.45310279726982117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03338731452822685, decouple_loss:0.00227745296433568
The modified gen p mean: 0.45103394985198975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03362182155251503, decouple_loss:0.0020635095424950123
The modified gen p mean: 0.45291686058044434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03534594550728798, decouple_loss:0.00218033860437572
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.034227050840854645, avg_mse: 0.04662945494055748
current test mse: 0.046629
Iteration: 61, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44750097393989563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02956962026655674, decouple_loss:0.0022532776929438114
The modified gen p mean: 0.44526082277297974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029449455440044403, decouple_loss:0.001931583508849144
The modified gen p mean: 0.44994646310806274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030216950923204422, decouple_loss:0.0018797476077452302
Iteration: 62, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4546753168106079, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44534415006637573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029601717367768288, decouple_loss:0.0018352156039327383
loss_pred:0.028536008670926094, decouple_loss:0.0021078477147966623
The modified gen p mean: 0.45047780871391296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029272710904479027, decouple_loss:0.0018047166522592306
Iteration: 63, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446805864572525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029560888186097145, decouple_loss:0.0020700718741863966
The modified gen p mean: 0.4499601423740387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029514392837882042, decouple_loss:0.0018502981401979923
The modified gen p mean: 0.4443496763706207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030030982568860054, decouple_loss:0.0020762113854289055
Iteration: 64, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44574373960494995, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4487905204296112, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02952919341623783, decouple_loss:0.002040101680904627
loss_pred:0.029540184885263443, decouple_loss:0.001985835377126932
The modified gen p mean: 0.4456758499145508, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029164062812924385, decouple_loss:0.0017986606108024716
Iteration: 65, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44572144746780396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02993391826748848, decouple_loss:0.002057902282103896
The modified gen p mean: 0.44852423667907715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028127415105700493, decouple_loss:0.001848844694904983
The modified gen p mean: 0.44482746720314026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03014182113111019, decouple_loss:0.0019376692362129688
Iteration: 66, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44504624605178833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030500831082463264, decouple_loss:0.001864557503722608
The modified gen p mean: 0.44381681084632874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028435304760932922, decouple_loss:0.0018389506731182337
The modified gen p mean: 0.4451392889022827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028819585219025612, decouple_loss:0.0017434326000511646
Iteration: 67, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45037466287612915, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44395774602890015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028430471196770668, decouple_loss:0.001914145308546722
loss_pred:0.02829556353390217, decouple_loss:0.0020007400307804346
The modified gen p mean: 0.44875454902648926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02839573845267296, decouple_loss:0.0020819196943193674
Iteration: 68, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44811081886291504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0279279425740242, decouple_loss:0.002217104658484459
The modified gen p mean: 0.44472309947013855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02890966646373272, decouple_loss:0.0017360351048409939
The modified gen p mean: 0.4476434290409088, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030271971598267555, decouple_loss:0.001993677346035838
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr_shift3.npz
NaN value num: 0
Iteration: 69, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44578373432159424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.036479055881500244, decouple_loss:0.0020567202009260654
The modified gen p mean: 0.4457920789718628, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035351332277059555, decouple_loss:0.0020646320190280676
The modified gen p mean: 0.45073339343070984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03552110865712166, decouple_loss:0.002038081642240286
Iteration: 70, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45056819915771484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035855524241924286, decouple_loss:0.002052770461887121
The modified gen p mean: 0.4483221769332886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0347510427236557, decouple_loss:0.0018027023179456592
The modified gen p mean: 0.4505721628665924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03608652949333191, decouple_loss:0.002213391475379467
2023-05-26 02:59:09 testing...
The modified gen p mean: 0.45429980754852295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033093638718128204, decouple_loss:0.0020533925853669643
The modified gen p mean: 0.4524068534374237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033213481307029724, decouple_loss:0.0019712101202458143
The modified gen p mean: 0.4541007876396179, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03469546511769295, decouple_loss:0.0020385358948260546
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033768583089113235, avg_mse: 0.04574326053261757
current test mse: 0.045743
At step 70, Best test: 0.045743
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_WV_1_PC_0_EH_0_PS_40_6hrs.ckpt
Iteration: 71, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4517155587673187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0348602719604969, decouple_loss:0.0017186544137075543
The modified gen p mean: 0.4496564269065857, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4524784982204437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03421923518180847, decouple_loss:0.0018271129811182618
loss_pred:0.03399096801877022, decouple_loss:0.0017033577896654606
Iteration: 72, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45358073711395264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03373560309410095, decouple_loss:0.0019327455665916204
The modified gen p mean: 0.4504166841506958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0342177078127861, decouple_loss:0.0017195332329720259
The modified gen p mean: 0.4548206925392151, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03440838307142258, decouple_loss:0.001847322448156774
Iteration: 73, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4547595679759979, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4523248076438904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03382488712668419, decouple_loss:0.0019069220870733261
loss_pred:0.033277351409196854, decouple_loss:0.001986524323001504
The modified gen p mean: 0.45154720544815063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035497017204761505, decouple_loss:0.001867347047664225
Iteration: 74, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4537983238697052, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033282700926065445, decouple_loss:0.0018179104663431644
The modified gen p mean: 0.45325133204460144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03476334735751152, decouple_loss:0.0020613507367670536
The modified gen p mean: 0.4542967677116394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03373133763670921, decouple_loss:0.0020545937586575747
Iteration: 75, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45431795716285706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03349394351243973, decouple_loss:0.0016307806363329291
The modified gen p mean: 0.45913153886795044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0344543494284153, decouple_loss:0.001968796132132411
The modified gen p mean: 0.45565250515937805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03293771669268608, decouple_loss:0.0018710545264184475
Iteration: 76, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4598676562309265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034342799335718155, decouple_loss:0.0019754767417907715
The modified gen p mean: 0.45516395568847656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03452630713582039, decouple_loss:0.0016988437855616212
The modified gen p mean: 0.4579654037952423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03384106233716011, decouple_loss:0.0018033582018688321
Iteration: 77, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45495739579200745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034337881952524185, decouple_loss:0.0017227093921974301
The modified gen p mean: 0.45761027932167053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032723382115364075, decouple_loss:0.0020357193425297737
The modified gen p mean: 0.4556728005409241, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03276766091585159, decouple_loss:0.0018497523851692677
Iteration: 78, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516601264476776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03440122306346893, decouple_loss:0.0019473021384328604
The modified gen p mean: 0.4499586820602417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032347097992897034, decouple_loss:0.0016057384200394154
The modified gen p mean: 0.45118847489356995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03525004908442497, decouple_loss:0.0017408047569915652
Iteration: 79, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470663368701935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03197851404547691, decouple_loss:0.001578866271302104
The modified gen p mean: 0.45102766156196594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034629594534635544, decouple_loss:0.0016167862340807915
The modified gen p mean: 0.4512840807437897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03328101709485054, decouple_loss:0.0016879725735634565
Iteration: 80, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44883233308792114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03446292132139206, decouple_loss:0.001740779378451407
The modified gen p mean: 0.4463782012462616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035008497536182404, decouple_loss:0.001690616481937468
The modified gen p mean: 0.4483624994754791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03411103039979935, decouple_loss:0.001946807373315096
2023-05-26 03:03:20 testing...
The modified gen p mean: 0.44946396350860596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259039670228958, decouple_loss:0.001833400223404169
The modified gen p mean: 0.4492921829223633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03394855931401253, decouple_loss:0.0018252665176987648
The modified gen p mean: 0.44796010851860046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032737717032432556, decouple_loss:0.0018340755486860871
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03318376839160919, avg_mse: 0.04471953585743904
current test mse: 0.04472
At step 80, Best test: 0.04472
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_WV_1_PC_0_EH_0_PS_40_6hrs.ckpt
Iteration: 81, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45015355944633484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034402165561914444, decouple_loss:0.001904816715978086
The modified gen p mean: 0.4439471662044525, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4460659921169281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033844172954559326, decouple_loss:0.00167506979778409loss_pred:0.03299834206700325, decouple_loss:0.0017982120625674725
Iteration: 82, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468497633934021, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033895693719387054, decouple_loss:0.0017707853112369776
The modified gen p mean: 0.4429863691329956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03452148661017418, decouple_loss:0.0015354770002886653
The modified gen p mean: 0.44703415036201477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03349953517317772, decouple_loss:0.00190233055036515
Iteration: 83, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4440547823905945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03410563990473747, decouple_loss:0.0016166088171303272
The modified gen p mean: 0.44426149129867554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03480272740125656, decouple_loss:0.0017321708146482706
The modified gen p mean: 0.4475836157798767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03274344652891159, decouple_loss:0.0019487591926008463
Iteration: 84, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44469860196113586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03273224085569382, decouple_loss:0.001805576030164957
The modified gen p mean: 0.4434741139411926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034373313188552856, decouple_loss:0.0017117966199293733
The modified gen p mean: 0.449320912361145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03519843518733978, decouple_loss:0.0017459839582443237
Iteration: 85, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491207003593445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03407564386725426, decouple_loss:0.001712005352601409
The modified gen p mean: 0.4451134502887726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03437824547290802, decouple_loss:0.0016200271202251315
The modified gen p mean: 0.44771939516067505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03197023272514343, decouple_loss:0.0017675281269475818
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr.npz
NaN value num: 0
Iteration: 86, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481949806213379, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033709101378917694, decouple_loss:0.0017969360342249274
The modified gen p mean: 0.45078378915786743, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44984328746795654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03418364375829697, decouple_loss:0.0018475297838449478
loss_pred:0.03451967611908913, decouple_loss:0.0018276642076671124
Iteration: 87, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44805899262428284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03284316509962082, decouple_loss:0.00216506770811975
The modified gen p mean: 0.45304685831069946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03378652036190033, decouple_loss:0.00168594007845968
The modified gen p mean: 0.44711050391197205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03175345063209534, decouple_loss:0.0016965422546491027
Iteration: 88, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44996175169944763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03304015472531319, decouple_loss:0.0016649245517328382
The modified gen p mean: 0.450987845659256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03350235894322395, decouple_loss:0.0016569186700507998
The modified gen p mean: 0.4495886564254761, gen p mean: 0.0, mean p set: 0.448
