load model: /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_6000.ckpt
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr_shift3.npz
train_data_files nums: 84
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset_6hrs/era5_train_2022_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44995251297950745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032834991812705994, decouple_loss:0.0028916392475366592
The modified gen p mean: 0.4491688311100006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034248899668455124, decouple_loss:0.0028698714450001717
The modified gen p mean: 0.4471724033355713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0302506722509861, decouple_loss:0.003423805581405759
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45436811447143555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03106137178838253, decouple_loss:0.00223556743003428
The modified gen p mean: 0.45557546615600586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03079359419643879, decouple_loss:0.002487543039023876
The modified gen p mean: 0.4546988606452942, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03320015221834183, decouple_loss:0.002581582171842456
Iteration: 3, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487745463848114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031683243811130524, decouple_loss:0.0023988077882677317
The modified gen p mean: 0.4544115662574768, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02955247275531292, decouple_loss:0.002236119471490383
The modified gen p mean: 0.4493683874607086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03207702934741974, decouple_loss:0.002185576129704714
Iteration: 4, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447275400161743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0308940839022398, decouple_loss:0.002046158304437995
The modified gen p mean: 0.4480576515197754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030555173754692078, decouple_loss:0.002361530438065529
The modified gen p mean: 0.44703298807144165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03245048597455025, decouple_loss:0.0020895476918667555
Iteration: 5, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449978470802307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029825711622834206, decouple_loss:0.0026577666867524385
The modified gen p mean: 0.44087162613868713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030703675001859665, decouple_loss:0.0022299739066511393
The modified gen p mean: 0.44521328806877136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031107045710086823, decouple_loss:0.0022612952161580324
Iteration: 6, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.440906822681427, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44408780336380005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029514847323298454, decouple_loss:0.0030173962004482746
loss_pred:0.030514439567923546, decouple_loss:0.0025983673986047506
The modified gen p mean: 0.43928036093711853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03083081543445587, decouple_loss:0.0021098796278238297
Iteration: 7, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44015297293663025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029537606984376907, decouple_loss:0.002262233290821314
The modified gen p mean: 0.44059130549430847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030516767874360085, decouple_loss:0.002168502891436219
The modified gen p mean: 0.4395998418331146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03012957237660885, decouple_loss:0.0023296335712075233
Iteration: 8, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439097046852112, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030014436691999435, decouple_loss:0.0025846995413303375
The modified gen p mean: 0.4434666037559509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02894783206284046, decouple_loss:0.00352270994335413
The modified gen p mean: 0.44282448291778564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030973877757787704, decouple_loss:0.0031639845110476017
Iteration: 9, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465867280960083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029924487695097923, decouple_loss:0.002233896404504776
The modified gen p mean: 0.4464784264564514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029570529237389565, decouple_loss:0.002138809533789754
The modified gen p mean: 0.4451275169849396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030369289219379425, decouple_loss:0.0023244298063218594
Iteration: 10, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44451719522476196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031418051570653915, decouple_loss:0.0023178544361144304
The modified gen p mean: 0.44603583216667175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02979799173772335, decouple_loss:0.00229061022400856
The modified gen p mean: 0.44431066513061523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03063584677875042, decouple_loss:0.002127708401530981
2023-05-26 02:31:41 testing...
The modified gen p mean: 0.45360252261161804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033343661576509476, decouple_loss:0.0024327330756932497
The modified gen p mean: 0.4517415463924408, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03373139724135399, decouple_loss:0.002238588174805045
The modified gen p mean: 0.453119158744812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03513549640774727, decouple_loss:0.0023787140380591154
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0341876856982708, avg_mse: 0.046351879835128784
current test mse: 0.046352
At step 10, Best test: 0.046352
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_WV_1_PC_0_EH_0_PS_40_6hrs.ckpt
Iteration: 11, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45145875215530396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029931258410215378, decouple_loss:0.0024452044162899256
The modified gen p mean: 0.4507896900177002, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44848424196243286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02967846393585205, decouple_loss:0.002497764304280281
loss_pred:0.027955632656812668, decouple_loss:0.002286243950948119
Iteration: 12, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44726672768592834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031239701434969902, decouple_loss:0.0019817331340163946
The modified gen p mean: 0.44737765192985535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03062978759407997, decouple_loss:0.002047940157353878
The modified gen p mean: 0.44823241233825684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030443299561738968, decouple_loss:0.00204436294734478
Iteration: 13, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.453753799200058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029848894104361534, decouple_loss:0.002260521287098527
The modified gen p mean: 0.45214980840682983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029548564925789833, decouple_loss:0.0024657936301082373
The modified gen p mean: 0.4478445053100586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029811611399054527, decouple_loss:0.0026370645500719547
Iteration: 14, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486084580421448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02870606631040573, decouple_loss:0.0025543917436152697
The modified gen p mean: 0.448815256357193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030949145555496216, decouple_loss:0.0025314108934253454
The modified gen p mean: 0.4477670192718506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029873142018914223, decouple_loss:0.0026646056212484837
Iteration: 15, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44840380549430847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030459251254796982, decouple_loss:0.002455064794048667
The modified gen p mean: 0.4460720419883728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031172361224889755, decouple_loss:0.002818732289597392
The modified gen p mean: 0.4486532211303711, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029459549114108086, decouple_loss:0.002238625194877386
Iteration: 16, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472813010215759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02937188185751438, decouple_loss:0.002569719683378935
The modified gen p mean: 0.4481082558631897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02934594638645649, decouple_loss:0.0023142199497669935
The modified gen p mean: 0.4432835876941681, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031243236735463142, decouple_loss:0.0019120513461530209
Iteration: 17, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44677460193634033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030633078888058662, decouple_loss:0.001944127376191318
The modified gen p mean: 0.44225436449050903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030977847054600716, decouple_loss:0.0022499794140458107
The modified gen p mean: 0.44719401001930237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02833425998687744, decouple_loss:0.0021881095599383116
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr_shift3.npz
NaN value num: 0
Iteration: 18, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441501796245575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02965901792049408, decouple_loss:0.0028074958827346563
The modified gen p mean: 0.4446239471435547, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44576001167297363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0317966490983963, decouple_loss:0.002094147726893425
loss_pred:0.029606318101286888, decouple_loss:0.0020659056026488543
Iteration: 19, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439973831176758, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03199825808405876, decouple_loss:0.0023913367185741663
The modified gen p mean: 0.44491103291511536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028298644348978996, decouple_loss:0.00235922122374177
The modified gen p mean: 0.4476410448551178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029733486473560333, decouple_loss:0.002338044112548232
Iteration: 20, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478769600391388, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030109615996479988, decouple_loss:0.0022639986127614975
The modified gen p mean: 0.4478782117366791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03100656159222126, decouple_loss:0.002307104179635644
The modified gen p mean: 0.4480525255203247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029429078102111816, decouple_loss:0.0020750053226947784
2023-05-26 02:36:38 testing...
The modified gen p mean: 0.451700359582901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03520435094833374, decouple_loss:0.002566371811553836
The modified gen p mean: 0.45119035243988037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03696713596582413, decouple_loss:0.0024974506814032793
The modified gen p mean: 0.4498611092567444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035074904561042786, decouple_loss:0.0022292521316558123
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.035870350897312164, avg_mse: 0.04908587038516998
current test mse: 0.049086
Iteration: 21, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441213309764862, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031734924763441086, decouple_loss:0.002337006153538823
The modified gen p mean: 0.4457259178161621, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030004972591996193, decouple_loss:0.003454357385635376
The modified gen p mean: 0.44647446274757385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02885216847062111, decouple_loss:0.0021206876263022423
Iteration: 22, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44987577199935913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029639264568686485, decouple_loss:0.002097503049299121
The modified gen p mean: 0.44690486788749695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03011588752269745, decouple_loss:0.002088414505124092
The modified gen p mean: 0.44586148858070374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029254166409373283, decouple_loss:0.0024151718243956566
Iteration: 23, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44610169529914856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03151316940784454, decouple_loss:0.0024211008567363024
The modified gen p mean: 0.4485701620578766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02809266373515129, decouple_loss:0.002438961761072278
The modified gen p mean: 0.45057061314582825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029055947437882423, decouple_loss:0.002257738960906863
Iteration: 24, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45097747445106506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03069179132580757, decouple_loss:0.002133272122591734
The modified gen p mean: 0.45101773738861084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02808648720383644, decouple_loss:0.0026580379344522953
The modified gen p mean: 0.4527273178100586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029221629723906517, decouple_loss:0.0022284432779997587
Iteration: 25, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477478861808777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029719749465584755, decouple_loss:0.0021083129104226828
The modified gen p mean: 0.44835156202316284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03217659145593643, decouple_loss:0.0022274204529821873
The modified gen p mean: 0.4501711130142212, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031522661447525024, decouple_loss:0.002183191478252411
Iteration: 26, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481618106365204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030645500868558884, decouple_loss:0.002370639471337199
The modified gen p mean: 0.4473223090171814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029685314744710922, decouple_loss:0.00228656898252666
The modified gen p mean: 0.4517422318458557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02961540035903454, decouple_loss:0.0020749031100422144
Iteration: 27, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44785359501838684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02970038913190365, decouple_loss:0.0021094854455441236
The modified gen p mean: 0.44697698950767517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029458822682499886, decouple_loss:0.0019646910950541496
The modified gen p mean: 0.44598859548568726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03190850839018822, decouple_loss:0.0020492104813456535
Iteration: 28, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464627504348755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02860051393508911, decouple_loss:0.0022003287449479103
The modified gen p mean: 0.4460467994213104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030793655663728714, decouple_loss:0.0019590335432440042
The modified gen p mean: 0.44574305415153503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02948784828186035, decouple_loss:0.001995484810322523
Iteration: 29, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489143490791321, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029285158962011337, decouple_loss:0.002225275384262204
The modified gen p mean: 0.44604891538619995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028794145211577415, decouple_loss:0.0018984200432896614
The modified gen p mean: 0.4451563358306885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028345778584480286, decouple_loss:0.002227088902145624
Iteration: 30, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482068717479706, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4498077630996704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028212543576955795, decouple_loss:0.003612861502915621
loss_pred:0.02789737656712532, decouple_loss:0.003188916714861989
The modified gen p mean: 0.44776442646980286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028069451451301575, decouple_loss:0.0021905037574470043
2023-05-26 02:40:43 testing...
The modified gen p mean: 0.4526829123497009, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03517172485589981, decouple_loss:0.0023813166189938784
The modified gen p mean: 0.4508550465106964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03484509512782097, decouple_loss:0.002292121294885874
The modified gen p mean: 0.45214909315109253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03688979148864746, decouple_loss:0.0024012657813727856
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03575345128774643, avg_mse: 0.04891505837440491
current test mse: 0.048915
Iteration: 31, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44543081521987915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03094353899359703, decouple_loss:0.0021590888500213623
The modified gen p mean: 0.44834819436073303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028566423803567886, decouple_loss:0.002296572783961892
The modified gen p mean: 0.44652891159057617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03092196397483349, decouple_loss:0.0019319582497701049
Iteration: 32, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480743408203125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0288691408932209, decouple_loss:0.0020929179154336452
The modified gen p mean: 0.4462837874889374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029668228700757027, decouple_loss:0.0021088463254272938
The modified gen p mean: 0.4515521824359894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027778353542089462, decouple_loss:0.002310924930498004
Iteration: 33, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481963813304901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030732521787285805, decouple_loss:0.002173236571252346
The modified gen p mean: 0.44506844878196716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029674535617232323, decouple_loss:0.002404177561402321
The modified gen p mean: 0.44809868931770325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820430137217045, decouple_loss:0.0024371205363422632
Iteration: 34, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45035451650619507, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02995884232223034, decouple_loss:0.0022078321781009436
The modified gen p mean: 0.4494469463825226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02863183431327343, decouple_loss:0.002660341328009963
The modified gen p mean: 0.451591432094574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02921956591308117, decouple_loss:0.0019241629634052515
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr_shift3.npz
NaN value num: 0
Iteration: 35, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459114670753479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02978738583624363, decouple_loss:0.0024347244761884212
The modified gen p mean: 0.4490768015384674, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466990530490875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03034132532775402, decouple_loss:0.0022235314827412367
loss_pred:0.029151609167456627, decouple_loss:0.0019438661402091384
Iteration: 36, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449150025844574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027901194989681244, decouple_loss:0.0020991982892155647
The modified gen p mean: 0.44339293241500854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03006935492157936, decouple_loss:0.002124165650457144
The modified gen p mean: 0.44943293929100037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029109425842761993, decouple_loss:0.00233842758461833
Iteration: 37, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453827142715454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030215030536055565, decouple_loss:0.002279209438711405
The modified gen p mean: 0.44420376420021057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02938506007194519, decouple_loss:0.002648870460689068
The modified gen p mean: 0.45290327072143555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028059283271431923, decouple_loss:0.00309224845841527
Iteration: 38, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459487199783325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027099888771772385, decouple_loss:0.002340367529541254
The modified gen p mean: 0.4515541195869446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027214927598834038, decouple_loss:0.0022049087565392256
The modified gen p mean: 0.44530820846557617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02876516990363598, decouple_loss:0.0019159411313012242
Iteration: 39, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445415735244751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029058022424578667, decouple_loss:0.002199741080403328
The modified gen p mean: 0.4484977126121521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027857638895511627, decouple_loss:0.0023493608459830284
The modified gen p mean: 0.4522531032562256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02741687186062336, decouple_loss:0.002137749455869198
Iteration: 40, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452003836631775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029236409813165665, decouple_loss:0.002235780004411936
The modified gen p mean: 0.4444619417190552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0299695897847414, decouple_loss:0.002281690714880824
The modified gen p mean: 0.44737401604652405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027994142845273018, decouple_loss:0.0023064978886395693
2023-05-26 02:45:28 testing...
The modified gen p mean: 0.4535262882709503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03392153978347778, decouple_loss:0.002312998753041029
The modified gen p mean: 0.45323634147644043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03610504791140556, decouple_loss:0.0022924267686903477
The modified gen p mean: 0.45154163241386414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034053076058626175, decouple_loss:0.002087776083499193
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.034804776310920715, avg_mse: 0.0474858283996582
current test mse: 0.047486
Iteration: 41, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45201289653778076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0288442000746727, decouple_loss:0.002357727847993374
The modified gen p mean: 0.44573307037353516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029814867302775383, decouple_loss:0.002123755868524313
The modified gen p mean: 0.4457745850086212, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029252000153064728, decouple_loss:0.0019211573526263237
Iteration: 42, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514717161655426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02876342460513115, decouple_loss:0.0021999089512974024
The modified gen p mean: 0.44485849142074585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029052941128611565, decouple_loss:0.002086237771436572
The modified gen p mean: 0.44897326827049255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027226688340306282, decouple_loss:0.0022851452231407166
Iteration: 43, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444907605648041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030044689774513245, decouple_loss:0.0018328671576455235
The modified gen p mean: 0.44610288739204407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029117407277226448, decouple_loss:0.002125755650922656
The modified gen p mean: 0.4536035358905792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028293633833527565, decouple_loss:0.0020134239457547665
Iteration: 44, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44708704948425293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027005787938833237, decouple_loss:0.0021558161824941635
The modified gen p mean: 0.4441496729850769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02925943024456501, decouple_loss:0.0023805417586117983
The modified gen p mean: 0.44644254446029663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0296810120344162, decouple_loss:0.0021128205116838217
Iteration: 45, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462279677391052, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028985513374209404, decouple_loss:0.002273554913699627
The modified gen p mean: 0.4495992660522461, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027969978749752045, decouple_loss:0.0018378552049398422
The modified gen p mean: 0.45135563611984253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029399365186691284, decouple_loss:0.0017945868894457817
Iteration: 46, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44910120964050293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028490904718637466, decouple_loss:0.0021515688858926296
The modified gen p mean: 0.452108234167099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732001803815365, decouple_loss:0.0023334771394729614
The modified gen p mean: 0.44542989134788513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02961146831512451, decouple_loss:0.0020474062766879797
Iteration: 47, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469921886920929, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03059091605246067, decouple_loss:0.002388089196756482
The modified gen p mean: 0.4454125761985779, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029223721474409103, decouple_loss:0.0017182433512061834
The modified gen p mean: 0.45350518822669983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722807787358761, decouple_loss:0.0028626115527004004
Iteration: 48, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44812503457069397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02843649312853813, decouple_loss:0.001819041557610035
The modified gen p mean: 0.44503945112228394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029193732887506485, decouple_loss:0.0017313336720690131
The modified gen p mean: 0.4463537037372589, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030090348795056343, decouple_loss:0.002239564899355173
Iteration: 49, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490770399570465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029366521164774895, decouple_loss:0.0020575763192027807
The modified gen p mean: 0.445223867893219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028640681877732277, decouple_loss:0.0025185388512909412
The modified gen p mean: 0.4451146721839905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02900237962603569, decouple_loss:0.0022110294084995985
Iteration: 50, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44529926776885986, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4418730139732361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030264977365732193, decouple_loss:0.0020240889862179756
loss_pred:0.02869906835258007, decouple_loss:0.001685291645117104
The modified gen p mean: 0.44965434074401855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028251050040125847, decouple_loss:0.0024964530020952225
2023-05-26 02:49:35 testing...
The modified gen p mean: 0.4517328143119812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034644965082407, decouple_loss:0.0025223710108548403
The modified gen p mean: 0.4496641457080841, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034378036856651306, decouple_loss:0.0021549146622419357
The modified gen p mean: 0.45097821950912476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03642340749502182, decouple_loss:0.002422937424853444
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.035267140716314316, avg_mse: 0.04824639484286308
current test mse: 0.048246
Iteration: 51, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44621405005455017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0275716669857502, decouple_loss:0.001799182966351509
The modified gen p mean: 0.4499676525592804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026941265910863876, decouple_loss:0.0023017735220491886
The modified gen p mean: 0.4499684274196625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026929225772619247, decouple_loss:0.002285170368850231
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr_shift3.npz
NaN value num: 0
Iteration: 52, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434446394443512, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030474642291665077, decouple_loss:0.0020996977109462023
The modified gen p mean: 0.4475939869880676, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4440397620201111, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02984573319554329, decouple_loss:0.0019166049314662814
loss_pred:0.030389461666345596, decouple_loss:0.0021436961833387613
Iteration: 53, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478588402271271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030493319034576416, decouple_loss:0.002019257051870227
The modified gen p mean: 0.44881221652030945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028930647298693657, decouple_loss:0.002610126044601202
The modified gen p mean: 0.45005786418914795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028946788981556892, decouple_loss:0.0024320988450199366
Iteration: 54, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44667622447013855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02947295270860195, decouple_loss:0.0020262477919459343
The modified gen p mean: 0.44770684838294983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029915673658251762, decouple_loss:0.0019313325174152851
The modified gen p mean: 0.4496578872203827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028720615431666374, decouple_loss:0.00219351751729846
Iteration: 55, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44608739018440247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028852907940745354, decouple_loss:0.0022029855754226446
The modified gen p mean: 0.4483276307582855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029452567920088768, decouple_loss:0.001803373685106635
The modified gen p mean: 0.44546443223953247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028911055997014046, decouple_loss:0.0017542768036946654
Iteration: 56, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44507482647895813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028145840391516685, decouple_loss:0.001898256246931851
The modified gen p mean: 0.45277538895606995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029949145391583443, decouple_loss:0.002064262516796589
The modified gen p mean: 0.44905585050582886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028866425156593323, decouple_loss:0.0022527403198182583
Iteration: 57, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45299986004829407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02844119817018509, decouple_loss:0.0021843903232365847
The modified gen p mean: 0.4488365948200226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0294228233397007, decouple_loss:0.0025863570626825094
The modified gen p mean: 0.4527796804904938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029157530516386032, decouple_loss:0.0022006977815181017
Iteration: 58, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44959384202957153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028178609907627106, decouple_loss:0.0024260093923658133
The modified gen p mean: 0.4535234570503235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029110709205269814, decouple_loss:0.0021776235662400723
The modified gen p mean: 0.4470347762107849, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029955189675092697, decouple_loss:0.0021864380687475204
Iteration: 59, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44995856285095215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02972886711359024, decouple_loss:0.002160098170861602
The modified gen p mean: 0.44610628485679626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030366556718945503, decouple_loss:0.002083033323287964
The modified gen p mean: 0.4485893249511719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029007669538259506, decouple_loss:0.002307659247890115
Iteration: 60, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494709372520447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028453830629587173, decouple_loss:0.002483668038621545
The modified gen p mean: 0.44668295979499817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029635624960064888, decouple_loss:0.002065075095742941
The modified gen p mean: 0.44848576188087463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02955244667828083, decouple_loss:0.0019231645856052637
2023-05-26 02:54:20 testing...
The modified gen p mean: 0.45310279726982117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03338731452822685, decouple_loss:0.00227745296433568
The modified gen p mean: 0.45103394985198975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03362182155251503, decouple_loss:0.0020635095424950123
The modified gen p mean: 0.45291686058044434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03534594550728798, decouple_loss:0.00218033860437572
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.034227050840854645, avg_mse: 0.04662945494055748
current test mse: 0.046629
Iteration: 61, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44750097393989563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02956962026655674, decouple_loss:0.0022532776929438114
The modified gen p mean: 0.44526082277297974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029449455440044403, decouple_loss:0.001931583508849144
The modified gen p mean: 0.44994646310806274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030216950923204422, decouple_loss:0.0018797476077452302
Iteration: 62, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4546753168106079, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44534415006637573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029601717367768288, decouple_loss:0.0018352156039327383
loss_pred:0.028536008670926094, decouple_loss:0.0021078477147966623
The modified gen p mean: 0.45047780871391296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029272710904479027, decouple_loss:0.0018047166522592306
Iteration: 63, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446805864572525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029560888186097145, decouple_loss:0.0020700718741863966
The modified gen p mean: 0.4499601423740387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029514392837882042, decouple_loss:0.0018502981401979923
The modified gen p mean: 0.4443496763706207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030030982568860054, decouple_loss:0.0020762113854289055
Iteration: 64, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44574373960494995, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4487905204296112, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02952919341623783, decouple_loss:0.002040101680904627
loss_pred:0.029540184885263443, decouple_loss:0.001985835377126932
The modified gen p mean: 0.4456758499145508, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029164062812924385, decouple_loss:0.0017986606108024716
Iteration: 65, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44572144746780396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02993391826748848, decouple_loss:0.002057902282103896
The modified gen p mean: 0.44852423667907715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028127415105700493, decouple_loss:0.001848844694904983
The modified gen p mean: 0.44482746720314026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03014182113111019, decouple_loss:0.0019376692362129688
Iteration: 66, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44504624605178833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030500831082463264, decouple_loss:0.001864557503722608
The modified gen p mean: 0.44381681084632874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028435304760932922, decouple_loss:0.0018389506731182337
The modified gen p mean: 0.4451392889022827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028819585219025612, decouple_loss:0.0017434326000511646
Iteration: 67, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45037466287612915, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44395774602890015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028430471196770668, decouple_loss:0.001914145308546722
loss_pred:0.02829556353390217, decouple_loss:0.0020007400307804346
The modified gen p mean: 0.44875454902648926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02839573845267296, decouple_loss:0.0020819196943193674
Iteration: 68, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44811081886291504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0279279425740242, decouple_loss:0.002217104658484459
The modified gen p mean: 0.44472309947013855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02890966646373272, decouple_loss:0.0017360351048409939
The modified gen p mean: 0.4476434290409088, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030271971598267555, decouple_loss:0.001993677346035838
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr_shift3.npz
NaN value num: 0
Iteration: 69, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44578373432159424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.036479055881500244, decouple_loss:0.0020567202009260654
The modified gen p mean: 0.4457920789718628, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035351332277059555, decouple_loss:0.0020646320190280676
The modified gen p mean: 0.45073339343070984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03552110865712166, decouple_loss:0.002038081642240286
Iteration: 70, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45056819915771484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035855524241924286, decouple_loss:0.002052770461887121
The modified gen p mean: 0.4483221769332886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0347510427236557, decouple_loss:0.0018027023179456592
The modified gen p mean: 0.4505721628665924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03608652949333191, decouple_loss:0.002213391475379467
2023-05-26 02:59:09 testing...
The modified gen p mean: 0.45429980754852295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033093638718128204, decouple_loss:0.0020533925853669643
The modified gen p mean: 0.4524068534374237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033213481307029724, decouple_loss:0.0019712101202458143
The modified gen p mean: 0.4541007876396179, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03469546511769295, decouple_loss:0.0020385358948260546
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033768583089113235, avg_mse: 0.04574326053261757
current test mse: 0.045743
At step 70, Best test: 0.045743
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_WV_1_PC_0_EH_0_PS_40_6hrs.ckpt
Iteration: 71, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4517155587673187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0348602719604969, decouple_loss:0.0017186544137075543
The modified gen p mean: 0.4496564269065857, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4524784982204437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03421923518180847, decouple_loss:0.0018271129811182618
loss_pred:0.03399096801877022, decouple_loss:0.0017033577896654606
Iteration: 72, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45358073711395264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03373560309410095, decouple_loss:0.0019327455665916204
The modified gen p mean: 0.4504166841506958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0342177078127861, decouple_loss:0.0017195332329720259
The modified gen p mean: 0.4548206925392151, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03440838307142258, decouple_loss:0.001847322448156774
Iteration: 73, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4547595679759979, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4523248076438904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03382488712668419, decouple_loss:0.0019069220870733261
loss_pred:0.033277351409196854, decouple_loss:0.001986524323001504
The modified gen p mean: 0.45154720544815063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035497017204761505, decouple_loss:0.001867347047664225
Iteration: 74, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4537983238697052, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033282700926065445, decouple_loss:0.0018179104663431644
The modified gen p mean: 0.45325133204460144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03476334735751152, decouple_loss:0.0020613507367670536
The modified gen p mean: 0.4542967677116394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03373133763670921, decouple_loss:0.0020545937586575747
Iteration: 75, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45431795716285706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03349394351243973, decouple_loss:0.0016307806363329291
The modified gen p mean: 0.45913153886795044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0344543494284153, decouple_loss:0.001968796132132411
The modified gen p mean: 0.45565250515937805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03293771669268608, decouple_loss:0.0018710545264184475
Iteration: 76, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4598676562309265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034342799335718155, decouple_loss:0.0019754767417907715
The modified gen p mean: 0.45516395568847656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03452630713582039, decouple_loss:0.0016988437855616212
The modified gen p mean: 0.4579654037952423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03384106233716011, decouple_loss:0.0018033582018688321
Iteration: 77, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45495739579200745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034337881952524185, decouple_loss:0.0017227093921974301
The modified gen p mean: 0.45761027932167053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032723382115364075, decouple_loss:0.0020357193425297737
The modified gen p mean: 0.4556728005409241, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03276766091585159, decouple_loss:0.0018497523851692677
Iteration: 78, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516601264476776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03440122306346893, decouple_loss:0.0019473021384328604
The modified gen p mean: 0.4499586820602417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032347097992897034, decouple_loss:0.0016057384200394154
The modified gen p mean: 0.45118847489356995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03525004908442497, decouple_loss:0.0017408047569915652
Iteration: 79, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470663368701935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03197851404547691, decouple_loss:0.001578866271302104
The modified gen p mean: 0.45102766156196594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034629594534635544, decouple_loss:0.0016167862340807915
The modified gen p mean: 0.4512840807437897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03328101709485054, decouple_loss:0.0016879725735634565
Iteration: 80, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44883233308792114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03446292132139206, decouple_loss:0.001740779378451407
The modified gen p mean: 0.4463782012462616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035008497536182404, decouple_loss:0.001690616481937468
The modified gen p mean: 0.4483624994754791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03411103039979935, decouple_loss:0.001946807373315096
2023-05-26 03:03:20 testing...
The modified gen p mean: 0.44946396350860596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259039670228958, decouple_loss:0.001833400223404169
The modified gen p mean: 0.4492921829223633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03394855931401253, decouple_loss:0.0018252665176987648
The modified gen p mean: 0.44796010851860046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032737717032432556, decouple_loss:0.0018340755486860871
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03318376839160919, avg_mse: 0.04471953585743904
current test mse: 0.04472
At step 80, Best test: 0.04472
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_WV_1_PC_0_EH_0_PS_40_6hrs.ckpt
Iteration: 81, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45015355944633484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034402165561914444, decouple_loss:0.001904816715978086
The modified gen p mean: 0.4439471662044525, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4460659921169281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033844172954559326, decouple_loss:0.00167506979778409loss_pred:0.03299834206700325, decouple_loss:0.0017982120625674725
Iteration: 82, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468497633934021, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033895693719387054, decouple_loss:0.0017707853112369776
The modified gen p mean: 0.4429863691329956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03452148661017418, decouple_loss:0.0015354770002886653
The modified gen p mean: 0.44703415036201477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03349953517317772, decouple_loss:0.00190233055036515
Iteration: 83, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4440547823905945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03410563990473747, decouple_loss:0.0016166088171303272
The modified gen p mean: 0.44426149129867554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03480272740125656, decouple_loss:0.0017321708146482706
The modified gen p mean: 0.4475836157798767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03274344652891159, decouple_loss:0.0019487591926008463
Iteration: 84, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44469860196113586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03273224085569382, decouple_loss:0.001805576030164957
The modified gen p mean: 0.4434741139411926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034373313188552856, decouple_loss:0.0017117966199293733
The modified gen p mean: 0.449320912361145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03519843518733978, decouple_loss:0.0017459839582443237
Iteration: 85, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491207003593445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03407564386725426, decouple_loss:0.001712005352601409
The modified gen p mean: 0.4451134502887726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03437824547290802, decouple_loss:0.0016200271202251315
The modified gen p mean: 0.44771939516067505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03197023272514343, decouple_loss:0.0017675281269475818
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr.npz
NaN value num: 0
Iteration: 86, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481949806213379, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033709101378917694, decouple_loss:0.0017969360342249274
The modified gen p mean: 0.45078378915786743, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44984328746795654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03418364375829697, decouple_loss:0.0018475297838449478
loss_pred:0.03451967611908913, decouple_loss:0.0018276642076671124
Iteration: 87, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44805899262428284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03284316509962082, decouple_loss:0.00216506770811975
The modified gen p mean: 0.45304685831069946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03378652036190033, decouple_loss:0.00168594007845968
The modified gen p mean: 0.44711050391197205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03175345063209534, decouple_loss:0.0016965422546491027
Iteration: 88, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44996175169944763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03304015472531319, decouple_loss:0.0016649245517328382
The modified gen p mean: 0.450987845659256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03350235894322395, decouple_loss:0.0016569186700507998
The modified gen p mean: 0.4495886564254761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03263266012072563, decouple_loss:0.0017397881019860506
Iteration: 89, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44889310002326965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03227553889155388, decouple_loss:0.0017238323343917727
The modified gen p mean: 0.4529985189437866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03180588781833649, decouple_loss:0.0018040875438600779
The modified gen p mean: 0.4476041793823242, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032628223299980164, decouple_loss:0.001786961336620152
Iteration: 90, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44970008730888367, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4523807466030121, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03366997092962265, decouple_loss:0.001896293368190527
loss_pred:0.03358467295765877, decouple_loss:0.0020819304045289755
The modified gen p mean: 0.4536275863647461, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033686600625514984, decouple_loss:0.0018257438205182552
2023-05-26 03:08:17 testing...
The modified gen p mean: 0.45368871092796326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03238248452544212, decouple_loss:0.0019553517922759056
The modified gen p mean: 0.45234233140945435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032676517963409424, decouple_loss:0.0018442196305841208
The modified gen p mean: 0.45365774631500244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03391363099217415, decouple_loss:0.0018547306535765529
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03308511897921562, avg_mse: 0.04460703209042549
current test mse: 0.044607
At step 90, Best test: 0.044607
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_WV_1_PC_0_EH_0_PS_40_6hrs.ckpt
Iteration: 91, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496898949146271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033263351768255234, decouple_loss:0.0017161114374175668
The modified gen p mean: 0.4479059875011444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03400063142180443, decouple_loss:0.0017195926047861576
The modified gen p mean: 0.4467911720275879, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0339537113904953, decouple_loss:0.0020088164601475
Iteration: 92, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468774199485779, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03244316950440407, decouple_loss:0.0017945505678653717
The modified gen p mean: 0.44889819622039795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035243552178144455, decouple_loss:0.0018629078986123204
The modified gen p mean: 0.44692957401275635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03142969682812691, decouple_loss:0.001532761612907052
Iteration: 93, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45023980736732483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033651020377874374, decouple_loss:0.0017994634108617902
The modified gen p mean: 0.4489356577396393, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03324209898710251, decouple_loss:0.0016650783363729715
The modified gen p mean: 0.4453982710838318, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03272444009780884, decouple_loss:0.0017577784601598978
Iteration: 94, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44809284806251526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03466128930449486, decouple_loss:0.0016101327491924167
The modified gen p mean: 0.4496222138404846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03224049136042595, decouple_loss:0.0017241643508896232
The modified gen p mean: 0.44795334339141846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033262282609939575, decouple_loss:0.0016994369216263294
Iteration: 95, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4524816870689392, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261297196149826, decouple_loss:0.001695078331977129
The modified gen p mean: 0.45143210887908936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03229529783129692, decouple_loss:0.0017662898171693087
The modified gen p mean: 0.44692108035087585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032792165875434875, decouple_loss:0.001791996299289167
Iteration: 96, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477713704109192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03452521935105324, decouple_loss:0.001726298127323389
The modified gen p mean: 0.4493354856967926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03178578242659569, decouple_loss:0.0018644384108483791
The modified gen p mean: 0.44692718982696533, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032930292189121246, decouple_loss:0.0016973938327282667
Iteration: 97, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44983842968940735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03313859924674034, decouple_loss:0.0020343188662081957
The modified gen p mean: 0.4482121765613556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03226638585329056, decouple_loss:0.0017406720435246825
The modified gen p mean: 0.4516090750694275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03215806931257248, decouple_loss:0.0016116873594000936
Iteration: 98, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44812703132629395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032624270766973495, decouple_loss:0.0017606106121093035
The modified gen p mean: 0.4515135884284973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03317761793732643, decouple_loss:0.001655999687500298
The modified gen p mean: 0.44840529561042786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03346885368227959, decouple_loss:0.001512646907940507
Iteration: 99, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4533936679363251, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03166617080569267, decouple_loss:0.0016539868665859103
The modified gen p mean: 0.4475308656692505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03422718495130539, decouple_loss:0.0016333460807800293
The modified gen p mean: 0.4499238133430481, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03296428173780441, decouple_loss:0.0017650254303589463
Iteration: 100, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44891706109046936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265245258808136, decouple_loss:0.0016536297043785453
The modified gen p mean: 0.45274078845977783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033070776611566544, decouple_loss:0.0017899369122460485
The modified gen p mean: 0.4527193009853363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283332288265228, decouple_loss:0.0017028821166604757
2023-05-26 03:12:30 testing...
The modified gen p mean: 0.45265406370162964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03226122632622719, decouple_loss:0.001815231516957283
The modified gen p mean: 0.45146840810775757, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246823325753212, decouple_loss:0.0018251296132802963
The modified gen p mean: 0.45279461145401, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03377741202712059, decouple_loss:0.001741577172651887
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0329253226518631, avg_mse: 0.04440814629197121
current test mse: 0.044408
At step 100, Best test: 0.044408
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_WV_1_PC_0_EH_0_PS_40_6hrs.ckpt
Iteration: 101, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479486644268036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03327126428484917, decouple_loss:0.0017502930713817477
The modified gen p mean: 0.44855427742004395, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4512697458267212, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03480137512087822, decouple_loss:0.0018046194454655051
loss_pred:0.03214576840400696, decouple_loss:0.0017260608728975058
Iteration: 102, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497112035751343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03285730257630348, decouple_loss:0.0016394100384786725
The modified gen p mean: 0.44796252250671387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033967845141887665, decouple_loss:0.0016052682185545564
The modified gen p mean: 0.45073238015174866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03502880036830902, decouple_loss:0.001705694361589849
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr.npz
NaN value num: 0
Iteration: 103, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45048221945762634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030637849122285843, decouple_loss:0.0019445662619546056
The modified gen p mean: 0.449259489774704, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44923868775367737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02864997275173664, decouple_loss:0.0017595585668459535
loss_pred:0.02797713689506054, decouple_loss:0.0017369702691212296
Iteration: 104, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44982969760894775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028623370453715324, decouple_loss:0.0021384949795901775
The modified gen p mean: 0.45162534713745117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030640844255685806, decouple_loss:0.0021036493126302958
The modified gen p mean: 0.4470452070236206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028342511504888535, decouple_loss:0.0018155130092054605
Iteration: 105, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484959542751312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027563611045479774, decouple_loss:0.0017991071799769998
The modified gen p mean: 0.45020222663879395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03130633383989334, decouple_loss:0.0023014105390757322
The modified gen p mean: 0.4464007019996643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029348669573664665, decouple_loss:0.0019705630838871002
Iteration: 106, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468998610973358, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44456881284713745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02767140232026577, decouple_loss:0.0018155918223783374
loss_pred:0.02964322455227375, decouple_loss:0.0018325216369703412
The modified gen p mean: 0.4490099549293518, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029641006141901016, decouple_loss:0.002193526364862919
Iteration: 107, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44812318682670593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027641719207167625, decouple_loss:0.0018530406523495913
The modified gen p mean: 0.4482837915420532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02960820309817791, decouple_loss:0.002136010443791747
The modified gen p mean: 0.4422725737094879, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029221002012491226, decouple_loss:0.0021152200642973185
Iteration: 108, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44458794593811035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028209198266267776, decouple_loss:0.00182987074367702
The modified gen p mean: 0.4432900846004486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028659431263804436, decouple_loss:0.0018741640960797668
The modified gen p mean: 0.4464889168739319, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028140561655163765, decouple_loss:0.0019885459914803505
Iteration: 109, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454175531864166, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4461899399757385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031001681461930275, decouple_loss:0.0018092987593263388
loss_pred:0.029688967391848564, decouple_loss:0.0019456202862784266
The modified gen p mean: 0.4450097978115082, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029935840517282486, decouple_loss:0.0016754382522776723
Iteration: 110, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44533148407936096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028698625043034554, decouple_loss:0.0019444735953584313
The modified gen p mean: 0.443574458360672, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02839593030512333, decouple_loss:0.0018376412335783243
The modified gen p mean: 0.44681739807128906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029888352379202843, decouple_loss:0.001835747854784131
2023-05-26 03:17:24 testing...
The modified gen p mean: 0.4513140320777893, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03244846314191818, decouple_loss:0.0020996511448174715
The modified gen p mean: 0.4515107572078705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03398739919066429, decouple_loss:0.0020044331904500723
The modified gen p mean: 0.45000505447387695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265569731593132, decouple_loss:0.001980359433218837
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033131927251815796, avg_mse: 0.04478060081601143
current test mse: 0.044781
Iteration: 111, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461590051651001, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02855719067156315, decouple_loss:0.0022601643577218056
The modified gen p mean: 0.44595691561698914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03000355139374733, decouple_loss:0.002134403446689248
The modified gen p mean: 0.4443782567977905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02942441776394844, decouple_loss:0.0019741097930818796
Iteration: 112, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495543837547302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030215704813599586, decouple_loss:0.0019057634053751826
The modified gen p mean: 0.4508824944496155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029706457629799843, decouple_loss:0.001955421408638358
The modified gen p mean: 0.44613775610923767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02939543128013611, decouple_loss:0.0017932286718860269
Iteration: 113, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45184585452079773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028993386775255203, decouple_loss:0.0019811964593827724
The modified gen p mean: 0.44763025641441345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02830681949853897, decouple_loss:0.0019087125547230244
The modified gen p mean: 0.44924119114875793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029917044565081596, decouple_loss:0.0019042800413444638
Iteration: 114, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44908514618873596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02829083427786827, decouple_loss:0.002184957033023238
The modified gen p mean: 0.45194315910339355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028193563222885132, decouple_loss:0.0018077321583405137
The modified gen p mean: 0.45262831449508667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02919377200305462, decouple_loss:0.0021379238460212946
Iteration: 115, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45088985562324524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029409904032945633, decouple_loss:0.0020783988293260336
The modified gen p mean: 0.4496324956417084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029492372646927834, decouple_loss:0.0023959181271493435
The modified gen p mean: 0.4523901641368866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027869243174791336, decouple_loss:0.0025952744763344526
Iteration: 116, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45042863488197327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028085023164749146, decouple_loss:0.002575397025793791
The modified gen p mean: 0.4506455659866333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029322508722543716, decouple_loss:0.0023518658708781004
The modified gen p mean: 0.4509505331516266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02830079197883606, decouple_loss:0.0020111054182052612
Iteration: 117, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4529181718826294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030154971405863762, decouple_loss:0.0024804326239973307
The modified gen p mean: 0.4552229046821594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027728846296668053, decouple_loss:0.001988121075555682
The modified gen p mean: 0.4532811939716339, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0287068672478199, decouple_loss:0.0021032514050602913
Iteration: 118, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516488313674927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0288697462528944, decouple_loss:0.0019277357496321201
The modified gen p mean: 0.45598435401916504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0296485498547554, decouple_loss:0.0017061826074495912
The modified gen p mean: 0.45233920216560364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029998069629073143, decouple_loss:0.002558516338467598
Iteration: 119, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501723349094391, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0296914204955101, decouple_loss:0.0018906681798398495
The modified gen p mean: 0.4531264007091522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028236281126737595, decouple_loss:0.0019452854758128524
The modified gen p mean: 0.45325517654418945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02741340920329094, decouple_loss:0.001992151839658618
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr.npz
NaN value num: 0
Iteration: 120, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449200838804245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03406520187854767, decouple_loss:0.001850560656748712
The modified gen p mean: 0.4510834515094757, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033438876271247864, decouple_loss:0.0019924233201891184
The modified gen p mean: 0.45333099365234375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03724610432982445, decouple_loss:0.0017647331114858389
2023-05-26 03:22:13 testing...
The modified gen p mean: 0.4550617039203644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032887790352106094, decouple_loss:0.0021767986472696066
The modified gen p mean: 0.4535924196243286, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4551224410533905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033060528337955475, decouple_loss:0.002082066610455513
loss_pred:0.03436513617634773, decouple_loss:0.0020671694073826075
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03354325145483017, avg_mse: 0.04555169865489006
current test mse: 0.045552
Iteration: 121, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4542670249938965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03336677327752113, decouple_loss:0.002035922836512327
The modified gen p mean: 0.4494549632072449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033677488565444946, decouple_loss:0.0016724423039704561
The modified gen p mean: 0.45072516798973083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03217872232198715, decouple_loss:0.001734997145831585
Iteration: 122, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485650956630707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0334368571639061, decouple_loss:0.0016599452355876565
The modified gen p mean: 0.455098956823349, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034467633813619614, decouple_loss:0.0021011654753237963
The modified gen p mean: 0.45572978258132935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03770440071821213, decouple_loss:0.0021247791592031717
Iteration: 123, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44929948449134827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03356371819972992, decouple_loss:0.0018467948539182544
The modified gen p mean: 0.4531188905239105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03593527898192406, decouple_loss:0.0018145516514778137
The modified gen p mean: 0.45223376154899597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03379276767373085, decouple_loss:0.0017205113545060158
Iteration: 124, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495485723018646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03382759168744087, decouple_loss:0.001845040824264288
The modified gen p mean: 0.45274966955184937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03356032073497772, decouple_loss:0.002159588271752
The modified gen p mean: 0.4473889470100403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03405352309346199, decouple_loss:0.0017378425691276789
Iteration: 125, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485521614551544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03426291421055794, decouple_loss:0.001741693471558392
The modified gen p mean: 0.45263418555259705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03719281032681465, decouple_loss:0.00185595138464123
The modified gen p mean: 0.4552481174468994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033591821789741516, decouple_loss:0.0018946402706205845
Iteration: 126, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485938847064972, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03280305862426758, decouple_loss:0.0017947335727512836
The modified gen p mean: 0.4525286555290222, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035565607249736786, decouple_loss:0.0018642423674464226
The modified gen p mean: 0.44810906052589417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03476511314511299, decouple_loss:0.0017079284880310297
Iteration: 127, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4522956609725952, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03371389955282211, decouple_loss:0.0018335666973143816
The modified gen p mean: 0.44718047976493835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03227810934185982, decouple_loss:0.0015896990662440658
The modified gen p mean: 0.44795578718185425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03211014345288277, decouple_loss:0.0016565362457185984
Iteration: 128, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469391703605652, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033843375742435455, decouple_loss:0.0016114524332806468
The modified gen p mean: 0.44828522205352783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035357698798179626, decouple_loss:0.0017621830338612199
The modified gen p mean: 0.4481736421585083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03593292087316513, decouple_loss:0.001610930310562253
Iteration: 129, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519217610359192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03333378955721855, decouple_loss:0.0017114533111453056
The modified gen p mean: 0.44933900237083435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0351375937461853, decouple_loss:0.0016518629854544997
The modified gen p mean: 0.45133206248283386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0357823371887207, decouple_loss:0.001741644460707903
Iteration: 130, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4539768397808075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03424788638949394, decouple_loss:0.0016257353127002716
The modified gen p mean: 0.4497164189815521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03371783345937729, decouple_loss:0.00160648871678859
The modified gen p mean: 0.4541485011577606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033526599407196045, decouple_loss:0.0017003758111968637
2023-05-26 03:26:20 testing...
The modified gen p mean: 0.45647746324539185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032389648258686066, decouple_loss:0.0018140145111829042
The modified gen p mean: 0.45506712794303894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03250850737094879, decouple_loss:0.0017991721397265792
The modified gen p mean: 0.4565527141094208, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03383275866508484, decouple_loss:0.0018125413917005062
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03300073370337486, avg_mse: 0.04454105719923973
current test mse: 0.044541
Iteration: 131, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45617955923080444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03386472538113594, decouple_loss:0.0017616115510463715
The modified gen p mean: 0.45207446813583374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03248397260904312, decouple_loss:0.0018954048864543438
The modified gen p mean: 0.4514002799987793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03403783217072487, decouple_loss:0.0019295962993055582
Iteration: 132, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45272284746170044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03420921415090561, decouple_loss:0.0016200304962694645
The modified gen p mean: 0.45717665553092957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032777898013591766, decouple_loss:0.0016785513143986464
The modified gen p mean: 0.4546454846858978, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254734352231026, decouple_loss:0.001976089319214225
Iteration: 133, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451786071062088, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03370111063122749, decouple_loss:0.0017360171768814325
The modified gen p mean: 0.45185214281082153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033377911895513535, decouple_loss:0.0016700015403330326
The modified gen p mean: 0.4519796371459961, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03386640176177025, decouple_loss:0.0019279737025499344
Iteration: 134, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509003162384033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034658558666706085, decouple_loss:0.0016722538275644183
The modified gen p mean: 0.45362815260887146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034406740218400955, decouple_loss:0.0016160926315933466
The modified gen p mean: 0.4521188735961914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03449464216828346, decouple_loss:0.0016798292053863406
Iteration: 135, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503195285797119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03421250358223915, decouple_loss:0.0017444187542423606
The modified gen p mean: 0.450575590133667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032268181443214417, decouple_loss:0.0016632513143122196
The modified gen p mean: 0.4530433416366577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03616804629564285, decouple_loss:0.0018090697703883052
Iteration: 136, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45102229714393616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030609464272856712, decouple_loss:0.001683393376879394The modified gen p mean: 0.4496871829032898, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03448019176721573, decouple_loss:0.001777700730599463
The modified gen p mean: 0.4482651948928833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03324868530035019, decouple_loss:0.0016606785356998444
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr.npz
NaN value num: 0
Iteration: 137, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44648540019989014, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03375641256570816, decouple_loss:0.0020008685532957315
The modified gen p mean: 0.4475766718387604, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4489913582801819, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03297700360417366, decouple_loss:0.0018028990598395467loss_pred:0.032027777284383774, decouple_loss:0.0019793205428868532
Iteration: 138, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44846203923225403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03273871913552284, decouple_loss:0.0017503455746918917
The modified gen p mean: 0.4446171224117279, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03282691910862923, decouple_loss:0.0018966441275551915
The modified gen p mean: 0.4488166272640228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03411508724093437, decouple_loss:0.0018006935715675354
Iteration: 139, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498426914215088, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4499792158603668, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032838255167007446, decouple_loss:0.0017670561792328954
loss_pred:0.03484301269054413, decouple_loss:0.0018185211811214685
The modified gen p mean: 0.44898733496665955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03408941999077797, decouple_loss:0.0017998351249843836
Iteration: 140, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44912758469581604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033200375735759735, decouple_loss:0.0015882868319749832
The modified gen p mean: 0.450716495513916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0326617956161499, decouple_loss:0.0016889615217223763
The modified gen p mean: 0.4498031437397003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03186362609267235, decouple_loss:0.001857696333900094
2023-05-26 03:31:07 testing...
The modified gen p mean: 0.453008234500885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03369526192545891, decouple_loss:0.0017327481182292104
The modified gen p mean: 0.45284634828567505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0322495773434639, decouple_loss:0.001803846680559218
The modified gen p mean: 0.45146384835243225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032458554953336716, decouple_loss:0.0016732638468965888
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032887961715459824, avg_mse: 0.0444248765707016
current test mse: 0.044425
Iteration: 141, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44720861315727234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03263583406805992, decouple_loss:0.0016578303184360266
The modified gen p mean: 0.4502806067466736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03458287939429283, decouple_loss:0.0016361753223463893
The modified gen p mean: 0.44603267312049866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03390149772167206, decouple_loss:0.001755806733854115
Iteration: 142, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4530814290046692, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03186105191707611, decouple_loss:0.0015378670068457723
The modified gen p mean: 0.4479156732559204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033692050725221634, decouple_loss:0.0016757930861786008
The modified gen p mean: 0.4513590335845947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033582642674446106, decouple_loss:0.001726376242004335
Iteration: 143, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492809474468231, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03312811627984047, decouple_loss:0.001606039353646338
The modified gen p mean: 0.44874557852745056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033298738300800323, decouple_loss:0.0016522841760888696
The modified gen p mean: 0.4486250579357147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032336730509996414, decouple_loss:0.0015039986465126276
Iteration: 144, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4522671699523926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230790048837662, decouple_loss:0.0015844921581447124
The modified gen p mean: 0.4481049180030823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03241946920752525, decouple_loss:0.0015989195089787245
The modified gen p mean: 0.4507369101047516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0333973728120327, decouple_loss:0.0018418221734464169
Iteration: 145, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498438537120819, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0334494449198246, decouple_loss:0.0016613919287919998
The modified gen p mean: 0.4482548236846924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03423987701535225, decouple_loss:0.0016112489392980933
The modified gen p mean: 0.4535309970378876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03223145753145218, decouple_loss:0.0018799126846715808
Iteration: 146, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44755348563194275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03362796828150749, decouple_loss:0.00150955468416214
The modified gen p mean: 0.4486370384693146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03455283120274544, decouple_loss:0.0017002979293465614
The modified gen p mean: 0.448386549949646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03314793109893799, decouple_loss:0.001490019029006362
Iteration: 147, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503108263015747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03317733108997345, decouple_loss:0.0016744453459978104
The modified gen p mean: 0.44600218534469604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032532911747694016, decouple_loss:0.0015575020806863904
The modified gen p mean: 0.4493027329444885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033481307327747345, decouple_loss:0.0016516243340447545
Iteration: 148, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475826621055603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03454622998833656, decouple_loss:0.0015213098376989365
The modified gen p mean: 0.44609251618385315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03383127599954605, decouple_loss:0.0017721219919621944
The modified gen p mean: 0.44866013526916504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03358715400099754, decouple_loss:0.0015554914716631174
Iteration: 149, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478357136249542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03231552243232727, decouple_loss:0.0017189335776492953
The modified gen p mean: 0.4474644362926483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0353618822991848, decouple_loss:0.0016285026213154197
The modified gen p mean: 0.4455007016658783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03435654193162918, decouple_loss:0.001594166038557887
Iteration: 150, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446058064699173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03308062627911568, decouple_loss:0.001826695865020156
The modified gen p mean: 0.4462795853614807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03202534466981888, decouple_loss:0.0016136986669152975
The modified gen p mean: 0.4508584439754486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03418896347284317, decouple_loss:0.0015660739736631513
2023-05-26 03:35:14 testing...
The modified gen p mean: 0.45272764563560486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03199685737490654, decouple_loss:0.0016884368378669024
The modified gen p mean: 0.45141610503196716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230263665318489, decouple_loss:0.0016633045161142945
The modified gen p mean: 0.4529903829097748, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03357257694005966, decouple_loss:0.0017165311146527529
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03270849585533142, avg_mse: 0.044152263551950455
current test mse: 0.044152
At step 150, Best test: 0.044152
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_WV_1_PC_0_EH_0_PS_40_6hrs.ckpt
Iteration: 151, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45117950439453125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033539410680532455, decouple_loss:0.001536530558951199
The modified gen p mean: 0.4506722688674927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034204091876745224, decouple_loss:0.0015305057168006897
The modified gen p mean: 0.4512363076210022, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03343337029218674, decouple_loss:0.0018900141585618258
Iteration: 152, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44636520743370056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03367118909955025, decouple_loss:0.0017043427797034383
The modified gen p mean: 0.45179277658462524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03368291258811951, decouple_loss:0.0017458760412409902
The modified gen p mean: 0.4515746831893921, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03342993184924126, decouple_loss:0.001787026529200375
Iteration: 153, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44505324959754944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03399357199668884, decouple_loss:0.0017933495109900832
The modified gen p mean: 0.44876837730407715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03396422788500786, decouple_loss:0.0017051901668310165
The modified gen p mean: 0.4471292197704315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03350059315562248, decouple_loss:0.001544041559100151
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr_shift3.npz
NaN value num: 0
Iteration: 154, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45137646794319153, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45018720626831055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03355778753757477, decouple_loss:0.0017376361647620797loss_pred:0.032227449119091034, decouple_loss:0.0017203064635396004
The modified gen p mean: 0.45056992769241333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02998034842312336, decouple_loss:0.001936762360855937
Iteration: 155, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44823166728019714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030774615705013275, decouple_loss:0.001942952978424728
The modified gen p mean: 0.4463054835796356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03386599197983742, decouple_loss:0.0017865333938971162
The modified gen p mean: 0.4508230686187744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03270861878991127, decouple_loss:0.0019030265975743532
Iteration: 156, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44730231165885925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03279843181371689, decouple_loss:0.0016056840540841222
The modified gen p mean: 0.44899433851242065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030522283166646957, decouple_loss:0.0016774720279499888
The modified gen p mean: 0.4483371376991272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03128466010093689, decouple_loss:0.0017563397996127605
Iteration: 157, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4435885548591614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031497012823820114, decouple_loss:0.0015954376431182027
The modified gen p mean: 0.4455767869949341, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03148561343550682, decouple_loss:0.0017905815038830042
The modified gen p mean: 0.4442709684371948, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0319378599524498, decouple_loss:0.0018209322588518262
Iteration: 158, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4421212673187256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283141180872917, decouple_loss:0.001586139784194529
The modified gen p mean: 0.4457900822162628, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033691614866256714, decouple_loss:0.0015941952588036656
The modified gen p mean: 0.4442775547504425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254813328385353, decouple_loss:0.001607087324373424
Iteration: 159, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448620080947876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03153112158179283, decouple_loss:0.002059395657852292
The modified gen p mean: 0.44459354877471924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031710024923086166, decouple_loss:0.001871083164587617
The modified gen p mean: 0.44567784667015076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029187314212322235, decouple_loss:0.0016794588882476091
Iteration: 160, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44233760237693787, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4469592273235321, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031204739585518837, decouple_loss:0.001568867126479745
loss_pred:0.030847076326608658, decouple_loss:0.001725957728922367
The modified gen p mean: 0.4438876807689667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03288045525550842, decouple_loss:0.0016236293595284224
2023-05-26 03:40:30 testing...
The modified gen p mean: 0.44895315170288086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032019197940826416, decouple_loss:0.0017070051981136203
The modified gen p mean: 0.4490966200828552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033636778593063354, decouple_loss:0.0017733294516801834
The modified gen p mean: 0.44752237200737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03238843008875847, decouple_loss:0.001668149488978088
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03276727721095085, avg_mse: 0.044224146753549576
current test mse: 0.044224
Iteration: 161, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4423985183238983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03167589008808136, decouple_loss:0.0014099201653152704
The modified gen p mean: 0.44840434193611145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031271446496248245, decouple_loss:0.0017807394033297896
The modified gen p mean: 0.44481831789016724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030115729197859764, decouple_loss:0.0017372767906636
Iteration: 162, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44974520802497864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029768014326691628, decouple_loss:0.0018113201949745417
The modified gen p mean: 0.4465750455856323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03149998188018799, decouple_loss:0.0016473998548462987
The modified gen p mean: 0.4494413137435913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03112896718084812, decouple_loss:0.0018781243124976754
Iteration: 163, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44797655940055847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03175363689661026, decouple_loss:0.0016835773130878806
The modified gen p mean: 0.44642895460128784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02986876294016838, decouple_loss:0.0015103875193744898
The modified gen p mean: 0.44782254099845886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033240143209695816, decouple_loss:0.0018308887956663966
Iteration: 164, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45163944363594055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03153332695364952, decouple_loss:0.0017665305640548468
The modified gen p mean: 0.45294466614723206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029731035232543945, decouple_loss:0.001995299942791462
The modified gen p mean: 0.4516545236110687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029950346797704697, decouple_loss:0.001968881580978632
Iteration: 165, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4522709548473358, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03257028013467789, decouple_loss:0.001678024884313345
The modified gen p mean: 0.4538124203681946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031765054911375046, decouple_loss:0.0017100274562835693
The modified gen p mean: 0.4570882320404053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031111912801861763, decouple_loss:0.0017077873926609755
Iteration: 166, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45160409808158875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030684251338243484, decouple_loss:0.0018601154442876577
The modified gen p mean: 0.45530378818511963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032798994332551956, decouple_loss:0.0020013346802443266
The modified gen p mean: 0.453938364982605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032073069363832474, decouple_loss:0.001773273921571672
Iteration: 167, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4561549425125122, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030118625611066818, decouple_loss:0.0019661555998027325
The modified gen p mean: 0.45199665427207947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032578956335783005, decouple_loss:0.0018927834462374449
The modified gen p mean: 0.45698294043540955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02964293397963047, decouple_loss:0.0020400320645421743
Iteration: 168, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4523947536945343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03337236866354942, decouple_loss:0.0017405736725777388
The modified gen p mean: 0.45296165347099304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03193248063325882, decouple_loss:0.0016981674125418067
The modified gen p mean: 0.45256003737449646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030481085181236267, decouple_loss:0.001704960479401052
Iteration: 169, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485898017883301, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03056010976433754, decouple_loss:0.001803274150006473
The modified gen p mean: 0.44843509793281555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030965091660618782, decouple_loss:0.0016971273580566049
The modified gen p mean: 0.4476011395454407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032522089779376984, decouple_loss:0.0018118447624146938
Iteration: 170, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44906359910964966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028939587995409966, decouple_loss:0.00182532228063792
The modified gen p mean: 0.4467029273509979, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03174544870853424, decouple_loss:0.0019583418034017086
The modified gen p mean: 0.44854268431663513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030689289793372154, decouple_loss:0.002243508817628026
2023-05-26 03:44:35 testing...
The modified gen p mean: 0.45018088817596436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03263670951128006, decouple_loss:0.0018867433536797762
The modified gen p mean: 0.44970473647117615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03450139984488487, decouple_loss:0.0019641234539449215
The modified gen p mean: 0.4481799900531769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03316689282655716, decouple_loss:0.0019425926730036736
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0335315577685833, avg_mse: 0.045364152640104294
current test mse: 0.045364
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr_shift3.npz
NaN value num: 0
Iteration: 171, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44438618421554565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02842177078127861, decouple_loss:0.0018861325224861503
The modified gen p mean: 0.44636431336402893, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44335153698921204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029044991359114647, decouple_loss:0.0019262471469119191
loss_pred:0.03168747201561928, decouple_loss:0.0015689678257331252
Iteration: 172, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44421032071113586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03185920789837837, decouple_loss:0.001631756080314517
The modified gen p mean: 0.4437297284603119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02931557223200798, decouple_loss:0.0017877740319818258
The modified gen p mean: 0.4474296569824219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02859712578356266, decouple_loss:0.0019096093019470572
Iteration: 173, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44232967495918274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03058875910937786, decouple_loss:0.0017763774376362562
The modified gen p mean: 0.43925195932388306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03184135630726814, decouple_loss:0.0017625326290726662
The modified gen p mean: 0.4420119822025299, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029449475929141045, decouple_loss:0.0020151690114289522
Iteration: 174, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452914297580719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029176346957683563, decouple_loss:0.002202877076342702
The modified gen p mean: 0.44709718227386475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029195116832852364, decouple_loss:0.0018646825337782502
The modified gen p mean: 0.44325658679008484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03130456432700157, decouple_loss:0.0019164475379511714
Iteration: 175, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44359877705574036, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44611263275146484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030319448560476303, decouple_loss:0.0019198203226551414
loss_pred:0.030247870832681656, decouple_loss:0.002216471591964364
The modified gen p mean: 0.44157087802886963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030897721648216248, decouple_loss:0.0018012946238741279
Iteration: 176, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44525057077407837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029631562530994415, decouple_loss:0.001790786860510707
The modified gen p mean: 0.4478940963745117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02949812449514866, decouple_loss:0.0019328567432239652
The modified gen p mean: 0.4421063959598541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03182879090309143, decouple_loss:0.0018378947861492634
Iteration: 177, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4448418915271759, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44102776050567627, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028787991032004356, decouple_loss:0.001709155854769051
loss_pred:0.031582873314619064, decouple_loss:0.001589293358847499
The modified gen p mean: 0.44478583335876465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029636504128575325, decouple_loss:0.0016298139235004783
Iteration: 178, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44755038619041443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0289799515157938, decouple_loss:0.0019337103003636003
The modified gen p mean: 0.4490891396999359, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028760919347405434, decouple_loss:0.0019139467040076852
The modified gen p mean: 0.4479820728302002, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028816165402531624, decouple_loss:0.0017340229824185371
Iteration: 179, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44657596945762634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030396629124879837, decouple_loss:0.0017268680967390537
The modified gen p mean: 0.4488554298877716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029600920155644417, decouple_loss:0.001711782068014145
The modified gen p mean: 0.44561079144477844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030063506215810776, decouple_loss:0.001926713390275836
Iteration: 180, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509419798851013, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029619447886943817, decouple_loss:0.0018508514622226357
The modified gen p mean: 0.4484562873840332, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029020121321082115, decouple_loss:0.0018298468785360456
The modified gen p mean: 0.44755056500434875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02980799600481987, decouple_loss:0.002104241168126464
2023-05-26 03:49:27 testing...
The modified gen p mean: 0.45308053493499756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033266883343458176, decouple_loss:0.0021104931365698576
The modified gen p mean: 0.45101842284202576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033556997776031494, decouple_loss:0.0019524614326655865
The modified gen p mean: 0.4528161287307739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03493406996130943, decouple_loss:0.0020022643730044365
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.034020405262708664, avg_mse: 0.04618686065077782
current test mse: 0.046187
Iteration: 181, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445330947637558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02938566915690899, decouple_loss:0.0016239655669778585
The modified gen p mean: 0.44797635078430176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030961090698838234, decouple_loss:0.0018617970636114478
The modified gen p mean: 0.44695600867271423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03013824112713337, decouple_loss:0.0019480455666780472
Iteration: 182, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484499990940094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029049577191472054, decouple_loss:0.001910498132929206
The modified gen p mean: 0.4454387426376343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030804801732301712, decouple_loss:0.0018308579456061125
The modified gen p mean: 0.4445784389972687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02880038507282734, decouple_loss:0.001642812043428421
Iteration: 183, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4421246647834778, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031053612008690834, decouple_loss:0.0017592767253518105
The modified gen p mean: 0.4463259279727936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028881778940558434, decouple_loss:0.0023139063268899918
The modified gen p mean: 0.4468100666999817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03106582723557949, decouple_loss:0.0018572283443063498
Iteration: 184, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4435144364833832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03065343387424946, decouple_loss:0.0017533389618620276
The modified gen p mean: 0.4486927092075348, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02814667299389839, decouple_loss:0.002011376665905118
The modified gen p mean: 0.44566649198532104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027989467605948448, decouple_loss:0.002001849003136158
Iteration: 185, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4422318637371063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030362248420715332, decouple_loss:0.0020121620036661625
The modified gen p mean: 0.44367721676826477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030044008046388626, decouple_loss:0.0019135978072881699
The modified gen p mean: 0.44426003098487854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02838483266532421, decouple_loss:0.0018821860430762172
Iteration: 186, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44298627972602844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02862817980349064, decouple_loss:0.001983190421015024
The modified gen p mean: 0.44541406631469727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027864394709467888, decouple_loss:0.002390218200162053
The modified gen p mean: 0.4467499852180481, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029260294511914253, decouple_loss:0.001840477343648672
Iteration: 187, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44234776496887207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03046928346157074, decouple_loss:0.002013019286096096
The modified gen p mean: 0.44301822781562805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03017457015812397, decouple_loss:0.0015992987900972366
The modified gen p mean: 0.44457924365997314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029158905148506165, decouple_loss:0.001813284819945693
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr_shift3.npz
NaN value num: 0
Iteration: 188, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44544458389282227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029329903423786163, decouple_loss:0.00203238264657557
The modified gen p mean: 0.44424599409103394, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4409709870815277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03036695346236229, decouple_loss:0.0021308325231075287
loss_pred:0.030178183689713478, decouple_loss:0.0018254028400406241
Iteration: 189, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4424739181995392, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02831217832863331, decouple_loss:0.0020706902723759413
The modified gen p mean: 0.4442736506462097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02934456244111061, decouple_loss:0.001974155195057392
The modified gen p mean: 0.44369015097618103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030294116586446762, decouple_loss:0.0017116270028054714
Iteration: 190, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476240873336792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029190849512815475, decouple_loss:0.001916541252285242
The modified gen p mean: 0.44385144114494324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027987148612737656, decouple_loss:0.0018455820390954614
The modified gen p mean: 0.44403037428855896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029576892033219337, decouple_loss:0.001813040697015822
2023-05-26 03:54:10 testing...
The modified gen p mean: 0.45037364959716797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03323275223374367, decouple_loss:0.0021158282179385424
The modified gen p mean: 0.448613703250885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03350014239549637, decouple_loss:0.0019041732884943485
The modified gen p mean: 0.45049870014190674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03508885204792023, decouple_loss:0.0019888628739863634
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03404073044657707, avg_mse: 0.0461893230676651
current test mse: 0.046189
Iteration: 191, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464743435382843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029517602175474167, decouple_loss:0.0019260452827438712
The modified gen p mean: 0.44523584842681885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030074050650000572, decouple_loss:0.001721551176160574
The modified gen p mean: 0.4465421438217163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029858818277716637, decouple_loss:0.0019832004327327013
Iteration: 192, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456666111946106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029957542195916176, decouple_loss:0.0017838944913819432
The modified gen p mean: 0.45085570216178894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029558397829532623, decouple_loss:0.0018449064809828997
The modified gen p mean: 0.4498480558395386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029162663966417313, decouple_loss:0.002039387822151184
Iteration: 193, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474528431892395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028522886335849762, decouple_loss:0.0018476187251508236
The modified gen p mean: 0.45241299271583557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02833738550543785, decouple_loss:0.00200501992367208
The modified gen p mean: 0.4504055082798004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027894945815205574, decouple_loss:0.0020286766812205315
Iteration: 194, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473705589771271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02864987961947918, decouple_loss:0.0015832651406526566
The modified gen p mean: 0.447133868932724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03208943083882332, decouple_loss:0.0016199852107092738
The modified gen p mean: 0.44998180866241455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029513772577047348, decouple_loss:0.0017326119123026729
Iteration: 195, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44716042280197144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02983962371945381, decouple_loss:0.0015802303096279502
The modified gen p mean: 0.45424261689186096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02774626575410366, decouple_loss:0.0019100825302302837
The modified gen p mean: 0.4483896791934967, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03059231862425804, decouple_loss:0.0019710250198841095
Iteration: 196, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44988173246383667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029108842834830284, decouple_loss:0.002196068875491619
The modified gen p mean: 0.4481193721294403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030357014387845993, decouple_loss:0.00213033938780427
The modified gen p mean: 0.45217469334602356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029281554743647575, decouple_loss:0.002517290646210313
Iteration: 197, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44765394926071167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028960028663277626, decouple_loss:0.001678314758464694
The modified gen p mean: 0.4472709596157074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029181795194745064, decouple_loss:0.0018810541369020939
The modified gen p mean: 0.447222501039505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029481517150998116, decouple_loss:0.0020089210011065006
Iteration: 198, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471048414707184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029536744579672813, decouple_loss:0.0015944935148581862
The modified gen p mean: 0.4471386671066284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029523832723498344, decouple_loss:0.0019240286201238632
The modified gen p mean: 0.4475860595703125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029611729085445404, decouple_loss:0.001798155251890421
Iteration: 199, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443827271461487, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4443017244338989, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02984546311199665, decouple_loss:0.0018624855438247323
loss_pred:0.029502637684345245, decouple_loss:0.0023229215294122696
The modified gen p mean: 0.4469265937805176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029143113642930984, decouple_loss:0.0019983029924333096
Iteration: 200, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449705570936203, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028537020087242126, decouple_loss:0.0020362206269055605
The modified gen p mean: 0.44621989130973816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028164658695459366, decouple_loss:0.0017138482071459293
The modified gen p mean: 0.45053473114967346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028458287939429283, decouple_loss:0.0019978350028395653
2023-05-26 03:58:16 testing...
The modified gen p mean: 0.45073795318603516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03336934372782707, decouple_loss:0.0020778283942490816
The modified gen p mean: 0.4508017301559448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03540690243244171, decouple_loss:0.0019934524316340685
The modified gen p mean: 0.44878238439559937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03364633396267891, decouple_loss:0.0019095615716651082
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.034240543842315674, avg_mse: 0.04648331180214882
current test mse: 0.046483
Iteration: 201, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44725942611694336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028659401461482048, decouple_loss:0.001982559449970722
The modified gen p mean: 0.44940853118896484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029813319444656372, decouple_loss:0.001984204398468137
The modified gen p mean: 0.45019030570983887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028548413887619972, decouple_loss:0.0021497292909771204
Iteration: 202, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443259835243225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029418526217341423, decouple_loss:0.0016881650080904365
The modified gen p mean: 0.4434165060520172, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02972722053527832, decouple_loss:0.0018179408507421613
The modified gen p mean: 0.4479592442512512, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028559133410453796, decouple_loss:0.0019090735586360097
Iteration: 203, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44676345586776733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030725914984941483, decouple_loss:0.0018357755616307259
The modified gen p mean: 0.4426499605178833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029765047132968903, decouple_loss:0.0020351544953882694
The modified gen p mean: 0.44282183051109314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030776752158999443, decouple_loss:0.001992144389078021
Iteration: 204, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44310134649276733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029054155573248863, decouple_loss:0.0023605655878782272
The modified gen p mean: 0.4503553509712219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028916655108332634, decouple_loss:0.002089440356940031
The modified gen p mean: 0.44375088810920715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027813564985990524, decouple_loss:0.0020462139509618282
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr_shift3.npz
NaN value num: 0
Iteration: 205, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.443040668964386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030174620449543, decouple_loss:0.0018409925978630781
The modified gen p mean: 0.443592369556427, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4433835446834564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029175354167819023, decouple_loss:0.0017767419340088964
loss_pred:0.02854561246931553, decouple_loss:0.0022071588318794966
Iteration: 206, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466015696525574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02887631207704544, decouple_loss:0.0019204507116228342
The modified gen p mean: 0.4461488425731659, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028475070372223854, decouple_loss:0.002255073981359601
The modified gen p mean: 0.4457778334617615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03103412687778473, decouple_loss:0.001744808629155159
Iteration: 207, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457724392414093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02985242009162903, decouple_loss:0.002025018213316798
The modified gen p mean: 0.44526007771492004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029493480920791626, decouple_loss:0.0017000051448121667
The modified gen p mean: 0.4443809390068054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030231738463044167, decouple_loss:0.0016780527075752616
Iteration: 208, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489167034626007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028868544846773148, decouple_loss:0.0018576079746708274
The modified gen p mean: 0.44800129532814026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0290108360350132, decouple_loss:0.00199657934717834
The modified gen p mean: 0.4517018795013428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029088536277413368, decouple_loss:0.001912744715809822
Iteration: 209, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45168566703796387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02838410809636116, decouple_loss:0.0017699103336781263
The modified gen p mean: 0.4518161416053772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028519539162516594, decouple_loss:0.002156853675842285
The modified gen p mean: 0.45165809988975525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029379693791270256, decouple_loss:0.002114770468324423
Iteration: 210, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500029385089874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03058840148150921, decouple_loss:0.0017458818620070815
The modified gen p mean: 0.45315149426460266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02841508388519287, decouple_loss:0.0019462121417745948
The modified gen p mean: 0.4484933912754059, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03011116199195385, decouple_loss:0.0019100806675851345
2023-05-26 04:03:12 testing...
The modified gen p mean: 0.4565463960170746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033703286200761795, decouple_loss:0.0020794307347387075
The modified gen p mean: 0.45449748635292053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033913787454366684, decouple_loss:0.0019370409427210689
The modified gen p mean: 0.4563513994216919, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035799313336610794, decouple_loss:0.002023525768890977
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.034572795033454895, avg_mse: 0.047024574130773544
current test mse: 0.047025
Iteration: 211, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45063522458076477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028822507709264755, decouple_loss:0.0019041248597204685
The modified gen p mean: 0.448683500289917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02941461279988289, decouple_loss:0.0020924429409205914
The modified gen p mean: 0.44801563024520874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02960215136408806, decouple_loss:0.0019990671426057816
Iteration: 212, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44811728596687317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029529210180044174, decouple_loss:0.0017057328950613737
The modified gen p mean: 0.4508604407310486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02912103198468685, decouple_loss:0.0018939034780487418
The modified gen p mean: 0.44924795627593994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02954627387225628, decouple_loss:0.0016796906711533666
Iteration: 213, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479997456073761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030500216409564018, decouple_loss:0.0018574538407847285
The modified gen p mean: 0.4484490752220154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028151772916316986, decouple_loss:0.001979393418878317
The modified gen p mean: 0.4541427195072174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028566693887114525, decouple_loss:0.0021326502319425344
Iteration: 214, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45154669880867004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028854915872216225, decouple_loss:0.0020029323641210794
The modified gen p mean: 0.44677117466926575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02952614240348339, decouple_loss:0.0017591690411791205
The modified gen p mean: 0.4486182928085327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02887227013707161, decouple_loss:0.0025796585250645876
Iteration: 215, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44358932971954346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0288753230124712, decouple_loss:0.0020824014209210873
The modified gen p mean: 0.44952067732810974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027738379314541817, decouple_loss:0.0024238303303718567
The modified gen p mean: 0.4442163109779358, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02945110574364662, decouple_loss:0.002232061931863427
Iteration: 216, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44707125425338745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0284713227301836, decouple_loss:0.0018833994399756193
The modified gen p mean: 0.4464266002178192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027772797271609306, decouple_loss:0.0021048036869615316
The modified gen p mean: 0.4439779222011566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02828032709658146, decouple_loss:0.0020958315581083298
Iteration: 217, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4433937072753906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02912946604192257, decouple_loss:0.0019443078199401498
The modified gen p mean: 0.44842225313186646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027897903695702553, decouple_loss:0.0026167151518166065
The modified gen p mean: 0.4447959363460541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02802073396742344, decouple_loss:0.002044175285845995
Iteration: 218, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4409310221672058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02895784005522728, decouple_loss:0.0017043041298165917
The modified gen p mean: 0.444713294506073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029499001801013947, decouple_loss:0.002357853576540947
The modified gen p mean: 0.4412553310394287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03033064864575863, decouple_loss:0.0016875991132110357
Iteration: 219, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4426318407058716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030411604791879654, decouple_loss:0.0018349901074543595
The modified gen p mean: 0.4442906975746155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028956802561879158, decouple_loss:0.002072140807285905
The modified gen p mean: 0.4411099851131439, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028401292860507965, decouple_loss:0.0017960957484319806
Iteration: 220, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4387974441051483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029100291430950165, decouple_loss:0.0016793104587122798
The modified gen p mean: 0.44595828652381897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02814408950507641, decouple_loss:0.002032775431871414
The modified gen p mean: 0.44009387493133545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02871810458600521, decouple_loss:0.0017284615896642208
2023-05-26 04:07:18 testing...
The modified gen p mean: 0.44871985912323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033679112792015076, decouple_loss:0.002089069690555334
The modified gen p mean: 0.4485769271850586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035845328122377396, decouple_loss:0.0020128244068473577
The modified gen p mean: 0.4466531574726105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03392568603157997, decouple_loss:0.0019870568066835403
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03458486124873161, avg_mse: 0.047087252140045166
current test mse: 0.047087
Iteration: 221, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44266799092292786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02955545112490654, decouple_loss:0.002082468941807747
The modified gen p mean: 0.44126394391059875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0298090111464262, decouple_loss:0.0018180973129346967
The modified gen p mean: 0.44342541694641113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028206510469317436, decouple_loss:0.0020637409761548042
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr.npz
NaN value num: 0
Iteration: 222, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44727396965026855, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44363024830818176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03610201179981232, decouple_loss:0.001966467360034585
loss_pred:0.03636649623513222, decouple_loss:0.0019382935715839267
The modified gen p mean: 0.44497451186180115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03403456509113312, decouple_loss:0.0018375169020146132
Iteration: 223, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44488525390625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034216754138469696, decouple_loss:0.001794905518181622
The modified gen p mean: 0.4487158954143524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035784799605607986, decouple_loss:0.002032529329881072
The modified gen p mean: 0.44640952348709106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0346439853310585, decouple_loss:0.0018596762092784047
Iteration: 224, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505874514579773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03091851994395256, decouple_loss:0.001812818692997098
The modified gen p mean: 0.448067843914032, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0336512066423893, decouple_loss:0.001679976237937808
The modified gen p mean: 0.4507565200328827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03537064790725708, decouple_loss:0.0019414651906117797
Iteration: 225, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45083317160606384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0341285802423954, decouple_loss:0.0017998875118792057
The modified gen p mean: 0.45203155279159546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03354208171367645, decouple_loss:0.0018277546623721719
The modified gen p mean: 0.4519568383693695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03390458971261978, decouple_loss:0.0017454593908041716
Iteration: 226, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45322564244270325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033310968428850174, decouple_loss:0.0017256233841180801
The modified gen p mean: 0.4535267949104309, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03373255953192711, decouple_loss:0.0017128142062574625
The modified gen p mean: 0.45203089714050293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034052323549985886, decouple_loss:0.0018168366514146328
Iteration: 227, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45536187291145325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03338070213794708, decouple_loss:0.0017677095020189881
The modified gen p mean: 0.4540570080280304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033285461366176605, decouple_loss:0.0016732624499127269
The modified gen p mean: 0.45844539999961853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03745850920677185, decouple_loss:0.0018127101939171553
Iteration: 228, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45469430088996887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032933928072452545, decouple_loss:0.0016982208471745253
The modified gen p mean: 0.45505914092063904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03534861281514168, decouple_loss:0.0017208550125360489
The modified gen p mean: 0.4555206000804901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03383280336856842, decouple_loss:0.0018400714034214616
Iteration: 229, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4557131230831146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03236325830221176, decouple_loss:0.0017819360364228487
The modified gen p mean: 0.4533621370792389, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032581593841314316, decouple_loss:0.0018598507158458233
The modified gen p mean: 0.4561510384082794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03654652461409569, decouple_loss:0.0017814376624301076
Iteration: 230, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45216119289398193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034007828682661057, decouple_loss:0.0015629585832357407
The modified gen p mean: 0.45168590545654297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031641505658626556, decouple_loss:0.0015614570584148169
The modified gen p mean: 0.4527190327644348, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033927034586668015, decouple_loss:0.0017598439007997513
2023-05-26 04:12:05 testing...
The modified gen p mean: 0.45473378896713257, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03247813135385513, decouple_loss:0.0017960767727345228
The modified gen p mean: 0.4531554877758026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255336359143257, decouple_loss:0.0017670129891484976
The modified gen p mean: 0.45454275608062744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03381229192018509, decouple_loss:0.0018229722045361996
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0330376997590065, avg_mse: 0.04462477192282677
current test mse: 0.044625
Iteration: 231, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503072202205658, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0335376001894474, decouple_loss:0.0016199719393625855
The modified gen p mean: 0.4490741193294525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03129567578434944, decouple_loss:0.0017268545925617218
The modified gen p mean: 0.4548938572406769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035582222044467926, decouple_loss:0.001676903455518186
Iteration: 232, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44998693466186523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03594307228922844, decouple_loss:0.0018530763918533921
The modified gen p mean: 0.4473748803138733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03437533229589462, decouple_loss:0.001750674215145409
The modified gen p mean: 0.4505578577518463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033881865441799164, decouple_loss:0.0018019534181803465
Iteration: 233, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44651907682418823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03431730717420578, decouple_loss:0.0017412112792953849
The modified gen p mean: 0.4502328634262085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03314689174294472, decouple_loss:0.001714633428491652
The modified gen p mean: 0.4506590664386749, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03390859439969063, decouple_loss:0.0018021672731265426
Iteration: 234, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467470347881317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03222789615392685, decouple_loss:0.0017029084265232086
The modified gen p mean: 0.4458718001842499, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03322412446141243, decouple_loss:0.0016222831327468157
The modified gen p mean: 0.4478698670864105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03501725196838379, decouple_loss:0.0018096130806952715
Iteration: 235, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44615668058395386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03381996974349022, decouple_loss:0.0016707227332517505
The modified gen p mean: 0.4496060609817505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03435099497437477, decouple_loss:0.0017710175598040223
The modified gen p mean: 0.4460291564464569, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03347707912325859, decouple_loss:0.0016122470842674375
Iteration: 236, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45018818974494934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032999634742736816, decouple_loss:0.0015548100927844644
The modified gen p mean: 0.4520537853240967, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03303997963666916, decouple_loss:0.0018294043838977814
The modified gen p mean: 0.44811055064201355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03290347009897232, decouple_loss:0.0016226787120103836
Iteration: 237, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44926589727401733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033215343952178955, decouple_loss:0.001557526527903974
The modified gen p mean: 0.45399951934814453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031005091965198517, decouple_loss:0.001713680918328464
The modified gen p mean: 0.4530271589756012, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0326412171125412, decouple_loss:0.0019089350244030356
Iteration: 238, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4520999789237976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03394097462296486, decouple_loss:0.0018721689702942967
The modified gen p mean: 0.4531910717487335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033041056245565414, decouple_loss:0.001730934251099825
The modified gen p mean: 0.4507177174091339, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03353849798440933, decouple_loss:0.0014819472562521696
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr_shift3.npz
NaN value num: 0
Iteration: 239, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4531515836715698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03080071695148945, decouple_loss:0.0018824436701834202
The modified gen p mean: 0.45272818207740784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03146066889166832, decouple_loss:0.00189004756975919
The modified gen p mean: 0.4514736533164978, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0326087661087513, decouple_loss:0.0016188262961804867
Iteration: 240, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45037856698036194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03258756920695305, decouple_loss:0.001640467206016183
The modified gen p mean: 0.44879284501075745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03035280853509903, decouple_loss:0.0016784821636974812
The modified gen p mean: 0.4492431879043579, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030791906639933586, decouple_loss:0.0019991095177829266
2023-05-26 04:17:02 testing...
The modified gen p mean: 0.4527702033519745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032397616654634476, decouple_loss:0.0017538932152092457
The modified gen p mean: 0.4510015547275543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032585274428129196, decouple_loss:0.001681665307842195
The modified gen p mean: 0.45265915989875793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03380928561091423, decouple_loss:0.0017652936512604356
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03301740810275078, avg_mse: 0.044480711221694946
current test mse: 0.044481
Iteration: 241, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474416673183441, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03224727138876915, decouple_loss:0.0016221227124333382
The modified gen p mean: 0.44620630145072937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031057730317115784, decouple_loss:0.001500295358709991
The modified gen p mean: 0.45002755522727966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03162568435072899, decouple_loss:0.001621394301764667
Iteration: 242, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495072066783905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030055558308959007, decouple_loss:0.001784913009032607
The modified gen p mean: 0.4517053961753845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02910369634628296, decouple_loss:0.0016868662787601352
The modified gen p mean: 0.4449836313724518, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03198960795998573, decouple_loss:0.001563374768011272
Iteration: 243, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455227255821228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031004011631011963, decouple_loss:0.0017406934639438987
The modified gen p mean: 0.4446049928665161, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03126630187034607, decouple_loss:0.0015257757622748613
The modified gen p mean: 0.4477894902229309, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029848763719201088, decouple_loss:0.001754205790348351
Iteration: 244, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44929489493370056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030749833211302757, decouple_loss:0.001627108664251864
The modified gen p mean: 0.4427695870399475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028741557151079178, decouple_loss:0.001686622155830264
The modified gen p mean: 0.4447268843650818, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03227772191166878, decouple_loss:0.0017191380029544234
Iteration: 245, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44704562425613403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031223760917782784, decouple_loss:0.001711449003778398
The modified gen p mean: 0.4444631040096283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029614215716719627, decouple_loss:0.0018520994344726205
The modified gen p mean: 0.4441644847393036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03148288652300835, decouple_loss:0.0019835452549159527
Iteration: 246, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476320743560791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03205521032214165, decouple_loss:0.0017387440893799067
The modified gen p mean: 0.44769570231437683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030068019405007362, decouple_loss:0.0016411272808909416
The modified gen p mean: 0.44331610202789307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03148311749100685, decouple_loss:0.0017311475239694118
Iteration: 247, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44772109389305115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030965430662035942, decouple_loss:0.0017835277831181884
The modified gen p mean: 0.4450574517250061, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02979215607047081, decouple_loss:0.0017149756895378232
The modified gen p mean: 0.44833311438560486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030058225616812706, decouple_loss:0.0018083829199895263
Iteration: 248, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499090909957886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029983393847942352, decouple_loss:0.0020112942438572645
The modified gen p mean: 0.44996389746665955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031154906377196312, decouple_loss:0.002027419861406088
The modified gen p mean: 0.4461711347103119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03016510047018528, decouple_loss:0.002020264742895961
Iteration: 249, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534913897514343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029164068400859833, decouple_loss:0.0019846383947879076
The modified gen p mean: 0.4545246362686157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027875294908881187, decouple_loss:0.0016957828775048256
The modified gen p mean: 0.44812890887260437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03070785105228424, decouple_loss:0.0019471598789095879
Iteration: 250, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45121610164642334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029929352924227715, decouple_loss:0.0018346599536016583
The modified gen p mean: 0.45464736223220825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028536543250083923, decouple_loss:0.0021110433153808117
The modified gen p mean: 0.44707033038139343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030480850487947464, decouple_loss:0.0017093165079131722
2023-05-26 04:21:08 testing...
The modified gen p mean: 0.45494744181632996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251940384507179, decouple_loss:0.0019431934924796224
The modified gen p mean: 0.4530021548271179, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03302633389830589, decouple_loss:0.0018696744227781892
The modified gen p mean: 0.45455843210220337, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03423647955060005, decouple_loss:0.002025604248046875
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03335804492235184, avg_mse: 0.045030925422906876
current test mse: 0.045031
Iteration: 251, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45360496640205383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02940942533314228, decouple_loss:0.0017356136813759804
The modified gen p mean: 0.45251449942588806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03055376186966896, decouple_loss:0.0020754782017320395
The modified gen p mean: 0.44802185893058777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031063921749591827, decouple_loss:0.0016827883664518595
Iteration: 252, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45362091064453125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030057087540626526, decouple_loss:0.0023292500991374254
The modified gen p mean: 0.44664624333381653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03007909096777439, decouple_loss:0.0023007262498140335
The modified gen p mean: 0.45080995559692383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03078520856797695, decouple_loss:0.0020790945272892714
Iteration: 253, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44682377576828003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030703105032444, decouple_loss:0.0017827460542321205
The modified gen p mean: 0.44849979877471924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028752481564879417, decouple_loss:0.002298074308782816
The modified gen p mean: 0.44672393798828125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03070945106446743, decouple_loss:0.0020783967338502407
Iteration: 254, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44463908672332764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029838407412171364, decouple_loss:0.002145264996215701
The modified gen p mean: 0.4457817077636719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027874169871211052, decouple_loss:0.001894683693535626
The modified gen p mean: 0.4489917755126953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02891295589506626, decouple_loss:0.002008159412071109
Iteration: 255, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44684699177742004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03015427477657795, decouple_loss:0.0019140270305797458
The modified gen p mean: 0.4447941184043884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030647991225123405, decouple_loss:0.0019231911282986403
The modified gen p mean: 0.446904718875885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027323730289936066, decouple_loss:0.002088300883769989
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr_shift3.npz
NaN value num: 0
Iteration: 256, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444579541683197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031783733516931534, decouple_loss:0.0018737369682639837
The modified gen p mean: 0.44862204790115356, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4475863575935364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03289215639233589, decouple_loss:0.0018784040585160255
loss_pred:0.03384114429354668, decouple_loss:0.001837660325691104
Iteration: 257, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44845741987228394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03301888331770897, decouple_loss:0.001863962854258716
The modified gen p mean: 0.4436481297016144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03182920068502426, decouple_loss:0.0018671563593670726
The modified gen p mean: 0.44857949018478394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03447636961936951, decouple_loss:0.002093910938128829
Iteration: 258, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44516363739967346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03421168401837349, decouple_loss:0.0018977823201566935
The modified gen p mean: 0.44949421286582947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032526254653930664, decouple_loss:0.001798184821382165
The modified gen p mean: 0.4461215138435364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03347655385732651, decouple_loss:0.0018509457586333156
Iteration: 259, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468182325363159, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033075470477342606, decouple_loss:0.0019472005078569055
The modified gen p mean: 0.44402316212654114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03349410742521286, decouple_loss:0.001920219394378364
The modified gen p mean: 0.4460548758506775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03322620689868927, decouple_loss:0.0017895892960950732
Iteration: 260, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45139849185943604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03319604694843292, decouple_loss:0.0017834091559052467
The modified gen p mean: 0.44839489459991455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033755119889974594, decouple_loss:0.0017877117497846484
The modified gen p mean: 0.4488353431224823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034377969801425934, decouple_loss:0.0017721615731716156
2023-05-26 04:25:51 testing...
The modified gen p mean: 0.45524996519088745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03263908624649048, decouple_loss:0.001987644238397479
The modified gen p mean: 0.4533545672893524, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45463961362838745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032996539026498795, decouple_loss:0.0018789231544360518
loss_pred:0.03448285534977913, decouple_loss:0.0020356690511107445
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03347119688987732, avg_mse: 0.04523002728819847
current test mse: 0.04523
Iteration: 261, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493180513381958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03165220096707344, decouple_loss:0.001733917510136962
The modified gen p mean: 0.44866010546684265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032150235027074814, decouple_loss:0.001890029525384307
The modified gen p mean: 0.4538993239402771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251498192548752, decouple_loss:0.0019332801457494497
Iteration: 262, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45417430996894836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03290830925107002, decouple_loss:0.0018971521640196443
The modified gen p mean: 0.4512802064418793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03204174339771271, decouple_loss:0.0017860723892226815
The modified gen p mean: 0.4524773955345154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03447272256016731, decouple_loss:0.001864273683167994
Iteration: 263, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4571673572063446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032415762543678284, decouple_loss:0.0018348515732213855
The modified gen p mean: 0.4575571119785309, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03379107266664505, decouple_loss:0.001814208342693746
The modified gen p mean: 0.4517679810523987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03361032158136368, decouple_loss:0.0016776657430455089
Iteration: 264, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4531627893447876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03211236372590065, decouple_loss:0.001827745232731104
The modified gen p mean: 0.45170319080352783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03217513859272003, decouple_loss:0.0016961313085630536
The modified gen p mean: 0.4532269835472107, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034168098121881485, decouple_loss:0.001658843015320599
Iteration: 265, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4565006494522095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034407444298267365, decouple_loss:0.0016966150142252445
The modified gen p mean: 0.452811598777771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03177899122238159, decouple_loss:0.0018120089080184698
The modified gen p mean: 0.4572749137878418, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03287964314222336, decouple_loss:0.0016086908290162683
Iteration: 266, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45607319474220276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03365509212017059, decouple_loss:0.0016610126476734877
The modified gen p mean: 0.456711083650589, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031138960272073746, decouple_loss:0.00171008356846869
The modified gen p mean: 0.45526090264320374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03167730197310448, decouple_loss:0.0019113788148388267
Iteration: 267, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45220646262168884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03252171725034714, decouple_loss:0.001785204280167818
The modified gen p mean: 0.4521584212779999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033185847103595734, decouple_loss:0.0017076467629522085
The modified gen p mean: 0.4529479742050171, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03324265778064728, decouple_loss:0.0017451215535402298
Iteration: 268, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44996196031570435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03211985155940056, decouple_loss:0.0016158146318048239
The modified gen p mean: 0.44999709725379944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032856330275535583, decouple_loss:0.0015596946468576789
The modified gen p mean: 0.4517382085323334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03237031400203705, decouple_loss:0.00161270413082093
Iteration: 269, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44690269231796265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03405233100056648, decouple_loss:0.001722644199617207
The modified gen p mean: 0.4476122558116913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03226494789123535, decouple_loss:0.0017665692139416933
The modified gen p mean: 0.4459335505962372, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033064741641283035, decouple_loss:0.0016240908298641443
Iteration: 270, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468596577644348, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032629236578941345, decouple_loss:0.001658766996115446
The modified gen p mean: 0.44413134455680847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032653648406267166, decouple_loss:0.0016048249090090394
The modified gen p mean: 0.44852784276008606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03179654851555824, decouple_loss:0.0019024686189368367
2023-05-26 04:29:58 testing...
The modified gen p mean: 0.4500797986984253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03226407989859581, decouple_loss:0.0019010012038052082
The modified gen p mean: 0.4485153555870056, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44983091950416565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246241807937622, decouple_loss:0.0018122916808351874
loss_pred:0.03384967893362045, decouple_loss:0.001852036570198834
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0329514816403389, avg_mse: 0.0444081611931324
current test mse: 0.044408
Iteration: 271, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478878974914551, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031689513474702835, decouple_loss:0.0017406903207302094
The modified gen p mean: 0.44737473130226135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032748982310295105, decouple_loss:0.0018538536969572306
The modified gen p mean: 0.44599780440330505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03235659748315811, decouple_loss:0.0017246996285393834
Iteration: 272, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462852478027344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032917238771915436, decouple_loss:0.0016976993065327406
The modified gen p mean: 0.44374215602874756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03312930092215538, decouple_loss:0.0015841012354940176
The modified gen p mean: 0.44438764452934265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032686177641153336, decouple_loss:0.0016960303764790297
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr_shift3.npz
NaN value num: 0
Iteration: 273, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495806097984314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030129728838801384, decouple_loss:0.001765388180501759
The modified gen p mean: 0.44555434584617615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030533291399478912, decouple_loss:0.0016388454241678119
The modified gen p mean: 0.44842755794525146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029396604746580124, decouple_loss:0.0017905790591612458
Iteration: 274, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478556513786316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030146997421979904, decouple_loss:0.001582972938194871
The modified gen p mean: 0.44865188002586365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030813172459602356, decouple_loss:0.0019441162003204226
The modified gen p mean: 0.44717055559158325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03045019507408142, decouple_loss:0.0016771535156294703
Iteration: 275, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469301104545593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030751382932066917, decouple_loss:0.0018344420241191983
The modified gen p mean: 0.4454194903373718, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031285692006349564, decouple_loss:0.0016860268078744411
The modified gen p mean: 0.45106014609336853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029032107442617416, decouple_loss:0.001596006564795971
Iteration: 276, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446403443813324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029338769614696503, decouple_loss:0.0018359590321779251
The modified gen p mean: 0.4452226161956787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029618525877594948, decouple_loss:0.0017697145231068134
The modified gen p mean: 0.44904807209968567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029897693544626236, decouple_loss:0.0017147082835435867
Iteration: 277, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493536055088043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028928199782967567, decouple_loss:0.0017775140004232526
The modified gen p mean: 0.4441273808479309, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02984299696981907, decouple_loss:0.0016180172096937895
The modified gen p mean: 0.44846057891845703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028971603140234947, decouple_loss:0.0018924459582194686
Iteration: 278, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4425472617149353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02978634275496006, decouple_loss:0.0016006582882255316
The modified gen p mean: 0.4428175389766693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030199985951185226, decouple_loss:0.0018954428378492594
The modified gen p mean: 0.4436326324939728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02966604195535183, decouple_loss:0.0020075931679457426
Iteration: 279, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443758428096771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03066050074994564, decouple_loss:0.0015637322794646025
The modified gen p mean: 0.4479636251926422, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028247017413377762, decouple_loss:0.001699588494375348
The modified gen p mean: 0.4466875195503235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03002876602113247, decouple_loss:0.0016022545751184225
Iteration: 280, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44683921337127686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030772412195801735, decouple_loss:0.0016532883746549487
The modified gen p mean: 0.45045095682144165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028229426592588425, decouple_loss:0.00188102584797889
The modified gen p mean: 0.4508737027645111, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02980894409120083, decouple_loss:0.0017661101883277297
2023-05-26 04:34:45 testing...
The modified gen p mean: 0.4507979452610016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03241578862071037, decouple_loss:0.001851062523201108
The modified gen p mean: 0.44917237758636475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03268326073884964, decouple_loss:0.0018045114120468497
The modified gen p mean: 0.4504919648170471, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034088876098394394, decouple_loss:0.0019039969192817807
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033155303448438644, avg_mse: 0.0446283333003521
current test mse: 0.044628
Iteration: 281, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4440612494945526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02948465570807457, decouple_loss:0.00160590757150203
The modified gen p mean: 0.4457177221775055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030567238107323647, decouple_loss:0.0018826652085408568
The modified gen p mean: 0.44709286093711853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029909588396549225, decouple_loss:0.001755560515448451
Iteration: 282, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45138782262802124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028999529778957367, decouple_loss:0.0021611235570162535
The modified gen p mean: 0.44638222455978394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029001882299780846, decouple_loss:0.0018422683933749795
The modified gen p mean: 0.4448258876800537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029639508575201035, decouple_loss:0.0017973344074562192
Iteration: 283, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450213611125946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028716785833239555, decouple_loss:0.0017730152467265725
The modified gen p mean: 0.44563937187194824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029574481770396233, decouple_loss:0.0018559283344075084
The modified gen p mean: 0.4446524977684021, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02923762798309326, decouple_loss:0.0017532906495034695
Iteration: 284, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463356137275696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031295295804739, decouple_loss:0.0017897705547511578
The modified gen p mean: 0.4507835805416107, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02838611789047718, decouple_loss:0.0018693215679377317
The modified gen p mean: 0.4465497136116028, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03054298833012581, decouple_loss:0.0019339002901688218
Iteration: 285, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44868046045303345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029577696695923805, decouple_loss:0.002017433289438486
The modified gen p mean: 0.45094478130340576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02947559580206871, decouple_loss:0.0018593167187646031
The modified gen p mean: 0.45133233070373535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029434403404593468, decouple_loss:0.0022361206356436014
Iteration: 286, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44986259937286377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029650019481778145, decouple_loss:0.0021493532694876194
The modified gen p mean: 0.4500473439693451, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029933637008070946, decouple_loss:0.001926502794958651
The modified gen p mean: 0.4492608904838562, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029555929824709892, decouple_loss:0.001995270373299718
Iteration: 287, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44737696647644043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02872144803404808, decouple_loss:0.0017558189574629068
The modified gen p mean: 0.4511578381061554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028983697295188904, decouple_loss:0.0017792468424886465
The modified gen p mean: 0.45161789655685425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029136115685105324, decouple_loss:0.0017427944112569094
Iteration: 288, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45086783170700073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029098784551024437, decouple_loss:0.001884615863673389
The modified gen p mean: 0.45102453231811523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029312968254089355, decouple_loss:0.0018003986915573478
The modified gen p mean: 0.44678744673728943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030901972204446793, decouple_loss:0.0016902284696698189
Iteration: 289, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476067125797272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030342312529683113, decouple_loss:0.002041530329734087
The modified gen p mean: 0.45180976390838623, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02939751371741295, decouple_loss:0.002013091230764985
The modified gen p mean: 0.4480929970741272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030676139518618584, decouple_loss:0.0017418904462829232
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr.npz
NaN value num: 0
Iteration: 290, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44450196623802185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03068714775145054, decouple_loss:0.0018837448442354798
The modified gen p mean: 0.45397353172302246, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4468085467815399, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03106635808944702, decouple_loss:0.002000529784709215loss_pred:0.03017313778400421, decouple_loss:0.001635165885090828
2023-05-26 04:39:32 testing...
The modified gen p mean: 0.45170077681541443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033009521663188934, decouple_loss:0.0020003938116133213
The modified gen p mean: 0.45109811425209045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034841157495975494, decouple_loss:0.0020835967734456062
The modified gen p mean: 0.44989845156669617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033413417637348175, decouple_loss:0.0019160377560183406
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03385470435023308, avg_mse: 0.04585070535540581
current test mse: 0.045851
Iteration: 291, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44981661438941956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029812512919306755, decouple_loss:0.00207459251396358
The modified gen p mean: 0.44712069630622864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031737275421619415, decouple_loss:0.001777906552888453
The modified gen p mean: 0.44521716237068176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03214385360479355, decouple_loss:0.0018342288676649332
Iteration: 292, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4433375298976898, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030213192105293274, decouple_loss:0.0018616640008985996
The modified gen p mean: 0.4491899311542511, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029625503346323967, decouple_loss:0.0021692996378988028
The modified gen p mean: 0.4432050287723541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030215652659535408, decouple_loss:0.0022436268627643585
Iteration: 293, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464729130268097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030628932639956474, decouple_loss:0.001977998996153474
The modified gen p mean: 0.4428711533546448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029809793457388878, decouple_loss:0.0018161401385441422
The modified gen p mean: 0.4463624656200409, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029747826978564262, decouple_loss:0.002040658611804247
Iteration: 294, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444964826107025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028745371848344803, decouple_loss:0.00194179464597255
The modified gen p mean: 0.4442228078842163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029210643842816353, decouple_loss:0.0019088649423792958
The modified gen p mean: 0.443333238363266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02895498462021351, decouple_loss:0.0018436849350109696
Iteration: 295, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44144344329833984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030113965272903442, decouple_loss:0.002135586692020297
The modified gen p mean: 0.4419824182987213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028849607333540916, decouple_loss:0.0018734182231128216
The modified gen p mean: 0.4426993131637573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03086751326918602, decouple_loss:0.0017735681030899286
Iteration: 296, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475283622741699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029462048783898354, decouple_loss:0.0020071472972631454
The modified gen p mean: 0.44278186559677124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02997240424156189, decouple_loss:0.0017635822296142578
The modified gen p mean: 0.4427793025970459, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03005760721862316, decouple_loss:0.0018337086075916886
Iteration: 297, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468075633049011, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029470568522810936, decouple_loss:0.0021755683701485395
The modified gen p mean: 0.44930243492126465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028780991211533546, decouple_loss:0.0019309476483613253
The modified gen p mean: 0.4459177851676941, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028816286474466324, decouple_loss:0.0021435676608234644
Iteration: 298, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513152539730072, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028897657990455627, decouple_loss:0.002152420813217759
The modified gen p mean: 0.4467921555042267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029585309326648712, decouple_loss:0.0019597557839006186
The modified gen p mean: 0.4468478262424469, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028966862708330154, decouple_loss:0.0017771029379218817
Iteration: 299, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468979239463806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028318751603364944, decouple_loss:0.0020759415347129107
The modified gen p mean: 0.4479142427444458, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02904677577316761, decouple_loss:0.001969026867300272
The modified gen p mean: 0.4454083740711212, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029266851022839546, decouple_loss:0.0018458687700331211
Iteration: 300, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4521191716194153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028648272156715393, decouple_loss:0.002019536215811968
The modified gen p mean: 0.4516511559486389, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027502762153744698, decouple_loss:0.0025053177960217
The modified gen p mean: 0.44539162516593933, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028867261484265327, decouple_loss:0.0019400932360440493
2023-05-26 04:43:38 testing...
The modified gen p mean: 0.4540843665599823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0329902283847332, decouple_loss:0.001995970495045185
The modified gen p mean: 0.45198214054107666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03308158367872238, decouple_loss:0.0019136246992275119
The modified gen p mean: 0.45369309186935425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03446890413761139, decouple_loss:0.0019697463139891624
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033611562103033066, avg_mse: 0.04560699686408043
current test mse: 0.045607
Iteration: 301, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492739737033844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028858669102191925, decouple_loss:0.0019010830437764525
The modified gen p mean: 0.4487415552139282, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029205674305558205, decouple_loss:0.0017832667799666524
The modified gen p mean: 0.45136940479278564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0289821308106184, decouple_loss:0.0019102031365036964
Iteration: 302, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45092442631721497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02807159349322319, decouple_loss:0.0019042094936594367
The modified gen p mean: 0.4468706250190735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028910575434565544, decouple_loss:0.0018362486734986305
The modified gen p mean: 0.44815346598625183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0307602658867836, decouple_loss:0.002015250502154231
Iteration: 303, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519965648651123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029097579419612885, decouple_loss:0.0019258197862654924
The modified gen p mean: 0.44704246520996094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029571736231446266, decouple_loss:0.002032971242442727
The modified gen p mean: 0.45025521516799927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028872154653072357, decouple_loss:0.0019086175598204136
Iteration: 304, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45080944895744324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722165547311306, decouple_loss:0.0019111944129690528
The modified gen p mean: 0.44679024815559387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02957223355770111, decouple_loss:0.0019234929932281375
The modified gen p mean: 0.4527967870235443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029156308621168137, decouple_loss:0.0025964435189962387
Iteration: 305, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444969117641449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028651650995016098, decouple_loss:0.001769430236890912
The modified gen p mean: 0.4522647261619568, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02902805246412754, decouple_loss:0.001865450874902308
The modified gen p mean: 0.4458690285682678, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028598321601748466, decouple_loss:0.0016708143521100283
Iteration: 306, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518556296825409, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02969270944595337, decouple_loss:0.001986281480640173
The modified gen p mean: 0.45176592469215393, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029357200488448143, decouple_loss:0.002148133236914873
The modified gen p mean: 0.4466947019100189, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029124626889824867, decouple_loss:0.0016792735550552607
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr.npz
NaN value num: 0
Iteration: 307, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456142485141754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028655415400862694, decouple_loss:0.0016510640271008015
The modified gen p mean: 0.4457865357398987, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4486221671104431, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027886446565389633, decouple_loss:0.0017792335711419582
loss_pred:0.027955830097198486, decouple_loss:0.0021174883004277945
Iteration: 308, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44780421257019043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027572501450777054, decouple_loss:0.001784832333214581
The modified gen p mean: 0.44745492935180664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027997873723506927, decouple_loss:0.001825341023504734
The modified gen p mean: 0.44713565707206726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02691982313990593, decouple_loss:0.0019004856003448367
Iteration: 309, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44535043835639954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027934905141592026, decouple_loss:0.0017413023160770535
The modified gen p mean: 0.448465496301651, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02746063657104969, decouple_loss:0.002072731964290142
The modified gen p mean: 0.44719043374061584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02780291624367237, decouple_loss:0.0020667766220867634
Iteration: 310, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451673626899719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02793855220079422, decouple_loss:0.001651976490393281
The modified gen p mean: 0.4444631338119507, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027989793568849564, decouple_loss:0.001786850392818451
The modified gen p mean: 0.4505006968975067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027668675407767296, decouple_loss:0.0019509519916027784
2023-05-26 04:48:31 testing...
The modified gen p mean: 0.45234960317611694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032989099621772766, decouple_loss:0.0019372791284695268
The modified gen p mean: 0.4520411491394043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03443607687950134, decouple_loss:0.001920724636875093
The modified gen p mean: 0.4501200020313263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03312648832798004, decouple_loss:0.0018210315611213446
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03361187130212784, avg_mse: 0.045517340302467346
current test mse: 0.045517
Iteration: 311, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442071318626404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028682280331850052, decouple_loss:0.0017478783847764134
The modified gen p mean: 0.45156705379486084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026910604909062386, decouple_loss:0.002216467633843422
The modified gen p mean: 0.44572558999061584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027992548421025276, decouple_loss:0.00197613169439137
Iteration: 312, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44801971316337585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027480125427246094, decouple_loss:0.002091201487928629
The modified gen p mean: 0.44726046919822693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02707868069410324, decouple_loss:0.0018347763689234853
The modified gen p mean: 0.44463270902633667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027295995503664017, decouple_loss:0.001908747712150216
Iteration: 313, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445625901222229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02788463979959488, decouple_loss:0.0017887726426124573
The modified gen p mean: 0.4433005154132843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0275352131575346, decouple_loss:0.0017104344442486763
The modified gen p mean: 0.44290950894355774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02744324877858162, decouple_loss:0.0017300822073593736
Iteration: 314, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44548898935317993, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02896169014275074, decouple_loss:0.0017400250071659684
The modified gen p mean: 0.4450884461402893, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02618350274860859, decouple_loss:0.0021645119413733482
The modified gen p mean: 0.44278934597969055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029000775888562202, decouple_loss:0.0018376604421064258
Iteration: 315, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444822072982788, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028897762298583984, decouple_loss:0.0017800640780478716
The modified gen p mean: 0.4485156238079071, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026606859639286995, decouple_loss:0.0017813508166000247
The modified gen p mean: 0.4454416334629059, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02781199850142002, decouple_loss:0.0016691593918949366
Iteration: 316, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44568538665771484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02671915479004383, decouple_loss:0.0018318848451599479
The modified gen p mean: 0.4435378909111023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026611780747771263, decouple_loss:0.0017112622736021876
The modified gen p mean: 0.4469669461250305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027088798582553864, decouple_loss:0.002201196039095521
Iteration: 317, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44479915499687195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02793940342962742, decouple_loss:0.0019261980196461082
The modified gen p mean: 0.4482883810997009, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027213694527745247, decouple_loss:0.002012380864471197
The modified gen p mean: 0.44441327452659607, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02850726991891861, decouple_loss:0.0018209338886663318
Iteration: 318, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452754259109497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027343204244971275, decouple_loss:0.0017124296864494681
The modified gen p mean: 0.4499616324901581, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02764139510691166, decouple_loss:0.0019090890418738127
The modified gen p mean: 0.44901540875434875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026663195341825485, decouple_loss:0.0017231351230293512
Iteration: 319, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441203474998474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027867237105965614, decouple_loss:0.0021157225128263235
The modified gen p mean: 0.44995978474617004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026222629472613335, decouple_loss:0.0018638886976987123
The modified gen p mean: 0.44626688957214355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02776237577199936, decouple_loss:0.0017450168961659074
Iteration: 320, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44638726115226746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02765834331512451, decouple_loss:0.0016274835215881467
The modified gen p mean: 0.44449207186698914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02809593640267849, decouple_loss:0.001729763695038855
The modified gen p mean: 0.4438914656639099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027815192937850952, decouple_loss:0.0019089755369350314
2023-05-26 04:52:40 testing...
The modified gen p mean: 0.45244917273521423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03308521583676338, decouple_loss:0.0019998715724796057
The modified gen p mean: 0.4502101540565491, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033164579421281815, decouple_loss:0.0018931139493361115
The modified gen p mean: 0.45218539237976074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03442633897066116, decouple_loss:0.001998805208131671
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03365691006183624, avg_mse: 0.04574646055698395
current test mse: 0.045746
Iteration: 321, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44578880071640015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02693750336766243, decouple_loss:0.001924791606143117
The modified gen p mean: 0.4456409513950348, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027255646884441376, decouple_loss:0.0018711257725954056
The modified gen p mean: 0.4494704604148865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02706020697951317, decouple_loss:0.0017919567180797458
Iteration: 322, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444183349609375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026893863454461098, decouple_loss:0.0017061830731108785
The modified gen p mean: 0.4494909346103668, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0270247682929039, decouple_loss:0.0021946262568235397
The modified gen p mean: 0.4464791417121887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02702682465314865, decouple_loss:0.0017522717826068401
Iteration: 323, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45077934861183167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026540327817201614, decouple_loss:0.001979358261451125
The modified gen p mean: 0.44756385684013367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027055591344833374, decouple_loss:0.0019259671680629253
The modified gen p mean: 0.4463001787662506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026569761335849762, decouple_loss:0.00233670137822628
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr_shift3.npz
NaN value num: 0
Iteration: 324, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513656198978424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030853191390633583, decouple_loss:0.001938781701028347
The modified gen p mean: 0.44469380378723145, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488274157047272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031682338565588, decouple_loss:0.0016228616004809737
loss_pred:0.030325425788760185, decouple_loss:0.0017532468773424625
Iteration: 325, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487839341163635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03234606981277466, decouple_loss:0.0016973952297121286
The modified gen p mean: 0.4488677382469177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030262989923357964, decouple_loss:0.0017787957331165671
The modified gen p mean: 0.45189931988716125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031235983595252037, decouple_loss:0.001732896314933896
Iteration: 326, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45281416177749634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030731908977031708, decouple_loss:0.0017108843894675374
The modified gen p mean: 0.45215070247650146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030056485906243324, decouple_loss:0.001912784529849887
The modified gen p mean: 0.45220011472702026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03045349195599556, decouple_loss:0.001951452111825347
Iteration: 327, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45074090361595154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03010897897183895, decouple_loss:0.0019550039432942867
The modified gen p mean: 0.4497862458229065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030036423355340958, decouple_loss:0.00205631204880774
The modified gen p mean: 0.4532619118690491, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029890742152929306, decouple_loss:0.0017809756100177765
Iteration: 328, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494723379611969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03127617761492729, decouple_loss:0.001946364645846188
The modified gen p mean: 0.4553530216217041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031495559960603714, decouple_loss:0.0017797686159610748
The modified gen p mean: 0.4520546793937683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030735498294234276, decouple_loss:0.0016667642630636692
Iteration: 329, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4587465524673462, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03175889328122139, decouple_loss:0.0017656830605119467
The modified gen p mean: 0.4536804258823395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030712822452187538, decouple_loss:0.0018836611416190863
The modified gen p mean: 0.4540000557899475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031093193218111992, decouple_loss:0.0016987989656627178
Iteration: 330, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4564664661884308, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029832685366272926, decouple_loss:0.0019519553752616048
The modified gen p mean: 0.4558562636375427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029820695519447327, decouple_loss:0.0017801442882046103
The modified gen p mean: 0.45197978615760803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030904822051525116, decouple_loss:0.0019120952347293496
2023-05-26 04:57:27 testing...
The modified gen p mean: 0.45552775263786316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03266851231455803, decouple_loss:0.0018679542699828744
The modified gen p mean: 0.45333483815193176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03290354833006859, decouple_loss:0.0017524821450933814
The modified gen p mean: 0.4550080895423889, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03429248183965683, decouple_loss:0.0018743460532277822
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03337976336479187, avg_mse: 0.04509376734495163
current test mse: 0.045094
Iteration: 331, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4535147249698639, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030110491439700127, decouple_loss:0.00168383598793298
The modified gen p mean: 0.4508523941040039, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030553963035345078, decouple_loss:0.0017949617467820644
The modified gen p mean: 0.44913139939308167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0312771312892437, decouple_loss:0.0016603823751211166
Iteration: 332, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534546732902527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031153185293078423, decouple_loss:0.0016296220710501075
The modified gen p mean: 0.45311239361763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030367273837327957, decouple_loss:0.001846756087616086
The modified gen p mean: 0.4495355486869812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02994956076145172, decouple_loss:0.0018024839228019118
Iteration: 333, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44794514775276184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029155490919947624, decouple_loss:0.0017194346291944385
The modified gen p mean: 0.4464837610721588, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030400171875953674, decouple_loss:0.0019217963563278317
The modified gen p mean: 0.44721555709838867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031671274453401566, decouple_loss:0.0017126398161053658
Iteration: 334, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467196464538574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03219378739595413, decouple_loss:0.0018130624666810036
The modified gen p mean: 0.44728001952171326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0296926386654377, decouple_loss:0.0018486710032448173
The modified gen p mean: 0.44775426387786865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029569292441010475, decouple_loss:0.002001385670155287
Iteration: 335, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44887301325798035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02985725924372673, decouple_loss:0.0017701374599710107
The modified gen p mean: 0.4468940794467926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031663842499256134, decouple_loss:0.0018713311292231083
The modified gen p mean: 0.44766098260879517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029866883531212807, decouple_loss:0.001932159997522831
Iteration: 336, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461832642555237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03117045760154724, decouple_loss:0.0016836946597322822
The modified gen p mean: 0.44442352652549744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030424688011407852, decouple_loss:0.0016750996001064777
The modified gen p mean: 0.44616925716400146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02966178022325039, decouple_loss:0.0018536391435191035
Iteration: 337, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44732463359832764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029345013201236725, decouple_loss:0.0018723767716437578
The modified gen p mean: 0.4486425220966339, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029802925884723663, decouple_loss:0.0017557734390720725
The modified gen p mean: 0.4528726637363434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030050471425056458, decouple_loss:0.0018360139802098274
Iteration: 338, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448683500289917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029858063906431198, decouple_loss:0.0018357306253165007
The modified gen p mean: 0.4447402358055115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029466968029737473, decouple_loss:0.0018733348697423935
The modified gen p mean: 0.4511174261569977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030147753655910492, decouple_loss:0.0017664394108578563
Iteration: 339, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44687071442604065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030790437012910843, decouple_loss:0.0016535331960767508
The modified gen p mean: 0.4494737386703491, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030636996030807495, decouple_loss:0.001814910676330328
The modified gen p mean: 0.44723838567733765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029525399208068848, decouple_loss:0.001979503547772765
Iteration: 340, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474917948246002, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03151555731892586, decouple_loss:0.0019429824315011501
The modified gen p mean: 0.452752947807312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030625391751527786, decouple_loss:0.0019789235666394234
The modified gen p mean: 0.45073381066322327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02840246818959713, decouple_loss:0.001753946766257286
2023-05-26 05:01:36 testing...
The modified gen p mean: 0.45442163944244385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283006325364113, decouple_loss:0.0019324630266055465
The modified gen p mean: 0.4520213007926941, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033413778990507126, decouple_loss:0.001827759901061654
The modified gen p mean: 0.4535251259803772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034612078219652176, decouple_loss:0.0020702765323221684
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03371581807732582, avg_mse: 0.0454808734357357
current test mse: 0.045481
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr_shift3.npz
NaN value num: 0
Iteration: 341, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45234575867652893, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030896032229065895, decouple_loss:0.0020403489470481873
The modified gen p mean: 0.4511951208114624, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4497360289096832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030378291383385658, decouple_loss:0.002324059372767806
loss_pred:0.028369871899485588, decouple_loss:0.0017748679965734482
Iteration: 342, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4531404674053192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02893446758389473, decouple_loss:0.0018829239998012781
The modified gen p mean: 0.448321670293808, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02932853251695633, decouple_loss:0.0017327647656202316
The modified gen p mean: 0.44950297474861145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0287797749042511, decouple_loss:0.0024252701550722122
Iteration: 343, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501235783100128, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03059370070695877, decouple_loss:0.0019302370492368937
The modified gen p mean: 0.448973149061203, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028047535568475723, decouple_loss:0.001818751567043364
The modified gen p mean: 0.44716042280197144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028956089168787003, decouple_loss:0.002250519348308444
Iteration: 344, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45241934061050415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028822168707847595, decouple_loss:0.0021045440807938576
The modified gen p mean: 0.4479374289512634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029080498963594437, decouple_loss:0.0020876508206129074
The modified gen p mean: 0.4477046728134155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028953880071640015, decouple_loss:0.001907866564579308
Iteration: 345, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44559887051582336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029907889664173126, decouple_loss:0.0019101491197943687
The modified gen p mean: 0.4450051188468933, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0297186691313982, decouple_loss:0.0022992664016783237
The modified gen p mean: 0.44967541098594666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030572526156902313, decouple_loss:0.0020904731936752796
Iteration: 346, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497016966342926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029161715880036354, decouple_loss:0.002080637961626053
The modified gen p mean: 0.4481629431247711, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030902696773409843, decouple_loss:0.002230430720373988
The modified gen p mean: 0.4452979564666748, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02963155321776867, decouple_loss:0.002067435998469591
Iteration: 347, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462689161300659, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029771799221634865, decouple_loss:0.002172887558117509
The modified gen p mean: 0.44652411341667175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0304816085845232, decouple_loss:0.002011785050854087
The modified gen p mean: 0.44964373111724854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030582895502448082, decouple_loss:0.00216467073187232
Iteration: 348, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479646384716034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03029378317296505, decouple_loss:0.001956378109753132
The modified gen p mean: 0.44619500637054443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03056442365050316, decouple_loss:0.001958264037966728
The modified gen p mean: 0.4441579580307007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030180342495441437, decouple_loss:0.001779972924850881
Iteration: 349, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44259166717529297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030474018305540085, decouple_loss:0.002063096035271883
The modified gen p mean: 0.44407665729522705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03146864101290703, decouple_loss:0.001988533418625593
The modified gen p mean: 0.4485032856464386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027911575511097908, decouple_loss:0.0023077449295669794
Iteration: 350, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44705379009246826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02959495410323143, decouple_loss:0.0019508586265146732
The modified gen p mean: 0.4449841380119324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028284339234232903, decouple_loss:0.002374425996094942
The modified gen p mean: 0.44557273387908936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028605464845895767, decouple_loss:0.0026423106901347637
2023-05-26 05:06:24 testing...
The modified gen p mean: 0.45056435465812683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03320617228746414, decouple_loss:0.002005289774388075
The modified gen p mean: 0.44795212149620056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033710282295942307, decouple_loss:0.0018275916809216142
The modified gen p mean: 0.44958585500717163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03492753207683563, decouple_loss:0.002084694802761078
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03404662013053894, avg_mse: 0.04612559452652931
current test mse: 0.046126
Iteration: 351, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44602981209754944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02866113744676113, decouple_loss:0.0026725134812295437
The modified gen p mean: 0.4443061649799347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030285241082310677, decouple_loss:0.001965908333659172
The modified gen p mean: 0.44431185722351074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03081153705716133, decouple_loss:0.0017928085289895535
Iteration: 352, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4433528482913971, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031401485204696655, decouple_loss:0.0018753214972093701
The modified gen p mean: 0.4464021921157837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030156847089529037, decouple_loss:0.0018157664453610778
The modified gen p mean: 0.445212185382843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02861093357205391, decouple_loss:0.0019434844143688679
Iteration: 353, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447769224643707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029433244839310646, decouple_loss:0.0017235471168532968
The modified gen p mean: 0.44808417558670044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02904425375163555, decouple_loss:0.0020518056116998196
The modified gen p mean: 0.44953709840774536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028339460492134094, decouple_loss:0.001796376658603549
Iteration: 354, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503194987773895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029766181483864784, decouple_loss:0.0021609580144286156
The modified gen p mean: 0.4469493627548218, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02792174741625786, decouple_loss:0.0024304986000061035
The modified gen p mean: 0.4505584239959717, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030286628752946854, decouple_loss:0.0019665369763970375
Iteration: 355, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45147189497947693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02905787155032158, decouple_loss:0.0018205916276201606
The modified gen p mean: 0.4505964517593384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028029920533299446, decouple_loss:0.0019287740578874946
The modified gen p mean: 0.44865280389785767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029130933806300163, decouple_loss:0.0023688015062361956
Iteration: 356, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493177533149719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028880726546049118, decouple_loss:0.0020227034110575914
The modified gen p mean: 0.451699823141098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029107090085744858, decouple_loss:0.0023277532309293747
The modified gen p mean: 0.4478875398635864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029956229031085968, decouple_loss:0.0019926661625504494
Iteration: 357, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44908031821250916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029262807220220566, decouple_loss:0.0019593958277255297
The modified gen p mean: 0.4508221447467804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028449857607483864, decouple_loss:0.002016808371990919
The modified gen p mean: 0.44995760917663574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029083650559186935, decouple_loss:0.0019800488371402025
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr.npz
NaN value num: 0
Iteration: 358, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4517364501953125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027962878346443176, decouple_loss:0.0018052972154691815
The modified gen p mean: 0.4526173770427704, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4536914825439453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02864205837249756, decouple_loss:0.0023169955238699913
loss_pred:0.02880891226232052, decouple_loss:0.0019633062183856964
Iteration: 359, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44626376032829285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02803204581141472, decouple_loss:0.0017279662424698472
The modified gen p mean: 0.4464184045791626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029019629582762718, decouple_loss:0.0016109186690300703
The modified gen p mean: 0.44917023181915283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028315966948866844, decouple_loss:0.0015082686441019177
Iteration: 360, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44794684648513794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028191134333610535, decouple_loss:0.0021448442712426186
The modified gen p mean: 0.44681936502456665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028092704713344574, decouple_loss:0.0015617050230503082
The modified gen p mean: 0.4482388198375702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028362790122628212, decouple_loss:0.0017504609422758222
2023-05-26 05:11:19 testing...
The modified gen p mean: 0.453055202960968, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033044785261154175, decouple_loss:0.0019464334473013878
The modified gen p mean: 0.45062917470932007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03320663422346115, decouple_loss:0.0018130310345441103
The modified gen p mean: 0.45268023014068604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03464580327272415, decouple_loss:0.0019534234888851643
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03372762352228165, avg_mse: 0.04584498330950737
current test mse: 0.045845
Iteration: 361, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500775933265686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027499457821249962, decouple_loss:0.00191305682528764
The modified gen p mean: 0.4467710554599762, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028793636709451675, decouple_loss:0.0017216706182807684
The modified gen p mean: 0.4501890242099762, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028842709958553314, decouple_loss:0.002065882785245776
Iteration: 362, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44531792402267456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02904125303030014, decouple_loss:0.0018467135960236192
The modified gen p mean: 0.44597434997558594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027962075546383858, decouple_loss:0.0016075633466243744
The modified gen p mean: 0.4457016885280609, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02807290479540825, decouple_loss:0.001694151433184743
Iteration: 363, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44739389419555664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02782081812620163, decouple_loss:0.0017785447416827083
The modified gen p mean: 0.44780871272087097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02809460461139679, decouple_loss:0.0017034836346283555
The modified gen p mean: 0.4447028636932373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029233239591121674, decouple_loss:0.0019311094656586647
Iteration: 364, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44823044538497925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027172015979886055, decouple_loss:0.0020986516028642654
The modified gen p mean: 0.4486580193042755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027512580156326294, decouple_loss:0.0016801714664325118
The modified gen p mean: 0.4513193666934967, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027495581656694412, decouple_loss:0.0016893924912437797
Iteration: 365, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467105269432068, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026940587908029556, decouple_loss:0.0020432197488844395
The modified gen p mean: 0.4453883767127991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028016701340675354, decouple_loss:0.001713179866783321
The modified gen p mean: 0.4506857991218567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028552843257784843, decouple_loss:0.0017665185732766986
Iteration: 366, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44393235445022583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027864374220371246, decouple_loss:0.0016598820220679045
The modified gen p mean: 0.4464770257472992, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027694718912243843, decouple_loss:0.0016579454531893134
The modified gen p mean: 0.4437902569770813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028288092464208603, decouple_loss:0.0016790893860161304
Iteration: 367, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44500312209129333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028422722592949867, decouple_loss:0.001864583813585341
The modified gen p mean: 0.4416877031326294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02720765955746174, decouple_loss:0.002129098167642951
The modified gen p mean: 0.4454629421234131, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02878684736788273, decouple_loss:0.0019247650634497404
Iteration: 368, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44811776280403137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02714724838733673, decouple_loss:0.0018122604815289378
The modified gen p mean: 0.44508543610572815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02739061415195465, decouple_loss:0.0018958835862576962
The modified gen p mean: 0.44515010714530945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026440637186169624, decouple_loss:0.0018968528602272272
Iteration: 369, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44517141580581665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027164194732904434, decouple_loss:0.0019108231645077467
The modified gen p mean: 0.44239428639411926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027292486280202866, decouple_loss:0.0016382444882765412
The modified gen p mean: 0.44256871938705444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028900165110826492, decouple_loss:0.0016878178576007485
Iteration: 370, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44711634516716003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027949010953307152, decouple_loss:0.0018001360585913062
The modified gen p mean: 0.44393542408943176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02913491427898407, decouple_loss:0.0018784782150760293
The modified gen p mean: 0.44650551676750183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026837650686502457, decouple_loss:0.0018469857750460505
2023-05-26 05:15:25 testing...
The modified gen p mean: 0.45129910111427307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03308800980448723, decouple_loss:0.001972811296582222
The modified gen p mean: 0.4510330259799957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03468799591064453, decouple_loss:0.0020081240218132734
The modified gen p mean: 0.4490041136741638, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03329407423734665, decouple_loss:0.0018524087499827147
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03378725051879883, avg_mse: 0.046064458787441254
current test mse: 0.046064
Iteration: 371, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44793832302093506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027715248987078667, decouple_loss:0.0018461189465597272
The modified gen p mean: 0.4474330544471741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026398791000247, decouple_loss:0.001861030119471252
The modified gen p mean: 0.44866400957107544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02762232907116413, decouple_loss:0.001848481479100883
Iteration: 372, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484612047672272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028155311942100525, decouple_loss:0.0021989725064486265
The modified gen p mean: 0.447939395904541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027484416961669922, decouple_loss:0.001925188465975225
The modified gen p mean: 0.45300254225730896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02758016251027584, decouple_loss:0.0019111109431833029
Iteration: 373, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4528481960296631, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026708366349339485, decouple_loss:0.0017613855889067054
The modified gen p mean: 0.44885435700416565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027833176776766777, decouple_loss:0.0019112108275294304
The modified gen p mean: 0.45079106092453003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026797115802764893, decouple_loss:0.00185711111407727
Iteration: 374, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505872428417206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027987860143184662, decouple_loss:0.0019239234970882535
The modified gen p mean: 0.44942381978034973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027986520901322365, decouple_loss:0.0017903788248077035
The modified gen p mean: 0.44818928837776184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02761230431497097, decouple_loss:0.0016778854187577963
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr.npz
NaN value num: 0
Iteration: 375, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495033621788025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028715219348669052, decouple_loss:0.0018981246976181865
The modified gen p mean: 0.449010968208313, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4492543637752533, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026520662009716034, decouple_loss:0.0022247857414186
loss_pred:0.02832573838531971, decouple_loss:0.0018094306578859687
Iteration: 376, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459344744682312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028129613026976585, decouple_loss:0.0016725383466109633
The modified gen p mean: 0.4500676095485687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02727641724050045, decouple_loss:0.001981184585019946
The modified gen p mean: 0.446082204580307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02874292992055416, decouple_loss:0.0018222150392830372
Iteration: 377, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480077624320984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026482414454221725, decouple_loss:0.0019000364700332284
The modified gen p mean: 0.44526758790016174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026290541514754295, decouple_loss:0.0020947232842445374
The modified gen p mean: 0.4493023157119751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02828831411898136, decouple_loss:0.0017476952634751797
Iteration: 378, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482496380805969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028257319703698158, decouple_loss:0.0019186805002391338
The modified gen p mean: 0.44439953565597534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029088275507092476, decouple_loss:0.0019380314042791724
The modified gen p mean: 0.44749385118484497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02587117813527584, decouple_loss:0.0018558962037786841
Iteration: 379, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444909989833832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028339290991425514, decouple_loss:0.0018009761115536094
The modified gen p mean: 0.44716504216194153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028897490352392197, decouple_loss:0.0018558136653155088
The modified gen p mean: 0.44698917865753174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028313372284173965, decouple_loss:0.0019082317594438791
Iteration: 380, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4511365592479706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027470655739307404, decouple_loss:0.0017536395462229848
The modified gen p mean: 0.45016855001449585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02769578993320465, decouple_loss:0.0017832709709182382
The modified gen p mean: 0.4500694274902344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026983490213751793, decouple_loss:0.0016670190962031484
2023-05-26 05:20:18 testing...
The modified gen p mean: 0.4552643299102783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032901499420404434, decouple_loss:0.0019487885292619467
The modified gen p mean: 0.45498982071876526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03441479802131653, decouple_loss:0.0020855702459812164
The modified gen p mean: 0.45323410630226135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03321018069982529, decouple_loss:0.0018669161945581436
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033607181161642075, avg_mse: 0.04574469104409218
current test mse: 0.045745
Iteration: 381, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45152658224105835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02753380499780178, decouple_loss:0.0019154750043526292
The modified gen p mean: 0.4503731429576874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02781386859714985, decouple_loss:0.0017045624554157257
The modified gen p mean: 0.4490622878074646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029500087723135948, decouple_loss:0.002120943972840905
Iteration: 382, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44913044571876526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027004914358258247, decouple_loss:0.0016970258438959718
The modified gen p mean: 0.4522913694381714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02695843018591404, decouple_loss:0.0019493623403832316
The modified gen p mean: 0.4530978202819824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027993401512503624, decouple_loss:0.0017092811176553369
Iteration: 383, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44724634289741516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028178829699754715, decouple_loss:0.0017216530395671725
The modified gen p mean: 0.4468633830547333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028609521687030792, decouple_loss:0.0019040042534470558
The modified gen p mean: 0.4508970081806183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026983710005879402, decouple_loss:0.0017532594501972198
Iteration: 384, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519011974334717, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027872378006577492, decouple_loss:0.001884052879177034
The modified gen p mean: 0.449922114610672, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027435343712568283, decouple_loss:0.0017181525472551584
The modified gen p mean: 0.4468179941177368, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02909213677048683, decouple_loss:0.0017304130597040057
Iteration: 385, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461795687675476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027895892038941383, decouple_loss:0.001997270155698061
The modified gen p mean: 0.45042842626571655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027643131092190742, decouple_loss:0.0018382936250418425
The modified gen p mean: 0.44992882013320923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027236418798565865, decouple_loss:0.001755989040248096
Iteration: 386, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445823609828949, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771163173019886, decouple_loss:0.0017747452948242426
The modified gen p mean: 0.4488077163696289, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02676171250641346, decouple_loss:0.0016066343523561954
The modified gen p mean: 0.4449842870235443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028667550534009933, decouple_loss:0.0021408414468169212
Iteration: 387, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44564199447631836, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44450122117996216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0275071170181036, decouple_loss:0.0018822232959792018
loss_pred:0.02832602709531784, decouple_loss:0.0016755122924223542
The modified gen p mean: 0.44789084792137146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02633063867688179, decouple_loss:0.0019313901429995894
Iteration: 388, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4416515827178955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028286227956414223, decouple_loss:0.0016002830816432834
The modified gen p mean: 0.4473239779472351, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026640158146619797, decouple_loss:0.001736316247843206
The modified gen p mean: 0.4476158022880554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02709626778960228, decouple_loss:0.0018251667497679591
Iteration: 389, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4415923058986664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028742728754878044, decouple_loss:0.0017872770549729466
The modified gen p mean: 0.44224220514297485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028105538338422775, decouple_loss:0.0017675732960924506
The modified gen p mean: 0.4436679780483246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028199104592204094, decouple_loss:0.002006708877161145
Iteration: 390, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446053683757782, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026698166504502296, decouple_loss:0.002083329949527979
The modified gen p mean: 0.4449065625667572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026526696979999542, decouple_loss:0.0017896430799737573
The modified gen p mean: 0.4429105222225189, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028363283723592758, decouple_loss:0.001784771797247231
2023-05-26 05:24:27 testing...
The modified gen p mean: 0.4515647292137146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0329526923596859, decouple_loss:0.0018826652085408568
The modified gen p mean: 0.451337605714798, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03445706143975258, decouple_loss:0.002028547925874591
The modified gen p mean: 0.44949987530708313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03321542218327522, decouple_loss:0.0018366668373346329
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03363752365112305, avg_mse: 0.04582725837826729
current test mse: 0.045827
Iteration: 391, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44557321071624756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02664523385465145, decouple_loss:0.0016668083844706416
The modified gen p mean: 0.4475022256374359, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0264707263559103, decouple_loss:0.0019354787655174732
The modified gen p mean: 0.4460834562778473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02677830494940281, decouple_loss:0.0019388055661693215
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr.npz
NaN value num: 0
Iteration: 392, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447783827781677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028729669749736786, decouple_loss:0.001791497110389173
The modified gen p mean: 0.4447537660598755, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45064371824264526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02931167557835579, decouple_loss:0.001793085946701467
loss_pred:0.027694135904312134, decouple_loss:0.0017730032559484243
Iteration: 393, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495793282985687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029047127813100815, decouple_loss:0.0025018625892698765
The modified gen p mean: 0.45185816287994385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02817380428314209, decouple_loss:0.0018615822773426771
The modified gen p mean: 0.4474472999572754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02757265418767929, decouple_loss:0.0020263365004211664
Iteration: 394, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45436251163482666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027482077479362488, decouple_loss:0.0020037461072206497
The modified gen p mean: 0.45299822092056274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0289772916585207, decouple_loss:0.00238252361305058
The modified gen p mean: 0.44885969161987305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027766350656747818, decouple_loss:0.0021857793908566236
Iteration: 395, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4543021023273468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027218803763389587, decouple_loss:0.0021788389421999454
The modified gen p mean: 0.45101243257522583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02928926981985569, decouple_loss:0.0017172831576317549
The modified gen p mean: 0.45170778036117554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027566680684685707, decouple_loss:0.0017787248361855745
Iteration: 396, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44726642966270447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028439396992325783, decouple_loss:0.001960685010999441
The modified gen p mean: 0.4496743679046631, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027551831677556038, decouple_loss:0.002046717796474695
The modified gen p mean: 0.45369744300842285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027300206944346428, decouple_loss:0.0019936379976570606
Iteration: 397, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488653838634491, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029985960572957993, decouple_loss:0.002091767033562064
The modified gen p mean: 0.45146694779396057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02758553996682167, decouple_loss:0.0017970682820305228
The modified gen p mean: 0.450022429227829, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028809405863285065, decouple_loss:0.0019139278447255492
Iteration: 398, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45165374875068665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029364798218011856, decouple_loss:0.0019545808900147676
The modified gen p mean: 0.4498968720436096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028054041787981987, decouple_loss:0.0025320802815258503
The modified gen p mean: 0.4466699957847595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027642618864774704, decouple_loss:0.0015755603089928627
Iteration: 399, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450346529483795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02855459786951542, decouple_loss:0.0017273087287321687
The modified gen p mean: 0.45274868607521057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028535017743706703, decouple_loss:0.0018957072170451283
The modified gen p mean: 0.44965970516204834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027923477813601494, decouple_loss:0.001693669706583023
Iteration: 400, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477542042732239, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45082882046699524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02748401276767254, decouple_loss:0.001976982457563281
loss_pred:0.02810264192521572, decouple_loss:0.001736297970637679
The modified gen p mean: 0.4455239176750183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0287077147513628, decouple_loss:0.0018096131971105933

2023-05-26 05:29:17 testing...
The modified gen p mean: 0.45281079411506653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0327274389564991, decouple_loss:0.0021289584692567587
The modified gen p mean: 0.4508630037307739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032990146428346634, decouple_loss:0.0018765779677778482
The modified gen p mean: 0.4526382386684418, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034289706498384476, decouple_loss:0.0020564175210893154
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03343679755926132, avg_mse: 0.04544283449649811
current test mse: 0.045443
Iteration: 401, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45227643847465515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027605468407273293, decouple_loss:0.001968056196346879
The modified gen p mean: 0.4495547115802765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027016617357730865, decouple_loss:0.002052019815891981
The modified gen p mean: 0.4491150677204132, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029851291328668594, decouple_loss:0.0017646622145548463
Iteration: 402, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513227641582489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029037803411483765, decouple_loss:0.0018772089388221502
The modified gen p mean: 0.44812676310539246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027231935411691666, decouple_loss:0.001957394415512681
The modified gen p mean: 0.4469049274921417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029401393607258797, decouple_loss:0.0022829207591712475
Iteration: 403, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463045299053192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028341809287667274, decouple_loss:0.0019175673369318247
The modified gen p mean: 0.4445001482963562, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028872843831777573, decouple_loss:0.0017120136180892587
The modified gen p mean: 0.44709789752960205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027826610952615738, decouple_loss:0.0021992649417370558
Iteration: 404, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4431062638759613, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028885604813694954, decouple_loss:0.0015807501040399075
The modified gen p mean: 0.4461551606655121, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02922319993376732, decouple_loss:0.001592564512975514
The modified gen p mean: 0.44821426272392273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027313902974128723, decouple_loss:0.0021942504681646824
Iteration: 405, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44792452454566956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02778869867324829, decouple_loss:0.001989478711038828
The modified gen p mean: 0.44705042243003845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029104482382535934, decouple_loss:0.0019001594046130776
The modified gen p mean: 0.4448656439781189, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028603430837392807, decouple_loss:0.0017583746230229735
Iteration: 406, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44819948077201843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02876817062497139, decouple_loss:0.0021067005582153797
The modified gen p mean: 0.4481768310070038, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027407951653003693, decouple_loss:0.0016557746566832066
The modified gen p mean: 0.4511154592037201, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028349772095680237, decouple_loss:0.0018683437956497073
Iteration: 407, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471170902252197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027613069862127304, decouple_loss:0.0015952137764543295
The modified gen p mean: 0.45057412981987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026499299332499504, decouple_loss:0.0018884048331528902
The modified gen p mean: 0.4515904188156128, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027584999799728394, decouple_loss:0.0018266747938469052
Iteration: 408, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4530898332595825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027616623789072037, decouple_loss:0.0017935819923877716
The modified gen p mean: 0.4506687521934509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026647698134183884, decouple_loss:0.001782391918823123
The modified gen p mean: 0.44930294156074524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028874820098280907, decouple_loss:0.0017456397181376815
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr_shift3.npz
NaN value num: 0
Iteration: 409, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4523134231567383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03061693347990513, decouple_loss:0.0018417066894471645
The modified gen p mean: 0.4553491771221161, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029026124626398087, decouple_loss:0.001802779850549996
The modified gen p mean: 0.4502146244049072, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02969583123922348, decouple_loss:0.0016138923820108175
Iteration: 410, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44982799887657166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03019154816865921, decouple_loss:0.0015338441589847207
The modified gen p mean: 0.4530535936355591, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0288590919226408, decouple_loss:0.0019794884137809277
The modified gen p mean: 0.45585379004478455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030041374266147614, decouple_loss:0.0016799467848613858
2023-05-26 05:34:06 testing...
The modified gen p mean: 0.45642098784446716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03270464390516281, decouple_loss:0.0020486621651798487
The modified gen p mean: 0.4546809792518616, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4564061462879181, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033051107078790665, decouple_loss:0.0017814799211919308
loss_pred:0.034284792840480804, decouple_loss:0.001901524025015533
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03344237804412842, avg_mse: 0.045386914163827896
current test mse: 0.045387
Iteration: 411, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4531439542770386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029077494516968727, decouple_loss:0.0019418117590248585
The modified gen p mean: 0.45311278104782104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02898859977722168, decouple_loss:0.0016153318574652076
The modified gen p mean: 0.452828973531723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030629951506853104, decouple_loss:0.0017937944503501058
Iteration: 412, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4548966884613037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027709906920790672, decouple_loss:0.0017706570215523243
The modified gen p mean: 0.4549456238746643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028307031840085983, decouple_loss:0.0017504454590380192
The modified gen p mean: 0.44930675625801086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02937646582722664, decouple_loss:0.0016285959864035249
Iteration: 413, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45174089074134827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02925189398229122, decouple_loss:0.0017085327999666333
The modified gen p mean: 0.4495890736579895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029160797595977783, decouple_loss:0.0015984998317435384
The modified gen p mean: 0.44808703660964966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029300058260560036, decouple_loss:0.0016420847969129682
Iteration: 414, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497130215167999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029379870742559433, decouple_loss:0.0017242314061149955
The modified gen p mean: 0.44661745429039, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028818916529417038, decouple_loss:0.0018161529442295432
The modified gen p mean: 0.44719505310058594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02814684435725212, decouple_loss:0.0015822449931874871
Iteration: 415, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45123788714408875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029050424695014954, decouple_loss:0.001571750151924789
The modified gen p mean: 0.45297685265541077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02840464934706688, decouple_loss:0.0017307748785242438
The modified gen p mean: 0.4488489031791687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028302254155278206, decouple_loss:0.001762079307809472
Iteration: 416, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44662806391716003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029851235449314117, decouple_loss:0.0016332459636032581
The modified gen p mean: 0.44714686274528503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028332630172371864, decouple_loss:0.0016871141269803047
The modified gen p mean: 0.44847699999809265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029300160706043243, decouple_loss:0.001866347505711019
Iteration: 417, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44330620765686035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030246552079916, decouple_loss:0.0015599556500092149
The modified gen p mean: 0.44583043456077576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028854863718152046, decouple_loss:0.0016886827070266008
The modified gen p mean: 0.4497048854827881, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027717221528291702, decouple_loss:0.0018535720882937312
Iteration: 418, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44796839356422424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029768245294690132, decouple_loss:0.001809877110645175
The modified gen p mean: 0.44901612401008606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02891542762517929, decouple_loss:0.0016658259555697441
The modified gen p mean: 0.44994890689849854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029188115149736404, decouple_loss:0.0019682554993778467
Iteration: 419, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482508599758148, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027900317683815956, decouple_loss:0.0017600130522623658
The modified gen p mean: 0.44349226355552673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030369680374860764, decouple_loss:0.0017881083767861128
The modified gen p mean: 0.4500185549259186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029672570526599884, decouple_loss:0.0017132400535047054
Iteration: 420, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44689759612083435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02792852744460106, decouple_loss:0.0017798204207792878
The modified gen p mean: 0.447024405002594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027838246896862984, decouple_loss:0.0017364458180963993
The modified gen p mean: 0.44957637786865234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02817581593990326, decouple_loss:0.0017303531058132648
2023-05-26 05:38:15 testing...
The modified gen p mean: 0.45263171195983887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03307238593697548, decouple_loss:0.0020354255102574825
The modified gen p mean: 0.4523583948612213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034751277416944504, decouple_loss:0.0019904575310647488
The modified gen p mean: 0.45091307163238525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03346720337867737, decouple_loss:0.001783166080713272
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03386044129729271, avg_mse: 0.0458526685833931
current test mse: 0.045853
Iteration: 421, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44888928532600403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028781726956367493, decouple_loss:0.0019756474066525698
The modified gen p mean: 0.4480542242527008, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02920444682240486, decouple_loss:0.0016638630768284202
The modified gen p mean: 0.4520747661590576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02776900678873062, decouple_loss:0.0018349847523495555
Iteration: 422, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44553709030151367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02920866198837757, decouple_loss:0.0016209941823035479
The modified gen p mean: 0.45261895656585693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02933046966791153, decouple_loss:0.001855466514825821
The modified gen p mean: 0.44978857040405273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028264816850423813, decouple_loss:0.0016340219881385565
Iteration: 423, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44770583510398865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028630215674638748, decouple_loss:0.0017318769823759794
The modified gen p mean: 0.45025044679641724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027998924255371094, decouple_loss:0.0018979446031153202
The modified gen p mean: 0.4522830843925476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02713962085545063, decouple_loss:0.0019870654214173555
Iteration: 424, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503273665904999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03026629239320755, decouple_loss:0.0016808084910735488
The modified gen p mean: 0.44939082860946655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028538428246974945, decouple_loss:0.0017010103911161423
The modified gen p mean: 0.45576581358909607, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02893076092004776, decouple_loss:0.0017509147292003036
Iteration: 425, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518619477748871, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02718423865735531, decouple_loss:0.001661822316236794
The modified gen p mean: 0.44813039898872375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02777331881225109, decouple_loss:0.0017759817419573665
The modified gen p mean: 0.4496069848537445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029412126168608665, decouple_loss:0.0018432724755257368
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr.npz
NaN value num: 0
Iteration: 426, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505191445350647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028621578589081764, decouple_loss:0.002138467039912939
The modified gen p mean: 0.44909125566482544, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45212680101394653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029792824760079384, decouple_loss:0.0017064755083993077
loss_pred:0.03008166514337063, decouple_loss:0.0022347026970237494
Iteration: 427, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44584566354751587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02996073290705681, decouple_loss:0.0019631616305559874
The modified gen p mean: 0.4467703402042389, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029230674728751183, decouple_loss:0.002004421316087246
The modified gen p mean: 0.44751879572868347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030916638672351837, decouple_loss:0.0020394723396748304
Iteration: 428, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44494155049324036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029314471408724785, decouple_loss:0.001862401026301086
The modified gen p mean: 0.4437757432460785, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4457228481769562, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030511410906910896, decouple_loss:0.0020628541242331266
loss_pred:0.02963428385555744, decouple_loss:0.0018012765794992447
Iteration: 429, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482863247394562, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027808666229248047, decouple_loss:0.0021487162448465824
The modified gen p mean: 0.4459432065486908, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029086975380778313, decouple_loss:0.0018545561470091343
The modified gen p mean: 0.44654399156570435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028011493384838104, decouple_loss:0.0017942300764843822
Iteration: 430, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445401132106781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027284476906061172, decouple_loss:0.0020483483094722033
The modified gen p mean: 0.44366174936294556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027630027383565903, decouple_loss:0.0022379246074706316
The modified gen p mean: 0.4410143196582794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03016318380832672, decouple_loss:0.0020173045340925455
2023-05-26 05:43:06 testing...
The modified gen p mean: 0.45001664757728577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033156536519527435, decouple_loss:0.0020977549720555544
The modified gen p mean: 0.4497567415237427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03473586589097977, decouple_loss:0.0019873916171491146
The modified gen p mean: 0.4482673108577728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0335221029818058, decouple_loss:0.0018634649459272623
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033903978765010834, avg_mse: 0.046036023646593094
current test mse: 0.046036
Iteration: 431, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44472768902778625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02721051126718521, decouple_loss:0.001766470610164106
The modified gen p mean: 0.44667479395866394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02810940146446228, decouple_loss:0.002020576037466526
The modified gen p mean: 0.44390037655830383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028031229972839355, decouple_loss:0.0019946626853197813
Iteration: 432, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449506938457489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027581755071878433, decouple_loss:0.0017486406723037362
The modified gen p mean: 0.44320979714393616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02848214842379093, decouple_loss:0.00173968228045851
The modified gen p mean: 0.4461074471473694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029472094029188156, decouple_loss:0.001695371582172811
Iteration: 433, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44498786330223083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028278689831495285, decouple_loss:0.0016700496198609471
The modified gen p mean: 0.4504581093788147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026916787028312683, decouple_loss:0.0019247789168730378
The modified gen p mean: 0.4460829794406891, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029360778629779816, decouple_loss:0.00196432089433074
Iteration: 434, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519171416759491, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027292374521493912, decouple_loss:0.0018634586594998837
The modified gen p mean: 0.4490218758583069, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026876719668507576, decouple_loss:0.0019962438382208347
The modified gen p mean: 0.44967037439346313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02839953638613224, decouple_loss:0.001778702368028462
Iteration: 435, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472724199295044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028170788660645485, decouple_loss:0.0017143754521384835
The modified gen p mean: 0.45299628376960754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02816593088209629, decouple_loss:0.001762188272550702
The modified gen p mean: 0.44900792837142944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02928963303565979, decouple_loss:0.0016519296914339066
Iteration: 436, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44746002554893494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02911663055419922, decouple_loss:0.001990682678297162
The modified gen p mean: 0.4519726634025574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02745123766362667, decouple_loss:0.0023997128009796143
The modified gen p mean: 0.4451388418674469, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028929345309734344, decouple_loss:0.0018159508472308517
Iteration: 437, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44680196046829224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029083948582410812, decouple_loss:0.0017327419482171535
The modified gen p mean: 0.4474553167819977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027673915028572083, decouple_loss:0.0017030899180099368
The modified gen p mean: 0.4512858986854553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026967469602823257, decouple_loss:0.002031023846939206
Iteration: 438, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44664308428764343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02873748540878296, decouple_loss:0.0018114990089088678
The modified gen p mean: 0.44789907336235046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029058730229735374, decouple_loss:0.0017593196826055646
The modified gen p mean: 0.4500800669193268, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027708625420928, decouple_loss:0.0018882647855207324
Iteration: 439, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44969478249549866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0269184447824955, decouple_loss:0.0022451644763350487
The modified gen p mean: 0.44627803564071655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028627976775169373, decouple_loss:0.0020995771046727896
The modified gen p mean: 0.45022353529930115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028503887355327606, decouple_loss:0.0023589369375258684
Iteration: 440, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44885513186454773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027270693331956863, decouple_loss:0.0023246565833687782
The modified gen p mean: 0.44377022981643677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029165135696530342, decouple_loss:0.00220498931594193
The modified gen p mean: 0.44616034626960754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028476251289248466, decouple_loss:0.001975212711840868
2023-05-26 05:47:11 testing...
The modified gen p mean: 0.4521772563457489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03294124826788902, decouple_loss:0.0020383268129080534
The modified gen p mean: 0.4503621459007263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033110346645116806, decouple_loss:0.0018897695699706674
The modified gen p mean: 0.45203012228012085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03428255021572113, decouple_loss:0.0019802867900580168
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033543191850185394, avg_mse: 0.04546861723065376
current test mse: 0.045469
Iteration: 441, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44479677081108093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028529871255159378, decouple_loss:0.0016374635742977262
The modified gen p mean: 0.4452131986618042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028821762651205063, decouple_loss:0.0018969286466017365
The modified gen p mean: 0.4442606568336487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02856474556028843, decouple_loss:0.0019454272696748376
Iteration: 442, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477311968803406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722076140344143, decouple_loss:0.0019372559618204832
The modified gen p mean: 0.4470301568508148, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027260828763246536, decouple_loss:0.001851199078373611
The modified gen p mean: 0.44645801186561584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028101641684770584, decouple_loss:0.001953051658347249
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr_shift3.npz
NaN value num: 0
Iteration: 443, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4539757966995239, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03331233188509941, decouple_loss:0.0018331831088289618
The modified gen p mean: 0.4459886848926544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034676674753427505, decouple_loss:0.0017507013399153948
The modified gen p mean: 0.44900423288345337, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03528173640370369, decouple_loss:0.0018893632804974914
Iteration: 444, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45209938287734985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034635186195373535, decouple_loss:0.001845819759182632
The modified gen p mean: 0.4508732259273529, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03532193601131439, decouple_loss:0.0017873658798635006
The modified gen p mean: 0.4553661346435547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034810133278369904, decouple_loss:0.0018703960813581944
Iteration: 445, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45369231700897217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033928655087947845, decouple_loss:0.0023588482290506363
The modified gen p mean: 0.45527443289756775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035962749272584915, decouple_loss:0.002311577321961522
The modified gen p mean: 0.4557250738143921, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033302973955869675, decouple_loss:0.0020744798239320517
Iteration: 446, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45483094453811646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035593803972005844, decouple_loss:0.001978823449462652
The modified gen p mean: 0.4547003507614136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03346307575702667, decouple_loss:0.0018986157374456525
The modified gen p mean: 0.45509907603263855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03600040450692177, decouple_loss:0.002001560525968671
Iteration: 447, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.453000545501709, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03352196142077446, decouple_loss:0.0019062464125454426
The modified gen p mean: 0.45377111434936523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03504011780023575, decouple_loss:0.0017824281239882112
The modified gen p mean: 0.45852580666542053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03462916985154152, decouple_loss:0.0018187988316640258
Iteration: 448, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4549543857574463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0327710397541523, decouple_loss:0.001726633752696216
The modified gen p mean: 0.4548863470554352, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03375498205423355, decouple_loss:0.0017624064348638058
The modified gen p mean: 0.45423299074172974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034489866346120834, decouple_loss:0.00172444770578295
Iteration: 449, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4545761048793793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03297698125243187, decouple_loss:0.0016832390101626515
The modified gen p mean: 0.45230183005332947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03452908992767334, decouple_loss:0.001879487419500947
The modified gen p mean: 0.4598371088504791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03522106632590294, decouple_loss:0.001874730922281742
Iteration: 450, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45332959294319153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033208005130290985, decouple_loss:0.0018605965888127685
The modified gen p mean: 0.45506078004837036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03526150807738304, decouple_loss:0.0019503383664414287
The modified gen p mean: 0.4530975818634033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034360408782958984, decouple_loss:0.0017194064566865563
2023-05-26 05:52:00 testing...
The modified gen p mean: 0.45043042302131653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03238812834024429, decouple_loss:0.0018384268041700125
The modified gen p mean: 0.4486750066280365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032702572643756866, decouple_loss:0.0017916073556989431
The modified gen p mean: 0.450144499540329, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03392333537340164, decouple_loss:0.0018958412110805511
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03309677541255951, avg_mse: 0.04470006376504898
current test mse: 0.0447
Iteration: 451, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496467113494873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035245154052972794, decouple_loss:0.001790976501069963
The modified gen p mean: 0.44341686367988586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03399046137928963, decouple_loss:0.0017775277374312282
The modified gen p mean: 0.4476531744003296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03361556679010391, decouple_loss:0.001646953634917736
Iteration: 452, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438672661781311, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03349863737821579, decouple_loss:0.001742990338243544
The modified gen p mean: 0.4471454620361328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03192663565278053, decouple_loss:0.0017365647945553064
The modified gen p mean: 0.44774219393730164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034001871943473816, decouple_loss:0.0017689596861600876
Iteration: 453, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4414531886577606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03312583267688751, decouple_loss:0.001616188557818532
The modified gen p mean: 0.44134145975112915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03317267820239067, decouple_loss:0.0019200942479074001
The modified gen p mean: 0.44497257471084595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03397545963525772, decouple_loss:0.0019274599617347121
Iteration: 454, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4409961700439453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03369853273034096, decouple_loss:0.00175321230199188
The modified gen p mean: 0.4454072415828705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033637139946222305, decouple_loss:0.0019415193237364292
The modified gen p mean: 0.4465697109699249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03421977534890175, decouple_loss:0.001824334729462862
Iteration: 455, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4412608742713928, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03396335616707802, decouple_loss:0.0018468969501554966
The modified gen p mean: 0.4404018521308899, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03248177096247673, decouple_loss:0.0016592269530519843
The modified gen p mean: 0.4479076862335205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03425503894686699, decouple_loss:0.0018824449507519603
Iteration: 456, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494388699531555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0332510732114315, decouple_loss:0.0018753993790596724
The modified gen p mean: 0.4465344548225403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03288212791085243, decouple_loss:0.0016791848465800285
The modified gen p mean: 0.4494502544403076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034147508442401886, decouple_loss:0.0020112984348088503
Iteration: 457, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45441174507141113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03464910387992859, decouple_loss:0.0016983594978228211
The modified gen p mean: 0.45148736238479614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03324279189109802, decouple_loss:0.0016729175113141537
The modified gen p mean: 0.4503878355026245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03558707982301712, decouple_loss:0.001712042256258428
Iteration: 458, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451528400182724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03397668898105621, decouple_loss:0.0016022372292354703
The modified gen p mean: 0.4547286927700043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03351999819278717, decouple_loss:0.0017120379488915205
The modified gen p mean: 0.4549945592880249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03357589989900589, decouple_loss:0.0021049664355814457
Iteration: 459, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4540282189846039, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033914923667907715, decouple_loss:0.0018558461451902986
The modified gen p mean: 0.4556908905506134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03461955487728119, decouple_loss:0.001539534772746265
The modified gen p mean: 0.452869713306427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03370482847094536, decouple_loss:0.001939920475706458
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr_shift3.npz
NaN value num: 0
Iteration: 460, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510584771633148, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03164486214518547, decouple_loss:0.0015077319694682956
The modified gen p mean: 0.4518606662750244, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45619603991508484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03149798512458801, decouple_loss:0.0018460581777617335loss_pred:0.030985690653324127, decouple_loss:0.001957029802724719
2023-05-26 05:56:52 testing...
The modified gen p mean: 0.45606163144111633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032274194061756134, decouple_loss:0.0017831048462539911
The modified gen p mean: 0.45423728227615356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03257929906249046, decouple_loss:0.0017277217702940106
The modified gen p mean: 0.45574524998664856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03383464366197586, decouple_loss:0.0018809848697856069
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03298591077327728, avg_mse: 0.04446341097354889
current test mse: 0.044463
Iteration: 461, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45404502749443054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03189399838447571, decouple_loss:0.001964625669643283
The modified gen p mean: 0.44886067509651184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02931862883269787, decouple_loss:0.0016382974572479725
The modified gen p mean: 0.45086121559143066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02937999926507473, decouple_loss:0.0019625662826001644
Iteration: 462, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44937971234321594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029480604454874992, decouple_loss:0.0018699347274377942
The modified gen p mean: 0.4449124336242676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030184978619217873, decouple_loss:0.0017601337749511003
The modified gen p mean: 0.44644856452941895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02951805666089058, decouple_loss:0.0015820038970559835
Iteration: 463, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444778859615326, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44223883748054504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029713554307818413, decouple_loss:0.0020451571326702833
loss_pred:0.028825191780924797, decouple_loss:0.0020202116575092077
The modified gen p mean: 0.4473192095756531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029153723269701004, decouple_loss:0.0020093354396522045
Iteration: 464, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459238052368164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029218435287475586, decouple_loss:0.0024539947044104338
The modified gen p mean: 0.44088292121887207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03097609616816044, decouple_loss:0.0016552493907511234
The modified gen p mean: 0.44115185737609863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02936154417693615, decouple_loss:0.0020012075547128916
Iteration: 465, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44574669003486633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03000505082309246, decouple_loss:0.0018931637750938535
The modified gen p mean: 0.4455733299255371, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030662622302770615, decouple_loss:0.001826687017455697
The modified gen p mean: 0.44082701206207275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030625246465206146, decouple_loss:0.0016621685354039073
Iteration: 466, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4411593973636627, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027552630752325058, decouple_loss:0.0018799450481310487
The modified gen p mean: 0.4414959251880646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029211945831775665, decouple_loss:0.0018075619591400027
The modified gen p mean: 0.4412737190723419, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03267253190279007, decouple_loss:0.0018064110772684216
Iteration: 467, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44855791330337524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03077906370162964, decouple_loss:0.0019629914313554764
The modified gen p mean: 0.4452149271965027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029402591288089752, decouple_loss:0.0017457441426813602
The modified gen p mean: 0.44384220242500305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03020968660712242, decouple_loss:0.0016317114932462573
Iteration: 468, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44665390253067017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031798094511032104, decouple_loss:0.0018783940467983484
The modified gen p mean: 0.44943782687187195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028884131461381912, decouple_loss:0.0018903723685070872
The modified gen p mean: 0.44718512892723083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028566185384988785, decouple_loss:0.0019497234607115388
Iteration: 469, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469974637031555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029716307297348976, decouple_loss:0.001652878476306796
The modified gen p mean: 0.4533218443393707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027422484010457993, decouple_loss:0.0018978840671479702
The modified gen p mean: 0.4479833245277405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02979312278330326, decouple_loss:0.0018523562466725707
Iteration: 470, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491219222545624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03140029311180115, decouple_loss:0.0017957085510715842
The modified gen p mean: 0.4484082758426666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030047791078686714, decouple_loss:0.0015895601827651262
The modified gen p mean: 0.4508388638496399, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027982572093605995, decouple_loss:0.001901555573567748
2023-05-26 06:00:56 testing...
The modified gen p mean: 0.4558064937591553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03262491896748543, decouple_loss:0.0019113587914034724
The modified gen p mean: 0.4553765654563904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03418326750397682, decouple_loss:0.0020384136587381363
The modified gen p mean: 0.45389750599861145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03297748044133186, decouple_loss:0.0018715948099270463
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03335891291499138, avg_mse: 0.045003730803728104
current test mse: 0.045004
Iteration: 471, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44909095764160156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030849093571305275, decouple_loss:0.0018408892210572958
The modified gen p mean: 0.45360931754112244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03072771430015564, decouple_loss:0.0018743464024737477
The modified gen p mean: 0.45251086354255676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02952001616358757, decouple_loss:0.0018615139415487647
Iteration: 472, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496620297431946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02877136506140232, decouple_loss:0.0018848869949579239
The modified gen p mean: 0.4520629048347473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029371079057455063, decouple_loss:0.001991862431168556
The modified gen p mean: 0.4557611346244812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029256144538521767, decouple_loss:0.0021168580278754234
Iteration: 473, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45129480957984924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026924604550004005, decouple_loss:0.0017615974647924304
The modified gen p mean: 0.44875669479370117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031175557523965836, decouple_loss:0.001836594077758491
The modified gen p mean: 0.44970887899398804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02976955473423004, decouple_loss:0.0018863729201257229
Iteration: 474, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458429515361786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029427647590637207, decouple_loss:0.0016965296817943454
The modified gen p mean: 0.45010906457901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028460005298256874, decouple_loss:0.0019287450704723597
The modified gen p mean: 0.44624367356300354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029692895710468292, decouple_loss:0.0023253613617271185
Iteration: 475, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485462009906769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029336201027035713, decouple_loss:0.0021113574039191008
The modified gen p mean: 0.4486467242240906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028292058035731316, decouple_loss:0.0019028660608455539
The modified gen p mean: 0.44375744462013245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02987810969352722, decouple_loss:0.0019019393948838115
Iteration: 476, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44609135389328003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029346462339162827, decouple_loss:0.0020869732834398746
The modified gen p mean: 0.44294121861457825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03058776445686817, decouple_loss:0.00197980715893209
The modified gen p mean: 0.4474371373653412, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03034319542348385, decouple_loss:0.0019739221315830946
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr_shift3.npz
NaN value num: 0
Iteration: 477, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475518465042114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029728595167398453, decouple_loss:0.0021285745315253735
The modified gen p mean: 0.44405224919319153, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4444282352924347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031642451882362366, decouple_loss:0.0020224670879542828
loss_pred:0.029583275318145752, decouple_loss:0.0018821140984073281
Iteration: 478, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459293484687805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0303485244512558, decouple_loss:0.001745367655530572
The modified gen p mean: 0.4483824670314789, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029582621529698372, decouple_loss:0.0018392573110759258
The modified gen p mean: 0.45201751589775085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02906959503889084, decouple_loss:0.00200447509996593
Iteration: 479, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44851744174957275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02927730418741703, decouple_loss:0.0019136829068884254
The modified gen p mean: 0.4511484205722809, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031163174659013748, decouple_loss:0.001973358914256096
The modified gen p mean: 0.44574934244155884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02977064624428749, decouple_loss:0.0016412818804383278
Iteration: 480, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470946788787842, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029275331646203995, decouple_loss:0.0017204370815306902
The modified gen p mean: 0.44762951135635376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03066139854490757, decouple_loss:0.0017803767696022987
The modified gen p mean: 0.4466608762741089, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03059806115925312, decouple_loss:0.001808621222153306
2023-05-26 06:05:43 testing...
The modified gen p mean: 0.4526612460613251, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032911062240600586, decouple_loss:0.0019986615516245365
The modified gen p mean: 0.45085346698760986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03306225314736366, decouple_loss:0.0018159280298277736
The modified gen p mean: 0.45232510566711426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03439858555793762, decouple_loss:0.001912714447826147
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033552758395671844, avg_mse: 0.045323554426431656
current test mse: 0.045324
Iteration: 481, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4528314173221588, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03001479245722294, decouple_loss:0.0017479429952800274
The modified gen p mean: 0.45168501138687134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030239492654800415, decouple_loss:0.001895666471682489
The modified gen p mean: 0.4488079249858856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030222907662391663, decouple_loss:0.0019014821154996753
Iteration: 482, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45295438170433044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030003391206264496, decouple_loss:0.002209499478340149
The modified gen p mean: 0.44651561975479126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03064892627298832, decouple_loss:0.0020725347567349672
The modified gen p mean: 0.44918572902679443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028937797993421555, decouple_loss:0.0015995341818779707
Iteration: 483, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4532551169395447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030605453997850418, decouple_loss:0.001703997957520187
The modified gen p mean: 0.4488146901130676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03089049644768238, decouple_loss:0.0017067014705389738
The modified gen p mean: 0.44864052534103394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029767706990242004, decouple_loss:0.0020677801221609116
Iteration: 484, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4546433687210083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03084499016404152, decouple_loss:0.0018737962236627936
The modified gen p mean: 0.45043396949768066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028395920991897583, decouple_loss:0.002129030879586935
The modified gen p mean: 0.44620075821876526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02990041673183441, decouple_loss:0.0017847762210294604
Iteration: 485, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44669169187545776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03185832127928734, decouple_loss:0.001994191436097026
The modified gen p mean: 0.4480851888656616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029232928529381752, decouple_loss:0.0016453994903713465
The modified gen p mean: 0.45190179347991943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030463367700576782, decouple_loss:0.0016921872738748789
Iteration: 486, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466972351074219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031227922067046165, decouple_loss:0.001805959502235055
The modified gen p mean: 0.44665852189064026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03139336034655571, decouple_loss:0.0018235720926895738
The modified gen p mean: 0.4466497600078583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030188970267772675, decouple_loss:0.0017340285703539848
Iteration: 487, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44823044538497925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028311822563409805, decouple_loss:0.0021321289241313934
The modified gen p mean: 0.4505770802497864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030083579942584038, decouple_loss:0.0023998182732611895
The modified gen p mean: 0.4511674642562866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030743371695280075, decouple_loss:0.0018763926345854998
Iteration: 488, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44783374667167664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03084455244243145, decouple_loss:0.0020553949289023876
The modified gen p mean: 0.44936034083366394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02871173620223999, decouple_loss:0.0019090637797489762
The modified gen p mean: 0.4489884078502655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030122490599751472, decouple_loss:0.001814774819649756
Iteration: 489, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4435598850250244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031859397888183594, decouple_loss:0.0018109928350895643
The modified gen p mean: 0.44725674390792847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028889385983347893, decouple_loss:0.001994224265217781
The modified gen p mean: 0.445038765668869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029982630163431168, decouple_loss:0.001834517577663064
Iteration: 490, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44581684470176697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03209647908806801, decouple_loss:0.001694594626314938
The modified gen p mean: 0.44628292322158813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02909773960709572, decouple_loss:0.0018109665252268314
The modified gen p mean: 0.4460735619068146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03188953176140785, decouple_loss:0.0020013763569295406
2023-05-26 06:09:48 testing...
The modified gen p mean: 0.45202502608299255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03309693932533264, decouple_loss:0.0020268834196031094
The modified gen p mean: 0.4515455961227417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034623827785253525, decouple_loss:0.001991110621020198
The modified gen p mean: 0.44993817806243896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03339335322380066, decouple_loss:0.0019133543828502297
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03380356356501579, avg_mse: 0.045808371156454086
current test mse: 0.045808
Iteration: 491, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44618797302246094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029422057792544365, decouple_loss:0.0022690673358738422
The modified gen p mean: 0.4466422498226166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029750961810350418, decouple_loss:0.0022600223310291767
The modified gen p mean: 0.4496467113494873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030138133093714714, decouple_loss:0.0017088978784158826
Iteration: 492, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512437582015991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0282584298402071, decouple_loss:0.002055047545582056
The modified gen p mean: 0.44680267572402954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030454121530056, decouple_loss:0.0016762309242039919
The modified gen p mean: 0.451726496219635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029354965314269066, decouple_loss:0.001983038615435362
Iteration: 493, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45331844687461853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028827236965298653, decouple_loss:0.002642926760017872
The modified gen p mean: 0.4532395005226135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028001993894577026, decouple_loss:0.0029928339645266533
The modified gen p mean: 0.4482461214065552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02927575074136257, decouple_loss:0.0017991634085774422
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr_shift3.npz
NaN value num: 0
Iteration: 494, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44759824872016907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035715267062187195, decouple_loss:0.0017847690032795072
The modified gen p mean: 0.4486742913722992, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44801095128059387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035956088453531265, decouple_loss:0.0018204755615442991
loss_pred:0.03461533412337303, decouple_loss:0.0020477697253227234
Iteration: 495, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45484626293182373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03552522510290146, decouple_loss:0.00212004198692739
The modified gen p mean: 0.4478425681591034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03396506607532501, decouple_loss:0.00180157576687634
The modified gen p mean: 0.4555301070213318, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03393973782658577, decouple_loss:0.0018389727920293808
Iteration: 496, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45398521423339844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03578527644276619, decouple_loss:0.0017434248002246022
The modified gen p mean: 0.44789132475852966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034896720200777054, decouple_loss:0.001744396286085248
The modified gen p mean: 0.4501076638698578, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0345156155526638, decouple_loss:0.0018304702825844288
Iteration: 497, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44855621457099915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03274135664105415, decouple_loss:0.0015951457899063826
The modified gen p mean: 0.449720174074173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03325194865465164, decouple_loss:0.002020743675529957
The modified gen p mean: 0.45390740036964417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033605314791202545, decouple_loss:0.0017041821265593171
Iteration: 498, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44883838295936584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034985318779945374, decouple_loss:0.0018488713540136814
The modified gen p mean: 0.44935908913612366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03365073725581169, decouple_loss:0.0015967306680977345
The modified gen p mean: 0.44899606704711914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03359651565551758, decouple_loss:0.0016281211283057928
Iteration: 499, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45065444707870483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03427519649267197, decouple_loss:0.00172077224124223
The modified gen p mean: 0.44980645179748535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03388327360153198, decouple_loss:0.0016401471802964807
The modified gen p mean: 0.4480971395969391, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03217513859272003, decouple_loss:0.001702402369119227
Iteration: 500, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514550268650055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03335347771644592, decouple_loss:0.0019218650413677096
The modified gen p mean: 0.44701844453811646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03436678275465965, decouple_loss:0.0017118084942921996
The modified gen p mean: 0.45244795083999634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03365663066506386, decouple_loss:0.001777562079951167
2023-05-26 06:14:35 testing...
The modified gen p mean: 0.452554851770401, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265567868947983, decouple_loss:0.0018053425010293722
The modified gen p mean: 0.4507300853729248, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03285261243581772, decouple_loss:0.0017538858810439706
The modified gen p mean: 0.4523186981678009, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034162264317274094, decouple_loss:0.0017942290287464857
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03331274539232254, avg_mse: 0.04493920877575874
current test mse: 0.044939
Iteration: 501, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4538825750350952, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03337407857179642, decouple_loss:0.0017696317518129945
The modified gen p mean: 0.4457933306694031, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03367113694548607, decouple_loss:0.0015814881771802902
The modified gen p mean: 0.44534584879875183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03225956857204437, decouple_loss:0.0015442327130585909
Iteration: 502, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477720856666565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03356275334954262, decouple_loss:0.001627658144570887
The modified gen p mean: 0.44678571820259094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032521262764930725, decouple_loss:0.0017104558646678925
The modified gen p mean: 0.4488317668437958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03400704637169838, decouple_loss:0.0017270706593990326
Iteration: 503, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45160484313964844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0326133668422699, decouple_loss:0.001685229130089283
The modified gen p mean: 0.4524037539958954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261102735996246, decouple_loss:0.0017734006978571415
The modified gen p mean: 0.44709762930870056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032944630831480026, decouple_loss:0.0017155352979898453
Iteration: 504, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480886459350586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0322134755551815, decouple_loss:0.0016252336790785193
The modified gen p mean: 0.4507233202457428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03383613005280495, decouple_loss:0.0019772248342633247
The modified gen p mean: 0.4465058147907257, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03333514183759689, decouple_loss:0.001610422390513122
Iteration: 505, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44929251074790955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03190568834543228, decouple_loss:0.0016410594107583165
The modified gen p mean: 0.4539938271045685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03271220996975899, decouple_loss:0.0018256090115755796
The modified gen p mean: 0.4485916793346405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035014573484659195, decouple_loss:0.001677818945609033
Iteration: 506, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493005871772766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032589156180620193, decouple_loss:0.001637414563447237
The modified gen p mean: 0.45207828283309937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03244857117533684, decouple_loss:0.001635138993151486
The modified gen p mean: 0.44962477684020996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03198796883225441, decouple_loss:0.0015548468800261617
Iteration: 507, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4533543586730957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03339026868343353, decouple_loss:0.0016160638770088553
The modified gen p mean: 0.4494476020336151, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03421461209654808, decouple_loss:0.0016821735771372914
The modified gen p mean: 0.44999727606773376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03240315243601799, decouple_loss:0.0018000390846282244
Iteration: 508, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45259296894073486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033006682991981506, decouple_loss:0.0016520852223038673
The modified gen p mean: 0.4503619968891144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03144676983356476, decouple_loss:0.0016850893152877688
The modified gen p mean: 0.4522789716720581, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03514247015118599, decouple_loss:0.0018642556387931108
Iteration: 509, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45160818099975586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03467511758208275, decouple_loss:0.001675094710662961
The modified gen p mean: 0.44571906328201294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03486277908086777, decouple_loss:0.0015669367276132107
The modified gen p mean: 0.44739511609077454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03442810848355293, decouple_loss:0.0016426437068730593
Iteration: 510, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508633315563202, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03188915550708771, decouple_loss:0.0016667089657858014
The modified gen p mean: 0.4456312656402588, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032334793359041214, decouple_loss:0.0014727325178682804
The modified gen p mean: 0.4470663368701935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03417685627937317, decouple_loss:0.0017687766812741756
2023-05-26 06:18:44 testing...
The modified gen p mean: 0.4505484104156494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03237209469079971, decouple_loss:0.0016841765027493238
The modified gen p mean: 0.4506574273109436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03391702100634575, decouple_loss:0.0017410540021955967
The modified gen p mean: 0.4490816593170166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032511815428733826, decouple_loss:0.0016295893583446741
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03301789611577988, avg_mse: 0.04451191797852516
current test mse: 0.044512
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr.npz
NaN value num: 0
Iteration: 511, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44711270928382874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03310123831033707, decouple_loss:0.001646159216761589
The modified gen p mean: 0.44747039675712585, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4458881616592407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261088952422142, decouple_loss:0.0015749685699120164
loss_pred:0.0325005017220974, decouple_loss:0.001739750849083066
Iteration: 512, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461993873119354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0337224118411541, decouple_loss:0.001608549733646214
The modified gen p mean: 0.4479781687259674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03363289684057236, decouple_loss:0.0016137060010805726
The modified gen p mean: 0.4460180401802063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03305744379758835, decouple_loss:0.0015509279910475016
Iteration: 513, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495142996311188, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4507250189781189, gen p mean: 0.0, mean p set: 0.448loss_pred:0.033501479774713516, decouple_loss:0.0018208831315860152
loss_pred:0.033837150782346725, decouple_loss:0.0016700644046068192
The modified gen p mean: 0.447867214679718, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03297187015414238, decouple_loss:0.0017115483060479164
Iteration: 514, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44812309741973877, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035282835364341736, decouple_loss:0.0015072835376486182
The modified gen p mean: 0.4516061842441559, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03318437933921814, decouple_loss:0.0017154064262285829
The modified gen p mean: 0.4529415965080261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03355926275253296, decouple_loss:0.0017959133256226778
Iteration: 515, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44906890392303467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03323011100292206, decouple_loss:0.0015040274010971189
The modified gen p mean: 0.4526202082633972, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034772101789712906, decouple_loss:0.0016056291060522199
The modified gen p mean: 0.45111536979675293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033692002296447754, decouple_loss:0.0017384204547852278
Iteration: 516, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488848149776459, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03469456732273102, decouple_loss:0.0017005805857479572
The modified gen p mean: 0.45298823714256287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03392098844051361, decouple_loss:0.001689138705842197
The modified gen p mean: 0.4503215253353119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032248545438051224, decouple_loss:0.0013729064958170056
Iteration: 517, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44862914085388184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034278228878974915, decouple_loss:0.001566830207593739
The modified gen p mean: 0.45100897550582886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03403173014521599, decouple_loss:0.0018316954374313354
The modified gen p mean: 0.44781172275543213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03342209756374359, decouple_loss:0.0016334636602550745
Iteration: 518, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497959315776825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033087316900491714, decouple_loss:0.0016309894854202867
The modified gen p mean: 0.4499965012073517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03263406828045845, decouple_loss:0.001643851981498301
The modified gen p mean: 0.45048490166664124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033021170645952225, decouple_loss:0.001782595762051642
Iteration: 519, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485887587070465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033825330436229706, decouple_loss:0.0015902098966762424
The modified gen p mean: 0.4471791386604309, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03458405286073685, decouple_loss:0.0015312739415094256
The modified gen p mean: 0.44885390996932983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033154767006635666, decouple_loss:0.0015705199912190437
Iteration: 520, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44858992099761963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03480498492717743, decouple_loss:0.0015413040528073907
The modified gen p mean: 0.446556955575943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032961081713438034, decouple_loss:0.001531809801235795
The modified gen p mean: 0.450104296207428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03401318937540054, decouple_loss:0.0014462349936366081
2023-05-26 06:23:55 testing...
The modified gen p mean: 0.45309409499168396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032107096165418625, decouple_loss:0.0015825176378712058
The modified gen p mean: 0.4516906142234802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03232495114207268, decouple_loss:0.0015433470252901316
The modified gen p mean: 0.453352153301239, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033832158893346786, decouple_loss:0.001670598634518683
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032834675163030624, avg_mse: 0.04430808499455452
current test mse: 0.044308
Iteration: 521, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471033215522766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03282603621482849, decouple_loss:0.0014925617724657059
The modified gen p mean: 0.44824641942977905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03280771151185036, decouple_loss:0.0013628308661282063
The modified gen p mean: 0.4495140314102173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03285951167345047, decouple_loss:0.0017463063122704625
Iteration: 522, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45148926973342896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033995453268289566, decouple_loss:0.0019235112704336643
The modified gen p mean: 0.44827648997306824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034580811858177185, decouple_loss:0.0015983838820829988
The modified gen p mean: 0.44847407937049866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03275451809167862, decouple_loss:0.0013835893478244543
Iteration: 523, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44741177558898926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03285634145140648, decouple_loss:0.0014142651343718171
The modified gen p mean: 0.450162798166275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03317742422223091, decouple_loss:0.0014350771671161056
The modified gen p mean: 0.44742274284362793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033150848001241684, decouple_loss:0.0013249776093289256
Iteration: 524, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484570622444153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033207111060619354, decouple_loss:0.0015044014435261488
The modified gen p mean: 0.44753673672676086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03375256061553955, decouple_loss:0.0014631294179707766
The modified gen p mean: 0.44849079847335815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03455406427383423, decouple_loss:0.0014910852769389749
Iteration: 525, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462238848209381, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03139917925000191, decouple_loss:0.0013297522673383355
The modified gen p mean: 0.44975292682647705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03451423719525337, decouple_loss:0.0016721434658393264
The modified gen p mean: 0.4496126174926758, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03455055132508278, decouple_loss:0.0014903625706210732
Iteration: 526, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44628188014030457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0315319187939167, decouple_loss:0.0014163737650960684
The modified gen p mean: 0.44866564869880676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03323457017540932, decouple_loss:0.0016259223921224475
The modified gen p mean: 0.44606101512908936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03421080857515335, decouple_loss:0.0014415604528039694
Iteration: 527, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474593698978424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0352521575987339, decouple_loss:0.001406466937623918
The modified gen p mean: 0.4497123658657074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03350020572543144, decouple_loss:0.0016016988083720207
The modified gen p mean: 0.44912925362586975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03311664238572121, decouple_loss:0.0014863022370263934
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr.npz
NaN value num: 0
Iteration: 528, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499432146549225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027587777003645897, decouple_loss:0.0015960464952513576
The modified gen p mean: 0.4481884837150574, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4486943483352661, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029776616021990776, decouple_loss:0.0014801137149333954
loss_pred:0.029610522091388702, decouple_loss:0.0013982543023303151
Iteration: 529, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466327130794525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029926937073469162, decouple_loss:0.0015224935486912727
The modified gen p mean: 0.4500781297683716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02814311534166336, decouple_loss:0.0016258624382317066
The modified gen p mean: 0.4475294351577759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02966734580695629, decouple_loss:0.0015143927885219455
Iteration: 530, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44828668236732483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029051531106233597, decouple_loss:0.0016563317039981484
The modified gen p mean: 0.4485776722431183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028676370158791542, decouple_loss:0.0017816259060055017
The modified gen p mean: 0.45137688517570496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029911451041698456, decouple_loss:0.001805111183784902
2023-05-26 06:28:52 testing...
The modified gen p mean: 0.4533526599407196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031966857612133026, decouple_loss:0.001660928362980485
The modified gen p mean: 0.45180585980415344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032281629741191864, decouple_loss:0.0015533906407654285
The modified gen p mean: 0.45370814204216003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03383227437734604, decouple_loss:0.001679037231951952
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0327751450240612, avg_mse: 0.04422773793339729
current test mse: 0.044228
Iteration: 531, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44774577021598816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028645901009440422, decouple_loss:0.0017469488084316254
The modified gen p mean: 0.44923830032348633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028499526903033257, decouple_loss:0.0015557976439595222
The modified gen p mean: 0.45081642270088196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027350882068276405, decouple_loss:0.0019324899185448885
Iteration: 532, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44709306955337524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028797121718525887, decouple_loss:0.001584384823217988
The modified gen p mean: 0.4498365521430969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028326213359832764, decouple_loss:0.0015184528892859817
The modified gen p mean: 0.44853246212005615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028432175517082214, decouple_loss:0.0014256673166528344
Iteration: 533, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489959180355072, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02890588901937008, decouple_loss:0.0016055317828431726
The modified gen p mean: 0.4461500346660614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028253110125660896, decouple_loss:0.0015773773193359375
The modified gen p mean: 0.4454875588417053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029486339539289474, decouple_loss:0.0016903538489714265
Iteration: 534, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4426914155483246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028994834050536156, decouple_loss:0.0017092858906835318The modified gen p mean: 0.442855566740036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028529096394777298, decouple_loss:0.0017125302692875266
The modified gen p mean: 0.44290366768836975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028257178142666817, decouple_loss:0.0017003145767375827
Iteration: 535, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4435563087463379, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02863168716430664, decouple_loss:0.0018718848004937172
The modified gen p mean: 0.4442160427570343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02763102762401104, decouple_loss:0.0018634990556165576
The modified gen p mean: 0.441519558429718, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029523849487304688, decouple_loss:0.001787881599739194
Iteration: 536, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44160687923431396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028968779370188713, decouple_loss:0.0015573330456390977
The modified gen p mean: 0.44406142830848694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027810396626591682, decouple_loss:0.0017093446804210544
The modified gen p mean: 0.4479070007801056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02793550118803978, decouple_loss:0.0018132413970306516
Iteration: 537, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.439942330121994, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4431622326374054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02938135527074337, decouple_loss:0.0016856485744938254loss_pred:0.027567287907004356, decouple_loss:0.002354943659156561
The modified gen p mean: 0.4420047104358673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028465844690799713, decouple_loss:0.00177751702722162
Iteration: 538, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473860561847687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027931666001677513, decouple_loss:0.0019230571342632174
The modified gen p mean: 0.44265469908714294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027936358004808426, decouple_loss:0.0017827481497079134
The modified gen p mean: 0.44078296422958374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028165077790617943, decouple_loss:0.001791066606529057
Iteration: 539, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465627670288086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02833414077758789, decouple_loss:0.0019990024156868458
The modified gen p mean: 0.445500910282135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027359575033187866, decouple_loss:0.0020043677650392056
The modified gen p mean: 0.45028093457221985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02801920659840107, decouple_loss:0.002410238841548562
Iteration: 540, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505576491355896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02720668353140354, decouple_loss:0.002046682871878147
The modified gen p mean: 0.44704756140708923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02943260781466961, decouple_loss:0.001962431473657489
The modified gen p mean: 0.4457050561904907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028580425307154655, decouple_loss:0.0015822079731151462
2023-05-26 06:32:58 testing...
The modified gen p mean: 0.45521923899650574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251877427101135, decouple_loss:0.0018608142854645848
The modified gen p mean: 0.4555371403694153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03422543406486511, decouple_loss:0.0019572952296584845
The modified gen p mean: 0.4535706341266632, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032955002039670944, decouple_loss:0.001818215474486351
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03332700952887535, avg_mse: 0.04527448117733002
current test mse: 0.045274
Iteration: 541, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45286503434181213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028117086738348007, decouple_loss:0.0018323978874832392
The modified gen p mean: 0.45188453793525696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02760932222008705, decouple_loss:0.002020622603595257
The modified gen p mean: 0.4492517411708832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027877654880285263, decouple_loss:0.001977214589715004
Iteration: 542, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4543110132217407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027882708236575127, decouple_loss:0.0018122928449884057
The modified gen p mean: 0.45509299635887146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02694128267467022, decouple_loss:0.0020169615745544434
The modified gen p mean: 0.4504088759422302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029136037454009056, decouple_loss:0.0021470566280186176
Iteration: 543, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4523884057998657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02829756587743759, decouple_loss:0.0017605751054361463
The modified gen p mean: 0.4518645703792572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028564685955643654, decouple_loss:0.001888134516775608
The modified gen p mean: 0.456409215927124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026507532224059105, decouple_loss:0.0019360741134732962
Iteration: 544, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508742392063141, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028497867286205292, decouple_loss:0.0017640673322603106
The modified gen p mean: 0.45481348037719727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02761288359761238, decouple_loss:0.002314400626346469
The modified gen p mean: 0.45329907536506653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02699635922908783, decouple_loss:0.002018580911681056
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr.npz
NaN value num: 0
Iteration: 545, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45397061109542847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027969341725111008, decouple_loss:0.0018906693439930677
The modified gen p mean: 0.455415278673172, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027170952409505844, decouple_loss:0.0019653053022921085
The modified gen p mean: 0.4531235098838806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028314391151070595, decouple_loss:0.0018749167211353779
Iteration: 546, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503432810306549, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028014736250042915, decouple_loss:0.001779336598701775
The modified gen p mean: 0.4505408704280853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029822198674082756, decouple_loss:0.001908696605823934
The modified gen p mean: 0.45240724086761475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0280478335916996, decouple_loss:0.0018647413235157728
Iteration: 547, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463992714881897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02804684080183506, decouple_loss:0.0016740270657464862
The modified gen p mean: 0.4518328905105591, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0279695987701416, decouple_loss:0.0017368646804243326
The modified gen p mean: 0.45089399814605713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02782513201236725, decouple_loss:0.0018733915640041232
Iteration: 548, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492863118648529, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027479857206344604, decouple_loss:0.0017623797757551074
The modified gen p mean: 0.44915494322776794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02775757946074009, decouple_loss:0.0016890686238184571
The modified gen p mean: 0.45078155398368835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028128238394856453, decouple_loss:0.0018591972766444087
Iteration: 549, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44872358441352844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026779280975461006, decouple_loss:0.0016971579752862453
The modified gen p mean: 0.4496697783470154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02797795459628105, decouple_loss:0.0016299019334837794
The modified gen p mean: 0.4478514492511749, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02863127924501896, decouple_loss:0.0022073627915233374
Iteration: 550, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487769901752472, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783101052045822, decouple_loss:0.001889935927465558
The modified gen p mean: 0.4469040334224701, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02925519086420536, decouple_loss:0.0016058137407526374
The modified gen p mean: 0.44716283679008484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028600027784705162, decouple_loss:0.0016633747145533562
2023-05-26 06:37:42 testing...
The modified gen p mean: 0.45120325684547424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03257852420210838, decouple_loss:0.001812304137274623
The modified gen p mean: 0.44967013597488403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03286461904644966, decouple_loss:0.0017479456728324294
The modified gen p mean: 0.4514067769050598, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03418375179171562, decouple_loss:0.0018423569854348898
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03329901024699211, avg_mse: 0.04521045461297035
current test mse: 0.04521
Iteration: 551, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459961950778961, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028242865577340126, decouple_loss:0.0018242032965645194
The modified gen p mean: 0.4459593594074249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02800290286540985, decouple_loss:0.001678699511103332
The modified gen p mean: 0.44843152165412903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02794216014444828, decouple_loss:0.0015710992738604546
Iteration: 552, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44628414511680603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028772803023457527, decouple_loss:0.00167654559481889
The modified gen p mean: 0.45035991072654724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027688000351190567, decouple_loss:0.0015351071488112211
The modified gen p mean: 0.44658657908439636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028663983568549156, decouple_loss:0.0016352263046428561
Iteration: 553, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474385976791382, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02876085601747036, decouple_loss:0.001721346634440124
The modified gen p mean: 0.4475002586841583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027915503829717636, decouple_loss:0.0017292255070060492
The modified gen p mean: 0.4544823467731476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02858373150229454, decouple_loss:0.0016305367462337017
Iteration: 554, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489065408706665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027783378958702087, decouple_loss:0.0016321996226906776
The modified gen p mean: 0.44870248436927795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027828659862279892, decouple_loss:0.0018920537550002337
The modified gen p mean: 0.448689341545105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028711797669529915, decouple_loss:0.001639898749999702
Iteration: 555, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4558378756046295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02827964909374714, decouple_loss:0.0017955759540200233
The modified gen p mean: 0.4522016644477844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028565730899572372, decouple_loss:0.001738297869451344
The modified gen p mean: 0.4480331242084503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028593797236680984, decouple_loss:0.0016443105414509773
Iteration: 556, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4538498818874359, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027738187462091446, decouple_loss:0.0016607032157480717
The modified gen p mean: 0.45496779680252075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028132114559412003, decouple_loss:0.0022361271549016237
The modified gen p mean: 0.45046094059944153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030018437653779984, decouple_loss:0.0017161993309855461
Iteration: 557, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506637752056122, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028247680515050888, decouple_loss:0.001711918506771326
The modified gen p mean: 0.4533577561378479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027499709278345108, decouple_loss:0.0016602131072431803
The modified gen p mean: 0.4530007839202881, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028511399403214455, decouple_loss:0.0016232877969741821
Iteration: 558, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45198532938957214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028945114463567734, decouple_loss:0.0016614627093076706
The modified gen p mean: 0.44931739568710327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027793342247605324, decouple_loss:0.0016468324465677142
The modified gen p mean: 0.4505537152290344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029534950852394104, decouple_loss:0.0016323472373187542
Iteration: 559, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4528069496154785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027544161304831505, decouple_loss:0.0016557733761146665
The modified gen p mean: 0.45270007848739624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027966508641839027, decouple_loss:0.0017602394800633192
The modified gen p mean: 0.448353111743927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028503399342298508, decouple_loss:0.0016862903721630573
Iteration: 560, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499225318431854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027933789417147636, decouple_loss:0.0016023798380047083
The modified gen p mean: 0.44916197657585144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02723640762269497, decouple_loss:0.0016466197557747364
The modified gen p mean: 0.448535680770874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028979448601603508, decouple_loss:0.0017926765140146017
2023-05-26 06:41:47 testing...
The modified gen p mean: 0.4539091885089874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032821863889694214, decouple_loss:0.0017867917194962502
The modified gen p mean: 0.45217564702033997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03312712162733078, decouple_loss:0.001703195390291512
The modified gen p mean: 0.4539487957954407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0344238318502903, decouple_loss:0.001795098534785211
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03354569151997566, avg_mse: 0.0456131286919117
current test mse: 0.045613
Iteration: 561, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489661157131195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027241170406341553, decouple_loss:0.0016838146839290857
The modified gen p mean: 0.45365431904792786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028515491634607315, decouple_loss:0.0017792717553675175
The modified gen p mean: 0.44980132579803467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02709336206316948, decouple_loss:0.0019016332225874066
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr.npz
NaN value num: 0
Iteration: 562, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444299578666687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028883755207061768, decouple_loss:0.0019903178326785564
The modified gen p mean: 0.44879159331321716, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.448494017124176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028655551373958588, decouple_loss:0.0017913790652528405
loss_pred:0.02888019196689129, decouple_loss:0.0018889751518145204
Iteration: 563, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44873061776161194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027936790138483047, decouple_loss:0.0023948990274220705
The modified gen p mean: 0.44881683588027954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673107013106346, decouple_loss:0.0015827590832486749
The modified gen p mean: 0.447529673576355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026499925181269646, decouple_loss:0.0018132751574739814
Iteration: 564, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487152695655823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02733408845961094, decouple_loss:0.0020910105668008327
The modified gen p mean: 0.4466027617454529, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027531279250979424, decouple_loss:0.001977842301130295
The modified gen p mean: 0.44788217544555664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028194421902298927, decouple_loss:0.002007488626986742
Iteration: 565, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476030170917511, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028190575540065765, decouple_loss:0.0017162110889330506
The modified gen p mean: 0.4414557218551636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028435030952095985, decouple_loss:0.0018558627925813198
The modified gen p mean: 0.44389525055885315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028338126838207245, decouple_loss:0.0017128580948337913
Iteration: 566, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44252291321754456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027779491618275642, decouple_loss:0.0017139747506007552
The modified gen p mean: 0.44660139083862305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02602365054190159, decouple_loss:0.0019759389106184244
The modified gen p mean: 0.44691306352615356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02856963872909546, decouple_loss:0.002028526272624731
Iteration: 567, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4420556426048279, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028960129246115685, decouple_loss:0.0017734901048243046
The modified gen p mean: 0.4442424178123474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027028441429138184, decouple_loss:0.002017437480390072
The modified gen p mean: 0.4423747658729553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028404386714100838, decouple_loss:0.0017703112680464983
Iteration: 568, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480472803115845, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44285058975219727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027205370366573334, decouple_loss:0.001999098341912031
loss_pred:0.02879144437611103, decouple_loss:0.0018404140137135983
The modified gen p mean: 0.4407567083835602, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028122033923864365, decouple_loss:0.0016860152827575803
Iteration: 569, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470102787017822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02671140246093273, decouple_loss:0.001613653963431716
The modified gen p mean: 0.44362562894821167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0279061459004879, decouple_loss:0.0018909218488261104
The modified gen p mean: 0.4457297623157501, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028139187023043633, decouple_loss:0.0016774304676800966
Iteration: 570, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460398554801941, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028300637379288673, decouple_loss:0.0016882107593119144
The modified gen p mean: 0.44359850883483887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028211841359734535, decouple_loss:0.0018417208921164274
The modified gen p mean: 0.4456404149532318, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028745634481310844, decouple_loss:0.0017574004596099257
2023-05-26 06:46:33 testing...
The modified gen p mean: 0.45210954546928406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259933367371559, decouple_loss:0.0017281295731663704
The modified gen p mean: 0.45043855905532837, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45193836092948914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03291039541363716, decouple_loss:0.0016710080672055483
loss_pred:0.03414949029684067, decouple_loss:0.001795744290575385
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03330632299184799, avg_mse: 0.04520973190665245
current test mse: 0.04521
Iteration: 571, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471626877784729, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028548220172524452, decouple_loss:0.0019190722377970815
The modified gen p mean: 0.44972142577171326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02717488259077072, decouple_loss:0.001932272338308394
The modified gen p mean: 0.44559088349342346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028214557096362114, decouple_loss:0.0015754912747070193
Iteration: 572, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464016854763031, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44836190342903137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027927609160542488, decouple_loss:0.0016751104267314076loss_pred:0.027662158012390137, decouple_loss:0.001724048051983118
The modified gen p mean: 0.44710078835487366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028198670595884323, decouple_loss:0.0016939891502261162
Iteration: 573, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451480895280838, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4469734728336334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027618195861577988, decouple_loss:0.0021345107816159725
loss_pred:0.02895970828831196, decouple_loss:0.0017209909856319427
The modified gen p mean: 0.4528133273124695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026885829865932465, decouple_loss:0.0017234054394066334
Iteration: 574, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44734081625938416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028162555769085884, decouple_loss:0.0016343146562576294
The modified gen p mean: 0.45334339141845703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02694857120513916, decouple_loss:0.001732483273372054
The modified gen p mean: 0.4453352093696594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02840884029865265, decouple_loss:0.0016442480264231563
Iteration: 575, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483095109462738, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027205774560570717, decouple_loss:0.0018923789029940963
The modified gen p mean: 0.4492539167404175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026446981355547905, decouple_loss:0.0015087794745340943
The modified gen p mean: 0.4481484293937683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02569860965013504, decouple_loss:0.0015806437004357576
Iteration: 576, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45105332136154175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02837512642145157, decouple_loss:0.0016519679920747876
The modified gen p mean: 0.4445088505744934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028915494680404663, decouple_loss:0.0016350244404748082
The modified gen p mean: 0.4511532783508301, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02902251109480858, decouple_loss:0.001862952602095902
Iteration: 577, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519791603088379, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612314186990261, decouple_loss:0.0017980897100642323
The modified gen p mean: 0.44637537002563477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02677227184176445, decouple_loss:0.0017883910331875086
The modified gen p mean: 0.4452953636646271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028981370851397514, decouple_loss:0.0019827610813081264
Iteration: 578, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489828944206238, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026814429089426994, decouple_loss:0.0018763703992590308
The modified gen p mean: 0.4488844573497772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027803583070635796, decouple_loss:0.0023538144305348396
The modified gen p mean: 0.44877657294273376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026689041405916214, decouple_loss:0.0016305563040077686
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr.npz
NaN value num: 0
Iteration: 579, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485066533088684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03309750184416771, decouple_loss:0.0018119481392204762
The modified gen p mean: 0.4487936198711395, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4479575455188751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03550313785672188, decouple_loss:0.0018551404355093837
loss_pred:0.032783377915620804, decouple_loss:0.002000712789595127
Iteration: 580, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504026174545288, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03445228561758995, decouple_loss:0.001781061990186572
The modified gen p mean: 0.44511327147483826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03483971953392029, decouple_loss:0.0016040831105783582
The modified gen p mean: 0.4477212131023407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03140828385949135, decouple_loss:0.0017695248825475574
2023-05-26 06:51:29 testing...
The modified gen p mean: 0.4543853998184204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03250463679432869, decouple_loss:0.001722965156659484
The modified gen p mean: 0.4528648257255554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03293057903647423, decouple_loss:0.0016641966067254543
The modified gen p mean: 0.45426225662231445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034101542085409164, decouple_loss:0.0018074589315801859
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03326549381017685, avg_mse: 0.04513698071241379
current test mse: 0.045137
Iteration: 581, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44922423362731934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03532274439930916, decouple_loss:0.0017482206458225846
The modified gen p mean: 0.4477941691875458, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03234344720840454, decouple_loss:0.0017589733470231295
The modified gen p mean: 0.45248764753341675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03234192356467247, decouple_loss:0.0018184944055974483
Iteration: 582, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4559430181980133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032710492610931396, decouple_loss:0.0016961400397121906
The modified gen p mean: 0.45556172728538513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031669676303863525, decouple_loss:0.001733474200591445
The modified gen p mean: 0.45270368456840515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0316169299185276, decouple_loss:0.0016781497979536653
Iteration: 583, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4588577449321747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03240634873509407, decouple_loss:0.0016858222661539912
The modified gen p mean: 0.4547868072986603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265078365802765, decouple_loss:0.001697239000350237
The modified gen p mean: 0.45640286803245544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033748187124729156, decouple_loss:0.001678141881711781
Iteration: 584, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45973941683769226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0340130478143692, decouple_loss:0.0016816038405522704
The modified gen p mean: 0.4572919011116028, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03235315531492233, decouple_loss:0.001704792259261012
The modified gen p mean: 0.45649850368499756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03185070678591728, decouple_loss:0.0016557511407881975
Iteration: 585, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4584653973579407, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45877009630203247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03370281681418419, decouple_loss:0.0017314573051407933
loss_pred:0.03283435106277466, decouple_loss:0.0017326811794191599
The modified gen p mean: 0.46054333448410034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03328344225883484, decouple_loss:0.001659835921600461
Iteration: 586, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45289146900177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033188171684741974, decouple_loss:0.0016673995414748788
The modified gen p mean: 0.45134395360946655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03256318345665932, decouple_loss:0.0015486945630982518
The modified gen p mean: 0.45367592573165894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03476988151669502, decouple_loss:0.0016175721539184451
Iteration: 587, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4562036097049713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032128240913152695, decouple_loss:0.001818230259232223
The modified gen p mean: 0.4571983218193054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031752828508615494, decouple_loss:0.001522077713161707
The modified gen p mean: 0.4544958472251892, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032525599002838135, decouple_loss:0.001441093278117478
Iteration: 588, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.456142395734787, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4559299051761627, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03358089551329613, decouple_loss:0.001556074246764183
loss_pred:0.03236868605017662, decouple_loss:0.001749297953210771
The modified gen p mean: 0.4534878432750702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03228937089443207, decouple_loss:0.001735858852043748
Iteration: 589, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4548643231391907, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4573539197444916, gen p mean: 0.0, mean p set: 0.448loss_pred:0.03253096342086792, decouple_loss:0.0014854430919513106
loss_pred:0.033508799970149994, decouple_loss:0.0018213255098089576
The modified gen p mean: 0.44950103759765625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03275527060031891, decouple_loss:0.0016428814269602299
Iteration: 590, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502313733100891, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246987238526344, decouple_loss:0.0016308561898767948
The modified gen p mean: 0.45271509885787964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034532736986875534, decouple_loss:0.0015111727407202125
The modified gen p mean: 0.45082545280456543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033647555857896805, decouple_loss:0.0015238018240779638
2023-05-26 06:55:36 testing...
The modified gen p mean: 0.45198169350624084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032220110297203064, decouple_loss:0.0017767319222912192
The modified gen p mean: 0.4503968358039856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032729968428611755, decouple_loss:0.0017119531985372305
The modified gen p mean: 0.45169416069984436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0338287428021431, decouple_loss:0.0018282048404216766
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03301488980650902, avg_mse: 0.044556356966495514
current test mse: 0.044556
Iteration: 591, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475794732570648, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033773504197597504, decouple_loss:0.0015977398725226521
The modified gen p mean: 0.4463748037815094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03465166315436363, decouple_loss:0.0016339861322194338
The modified gen p mean: 0.4456014931201935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032470766454935074, decouple_loss:0.0015966442879289389
Iteration: 592, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44653597474098206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03337329253554344, decouple_loss:0.0016172699397429824
The modified gen p mean: 0.4455539286136627, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03457101806998253, decouple_loss:0.0014632485108450055
The modified gen p mean: 0.44567471742630005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033823028206825256, decouple_loss:0.0015693000750616193
Iteration: 593, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472216069698334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03237291797995567, decouple_loss:0.0016338889254257083
The modified gen p mean: 0.4428820013999939, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03337428346276283, decouple_loss:0.0015115715796127915
The modified gen p mean: 0.4444636404514313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03324965015053749, decouple_loss:0.0013868394307792187
Iteration: 594, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44337543845176697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033216241747140884, decouple_loss:0.001487518660724163
The modified gen p mean: 0.4431576728820801, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033483076840639114, decouple_loss:0.0015793112106621265
The modified gen p mean: 0.4431910216808319, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032323818653821945, decouple_loss:0.0015978311421349645
Iteration: 595, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474388659000397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03309183940291405, decouple_loss:0.0015576534206047654
The modified gen p mean: 0.4431670606136322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032637856900691986, decouple_loss:0.0016139401122927666
The modified gen p mean: 0.4413035213947296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03130776435136795, decouple_loss:0.001425210852175951
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr_shift3.npz
NaN value num: 0
Iteration: 596, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4423743486404419, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03023858740925789, decouple_loss:0.0017638533608987927
The modified gen p mean: 0.4422326385974884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03094208426773548, decouple_loss:0.0015789573080837727
The modified gen p mean: 0.44493651390075684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028863990679383278, decouple_loss:0.002074376679956913
Iteration: 597, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444307416677475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030417155474424362, decouple_loss:0.0016931910067796707
The modified gen p mean: 0.4430590271949768, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03060327284038067, decouple_loss:0.0016242086421698332
The modified gen p mean: 0.4438110888004303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03112698905169964, decouple_loss:0.0017893180483952165
Iteration: 598, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44749900698661804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02896564081311226, decouple_loss:0.0016921978676691651
The modified gen p mean: 0.44357627630233765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029601378366351128, decouple_loss:0.001674933941103518
The modified gen p mean: 0.4468218982219696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03036332130432129, decouple_loss:0.0017524396535009146
Iteration: 599, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4430963397026062, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03000539541244507, decouple_loss:0.0015877365367487073
The modified gen p mean: 0.44676974415779114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028901031240820885, decouple_loss:0.0016709022456780076
The modified gen p mean: 0.44400522112846375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030358700081706047, decouple_loss:0.002068731701001525
Iteration: 600, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445672869682312, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4443225860595703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03086869977414608, decouple_loss:0.0017441526288166642
loss_pred:0.02891085483133793, decouple_loss:0.0016969761345535517
The modified gen p mean: 0.4441804587841034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03148629143834114, decouple_loss:0.0017831869190558791
2023-05-26 07:00:22 testing...
The modified gen p mean: 0.4506959915161133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03228476271033287, decouple_loss:0.0017478474183008075
The modified gen p mean: 0.44913291931152344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032714489847421646, decouple_loss:0.001667842734605074
The modified gen p mean: 0.450235515832901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033723704516887665, decouple_loss:0.001728433882817626
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032993391156196594, avg_mse: 0.0444951131939888
current test mse: 0.044495
Iteration: 601, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44293972849845886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03116527386009693, decouple_loss:0.0017836206825450063
The modified gen p mean: 0.4478270411491394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029730867594480515, decouple_loss:0.0017715891590341926
The modified gen p mean: 0.4471059739589691, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029650352895259857, decouple_loss:0.0016749073984101415
Iteration: 602, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459829330444336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029836099594831467, decouple_loss:0.0016987868584692478
The modified gen p mean: 0.4487527310848236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029174163937568665, decouple_loss:0.0016354502877220511
The modified gen p mean: 0.44742125272750854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029133528470993042, decouple_loss:0.0017324744258075953
Iteration: 603, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492163062095642, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02921818569302559, decouple_loss:0.0019188527949154377
The modified gen p mean: 0.446548730134964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027517665177583694, decouple_loss:0.001914584543555975
The modified gen p mean: 0.44379159808158875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03061087802052498, decouple_loss:0.001595207373611629
Iteration: 604, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44703224301338196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02946653589606285, decouple_loss:0.0016388670774176717
The modified gen p mean: 0.44847971200942993, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029698986560106277, decouple_loss:0.0019089773995801806
The modified gen p mean: 0.445938378572464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029692411422729492, decouple_loss:0.0019311661599203944
Iteration: 605, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44321227073669434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030176902189850807, decouple_loss:0.0015625437954440713
The modified gen p mean: 0.44557449221611023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028685910627245903, decouple_loss:0.001934558735229075
The modified gen p mean: 0.4480690062046051, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029454350471496582, decouple_loss:0.001835735747590661
Iteration: 606, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459410011768341, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029836975038051605, decouple_loss:0.0016526903491467237
The modified gen p mean: 0.4446006715297699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030500173568725586, decouple_loss:0.001760820858180523
The modified gen p mean: 0.44630667567253113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029749935492873192, decouple_loss:0.0018496512202546
Iteration: 607, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4437348246574402, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03038472682237625, decouple_loss:0.0020313793793320656
The modified gen p mean: 0.44497808814048767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02803434245288372, decouple_loss:0.0017453297041356564
The modified gen p mean: 0.44264665246009827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030509212985634804, decouple_loss:0.0019218835514038801
Iteration: 608, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.443678617477417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0312693826854229, decouple_loss:0.0017850466538220644
The modified gen p mean: 0.4456140100955963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028072891756892204, decouple_loss:0.0018541684839874506
The modified gen p mean: 0.44530031085014343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03133524954319, decouple_loss:0.0018938698340207338
Iteration: 609, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452139437198639, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030044814571738243, decouple_loss:0.0019842195324599743
The modified gen p mean: 0.4477008879184723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028606249019503593, decouple_loss:0.0019196931971237063
The modified gen p mean: 0.44350409507751465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03079690784215927, decouple_loss:0.0017498154193162918
Iteration: 610, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464036822319031, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029986176639795303, decouple_loss:0.0018741723615676165
The modified gen p mean: 0.44759151339530945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02975892648100853, decouple_loss:0.0021553663536906242
The modified gen p mean: 0.44648176431655884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02720244787633419, decouple_loss:0.0019662154372781515
2023-05-26 07:04:28 testing...
The modified gen p mean: 0.45106130838394165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032718222588300705, decouple_loss:0.0019337189150974154
The modified gen p mean: 0.4495050609111786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03317208215594292, decouple_loss:0.0017535124206915498
The modified gen p mean: 0.45040667057037354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034177716821432114, decouple_loss:0.0018993220292031765
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03344911336898804, avg_mse: 0.04524540156126022
current test mse: 0.045245
Iteration: 611, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484381079673767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02956789918243885, decouple_loss:0.0016706414753571153
The modified gen p mean: 0.4462631642818451, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029543938115239143, decouple_loss:0.0015205859672278166
The modified gen p mean: 0.44654378294944763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029909592121839523, decouple_loss:0.0022742708679288626
Iteration: 612, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480091631412506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029778193682432175, decouple_loss:0.0019157021306455135
The modified gen p mean: 0.444682776927948, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03089059330523014, decouple_loss:0.0018375975778326392
The modified gen p mean: 0.4453757703304291, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029890859499573708, decouple_loss:0.001883804565295577
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr_shift3.npz
NaN value num: 0
Iteration: 613, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503411650657654, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44647902250289917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027944985777139664, decouple_loss:0.0017046696739271283
loss_pred:0.028716880828142166, decouple_loss:0.0019644335843622684
The modified gen p mean: 0.4484896659851074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029071947559714317, decouple_loss:0.0017666916828602552
Iteration: 614, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448569655418396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028556257486343384, decouple_loss:0.0017570806667208672
The modified gen p mean: 0.4481130540370941, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028426937758922577, decouple_loss:0.001689054537564516
The modified gen p mean: 0.4475381672382355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03001592308282852, decouple_loss:0.0018719021463766694
Iteration: 615, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44674402475357056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030246861279010773, decouple_loss:0.0020808849949389696
The modified gen p mean: 0.44680216908454895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029171718284487724, decouple_loss:0.001858553383499384
The modified gen p mean: 0.4506710171699524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02874673902988434, decouple_loss:0.0018501318991184235
Iteration: 616, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493558704853058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02904587984085083, decouple_loss:0.001691316720098257
The modified gen p mean: 0.4476736783981323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029214033856987953, decouple_loss:0.001712258206680417
The modified gen p mean: 0.4506613314151764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02895078808069229, decouple_loss:0.0020153841469436884
Iteration: 617, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45017969608306885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028996102511882782, decouple_loss:0.0016508657718077302
The modified gen p mean: 0.45091739296913147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027004355564713478, decouple_loss:0.0019107346888631582
The modified gen p mean: 0.45132896304130554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0278472937643528, decouple_loss:0.0019140917574986815
Iteration: 618, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497431218624115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029188573360443115, decouple_loss:0.0019172796746715903
The modified gen p mean: 0.4529828131198883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027964822947978973, decouple_loss:0.0017809770070016384
The modified gen p mean: 0.45470327138900757, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02819139137864113, decouple_loss:0.0018774967174977064
Iteration: 619, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45126113295555115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02846730314195156, decouple_loss:0.002077754819765687
The modified gen p mean: 0.45167025923728943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02994108945131302, decouple_loss:0.0020049752201884985
The modified gen p mean: 0.45514559745788574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028086336329579353, decouple_loss:0.002011920092627406
Iteration: 620, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45170173048973083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027455952018499374, decouple_loss:0.002010215539485216
The modified gen p mean: 0.452014297246933, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028730295598506927, decouple_loss:0.0018598629394546151
The modified gen p mean: 0.45195066928863525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027370955795049667, decouple_loss:0.002093004761263728
2023-05-26 07:09:21 testing...
The modified gen p mean: 0.4536052346229553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03324275091290474, decouple_loss:0.0018915735417976975
The modified gen p mean: 0.45185935497283936, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4531157612800598, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033747654408216476, decouple_loss:0.0017454642802476883
loss_pred:0.03508791700005531, decouple_loss:0.001883083488792181
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.034118108451366425, avg_mse: 0.04636886343359947
current test mse: 0.046369
Iteration: 621, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483140707015991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027844034135341644, decouple_loss:0.0015808043535798788
The modified gen p mean: 0.4522511065006256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02669028379023075, decouple_loss:0.002001202665269375
The modified gen p mean: 0.44713306427001953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02881748043000698, decouple_loss:0.001644133240915835
Iteration: 622, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4530647099018097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028160378336906433, decouple_loss:0.0017349496483802795
The modified gen p mean: 0.44662022590637207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028979932889342308, decouple_loss:0.0018779441015794873
The modified gen p mean: 0.44698622822761536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028600391000509262, decouple_loss:0.0015870010247454047
Iteration: 623, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44975534081459045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027334794402122498, decouple_loss:0.0019710776396095753
The modified gen p mean: 0.44862690567970276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027912212535738945, decouple_loss:0.0017027989961206913
The modified gen p mean: 0.44651317596435547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027729341760277748, decouple_loss:0.0019242215203121305
Iteration: 624, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484335482120514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027608761563897133, decouple_loss:0.0019498101901262999
The modified gen p mean: 0.4444308876991272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02927173487842083, decouple_loss:0.002035742159932852
The modified gen p mean: 0.4527284801006317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028122885152697563, decouple_loss:0.0017913427436724305
Iteration: 625, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461855888366699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028817791491746902, decouple_loss:0.001656525069847703
The modified gen p mean: 0.4458208382129669, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02855871059000492, decouple_loss:0.0017342553474009037
The modified gen p mean: 0.44698455929756165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0287922453135252, decouple_loss:0.001654639607295394
Iteration: 626, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44777700304985046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027549780905246735, decouple_loss:0.0017864310648292303
The modified gen p mean: 0.4503137469291687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027653895318508148, decouple_loss:0.0017829984426498413
The modified gen p mean: 0.4490770101547241, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028235649690032005, decouple_loss:0.0016423227498307824
Iteration: 627, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469166398048401, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02896770089864731, decouple_loss:0.0017949506873264909
The modified gen p mean: 0.44632986187934875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771097607910633, decouple_loss:0.0019311620853841305
The modified gen p mean: 0.4472648799419403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028348678722977638, decouple_loss:0.0020584447775036097
Iteration: 628, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486827850341797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02714780904352665, decouple_loss:0.0018452635267749429
The modified gen p mean: 0.44773831963539124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027530184015631676, decouple_loss:0.0017708024242892861
The modified gen p mean: 0.44637471437454224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02907479926943779, decouple_loss:0.0016788074281066656
Iteration: 629, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446672260761261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028011539950966835, decouple_loss:0.001657169428654015
The modified gen p mean: 0.45027387142181396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028045879676938057, decouple_loss:0.0018111250828951597
The modified gen p mean: 0.4455796778202057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028885236009955406, decouple_loss:0.001673322869464755
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr.npz
NaN value num: 0
Iteration: 630, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44687336683273315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030584126710891724, decouple_loss:0.0017478402005508542
The modified gen p mean: 0.447675496339798, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44739991426467896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030147073790431023, decouple_loss:0.002004047390073538
loss_pred:0.030263766646385193, decouple_loss:0.002075267257168889
2023-05-26 07:14:09 testing...
The modified gen p mean: 0.45042046904563904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03284484148025513, decouple_loss:0.001995708327740431
The modified gen p mean: 0.44903242588043213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033256109803915024, decouple_loss:0.0018971317913383245
The modified gen p mean: 0.45043396949768066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03460593521595001, decouple_loss:0.002013957127928734
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03366740792989731, avg_mse: 0.04576895013451576
current test mse: 0.045769
Iteration: 631, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456571042537689, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027575545012950897, decouple_loss:0.0015778372762724757
The modified gen p mean: 0.4482351243495941, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027053633704781532, decouple_loss:0.0017017326317727566
The modified gen p mean: 0.4463776648044586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028108783066272736, decouple_loss:0.0018599664326757193
Iteration: 632, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475841522216797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02743552438914776, decouple_loss:0.0020619702991098166
The modified gen p mean: 0.4437035620212555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029189979657530785, decouple_loss:0.00184197211638093
The modified gen p mean: 0.4449597895145416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028407372534275055, decouple_loss:0.0020789976697415113
Iteration: 633, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44462892413139343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028777655214071274, decouple_loss:0.0018199809128418565
The modified gen p mean: 0.4444458484649658, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028416162356734276, decouple_loss:0.0017623589374125004
The modified gen p mean: 0.4471137225627899, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02739853225648403, decouple_loss:0.0018356534419581294
Iteration: 634, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452243149280548, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028556959703564644, decouple_loss:0.001790064969100058
The modified gen p mean: 0.4433208703994751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028961624950170517, decouple_loss:0.0018092542886734009
The modified gen p mean: 0.44553640484809875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027515117079019547, decouple_loss:0.00174499221611768
Iteration: 635, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491553008556366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02702113799750805, decouple_loss:0.001784508815035224
The modified gen p mean: 0.44833943247795105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02704622969031334, decouple_loss:0.0018054918618872762
The modified gen p mean: 0.4449758529663086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028103290125727654, decouple_loss:0.0017033464973792434
Iteration: 636, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45067381858825684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026696154847741127, decouple_loss:0.001784732099622488
The modified gen p mean: 0.4460340738296509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029155852273106575, decouple_loss:0.001739413826726377
The modified gen p mean: 0.44496166706085205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028209613636136055, decouple_loss:0.0017729471437633038
Iteration: 637, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44900253415107727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028291266411542892, decouple_loss:0.0017454777844250202
The modified gen p mean: 0.4443245232105255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028016865253448486, decouple_loss:0.0018936197739094496
The modified gen p mean: 0.4455215632915497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028401631861925125, decouple_loss:0.0018098397413268685
Iteration: 638, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44278794527053833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0285639651119709, decouple_loss:0.0017776457825675607
The modified gen p mean: 0.4429892897605896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028779497370123863, decouple_loss:0.0016817511059343815
The modified gen p mean: 0.44481444358825684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028545647859573364, decouple_loss:0.0016661970876157284
Iteration: 639, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44415804743766785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028180571272969246, decouple_loss:0.0016780637670308352
The modified gen p mean: 0.4459340572357178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028263302519917488, decouple_loss:0.0018304151017218828
The modified gen p mean: 0.44437673687934875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027107104659080505, decouple_loss:0.0017879524966701865
Iteration: 640, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446609616279602, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02698875591158867, decouple_loss:0.0018961161840707064
The modified gen p mean: 0.444745808839798, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026084894314408302, decouple_loss:0.0019565210677683353
The modified gen p mean: 0.4417295753955841, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02848188579082489, decouple_loss:0.0017089106841012836
2023-05-26 07:18:15 testing...
The modified gen p mean: 0.4495576322078705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032983243465423584, decouple_loss:0.0019780597649514675
The modified gen p mean: 0.4482199549674988, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033151715993881226, decouple_loss:0.0018364634597674012
The modified gen p mean: 0.44974812865257263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034344758838415146, decouple_loss:0.002004376845434308
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033590223640203476, avg_mse: 0.045521434396505356
current test mse: 0.045521
Iteration: 641, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444134384393692, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026356376707553864, decouple_loss:0.0018511847592890263
The modified gen p mean: 0.4450059235095978, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025985725224018097, decouple_loss:0.0019974519964307547
The modified gen p mean: 0.4454389810562134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029753904789686203, decouple_loss:0.0019407477229833603
Iteration: 642, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459168314933777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02739078365266323, decouple_loss:0.0018745050765573978
The modified gen p mean: 0.4454466700553894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02763785794377327, decouple_loss:0.0017487576697021723
The modified gen p mean: 0.44651052355766296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026597268879413605, decouple_loss:0.0018623998621478677
Iteration: 643, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44949838519096375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028008634224534035, decouple_loss:0.0018598141614347696
The modified gen p mean: 0.44540947675704956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028645986691117287, decouple_loss:0.002076967852190137
The modified gen p mean: 0.44621920585632324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027921516448259354, decouple_loss:0.0018549591768532991
Iteration: 644, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467501938343048, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02903144434094429, decouple_loss:0.001966688083484769
The modified gen p mean: 0.44829076528549194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026711279526352882, decouple_loss:0.0018119169399142265
The modified gen p mean: 0.4485253691673279, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02698569744825363, decouple_loss:0.0021886071190238
Iteration: 645, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487196207046509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025488706305623055, decouple_loss:0.0018688526470214128
The modified gen p mean: 0.447913259267807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028431061655282974, decouple_loss:0.002012719865888357
The modified gen p mean: 0.44648995995521545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026463337242603302, decouple_loss:0.001981449546292424
Iteration: 646, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44731834530830383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028199220076203346, decouple_loss:0.0017878812504932284
The modified gen p mean: 0.449115127325058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027284400537610054, decouple_loss:0.0019027277594432235
The modified gen p mean: 0.4480971395969391, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028138205409049988, decouple_loss:0.001756020006723702
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr.npz
NaN value num: 0
Iteration: 647, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484311640262604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03441810980439186, decouple_loss:0.0018881990108639002
The modified gen p mean: 0.4482055604457855, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4480612277984619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03285925090312958, decouple_loss:0.0018373014172539115
loss_pred:0.03398824483156204, decouple_loss:0.002199313836172223
Iteration: 648, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45145559310913086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0326099619269371, decouple_loss:0.0020143832080066204
The modified gen p mean: 0.4469406306743622, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035084549337625504, decouple_loss:0.001858174568042159
The modified gen p mean: 0.44616445899009705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031358178704977036, decouple_loss:0.0017986928578466177
Iteration: 649, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518634080886841, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033603645861148834, decouple_loss:0.0018380595138296485
The modified gen p mean: 0.4539080262184143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034082990139722824, decouple_loss:0.0018758896039798856
The modified gen p mean: 0.45264896750450134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251783549785614, decouple_loss:0.0018774335039779544
Iteration: 650, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45045071840286255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0335831455886364, decouple_loss:0.0019064666703343391
The modified gen p mean: 0.44930145144462585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033162400126457214, decouple_loss:0.0017011266900226474
The modified gen p mean: 0.45048290491104126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03418302536010742, decouple_loss:0.0017380118370056152
2023-05-26 07:23:02 testing...
The modified gen p mean: 0.4573974013328552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03248281031847, decouple_loss:0.0018538854783400893
The modified gen p mean: 0.45622316002845764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03276922181248665, decouple_loss:0.0017536311643198133
The modified gen p mean: 0.45744267106056213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03387963026762009, decouple_loss:0.0018817468080669641
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03313537687063217, avg_mse: 0.044699814170598984
current test mse: 0.0447
Iteration: 651, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.452440083026886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03407156094908714, decouple_loss:0.0017530829645693302
The modified gen p mean: 0.45219871401786804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03209220618009567, decouple_loss:0.001745041343383491
The modified gen p mean: 0.4551774263381958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03250732645392418, decouple_loss:0.002292414428666234
Iteration: 652, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4527723491191864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03311070054769516, decouple_loss:0.0017227656207978725
The modified gen p mean: 0.4521651566028595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0337897464632988, decouple_loss:0.0016323430463671684
The modified gen p mean: 0.4544905424118042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03403925150632858, decouple_loss:0.0016711093485355377
Iteration: 653, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45555028319358826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032239869236946106, decouple_loss:0.0018547421786934137
The modified gen p mean: 0.4550234079360962, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032061923295259476, decouple_loss:0.0020224989857524633
The modified gen p mean: 0.45334407687187195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03287160024046898, decouple_loss:0.001768553745932877
Iteration: 654, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4535244107246399, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03323739022016525, decouple_loss:0.0017287270165979862
The modified gen p mean: 0.45286306738853455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03222010284662247, decouple_loss:0.0019309157505631447
The modified gen p mean: 0.4532105624675751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03301410377025604, decouple_loss:0.0016400724416598678
Iteration: 655, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44926851987838745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03247642144560814, decouple_loss:0.0016412719851359725
The modified gen p mean: 0.4521888196468353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03284560889005661, decouple_loss:0.001717767328955233
The modified gen p mean: 0.45263585448265076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03528433293104172, decouple_loss:0.0019184811972081661
Iteration: 656, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483880400657654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033301807940006256, decouple_loss:0.0016799436416476965
The modified gen p mean: 0.4504275619983673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033462874591350555, decouple_loss:0.0017023636028170586
The modified gen p mean: 0.4522608518600464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031215885654091835, decouple_loss:0.0017372412839904428
Iteration: 657, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44802770018577576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03192431107163429, decouple_loss:0.0016810499364510179
The modified gen p mean: 0.44609931111335754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03368796780705452, decouple_loss:0.001693332684226334
The modified gen p mean: 0.44858333468437195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03169897943735123, decouple_loss:0.00179749121889472
Iteration: 658, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44543588161468506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03397240489721298, decouple_loss:0.0018314436310902238
The modified gen p mean: 0.4467136561870575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031854528933763504, decouple_loss:0.0016618729569017887
The modified gen p mean: 0.4465791881084442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283323347568512, decouple_loss:0.001676074112765491
Iteration: 659, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44327783584594727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03222045302391052, decouple_loss:0.0016977699706330895
The modified gen p mean: 0.4434012472629547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03291866183280945, decouple_loss:0.0016347462078556418
The modified gen p mean: 0.4437887668609619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03323261812329292, decouple_loss:0.0016701897839084268
Iteration: 660, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4425256550312042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03339262306690216, decouple_loss:0.0017666133353486657
The modified gen p mean: 0.44386234879493713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032979633659124374, decouple_loss:0.0015889406204223633
The modified gen p mean: 0.4459555149078369, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03304975479841232, decouple_loss:0.0018602608470246196
2023-05-26 07:27:09 testing...
The modified gen p mean: 0.4479908347129822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03232783079147339, decouple_loss:0.0018088375218212605
The modified gen p mean: 0.44683969020843506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259500116109848, decouple_loss:0.0016555184265598655
The modified gen p mean: 0.4481695294380188, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033651579171419144, decouple_loss:0.001791762188076973
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03294574096798897, avg_mse: 0.044400300830602646
current test mse: 0.0444
Iteration: 661, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442218542098999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03172696381807327, decouple_loss:0.0016120719956234097
The modified gen p mean: 0.44262561202049255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03297597914934158, decouple_loss:0.0016593721229583025
The modified gen p mean: 0.4480825364589691, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0324883908033371, decouple_loss:0.0018848219187930226
Iteration: 662, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446886479854584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033191923052072525, decouple_loss:0.00174546183552593
The modified gen p mean: 0.4464355707168579, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03308374807238579, decouple_loss:0.0017057425575330853
The modified gen p mean: 0.44385212659835815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032438747584819794, decouple_loss:0.001776841119863093
Iteration: 663, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463285505771637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033585935831069946, decouple_loss:0.0016406788490712643
The modified gen p mean: 0.44641077518463135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03223499283194542, decouple_loss:0.0017166779143735766
The modified gen p mean: 0.44429150223731995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03161625191569328, decouple_loss:0.0017445222474634647
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr.npz
NaN value num: 0
Iteration: 664, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44582599401474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03162257745862007, decouple_loss:0.0017025613924488425
The modified gen p mean: 0.44774648547172546, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44537022709846497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033970221877098083, decouple_loss:0.0016393234254792333
loss_pred:0.03313757851719856, decouple_loss:0.001657869783230126
Iteration: 665, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479689598083496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03234183415770531, decouple_loss:0.0015724455006420612
The modified gen p mean: 0.4503490924835205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033676955848932266, decouple_loss:0.0016727617476135492
The modified gen p mean: 0.44790324568748474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03381745144724846, decouple_loss:0.001571914879605174
Iteration: 666, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485270082950592, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03433763235807419, decouple_loss:0.0016731128562241793
The modified gen p mean: 0.4480290710926056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03214568644762039, decouple_loss:0.0015530773671343923
The modified gen p mean: 0.4459976255893707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0313890166580677, decouple_loss:0.001584307407028973
Iteration: 667, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498894512653351, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032687969505786896, decouple_loss:0.0016409734962508082
The modified gen p mean: 0.4486098289489746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033090993762016296, decouple_loss:0.001400386798195541
The modified gen p mean: 0.4536114037036896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246660903096199, decouple_loss:0.001798235229216516
Iteration: 668, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518674910068512, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03328900784254074, decouple_loss:0.0015252589946612716
The modified gen p mean: 0.4527250826358795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033981774002313614, decouple_loss:0.0015393596841022372
The modified gen p mean: 0.4508359432220459, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031174175441265106, decouple_loss:0.0018828557804226875
Iteration: 669, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45196735858917236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0324091799557209, decouple_loss:0.001551489345729351
The modified gen p mean: 0.4529849886894226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03380991891026497, decouple_loss:0.0015068489592522383
The modified gen p mean: 0.4518933594226837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0339496023952961, decouple_loss:0.0014832504093647003
Iteration: 670, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.455366849899292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03337542340159416, decouple_loss:0.0016922308132052422
The modified gen p mean: 0.4529503285884857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032875366508960724, decouple_loss:0.0017685253405943513
The modified gen p mean: 0.4495146572589874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03257443755865097, decouple_loss:0.001470495481044054
2023-05-26 07:31:57 testing...
The modified gen p mean: 0.4537697434425354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032207190990448, decouple_loss:0.0017319291364401579
The modified gen p mean: 0.45402759313583374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03355924040079117, decouple_loss:0.0017486927099525928
The modified gen p mean: 0.452441543340683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03240085393190384, decouple_loss:0.0016153823817148805
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0328073650598526, avg_mse: 0.044193949550390244
current test mse: 0.044194
Iteration: 671, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516831338405609, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032557498663663864, decouple_loss:0.001687298878096044
The modified gen p mean: 0.4491124451160431, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034732211381196976, decouple_loss:0.0017168748890981078
The modified gen p mean: 0.4471729099750519, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03132953494787216, decouple_loss:0.0014538201503455639
Iteration: 672, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484812617301941, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246094658970833, decouple_loss:0.0015194480074569583
The modified gen p mean: 0.4489591717720032, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03250978887081146, decouple_loss:0.0014318468747660518
The modified gen p mean: 0.4481840431690216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032806396484375, decouple_loss:0.001583333476446569
Iteration: 673, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452558755874634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033911388367414474, decouple_loss:0.0014721270417794585
The modified gen p mean: 0.4446709454059601, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031864382326602936, decouple_loss:0.0016033985884860158
The modified gen p mean: 0.45061782002449036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03187962621450424, decouple_loss:0.0016107367118820548
Iteration: 674, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480246305465698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03244376182556152, decouple_loss:0.0016293801600113511
The modified gen p mean: 0.44891610741615295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034134019166231155, decouple_loss:0.0015248704003170133
The modified gen p mean: 0.44418615102767944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033512379974126816, decouple_loss:0.0016377207357436419
Iteration: 675, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44967350363731384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033472493290901184, decouple_loss:0.0015971505781635642
The modified gen p mean: 0.4440625011920929, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03378800302743912, decouple_loss:0.001449808944016695
The modified gen p mean: 0.44404634833335876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033500492572784424, decouple_loss:0.001624473836272955
Iteration: 676, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44893062114715576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031552787870168686, decouple_loss:0.0016430086689069867
The modified gen p mean: 0.4445657730102539, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0333629734814167, decouple_loss:0.0015052915550768375
The modified gen p mean: 0.4494803547859192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033609941601753235, decouple_loss:0.001551974331960082
Iteration: 677, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45040541887283325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032920245081186295, decouple_loss:0.0014208033680915833
The modified gen p mean: 0.4516294002532959, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03317767009139061, decouple_loss:0.0015689359279349446
The modified gen p mean: 0.4503077566623688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03264903649687767, decouple_loss:0.0015018086414784193
Iteration: 678, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4536643326282501, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032526999711990356, decouple_loss:0.0015656527830287814
The modified gen p mean: 0.4480477571487427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0331156849861145, decouple_loss:0.0014674639096483588
The modified gen p mean: 0.45045748353004456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03228240832686424, decouple_loss:0.0015245737740769982
Iteration: 679, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510197639465332, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03267235681414604, decouple_loss:0.0016045391093939543
The modified gen p mean: 0.4531177580356598, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03293529525399208, decouple_loss:0.00160237867385149
The modified gen p mean: 0.4531404674053192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031835783272981644, decouple_loss:0.0015479031717404723
Iteration: 680, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45190495252609253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03461797535419464, decouple_loss:0.0016688373871147633
The modified gen p mean: 0.4540402591228485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03336977958679199, decouple_loss:0.0013941514771431684
The modified gen p mean: 0.45582351088523865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03206523135304451, decouple_loss:0.0015994315035641193
2023-05-26 07:36:10 testing...
The modified gen p mean: 0.45885059237480164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03206871449947357, decouple_loss:0.0017239060252904892
The modified gen p mean: 0.45772334933280945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03231227025389671, decouple_loss:0.001546801533550024
The modified gen p mean: 0.45915690064430237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03356196731328964, decouple_loss:0.001708527677692473
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03273063898086548, avg_mse: 0.04413820058107376
current test mse: 0.044138
At step 680, Best test: 0.044138
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_WV_1_PC_0_EH_0_PS_40_6hrs.ckpt
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr.npz
NaN value num: 0
Iteration: 681, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4524412751197815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029731765389442444, decouple_loss:0.0013595205964520574
The modified gen p mean: 0.4561592936515808, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45531460642814636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028331410139799118, decouple_loss:0.0014530561165884137
loss_pred:0.02803661674261093, decouple_loss:0.0015670289285480976
Iteration: 682, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503464698791504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030026772990822792, decouple_loss:0.0013854083372280002
The modified gen p mean: 0.45024484395980835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028187518939375877, decouple_loss:0.001558245625346899
The modified gen p mean: 0.45643991231918335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028221840038895607, decouple_loss:0.0015801654662936926
Iteration: 683, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45530375838279724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027781279757618904, decouple_loss:0.0016570830484852195
The modified gen p mean: 0.4518607258796692, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028674833476543427, decouple_loss:0.0014670038362964988
The modified gen p mean: 0.44725877046585083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028989149257540703, decouple_loss:0.0014418249484151602
Iteration: 684, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44546183943748474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028294704854488373, decouple_loss:0.001492511946707964
The modified gen p mean: 0.45158517360687256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02734794095158577, decouple_loss:0.0015176634769886732
The modified gen p mean: 0.44338348507881165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028784971684217453, decouple_loss:0.0013943745288997889
Iteration: 685, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44608941674232483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02812364511191845, decouple_loss:0.0013833858538419008
The modified gen p mean: 0.4462124705314636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027803028002381325, decouple_loss:0.0013554198667407036
The modified gen p mean: 0.44534313678741455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028940165415406227, decouple_loss:0.0015849159099161625
Iteration: 686, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450916051864624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028170960023999214, decouple_loss:0.0015843870351091027
The modified gen p mean: 0.4386071264743805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02792084775865078, decouple_loss:0.001481996150687337
The modified gen p mean: 0.4428195655345917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02798316814005375, decouple_loss:0.0016265735030174255
Iteration: 687, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.43960344791412354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02808219939470291, decouple_loss:0.0017262916080653667
The modified gen p mean: 0.445203572511673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027422834187746048, decouple_loss:0.0015432483050972223
The modified gen p mean: 0.43879950046539307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027787236496806145, decouple_loss:0.001585308345966041
Iteration: 688, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.43797579407691956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028726695105433464, decouple_loss:0.001686048461124301
The modified gen p mean: 0.4391728937625885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02774784341454506, decouple_loss:0.0015901861479505897
The modified gen p mean: 0.4426819384098053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028468843549489975, decouple_loss:0.0017007901333272457
Iteration: 689, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452196955680847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02828078344464302, decouple_loss:0.0015634804731234908
The modified gen p mean: 0.44234997034072876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0288066603243351, decouple_loss:0.0017928871093317866
The modified gen p mean: 0.44267717003822327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02857978828251362, decouple_loss:0.001532738097012043
Iteration: 690, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44599753618240356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027665041387081146, decouple_loss:0.0016708227340131998
The modified gen p mean: 0.4464828073978424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027728024870157242, decouple_loss:0.0017724605277180672
The modified gen p mean: 0.4477839469909668, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02671768143773079, decouple_loss:0.0017546755261719227
2023-05-26 07:41:11 testing...
The modified gen p mean: 0.4525672495365143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03248358890414238, decouple_loss:0.00175034673884511
The modified gen p mean: 0.4511744976043701, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032907649874687195, decouple_loss:0.0016918767942115664
The modified gen p mean: 0.45281651616096497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034009456634521484, decouple_loss:0.001890111598186195
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03322243690490723, avg_mse: 0.04493669047951698
current test mse: 0.044937
Iteration: 691, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44463491439819336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732943743467331, decouple_loss:0.0016727469628676772
The modified gen p mean: 0.44871458411216736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028432581573724747, decouple_loss:0.0017491758335381746
The modified gen p mean: 0.44990676641464233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027705157175660133, decouple_loss:0.0017625412438064814
Iteration: 692, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503183662891388, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02835889719426632, decouple_loss:0.0016175990458577871
The modified gen p mean: 0.44812989234924316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027791272848844528, decouple_loss:0.001862101024016738
The modified gen p mean: 0.4472067356109619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028199290856719017, decouple_loss:0.0015712728491052985
Iteration: 693, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505501389503479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026559647172689438, decouple_loss:0.0018276633927598596
The modified gen p mean: 0.45422789454460144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026539843529462814, decouple_loss:0.0017680635210126638
The modified gen p mean: 0.4507732689380646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027538273483514786, decouple_loss:0.0017494455678388476
Iteration: 694, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4527420699596405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026764769107103348, decouple_loss:0.0016543286619707942
The modified gen p mean: 0.44810158014297485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029188096523284912, decouple_loss:0.001569291460327804
The modified gen p mean: 0.45412659645080566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02654995582997799, decouple_loss:0.0016246283194050193
Iteration: 695, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4523441195487976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027274703606963158, decouple_loss:0.0015983510529622436
The modified gen p mean: 0.4550800323486328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027351951226592064, decouple_loss:0.00173086766153574
The modified gen p mean: 0.4496253430843353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02729376032948494, decouple_loss:0.001733757322654128
Iteration: 696, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451944500207901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027425149455666542, decouple_loss:0.0016309407074004412
The modified gen p mean: 0.4495195150375366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026843823492527008, decouple_loss:0.0017743186326697469
The modified gen p mean: 0.4478420317173004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028239218518137932, decouple_loss:0.0018008733168244362
Iteration: 697, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472893178462982, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028770776465535164, decouple_loss:0.0017721145413815975
The modified gen p mean: 0.44708380103111267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02806652896106243, decouple_loss:0.0015984547790139914
The modified gen p mean: 0.4454500079154968, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027155213057994843, decouple_loss:0.0016883062198758125
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr.npz
NaN value num: 0
Iteration: 698, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483031928539276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02892877906560898, decouple_loss:0.0017428278224542737
The modified gen p mean: 0.4448462426662445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028755871579051018, decouple_loss:0.0015523401089012623
The modified gen p mean: 0.4467594623565674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029751509428024292, decouple_loss:0.0016238794196397066
Iteration: 699, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476337432861328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028376879170536995, decouple_loss:0.0016378844156861305
The modified gen p mean: 0.44654208421707153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02797968126833439, decouple_loss:0.001723441993817687
The modified gen p mean: 0.44705232977867126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03059295006096363, decouple_loss:0.001736926380544901
Iteration: 700, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469074010848999, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44558900594711304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029824016615748405, decouple_loss:0.0015622560167685151
loss_pred:0.02872127667069435, decouple_loss:0.0017625908367335796
The modified gen p mean: 0.4484654664993286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029015041887760162, decouple_loss:0.001813786569982767
2023-05-26 07:46:14 testing...
The modified gen p mean: 0.44853049516677856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259284794330597, decouple_loss:0.0018224441446363926
The modified gen p mean: 0.4486258029937744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033919937908649445, decouple_loss:0.0019331660587340593
The modified gen p mean: 0.44728460907936096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03299843147397041, decouple_loss:0.0017785642994567752
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03326264023780823, avg_mse: 0.04507836326956749
current test mse: 0.045078
Iteration: 701, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44551318883895874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02680175006389618, decouple_loss:0.0016776041593402624
The modified gen p mean: 0.44112324714660645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030515199527144432, decouple_loss:0.0017432128079235554
The modified gen p mean: 0.4495545029640198, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028758300468325615, decouple_loss:0.0020145312882959843
Iteration: 702, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44603660702705383, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4463549256324768, gen p mean: 0.0, mean p set: 0.448loss_pred:0.028307538479566574, decouple_loss:0.0025071129202842712
loss_pred:0.029673371464014053, decouple_loss:0.0016604306874796748
The modified gen p mean: 0.4465045928955078, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027369163930416107, decouple_loss:0.0020533420611172915
Iteration: 703, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4431450366973877, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029598593711853027, decouple_loss:0.0016521064098924398
The modified gen p mean: 0.4432414174079895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029066305607557297, decouple_loss:0.0017342278733849525
The modified gen p mean: 0.4453032314777374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027800142765045166, decouple_loss:0.0018412675708532333
Iteration: 704, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44676265120506287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03036636672914028, decouple_loss:0.001590333878993988
The modified gen p mean: 0.44257286190986633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02803223766386509, decouple_loss:0.001933801919221878
The modified gen p mean: 0.44341540336608887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028956977650523186, decouple_loss:0.0018268668791279197
Iteration: 705, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485195279121399, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02861504629254341, decouple_loss:0.0018275664187967777
The modified gen p mean: 0.44538581371307373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02877565659582615, decouple_loss:0.0017091663321480155
The modified gen p mean: 0.4495285153388977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03009038418531418, decouple_loss:0.001720114378258586
Iteration: 706, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44816192984580994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030150799080729485, decouple_loss:0.0018770525930449367
The modified gen p mean: 0.4463852643966675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027983183041214943, decouple_loss:0.0016553289024159312
The modified gen p mean: 0.44679951667785645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02883872389793396, decouple_loss:0.0019278796389698982
Iteration: 707, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44413262605667114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030338184908032417, decouple_loss:0.0017652870155870914
The modified gen p mean: 0.4474228322505951, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02881298027932644, decouple_loss:0.0018380653345957398
The modified gen p mean: 0.44733211398124695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030092481523752213, decouple_loss:0.001985291950404644
Iteration: 708, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45068997144699097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029684916138648987, decouple_loss:0.0017203155439347029
The modified gen p mean: 0.44556760787963867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029534226283431053, decouple_loss:0.001698476611636579
The modified gen p mean: 0.44817760586738586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02906232886016369, decouple_loss:0.001864646328613162
Iteration: 709, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459584057331085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029565254226326942, decouple_loss:0.0016802169848233461
The modified gen p mean: 0.4495377242565155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02962024323642254, decouple_loss:0.0016280586132779717
The modified gen p mean: 0.4448491036891937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02890978753566742, decouple_loss:0.001660755486227572
Iteration: 710, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44308531284332275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028419703245162964, decouple_loss:0.0017868293216452003
The modified gen p mean: 0.44585177302360535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030278870835900307, decouple_loss:0.0017950026085600257
The modified gen p mean: 0.44961464405059814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03009151853621006, decouple_loss:0.0016972451703622937
2023-05-26 07:50:19 testing...
The modified gen p mean: 0.45135053992271423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032667044550180435, decouple_loss:0.0018522231839597225
The modified gen p mean: 0.45010608434677124, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4513412415981293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033032532781362534, decouple_loss:0.0018057117704302073
loss_pred:0.03395304083824158, decouple_loss:0.0019037480233237147
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03331023454666138, avg_mse: 0.04516321048140526
current test mse: 0.045163
Iteration: 711, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498087763786316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027730340138077736, decouple_loss:0.0017760659102350473
The modified gen p mean: 0.44912245869636536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028008686378598213, decouple_loss:0.0018826015293598175
The modified gen p mean: 0.449790894985199, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028265949338674545, decouple_loss:0.001670220633968711
Iteration: 712, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45080646872520447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02768792398273945, decouple_loss:0.0017356842290610075
The modified gen p mean: 0.450778603553772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027812769636511803, decouple_loss:0.0018334152409806848
The modified gen p mean: 0.4455137848854065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02778877317905426, decouple_loss:0.001523599843494594
Iteration: 713, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493620693683624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02978936955332756, decouple_loss:0.0016589643200859427
The modified gen p mean: 0.4507976770401001, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02760080248117447, decouple_loss:0.0017497338121756911
The modified gen p mean: 0.4488571584224701, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027539854869246483, decouple_loss:0.0016075572930276394
Iteration: 714, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45161381363868713, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.448064386844635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771696262061596, decouple_loss:0.001759442500770092
loss_pred:0.02794388309121132, decouple_loss:0.0015161895425990224
The modified gen p mean: 0.44838741421699524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02904611825942993, decouple_loss:0.001712225959636271
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr.npz
NaN value num: 0
Iteration: 715, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45166292786598206, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4470769166946411, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028869079425930977, decouple_loss:0.0017372326692566276loss_pred:0.028974484652280807, decouple_loss:0.0017509026220068336
The modified gen p mean: 0.4486487805843353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029168210923671722, decouple_loss:0.0014579561538994312
Iteration: 716, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477008879184723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028431540355086327, decouple_loss:0.0022772555239498615
The modified gen p mean: 0.4533936381340027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0283858273178339, decouple_loss:0.0021337151993066072
The modified gen p mean: 0.45166945457458496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028697151690721512, decouple_loss:0.0020710353273898363
Iteration: 717, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44983887672424316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029424021020531654, decouple_loss:0.0024822233244776726
The modified gen p mean: 0.4507788121700287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029115857556462288, decouple_loss:0.0018256088951602578
The modified gen p mean: 0.44910258054733276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027694059535861015, decouple_loss:0.0017784407828003168
Iteration: 718, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494602382183075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02895539440214634, decouple_loss:0.0015325377462431788
The modified gen p mean: 0.4503619372844696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03064688853919506, decouple_loss:0.002139987191185355
The modified gen p mean: 0.4521578848361969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02993948757648468, decouple_loss:0.0023114546202123165
Iteration: 719, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45076584815979004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029361970722675323, decouple_loss:0.0017787060933187604
The modified gen p mean: 0.45297205448150635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027534961700439453, decouple_loss:0.0018691765144467354
The modified gen p mean: 0.4562393128871918, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03003554977476597, decouple_loss:0.001956067280843854
Iteration: 720, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45472100377082825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02898239903151989, decouple_loss:0.0021029908675700426
The modified gen p mean: 0.44765740633010864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02855210192501545, decouple_loss:0.0017569841584190726
The modified gen p mean: 0.44892534613609314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026729723438620567, decouple_loss:0.0015897670527920127
2023-05-26 07:55:28 testing...
The modified gen p mean: 0.4532952904701233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255292400717735, decouple_loss:0.002052738331258297
The modified gen p mean: 0.45216143131256104, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45326054096221924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03289821743965149, decouple_loss:0.002028791466727853
loss_pred:0.03399217501282692, decouple_loss:0.0020609451457858086
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033250145614147186, avg_mse: 0.045024801045656204
current test mse: 0.045025
Iteration: 721, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45345860719680786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03016040101647377, decouple_loss:0.0017613846575841308
The modified gen p mean: 0.44937941431999207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02876165136694908, decouple_loss:0.0017690847162157297
The modified gen p mean: 0.44682222604751587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03002084046602249, decouple_loss:0.0018001995049417019
Iteration: 722, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44752761721611023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783314138650894, decouple_loss:0.0019377388525754213
The modified gen p mean: 0.4510863423347473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02941945195198059, decouple_loss:0.0018939428264275193
The modified gen p mean: 0.4481869339942932, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028878984972834587, decouple_loss:0.0016345485346391797
Iteration: 723, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44570040702819824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03067348338663578, decouple_loss:0.0017246589995920658
The modified gen p mean: 0.4492369294166565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02885950356721878, decouple_loss:0.0018242293735966086
The modified gen p mean: 0.4481508731842041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029536757618188858, decouple_loss:0.0018965108320116997
Iteration: 724, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44995132088661194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026509545743465424, decouple_loss:0.0016650453908368945
The modified gen p mean: 0.4484776258468628, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028617801144719124, decouple_loss:0.0016410867683589458
The modified gen p mean: 0.44761285185813904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027800148352980614, decouple_loss:0.0016602309187874198
Iteration: 725, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472661316394806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02715962938964367, decouple_loss:0.001561716664582491
The modified gen p mean: 0.44864898920059204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028225526213645935, decouple_loss:0.0015837332466617227
The modified gen p mean: 0.45232707262039185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02968709170818329, decouple_loss:0.0016785028856247663
Iteration: 726, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45121660828590393, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026989802718162537, decouple_loss:0.0016917994944378734
The modified gen p mean: 0.44846662878990173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027057748287916183, decouple_loss:0.0022439230233430862
The modified gen p mean: 0.44919803738594055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027254115790128708, decouple_loss:0.00201758393086493
Iteration: 727, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510946273803711, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028784582391381264, decouple_loss:0.001722905202768743
The modified gen p mean: 0.45137667655944824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028668086975812912, decouple_loss:0.00175355258397758
The modified gen p mean: 0.4525335133075714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0279939454048872, decouple_loss:0.0016135264886543155
Iteration: 728, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45451420545578003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02828892506659031, decouple_loss:0.0018064540345221758
The modified gen p mean: 0.4487617313861847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028294747695326805, decouple_loss:0.0016252611530944705
The modified gen p mean: 0.4486134946346283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02702777273952961, decouple_loss:0.001711855991743505
Iteration: 729, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45021700859069824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0295986607670784, decouple_loss:0.001848497660830617
The modified gen p mean: 0.44850724935531616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030790328979492188, decouple_loss:0.0017293741693720222
The modified gen p mean: 0.4517178535461426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02851659245789051, decouple_loss:0.0017204522155225277
Iteration: 730, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44909006357192993, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028589682653546333, decouple_loss:0.0016383202746510506
The modified gen p mean: 0.4458773136138916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027292795479297638, decouple_loss:0.0016807414358481765
The modified gen p mean: 0.4469708204269409, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029368780553340912, decouple_loss:0.00206185644492507
2023-05-26 07:59:35 testing...
The modified gen p mean: 0.4514121413230896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032577335834503174, decouple_loss:0.0019611758179962635
The modified gen p mean: 0.45135390758514404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034086406230926514, decouple_loss:0.0019329979550093412
The modified gen p mean: 0.45004376769065857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033011969178915024, decouple_loss:0.0017975219525396824
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033320099115371704, avg_mse: 0.0452260859310627
current test mse: 0.045226
Iteration: 731, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459388852119446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029179874807596207, decouple_loss:0.001480600913055241
The modified gen p mean: 0.44972512125968933, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029530180618166924, decouple_loss:0.0019525822717696428
The modified gen p mean: 0.44650381803512573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028132254257798195, decouple_loss:0.001625910634174943
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr.npz
NaN value num: 0
Iteration: 732, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510986804962158, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027331748977303505, decouple_loss:0.0019062372157350183
The modified gen p mean: 0.4455190598964691, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028717463836073875, decouple_loss:0.0017244531773030758
The modified gen p mean: 0.451735258102417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027615636587142944, decouple_loss:0.0018372285412624478
Iteration: 733, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475611448287964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027655502781271935, decouple_loss:0.0018050044309347868
The modified gen p mean: 0.44901493191719055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028252283111214638, decouple_loss:0.001803246675990522
The modified gen p mean: 0.4437643587589264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027946172282099724, decouple_loss:0.0015621816273778677
Iteration: 734, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44440725445747375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02688112109899521, decouple_loss:0.0016796899726614356
The modified gen p mean: 0.4488753080368042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0264498982578516, decouple_loss:0.0018845993326976895
The modified gen p mean: 0.4424888789653778, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028262516483664513, decouple_loss:0.0017143874429166317
Iteration: 735, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4432457387447357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02955590933561325, decouple_loss:0.0015537261497229338
The modified gen p mean: 0.44726842641830444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029129358008503914, decouple_loss:0.0016728517366573215
The modified gen p mean: 0.44542786478996277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027333350852131844, decouple_loss:0.0020711247343569994
Iteration: 736, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44452282786369324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027417214587330818, decouple_loss:0.0017352696740999818
The modified gen p mean: 0.44358646869659424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026630498468875885, decouple_loss:0.0016420098254457116
The modified gen p mean: 0.44365519285202026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02740360237658024, decouple_loss:0.0015416464302688837
Iteration: 737, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44807782769203186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673548273742199, decouple_loss:0.001686934963800013
The modified gen p mean: 0.44268420338630676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028040925040841103, decouple_loss:0.0014498891541734338
The modified gen p mean: 0.4424121677875519, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02863161265850067, decouple_loss:0.002046931767836213
Iteration: 738, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462006092071533, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.445968359708786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026964321732521057, decouple_loss:0.0017628873465582728
loss_pred:0.027555882930755615, decouple_loss:0.0016091119032353163
The modified gen p mean: 0.44261837005615234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02757790870964527, decouple_loss:0.0017732817213982344
Iteration: 739, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461519122123718, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44842422008514404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027272988110780716, decouple_loss:0.0018648875411599874
loss_pred:0.02616380900144577, decouple_loss:0.0017023009713739157
The modified gen p mean: 0.4454196095466614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028103506192564964, decouple_loss:0.001780310645699501
Iteration: 740, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460967183113098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02813193015754223, decouple_loss:0.0016929086996242404
The modified gen p mean: 0.4440842270851135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02973584271967411, decouple_loss:0.0014879022492095828
The modified gen p mean: 0.4460940957069397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027949746698141098, decouple_loss:0.0016855740686878562
2023-05-26 08:04:28 testing...
The modified gen p mean: 0.4507295787334442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032695237547159195, decouple_loss:0.0017941127298399806
The modified gen p mean: 0.449140727519989, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033169761300086975, decouple_loss:0.0016395378625020385
The modified gen p mean: 0.45068371295928955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03418080508708954, decouple_loss:0.0018759309314191341
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0334370955824852, avg_mse: 0.04549834877252579
current test mse: 0.045498
Iteration: 741, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447910487651825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02779087796807289, decouple_loss:0.0018842665012925863
The modified gen p mean: 0.4436611831188202, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027704833075404167, decouple_loss:0.0015575761208310723
The modified gen p mean: 0.44344088435173035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027557170018553734, decouple_loss:0.001554618589580059
Iteration: 742, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473252594470978, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4494708478450775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02797517739236355, decouple_loss:0.001582117285579443
loss_pred:0.027047961950302124, decouple_loss:0.0015848901821300387
The modified gen p mean: 0.44711026549339294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02836102433502674, decouple_loss:0.0014759841142222285
Iteration: 743, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44724997878074646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02780258283019066, decouple_loss:0.0016197148943319917
The modified gen p mean: 0.44551563262939453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02834995649755001, decouple_loss:0.0015038951532915235
The modified gen p mean: 0.45059046149253845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02570965141057968, decouple_loss:0.0016506811371073127
Iteration: 744, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44820165634155273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026100516319274902, decouple_loss:0.001584734651260078
The modified gen p mean: 0.4456883370876312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02817479334771633, decouple_loss:0.001503421226516366
The modified gen p mean: 0.44916850328445435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027374474331736565, decouple_loss:0.001619734801352024
Iteration: 745, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479221701622009, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026325594633817673, decouple_loss:0.0015674484893679619
The modified gen p mean: 0.44773605465888977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027106868103146553, decouple_loss:0.0014453575713559985
The modified gen p mean: 0.4492935538291931, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027686776593327522, decouple_loss:0.0017439150251448154
Iteration: 746, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4520914852619171, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02734456956386566, decouple_loss:0.0018132944824174047
The modified gen p mean: 0.45249077677726746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026280440390110016, decouple_loss:0.0015786353033035994
The modified gen p mean: 0.44907665252685547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02758542075753212, decouple_loss:0.0017185788601636887
Iteration: 747, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486258924007416, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4482191801071167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026397865265607834, decouple_loss:0.0015448275953531265
loss_pred:0.027746394276618958, decouple_loss:0.0016919281333684921
The modified gen p mean: 0.453759104013443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02581419050693512, decouple_loss:0.0017079227836802602
Iteration: 748, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44643518328666687, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4482327103614807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027920791879296303, decouple_loss:0.0014434191398322582
loss_pred:0.027658332139253616, decouple_loss:0.0016502905637025833
The modified gen p mean: 0.45166781544685364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02767876163125038, decouple_loss:0.0015820515109226108
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr.npz
NaN value num: 0
Iteration: 749, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473649561405182, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03329544514417648, decouple_loss:0.001466479036025703
The modified gen p mean: 0.4502110779285431, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03529399260878563, decouple_loss:0.0017280878964811563
The modified gen p mean: 0.4478040635585785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03150637447834015, decouple_loss:0.0016761443112045527
Iteration: 750, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482046067714691, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03393969312310219, decouple_loss:0.0016476467717438936
The modified gen p mean: 0.4495934545993805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03191797062754631, decouple_loss:0.0016538327326998115
The modified gen p mean: 0.44828343391418457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034544240683317184, decouple_loss:0.0014010112499818206
2023-05-26 08:09:10 testing...
The modified gen p mean: 0.4526151418685913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03252800181508064, decouple_loss:0.00176642881706357
The modified gen p mean: 0.4511984884738922, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03277669474482536, decouple_loss:0.0016221321420744061
The modified gen p mean: 0.4525974690914154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03394930809736252, decouple_loss:0.0018827778985723853
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033172525465488434, avg_mse: 0.044914133846759796
current test mse: 0.044914
Iteration: 751, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497820734977722, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03339771553874016, decouple_loss:0.0016777102136984468
The modified gen p mean: 0.4511311650276184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03373105078935623, decouple_loss:0.0016523555386811495
The modified gen p mean: 0.44920745491981506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03256212919950485, decouple_loss:0.0017370420973747969
Iteration: 752, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44918131828308105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034793708473443985, decouple_loss:0.001566895516589284
The modified gen p mean: 0.452484130859375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03523489087820053, decouple_loss:0.0014884260017424822
The modified gen p mean: 0.4515852928161621, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03636034578084946, decouple_loss:0.0015359011013060808
Iteration: 753, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501074254512787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03415754437446594, decouple_loss:0.001603364129550755
The modified gen p mean: 0.4535728693008423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03240933641791344, decouple_loss:0.0017145893070846796
The modified gen p mean: 0.44902360439300537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032378215342760086, decouple_loss:0.001560122356750071
Iteration: 754, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4522499740123749, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261352702975273, decouple_loss:0.0016009197570383549
The modified gen p mean: 0.44963449239730835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03280095010995865, decouple_loss:0.0015051356749609113
The modified gen p mean: 0.4495961368083954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251117467880249, decouple_loss:0.0015341544058173895
Iteration: 755, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4547625482082367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03393810987472534, decouple_loss:0.0017121175769716501
The modified gen p mean: 0.4491591453552246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03346262872219086, decouple_loss:0.0015686254482716322
The modified gen p mean: 0.45311805605888367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0344148725271225, decouple_loss:0.0014841179363429546
Iteration: 756, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493943750858307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034970883280038834, decouple_loss:0.0015376758528873324
The modified gen p mean: 0.45235639810562134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03557321056723595, decouple_loss:0.0015798964304849505
The modified gen p mean: 0.4526539444923401, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0338728204369545, decouple_loss:0.0015392927452921867
Iteration: 757, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45061013102531433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03432697430253029, decouple_loss:0.0016110680298879743
The modified gen p mean: 0.4511730372905731, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03365647420287132, decouple_loss:0.001375423977151513
The modified gen p mean: 0.4503133296966553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03420810028910637, decouple_loss:0.0016467584064230323
Iteration: 758, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45062941312789917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03463618829846382, decouple_loss:0.0014984948793426156
The modified gen p mean: 0.452630877494812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033346988260746, decouple_loss:0.001535017741844058
The modified gen p mean: 0.45165619254112244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03373363986611366, decouple_loss:0.0014958021929487586
Iteration: 759, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44987744092941284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03560662269592285, decouple_loss:0.0014544868608936667
The modified gen p mean: 0.4502098560333252, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03343803808093071, decouple_loss:0.0016255193622782826
The modified gen p mean: 0.44896912574768066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033965542912483215, decouple_loss:0.0014021537499502301
Iteration: 760, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480845034122467, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4471333622932434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03223216161131859, decouple_loss:0.0014592143706977367
loss_pred:0.0330476313829422, decouple_loss:0.0014316393062472343
The modified gen p mean: 0.44869181513786316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03544634208083153, decouple_loss:0.0015006298199295998
2023-05-26 08:13:12 testing...
The modified gen p mean: 0.45065343379974365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03226453810930252, decouple_loss:0.0016475903103128076
The modified gen p mean: 0.4506797194480896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0335845872759819, decouple_loss:0.0016796020790934563
The modified gen p mean: 0.44946807622909546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03244452551007271, decouple_loss:0.001511585433036089
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03284519910812378, avg_mse: 0.04431663826107979
current test mse: 0.044317
Iteration: 761, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458303451538086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034067291766405106, decouple_loss:0.0014226363273337483
The modified gen p mean: 0.44623708724975586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031093118712306023, decouple_loss:0.0016963043017312884
The modified gen p mean: 0.44815102219581604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032621581107378006, decouple_loss:0.001420899061486125
Iteration: 762, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44525501132011414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03267006203532219, decouple_loss:0.0015314267948269844
The modified gen p mean: 0.4461098611354828, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03315914049744606, decouple_loss:0.0016576527850702405
The modified gen p mean: 0.4485844671726227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03478885069489479, decouple_loss:0.0014531714841723442
Iteration: 763, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44474515318870544, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44779250025749207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0335623137652874, decouple_loss:0.0014122026041150093
loss_pred:0.0347689688205719, decouple_loss:0.001501676393672824
The modified gen p mean: 0.4455553889274597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03386761620640755, decouple_loss:0.0014425852568820119
Iteration: 764, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465065002441406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03213866800069809, decouple_loss:0.001552718342281878
The modified gen p mean: 0.4491499662399292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032142333686351776, decouple_loss:0.0015471263322979212
The modified gen p mean: 0.44961845874786377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03343687206506729, decouple_loss:0.0015428201295435429
Iteration: 765, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44405442476272583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0340266227722168, decouple_loss:0.0014644715702161193
The modified gen p mean: 0.4415189325809479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03248871490359306, decouple_loss:0.00147402158472687
The modified gen p mean: 0.44926148653030396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033838462084531784, decouple_loss:0.0016674567013978958
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr.npz
NaN value num: 0
Iteration: 766, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44446617364883423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033771369606256485, decouple_loss:0.00170930998865515
The modified gen p mean: 0.4435489773750305, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4480532705783844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034865595400333405, decouple_loss:0.0015013980446383357loss_pred:0.03455987200140953, decouple_loss:0.001401419984176755
Iteration: 767, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462209939956665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033988453447818756, decouple_loss:0.0017014166805893183
The modified gen p mean: 0.4431512951850891, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033348772674798965, decouple_loss:0.001454274752177298
The modified gen p mean: 0.44397860765457153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03201526775956154, decouple_loss:0.001482965424656868
Iteration: 768, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449666291475296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033161990344524384, decouple_loss:0.0015835905214771628
The modified gen p mean: 0.4471803903579712, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03340911492705345, decouple_loss:0.0014625408221036196
The modified gen p mean: 0.4476722776889801, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034053489565849304, decouple_loss:0.001495088217779994
Iteration: 769, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44885316491127014, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0355723612010479, decouple_loss:0.001521567814052105
The modified gen p mean: 0.4492271840572357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03291567787528038, decouple_loss:0.001561537035740912
The modified gen p mean: 0.44790971279144287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03396018594503403, decouple_loss:0.0016135902842506766
Iteration: 770, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483373165130615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032661810517311096, decouple_loss:0.0014496506191790104
The modified gen p mean: 0.4490737020969391, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03572065383195877, decouple_loss:0.0014073195634409785
The modified gen p mean: 0.45005112886428833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034577712416648865, decouple_loss:0.0014320977497845888
2023-05-26 08:17:51 testing...
The modified gen p mean: 0.4553074240684509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032094843685626984, decouple_loss:0.0016151150921359658
The modified gen p mean: 0.45391640067100525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03227343037724495, decouple_loss:0.001464264583773911
The modified gen p mean: 0.45539647340774536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03345974534749985, decouple_loss:0.0016671582125127316
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0326884500682354, avg_mse: 0.044123221188783646
current test mse: 0.044123
At step 770, Best test: 0.044123
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_WV_1_PC_0_EH_0_PS_40_6hrs.ckpt
Iteration: 771, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498961269855499, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4523048996925354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03298507258296013, decouple_loss:0.0014518022071570158
The modified gen p mean: 0.45122697949409485, gen p mean: 0.0, mean p set: 0.448loss_pred:0.0334068201482296, decouple_loss:0.0015160876791924238
loss_pred:0.034010715782642365, decouple_loss:0.0016014372231438756
Iteration: 772, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45093047618865967, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035483889281749725, decouple_loss:0.0015270481817424297
The modified gen p mean: 0.45328959822654724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032630179077386856, decouple_loss:0.0016637250082567334
The modified gen p mean: 0.45419830083847046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033830851316452026, decouple_loss:0.00147764733992517
Iteration: 773, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45072856545448303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03276564180850983, decouple_loss:0.001641603885218501
The modified gen p mean: 0.44913262128829956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033896300941705704, decouple_loss:0.0015430210623890162
The modified gen p mean: 0.4505819082260132, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03342900052666664, decouple_loss:0.0014643230242654681
Iteration: 774, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480617046356201, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03302943706512451, decouple_loss:0.0016274797962978482
The modified gen p mean: 0.4513530731201172, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03201708197593689, decouple_loss:0.001516544260084629
The modified gen p mean: 0.44921231269836426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03260348364710808, decouple_loss:0.0015273193130269647
Iteration: 775, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473462402820587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03523196280002594, decouple_loss:0.0015652745496481657
The modified gen p mean: 0.4456094801425934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03500865772366524, decouple_loss:0.0013928994303569198
The modified gen p mean: 0.4483641982078552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265431523323059, decouple_loss:0.0014270514948293567
Iteration: 776, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480888545513153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031704992055892944, decouple_loss:0.0015655005117878318
The modified gen p mean: 0.44709986448287964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034804340451955795, decouple_loss:0.0013930717250332236
The modified gen p mean: 0.4452253580093384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265771642327309, decouple_loss:0.0015846509486436844
Iteration: 777, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4426112771034241, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03343914449214935, decouple_loss:0.0015246572438627481
The modified gen p mean: 0.44510528445243835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03428737819194794, decouple_loss:0.0015060714213177562
The modified gen p mean: 0.4446656405925751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034515656530857086, decouple_loss:0.001497657154686749
Iteration: 778, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44142746925354004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03495890274643898, decouple_loss:0.0014811460860073566
The modified gen p mean: 0.4408033788204193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03304310515522957, decouple_loss:0.0013982872478663921
The modified gen p mean: 0.4418206214904785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034825753420591354, decouple_loss:0.0014436139026656747
Iteration: 779, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44313472509384155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03319423645734787, decouple_loss:0.0016038028988987207
The modified gen p mean: 0.4430059492588043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03391202166676521, decouple_loss:0.00137410091701895
The modified gen p mean: 0.441842645406723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03416023775935173, decouple_loss:0.0014765177620574832
Iteration: 780, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44703006744384766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03277013078331947, decouple_loss:0.001537937787361443
The modified gen p mean: 0.44373875856399536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03306809067726135, decouple_loss:0.0013779328437522054
The modified gen p mean: 0.44427523016929626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03532790020108223, decouple_loss:0.001533291768282652
2023-05-26 08:21:59 testing...
The modified gen p mean: 0.4500133991241455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03204049915075302, decouple_loss:0.0015129373641684651
The modified gen p mean: 0.4485167860984802, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45012205839157104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03213169053196907, decouple_loss:0.0013910847483202815
loss_pred:0.03331790119409561, decouple_loss:0.0015857029939070344
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03257152438163757, avg_mse: 0.0439310185611248
current test mse: 0.043931
At step 780, Best test: 0.043931
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_WV_1_PC_0_EH_0_PS_40_6hrs.ckpt
Iteration: 781, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44997528195381165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254051133990288, decouple_loss:0.0015349010936915874
The modified gen p mean: 0.4479562044143677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033596549183130264, decouple_loss:0.0016559648793190718
The modified gen p mean: 0.4450482130050659, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034667953848838806, decouple_loss:0.0013771808007732034
Iteration: 782, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45189523696899414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03280482441186905, decouple_loss:0.0014727353118360043
The modified gen p mean: 0.4475603699684143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03392685577273369, decouple_loss:0.0014429169241338968
The modified gen p mean: 0.44739437103271484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034106139093637466, decouple_loss:0.001333808759227395
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr.npz
NaN value num: 0
Iteration: 783, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479328691959381, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028593089431524277, decouple_loss:0.0013611079193651676
The modified gen p mean: 0.4496355354785919, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4476059079170227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029287228360772133, decouple_loss:0.0013803215697407722
loss_pred:0.028990818187594414, decouple_loss:0.0013770963996648788
Iteration: 784, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4545258581638336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026860611513257027, decouple_loss:0.0018255049362778664
The modified gen p mean: 0.4500070810317993, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030007977038621902, decouple_loss:0.0014485176652669907
The modified gen p mean: 0.44825834035873413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029317708685994148, decouple_loss:0.0013979627983644605
Iteration: 785, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502849876880646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0273633673787117, decouple_loss:0.0015795360086485744
The modified gen p mean: 0.4543135464191437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027864400297403336, decouple_loss:0.0015457386616617441
The modified gen p mean: 0.45580872893333435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027274856343865395, decouple_loss:0.00167214241810143
Iteration: 786, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493692219257355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027833614498376846, decouple_loss:0.00141366315074265
The modified gen p mean: 0.4496934413909912, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027636680752038956, decouple_loss:0.0014269879320636392
The modified gen p mean: 0.4536886215209961, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02646714076399803, decouple_loss:0.0016434602439403534
Iteration: 787, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489029347896576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02803555317223072, decouple_loss:0.0013765956973657012
The modified gen p mean: 0.44666072726249695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029211416840553284, decouple_loss:0.0015355941141024232
The modified gen p mean: 0.4479122757911682, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026365431025624275, decouple_loss:0.0015500299632549286
Iteration: 788, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438081979751587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028080780059099197, decouple_loss:0.0016166317509487271
The modified gen p mean: 0.44986212253570557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026286760345101357, decouple_loss:0.0016060438938438892
The modified gen p mean: 0.4447685182094574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02614530734717846, decouple_loss:0.0013955446192994714
Iteration: 789, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.443372517824173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02792103961110115, decouple_loss:0.0016241322737187147
The modified gen p mean: 0.4424193501472473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028202367946505547, decouple_loss:0.0015018698759377003
The modified gen p mean: 0.4433749318122864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027343446388840675, decouple_loss:0.0015650822315365076
Iteration: 790, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4393894672393799, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027492167428135872, decouple_loss:0.0017655255505815148
The modified gen p mean: 0.43956002593040466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027992555871605873, decouple_loss:0.001553869224153459
The modified gen p mean: 0.44179806113243103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027290839701890945, decouple_loss:0.0016381144523620605
2023-05-26 08:26:53 testing...
The modified gen p mean: 0.4485108554363251, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03236111253499985, decouple_loss:0.001710922340862453
The modified gen p mean: 0.4467599093914032, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032553791999816895, decouple_loss:0.0015247607370838523
The modified gen p mean: 0.44865909218788147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03368500992655754, decouple_loss:0.001787848537787795
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03295036405324936, avg_mse: 0.044643428176641464
current test mse: 0.044643
Iteration: 791, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470912516117096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025670116767287254, decouple_loss:0.0015625405358150601
The modified gen p mean: 0.4419196844100952, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027814198285341263, decouple_loss:0.001540269353426993
The modified gen p mean: 0.44846606254577637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025942066684365273, decouple_loss:0.0017921602120622993
Iteration: 792, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4428161382675171, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028128329664468765, decouple_loss:0.0015314581105485559
The modified gen p mean: 0.44213664531707764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027977682650089264, decouple_loss:0.001622718758881092
The modified gen p mean: 0.4465421438217163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02822304144501686, decouple_loss:0.0015547263901680708
Iteration: 793, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44547683000564575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028981581330299377, decouple_loss:0.0016343536553904414
The modified gen p mean: 0.44505757093429565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027521340176463127, decouple_loss:0.0015969329979270697
The modified gen p mean: 0.44439876079559326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0277026928961277, decouple_loss:0.001566662802360952
Iteration: 794, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44901078939437866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026689575985074043, decouple_loss:0.001501481863670051
The modified gen p mean: 0.45135244727134705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026847517117857933, decouple_loss:0.0017216077540069818
The modified gen p mean: 0.44963550567626953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027377355843782425, decouple_loss:0.0015131860272958875
Iteration: 795, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44993358850479126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02599586732685566, decouple_loss:0.001751548028551042
The modified gen p mean: 0.4492652416229248, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02881988324224949, decouple_loss:0.001638605841435492
The modified gen p mean: 0.4539778232574463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025957994163036346, decouple_loss:0.0017710191896185279
Iteration: 796, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44629979133605957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028274020180106163, decouple_loss:0.001562821096740663
The modified gen p mean: 0.44729527831077576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027185548096895218, decouple_loss:0.0016269511543214321
The modified gen p mean: 0.4538898468017578, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026591869071125984, decouple_loss:0.0016526051331311464
Iteration: 797, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477163851261139, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028161020949482918, decouple_loss:0.0017116352682933211
The modified gen p mean: 0.44606876373291016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027658583596348763, decouple_loss:0.0017985888989642262
The modified gen p mean: 0.4470668435096741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025703322142362595, decouple_loss:0.0015484248287975788
Iteration: 798, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44640079140663147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0278237946331501, decouple_loss:0.0016755060059949756
The modified gen p mean: 0.44987428188323975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025516578927636147, decouple_loss:0.0016629749443382025
The modified gen p mean: 0.448706716299057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027322232723236084, decouple_loss:0.0015105408383533359
Iteration: 799, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445992410182953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027960272505879402, decouple_loss:0.0015468572964891791
The modified gen p mean: 0.44858241081237793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02604025788605213, decouple_loss:0.0017117629759013653
The modified gen p mean: 0.4508803188800812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026965666562318802, decouple_loss:0.0018196796299889684
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr_shift3.npz
NaN value num: 0
Iteration: 800, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461425840854645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032009854912757874, decouple_loss:0.0015896561089903116
The modified gen p mean: 0.45126888155937195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02861597016453743, decouple_loss:0.0016791494563221931
The modified gen p mean: 0.44912147521972656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03108646720647812, decouple_loss:0.0017984176520258188
2023-05-26 08:31:38 testing...
The modified gen p mean: 0.45060765743255615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032606493681669235, decouple_loss:0.0017002378590404987
The modified gen p mean: 0.44874298572540283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032929468899965286, decouple_loss:0.001600727904587984
The modified gen p mean: 0.4505906403064728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03392515331506729, decouple_loss:0.0017966306768357754
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03323866426944733, avg_mse: 0.0452217273414135
current test mse: 0.045222
Iteration: 801, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45181164145469666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02910316176712513, decouple_loss:0.001546955551020801
The modified gen p mean: 0.44520747661590576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031216973438858986, decouple_loss:0.001569959451444447
The modified gen p mean: 0.44674476981163025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031137436628341675, decouple_loss:0.001629613689146936
Iteration: 802, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439207911491394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03205222636461258, decouple_loss:0.0015126815997064114
The modified gen p mean: 0.4470158517360687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029498597607016563, decouple_loss:0.001519264536909759
The modified gen p mean: 0.4500582218170166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02959391474723816, decouple_loss:0.001685886993072927
Iteration: 803, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518880248069763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030248016119003296, decouple_loss:0.001688789576292038
The modified gen p mean: 0.453621506690979, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029133265838027, decouple_loss:0.0016922347713261843
The modified gen p mean: 0.44671037793159485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030807262286543846, decouple_loss:0.0015989495441317558
Iteration: 804, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45002520084381104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030276358127593994, decouple_loss:0.0016452149720862508
The modified gen p mean: 0.4466683268547058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029704218730330467, decouple_loss:0.0015647077234461904
The modified gen p mean: 0.44915032386779785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03033793717622757, decouple_loss:0.001538806245662272
Iteration: 805, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480644464492798, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031798601150512695, decouple_loss:0.0016757074045017362
The modified gen p mean: 0.4496919810771942, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031584709882736206, decouple_loss:0.001496489392593503
The modified gen p mean: 0.4487600326538086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029952429234981537, decouple_loss:0.0015432415530085564
Iteration: 806, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44765424728393555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030038965865969658, decouple_loss:0.0016940096393227577
The modified gen p mean: 0.44783464074134827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03124297969043255, decouple_loss:0.0016993923345580697
The modified gen p mean: 0.4479319453239441, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030555114150047302, decouple_loss:0.0016438557067885995
Iteration: 807, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506979286670685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029513083398342133, decouple_loss:0.0016457207966595888
The modified gen p mean: 0.44969379901885986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03079325146973133, decouple_loss:0.0015410254709422588
The modified gen p mean: 0.4548463821411133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030884085223078728, decouple_loss:0.0016337621491402388
Iteration: 808, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515175223350525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030710386112332344, decouple_loss:0.0016552137676626444
The modified gen p mean: 0.44983020424842834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03142179176211357, decouple_loss:0.001536951633170247
The modified gen p mean: 0.44785380363464355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030814195051789284, decouple_loss:0.001537053263746202
Iteration: 809, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44860485196113586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02826492115855217, decouple_loss:0.0017717311857268214
The modified gen p mean: 0.4528299868106842, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02895769663155079, decouple_loss:0.001666511408984661
The modified gen p mean: 0.45131734013557434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028719160705804825, decouple_loss:0.0015980158932507038
Iteration: 810, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44689786434173584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02999444678425789, decouple_loss:0.0015613886062055826
The modified gen p mean: 0.4478163421154022, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02916448749601841, decouple_loss:0.0016650659963488579
The modified gen p mean: 0.45024731755256653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02919449843466282, decouple_loss:0.0016230241162702441
2023-05-26 08:35:44 testing...
The modified gen p mean: 0.4510928690433502, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253965824842453, decouple_loss:0.0017159455455839634
The modified gen p mean: 0.4492066204547882, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032749664038419724, decouple_loss:0.0016216274816542864
The modified gen p mean: 0.45068415999412537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033897798508405685, decouple_loss:0.001774192089214921
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03314756974577904, avg_mse: 0.04476610943675041
current test mse: 0.044766
Iteration: 811, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44667619466781616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029687944799661636, decouple_loss:0.001559047494083643
The modified gen p mean: 0.4506136178970337, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02988251857459545, decouple_loss:0.0018010062631219625
The modified gen p mean: 0.4461284279823303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03062986209988594, decouple_loss:0.0016218945384025574
Iteration: 812, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44876205921173096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03005996346473694, decouple_loss:0.0019817452412098646
The modified gen p mean: 0.451195627450943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028335506096482277, decouple_loss:0.0015849689953029156
The modified gen p mean: 0.44429638981819153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02998277358710766, decouple_loss:0.0018655803287401795
Iteration: 813, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45041877031326294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028894875198602676, decouple_loss:0.001838955213315785
The modified gen p mean: 0.44439974427223206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029799962416291237, decouple_loss:0.001698321313597262
The modified gen p mean: 0.4457229673862457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030387703329324722, decouple_loss:0.0016109939897432923
Iteration: 814, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44838425517082214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029445067048072815, decouple_loss:0.0016703573055565357
The modified gen p mean: 0.4466969966888428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029602788388729095, decouple_loss:0.0016383351758122444
The modified gen p mean: 0.44485172629356384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02965904399752617, decouple_loss:0.0015910806832835078
Iteration: 815, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44273725152015686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029143935069441795, decouple_loss:0.0015401950804516673
The modified gen p mean: 0.44804510474205017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028491737321019173, decouple_loss:0.0021984011400491
The modified gen p mean: 0.4474440813064575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030171016231179237, decouple_loss:0.0015821685083210468
Iteration: 816, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44545263051986694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029454264789819717, decouple_loss:0.0016461631748825312
The modified gen p mean: 0.44326382875442505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028913090005517006, decouple_loss:0.001556822215206921
The modified gen p mean: 0.4456750154495239, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029034443199634552, decouple_loss:0.0015730306040495634
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr_shift3.npz
NaN value num: 0
Iteration: 817, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450509250164032, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033135972917079926, decouple_loss:0.0016174019547179341
The modified gen p mean: 0.4478304386138916, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44824349880218506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03096666932106018, decouple_loss:0.001499474048614502
loss_pred:0.032844193279743195, decouple_loss:0.0016925943782553077
Iteration: 818, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466516077518463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03228664770722389, decouple_loss:0.0015396017115563154
The modified gen p mean: 0.4474806487560272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03389143943786621, decouple_loss:0.001674436149187386
The modified gen p mean: 0.44635912775993347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03304934874176979, decouple_loss:0.0015177015447989106
Iteration: 819, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44834035634994507, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032808076590299606, decouple_loss:0.0015316003700718284
The modified gen p mean: 0.4487917125225067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032450783997774124, decouple_loss:0.0016158083453774452
The modified gen p mean: 0.44878536462783813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03245434910058975, decouple_loss:0.0016353771788999438
Iteration: 820, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45540228486061096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03086571767926216, decouple_loss:0.0017616144614294171
The modified gen p mean: 0.4501415193080902, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283844515681267, decouple_loss:0.00158981594722718
The modified gen p mean: 0.44997408986091614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03285069018602371, decouple_loss:0.0016320716822519898
2023-05-26 08:40:35 testing...
The modified gen p mean: 0.45565322041511536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255171701312065, decouple_loss:0.0017851230222731829
The modified gen p mean: 0.45370641350746155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03288008272647858, decouple_loss:0.0017026095883920789
The modified gen p mean: 0.45516231656074524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03404923528432846, decouple_loss:0.0017974725924432278
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03324843570590019, avg_mse: 0.044889576733112335
current test mse: 0.04489
Iteration: 821, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507201015949249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032611291855573654, decouple_loss:0.0015418007969856262
The modified gen p mean: 0.4534875154495239, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031579237431287766, decouple_loss:0.001624826923944056
The modified gen p mean: 0.4518069326877594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03174808248877525, decouple_loss:0.0016270127380266786
Iteration: 822, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504210650920868, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03159787878394127, decouple_loss:0.0014886384597048163
The modified gen p mean: 0.45684105157852173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03211607784032822, decouple_loss:0.0016916743479669094
The modified gen p mean: 0.45401275157928467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255818784236908, decouple_loss:0.0016193855553865433
Iteration: 823, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44893425703048706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03299301862716675, decouple_loss:0.0015960115706548095
The modified gen p mean: 0.45323771238327026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03356505557894707, decouple_loss:0.0015653427690267563
The modified gen p mean: 0.4522516131401062, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0309097059071064, decouple_loss:0.0017376730684190989
Iteration: 824, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44919121265411377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03218478336930275, decouple_loss:0.0015727132558822632
The modified gen p mean: 0.4491129219532013, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032701022922992706, decouple_loss:0.001547524705529213
The modified gen p mean: 0.4526106119155884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03240685537457466, decouple_loss:0.00170070119202137
Iteration: 825, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.452792227268219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03147762268781662, decouple_loss:0.0016185137210413814
The modified gen p mean: 0.4509531259536743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03224689140915871, decouple_loss:0.0015784059651196003
The modified gen p mean: 0.44791293144226074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03148330748081207, decouple_loss:0.0015716004418209195
Iteration: 826, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44853469729423523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251532092690468, decouple_loss:0.0016613057814538479
The modified gen p mean: 0.4451420307159424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032021842896938324, decouple_loss:0.0015305104898288846
The modified gen p mean: 0.44631391763687134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03290215879678726, decouple_loss:0.0015507006319239736
Iteration: 827, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44488614797592163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03190910816192627, decouple_loss:0.0017276343423873186
The modified gen p mean: 0.447111040353775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03117145411670208, decouple_loss:0.0014166695764288306
The modified gen p mean: 0.4428665041923523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03249012678861618, decouple_loss:0.001550746732391417
Iteration: 828, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44421112537384033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033680692315101624, decouple_loss:0.001645418698899448
The modified gen p mean: 0.44622206687927246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031526047736406326, decouple_loss:0.0016365618212148547
The modified gen p mean: 0.4443325698375702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251367434859276, decouple_loss:0.0015454833628609776
Iteration: 829, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44470536708831787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03224297985434532, decouple_loss:0.001559524447657168
The modified gen p mean: 0.44332918524742126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033006079494953156, decouple_loss:0.0015512994723394513
The modified gen p mean: 0.4454215168952942, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03271877020597458, decouple_loss:0.00149766996037215
Iteration: 830, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44780468940734863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030729476362466812, decouple_loss:0.0015519759617745876
The modified gen p mean: 0.441558837890625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030508803203701973, decouple_loss:0.0014683423796668649
The modified gen p mean: 0.4429897367954254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03180621191859245, decouple_loss:0.0015046693151816726
2023-05-26 08:44:42 testing...
The modified gen p mean: 0.44938158988952637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03244980052113533, decouple_loss:0.0017345177475363016
The modified gen p mean: 0.44901469349861145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03375848010182381, decouple_loss:0.0017131238710135221
The modified gen p mean: 0.4476933181285858, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032570913434028625, decouple_loss:0.0016156084602698684
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03301078826189041, avg_mse: 0.044484611600637436
current test mse: 0.044485
Iteration: 831, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44944730401039124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03229958191514015, decouple_loss:0.00176780647598207
The modified gen p mean: 0.443878173828125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03388277441263199, decouple_loss:0.0014188687782734632
The modified gen p mean: 0.4465826451778412, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032068558037281036, decouple_loss:0.001662448514252901
Iteration: 832, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438977837562561, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032240159809589386, decouple_loss:0.0016352530801668763
The modified gen p mean: 0.4498777985572815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031542785465717316, decouple_loss:0.0016296009998768568
The modified gen p mean: 0.45186376571655273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032359879463911057, decouple_loss:0.0015599938342347741
Iteration: 833, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500340521335602, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03184939920902252, decouple_loss:0.0016297110123559833
The modified gen p mean: 0.446347713470459, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03284989297389984, decouple_loss:0.0016618953086435795
The modified gen p mean: 0.4487527310848236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03125002980232239, decouple_loss:0.0016309357015416026
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr_shift3.npz
NaN value num: 0
Iteration: 834, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489826560020447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03353489562869072, decouple_loss:0.0015085372142493725
The modified gen p mean: 0.44722244143486023, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4520101547241211, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033521268516778946, decouple_loss:0.001515023410320282
loss_pred:0.032684408128261566, decouple_loss:0.00163504877127707
Iteration: 835, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509600102901459, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03345084562897682, decouple_loss:0.0015466760378330946
The modified gen p mean: 0.45455968379974365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0320674404501915, decouple_loss:0.001689154072664678
The modified gen p mean: 0.44912514090538025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0342404767870903, decouple_loss:0.0015471290098503232
Iteration: 836, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490121304988861, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03288206830620766, decouple_loss:0.0015008733607828617
The modified gen p mean: 0.45348793268203735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03315257281064987, decouple_loss:0.0018054727697744966
The modified gen p mean: 0.44783738255500793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032561834901571274, decouple_loss:0.0015183150535449386
Iteration: 837, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534919261932373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03273453190922737, decouple_loss:0.0017529528122395277
The modified gen p mean: 0.45040953159332275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034557368606328964, decouple_loss:0.0015090592205524445
The modified gen p mean: 0.4524695575237274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034828875213861465, decouple_loss:0.0016183394473046064
Iteration: 838, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45526644587516785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03150568902492523, decouple_loss:0.0016356424894183874
The modified gen p mean: 0.45752742886543274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03468984365463257, decouple_loss:0.0016326220938935876
The modified gen p mean: 0.4578326642513275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03270904719829559, decouple_loss:0.001525523024611175
Iteration: 839, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45558619499206543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03154094144701958, decouple_loss:0.001521998317912221
The modified gen p mean: 0.4562813341617584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03157830238342285, decouple_loss:0.0014348477125167847
The modified gen p mean: 0.45405060052871704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031312838196754456, decouple_loss:0.001605771016329527
Iteration: 840, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45512211322784424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033716484904289246, decouple_loss:0.0015100435120984912
The modified gen p mean: 0.45286983251571655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03414998576045036, decouple_loss:0.0015024419408291578
The modified gen p mean: 0.4533458650112152, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0331660695374012, decouple_loss:0.0015545462956652045
2023-05-26 08:49:32 testing...
The modified gen p mean: 0.45611992478370667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032237086445093155, decouple_loss:0.0016423664055764675
The modified gen p mean: 0.45442578196525574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03221172094345093, decouple_loss:0.0015740833478048444
The modified gen p mean: 0.455904096364975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033547721803188324, decouple_loss:0.0016960501670837402
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032747384160757065, avg_mse: 0.04409575089812279
current test mse: 0.044096
Iteration: 841, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45787549018859863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032980311661958694, decouple_loss:0.0016371823148801923
The modified gen p mean: 0.4551538825035095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03131423518061638, decouple_loss:0.0016400011954829097
The modified gen p mean: 0.4503421485424042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03323392942547798, decouple_loss:0.001561825629323721
Iteration: 842, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44710907340049744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033829428255558014, decouple_loss:0.0015041569713503122
The modified gen p mean: 0.4522618353366852, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03073744662106037, decouple_loss:0.0015769476303830743
The modified gen p mean: 0.4481089115142822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03473880514502525, decouple_loss:0.0013843674678355455
Iteration: 843, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477755129337311, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03202011436223984, decouple_loss:0.001471499097533524
The modified gen p mean: 0.4495346248149872, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032688967883586884, decouple_loss:0.0015480207512155175
The modified gen p mean: 0.44834721088409424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034161247313022614, decouple_loss:0.0014344233786687255
Iteration: 844, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499700963497162, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034465111792087555, decouple_loss:0.0015242857625707984
The modified gen p mean: 0.44762498140335083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03332395479083061, decouple_loss:0.0015147242229431868
The modified gen p mean: 0.4539537727832794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034556176513433456, decouple_loss:0.0016100845532491803
Iteration: 845, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510372579097748, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03370574489235878, decouple_loss:0.001550068729557097
The modified gen p mean: 0.4471394121646881, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03200996294617653, decouple_loss:0.00148609874304384
The modified gen p mean: 0.45179641246795654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0337703600525856, decouple_loss:0.0016380420420318842
Iteration: 846, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4526846706867218, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0333343930542469, decouple_loss:0.0015198225155472755
The modified gen p mean: 0.4496026039123535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0330599769949913, decouple_loss:0.0015498698921874166
The modified gen p mean: 0.4512345790863037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03352179378271103, decouple_loss:0.001705892733298242
Iteration: 847, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445944219827652, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03425011783838272, decouple_loss:0.0014666608767583966
The modified gen p mean: 0.44791972637176514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03355862945318222, decouple_loss:0.0017236832063645124
The modified gen p mean: 0.44668257236480713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0329408273100853, decouple_loss:0.00140861002728343
Iteration: 848, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44379302859306335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03349439427256584, decouple_loss:0.001545081613585353
The modified gen p mean: 0.4484294354915619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03163374215364456, decouple_loss:0.0016277472022920847
The modified gen p mean: 0.4454026222229004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032104507088661194, decouple_loss:0.0014581411378458142
Iteration: 849, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4423535168170929, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033946067094802856, decouple_loss:0.0014051436446607113
The modified gen p mean: 0.4451243281364441, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03477054089307785, decouple_loss:0.0016169470036402345
The modified gen p mean: 0.44553521275520325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03360285982489586, decouple_loss:0.001686740666627884
Iteration: 850, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44700735807418823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03250809758901596, decouple_loss:0.0015630003763362765
The modified gen p mean: 0.4477088749408722, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0319070965051651, decouple_loss:0.0014804918318986893
The modified gen p mean: 0.44352853298187256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032154981046915054, decouple_loss:0.0014753699069842696
2023-05-26 08:53:38 testing...
The modified gen p mean: 0.4510200321674347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031941670924425125, decouple_loss:0.0015716836787760258
The modified gen p mean: 0.44924065470695496, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45098865032196045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032101597636938095, decouple_loss:0.0014725822256878018
loss_pred:0.03347962722182274, decouple_loss:0.0016118692001327872
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03258523344993591, avg_mse: 0.04383165016770363
current test mse: 0.043832
At step 850, Best test: 0.043832
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_WV_1_PC_0_EH_0_PS_40_6hrs.ckpt
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr.npz
NaN value num: 0
Iteration: 851, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482337236404419, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030429409816861153, decouple_loss:0.0013791300589218736
The modified gen p mean: 0.4496017098426819, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44463932514190674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030372004956007004, decouple_loss:0.0014398818602785468
loss_pred:0.027639176696538925, decouple_loss:0.0016100170323625207
Iteration: 852, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504619538784027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02688775025308132, decouple_loss:0.0014184981118887663
The modified gen p mean: 0.4477272629737854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027662353590130806, decouple_loss:0.0014268083032220602
The modified gen p mean: 0.4439738988876343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02849961258471012, decouple_loss:0.0015822052955627441
Iteration: 853, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446482390165329, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029376044869422913, decouple_loss:0.0014659333974123001
The modified gen p mean: 0.4430803656578064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030568454414606094, decouple_loss:0.0014676045393571258
The modified gen p mean: 0.44458767771720886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02940623089671135, decouple_loss:0.0014272663975134492
Iteration: 854, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44582125544548035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028553087264299393, decouple_loss:0.0015280384104698896
The modified gen p mean: 0.445792019367218, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029077842831611633, decouple_loss:0.0015764774288982153
The modified gen p mean: 0.44118544459342957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029799794778227806, decouple_loss:0.0014847605489194393
Iteration: 855, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4401967525482178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0280055720359087, decouple_loss:0.0015634368173778057
The modified gen p mean: 0.43987205624580383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027084099128842354, decouple_loss:0.0013955762842670083
The modified gen p mean: 0.4401854872703552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028147604316473007, decouple_loss:0.0014544692821800709
Iteration: 856, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4405424892902374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02726670913398266, decouple_loss:0.0014387767296284437
The modified gen p mean: 0.43806928396224976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028347812592983246, decouple_loss:0.0015854442026466131
The modified gen p mean: 0.43823137879371643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028581414371728897, decouple_loss:0.0015807421877980232
Iteration: 857, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4373653829097748, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028742851689457893, decouple_loss:0.0016151422169059515
The modified gen p mean: 0.44143038988113403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027401583269238472, decouple_loss:0.0016645420109853148
The modified gen p mean: 0.4392583966255188, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02978518418967724, decouple_loss:0.0015268842689692974
Iteration: 858, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4398691654205322, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44037508964538574, gen p mean: 0.0, mean p set: 0.448loss_pred:0.030799053609371185, decouple_loss:0.0016045223455876112
loss_pred:0.028939029201865196, decouple_loss:0.0015116201248019934
The modified gen p mean: 0.4444146156311035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02789854072034359, decouple_loss:0.001961036119610071
Iteration: 859, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44240230321884155, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4475559890270233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028280537575483322, decouple_loss:0.0016479502664878964
loss_pred:0.026651550084352493, decouple_loss:0.0020196742843836546
The modified gen p mean: 0.44261741638183594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02952686883509159, decouple_loss:0.0015424200100824237
Iteration: 860, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470828175544739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029440587386488914, decouple_loss:0.0016102741938084364
The modified gen p mean: 0.44504809379577637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027686558663845062, decouple_loss:0.0014999901177361608
The modified gen p mean: 0.4447896182537079, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03016028180718422, decouple_loss:0.001547092804685235
2023-05-26 08:58:33 testing...
The modified gen p mean: 0.45339348912239075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032499294728040695, decouple_loss:0.0017079573590308428
The modified gen p mean: 0.4515417814254761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032676298171281815, decouple_loss:0.0016021084738895297
The modified gen p mean: 0.4534660577774048, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033889733254909515, decouple_loss:0.0018075649859383702
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03310707211494446, avg_mse: 0.04475600644946098
current test mse: 0.044756
Iteration: 861, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45233869552612305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027270492166280746, decouple_loss:0.0017329200636595488
The modified gen p mean: 0.45107924938201904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02740158885717392, decouple_loss:0.0016729701310396194
The modified gen p mean: 0.44533005356788635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02788633480668068, decouple_loss:0.0016117155319079757
Iteration: 862, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45002973079681396, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44917550683021545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03021518513560295, decouple_loss:0.0017521961126476526
loss_pred:0.029310939833521843, decouple_loss:0.0016554297180846334
The modified gen p mean: 0.45192641019821167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027177972719073296, decouple_loss:0.0017948625609278679
Iteration: 863, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45426473021507263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027974918484687805, decouple_loss:0.0016130360309034586
The modified gen p mean: 0.45334818959236145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026596028357744217, decouple_loss:0.0016523790545761585
The modified gen p mean: 0.45312315225601196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026270342990756035, decouple_loss:0.0017021558014675975
Iteration: 864, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45040586590766907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02793091908097267, decouple_loss:0.0018631647108122706
The modified gen p mean: 0.4513324797153473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028134753927588463, decouple_loss:0.0018585864454507828
The modified gen p mean: 0.4529212415218353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027637194842100143, decouple_loss:0.0019881094340234995
Iteration: 865, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45036110281944275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026622159406542778, decouple_loss:0.0017241733148694038
The modified gen p mean: 0.45193979144096375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026583924889564514, decouple_loss:0.001807461492717266
The modified gen p mean: 0.45471519231796265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027640128508210182, decouple_loss:0.0015356908552348614
Iteration: 866, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4530353546142578, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027379203587770462, decouple_loss:0.001617208356037736
The modified gen p mean: 0.4516259729862213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029127148911356926, decouple_loss:0.0015713644679635763
The modified gen p mean: 0.4525212347507477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026676692068576813, decouple_loss:0.0017930452013388276
Iteration: 867, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478679597377777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030106516554951668, decouple_loss:0.0018454556120559573
The modified gen p mean: 0.4519934058189392, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028620697557926178, decouple_loss:0.001729622483253479
The modified gen p mean: 0.45107531547546387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02656235359609127, decouple_loss:0.0018311751773580909
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr_shift3.npz
NaN value num: 0
Iteration: 868, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45225441455841064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02969125099480152, decouple_loss:0.0017143725417554379
The modified gen p mean: 0.44551175832748413, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45037755370140076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03128974884748459, decouple_loss:0.0018254927126690745
loss_pred:0.03266620635986328, decouple_loss:0.001506471773609519
Iteration: 869, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44651123881340027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02911458909511566, decouple_loss:0.0015080115990713239
The modified gen p mean: 0.44591525197029114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03003562241792679, decouple_loss:0.001602430478669703
The modified gen p mean: 0.45263978838920593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03006814979016781, decouple_loss:0.0018154728459194303
Iteration: 870, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471147954463959, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03018723800778389, decouple_loss:0.0017253526020795107
The modified gen p mean: 0.44857504963874817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03099910356104374, decouple_loss:0.001527867978438735
The modified gen p mean: 0.4494480788707733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03022940643131733, decouple_loss:0.001628246856853366
2023-05-26 09:03:25 testing...
The modified gen p mean: 0.45232856273651123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03262752667069435, decouple_loss:0.0017678362783044577
The modified gen p mean: 0.45065703988075256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032955776900053024, decouple_loss:0.00168868456967175
The modified gen p mean: 0.4524303376674652, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03402172774076462, decouple_loss:0.0018080725567415357
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03328942134976387, avg_mse: 0.04508083313703537
current test mse: 0.045081
Iteration: 871, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479196071624756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029935641214251518, decouple_loss:0.0015517297433689237
The modified gen p mean: 0.45109525322914124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03013065829873085, decouple_loss:0.0015499488217756152
The modified gen p mean: 0.4484797716140747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02841058187186718, decouple_loss:0.001718883286230266
Iteration: 872, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4552494287490845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031380753964185715, decouple_loss:0.0017442083917558193
The modified gen p mean: 0.4537145495414734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030419865623116493, decouple_loss:0.0016051112907007337
The modified gen p mean: 0.45361271500587463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031051982194185257, decouple_loss:0.0016552909510210156
Iteration: 873, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513516426086426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029675563797354698, decouple_loss:0.0015601065242663026
The modified gen p mean: 0.4518021047115326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030398020520806313, decouple_loss:0.0016261531272903085
The modified gen p mean: 0.45008906722068787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029204651713371277, decouple_loss:0.0014850427396595478
Iteration: 874, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45034459233283997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03051062859594822, decouple_loss:0.002047321293503046
The modified gen p mean: 0.45013487339019775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030490420758724213, decouple_loss:0.0016663245623931289
The modified gen p mean: 0.45111286640167236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03216387331485748, decouple_loss:0.001683226553723216
Iteration: 875, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45096492767333984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029375508427619934, decouple_loss:0.001533134956844151
The modified gen p mean: 0.4533810317516327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02978663519024849, decouple_loss:0.001722221146337688
The modified gen p mean: 0.4508969187736511, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029242299497127533, decouple_loss:0.0015776620712131262
Iteration: 876, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500375986099243, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031298380345106125, decouple_loss:0.001673477585427463
The modified gen p mean: 0.4507845938205719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02825014665722847, decouple_loss:0.001718955347314477
The modified gen p mean: 0.44831037521362305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030456367880105972, decouple_loss:0.0017941805999726057
Iteration: 877, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45257726311683655, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45201951265335083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0302522461861372, decouple_loss:0.0017148562474176288
loss_pred:0.03056727722287178, decouple_loss:0.0019829454831779003
The modified gen p mean: 0.44810986518859863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029137980192899704, decouple_loss:0.002132224617525935
Iteration: 878, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44932448863983154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030083201825618744, decouple_loss:0.0016073610167950392
The modified gen p mean: 0.4467312693595886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02964959293603897, decouple_loss:0.0015618221368640661
The modified gen p mean: 0.45123231410980225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027791988104581833, decouple_loss:0.0016198715893551707
Iteration: 879, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447402685880661, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02747977524995804, decouple_loss:0.0016489150002598763
The modified gen p mean: 0.44970354437828064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02749205008149147, decouple_loss:0.0017496668733656406
The modified gen p mean: 0.44706371426582336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02903931401669979, decouple_loss:0.001728748669847846
Iteration: 880, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44547292590141296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02842714823782444, decouple_loss:0.0016688912874087691
The modified gen p mean: 0.4493979513645172, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03026827611029148, decouple_loss:0.0017031474271789193
The modified gen p mean: 0.44384706020355225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030332133173942566, decouple_loss:0.0014961693668738008
2023-05-26 09:07:31 testing...
The modified gen p mean: 0.45071858167648315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03331281244754791, decouple_loss:0.001867629704065621
The modified gen p mean: 0.45030295848846436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03487235680222511, decouple_loss:0.0019291050266474485
The modified gen p mean: 0.4486168622970581, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03355836868286133, decouple_loss:0.0018403835128992796
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.034008465707302094, avg_mse: 0.04607892781496048
current test mse: 0.046079
Iteration: 881, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44650647044181824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030117500573396683, decouple_loss:0.0016858450835570693
The modified gen p mean: 0.44856008887290955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027992909774184227, decouple_loss:0.0018056858098134398
The modified gen p mean: 0.444221556186676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02915125899016857, decouple_loss:0.0016161750536412
Iteration: 882, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44818875193595886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029520506039261818, decouple_loss:0.0019224262796342373
The modified gen p mean: 0.4476739466190338, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03046340122818947, decouple_loss:0.001860709278844297
The modified gen p mean: 0.4499470293521881, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028517108410596848, decouple_loss:0.0016608687583357096
Iteration: 883, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466451108455658, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44628676772117615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02809159643948078, decouple_loss:0.0017254705308005214
loss_pred:0.027681836858391762, decouple_loss:0.0019496666500344872
The modified gen p mean: 0.4479624330997467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029254192486405373, decouple_loss:0.0017421620432287455
Iteration: 884, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4525717794895172, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029018256813287735, decouple_loss:0.0017863124376162887
The modified gen p mean: 0.450101763010025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029065517708659172, decouple_loss:0.0019233250059187412
The modified gen p mean: 0.44721463322639465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029171964153647423, decouple_loss:0.0015149631071835756
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr.npz
NaN value num: 0
Iteration: 885, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44761961698532104, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4510546326637268, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030967798084020615, decouple_loss:0.0016960344510152936
The modified gen p mean: 0.44684964418411255, gen p mean: 0.0, mean p set: 0.448loss_pred:0.029786137863993645, decouple_loss:0.0018083284376189113
loss_pred:0.03138744458556175, decouple_loss:0.001678218599408865
Iteration: 886, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463503062725067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028569597750902176, decouple_loss:0.0017534455982968211
The modified gen p mean: 0.44670161604881287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029122332111001015, decouple_loss:0.0016948195407167077
The modified gen p mean: 0.4473129212856293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030122017487883568, decouple_loss:0.0016669443575665355
Iteration: 887, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45198342204093933, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02730385586619377, decouple_loss:0.0018178039463236928
The modified gen p mean: 0.4463270902633667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027514459565281868, decouple_loss:0.0016237152740359306
The modified gen p mean: 0.4483143091201782, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02907550148665905, decouple_loss:0.0017780817579478025
Iteration: 888, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44564932584762573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027547840029001236, decouple_loss:0.0016968275886029005
The modified gen p mean: 0.4490600526332855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027894791215658188, decouple_loss:0.0017330747796222568
The modified gen p mean: 0.44391342997550964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0279003344476223, decouple_loss:0.001522020436823368
Iteration: 889, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45095768570899963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02791532874107361, decouple_loss:0.001701675122603774
The modified gen p mean: 0.45037686824798584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02808554284274578, decouple_loss:0.0016555343754589558
The modified gen p mean: 0.447594553232193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02774377539753914, decouple_loss:0.0017585490131750703
Iteration: 890, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44899260997772217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027827724814414978, decouple_loss:0.0015847774920985103
The modified gen p mean: 0.4456896483898163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02909839153289795, decouple_loss:0.0016329223290085793
The modified gen p mean: 0.44863414764404297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722056210041046, decouple_loss:0.0016453121788799763
2023-05-26 09:12:14 testing...
The modified gen p mean: 0.45381617546081543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03302918002009392, decouple_loss:0.001793262897990644
The modified gen p mean: 0.4535897970199585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03440026938915253, decouple_loss:0.0018279977375641465
The modified gen p mean: 0.4519190192222595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033210743218660355, decouple_loss:0.0016805509803816676
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03363509476184845, avg_mse: 0.045731861144304276
current test mse: 0.045732
Iteration: 891, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45162835717201233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02721831202507019, decouple_loss:0.0018456875113770366
The modified gen p mean: 0.44968050718307495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02860458567738533, decouple_loss:0.0015986724756658077
The modified gen p mean: 0.45024213194847107, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027672870084643364, decouple_loss:0.0017049823654815555
Iteration: 892, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478009045124054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028205739334225655, decouple_loss:0.0016296360408887267
The modified gen p mean: 0.4493286609649658, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02883141115307808, decouple_loss:0.0015926422784104943
The modified gen p mean: 0.4485976994037628, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028999486938118935, decouple_loss:0.0016570271691307425
Iteration: 893, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45043814182281494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02858521044254303, decouple_loss:0.0015693778404965997
The modified gen p mean: 0.4546096920967102, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027895711362361908, decouple_loss:0.0016823334153741598
The modified gen p mean: 0.446882963180542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02826625667512417, decouple_loss:0.0015793279744684696
Iteration: 894, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495834708213806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028050560504198074, decouple_loss:0.0016955147730186582
The modified gen p mean: 0.4501992166042328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029201146215200424, decouple_loss:0.0015983968041837215
The modified gen p mean: 0.44973576068878174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027472682297229767, decouple_loss:0.001839679665863514
Iteration: 895, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448324978351593, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45195436477661133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028569374233484268, decouple_loss:0.001510673901066184
loss_pred:0.028101958334445953, decouple_loss:0.0018061611335724592
The modified gen p mean: 0.4487692713737488, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028042707592248917, decouple_loss:0.0015273472527042031
Iteration: 896, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45265382528305054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02663606032729149, decouple_loss:0.0017589032649993896
The modified gen p mean: 0.44683948159217834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0291836429387331, decouple_loss:0.0015896285185590386
The modified gen p mean: 0.4477769732475281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028017548844218254, decouple_loss:0.0016602131072431803
Iteration: 897, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460032284259796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028222836554050446, decouple_loss:0.0016132150776684284
The modified gen p mean: 0.4456002712249756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027945462614297867, decouple_loss:0.0015665083192288876
The modified gen p mean: 0.4460173547267914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027864566072821617, decouple_loss:0.0016281969146803021
Iteration: 898, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476836919784546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027113627642393112, decouple_loss:0.0016245621955022216
The modified gen p mean: 0.44458332657814026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02936388924717903, decouple_loss:0.0016124974936246872
The modified gen p mean: 0.44634300470352173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027670659124851227, decouple_loss:0.0017261331668123603
Iteration: 899, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44117283821105957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028498971834778786, decouple_loss:0.0017493214691057801
The modified gen p mean: 0.4444609582424164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028437476605176926, decouple_loss:0.001592267886735499
The modified gen p mean: 0.44519561529159546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026633845642209053, decouple_loss:0.0017968618776649237
Iteration: 900, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482414424419403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02734731137752533, decouple_loss:0.0015806587180122733
The modified gen p mean: 0.44348984956741333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028529485687613487, decouple_loss:0.0016082037473097444
The modified gen p mean: 0.4463428556919098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026727065443992615, decouple_loss:0.0015014080563560128
2023-05-26 09:16:19 testing...
The modified gen p mean: 0.4488028585910797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03262318670749664, decouple_loss:0.001710119773633778
The modified gen p mean: 0.4486066401004791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03404726833105087, decouple_loss:0.0018373116618022323
The modified gen p mean: 0.4468420743942261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03290953114628792, decouple_loss:0.0016687195748090744
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03328026458621025, avg_mse: 0.04512385278940201
current test mse: 0.045124
Iteration: 901, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454076886177063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028161754831671715, decouple_loss:0.0015229006530717015
The modified gen p mean: 0.44277530908584595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028310401365160942, decouple_loss:0.001461993670091033
The modified gen p mean: 0.445896178483963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026958080008625984, decouple_loss:0.0016906224191188812
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr_shift3.npz
NaN value num: 0
Iteration: 902, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451867938041687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030065741389989853, decouple_loss:0.0015909490175545216
The modified gen p mean: 0.4473617970943451, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02912856638431549, decouple_loss:0.0018732650205492973
The modified gen p mean: 0.4432934820652008, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031353630125522614, decouple_loss:0.0016754112439230084
Iteration: 903, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459223449230194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283676132559776, decouple_loss:0.0017008703434839845
The modified gen p mean: 0.4483141005039215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028966745361685753, decouple_loss:0.0015705754049122334
The modified gen p mean: 0.4478256404399872, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030454346910119057, decouple_loss:0.0015339790843427181
Iteration: 904, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499921202659607, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028965970501303673, decouple_loss:0.001714153215289116
The modified gen p mean: 0.4503152370452881, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03088945709168911, decouple_loss:0.0017432939494028687
The modified gen p mean: 0.45177391171455383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030053462833166122, decouple_loss:0.0019804141484200954
Iteration: 905, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.452974796295166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02868865430355072, decouple_loss:0.0017506475560367107
The modified gen p mean: 0.4499628245830536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03172999620437622, decouple_loss:0.0015505626797676086
The modified gen p mean: 0.4526389539241791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03127328306436539, decouple_loss:0.0017301073530688882
Iteration: 906, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4541223347187042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028790954500436783, decouple_loss:0.0017297471640631557
The modified gen p mean: 0.4512132406234741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032282646745443344, decouple_loss:0.0015074259135872126
The modified gen p mean: 0.45548152923583984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02880701795220375, decouple_loss:0.0016236962983384728
Iteration: 907, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488277733325958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029351983219385147, decouple_loss:0.0015444922028109431
The modified gen p mean: 0.45023828744888306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03062191978096962, decouple_loss:0.00173772347625345
The modified gen p mean: 0.44992417097091675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03181065246462822, decouple_loss:0.0017165361205115914
Iteration: 908, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45023441314697266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028985384851694107, decouple_loss:0.001607562997378409
The modified gen p mean: 0.4483110010623932, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03204932063817978, decouple_loss:0.0015846594469621778
The modified gen p mean: 0.45390424132347107, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029130611568689346, decouple_loss:0.0016917272005230188
Iteration: 909, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477888345718384, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.450675904750824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030095115303993225, decouple_loss:0.0016403340268880129
loss_pred:0.0289969090372324, decouple_loss:0.0017199423164129257
The modified gen p mean: 0.44787663221359253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02918904647231102, decouple_loss:0.0015723374672234058
Iteration: 910, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474134147167206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029793374240398407, decouple_loss:0.0017986985621973872
The modified gen p mean: 0.44637924432754517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029048848897218704, decouple_loss:0.0018079542787745595
The modified gen p mean: 0.44472673535346985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02907211147248745, decouple_loss:0.0014614110114052892
2023-05-26 09:21:03 testing...
The modified gen p mean: 0.4504950940608978, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03243033587932587, decouple_loss:0.0017707333900034428
The modified gen p mean: 0.44852808117866516, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45019081234931946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032802678644657135, decouple_loss:0.0016917547909542918
loss_pred:0.03391081467270851, decouple_loss:0.0018433841178193688
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03313637524843216, avg_mse: 0.044870775192976
current test mse: 0.044871
Iteration: 911, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44596630334854126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028515882790088654, decouple_loss:0.0018177294405177236
The modified gen p mean: 0.44872182607650757, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027792900800704956, decouple_loss:0.0017811850411817431
The modified gen p mean: 0.44495320320129395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03037874773144722, decouple_loss:0.0016531423898413777
Iteration: 912, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4437420964241028, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03048635646700859, decouple_loss:0.0019051226554438472
The modified gen p mean: 0.4456227421760559, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028628896921873093, decouple_loss:0.0018686967669054866
The modified gen p mean: 0.4444117546081543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030564768239855766, decouple_loss:0.0018263497622683644
Iteration: 913, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4427639842033386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030198222026228905, decouple_loss:0.001872943714261055
The modified gen p mean: 0.4423580765724182, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030446069315075874, decouple_loss:0.0016229244647547603
The modified gen p mean: 0.44421207904815674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030475523322820663, decouple_loss:0.0016134358011186123
Iteration: 914, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449223279953003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03051614575088024, decouple_loss:0.0018472227966412902
The modified gen p mean: 0.44523659348487854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029367243871092796, decouple_loss:0.0019913313444703817
The modified gen p mean: 0.4436413645744324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029939567670226097, decouple_loss:0.001726656686514616
Iteration: 915, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444301128387451, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029742080718278885, decouple_loss:0.0016855329740792513
The modified gen p mean: 0.44299745559692383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02834308333694935, decouple_loss:0.0016104727983474731
The modified gen p mean: 0.44596219062805176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028953347355127335, decouple_loss:0.001973972423002124
Iteration: 916, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444115549325943, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4486052095890045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028303083032369614, decouple_loss:0.0016359107103198767
loss_pred:0.02851290814578533, decouple_loss:0.00172152160666883
The modified gen p mean: 0.4439350366592407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03019317425787449, decouple_loss:0.0016544850077480078
Iteration: 917, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44923269748687744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027821561321616173, decouple_loss:0.002038404578343034
The modified gen p mean: 0.44685718417167664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03063984028995037, decouple_loss:0.0021875090897083282
The modified gen p mean: 0.44556185603141785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027669288218021393, decouple_loss:0.0017676561838015914
Iteration: 918, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507034122943878, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028478829190135002, decouple_loss:0.0016746422043070197
The modified gen p mean: 0.45094814896583557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031811125576496124, decouple_loss:0.0019014660501852632
The modified gen p mean: 0.44645631313323975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030258750542998314, decouple_loss:0.0016922600334510207
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr.npz
NaN value num: 0
Iteration: 919, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45044058561325073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030492529273033142, decouple_loss:0.0019796418491750956
The modified gen p mean: 0.44808071851730347, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488162696361542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029312649741768837, decouple_loss:0.0018370429752394557
loss_pred:0.028610959649086, decouple_loss:0.0018056925619021058
Iteration: 920, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513314962387085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029225913807749748, decouple_loss:0.0019479537149891257
The modified gen p mean: 0.448551744222641, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028913341462612152, decouple_loss:0.001775137847289443
The modified gen p mean: 0.4499402344226837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02825176902115345, decouple_loss:0.0018070109654217958
2023-05-26 09:25:47 testing...
The modified gen p mean: 0.45528629422187805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03266913816332817, decouple_loss:0.0017951802583411336
The modified gen p mean: 0.45495712757110596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03403554484248161, decouple_loss:0.001879058196209371
The modified gen p mean: 0.4535228908061981, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03296079859137535, decouple_loss:0.0017404034733772278
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03331207111477852, avg_mse: 0.04506703466176987
current test mse: 0.045067
Iteration: 921, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493255913257599, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02894250489771366, decouple_loss:0.001675296574831009
The modified gen p mean: 0.45170554518699646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027999944984912872, decouple_loss:0.0016978818457573652
The modified gen p mean: 0.45099449157714844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02991677261888981, decouple_loss:0.0017510548932477832
Iteration: 922, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45304712653160095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026366902515292168, decouple_loss:0.0018607102101668715
The modified gen p mean: 0.4560354948043823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028794150799512863, decouple_loss:0.0019425548380240798
The modified gen p mean: 0.4524083435535431, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027898630127310753, decouple_loss:0.0016387017676606774
Iteration: 923, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492221176624298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029301505535840988, decouple_loss:0.0017027569701895118
The modified gen p mean: 0.4491121470928192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028542090207338333, decouple_loss:0.001698591047897935
The modified gen p mean: 0.4499260187149048, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029222892597317696, decouple_loss:0.0019208125304430723
Iteration: 924, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496188163757324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02915460243821144, decouple_loss:0.0018603357020765543
The modified gen p mean: 0.45068901777267456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029398014768958092, decouple_loss:0.001813142211176455
The modified gen p mean: 0.4499395191669464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029674213379621506, decouple_loss:0.002028761664405465
Iteration: 925, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501155614852905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029995042830705643, decouple_loss:0.0019184600096195936
The modified gen p mean: 0.452639639377594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029319381341338158, decouple_loss:0.0016446852823719382
The modified gen p mean: 0.4505310654640198, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028224362060427666, decouple_loss:0.0018257658230140805
Iteration: 926, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510457515716553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028861388564109802, decouple_loss:0.0016355679836124182
The modified gen p mean: 0.44919857382774353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02833975851535797, decouple_loss:0.0018230127170681953
The modified gen p mean: 0.4498327672481537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02755839191377163, decouple_loss:0.0017155617242679
Iteration: 927, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45000511407852173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028824448585510254, decouple_loss:0.001963627291843295
The modified gen p mean: 0.45004454255104065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028065131977200508, decouple_loss:0.0022656710352748632
The modified gen p mean: 0.45012274384498596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027945421636104584, decouple_loss:0.0021344078704714775
Iteration: 928, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45280954241752625, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4510977566242218, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028383830562233925, decouple_loss:0.0019122648518532515
loss_pred:0.028573183342814445, decouple_loss:0.0017618302954360843
The modified gen p mean: 0.45265766978263855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027396436780691147, decouple_loss:0.001686725183390081
Iteration: 929, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44814667105674744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030136054381728172, decouple_loss:0.001884208177216351
The modified gen p mean: 0.4482616186141968, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028343098238110542, decouple_loss:0.001678534783422947
The modified gen p mean: 0.450626939535141, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029297396540641785, decouple_loss:0.0017175510292872787
Iteration: 930, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466230273246765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028417222201824188, decouple_loss:0.001601212308742106
The modified gen p mean: 0.4532630443572998, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027583695948123932, decouple_loss:0.0017321421764791012
The modified gen p mean: 0.4509386122226715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029573770239949226, decouple_loss:0.0018762500258162618
2023-05-26 09:29:52 testing...
The modified gen p mean: 0.455375611782074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265427052974701, decouple_loss:0.0017816501203924417
The modified gen p mean: 0.4535648226737976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0330074168741703, decouple_loss:0.0016800689045339823
The modified gen p mean: 0.45528116822242737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03404322639107704, decouple_loss:0.0018891304498538375
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03332415223121643, avg_mse: 0.045256298035383224
current test mse: 0.045256
Iteration: 931, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4545150101184845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02759798802435398, decouple_loss:0.001874542678706348
The modified gen p mean: 0.44890090823173523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0293277520686388, decouple_loss:0.0017559124389663339
The modified gen p mean: 0.45091161131858826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027139894664287567, decouple_loss:0.0016789226792752743
Iteration: 932, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45557889342308044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028507346287369728, decouple_loss:0.0015795957297086716
The modified gen p mean: 0.4541883170604706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027724329382181168, decouple_loss:0.0017319020116701722
The modified gen p mean: 0.44945278763771057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028335552662611008, decouple_loss:0.0015888214111328125
Iteration: 933, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45251622796058655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03027215600013733, decouple_loss:0.0016992847668007016
The modified gen p mean: 0.4517272710800171, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028278104960918427, decouple_loss:0.0017710627289488912
The modified gen p mean: 0.45042920112609863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02719539776444435, decouple_loss:0.0016416837461292744
Iteration: 934, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44981491565704346, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45236384868621826, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02774314396083355, decouple_loss:0.001983156194910407
loss_pred:0.029267622157931328, decouple_loss:0.0016836696304380894
The modified gen p mean: 0.44952380657196045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025950809940695763, decouple_loss:0.0019131458830088377
Iteration: 935, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4520634412765503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029962889850139618, decouple_loss:0.0019036965677514672
The modified gen p mean: 0.4525199830532074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028421005234122276, decouple_loss:0.0017075969371944666
The modified gen p mean: 0.45576244592666626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02845337986946106, decouple_loss:0.0017585873138159513
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr_shift3.npz
NaN value num: 0
Iteration: 936, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45190951228141785, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.450866162776947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031214652583003044, decouple_loss:0.0014921240508556366
The modified gen p mean: 0.4494766891002655, gen p mean: 0.0, mean p set: 0.448loss_pred:0.032942984253168106, decouple_loss:0.0016137673519551754
loss_pred:0.03205913305282593, decouple_loss:0.001627155696041882
Iteration: 937, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491446912288666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03407992795109749, decouple_loss:0.0016743919113650918
The modified gen p mean: 0.4493566155433655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03229539096355438, decouple_loss:0.0013916348107159138
The modified gen p mean: 0.4502895474433899, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034458838403224945, decouple_loss:0.0014549035113304853
Iteration: 938, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485495090484619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03305946663022041, decouple_loss:0.0014558924594894052
The modified gen p mean: 0.4517548382282257, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03447369486093521, decouple_loss:0.0015170484548434615
The modified gen p mean: 0.4468913972377777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032655928283929825, decouple_loss:0.001555324881337583
Iteration: 939, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44828474521636963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03571479395031929, decouple_loss:0.0015275025507435203
The modified gen p mean: 0.44819509983062744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033343471586704254, decouple_loss:0.0016156198689714074
The modified gen p mean: 0.45205384492874146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03292660042643547, decouple_loss:0.001811767928302288
Iteration: 940, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508872330188751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0315508097410202, decouple_loss:0.0017729683313518763
The modified gen p mean: 0.44911226630210876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03403043746948242, decouple_loss:0.0016667592572048306
The modified gen p mean: 0.44888439774513245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0314921960234642, decouple_loss:0.0017916134092956781
2023-05-26 09:34:36 testing...
The modified gen p mean: 0.44804462790489197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03227335959672928, decouple_loss:0.001724942121654749
The modified gen p mean: 0.4462442994117737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254614770412445, decouple_loss:0.0017055755015462637
The modified gen p mean: 0.4480927884578705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033657025545835495, decouple_loss:0.0018319017253816128
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032913219183683395, avg_mse: 0.04447810351848602
current test mse: 0.044478
Iteration: 941, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44581058621406555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0310930497944355, decouple_loss:0.0016187472501769662
The modified gen p mean: 0.44352447986602783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03272385522723198, decouple_loss:0.0014527825405821204
The modified gen p mean: 0.4464435875415802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03359144926071167, decouple_loss:0.0016061586793512106
Iteration: 942, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44141170382499695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032364845275878906, decouple_loss:0.0013894634321331978
The modified gen p mean: 0.44542625546455383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03271788731217384, decouple_loss:0.0013907296815887094
The modified gen p mean: 0.44652384519577026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03217964619398117, decouple_loss:0.001572691136971116
Iteration: 943, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441048502922058, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.444821298122406, gen p mean: 0.0, mean p set: 0.448loss_pred:0.035507068037986755, decouple_loss:0.0013645112048834562
loss_pred:0.03100297972559929, decouple_loss:0.0014417292550206184
The modified gen p mean: 0.44315192103385925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031047506257891655, decouple_loss:0.0014543230645358562
Iteration: 944, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454675018787384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03440750762820244, decouple_loss:0.0015423806617036462
The modified gen p mean: 0.44322454929351807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03244620934128761, decouple_loss:0.001447077956981957
The modified gen p mean: 0.44196265935897827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03305887058377266, decouple_loss:0.0015197243774309754
Iteration: 945, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4423046410083771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03373635932803154, decouple_loss:0.0015163059579208493
The modified gen p mean: 0.4439191222190857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0330364890396595, decouple_loss:0.0015846253372728825
The modified gen p mean: 0.4444992244243622, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03327896073460579, decouple_loss:0.0014132224023342133
Iteration: 946, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44587478041648865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03388810157775879, decouple_loss:0.001526778913103044
The modified gen p mean: 0.4454147219657898, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03167536109685898, decouple_loss:0.0014800576027482748
The modified gen p mean: 0.44692859053611755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03123689442873001, decouple_loss:0.0015976997092366219
Iteration: 947, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471464157104492, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03293251991271973, decouple_loss:0.00142943044193089
The modified gen p mean: 0.45529431104660034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03332716226577759, decouple_loss:0.0015978023875504732
The modified gen p mean: 0.45145201683044434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032037727534770966, decouple_loss:0.0015369317261502147
Iteration: 948, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504128098487854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03302298113703728, decouple_loss:0.0014051649486646056
The modified gen p mean: 0.45346784591674805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035254817456007004, decouple_loss:0.0014330523554235697
The modified gen p mean: 0.4502509832382202, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03267819434404373, decouple_loss:0.0013539503561332822
Iteration: 949, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4552481174468994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03203440085053444, decouple_loss:0.0015063694445416331
The modified gen p mean: 0.4533137381076813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032287243753671646, decouple_loss:0.001553089707158506
The modified gen p mean: 0.45158177614212036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03184745833277702, decouple_loss:0.0014708383241668344
Iteration: 950, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4521017074584961, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03219851851463318, decouple_loss:0.0015754569321870804
The modified gen p mean: 0.4545612335205078, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03459402546286583, decouple_loss:0.0015109007945284247
The modified gen p mean: 0.4515686333179474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0329480841755867, decouple_loss:0.0013537544291466475
2023-05-26 09:38:42 testing...
The modified gen p mean: 0.4553634226322174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03213869407773018, decouple_loss:0.0016285276506096125
The modified gen p mean: 0.4552805423736572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033485621213912964, decouple_loss:0.0016742004081606865
The modified gen p mean: 0.4536287188529968, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03232447803020477, decouple_loss:0.0015013342490419745
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03272966668009758, avg_mse: 0.044112786650657654
current test mse: 0.044113
Iteration: 951, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502040445804596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033701762557029724, decouple_loss:0.001471477560698986
The modified gen p mean: 0.4543370306491852, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033833619207143784, decouple_loss:0.0014265656936913729
The modified gen p mean: 0.45188915729522705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03220747038722038, decouple_loss:0.0016302582807838917
Iteration: 952, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45271241664886475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03191347047686577, decouple_loss:0.0014128339244052768
The modified gen p mean: 0.4547090232372284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259734436869621, decouple_loss:0.0015293516917154193
The modified gen p mean: 0.4514214098453522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03307504579424858, decouple_loss:0.0014431184390559793
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr.npz
NaN value num: 0
Iteration: 953, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506946802139282, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030104955658316612, decouple_loss:0.001596891786903143
The modified gen p mean: 0.4516230821609497, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44441601634025574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026714302599430084, decouple_loss:0.0015276290941983461
loss_pred:0.029570018872618675, decouple_loss:0.0015936599811539054
Iteration: 954, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4430523216724396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02885216847062111, decouple_loss:0.0014417986385524273
The modified gen p mean: 0.4438124895095825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02980141155421734, decouple_loss:0.0017140149138867855
The modified gen p mean: 0.4433709681034088, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028936393558979034, decouple_loss:0.0015346694272011518
Iteration: 955, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44646793603897095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027821479365229607, decouple_loss:0.0018787364242598414
The modified gen p mean: 0.4420337378978729, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02863978035748005, decouple_loss:0.0013795159757137299
The modified gen p mean: 0.44733625650405884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028451118618249893, decouple_loss:0.0015135370194911957
Iteration: 956, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487830400466919, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02857557125389576, decouple_loss:0.0016683385474607348
The modified gen p mean: 0.44289296865463257, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02899644337594509, decouple_loss:0.0014455196214839816
The modified gen p mean: 0.4446217715740204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027469314634799957, decouple_loss:0.0015712595777586102
Iteration: 957, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44317683577537537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02904549613595009, decouple_loss:0.0014718485763296485
The modified gen p mean: 0.448919415473938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028098491951823235, decouple_loss:0.001696092658676207
The modified gen p mean: 0.45014190673828125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027461707592010498, decouple_loss:0.0016621500253677368
Iteration: 958, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442393183708191, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028865758329629898, decouple_loss:0.001600564457476139
The modified gen p mean: 0.448438823223114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026723003014922142, decouple_loss:0.0015378993703052402
The modified gen p mean: 0.4472854733467102, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02890637330710888, decouple_loss:0.0017376863397657871
Iteration: 959, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44457465410232544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027845997363328934, decouple_loss:0.0017428400460630655
The modified gen p mean: 0.4443792402744293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028780104592442513, decouple_loss:0.0015581452753394842
The modified gen p mean: 0.4449038803577423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026647744700312614, decouple_loss:0.0015737698413431644
Iteration: 960, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44621703028678894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029030630365014076, decouple_loss:0.001502720289863646
The modified gen p mean: 0.4470684230327606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028678948059678078, decouple_loss:0.001630987273529172
The modified gen p mean: 0.4454798102378845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029056482017040253, decouple_loss:0.0016246521845459938
2023-05-26 09:43:29 testing...
The modified gen p mean: 0.45304495096206665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032396670430898666, decouple_loss:0.0017146171303465962
The modified gen p mean: 0.4531482458114624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03385433182120323, decouple_loss:0.0018114944687113166
The modified gen p mean: 0.45137113332748413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03271406143903732, decouple_loss:0.001616067485883832
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03307405859231949, avg_mse: 0.04479914903640747
current test mse: 0.044799
Iteration: 961, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45121899247169495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02806662768125534, decouple_loss:0.0016293007647618651
The modified gen p mean: 0.4477953016757965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029187120497226715, decouple_loss:0.001673197722993791
The modified gen p mean: 0.44703006744384766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028066202998161316, decouple_loss:0.00150879449211061
Iteration: 962, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480212330818176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02832772210240364, decouple_loss:0.0014739538310095668
The modified gen p mean: 0.45045697689056396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027210157364606857, decouple_loss:0.001847948762588203
The modified gen p mean: 0.4522536098957062, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02775215171277523, decouple_loss:0.0015763951232656837
Iteration: 963, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485960602760315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027770478278398514, decouple_loss:0.0016332032391801476
The modified gen p mean: 0.44719427824020386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027098432183265686, decouple_loss:0.0015611669514328241
The modified gen p mean: 0.4463635981082916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02798706479370594, decouple_loss:0.001584389596246183
Iteration: 964, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45275118947029114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027709655463695526, decouple_loss:0.0016300792340189219
The modified gen p mean: 0.44930529594421387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026902442798018456, decouple_loss:0.0016042792703956366
The modified gen p mean: 0.45440852642059326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02735316753387451, decouple_loss:0.0016984202666208148
Iteration: 965, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497913420200348, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028063563629984856, decouple_loss:0.0016663625137880445
The modified gen p mean: 0.45219337940216064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027869494631886482, decouple_loss:0.001573932939209044
The modified gen p mean: 0.4509028494358063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026698604226112366, decouple_loss:0.0016104198293760419
Iteration: 966, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512730538845062, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027734223753213882, decouple_loss:0.001742437481880188
The modified gen p mean: 0.45095691084861755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028483720496296883, decouple_loss:0.0021104805637151003
The modified gen p mean: 0.451808363199234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027204984799027443, decouple_loss:0.0018471392104402184
Iteration: 967, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45372459292411804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027520056813955307, decouple_loss:0.0018286926206201315
The modified gen p mean: 0.45129069685935974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02878418006002903, decouple_loss:0.0016805448103696108
The modified gen p mean: 0.44685614109039307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026793280616402626, decouple_loss:0.0017786143580451608
Iteration: 968, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45124268531799316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026730608195066452, decouple_loss:0.001987278461456299
The modified gen p mean: 0.45151442289352417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028807029128074646, decouple_loss:0.0015687692211940885
The modified gen p mean: 0.4500761330127716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029110709205269814, decouple_loss:0.0017524119466543198
Iteration: 969, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44891563057899475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026993336156010628, decouple_loss:0.0018427993636578321
The modified gen p mean: 0.4451049268245697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027624305337667465, decouple_loss:0.0014965165173634887
The modified gen p mean: 0.44826942682266235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028799500316381454, decouple_loss:0.002051552524790168
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr_shift3.npz
NaN value num: 0
Iteration: 970, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44924455881118774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032902784645557404, decouple_loss:0.0016417917795479298
The modified gen p mean: 0.45121073722839355, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4496951401233673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03406163677573204, decouple_loss:0.0016422143671661615
loss_pred:0.034001730382442474, decouple_loss:0.0015850481577217579
2023-05-26 09:48:12 testing...
The modified gen p mean: 0.450454980134964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032332949340343475, decouple_loss:0.0016451739938929677
The modified gen p mean: 0.4487849771976471, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283381089568138, decouple_loss:0.0015809264732524753
The modified gen p mean: 0.4507206082344055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03393005579710007, decouple_loss:0.0017399229109287262
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03311504051089287, avg_mse: 0.04491182044148445
current test mse: 0.044912
Iteration: 971, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44874173402786255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033880263566970825, decouple_loss:0.0016905696829780936
The modified gen p mean: 0.4474477171897888, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0339244082570076, decouple_loss:0.0015551812248304486
The modified gen p mean: 0.4488857686519623, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03223467990756035, decouple_loss:0.0015686991391703486
Iteration: 972, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45168447494506836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03155309706926346, decouple_loss:0.001501503400504589
The modified gen p mean: 0.4497838318347931, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03437431529164314, decouple_loss:0.0014450354501605034
The modified gen p mean: 0.45194733142852783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030250094830989838, decouple_loss:0.0014597380068153143
Iteration: 973, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499983787536621, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03309677541255951, decouple_loss:0.001437935745343566
The modified gen p mean: 0.4499712288379669, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032528989017009735, decouple_loss:0.0015722004463896155
The modified gen p mean: 0.4515497088432312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03478768840432167, decouple_loss:0.0016775151016190648
Iteration: 974, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514954686164856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259379789233208, decouple_loss:0.0014763991348445415
The modified gen p mean: 0.4509291350841522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0328669473528862, decouple_loss:0.0014886928256601095
The modified gen p mean: 0.44893425703048706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03225266560912132, decouple_loss:0.001506837666966021
Iteration: 975, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4540632367134094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035212982445955276, decouple_loss:0.0015039695426821709
The modified gen p mean: 0.4519123136997223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032700344920158386, decouple_loss:0.0015434966189786792
The modified gen p mean: 0.4495731592178345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032769180834293365, decouple_loss:0.0014777277829125524
Iteration: 976, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45259690284729004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03331673890352249, decouple_loss:0.0014375142054632306
The modified gen p mean: 0.45409080386161804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0345594547688961, decouple_loss:0.0014559796545654535
The modified gen p mean: 0.45019328594207764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03091089241206646, decouple_loss:0.0015107953222468495
Iteration: 977, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4530400335788727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0329749770462513, decouple_loss:0.0014766330132260919
The modified gen p mean: 0.45165789127349854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033556170761585236, decouple_loss:0.0015418232651427388
The modified gen p mean: 0.4519404470920563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032560933381319046, decouple_loss:0.001378543907776475
Iteration: 978, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519740641117096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03472769260406494, decouple_loss:0.001465083216316998
The modified gen p mean: 0.4505215585231781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03227398544549942, decouple_loss:0.0014262138865888119
The modified gen p mean: 0.45521971583366394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03304541856050491, decouple_loss:0.001477990299463272
Iteration: 979, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484058618545532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03182031586766243, decouple_loss:0.0013821054017171264
The modified gen p mean: 0.45006614923477173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0335872620344162, decouple_loss:0.0015822831774130464
The modified gen p mean: 0.45335233211517334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030569281429052353, decouple_loss:0.0015318228397518396
Iteration: 980, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44679394364356995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034085094928741455, decouple_loss:0.0014090259792283177
The modified gen p mean: 0.4482819736003876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03250240907073021, decouple_loss:0.001368209719657898
The modified gen p mean: 0.4470851421356201, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265872225165367, decouple_loss:0.0014506987063214183
2023-05-26 09:52:18 testing...
The modified gen p mean: 0.4495445787906647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031955331563949585, decouple_loss:0.0015608692774549127
The modified gen p mean: 0.4498027563095093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033509548753499985, decouple_loss:0.0016389436786994338
The modified gen p mean: 0.44796493649482727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0323912650346756, decouple_loss:0.001497761346399784
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03269701078534126, avg_mse: 0.044083043932914734
current test mse: 0.044083
Iteration: 981, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44944968819618225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03408393636345863, decouple_loss:0.0014671465614810586
The modified gen p mean: 0.4520973563194275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03472330421209335, decouple_loss:0.0014281112235039473
The modified gen p mean: 0.4441821575164795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03565649688243866, decouple_loss:0.0015147565864026546
Iteration: 982, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44985437393188477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03133852034807205, decouple_loss:0.0014291605912148952
The modified gen p mean: 0.44845566153526306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032184310257434845, decouple_loss:0.0014907856239005923
The modified gen p mean: 0.444474458694458, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03117440454661846, decouple_loss:0.0013087529223412275
Iteration: 983, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470953047275543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034941453486680984, decouple_loss:0.0013768603093922138
The modified gen p mean: 0.4445926547050476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246495872735977, decouple_loss:0.0014755050651729107
The modified gen p mean: 0.44859257340431213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03496423736214638, decouple_loss:0.001516892807558179
Iteration: 984, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44422444701194763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0327276885509491, decouple_loss:0.0013270060298964381
The modified gen p mean: 0.44662660360336304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032262224704027176, decouple_loss:0.0014033820480108261
The modified gen p mean: 0.4464566111564636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032469503581523895, decouple_loss:0.0014580665156245232
Iteration: 985, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466976225376129, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0330820195376873, decouple_loss:0.0013825305504724383
The modified gen p mean: 0.44531193375587463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0325419120490551, decouple_loss:0.0013955726753920317
The modified gen p mean: 0.44390299916267395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03277898207306862, decouple_loss:0.0013848775997757912
Iteration: 986, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450015664100647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032442882657051086, decouple_loss:0.0014945536386221647
The modified gen p mean: 0.446126252412796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032375238835811615, decouple_loss:0.0013906594831496477
The modified gen p mean: 0.4477602541446686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034739501774311066, decouple_loss:0.0013686643214896321
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr.npz
NaN value num: 0
Iteration: 987, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461671710014343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029162317514419556, decouple_loss:0.0013644755817949772
The modified gen p mean: 0.44720351696014404, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4458782970905304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029631085693836212, decouple_loss:0.0017395345494151115
loss_pred:0.027939746156334877, decouple_loss:0.0014035978820174932
Iteration: 988, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493170380592346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027406631037592888, decouple_loss:0.0014443499967455864
The modified gen p mean: 0.44615331292152405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027296796441078186, decouple_loss:0.0013590562157332897
The modified gen p mean: 0.44606852531433105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02912079729139805, decouple_loss:0.0014811661094427109
Iteration: 989, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446790874004364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029993804171681404, decouple_loss:0.0015089173102751374
The modified gen p mean: 0.44672104716300964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029811400920152664, decouple_loss:0.0014671031385660172
The modified gen p mean: 0.4489731788635254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028796372935175896, decouple_loss:0.0015473482199013233
Iteration: 990, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44661030173301697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029812052845954895, decouple_loss:0.0013979865470901132
The modified gen p mean: 0.4510265588760376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027574827894568443, decouple_loss:0.0014634730760008097
The modified gen p mean: 0.4496924579143524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026451798155903816, decouple_loss:0.0015184582443907857
2023-05-26 09:57:13 testing...
The modified gen p mean: 0.45310255885124207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032013360410928726, decouple_loss:0.0015637321630492806
The modified gen p mean: 0.45127367973327637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03236406669020653, decouple_loss:0.0014198134886100888
The modified gen p mean: 0.4532235562801361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03348453342914581, decouple_loss:0.0015906848711892962
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032696887850761414, avg_mse: 0.04405459016561508
current test mse: 0.044055
Iteration: 991, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464320242404938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026795128360390663, decouple_loss:0.0015342484693974257
The modified gen p mean: 0.44447916746139526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027908500283956528, decouple_loss:0.0014889490557834506
The modified gen p mean: 0.44686999917030334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02747119776904583, decouple_loss:0.0013456866145133972
Iteration: 992, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463064968585968, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030020857229828835, decouple_loss:0.0014476730721071362
The modified gen p mean: 0.44582992792129517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0294937863945961, decouple_loss:0.0014652656391263008
The modified gen p mean: 0.44766321778297424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026848023757338524, decouple_loss:0.0015195313608273864
Iteration: 993, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486944377422333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027383044362068176, decouple_loss:0.0014675322454422712
The modified gen p mean: 0.4450446367263794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02845236286520958, decouple_loss:0.0014991696225479245
The modified gen p mean: 0.44818010926246643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02761823497712612, decouple_loss:0.0016287320759147406
Iteration: 994, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481925368309021, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026703575626015663, decouple_loss:0.0015698985662311316
The modified gen p mean: 0.4441576898097992, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02805706113576889, decouple_loss:0.0014929452445358038
The modified gen p mean: 0.4462795853614807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02877170220017433, decouple_loss:0.0017563131405040622
Iteration: 995, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438386559486389, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02807268127799034, decouple_loss:0.0016145214904099703
The modified gen p mean: 0.4456619620323181, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673526480793953, decouple_loss:0.0015337198274210095
The modified gen p mean: 0.44385746121406555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028869085013866425, decouple_loss:0.0015309712616726756
Iteration: 996, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4433433413505554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02838977798819542, decouple_loss:0.0015626013046130538
The modified gen p mean: 0.4441559910774231, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026809589937329292, decouple_loss:0.0016213690396398306
The modified gen p mean: 0.4423829913139343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028927700594067574, decouple_loss:0.0016230157343670726
Iteration: 997, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44566670060157776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02756674401462078, decouple_loss:0.001645546522922814
The modified gen p mean: 0.44514769315719604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026744427159428596, decouple_loss:0.0018248698906973004
The modified gen p mean: 0.4422292113304138, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027861783280968666, decouple_loss:0.0013965240214020014
Iteration: 998, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455348551273346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0267415102571249, decouple_loss:0.0017004244728013873
The modified gen p mean: 0.44199976325035095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028809987008571625, decouple_loss:0.0015051187947392464
The modified gen p mean: 0.44352659583091736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02720721811056137, decouple_loss:0.0016049002297222614
Iteration: 999, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434284269809723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028169099241495132, decouple_loss:0.0016656783409416676
The modified gen p mean: 0.44620606303215027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02746613696217537, decouple_loss:0.0015578570310026407
The modified gen p mean: 0.4448225796222687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026915790513157845, decouple_loss:0.0017128456383943558
Iteration: 1000, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44600942730903625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02687392570078373, decouple_loss:0.0016060471534729004
The modified gen p mean: 0.44795194268226624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026750462129712105, decouple_loss:0.001577282208018005
The modified gen p mean: 0.4440310001373291, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028317570686340332, decouple_loss:0.0014537391252815723
2023-05-26 10:01:23 testing...
The modified gen p mean: 0.4531129002571106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246719762682915, decouple_loss:0.0016726363683119416
The modified gen p mean: 0.450991690158844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0328693650662899, decouple_loss:0.0015119813615456223
The modified gen p mean: 0.4531072974205017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03385042026638985, decouple_loss:0.001713252393528819
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03314395993947983, avg_mse: 0.04503866285085678
current test mse: 0.045039
Iteration: 1001, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469713568687439, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027626030147075653, decouple_loss:0.0015661123907193542
The modified gen p mean: 0.44578441977500916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026901021599769592, decouple_loss:0.001466625602915883
The modified gen p mean: 0.44774457812309265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028853723779320717, decouple_loss:0.0015522503526881337
Iteration: 1002, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45015403628349304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026580817997455597, decouple_loss:0.0016717729158699512
The modified gen p mean: 0.45115962624549866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02677150070667267, decouple_loss:0.001585876103490591
The modified gen p mean: 0.44665443897247314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027782423421740532, decouple_loss:0.0014416442718356848
Iteration: 1003, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44970327615737915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026891443878412247, decouple_loss:0.0014658989384770393
The modified gen p mean: 0.45182254910469055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028837626799941063, decouple_loss:0.0015343681443482637
The modified gen p mean: 0.45077964663505554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028385894373059273, decouple_loss:0.0014998168917372823
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr.npz
NaN value num: 0
Iteration: 1004, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45273202657699585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03131129592657089, decouple_loss:0.0016594550106674433
The modified gen p mean: 0.4516158699989319, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.453183114528656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032673489302396774, decouple_loss:0.0015239958884194493
loss_pred:0.034160543233156204, decouple_loss:0.001555773545987904
Iteration: 1005, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45084232091903687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03149670362472534, decouple_loss:0.001603103126399219
The modified gen p mean: 0.4520931541919708, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031839631497859955, decouple_loss:0.0016560887452214956
The modified gen p mean: 0.4535297155380249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031092066317796707, decouple_loss:0.0014833933673799038
Iteration: 1006, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4556589126586914, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45381319522857666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032691843807697296, decouple_loss:0.0015928825596347451
loss_pred:0.03355509042739868, decouple_loss:0.0016097319312393665
The modified gen p mean: 0.4565041661262512, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030630525201559067, decouple_loss:0.0014732000418007374
Iteration: 1007, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4511455297470093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031278952956199646, decouple_loss:0.0016286663012579083
The modified gen p mean: 0.45613908767700195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030614877119660378, decouple_loss:0.0015903637977316976
The modified gen p mean: 0.4507397711277008, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03402617573738098, decouple_loss:0.001523975864984095
Iteration: 1008, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45343369245529175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03414682671427727, decouple_loss:0.0014692903496325016
The modified gen p mean: 0.45683059096336365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03331928327679634, decouple_loss:0.0015985688660293818
The modified gen p mean: 0.45127081871032715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031518321484327316, decouple_loss:0.001527448883280158
Iteration: 1009, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45302510261535645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032217126339673996, decouple_loss:0.0015181625494733453
The modified gen p mean: 0.45630037784576416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03247669339179993, decouple_loss:0.0014327603857964277
The modified gen p mean: 0.45353808999061584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03281832113862038, decouple_loss:0.0015010169008746743
Iteration: 1010, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45842045545578003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03451786935329437, decouple_loss:0.0016337353736162186
The modified gen p mean: 0.4514027535915375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032874614000320435, decouple_loss:0.0013988204300403595
The modified gen p mean: 0.4575013816356659, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03204479068517685, decouple_loss:0.0014390660217031837
2023-05-26 10:06:21 testing...
The modified gen p mean: 0.4574103057384491, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032068949192762375, decouple_loss:0.0015713287284597754
The modified gen p mean: 0.4554106593132019, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45730602741241455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03240006044507027, decouple_loss:0.001479065278545022
loss_pred:0.03348873183131218, decouple_loss:0.0016229345928877592
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03273047134280205, avg_mse: 0.044117916375398636
current test mse: 0.044118
Iteration: 1011, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504850208759308, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03158002719283104, decouple_loss:0.0014353841543197632
The modified gen p mean: 0.4519970715045929, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03341376781463623, decouple_loss:0.0015574308345094323
The modified gen p mean: 0.45004165172576904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033475928008556366, decouple_loss:0.001480416627600789
Iteration: 1012, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44925960898399353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032806396484375, decouple_loss:0.0014333283761516213
The modified gen p mean: 0.4492807388305664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03271295130252838, decouple_loss:0.0015156421577557921
The modified gen p mean: 0.45048362016677856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03346340358257294, decouple_loss:0.0015189346158877015
Iteration: 1013, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496663808822632, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032120734453201294, decouple_loss:0.001495784497819841
The modified gen p mean: 0.45085689425468445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03200282156467438, decouple_loss:0.001617332687601447
The modified gen p mean: 0.4483397603034973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03403366357088089, decouple_loss:0.0015100828604772687
Iteration: 1014, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44491341710090637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03277648612856865, decouple_loss:0.0013774860417470336
The modified gen p mean: 0.44673237204551697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03185012936592102, decouple_loss:0.001571064000017941
The modified gen p mean: 0.44747623801231384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031106311827898026, decouple_loss:0.001489221234805882
Iteration: 1015, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44476601481437683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03272343426942825, decouple_loss:0.0013499578926712275
The modified gen p mean: 0.4452746510505676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03436211124062538, decouple_loss:0.0015197558095678687
The modified gen p mean: 0.44635704159736633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03225288167595863, decouple_loss:0.0015087926294654608
Iteration: 1016, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44472476840019226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03257324919104576, decouple_loss:0.001482964027673006
The modified gen p mean: 0.4525168240070343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03194563090801239, decouple_loss:0.0016234287759289145
The modified gen p mean: 0.45132866501808167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03113745152950287, decouple_loss:0.0016481442144140601
Iteration: 1017, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44952183961868286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031231243163347244, decouple_loss:0.001424726564437151
The modified gen p mean: 0.4450545608997345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034373100847005844, decouple_loss:0.0013539147330448031
The modified gen p mean: 0.4467853307723999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254851698875427, decouple_loss:0.0013155292253941298
Iteration: 1018, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483243525028229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03232012316584587, decouple_loss:0.0015549518866464496
The modified gen p mean: 0.4481748640537262, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0320139117538929, decouple_loss:0.0013819726882502437
The modified gen p mean: 0.4472799301147461, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032497815787792206, decouple_loss:0.0014589937636628747
Iteration: 1019, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503040611743927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030380796641111374, decouple_loss:0.0014889482408761978
The modified gen p mean: 0.4498037099838257, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03293396905064583, decouple_loss:0.0016171744791790843
The modified gen p mean: 0.4475468099117279, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03284000977873802, decouple_loss:0.0016278965631499887
Iteration: 1020, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461667239665985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03173092007637024, decouple_loss:0.001433519646525383
The modified gen p mean: 0.4453265070915222, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032811541110277176, decouple_loss:0.001551056164316833
The modified gen p mean: 0.4504809081554413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03307386860251427, decouple_loss:0.0014451351016759872
2023-05-26 10:10:26 testing...
The modified gen p mean: 0.45178887248039246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03187565505504608, decouple_loss:0.0016176147619262338
The modified gen p mean: 0.4514450132846832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033428583294153214, decouple_loss:0.0016140015795826912
The modified gen p mean: 0.4499364197254181, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032436810433864594, decouple_loss:0.0014661249006167054
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0326586477458477, avg_mse: 0.044005364179611206
current test mse: 0.044005
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1021, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451809525489807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032660774886608124, decouple_loss:0.0014322788920253515
The modified gen p mean: 0.44548845291137695, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44692492485046387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034159593284130096, decouple_loss:0.0015276059275493026
loss_pred:0.03342662379145622, decouple_loss:0.0016685796435922384
Iteration: 1022, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453875422477722, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246349096298218, decouple_loss:0.0014534759102389216
The modified gen p mean: 0.44800636172294617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032891951501369476, decouple_loss:0.0014238381991162896
The modified gen p mean: 0.44916948676109314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03302184119820595, decouple_loss:0.0014895184431225061
Iteration: 1023, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493875205516815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03367779776453972, decouple_loss:0.001473178155720234
The modified gen p mean: 0.4514463245868683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03134947270154953, decouple_loss:0.001532594789750874
The modified gen p mean: 0.447018563747406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03315141052007675, decouple_loss:0.001317523536272347
Iteration: 1024, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449629545211792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03237240016460419, decouple_loss:0.0015171249397099018
The modified gen p mean: 0.4460878074169159, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03324316069483757, decouple_loss:0.0015276593621820211
The modified gen p mean: 0.4470508396625519, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03290104120969772, decouple_loss:0.0013837863225489855
Iteration: 1025, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462791979312897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03349127992987633, decouple_loss:0.0014704446075484157
The modified gen p mean: 0.44959133863449097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03470800817012787, decouple_loss:0.0015707863494753838
The modified gen p mean: 0.4455820918083191, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03310105949640274, decouple_loss:0.0013785192277282476
Iteration: 1026, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476497173309326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03282366320490837, decouple_loss:0.0015381815610453486
The modified gen p mean: 0.4450470805168152, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03205414116382599, decouple_loss:0.0013502693036571145
The modified gen p mean: 0.44470295310020447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03363015130162239, decouple_loss:0.001507443725131452
Iteration: 1027, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455673396587372, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03466733917593956, decouple_loss:0.001466279849410057
The modified gen p mean: 0.4510258138179779, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03381475806236267, decouple_loss:0.001503046485595405
The modified gen p mean: 0.45073655247688293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031777579337358475, decouple_loss:0.0013744845055043697
Iteration: 1028, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45051321387290955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03319112956523895, decouple_loss:0.001490756869316101
The modified gen p mean: 0.45059341192245483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03295421972870827, decouple_loss:0.0015655586030334234
The modified gen p mean: 0.44338148832321167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033856168389320374, decouple_loss:0.001466913498006761
Iteration: 1029, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44656726717948914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03346935287117958, decouple_loss:0.0014682764885947108
The modified gen p mean: 0.445115864276886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03372775763273239, decouple_loss:0.0013367676874622703
The modified gen p mean: 0.44879812002182007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033350441604852676, decouple_loss:0.0014448639703914523
Iteration: 1030, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467543363571167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03288889676332474, decouple_loss:0.0013698125258088112
The modified gen p mean: 0.4447934925556183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03325958549976349, decouple_loss:0.0012514055706560612
The modified gen p mean: 0.44849807024002075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031218640506267548, decouple_loss:0.0015005097957327962
2023-05-26 10:15:16 testing...
The modified gen p mean: 0.45086827874183655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03195534646511078, decouple_loss:0.0015317867510020733
The modified gen p mean: 0.449090838432312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032263562083244324, decouple_loss:0.0014095044462010264
The modified gen p mean: 0.4508543014526367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033358439803123474, decouple_loss:0.0015247687697410583
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032600220292806625, avg_mse: 0.04391993582248688
current test mse: 0.04392
Iteration: 1031, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44694459438323975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033566370606422424, decouple_loss:0.0014928521122783422
The modified gen p mean: 0.44905245304107666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03161640092730522, decouple_loss:0.001360527821816504
The modified gen p mean: 0.4492854177951813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0328659787774086, decouple_loss:0.0014062830014154315
Iteration: 1032, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463229477405548, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03137524053454399, decouple_loss:0.00144727632869035
The modified gen p mean: 0.4505976438522339, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03291148692369461, decouple_loss:0.0016207176959142089
The modified gen p mean: 0.4512166678905487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03222639486193657, decouple_loss:0.0014423310058191419
Iteration: 1033, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45024824142456055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033204078674316406, decouple_loss:0.001407294301316142
The modified gen p mean: 0.45018574595451355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03337275609374046, decouple_loss:0.0014083395944908261
The modified gen p mean: 0.4502985179424286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0332871712744236, decouple_loss:0.0013323468156158924
Iteration: 1034, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467960596084595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033938564360141754, decouple_loss:0.0015114274574443698
The modified gen p mean: 0.44656163454055786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033896107226610184, decouple_loss:0.0014815465547144413
The modified gen p mean: 0.44979241490364075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033547449856996536, decouple_loss:0.001399580156430602
Iteration: 1035, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476829171180725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03226172924041748, decouple_loss:0.0014267497463151813
The modified gen p mean: 0.4490604102611542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03301502391695976, decouple_loss:0.001386274234391749
The modified gen p mean: 0.4482645094394684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03278419002890587, decouple_loss:0.0014488466549664736
Iteration: 1036, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4550458490848541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033555708825588226, decouple_loss:0.001356530119664967
The modified gen p mean: 0.4532909393310547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032014455646276474, decouple_loss:0.001578542753122747
The modified gen p mean: 0.45012035965919495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03305094316601753, decouple_loss:0.001383839757181704
Iteration: 1037, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45409154891967773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03383887931704521, decouple_loss:0.0014572712825611234
The modified gen p mean: 0.4511324465274811, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03320283815264702, decouple_loss:0.0013543248642235994
The modified gen p mean: 0.4523577392101288, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03343610838055611, decouple_loss:0.0015237450134009123
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1038, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45549166202545166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029004378244280815, decouple_loss:0.0013981432421132922
The modified gen p mean: 0.4488358199596405, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45213189721107483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028618240728974342, decouple_loss:0.0015145987272262573
loss_pred:0.028955897316336632, decouple_loss:0.0013908834662288427
Iteration: 1039, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4511008560657501, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02911529690027237, decouple_loss:0.0014770550187677145
The modified gen p mean: 0.4526921808719635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028862064704298973, decouple_loss:0.001374086714349687
The modified gen p mean: 0.4475953280925751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029674772173166275, decouple_loss:0.0011678743176162243
Iteration: 1040, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446460485458374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030706699937582016, decouple_loss:0.0013552792370319366
The modified gen p mean: 0.4487494230270386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030445678159594536, decouple_loss:0.0015165174845606089
The modified gen p mean: 0.4480389654636383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029997721314430237, decouple_loss:0.0015932278474792838
2023-05-26 10:20:02 testing...
The modified gen p mean: 0.44911205768585205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031802933663129807, decouple_loss:0.0015784797724336386
The modified gen p mean: 0.447613000869751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03221110254526138, decouple_loss:0.001467144931666553
The modified gen p mean: 0.44925254583358765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03331473097205162, decouple_loss:0.0016575435874983668
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03252130746841431, avg_mse: 0.04371858760714531
current test mse: 0.043719
At step 1040, Best test: 0.043719
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_WV_1_PC_0_EH_0_PS_40_6hrs.ckpt
Iteration: 1041, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481939971446991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0296171847730875, decouple_loss:0.0014690884854644537
The modified gen p mean: 0.44454225897789, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029992232099175453, decouple_loss:0.001766974339261651
The modified gen p mean: 0.4427962005138397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03002999909222126, decouple_loss:0.0014833661261945963
Iteration: 1042, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4409460425376892, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028988152742385864, decouple_loss:0.0013704404700547457
The modified gen p mean: 0.44068777561187744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030727723613381386, decouple_loss:0.0015300563536584377
The modified gen p mean: 0.43994003534317017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029015514999628067, decouple_loss:0.001317550428211689
Iteration: 1043, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44276148080825806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029229482635855675, decouple_loss:0.0016164082335308194
The modified gen p mean: 0.44215360283851624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027695432305336, decouple_loss:0.0013832885306328535
The modified gen p mean: 0.44050827622413635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030070312321186066, decouple_loss:0.0013188101584091783
Iteration: 1044, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44391804933547974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027834409847855568, decouple_loss:0.0016120178624987602
The modified gen p mean: 0.43980053067207336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029624249786138535, decouple_loss:0.0013425450306385756
The modified gen p mean: 0.43977436423301697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028325185179710388, decouple_loss:0.0014682571636512876
Iteration: 1045, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434291422367096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02854142151772976, decouple_loss:0.001656775246374309
The modified gen p mean: 0.4438317120075226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03033558838069439, decouple_loss:0.0014690235257148743
The modified gen p mean: 0.4401914179325104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02965804748237133, decouple_loss:0.0016103689558804035
Iteration: 1046, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44114232063293457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0285095926374197, decouple_loss:0.0015527288196608424
The modified gen p mean: 0.44645145535469055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02926766313612461, decouple_loss:0.001514889532700181
The modified gen p mean: 0.44537436962127686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027932019904255867, decouple_loss:0.001770383445546031
Iteration: 1047, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446598082780838, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02947293035686016, decouple_loss:0.001367454882711172
The modified gen p mean: 0.44587039947509766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02888340689241886, decouple_loss:0.0014348034746944904
The modified gen p mean: 0.4414741098880768, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02937954291701317, decouple_loss:0.0015191370621323586
Iteration: 1048, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463701546192169, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029120471328496933, decouple_loss:0.0017762734787538648
The modified gen p mean: 0.44663044810295105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027417076751589775, decouple_loss:0.0015571591211482882
The modified gen p mean: 0.4486543834209442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02736624702811241, decouple_loss:0.0016257831593975425
Iteration: 1049, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4448239803314209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029328476637601852, decouple_loss:0.0015278011560440063
The modified gen p mean: 0.44701850414276123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027192115783691406, decouple_loss:0.001515850774012506
The modified gen p mean: 0.45162156224250793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02752598747611046, decouple_loss:0.0016873404383659363
Iteration: 1050, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44663453102111816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028524603694677353, decouple_loss:0.00148949702270329
The modified gen p mean: 0.44862115383148193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02912759594619274, decouple_loss:0.001576303387992084
The modified gen p mean: 0.44699615240097046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029878662899136543, decouple_loss:0.0015434327069669962
2023-05-26 10:24:14 testing...
The modified gen p mean: 0.45369622111320496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03234965354204178, decouple_loss:0.0017120428383350372
The modified gen p mean: 0.4518245458602905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032843079417943954, decouple_loss:0.0016388418152928352
The modified gen p mean: 0.4535169005393982, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03398909047245979, decouple_loss:0.0018087868811562657
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03314660117030144, avg_mse: 0.04469623789191246
current test mse: 0.044696
Iteration: 1051, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474106431007385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028274856507778168, decouple_loss:0.0014582141302525997
The modified gen p mean: 0.4484606385231018, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029406428337097168, decouple_loss:0.001687018433585763
The modified gen p mean: 0.4509173631668091, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02811460755765438, decouple_loss:0.0015524697955697775
Iteration: 1052, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4547036290168762, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027378017082810402, decouple_loss:0.0017319046892225742
The modified gen p mean: 0.45452776551246643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0267051812261343, decouple_loss:0.0016497120959684253
The modified gen p mean: 0.45426976680755615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02859804779291153, decouple_loss:0.0017689852975308895
Iteration: 1053, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44846275448799133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028561947867274284, decouple_loss:0.0016215125797316432
The modified gen p mean: 0.4508756101131439, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02941162884235382, decouple_loss:0.0018157616723328829
The modified gen p mean: 0.4487568736076355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029641849920153618, decouple_loss:0.0016271381173282862
Iteration: 1054, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45041966438293457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029154587537050247, decouple_loss:0.001720702857710421
The modified gen p mean: 0.4488042891025543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028488777577877045, decouple_loss:0.0018107056384906173
The modified gen p mean: 0.4466240704059601, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02856292389333248, decouple_loss:0.00151309953071177
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr.npz
NaN value num: 0
Iteration: 1055, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44900014996528625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026920413598418236, decouple_loss:0.001707392162643373
The modified gen p mean: 0.4469308853149414, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44633054733276367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030362339690327644, decouple_loss:0.0017214326653629541
loss_pred:0.0291300006210804, decouple_loss:0.0016186366556212306
Iteration: 1056, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434696137905121, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771076001226902, decouple_loss:0.0016981844091787934
The modified gen p mean: 0.4451225996017456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02785612642765045, decouple_loss:0.0017729329410940409
The modified gen p mean: 0.4429754316806793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029006918892264366, decouple_loss:0.0014415683690458536
Iteration: 1057, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44252854585647583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029827304184436798, decouple_loss:0.0015961132012307644
The modified gen p mean: 0.4448934495449066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02767788991332054, decouple_loss:0.001551329274661839
The modified gen p mean: 0.4465758800506592, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0278819277882576, decouple_loss:0.0016757884295657277
Iteration: 1058, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44201570749282837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027186576277017593, decouple_loss:0.0017878252547234297
The modified gen p mean: 0.44294458627700806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029226379469037056, decouple_loss:0.0017302304040640593
The modified gen p mean: 0.44483423233032227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027393247932195663, decouple_loss:0.0017256601713597775
Iteration: 1059, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4435691833496094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029561787843704224, decouple_loss:0.0016861617332324386
The modified gen p mean: 0.4426397681236267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02910243719816208, decouple_loss:0.0016695198137313128
The modified gen p mean: 0.44443050026893616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027808567509055138, decouple_loss:0.0016369910445064306
Iteration: 1060, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465508759021759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027701394632458687, decouple_loss:0.0020824254024773836
The modified gen p mean: 0.4462856650352478, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028182830661535263, decouple_loss:0.001686400850303471
The modified gen p mean: 0.4459390938282013, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027235526591539383, decouple_loss:0.0021197758615016937
2023-05-26 10:28:57 testing...
The modified gen p mean: 0.4497714638710022, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03266553580760956, decouple_loss:0.0017607619520276785
The modified gen p mean: 0.4477542042732239, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4495498538017273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033003874123096466, decouple_loss:0.0016724783927202225
loss_pred:0.03418939933180809, decouple_loss:0.0018741987878456712
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03337472677230835, avg_mse: 0.045220907777547836
current test mse: 0.045221
Iteration: 1061, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4430663585662842, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02965015359222889, decouple_loss:0.0015640889760106802
The modified gen p mean: 0.4466254711151123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026997365057468414, decouple_loss:0.0018364436691626906
The modified gen p mean: 0.44147032499313354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029518866911530495, decouple_loss:0.001691135112196207
Iteration: 1062, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44692471623420715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027357669547200203, decouple_loss:0.001608372782357037
The modified gen p mean: 0.44767317175865173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027696602046489716, decouple_loss:0.0016291070496663451
The modified gen p mean: 0.4488341510295868, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02747167833149433, decouple_loss:0.0015643382212147117
Iteration: 1063, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443402588367462, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029700763523578644, decouple_loss:0.0014824739191681147
The modified gen p mean: 0.4488143026828766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02658069133758545, decouple_loss:0.0018090502126142383
The modified gen p mean: 0.44753703474998474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02654356323182583, decouple_loss:0.0015997977461665869
Iteration: 1064, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45129144191741943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783995121717453, decouple_loss:0.0017346665263175964
The modified gen p mean: 0.4478878378868103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028469765558838844, decouple_loss:0.0016063660150393844
The modified gen p mean: 0.4475070834159851, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028819173574447632, decouple_loss:0.0015366673469543457
Iteration: 1065, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45005568861961365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02986406721174717, decouple_loss:0.0015377132222056389
The modified gen p mean: 0.44709527492523193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027060383930802345, decouple_loss:0.0017160961870104074
The modified gen p mean: 0.44827720522880554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02872542105615139, decouple_loss:0.001687629846855998
Iteration: 1066, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448292076587677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026901541277766228, decouple_loss:0.0017896363278850913
The modified gen p mean: 0.4495692849159241, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02769334614276886, decouple_loss:0.0016780839068815112
The modified gen p mean: 0.44691231846809387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028570914641022682, decouple_loss:0.001595976180396974
Iteration: 1067, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441319704055786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029368584975600243, decouple_loss:0.0016534861642867327
The modified gen p mean: 0.44734591245651245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026696741580963135, decouple_loss:0.0017125298036262393
The modified gen p mean: 0.4460766911506653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028260108083486557, decouple_loss:0.0016561542870476842
Iteration: 1068, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.443882554769516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02975335903465748, decouple_loss:0.0016223764978349209
The modified gen p mean: 0.44588276743888855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028267385438084602, decouple_loss:0.0017004472902044654
The modified gen p mean: 0.4460901916027069, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02894911915063858, decouple_loss:0.0016085258685052395
Iteration: 1069, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44351744651794434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02932344377040863, decouple_loss:0.0015727387508377433
The modified gen p mean: 0.44660672545433044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027556078508496284, decouple_loss:0.0015783547423779964
The modified gen p mean: 0.44325485825538635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026299497112631798, decouple_loss:0.0017303129425272346
Iteration: 1070, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464147686958313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0272907093167305, decouple_loss:0.001699861022643745
The modified gen p mean: 0.4425126016139984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02862747386097908, decouple_loss:0.0016955331666395068
The modified gen p mean: 0.4429250657558441, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02880098484456539, decouple_loss:0.0015320011880248785
2023-05-26 10:33:03 testing...
The modified gen p mean: 0.44804003834724426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03262414038181305, decouple_loss:0.0017612859373912215
The modified gen p mean: 0.448017418384552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03407282009720802, decouple_loss:0.0016908857505768538
The modified gen p mean: 0.4461565613746643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032892074435949326, decouple_loss:0.0015486805932596326
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033279694616794586, avg_mse: 0.04515538364648819
current test mse: 0.045155
Iteration: 1071, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44255807995796204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028761671856045723, decouple_loss:0.0015549266245216131
The modified gen p mean: 0.4433545768260956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027123969048261642, decouple_loss:0.0015684511745348573
The modified gen p mean: 0.443562775850296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026794491335749626, decouple_loss:0.001606613746844232
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr.npz
NaN value num: 0
Iteration: 1072, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44093558192253113, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4449005126953125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0274520143866539, decouple_loss:0.0015849987976253033
The modified gen p mean: 0.44032031297683716, gen p mean: 0.0, mean p set: 0.448loss_pred:0.0267595574259758, decouple_loss:0.0017862452659755945
loss_pred:0.02792334370315075, decouple_loss:0.00135582045186311
Iteration: 1073, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44712910056114197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02669304795563221, decouple_loss:0.0017980232369154692
The modified gen p mean: 0.44206640124320984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029007593169808388, decouple_loss:0.0015125212958082557
The modified gen p mean: 0.44209757447242737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028499839827418327, decouple_loss:0.0014045975403860211
Iteration: 1074, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44338753819465637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02870352379977703, decouple_loss:0.0014679586747661233
The modified gen p mean: 0.4470735788345337, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02768811397254467, decouple_loss:0.0016807703068479896
The modified gen p mean: 0.44412267208099365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02678557112812996, decouple_loss:0.0015791193582117558
Iteration: 1075, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44411590695381165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02835126221179962, decouple_loss:0.0015481822192668915
The modified gen p mean: 0.4494413435459137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02716634050011635, decouple_loss:0.00170487305149436
The modified gen p mean: 0.44676992297172546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029283905401825905, decouple_loss:0.0015920930309221148
Iteration: 1076, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461844861507416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0289863683283329, decouple_loss:0.0016114757163450122
The modified gen p mean: 0.4481729567050934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02718954160809517, decouple_loss:0.0016756803961470723
The modified gen p mean: 0.4523391127586365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027086731046438217, decouple_loss:0.0017138090915977955
Iteration: 1077, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455813467502594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02755017764866352, decouple_loss:0.0015286675188690424
The modified gen p mean: 0.4498145878314972, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026508716866374016, decouple_loss:0.001698035979643464
The modified gen p mean: 0.44890764355659485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027797352522611618, decouple_loss:0.0017668352229520679
Iteration: 1078, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44549185037612915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02751132659614086, decouple_loss:0.0014524993021041155
The modified gen p mean: 0.4484727084636688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026929635554552078, decouple_loss:0.0016795762348920107
The modified gen p mean: 0.4503123164176941, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026857320219278336, decouple_loss:0.0015923968749120831
Iteration: 1079, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44707950949668884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027827292680740356, decouple_loss:0.001549870241433382
The modified gen p mean: 0.44957616925239563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027126789093017578, decouple_loss:0.0016038167523220181
The modified gen p mean: 0.4495348632335663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027500631287693977, decouple_loss:0.0016309884376823902
Iteration: 1080, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44661349058151245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02775939367711544, decouple_loss:0.0014334755251184106
The modified gen p mean: 0.4512055516242981, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027058158069849014, decouple_loss:0.0017061872640624642
The modified gen p mean: 0.4467600882053375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027432939037680626, decouple_loss:0.0015017037512734532
2023-05-26 10:37:56 testing...
The modified gen p mean: 0.4526751935482025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03249358385801315, decouple_loss:0.0017654434777796268
The modified gen p mean: 0.450848788022995, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4527798593044281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032909635454416275, decouple_loss:0.0015885467873886228
loss_pred:0.034117721021175385, decouple_loss:0.0017440015217289329
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03325861319899559, avg_mse: 0.045177314430475235
current test mse: 0.045177
Iteration: 1081, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484154284000397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026563148945569992, decouple_loss:0.0016798734432086349
The modified gen p mean: 0.4452705383300781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028043780475854874, decouple_loss:0.0015562799526378512
The modified gen p mean: 0.44739365577697754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026959586888551712, decouple_loss:0.0019626866560429335
Iteration: 1082, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4448516070842743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02747923508286476, decouple_loss:0.0016415197169408202
The modified gen p mean: 0.4480806589126587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02641567401587963, decouple_loss:0.0017542321002110839
The modified gen p mean: 0.4479055106639862, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02909012883901596, decouple_loss:0.0015150194521993399
Iteration: 1083, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471031725406647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027709024026989937, decouple_loss:0.0018581219483166933
The modified gen p mean: 0.44772255420684814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026611141860485077, decouple_loss:0.00160513655282557
The modified gen p mean: 0.44641435146331787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028086204081773758, decouple_loss:0.0015762781258672476
Iteration: 1084, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461403489112854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027258630841970444, decouple_loss:0.0016049975529313087
The modified gen p mean: 0.4458926320075989, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02778661623597145, decouple_loss:0.0018201903440058231
The modified gen p mean: 0.4439273774623871, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027577634900808334, decouple_loss:0.0014138753758743405
Iteration: 1085, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469773769378662, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027324695140123367, decouple_loss:0.0015790945617482066
The modified gen p mean: 0.44372519850730896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027654636651277542, decouple_loss:0.0015397577080875635
The modified gen p mean: 0.450930655002594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026468023657798767, decouple_loss:0.001912990934215486
Iteration: 1086, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44485047459602356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02776745893061161, decouple_loss:0.0015065348707139492
The modified gen p mean: 0.4452614188194275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02720239758491516, decouple_loss:0.0014736263547092676
The modified gen p mean: 0.44540730118751526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02823501266539097, decouple_loss:0.001614379114471376
Iteration: 1087, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44879207015037537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02644176408648491, decouple_loss:0.0018401456763967872
The modified gen p mean: 0.4479637145996094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026491807773709297, decouple_loss:0.001621018978767097
The modified gen p mean: 0.4461081624031067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028678933158516884, decouple_loss:0.001458974089473486
Iteration: 1088, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445125013589859, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027925459668040276, decouple_loss:0.0018147327937185764
The modified gen p mean: 0.4495861828327179, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026655470952391624, decouple_loss:0.0016737023834139109
The modified gen p mean: 0.44599196314811707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027298515662550926, decouple_loss:0.0014939939137548208
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr.npz
NaN value num: 0
Iteration: 1089, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451223909854889, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028868746012449265, decouple_loss:0.0016117735067382455
The modified gen p mean: 0.4457162022590637, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4477015733718872, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027644304558634758, decouple_loss:0.0021094612311571836
loss_pred:0.02892696112394333, decouple_loss:0.0018798141973093152
Iteration: 1090, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44610318541526794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02744336426258087, decouple_loss:0.0016079804627224803
The modified gen p mean: 0.4501059651374817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027756232768297195, decouple_loss:0.0014942025300115347
The modified gen p mean: 0.44508612155914307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02816072478890419, decouple_loss:0.0016513043083250523
2023-05-26 10:42:42 testing...
The modified gen p mean: 0.4509011507034302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03241169825196266, decouple_loss:0.0017246499191969633
The modified gen p mean: 0.4490281641483307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032902032136917114, decouple_loss:0.0015749873127788305
The modified gen p mean: 0.4509143531322479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0340544767677784, decouple_loss:0.001788774854503572
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033207543194293976, avg_mse: 0.04509486258029938
current test mse: 0.045095
Iteration: 1091, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44819512963294983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027602845802903175, decouple_loss:0.0016576898051425815
The modified gen p mean: 0.4449847638607025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028302472084760666, decouple_loss:0.0014708678936585784
The modified gen p mean: 0.44623714685440063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025592492893338203, decouple_loss:0.001797907636500895
Iteration: 1092, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488198757171631, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028097456321120262, decouple_loss:0.0016063943039625883
The modified gen p mean: 0.4516179859638214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026666734367609024, decouple_loss:0.001648988458327949
The modified gen p mean: 0.4451514780521393, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028433244675397873, decouple_loss:0.0016460829647257924
Iteration: 1093, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505181610584259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028549740090966225, decouple_loss:0.0016520369099453092
The modified gen p mean: 0.4482945203781128, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027946079149842262, decouple_loss:0.0017500044777989388
The modified gen p mean: 0.4466342329978943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028766760602593422, decouple_loss:0.001993417739868164
Iteration: 1094, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465812146663666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02559998258948326, decouple_loss:0.001590439467690885
The modified gen p mean: 0.44634297490119934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02823127806186676, decouple_loss:0.0016167769208550453
The modified gen p mean: 0.44677335023880005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028780078515410423, decouple_loss:0.001555769587866962
Iteration: 1095, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44777679443359375, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45040181279182434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028086336329579353, decouple_loss:0.0018471815856173635
loss_pred:0.027151796966791153, decouple_loss:0.00151128601282835
The modified gen p mean: 0.44836705923080444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027307184413075447, decouple_loss:0.0015138412127271295
Iteration: 1096, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468574523925781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028523476794362068, decouple_loss:0.0016573859611526132
The modified gen p mean: 0.4463687241077423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028236061334609985, decouple_loss:0.0016202270053327084
The modified gen p mean: 0.4467587471008301, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02808445692062378, decouple_loss:0.001657242770306766
Iteration: 1097, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492970407009125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028439531102776527, decouple_loss:0.0014662492321804166
The modified gen p mean: 0.447347491979599, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028174174949526787, decouple_loss:0.0016141587402671576
The modified gen p mean: 0.4477069079875946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027315791696310043, decouple_loss:0.0016600271919742227
Iteration: 1098, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446758508682251, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028057947754859924, decouple_loss:0.001999826868996024
The modified gen p mean: 0.4499988257884979, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028306514024734497, decouple_loss:0.0017723286291584373
The modified gen p mean: 0.4495849907398224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02793840318918228, decouple_loss:0.0019077626056969166
Iteration: 1099, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495333731174469, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027243517339229584, decouple_loss:0.001551858615130186
The modified gen p mean: 0.45248880982398987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025755781680345535, decouple_loss:0.0014965194277465343
The modified gen p mean: 0.4486433267593384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027475552633404732, decouple_loss:0.0016074019949883223
Iteration: 1100, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515373408794403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02768194116652012, decouple_loss:0.001721030450426042
The modified gen p mean: 0.44665563106536865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028319695964455605, decouple_loss:0.0015283264219760895
The modified gen p mean: 0.4497915804386139, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027702370658516884, decouple_loss:0.0020429491996765137
2023-05-26 10:46:46 testing...
The modified gen p mean: 0.4529973566532135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03238004446029663, decouple_loss:0.0016534553142264485
The modified gen p mean: 0.45312440395355225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03394041582942009, decouple_loss:0.0018130008829757571
The modified gen p mean: 0.4511975347995758, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032852429896593094, decouple_loss:0.0015674200840294361
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03314153105020523, avg_mse: 0.0449884869158268
current test mse: 0.044988
Iteration: 1101, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483034312725067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027218574658036232, decouple_loss:0.0019339780556038022
The modified gen p mean: 0.4489207863807678, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028774486854672432, decouple_loss:0.0014311163686215878
The modified gen p mean: 0.4504656195640564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02730073407292366, decouple_loss:0.0016563759418204427
Iteration: 1102, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464811086654663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02763858251273632, decouple_loss:0.0018100365996360779
The modified gen p mean: 0.44855213165283203, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0263485349714756, decouple_loss:0.0019383509643375874
The modified gen p mean: 0.44705894589424133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028098322451114655, decouple_loss:0.0017407126724720001
Iteration: 1103, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507479965686798, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02767222374677658, decouple_loss:0.0017099446849897504
The modified gen p mean: 0.4475806653499603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02570655383169651, decouple_loss:0.0015678860945627093
The modified gen p mean: 0.4532136619091034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026583539322018623, decouple_loss:0.0017334604635834694
Iteration: 1104, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45159146189689636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027423787862062454, decouple_loss:0.0016823132755234838
The modified gen p mean: 0.45033878087997437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026355057954788208, decouple_loss:0.0016961009241640568
The modified gen p mean: 0.4504239559173584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02809075266122818, decouple_loss:0.0016709815245121717
Iteration: 1105, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503886103630066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028791526332497597, decouple_loss:0.0016709595220163465
The modified gen p mean: 0.4527968764305115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02639402262866497, decouple_loss:0.0014530124608427286
The modified gen p mean: 0.4559560716152191, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026361718773841858, decouple_loss:0.0015570062678307295
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1106, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4530406594276428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03007415682077408, decouple_loss:0.0016038593603298068
The modified gen p mean: 0.4571649730205536, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4517592191696167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03008531592786312, decouple_loss:0.001757016172632575
loss_pred:0.03074553795158863, decouple_loss:0.0016653266502544284
Iteration: 1107, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44840747117996216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031625762581825256, decouple_loss:0.0016299039125442505
The modified gen p mean: 0.44943609833717346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032023824751377106, decouple_loss:0.001547472900711
The modified gen p mean: 0.45053645968437195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030257022008299828, decouple_loss:0.0015706389676779509
Iteration: 1108, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45067471265792847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028265900909900665, decouple_loss:0.001598250586539507
The modified gen p mean: 0.45226043462753296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02977442368865013, decouple_loss:0.0016220159595832229
The modified gen p mean: 0.44687792658805847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031023791059851646, decouple_loss:0.0016627806471660733
Iteration: 1109, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44470059871673584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031124690547585487, decouple_loss:0.0015573457349091768
The modified gen p mean: 0.44679221510887146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02996291033923626, decouple_loss:0.0015345626743510365
The modified gen p mean: 0.44797247648239136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030903903767466545, decouple_loss:0.001511373557150364
Iteration: 1110, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4431118369102478, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02957817167043686, decouple_loss:0.0014892610488459468
The modified gen p mean: 0.44703155755996704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030701564624905586, decouple_loss:0.0015832536155357957
The modified gen p mean: 0.4457828104496002, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0290019903331995, decouple_loss:0.0015952597605064511
2023-05-26 10:51:31 testing...
The modified gen p mean: 0.44640928506851196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03243706747889519, decouple_loss:0.001745227025821805
The modified gen p mean: 0.4463132321834564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03396107628941536, decouple_loss:0.0018036937108263373
The modified gen p mean: 0.444515198469162, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0328964963555336, decouple_loss:0.0016191082540899515
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03318434953689575, avg_mse: 0.0450320839881897
current test mse: 0.045032
Iteration: 1111, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44628670811653137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029235603287816048, decouple_loss:0.0017147205071523786
The modified gen p mean: 0.4443275034427643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028889304026961327, decouple_loss:0.0015172628918662667
The modified gen p mean: 0.4457288086414337, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028435425832867622, decouple_loss:0.0018047505291178823
Iteration: 1112, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443332850933075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03074607253074646, decouple_loss:0.00161651277448982
The modified gen p mean: 0.44189393520355225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03019830398261547, decouple_loss:0.001638046815060079
The modified gen p mean: 0.4401823878288269, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029042324051260948, decouple_loss:0.0014829641440883279
Iteration: 1113, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.440635085105896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029371928423643112, decouple_loss:0.00139000138733536
The modified gen p mean: 0.4463828206062317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031262725591659546, decouple_loss:0.001666776486672461
The modified gen p mean: 0.44247689843177795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02928960882127285, decouple_loss:0.0015333546325564384
Iteration: 1114, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44739392399787903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03130283206701279, decouple_loss:0.0015895979013293982
The modified gen p mean: 0.44424673914909363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029164869338274002, decouple_loss:0.0015311348251998425
The modified gen p mean: 0.4473103880882263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028808390721678734, decouple_loss:0.0018924262840300798
Iteration: 1115, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44569456577301025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028520945459604263, decouple_loss:0.0014776169555261731
The modified gen p mean: 0.4468836784362793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028546886518597603, decouple_loss:0.0016487279208377004
The modified gen p mean: 0.4491972029209137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02940433658659458, decouple_loss:0.0016698333201929927
Iteration: 1116, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485570788383484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031095577403903008, decouple_loss:0.0016681513516232371
The modified gen p mean: 0.4480605125427246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030785774812102318, decouple_loss:0.0017700371099635959
The modified gen p mean: 0.44923266768455505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029050985351204872, decouple_loss:0.0016796982381492853
Iteration: 1117, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45162472128868103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029298845678567886, decouple_loss:0.0016992760356515646
The modified gen p mean: 0.45067620277404785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029767312109470367, decouple_loss:0.0016594775952398777
The modified gen p mean: 0.45031315088272095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028897428885102272, decouple_loss:0.0017105776350945234
Iteration: 1118, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449438214302063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02924112044274807, decouple_loss:0.0018501278245821595
The modified gen p mean: 0.450472354888916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028511282056570053, decouple_loss:0.0017786123789846897
The modified gen p mean: 0.44900867342948914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028363170102238655, decouple_loss:0.0016185628483071923
Iteration: 1119, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487045109272003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028158901259303093, decouple_loss:0.0019062247592955828
The modified gen p mean: 0.4509190022945404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030367573723196983, decouple_loss:0.0017831454752013087
The modified gen p mean: 0.4476781189441681, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028262723237276077, decouple_loss:0.0017177291447296739
Iteration: 1120, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44785839319229126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02975776605308056, decouple_loss:0.0016861765179783106
The modified gen p mean: 0.4446960687637329, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02972758375108242, decouple_loss:0.0016651487676426768
The modified gen p mean: 0.4428096115589142, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030835356563329697, decouple_loss:0.0018383377464488149
2023-05-26 10:55:39 testing...
The modified gen p mean: 0.44844961166381836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032849885523319244, decouple_loss:0.0017619781428948045
The modified gen p mean: 0.44644492864608765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03324032574892044, decouple_loss:0.001675644889473915
The modified gen p mean: 0.44812822341918945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03435950726270676, decouple_loss:0.0018222873331978917
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03357090801000595, avg_mse: 0.045557525008916855
current test mse: 0.045558
Iteration: 1121, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44544366002082825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0285356342792511, decouple_loss:0.0016580441733822227
The modified gen p mean: 0.4450699985027313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030053503811359406, decouple_loss:0.0015492842067033052
The modified gen p mean: 0.4438726007938385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029783621430397034, decouple_loss:0.0016714318189769983
Iteration: 1122, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44518592953681946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027286693453788757, decouple_loss:0.0020024944096803665
The modified gen p mean: 0.44666799902915955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029880542308092117, decouple_loss:0.0016995304031297565
The modified gen p mean: 0.4422208070755005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028777269646525383, decouple_loss:0.0014770918060094118
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr.npz
NaN value num: 0
Iteration: 1123, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4407002925872803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029733942821621895, decouple_loss:0.0019243188435211778
The modified gen p mean: 0.43992218375205994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028553463518619537, decouple_loss:0.001806132961064577
The modified gen p mean: 0.443352609872818, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028281470760703087, decouple_loss:0.0017753462307155132
Iteration: 1124, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44485169649124146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02923741564154625, decouple_loss:0.0017057305667549372
The modified gen p mean: 0.4452921450138092, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783886343240738, decouple_loss:0.0018913015956059098
The modified gen p mean: 0.4426257312297821, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02674057148396969, decouple_loss:0.0015916118863970041
Iteration: 1125, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44374075531959534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027504267171025276, decouple_loss:0.0014826091937720776
The modified gen p mean: 0.4433099329471588, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02946210652589798, decouple_loss:0.001768960151821375
The modified gen p mean: 0.4470646381378174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02889338508248329, decouple_loss:0.0017641884041950107
Iteration: 1126, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456736445426941, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028285838663578033, decouple_loss:0.0014693127013742924
The modified gen p mean: 0.4511977434158325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027100197970867157, decouple_loss:0.0018820404075086117
The modified gen p mean: 0.44567224383354187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029808660969138145, decouple_loss:0.002119931858032942
Iteration: 1127, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44944149255752563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028288548812270164, decouple_loss:0.001638832502067089
The modified gen p mean: 0.447287380695343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027387678623199463, decouple_loss:0.001622067647986114
The modified gen p mean: 0.4506494402885437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027624495327472687, decouple_loss:0.0016499257180839777
Iteration: 1128, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494853615760803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02672143094241619, decouple_loss:0.0015654658200219274
The modified gen p mean: 0.4520135819911957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02718018740415573, decouple_loss:0.0018342651892453432
The modified gen p mean: 0.4528660178184509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026816749945282936, decouple_loss:0.0019421387696638703
Iteration: 1129, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45139139890670776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026040738448500633, decouple_loss:0.0014491890324279666
The modified gen p mean: 0.45406660437583923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028242073953151703, decouple_loss:0.0016031749546527863
The modified gen p mean: 0.4528244137763977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028663156554102898, decouple_loss:0.001541857491247356
Iteration: 1130, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4562535881996155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028959432616829872, decouple_loss:0.0016720345010980964
The modified gen p mean: 0.4532133936882019, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027222415432333946, decouple_loss:0.0016742718871682882
The modified gen p mean: 0.45323270559310913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027637895196676254, decouple_loss:0.0016094351885840297
2023-05-26 11:00:31 testing...
The modified gen p mean: 0.45725589990615845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03267670050263405, decouple_loss:0.0017939078388735652
The modified gen p mean: 0.4554080665111542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032980263233184814, decouple_loss:0.0017157003749161959
The modified gen p mean: 0.4571329951286316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0341150239109993, decouple_loss:0.0018156341975554824
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033346086740493774, avg_mse: 0.045242320746183395
current test mse: 0.045242
Iteration: 1131, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4536861479282379, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025764061138033867, decouple_loss:0.0015965023776516318
The modified gen p mean: 0.4553050398826599, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02754380740225315, decouple_loss:0.0017573864897713065
The modified gen p mean: 0.4525090456008911, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026572279632091522, decouple_loss:0.001703211572021246
Iteration: 1132, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490853548049927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02731400355696678, decouple_loss:0.001511555863544345
The modified gen p mean: 0.44871464371681213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02915544994175434, decouple_loss:0.0016601914539933205
The modified gen p mean: 0.4490159749984741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02827882394194603, decouple_loss:0.001798340119421482
Iteration: 1133, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44702795147895813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029669348150491714, decouple_loss:0.001763209467753768
The modified gen p mean: 0.44849470257759094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028921877965331078, decouple_loss:0.0015311498427763581
The modified gen p mean: 0.44747745990753174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028111208230257034, decouple_loss:0.0014534713700413704
Iteration: 1134, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44884783029556274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027407776564359665, decouple_loss:0.001894532237201929
The modified gen p mean: 0.4501441419124603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025660179555416107, decouple_loss:0.0017367947148159146
The modified gen p mean: 0.4463670551776886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783151902258396, decouple_loss:0.0018588901730254292
Iteration: 1135, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473310708999634, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44379153847694397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026442402973771095, decouple_loss:0.0015682507073506713
loss_pred:0.029599718749523163, decouple_loss:0.0015219795750454068
The modified gen p mean: 0.446079820394516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027420928701758385, decouple_loss:0.0015712829772382975
Iteration: 1136, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44369152188301086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027580823749303818, decouple_loss:0.0014758865581825376
The modified gen p mean: 0.4463983476161957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026456188410520554, decouple_loss:0.0019091860158368945
The modified gen p mean: 0.4458671808242798, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026795923709869385, decouple_loss:0.0015372750349342823
Iteration: 1137, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4430837631225586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027905449271202087, decouple_loss:0.001497837365604937
The modified gen p mean: 0.4460846483707428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028436824679374695, decouple_loss:0.0015872372314333916
The modified gen p mean: 0.4433223307132721, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027811475098133087, decouple_loss:0.0015965974889695644
Iteration: 1138, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444071054458618, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028747854754328728, decouple_loss:0.0015837820246815681
The modified gen p mean: 0.44340774416923523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02602563053369522, decouple_loss:0.001523777493275702
The modified gen p mean: 0.444897323846817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02671799622476101, decouple_loss:0.0016181000974029303
Iteration: 1139, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505278468132019, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028456425294280052, decouple_loss:0.0015586811350658536
The modified gen p mean: 0.4469338059425354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02751970663666725, decouple_loss:0.0015641277423128486
The modified gen p mean: 0.44928568601608276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028132600709795952, decouple_loss:0.00165754952467978
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1140, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4527908265590668, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028013568371534348, decouple_loss:0.0014446356799453497
The modified gen p mean: 0.4512777328491211, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44702616333961487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030560392886400223, decouple_loss:0.001718411105684936
loss_pred:0.02715093456208706, decouple_loss:0.001749659888446331
2023-05-26 11:05:11 testing...
The modified gen p mean: 0.4554550349712372, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032521188259124756, decouple_loss:0.001690094475634396
The modified gen p mean: 0.45352059602737427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03276138752698898, decouple_loss:0.0015443977899849415
The modified gen p mean: 0.4554212987422943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033912211656570435, decouple_loss:0.0017043114639818668
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03314724564552307, avg_mse: 0.04501087963581085
current test mse: 0.045011
Iteration: 1141, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45041877031326294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02940724790096283, decouple_loss:0.0014685264322906733
The modified gen p mean: 0.45070019364356995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029408711940050125, decouple_loss:0.0016139798099175096
The modified gen p mean: 0.4550323188304901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02906806580722332, decouple_loss:0.0017520321998745203
Iteration: 1142, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45081427693367004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029500029981136322, decouple_loss:0.0014512073248624802
The modified gen p mean: 0.45190325379371643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028833942487835884, decouple_loss:0.0014383930247277021
The modified gen p mean: 0.453068345785141, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02881637029349804, decouple_loss:0.001591221778653562
Iteration: 1143, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45351892709732056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02895549312233925, decouple_loss:0.0015349460300058126
The modified gen p mean: 0.45118439197540283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028789615258574486, decouple_loss:0.001568681444041431
The modified gen p mean: 0.45219993591308594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02655315399169922, decouple_loss:0.0017847729614004493
Iteration: 1144, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44930335879325867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028761934489011765, decouple_loss:0.0014966579619795084
The modified gen p mean: 0.45004159212112427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030912136659026146, decouple_loss:0.0014997180551290512
The modified gen p mean: 0.4512645900249481, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029254624620079994, decouple_loss:0.0016303675947710872
Iteration: 1145, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450364887714386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027206098660826683, decouple_loss:0.0016860311152413487
The modified gen p mean: 0.44858837127685547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029413621872663498, decouple_loss:0.0015411589993163943
The modified gen p mean: 0.45048415660858154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029669087380170822, decouple_loss:0.0017055128701031208
Iteration: 1146, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44794508814811707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029967140406370163, decouple_loss:0.00160010508261621
The modified gen p mean: 0.4481978714466095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02947073243558407, decouple_loss:0.0014542172430083156
The modified gen p mean: 0.447282612323761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028803864493966103, decouple_loss:0.001669795368798077
Iteration: 1147, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44754859805107117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029139360412955284, decouple_loss:0.001509754452854395
The modified gen p mean: 0.4459454119205475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029059873893857002, decouple_loss:0.0016570922452956438
The modified gen p mean: 0.44776037335395813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027760431170463562, decouple_loss:0.0017529093893244863
Iteration: 1148, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473915994167328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02788621187210083, decouple_loss:0.001830867724493146
The modified gen p mean: 0.44443580508232117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030688868835568428, decouple_loss:0.0015986025100573897
The modified gen p mean: 0.4471295177936554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771792560815811, decouple_loss:0.0015542360488325357
Iteration: 1149, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44200319051742554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02913169376552105, decouple_loss:0.001511662150733173
The modified gen p mean: 0.4463217556476593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027121376246213913, decouple_loss:0.0015957520809024572
The modified gen p mean: 0.44326651096343994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027547938749194145, decouple_loss:0.0018148706294596195
Iteration: 1150, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441744387149811, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4447292387485504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028023049235343933, decouple_loss:0.0015933415852487087loss_pred:0.02735482156276703, decouple_loss:0.0019090112764388323
The modified gen p mean: 0.442603200674057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02755771391093731, decouple_loss:0.0015584247885271907
2023-05-26 11:09:21 testing...
The modified gen p mean: 0.4484371542930603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03264664113521576, decouple_loss:0.001763143576681614
The modified gen p mean: 0.44624242186546326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03305668756365776, decouple_loss:0.0016878778114914894
The modified gen p mean: 0.4480876326560974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034119248390197754, decouple_loss:0.0017733204877004027
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03336126729846001, avg_mse: 0.04525583237409592
current test mse: 0.045256
Iteration: 1151, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44454193115234375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02810092084109783, decouple_loss:0.0016530374996364117
The modified gen p mean: 0.44795382022857666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02802184782922268, decouple_loss:0.0016305313911288977
The modified gen p mean: 0.440956711769104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02887403964996338, decouple_loss:0.0014058556407690048
Iteration: 1152, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4420815408229828, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029157040640711784, decouple_loss:0.001590346684679389
The modified gen p mean: 0.4450049102306366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029884526506066322, decouple_loss:0.0016197607619687915
The modified gen p mean: 0.4478265047073364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02818823792040348, decouple_loss:0.001767270267009735
Iteration: 1153, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44323498010635376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029251836240291595, decouple_loss:0.001833970076404512
The modified gen p mean: 0.4449199438095093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029880722984671593, decouple_loss:0.0018947351491078734
The modified gen p mean: 0.4440514147281647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029269615188241005, decouple_loss:0.0015135572757571936
Iteration: 1154, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450615644454956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02925850637257099, decouple_loss:0.0016089387936517596
The modified gen p mean: 0.44482919573783875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029351448640227318, decouple_loss:0.0015498780412599444
The modified gen p mean: 0.44784510135650635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029874807223677635, decouple_loss:0.0015799453249201179
Iteration: 1155, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4517917335033417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028949910774827003, decouple_loss:0.0017410236177965999
The modified gen p mean: 0.4497322738170624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028333226218819618, decouple_loss:0.0017363843508064747
The modified gen p mean: 0.44395285844802856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029297078028321266, decouple_loss:0.0015622860519215465
Iteration: 1156, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44935742020606995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028291281312704086, decouple_loss:0.0020702332258224487
The modified gen p mean: 0.453723669052124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027373462915420532, decouple_loss:0.0019120706710964441
The modified gen p mean: 0.4476117193698883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028266940265893936, decouple_loss:0.0015770215541124344
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1157, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45524877309799194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03243238478899002, decouple_loss:0.0017444273689761758
The modified gen p mean: 0.4522474408149719, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45413193106651306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03419727459549904, decouple_loss:0.0018192249117419124loss_pred:0.03222107142210007, decouple_loss:0.0017361294012516737
Iteration: 1158, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.453395813703537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03356782719492912, decouple_loss:0.0016278541879728436
The modified gen p mean: 0.4547154903411865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03433288261294365, decouple_loss:0.001568166888318956
The modified gen p mean: 0.4542444348335266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03244200721383095, decouple_loss:0.0017918809317052364
Iteration: 1159, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45298007130622864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03430686146020889, decouple_loss:0.0016118261264637113
The modified gen p mean: 0.45197415351867676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03402584791183472, decouple_loss:0.0019047382520511746
The modified gen p mean: 0.4489089250564575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03343845158815384, decouple_loss:0.0016597654903307557
Iteration: 1160, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450316846370697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03337392956018448, decouple_loss:0.0015604430809617043
The modified gen p mean: 0.4482147693634033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03573952615261078, decouple_loss:0.0017613251693546772
The modified gen p mean: 0.4487062990665436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03372056409716606, decouple_loss:0.001709794974885881
2023-05-26 11:14:08 testing...
The modified gen p mean: 0.45196017622947693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261888027191162, decouple_loss:0.0018850760534405708
The modified gen p mean: 0.44985100626945496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03297165408730507, decouple_loss:0.0018434174126014113
The modified gen p mean: 0.4513215124607086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03410954400897026, decouple_loss:0.0018635602900758386
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033326562494039536, avg_mse: 0.04506275802850723
current test mse: 0.045063
Iteration: 1161, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479886293411255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03364037722349167, decouple_loss:0.001483903150074184
The modified gen p mean: 0.44803863763809204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03458283841609955, decouple_loss:0.0016235895454883575
The modified gen p mean: 0.4529552459716797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03352733328938484, decouple_loss:0.0018474158132448792
Iteration: 1162, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493100345134735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03589538857340813, decouple_loss:0.00168167008087039
The modified gen p mean: 0.4472205936908722, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03325996547937393, decouple_loss:0.0018147979862987995
The modified gen p mean: 0.4475403428077698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03361096978187561, decouple_loss:0.0016208636807277799
Iteration: 1163, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500892162322998, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259572759270668, decouple_loss:0.0017154909437522292
The modified gen p mean: 0.4469625949859619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034768424928188324, decouple_loss:0.001453436678275466
The modified gen p mean: 0.44838443398475647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253627195954323, decouple_loss:0.0015654199523851275
Iteration: 1164, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44869816303253174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03266138583421707, decouple_loss:0.0015885491156950593
The modified gen p mean: 0.44869303703308105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03434548154473305, decouple_loss:0.0015853450167924166
The modified gen p mean: 0.44655343890190125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03247198462486267, decouple_loss:0.001421715714968741
Iteration: 1165, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44770488142967224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03466863930225372, decouple_loss:0.0014675244456157088
The modified gen p mean: 0.44740235805511475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033507488667964935, decouple_loss:0.001660019508562982
The modified gen p mean: 0.45028966665267944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0345756895840168, decouple_loss:0.0016131066950038075
Iteration: 1166, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44944533705711365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03430727496743202, decouple_loss:0.0014788095140829682
The modified gen p mean: 0.44804084300994873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0333750955760479, decouple_loss:0.001619457034394145
The modified gen p mean: 0.4506572484970093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03216695785522461, decouple_loss:0.0017869212897494435
Iteration: 1167, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488126337528229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03521835803985596, decouple_loss:0.0014367967378348112
The modified gen p mean: 0.4468095302581787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03272765129804611, decouple_loss:0.0014744807267561555
The modified gen p mean: 0.4490319788455963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03480001166462898, decouple_loss:0.0015278218779712915
Iteration: 1168, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506496787071228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03415312245488167, decouple_loss:0.0015164944343268871
The modified gen p mean: 0.44768011569976807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03514822944998741, decouple_loss:0.0016450551338493824
The modified gen p mean: 0.44904789328575134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03247398883104324, decouple_loss:0.0015933933900669217
Iteration: 1169, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44867807626724243, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033318694680929184, decouple_loss:0.001456594094634056
The modified gen p mean: 0.45156532526016235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03387672081589699, decouple_loss:0.0017499460373073816
The modified gen p mean: 0.44867804646492004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03418263792991638, decouple_loss:0.0014894986525177956
Iteration: 1170, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450522780418396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03273261711001396, decouple_loss:0.0014906181022524834
The modified gen p mean: 0.4476853013038635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03274787962436676, decouple_loss:0.0015311845345422626
The modified gen p mean: 0.4483254551887512, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03235150873661041, decouple_loss:0.0015655631432309747
2023-05-26 11:18:16 testing...
The modified gen p mean: 0.45035916566848755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032222770154476166, decouple_loss:0.0016362863825634122
The modified gen p mean: 0.44853705167770386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03239918500185013, decouple_loss:0.0015805927105247974
The modified gen p mean: 0.44985318183898926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03370356932282448, decouple_loss:0.0016807297943159938
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03285680338740349, avg_mse: 0.0443323478102684
current test mse: 0.044332
Iteration: 1171, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457610845565796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03412732854485512, decouple_loss:0.0014480846002697945
The modified gen p mean: 0.44635140895843506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03522321581840515, decouple_loss:0.001357166562229395
The modified gen p mean: 0.4481654167175293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03511412814259529, decouple_loss:0.0015057595446705818
Iteration: 1172, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444806307554245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03322770074009895, decouple_loss:0.0015719562070444226
The modified gen p mean: 0.4479807913303375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03395809605717659, decouple_loss:0.0015207523247227073
The modified gen p mean: 0.4483128488063812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033574752509593964, decouple_loss:0.0015829905169084668
Iteration: 1173, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474940598011017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03272072225809097, decouple_loss:0.0013801673194393516
The modified gen p mean: 0.44945839047431946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033144641667604446, decouple_loss:0.0015875636599957943
The modified gen p mean: 0.44777747988700867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032693106681108475, decouple_loss:0.0014196251286193728
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr.npz
NaN value num: 0
Iteration: 1174, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44812512397766113, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4475301504135132, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03420049697160721, decouple_loss:0.0015500059816986322
loss_pred:0.03440526872873306, decouple_loss:0.0015115460846573114The modified gen p mean: 0.4468216001987457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032650336623191833, decouple_loss:0.00157345668412745
Iteration: 1175, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4520290493965149, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030568337067961693, decouple_loss:0.001530868816189468
The modified gen p mean: 0.4504830539226532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03365642577409744, decouple_loss:0.0016140044899657369
The modified gen p mean: 0.4503512382507324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03198365122079849, decouple_loss:0.0014712070114910603
Iteration: 1176, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509425163269043, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4548148810863495, gen p mean: 0.0, mean p set: 0.448loss_pred:0.032947979867458344, decouple_loss:0.0016328551573678851
loss_pred:0.032591864466667175, decouple_loss:0.0014285114593803883
The modified gen p mean: 0.45022523403167725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031830523163080215, decouple_loss:0.001569148967973888
Iteration: 1177, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45380309224128723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035585999488830566, decouple_loss:0.0015385252190753818
The modified gen p mean: 0.45293447375297546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03208865225315094, decouple_loss:0.001536708208732307
The modified gen p mean: 0.4540790021419525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03127443417906761, decouple_loss:0.0014805286191403866
Iteration: 1178, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4545489549636841, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03347214683890343, decouple_loss:0.0016111023724079132
The modified gen p mean: 0.45584025979042053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034357957541942596, decouple_loss:0.0013521354412660003
The modified gen p mean: 0.456362783908844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03367634490132332, decouple_loss:0.0016130106523633003
Iteration: 1179, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45718222856521606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031510885804891586, decouple_loss:0.0015258478233590722
The modified gen p mean: 0.4540958106517792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031100234016776085, decouple_loss:0.001439482206478715
The modified gen p mean: 0.45678889751434326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034167494624853134, decouple_loss:0.0015202595386654139
Iteration: 1180, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4531857371330261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03321672976016998, decouple_loss:0.001495890086516738
The modified gen p mean: 0.4540771543979645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034970201551914215, decouple_loss:0.001380467670969665
The modified gen p mean: 0.45180147886276245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03341726213693619, decouple_loss:0.001429655821993947
2023-05-26 11:23:09 testing...
The modified gen p mean: 0.455650269985199, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03203972429037094, decouple_loss:0.0015477314591407776
The modified gen p mean: 0.4555605351924896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03360888361930847, decouple_loss:0.0015256315236911178
The modified gen p mean: 0.4537575840950012, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03222380578517914, decouple_loss:0.001399780041538179
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03269869089126587, avg_mse: 0.04413214698433876
current test mse: 0.044132
Iteration: 1181, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44931840896606445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032195355743169785, decouple_loss:0.0015291690360754728
The modified gen p mean: 0.4499238133430481, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03271079435944557, decouple_loss:0.001476380624808371
The modified gen p mean: 0.4536934494972229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03236416354775429, decouple_loss:0.001523321494460106
Iteration: 1182, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45010021328926086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035305455327034, decouple_loss:0.0017736121080815792
The modified gen p mean: 0.45375823974609375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03339669480919838, decouple_loss:0.001531832735054195
The modified gen p mean: 0.453586608171463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0317402184009552, decouple_loss:0.001462930697016418
Iteration: 1183, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483392536640167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03417930006980896, decouple_loss:0.0014641368761658669
The modified gen p mean: 0.45077410340309143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032992810010910034, decouple_loss:0.0014033062616363168
The modified gen p mean: 0.4511409401893616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0321812741458416, decouple_loss:0.00160559534560889
Iteration: 1184, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443148970603943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03523218631744385, decouple_loss:0.0015180950285866857
The modified gen p mean: 0.44825229048728943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03533473610877991, decouple_loss:0.0016000113682821393
The modified gen p mean: 0.4508492350578308, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03378155082464218, decouple_loss:0.0014241646276786923
Iteration: 1185, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44547712802886963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03434642404317856, decouple_loss:0.0014225434279069304
The modified gen p mean: 0.44653329253196716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03470582515001297, decouple_loss:0.0013639101525768638
The modified gen p mean: 0.4458162784576416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033883873373270035, decouple_loss:0.0014491495676338673
Iteration: 1186, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4431809186935425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03379669040441513, decouple_loss:0.0014367770636454225
The modified gen p mean: 0.44635289907455444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03407946974039078, decouple_loss:0.0014102765126153827
The modified gen p mean: 0.4447973370552063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03313450142741203, decouple_loss:0.0014248047955334187
Iteration: 1187, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44789132475852966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03262164443731308, decouple_loss:0.0013304969761520624
The modified gen p mean: 0.44432419538497925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032397087663412094, decouple_loss:0.0013288401532918215
The modified gen p mean: 0.44506606459617615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033299095928668976, decouple_loss:0.001451778458431363
Iteration: 1188, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455057382583618, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03412667661905289, decouple_loss:0.001464001601561904
The modified gen p mean: 0.44630327820777893, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0323990136384964, decouple_loss:0.0012877379776909947
The modified gen p mean: 0.4456348121166229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03470289334654808, decouple_loss:0.0014287229860201478
Iteration: 1189, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44811367988586426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032020799815654755, decouple_loss:0.0015000299317762256
The modified gen p mean: 0.44751375913619995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03312251716852188, decouple_loss:0.0015091814566403627
The modified gen p mean: 0.44973447918891907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03295036777853966, decouple_loss:0.0015985864447429776
Iteration: 1190, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44633227586746216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032699715346097946, decouple_loss:0.0014878042275086045
The modified gen p mean: 0.4474511742591858, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03216437250375748, decouple_loss:0.001466700923629105
The modified gen p mean: 0.4474342167377472, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03132234513759613, decouple_loss:0.001481462037190795
2023-05-26 11:27:14 testing...
The modified gen p mean: 0.4486628472805023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031926922500133514, decouple_loss:0.0015028088819235563
The modified gen p mean: 0.44689086079597473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032133135944604874, decouple_loss:0.0013428028905764222
The modified gen p mean: 0.44880247116088867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033596716821193695, decouple_loss:0.001524266554042697
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03262509033083916, avg_mse: 0.04397819563746452
current test mse: 0.043978
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1191, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.443926066160202, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029651766642928123, decouple_loss:0.0014579088892787695
The modified gen p mean: 0.44714322686195374, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4452156126499176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03121054917573929, decouple_loss:0.0014013475738465786
loss_pred:0.028329597786068916, decouple_loss:0.001491355593316257
Iteration: 1192, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460987150669098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029492907226085663, decouple_loss:0.0014530280604958534
The modified gen p mean: 0.44400009512901306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029381336644291878, decouple_loss:0.001396912382915616
The modified gen p mean: 0.4483838975429535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03199237957596779, decouple_loss:0.0014711254043504596
Iteration: 1193, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44241440296173096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03053675778210163, decouple_loss:0.0013375907437875867
The modified gen p mean: 0.44313302636146545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03050813265144825, decouple_loss:0.0014376917388290167
The modified gen p mean: 0.44569310545921326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02894756942987442, decouple_loss:0.0014619029825553298
Iteration: 1194, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438779354095459, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03061053901910782, decouple_loss:0.0014796549221500754
The modified gen p mean: 0.4434370994567871, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031057143583893776, decouple_loss:0.0015021648723632097
The modified gen p mean: 0.44082561135292053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0302430447191, decouple_loss:0.0012706035049632192
Iteration: 1195, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4437093734741211, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031634584069252014, decouple_loss:0.0014487080043181777
The modified gen p mean: 0.44364702701568604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02856372855603695, decouple_loss:0.0015066876076161861
The modified gen p mean: 0.4421018362045288, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029760809615254402, decouple_loss:0.0013056184398010373
Iteration: 1196, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.443052738904953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030676020309329033, decouple_loss:0.0014400648651644588
The modified gen p mean: 0.44584959745407104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02913583442568779, decouple_loss:0.0015229630516842008
The modified gen p mean: 0.4436931610107422, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030825063586235046, decouple_loss:0.0014465076383203268
Iteration: 1197, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473474323749542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028190359473228455, decouple_loss:0.0014516143128275871
The modified gen p mean: 0.44578996300697327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028960496187210083, decouple_loss:0.0016450650291517377
The modified gen p mean: 0.44897109270095825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029939470812678337, decouple_loss:0.001611109939403832
Iteration: 1198, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473477005958557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028974469751119614, decouple_loss:0.0015822692075744271
The modified gen p mean: 0.45026513934135437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028759639710187912, decouple_loss:0.0016191806644201279
The modified gen p mean: 0.4505745470523834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028251806274056435, decouple_loss:0.0015851706266403198
Iteration: 1199, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44864773750305176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03002551570534706, decouple_loss:0.0014871868770569563
The modified gen p mean: 0.45404869318008423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03005748800933361, decouple_loss:0.0019489270634949207
The modified gen p mean: 0.4525320827960968, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030909361317753792, decouple_loss:0.0014504228020086884
Iteration: 1200, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45275574922561646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03027539886534214, decouple_loss:0.0016067405231297016
The modified gen p mean: 0.45435288548469543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03005323000252247, decouple_loss:0.001879507559351623
The modified gen p mean: 0.4532153010368347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028026556596159935, decouple_loss:0.001531812478788197
2023-05-26 11:32:01 testing...
The modified gen p mean: 0.45484375953674316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0323110893368721, decouple_loss:0.0016581331146880984
The modified gen p mean: 0.45281982421875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03247702121734619, decouple_loss:0.0015004434389993548
The modified gen p mean: 0.4547803997993469, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03389815613627434, decouple_loss:0.0017164956079795957
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0329766720533371, avg_mse: 0.044497497379779816
current test mse: 0.044497
Iteration: 1201, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514324963092804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030441973358392715, decouple_loss:0.0017587915062904358
The modified gen p mean: 0.45451799035072327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03083968721330166, decouple_loss:0.002215369837358594
The modified gen p mean: 0.4513062536716461, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029454277828335762, decouple_loss:0.0016495793825015426
Iteration: 1202, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45020943880081177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030362239107489586, decouple_loss:0.0015385402366518974
The modified gen p mean: 0.4487275183200836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02867279388010502, decouple_loss:0.0015517541905865073
The modified gen p mean: 0.45094120502471924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027882913127541542, decouple_loss:0.0016568850260227919
Iteration: 1203, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476630985736847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028864098712801933, decouple_loss:0.001694460865110159
The modified gen p mean: 0.4499112665653229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0299981776624918, decouple_loss:0.0015555218560621142
The modified gen p mean: 0.44916996359825134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029143469408154488, decouple_loss:0.0013299895217642188
Iteration: 1204, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45131149888038635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02978542074561119, decouple_loss:0.0017222785390913486
The modified gen p mean: 0.4493700861930847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03024882823228836, decouple_loss:0.0015673639718443155
The modified gen p mean: 0.44660910964012146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029314015060663223, decouple_loss:0.0014887966681271791
Iteration: 1205, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44770342111587524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029362652450799942, decouple_loss:0.0017792864236980677
The modified gen p mean: 0.4488483667373657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030427219346165657, decouple_loss:0.0016570643056184053
The modified gen p mean: 0.44943395256996155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029999079182744026, decouple_loss:0.0018782856641337276
Iteration: 1206, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4517039656639099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027957962825894356, decouple_loss:0.0019623972475528717
The modified gen p mean: 0.44823580980300903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030547717586159706, decouple_loss:0.0016392507823184133
The modified gen p mean: 0.44800785183906555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03088971972465515, decouple_loss:0.0016196101205423474
Iteration: 1207, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497182071208954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722427435219288, decouple_loss:0.0018643807852640748
The modified gen p mean: 0.4465849697589874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030107978731393814, decouple_loss:0.0015650202985852957
The modified gen p mean: 0.4481634199619293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029418371617794037, decouple_loss:0.001648226287215948
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1208, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44635942578315735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03369444981217384, decouple_loss:0.0015086503699421883
The modified gen p mean: 0.4505409598350525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0312732495367527, decouple_loss:0.0015641655772924423
The modified gen p mean: 0.4464583098888397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03399202972650528, decouple_loss:0.0016072919825091958
Iteration: 1209, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45112428069114685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03263557329773903, decouple_loss:0.0016187260625883937
The modified gen p mean: 0.4471943974494934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03414565697312355, decouple_loss:0.001698697917163372
The modified gen p mean: 0.44925257563591003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03463127464056015, decouple_loss:0.0015567147638648748
Iteration: 1210, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503018260002136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03442889824509621, decouple_loss:0.001862331642769277
The modified gen p mean: 0.45346298813819885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03576776385307312, decouple_loss:0.001641640905290842
The modified gen p mean: 0.4529525637626648, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035978466272354126, decouple_loss:0.0016902940114960074
2023-05-26 11:36:47 testing...
The modified gen p mean: 0.4546404480934143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03256350755691528, decouple_loss:0.001725348993204534
The modified gen p mean: 0.4526643455028534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03286689147353172, decouple_loss:0.0016324497992172837
The modified gen p mean: 0.45439159870147705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034113962203264236, decouple_loss:0.001863522338680923
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03326847776770592, avg_mse: 0.04492558538913727
current test mse: 0.044926
Iteration: 1211, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4526345133781433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03236506134271622, decouple_loss:0.0016894754953682423
The modified gen p mean: 0.45161303877830505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03374842554330826, decouple_loss:0.0016384974587708712
The modified gen p mean: 0.45375490188598633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03326847776770592, decouple_loss:0.0015727555146440864
Iteration: 1212, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44991904497146606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033273447304964066, decouple_loss:0.0015903791645541787
The modified gen p mean: 0.455814927816391, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03420930355787277, decouple_loss:0.0017317581223323941
The modified gen p mean: 0.449795663356781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033636901527643204, decouple_loss:0.0015828183386474848
Iteration: 1213, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45219412446022034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032339904457330704, decouple_loss:0.0016386858187615871
The modified gen p mean: 0.4495641589164734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03182792663574219, decouple_loss:0.001389940152876079
The modified gen p mean: 0.44967755675315857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03330136090517044, decouple_loss:0.0014842102536931634
Iteration: 1214, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45109546184539795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03212535008788109, decouple_loss:0.001616345951333642
The modified gen p mean: 0.45069149136543274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0327017642557621, decouple_loss:0.0014616833068430424
The modified gen p mean: 0.45405665040016174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03293771669268608, decouple_loss:0.0016511109424754977
Iteration: 1215, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500690698623657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03194713965058327, decouple_loss:0.0015701290685683489
The modified gen p mean: 0.44992226362228394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0318683385848999, decouple_loss:0.0015898915007710457
The modified gen p mean: 0.45443418622016907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03497317433357239, decouple_loss:0.0015655665192753077
Iteration: 1216, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45248356461524963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03242264315485954, decouple_loss:0.001603917684406042
The modified gen p mean: 0.4488559365272522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03316504880785942, decouple_loss:0.0015114666894078255
The modified gen p mean: 0.44917717576026917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03163355961441994, decouple_loss:0.0013908531982451677
Iteration: 1217, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4526897072792053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0347294919192791, decouple_loss:0.0014901193790137768
The modified gen p mean: 0.4526050388813019, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032434068620204926, decouple_loss:0.0016333026578649879
The modified gen p mean: 0.4507647156715393, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03270064666867256, decouple_loss:0.0014312310377135873
Iteration: 1218, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515220820903778, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032029736787080765, decouple_loss:0.0014614940155297518
The modified gen p mean: 0.454071044921875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03335656598210335, decouple_loss:0.0016151393065229058
The modified gen p mean: 0.45069393515586853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03302987292408943, decouple_loss:0.0013945739483460784
Iteration: 1219, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512290954589844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033509206026792526, decouple_loss:0.0014322283677756786
The modified gen p mean: 0.4525083303451538, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03339448198676109, decouple_loss:0.001537651289254427
The modified gen p mean: 0.45098915696144104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034512124955654144, decouple_loss:0.0015076774870976806
Iteration: 1220, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4563945531845093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03195808455348015, decouple_loss:0.0016352991806343198
The modified gen p mean: 0.45469534397125244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032834943383932114, decouple_loss:0.0016296845860779285
The modified gen p mean: 0.4533727467060089, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03556329756975174, decouple_loss:0.0016469355905428529
2023-05-26 11:40:52 testing...
The modified gen p mean: 0.45528826117515564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032246824353933334, decouple_loss:0.0016726762987673283
The modified gen p mean: 0.4535313844680786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246046602725983, decouple_loss:0.0015918659046292305
The modified gen p mean: 0.4551931321620941, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03356074541807175, decouple_loss:0.0017406452680006623
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03283943235874176, avg_mse: 0.0442361906170845
current test mse: 0.044236
Iteration: 1221, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45138248801231384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03469771519303322, decouple_loss:0.001403486356139183
The modified gen p mean: 0.458001047372818, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03264620155096054, decouple_loss:0.001593505498021841
The modified gen p mean: 0.4519156813621521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03400599956512451, decouple_loss:0.0015285968547686934
Iteration: 1222, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4541268050670624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03383452817797661, decouple_loss:0.0015679055359214544
The modified gen p mean: 0.45487165451049805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03216361626982689, decouple_loss:0.0015087560750544071
The modified gen p mean: 0.45494934916496277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0347621887922287, decouple_loss:0.0015017378609627485
Iteration: 1223, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45152637362480164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03533979877829552, decouple_loss:0.0014473641058430076
The modified gen p mean: 0.4501711428165436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0326412171125412, decouple_loss:0.0013978988863527775
The modified gen p mean: 0.45194652676582336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03326211869716644, decouple_loss:0.0015166258672252297
Iteration: 1224, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4533206820487976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03578781709074974, decouple_loss:0.0014530420303344727
The modified gen p mean: 0.4542745053768158, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031913936138153076, decouple_loss:0.0014494957868009806
The modified gen p mean: 0.45209184288978577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03523394465446472, decouple_loss:0.0015787192387506366
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1225, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44808971881866455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033854469656944275, decouple_loss:0.0014856462366878986
The modified gen p mean: 0.45356929302215576, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4520839750766754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03054998256266117, decouple_loss:0.0014063749695196748
loss_pred:0.03341099992394447, decouple_loss:0.0015183240175247192
Iteration: 1226, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459371268749237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03432749956846237, decouple_loss:0.001544380560517311
The modified gen p mean: 0.4474896192550659, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03166155144572258, decouple_loss:0.0015373064670711756
The modified gen p mean: 0.4476887881755829, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03212397173047066, decouple_loss:0.0014530968619510531
Iteration: 1227, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45025721192359924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03224122151732445, decouple_loss:0.0015090684173628688
The modified gen p mean: 0.449831485748291, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03161846473813057, decouple_loss:0.0015681865625083447
The modified gen p mean: 0.4503012001514435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03267202526330948, decouple_loss:0.0015119370073080063
Iteration: 1228, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4523784816265106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03325840085744858, decouple_loss:0.0014965785667300224
The modified gen p mean: 0.4488283395767212, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03325682878494263, decouple_loss:0.0014542537974193692
The modified gen p mean: 0.45134684443473816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03242494910955429, decouple_loss:0.001460885163396597
Iteration: 1229, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509037435054779, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03165387362241745, decouple_loss:0.001624680357053876
The modified gen p mean: 0.4475049674510956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0330774262547493, decouple_loss:0.0014126354362815619
The modified gen p mean: 0.4486178457736969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030612433329224586, decouple_loss:0.001501439604908228
Iteration: 1230, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463783800601959, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033564791083335876, decouple_loss:0.0015317769721150398
The modified gen p mean: 0.4476826786994934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03284198418259621, decouple_loss:0.0014058224624022841
The modified gen p mean: 0.4463680684566498, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03203349560499191, decouple_loss:0.0014301431365311146
2023-05-26 11:45:40 testing...
The modified gen p mean: 0.451649010181427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03199394419789314, decouple_loss:0.0016709318151697516
The modified gen p mean: 0.45184752345085144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03336731716990471, decouple_loss:0.0016564566176384687
The modified gen p mean: 0.449990838766098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03227200731635094, decouple_loss:0.0015685823746025562
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03262602537870407, avg_mse: 0.04395005479454994
current test mse: 0.04395
Iteration: 1231, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45218273997306824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03070024587213993, decouple_loss:0.0016764586325734854
The modified gen p mean: 0.452144980430603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032590799033641815, decouple_loss:0.0015990640968084335
The modified gen p mean: 0.4519652724266052, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03045058622956276, decouple_loss:0.0015455492539331317
Iteration: 1232, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44964316487312317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032960012555122375, decouple_loss:0.00144910195376724
The modified gen p mean: 0.45132648944854736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03164669871330261, decouple_loss:0.0015996815636754036
The modified gen p mean: 0.4517914056777954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031603723764419556, decouple_loss:0.0016189528396353126
Iteration: 1233, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44941502809524536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0317794494330883, decouple_loss:0.0014455837663263083
The modified gen p mean: 0.4509192407131195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03156885877251625, decouple_loss:0.001624438213184476
The modified gen p mean: 0.44849711656570435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03365257754921913, decouple_loss:0.0014617596752941608
Iteration: 1234, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486851990222931, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03256617859005928, decouple_loss:0.0016507405089214444
The modified gen p mean: 0.4467920660972595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03155973553657532, decouple_loss:0.001420152373611927
The modified gen p mean: 0.4493180513381958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03458017110824585, decouple_loss:0.0013958746567368507
Iteration: 1235, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451607882976532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03203047439455986, decouple_loss:0.001526686130091548
The modified gen p mean: 0.4516426920890808, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03138374537229538, decouple_loss:0.0015214342856779695
The modified gen p mean: 0.4508965015411377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03169167414307594, decouple_loss:0.0013916086172685027
Iteration: 1236, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44926145672798157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03449296951293945, decouple_loss:0.001459001679904759
The modified gen p mean: 0.4495218098163605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0332597941160202, decouple_loss:0.0014171117218211293
The modified gen p mean: 0.44977015256881714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033445440232753754, decouple_loss:0.0015893027884885669
Iteration: 1237, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468819200992584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254885599017143, decouple_loss:0.001460920786485076
The modified gen p mean: 0.4482008218765259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265364095568657, decouple_loss:0.0015014278469607234
The modified gen p mean: 0.4477018713951111, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03352976590394974, decouple_loss:0.0014938140520825982
Iteration: 1238, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44771772623062134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030506517738103867, decouple_loss:0.0015261711087077856
The modified gen p mean: 0.44840380549430847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0330565981566906, decouple_loss:0.0015474327374249697
The modified gen p mean: 0.4464391767978668, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03195326775312424, decouple_loss:0.0015056075062602758
Iteration: 1239, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44613853096961975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03103899583220482, decouple_loss:0.001433965633623302
The modified gen p mean: 0.4430781602859497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03301060199737549, decouple_loss:0.0013582708779722452
The modified gen p mean: 0.4444659948348999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0341985784471035, decouple_loss:0.0015257735503837466
Iteration: 1240, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458877444267273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03156973049044609, decouple_loss:0.0014026592252776027
The modified gen p mean: 0.4457561671733856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03155824914574623, decouple_loss:0.0014478652738034725
The modified gen p mean: 0.44596442580223083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03388369455933571, decouple_loss:0.001365483971312642
2023-05-26 11:49:47 testing...
The modified gen p mean: 0.449090838432312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03192614018917084, decouple_loss:0.0016185343265533447
The modified gen p mean: 0.4491901397705078, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03346134349703789, decouple_loss:0.001582865952514112
The modified gen p mean: 0.4473910629749298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032142169773578644, decouple_loss:0.0015395876253023744
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0325889028608799, avg_mse: 0.04390567168593407
current test mse: 0.043906
Iteration: 1241, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44558870792388916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03260219842195511, decouple_loss:0.001471449970267713
The modified gen p mean: 0.44967368245124817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03185023367404938, decouple_loss:0.0016157252248376608
The modified gen p mean: 0.4468160569667816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0339190810918808, decouple_loss:0.0015330679016187787
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1242, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44687530398368835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027902737259864807, decouple_loss:0.0014243775513023138
The modified gen p mean: 0.45015469193458557, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4483603537082672, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028010282665491104, decouple_loss:0.0013848039088770747loss_pred:0.029705364257097244, decouple_loss:0.001700670807622373
Iteration: 1243, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45028072595596313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02821299061179161, decouple_loss:0.0015076525742188096
The modified gen p mean: 0.44927966594696045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029346778988838196, decouple_loss:0.001735336845740676
The modified gen p mean: 0.4486357867717743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02912469580769539, decouple_loss:0.0015206143725663424
Iteration: 1244, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44815441966056824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02796836569905281, decouple_loss:0.0014395239995792508
The modified gen p mean: 0.4460904896259308, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02940480411052704, decouple_loss:0.0014282746706157923
The modified gen p mean: 0.4465193450450897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028597721830010414, decouple_loss:0.0015800506807863712
Iteration: 1245, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44598588347435, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4464990794658661, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029596472159028053, decouple_loss:0.0013905367814004421
loss_pred:0.027655432000756264, decouple_loss:0.0014812168665230274
The modified gen p mean: 0.4463847279548645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029844341799616814, decouple_loss:0.0015179854817688465
Iteration: 1246, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44349241256713867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0287996344268322, decouple_loss:0.001557383220642805
The modified gen p mean: 0.44776269793510437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029545774683356285, decouple_loss:0.001542691607028246
The modified gen p mean: 0.44687169790267944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028034579008817673, decouple_loss:0.0015216805040836334
Iteration: 1247, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444907307624817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02972707524895668, decouple_loss:0.001561626442708075
The modified gen p mean: 0.4454443156719208, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027954580262303352, decouple_loss:0.0014913880731910467
The modified gen p mean: 0.447408527135849, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027922041714191437, decouple_loss:0.0014562441501766443
Iteration: 1248, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4429223835468292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027683958411216736, decouple_loss:0.0013502812944352627
The modified gen p mean: 0.4421350955963135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03019433468580246, decouple_loss:0.0014504353748634458
The modified gen p mean: 0.4434918463230133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02967335470020771, decouple_loss:0.0015599007019773126
Iteration: 1249, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44444677233695984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02971688285470009, decouple_loss:0.001495054573751986
The modified gen p mean: 0.4413410425186157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029600806534290314, decouple_loss:0.0014846974518150091
The modified gen p mean: 0.4428817927837372, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028756383806467056, decouple_loss:0.0014490956673398614
Iteration: 1250, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4401414692401886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029729653149843216, decouple_loss:0.001547650434076786
The modified gen p mean: 0.44393154978752136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0275063868612051, decouple_loss:0.001765175024047494
The modified gen p mean: 0.4412586987018585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028237804770469666, decouple_loss:0.0014742430066689849
2023-05-26 11:54:30 testing...
The modified gen p mean: 0.4478425979614258, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03231465443968773, decouple_loss:0.0016757859848439693
The modified gen p mean: 0.44777950644493103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03378155082464218, decouple_loss:0.001666584168560803
The modified gen p mean: 0.4460409879684448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0325067900121212, decouple_loss:0.0015260346699506044
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0329488068819046, avg_mse: 0.044510215520858765
current test mse: 0.04451
Iteration: 1251, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44263333082199097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02922825515270233, decouple_loss:0.0014843487879261374
The modified gen p mean: 0.4458117187023163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02946571074426174, decouple_loss:0.00187800417188555
The modified gen p mean: 0.4451437294483185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028392210602760315, decouple_loss:0.0015217260224744678
Iteration: 1252, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477039575576782, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027991944923996925, decouple_loss:0.0016771648079156876
The modified gen p mean: 0.4452711045742035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02692488580942154, decouple_loss:0.001736553036607802
The modified gen p mean: 0.44651323556900024, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028525691479444504, decouple_loss:0.0020196710247546434
Iteration: 1253, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486176073551178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029317691922187805, decouple_loss:0.0016155327903106809
The modified gen p mean: 0.4474908709526062, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028790183365345, decouple_loss:0.0016184973064810038
The modified gen p mean: 0.44968464970588684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027998091652989388, decouple_loss:0.0016210146714001894
Iteration: 1254, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448759526014328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028410181403160095, decouple_loss:0.001810997142456472
The modified gen p mean: 0.4477156102657318, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02940204180777073, decouple_loss:0.0014656282728537917
The modified gen p mean: 0.44905126094818115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027256056666374207, decouple_loss:0.0015392102068290114
Iteration: 1255, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44847458600997925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029199685901403427, decouple_loss:0.0017399057978764176
The modified gen p mean: 0.4495270848274231, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026684332638978958, decouple_loss:0.0015483550960198045
The modified gen p mean: 0.4479021430015564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028868870809674263, decouple_loss:0.0014877754729241133
Iteration: 1256, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449460506439209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02887885831296444, decouple_loss:0.0015135062858462334
The modified gen p mean: 0.4454374611377716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02881995402276516, decouple_loss:0.0015434437664225698
The modified gen p mean: 0.44758325815200806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029763877391815186, decouple_loss:0.001614689244888723
Iteration: 1257, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469456374645233, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4518461525440216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029017511755228043, decouple_loss:0.0014436447527259588
loss_pred:0.026673365384340286, decouple_loss:0.0017169594066217542
The modified gen p mean: 0.45177263021469116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028676148504018784, decouple_loss:0.001735856756567955
Iteration: 1258, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485578238964081, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029147762805223465, decouple_loss:0.0014126505702733994
The modified gen p mean: 0.4458426535129547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028645126149058342, decouple_loss:0.001489782938733697
The modified gen p mean: 0.450565367937088, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02743983082473278, decouple_loss:0.0016287867911159992
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1259, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481525421142578, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03513328731060028, decouple_loss:0.0014841759111732244
The modified gen p mean: 0.4512355327606201, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4463900029659271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03511375933885574, decouple_loss:0.001624888158403337
loss_pred:0.03463635966181755, decouple_loss:0.0017412904417142272
Iteration: 1260, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506090581417084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03561097010970116, decouple_loss:0.001739072729833424
The modified gen p mean: 0.45073381066322327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034746069461107254, decouple_loss:0.001723022316582501
The modified gen p mean: 0.4486068785190582, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0342249795794487, decouple_loss:0.001581832766532898
2023-05-26 11:59:17 testing...
The modified gen p mean: 0.4523446559906006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03273645415902138, decouple_loss:0.0017022660467773676
The modified gen p mean: 0.4505034387111664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03286788985133171, decouple_loss:0.001597914844751358
The modified gen p mean: 0.4522331655025482, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03407226875424385, decouple_loss:0.0017172533553093672
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03330916166305542, avg_mse: 0.04509245231747627
current test mse: 0.045092
Iteration: 1261, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465617835521698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034961942583322525, decouple_loss:0.00160428776871413
The modified gen p mean: 0.44653597474098206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03744553029537201, decouple_loss:0.001546032028272748
The modified gen p mean: 0.4474371075630188, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03587950021028519, decouple_loss:0.0016953416634351015
Iteration: 1262, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4530404508113861, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03497784957289696, decouple_loss:0.0016850045649334788
The modified gen p mean: 0.44856351613998413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03456798940896988, decouple_loss:0.001881362753920257
The modified gen p mean: 0.4510525166988373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03722652047872543, decouple_loss:0.001684586750343442
Iteration: 1263, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4538562595844269, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033590156584978104, decouple_loss:0.0017129668267443776
The modified gen p mean: 0.4524146318435669, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03422218933701515, decouple_loss:0.0016157036880031228
The modified gen p mean: 0.45270368456840515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03466970473527908, decouple_loss:0.0017496352083981037
Iteration: 1264, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45218074321746826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035179246217012405, decouple_loss:0.0015125989448279142
The modified gen p mean: 0.4536741375923157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03492138162255287, decouple_loss:0.0015565352514386177
The modified gen p mean: 0.4541495442390442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03720148280262947, decouple_loss:0.0016078652115538716
Iteration: 1265, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4542563259601593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031600940972566605, decouple_loss:0.001557281007990241
The modified gen p mean: 0.4516685903072357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03620436415076256, decouple_loss:0.0016521259676665068
The modified gen p mean: 0.4510936737060547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035473208874464035, decouple_loss:0.0014900353271514177
Iteration: 1266, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503442049026489, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45146867632865906, gen p mean: 0.0, mean p set: 0.448loss_pred:0.03554343804717064, decouple_loss:0.0016040363116189837
loss_pred:0.03529583662748337, decouple_loss:0.0016751630464568734
The modified gen p mean: 0.450800359249115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03374512121081352, decouple_loss:0.0015965220518410206
Iteration: 1267, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509675204753876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034177377820014954, decouple_loss:0.0016888794489204884
The modified gen p mean: 0.45133283734321594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03379655256867409, decouple_loss:0.0014471636386588216
The modified gen p mean: 0.45117834210395813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0346243679523468, decouple_loss:0.0014967357274144888
Iteration: 1268, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44585809111595154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032625019550323486, decouple_loss:0.0015002392465248704
The modified gen p mean: 0.4467279016971588, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03459206596016884, decouple_loss:0.0016387744108214974
The modified gen p mean: 0.4502173960208893, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03381471708416939, decouple_loss:0.0015493956161662936
Iteration: 1269, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484410583972931, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03575387969613075, decouple_loss:0.001487611560150981
The modified gen p mean: 0.4492809474468231, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03500941023230553, decouple_loss:0.0016601262614130974
The modified gen p mean: 0.44669249653816223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03410004451870918, decouple_loss:0.0014888901496306062
Iteration: 1270, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44659706950187683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030921565368771553, decouple_loss:0.001526766107417643
The modified gen p mean: 0.44369596242904663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03359523043036461, decouple_loss:0.0014955655205994844
The modified gen p mean: 0.4423217475414276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033068347722291946, decouple_loss:0.0013906521489843726
2023-05-26 12:03:24 testing...
The modified gen p mean: 0.44818374514579773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03216470777988434, decouple_loss:0.0016413151752203703
The modified gen p mean: 0.44833847880363464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0335099920630455, decouple_loss:0.0017028588335961103
The modified gen p mean: 0.44688230752944946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230573982000351, decouple_loss:0.0015832999488338828
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032742273062467575, avg_mse: 0.044080860912799835
current test mse: 0.044081
Iteration: 1271, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44321462512016296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03368031606078148, decouple_loss:0.0013937342446297407
The modified gen p mean: 0.44787725806236267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03229431062936783, decouple_loss:0.0016265215817838907
The modified gen p mean: 0.4423731565475464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03317353501915932, decouple_loss:0.0014767906395718455
Iteration: 1272, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445839524269104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03445272147655487, decouple_loss:0.0015772769693285227
The modified gen p mean: 0.4479701817035675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034104932099580765, decouple_loss:0.0017101735575124621
The modified gen p mean: 0.44772279262542725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03271612152457237, decouple_loss:0.0013287015026435256
Iteration: 1273, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44583064317703247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031770944595336914, decouple_loss:0.0014309585094451904
The modified gen p mean: 0.448539137840271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035315997898578644, decouple_loss:0.0013446395751088858
The modified gen p mean: 0.44540759921073914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033588360995054245, decouple_loss:0.0013564913533627987
Iteration: 1274, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44542205333709717, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03473854809999466, decouple_loss:0.0014402491506189108
The modified gen p mean: 0.45028233528137207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035479847341775894, decouple_loss:0.001383170485496521
The modified gen p mean: 0.44936326146125793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03554477542638779, decouple_loss:0.0015420992858707905
Iteration: 1275, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446113646030426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03403085470199585, decouple_loss:0.0012999295722693205
The modified gen p mean: 0.44767123460769653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0336417593061924, decouple_loss:0.0013447911478579044
The modified gen p mean: 0.4495849907398224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032879892736673355, decouple_loss:0.0016358491266146302
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr.npz
NaN value num: 0
Iteration: 1276, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478951096534729, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029586900025606155, decouple_loss:0.0013892845017835498
The modified gen p mean: 0.4488131105899811, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44760552048683167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029105739668011665, decouple_loss:0.0016239642864093184
loss_pred:0.028834722936153412, decouple_loss:0.0014432574389502406
Iteration: 1277, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44831135869026184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02836715057492256, decouple_loss:0.0015013515949249268
The modified gen p mean: 0.4492233395576477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027699273079633713, decouple_loss:0.0015096374554559588
The modified gen p mean: 0.44961658120155334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029629625380039215, decouple_loss:0.0014773905277252197
Iteration: 1278, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447284072637558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028895296156406403, decouple_loss:0.0015045159962028265
The modified gen p mean: 0.4497986435890198, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02968468889594078, decouple_loss:0.0014993485528975725
The modified gen p mean: 0.44837233424186707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028108639642596245, decouple_loss:0.0016221400583162904
Iteration: 1279, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44969695806503296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029910173267126083, decouple_loss:0.0015792669728398323
The modified gen p mean: 0.44627857208251953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027455955743789673, decouple_loss:0.001628125668503344
The modified gen p mean: 0.44969475269317627, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029133908450603485, decouple_loss:0.0015983214834704995
Iteration: 1280, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44605663418769836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02872510440647602, decouple_loss:0.0015926712658256292
The modified gen p mean: 0.4475322663784027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02829146943986416, decouple_loss:0.001438741572201252
The modified gen p mean: 0.4459287226200104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02871698886156082, decouple_loss:0.0015194376464933157
2023-05-26 12:08:08 testing...
The modified gen p mean: 0.452345609664917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0320470929145813, decouple_loss:0.0015562560874968767
The modified gen p mean: 0.45100048184394836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03221893310546875, decouple_loss:0.0014285064535215497
The modified gen p mean: 0.45270782709121704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0334385447204113, decouple_loss:0.001559681724756956
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03264393284916878, avg_mse: 0.04401659965515137
current test mse: 0.044017
Iteration: 1281, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505045413970947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028929729014635086, decouple_loss:0.001633409527130425
The modified gen p mean: 0.4500640630722046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02908194623887539, decouple_loss:0.0015529888914898038
The modified gen p mean: 0.44774627685546875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02788032591342926, decouple_loss:0.0015061383601278067
Iteration: 1282, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474828839302063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02856544591486454, decouple_loss:0.0017402106896042824
The modified gen p mean: 0.4469689726829529, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030393151566386223, decouple_loss:0.0016719249542802572
The modified gen p mean: 0.4453052878379822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029627449810504913, decouple_loss:0.0015757399378344417
Iteration: 1283, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477957785129547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02693610079586506, decouple_loss:0.0015719524817541242
The modified gen p mean: 0.45069465041160583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027808431535959244, decouple_loss:0.0014359719352796674
The modified gen p mean: 0.44788095355033875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02876971662044525, decouple_loss:0.001709659700281918
Iteration: 1284, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44827279448509216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02780739963054657, decouple_loss:0.0016832302790135145
The modified gen p mean: 0.4459090828895569, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027503561228513718, decouple_loss:0.0016909425612539053
The modified gen p mean: 0.4450733959674835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030123215168714523, decouple_loss:0.0014869343722239137
Iteration: 1285, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44581010937690735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028300631791353226, decouple_loss:0.0013569481670856476
The modified gen p mean: 0.44862428307533264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02787730284035206, decouple_loss:0.0016739163547754288
The modified gen p mean: 0.44774359464645386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02718682587146759, decouple_loss:0.001590936561115086
Iteration: 1286, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44489586353302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02935061976313591, decouple_loss:0.0014748485991731286
The modified gen p mean: 0.4434356689453125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028270909562706947, decouple_loss:0.0013966802507638931
The modified gen p mean: 0.44717496633529663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028735965490341187, decouple_loss:0.0019086977699771523
Iteration: 1287, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466921091079712, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028382079675793648, decouple_loss:0.0015518271829932928
The modified gen p mean: 0.44402217864990234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02777809090912342, decouple_loss:0.0016412304248660803
The modified gen p mean: 0.44599276781082153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027189383283257484, decouple_loss:0.001743111526593566
Iteration: 1288, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44738709926605225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027186082676053047, decouple_loss:0.0015746848657727242
The modified gen p mean: 0.44418567419052124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02777947671711445, decouple_loss:0.0015710009029135108
The modified gen p mean: 0.44555866718292236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027911214157938957, decouple_loss:0.001719674444757402
Iteration: 1289, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44392845034599304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028949784114956856, decouple_loss:0.0017491260077804327
The modified gen p mean: 0.44322922825813293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02865362912416458, decouple_loss:0.0016071287682279944
The modified gen p mean: 0.4434800446033478, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02844240702688694, decouple_loss:0.0015139998868107796
Iteration: 1290, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44857704639434814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026594826951622963, decouple_loss:0.001652487670071423
The modified gen p mean: 0.44842836260795593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026570670306682587, decouple_loss:0.0016075766179710627
The modified gen p mean: 0.4461964964866638, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026933614164590836, decouple_loss:0.0019267862662672997
2023-05-26 12:12:13 testing...
The modified gen p mean: 0.45161351561546326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251045197248459, decouple_loss:0.0016570185543969274
The modified gen p mean: 0.4499152600765228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03269442915916443, decouple_loss:0.0015509764198213816
The modified gen p mean: 0.45193159580230713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0339122973382473, decouple_loss:0.0016777081182226539
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03312049061059952, avg_mse: 0.04492758587002754
current test mse: 0.044928
Iteration: 1291, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468567371368408, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02912876196205616, decouple_loss:0.0017087927553802729
The modified gen p mean: 0.45110464096069336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026772601529955864, decouple_loss:0.0015606425004079938
The modified gen p mean: 0.44801828265190125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026261907070875168, decouple_loss:0.001472880132496357
Iteration: 1292, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455069899559021, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029203251004219055, decouple_loss:0.0015483233146369457
The modified gen p mean: 0.4494328796863556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02789568528532982, decouple_loss:0.0015776858199387789
The modified gen p mean: 0.45022839307785034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026974745094776154, decouple_loss:0.0018449581693857908
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1293, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485713243484497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02950739488005638, decouple_loss:0.0016308368649333715
The modified gen p mean: 0.44757771492004395, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44929927587509155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031212011352181435, decouple_loss:0.001943110371939838
loss_pred:0.030236801132559776, decouple_loss:0.0015221918001770973
Iteration: 1294, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491046369075775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03106536529958248, decouple_loss:0.001804885920137167
The modified gen p mean: 0.45622530579566956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030939865857362747, decouple_loss:0.0016881064511835575
The modified gen p mean: 0.45103955268859863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029619090259075165, decouple_loss:0.0016308824997395277
Iteration: 1295, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4536161422729492, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029600046575069427, decouple_loss:0.0016150041483342648
The modified gen p mean: 0.45272234082221985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03181542828679085, decouple_loss:0.001448692288249731
The modified gen p mean: 0.45344310998916626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030732247978448868, decouple_loss:0.0016065153758972883
Iteration: 1296, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45391321182250977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02910400927066803, decouple_loss:0.0015819142572581768
The modified gen p mean: 0.45120471715927124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02954133413732052, decouple_loss:0.0014913456980139017
The modified gen p mean: 0.4529511034488678, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030906934291124344, decouple_loss:0.0014726740773767233
Iteration: 1297, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45680299401283264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029866080731153488, decouple_loss:0.0014672571560367942
The modified gen p mean: 0.4508223831653595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029444368556141853, decouple_loss:0.0014687060611322522
The modified gen p mean: 0.4506714344024658, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02989838272333145, decouple_loss:0.0016697811661288142
Iteration: 1298, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4533631205558777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03068554773926735, decouple_loss:0.0016785026527941227
The modified gen p mean: 0.45412570238113403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03030235879123211, decouple_loss:0.0015142821939662099
The modified gen p mean: 0.45427972078323364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030914027243852615, decouple_loss:0.0016674865037202835
Iteration: 1299, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494730532169342, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02870226837694645, decouple_loss:0.0014640940353274345
The modified gen p mean: 0.45451876521110535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03022783435881138, decouple_loss:0.0015477928100153804
The modified gen p mean: 0.45304805040359497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028605109080672264, decouple_loss:0.0014086213195696473
Iteration: 1300, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45138221979141235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029300525784492493, decouple_loss:0.0014321147464215755
The modified gen p mean: 0.4485319256782532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03003856912255287, decouple_loss:0.001709233969449997
The modified gen p mean: 0.4535313546657562, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028424838557839394, decouple_loss:0.0015924801118671894
2023-05-26 12:17:01 testing...
The modified gen p mean: 0.4528322219848633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032485656440258026, decouple_loss:0.0017215828411281109
The modified gen p mean: 0.45097634196281433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03263918682932854, decouple_loss:0.0015944873448461294
The modified gen p mean: 0.45287981629371643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03387971594929695, decouple_loss:0.0017168765189126134
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033085402101278305, avg_mse: 0.04466838762164116
current test mse: 0.044668
Iteration: 1301, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446856826543808, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02939668484032154, decouple_loss:0.0015623968793079257
The modified gen p mean: 0.44958415627479553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028419435024261475, decouple_loss:0.0015824827132746577
The modified gen p mean: 0.450162798166275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02967044711112976, decouple_loss:0.0017115618102252483
Iteration: 1302, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45109134912490845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027866635471582413, decouple_loss:0.00164015032351017
The modified gen p mean: 0.4482303857803345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02850143238902092, decouple_loss:0.0016817200230434537
The modified gen p mean: 0.44958043098449707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0281123798340559, decouple_loss:0.001778096309863031
Iteration: 1303, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503542482852936, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4459065794944763, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02900851145386696, decouple_loss:0.0017919954843819141
loss_pred:0.029785271733999252, decouple_loss:0.0019002367043867707
The modified gen p mean: 0.44521835446357727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0296078622341156, decouple_loss:0.0015065656043589115
Iteration: 1304, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462953805923462, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029336286708712578, decouple_loss:0.0016997220227494836
The modified gen p mean: 0.44841745495796204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029229020699858665, decouple_loss:0.0016672307392582297
The modified gen p mean: 0.4450503885746002, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029922928661108017, decouple_loss:0.0014945995062589645
Iteration: 1305, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44751232862472534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03119305893778801, decouple_loss:0.0015994423301890492
The modified gen p mean: 0.4498690366744995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028214404359459877, decouple_loss:0.0015627427492290735
The modified gen p mean: 0.44531211256980896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028514143079519272, decouple_loss:0.0016128167044371367
Iteration: 1306, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44973045587539673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026623662561178207, decouple_loss:0.0016916139284148812
The modified gen p mean: 0.4449930787086487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029464291408658028, decouple_loss:0.0016104483511298895
The modified gen p mean: 0.44636398553848267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030560730025172234, decouple_loss:0.0015803553396835923
Iteration: 1307, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489215612411499, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02977006882429123, decouple_loss:0.001605117809958756
The modified gen p mean: 0.44796842336654663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029470840469002724, decouple_loss:0.001864867634139955
The modified gen p mean: 0.45245832204818726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028193071484565735, decouple_loss:0.0017277247970923781
Iteration: 1308, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492933452129364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027789702638983727, decouple_loss:0.0016907156677916646
The modified gen p mean: 0.4477384090423584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02798183262348175, decouple_loss:0.0015236572362482548
The modified gen p mean: 0.45334285497665405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028659554198384285, decouple_loss:0.0017574609955772758
Iteration: 1309, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44777706265449524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026733610779047012, decouple_loss:0.0016187916044145823
The modified gen p mean: 0.45013678073883057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029698245227336884, decouple_loss:0.0017043750267475843
The modified gen p mean: 0.45057427883148193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028078101575374603, decouple_loss:0.0016682028071954846
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr.npz
NaN value num: 0
Iteration: 1310, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4535035789012909, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03269767761230469, decouple_loss:0.001954832812771201
The modified gen p mean: 0.45200181007385254, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44667088985443115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035044509917497635, decouple_loss:0.0018098123837262392
loss_pred:0.03132236376404762, decouple_loss:0.001763931824825704
2023-05-26 12:21:43 testing...
The modified gen p mean: 0.45433127880096436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032769110053777695, decouple_loss:0.001810066169127822
The modified gen p mean: 0.45224401354789734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03298893943428993, decouple_loss:0.0016383682377636433
The modified gen p mean: 0.45412492752075195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03433993458747864, decouple_loss:0.0017837844789028168
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03345319628715515, avg_mse: 0.0452832467854023
current test mse: 0.045283
Iteration: 1311, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472092092037201, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03376854956150055, decouple_loss:0.0016461972845718265
The modified gen p mean: 0.4525441527366638, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03241697698831558, decouple_loss:0.0017125962767750025
The modified gen p mean: 0.45201992988586426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03271026164293289, decouple_loss:0.0017286703223362565
Iteration: 1312, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485105574131012, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03281096741557121, decouple_loss:0.001519549172371626
The modified gen p mean: 0.4481638967990875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03295193985104561, decouple_loss:0.001572286244481802
The modified gen p mean: 0.45030415058135986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031683407723903656, decouple_loss:0.0016746069304645061
Iteration: 1313, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45291587710380554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03309633955359459, decouple_loss:0.0015189674450084567
The modified gen p mean: 0.45023274421691895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0325903557240963, decouple_loss:0.0014884225092828274
The modified gen p mean: 0.45106178522109985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03169681876897812, decouple_loss:0.001531432499177754
Iteration: 1314, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508076608181, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031571075320243835, decouple_loss:0.0016147848218679428
The modified gen p mean: 0.45045122504234314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033263422548770905, decouple_loss:0.0017398972995579243
The modified gen p mean: 0.45747479796409607, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03216944634914398, decouple_loss:0.0015784880379214883
Iteration: 1315, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45283809304237366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03208128735423088, decouple_loss:0.0014558685943484306
The modified gen p mean: 0.4566757082939148, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03455638140439987, decouple_loss:0.0019244151189923286
The modified gen p mean: 0.45221182703971863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03377396613359451, decouple_loss:0.001541593112051487
Iteration: 1316, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4520920515060425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251272439956665, decouple_loss:0.001526379375718534
The modified gen p mean: 0.4522458016872406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0332275927066803, decouple_loss:0.0017088273307308555
The modified gen p mean: 0.4540145695209503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031874388456344604, decouple_loss:0.001604453194886446
Iteration: 1317, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45106014609336853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230999410152435, decouple_loss:0.0016582447569817305
The modified gen p mean: 0.4521554708480835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034296296536922455, decouple_loss:0.0014565786113962531
The modified gen p mean: 0.45062533020973206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03281541168689728, decouple_loss:0.0015602263156324625
Iteration: 1318, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44913578033447266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03314017131924629, decouple_loss:0.001424515387043357
The modified gen p mean: 0.45360514521598816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032602664083242416, decouple_loss:0.0015201547648757696
The modified gen p mean: 0.4508160352706909, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032659705728292465, decouple_loss:0.0016596709610894322
Iteration: 1319, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494917094707489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03345928713679314, decouple_loss:0.0017858545761555433
The modified gen p mean: 0.45197030901908875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031414926052093506, decouple_loss:0.00160980352666229
The modified gen p mean: 0.45066335797309875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03027348779141903, decouple_loss:0.0015307501889765263
Iteration: 1320, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462311863899231, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03250313550233841, decouple_loss:0.001570572261698544
The modified gen p mean: 0.4498133361339569, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03200819343328476, decouple_loss:0.0016643960261717439
The modified gen p mean: 0.4520008862018585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0311629269272089, decouple_loss:0.0015369766624644399
2023-05-26 12:25:47 testing...
The modified gen p mean: 0.4497893452644348, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03229183703660965, decouple_loss:0.0016275823581963778
The modified gen p mean: 0.4480414092540741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03243992105126381, decouple_loss:0.0015084859915077686
The modified gen p mean: 0.4496685564517975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03404189646244049, decouple_loss:0.001609964296221733
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03300365433096886, avg_mse: 0.04448356479406357
current test mse: 0.044484
Iteration: 1321, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491584002971649, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032956693321466446, decouple_loss:0.001550627639517188
The modified gen p mean: 0.44476455450057983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03317170590162277, decouple_loss:0.0015805468428879976
The modified gen p mean: 0.4455089867115021, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032592203468084335, decouple_loss:0.0017418749630451202
Iteration: 1322, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44561779499053955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03288384899497032, decouple_loss:0.0017524249851703644
The modified gen p mean: 0.4487210214138031, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259197995066643, decouple_loss:0.0016959636704996228
The modified gen p mean: 0.4445207118988037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03241298347711563, decouple_loss:0.0014700720785185695
Iteration: 1323, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44694191217422485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031852420419454575, decouple_loss:0.0016226591542363167
The modified gen p mean: 0.4437675476074219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03164253011345863, decouple_loss:0.0013989012222737074
The modified gen p mean: 0.4452931880950928, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03185810148715973, decouple_loss:0.0015106985811144114
Iteration: 1324, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45054182410240173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032562095671892166, decouple_loss:0.0016041183844208717
The modified gen p mean: 0.44562968611717224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03177255764603615, decouple_loss:0.00137336493935436
The modified gen p mean: 0.4500163793563843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03273843601346016, decouple_loss:0.0017211275408044457
Iteration: 1325, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478343427181244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030705558136105537, decouple_loss:0.0013911082642152905
The modified gen p mean: 0.44753482937812805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034022748470306396, decouple_loss:0.001519734039902687
The modified gen p mean: 0.4527471959590912, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03422882407903671, decouple_loss:0.0015847883187234402
Iteration: 1326, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491382837295532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03381401300430298, decouple_loss:0.0016192629700526595
The modified gen p mean: 0.44937020540237427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03376201540231705, decouple_loss:0.0016184374690055847
The modified gen p mean: 0.4497985541820526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03359220176935196, decouple_loss:0.0014788559637963772
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1327, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45123299956321716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03066559135913849, decouple_loss:0.0014157412806525826
The modified gen p mean: 0.4496626555919647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029580071568489075, decouple_loss:0.0014756660675629973
The modified gen p mean: 0.4532727599143982, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029769500717520714, decouple_loss:0.0015785665018483996
Iteration: 1328, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4539121687412262, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02853401191532612, decouple_loss:0.0015441067516803741
The modified gen p mean: 0.45285630226135254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030645964667201042, decouple_loss:0.001944007002748549
The modified gen p mean: 0.44990047812461853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031997762620449066, decouple_loss:0.0015685430262237787
Iteration: 1329, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44867396354675293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030872521921992302, decouple_loss:0.0014663853216916323
The modified gen p mean: 0.4483805298805237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03049486316740513, decouple_loss:0.0017094878712669015
The modified gen p mean: 0.4471331834793091, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028841862455010414, decouple_loss:0.0014530899934470654
Iteration: 1330, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44326120615005493, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02967691421508789, decouple_loss:0.0015801605768501759
The modified gen p mean: 0.44569823145866394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030859919264912605, decouple_loss:0.0015213434817269444
The modified gen p mean: 0.44532889127731323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029320690780878067, decouple_loss:0.0015185551019385457
2023-05-26 12:30:29 testing...
The modified gen p mean: 0.44794437289237976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03222392871975899, decouple_loss:0.001679350738413632
The modified gen p mean: 0.4479985237121582, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03391361981630325, decouple_loss:0.0016002642223611474
The modified gen p mean: 0.4461417496204376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03227715939283371, decouple_loss:0.0015484819887205958
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032885368913412094, avg_mse: 0.044427428394556046
current test mse: 0.044427
Iteration: 1331, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471643269062042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03050851821899414, decouple_loss:0.0015155681176111102
The modified gen p mean: 0.4469790756702423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030428992584347725, decouple_loss:0.001739102997817099
The modified gen p mean: 0.44010114669799805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03005313128232956, decouple_loss:0.0013848468661308289
Iteration: 1332, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44918832182884216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030061785131692886, decouple_loss:0.0016435969155281782
The modified gen p mean: 0.4412018060684204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030610842630267143, decouple_loss:0.0015427632024511695
The modified gen p mean: 0.441941499710083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029557157307863235, decouple_loss:0.0014913043705746531
Iteration: 1333, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44654834270477295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03006545640528202, decouple_loss:0.0016315167304128408
The modified gen p mean: 0.4481700360774994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029915988445281982, decouple_loss:0.001960476627573371
The modified gen p mean: 0.4433461129665375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029977232217788696, decouple_loss:0.0014826299156993628
Iteration: 1334, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44551900029182434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02848459780216217, decouple_loss:0.0015853673685342073
The modified gen p mean: 0.44485077261924744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03017871454358101, decouple_loss:0.0014292593114078045
The modified gen p mean: 0.4472392201423645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02872391790151596, decouple_loss:0.0016615001950412989
Iteration: 1335, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44447270035743713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02996210940182209, decouple_loss:0.0016144022811204195
The modified gen p mean: 0.4473339319229126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0294574573636055, decouple_loss:0.001825476996600628
The modified gen p mean: 0.4409659802913666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03078239969909191, decouple_loss:0.0015917547279968858
Iteration: 1336, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44295281171798706, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4415837824344635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029683569446206093, decouple_loss:0.0015898490091785789
loss_pred:0.0301777683198452, decouple_loss:0.0017816360341385007
The modified gen p mean: 0.4490998685359955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02976609393954277, decouple_loss:0.0016429745592176914
Iteration: 1337, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439767599105835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02972312830388546, decouple_loss:0.0014071374898776412
The modified gen p mean: 0.4441891610622406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02889047935605049, decouple_loss:0.001551981782540679
The modified gen p mean: 0.44715988636016846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029033159837126732, decouple_loss:0.0015705471159890294
Iteration: 1338, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44600144028663635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029399679973721504, decouple_loss:0.001572220935486257
The modified gen p mean: 0.4491940140724182, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028723111376166344, decouple_loss:0.0015548617811873555
The modified gen p mean: 0.4502534866333008, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030417602509260178, decouple_loss:0.0018530270317569375
Iteration: 1339, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491705596446991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030400797724723816, decouple_loss:0.0017632233211770654
The modified gen p mean: 0.4446870684623718, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031150635331869125, decouple_loss:0.001585929887369275
The modified gen p mean: 0.44376546144485474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029637690633535385, decouple_loss:0.0015984646743163466
Iteration: 1340, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447116255760193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028955448418855667, decouple_loss:0.0015713030006736517
The modified gen p mean: 0.4437835216522217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030120206996798515, decouple_loss:0.0015500510344281793
The modified gen p mean: 0.4489063322544098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02917470410466194, decouple_loss:0.0018876357935369015
2023-05-26 12:34:35 testing...
The modified gen p mean: 0.4521799683570862, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032557178288698196, decouple_loss:0.0017323355423286557
The modified gen p mean: 0.4502059519290924, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.452073335647583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03269501030445099, decouple_loss:0.00159871531650424
loss_pred:0.03409098833799362, decouple_loss:0.001733715063892305
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03319880738854408, avg_mse: 0.04495621845126152
current test mse: 0.044956
Iteration: 1341, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4448772668838501, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029507020488381386, decouple_loss:0.001516152755357325
The modified gen p mean: 0.44505220651626587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02958694100379944, decouple_loss:0.0014887109864503145
The modified gen p mean: 0.4488157033920288, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029562026262283325, decouple_loss:0.0016688855830579996
Iteration: 1342, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45214056968688965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030474018305540085, decouple_loss:0.0016496394528076053
The modified gen p mean: 0.4522668123245239, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030099591240286827, decouple_loss:0.001513817347586155
The modified gen p mean: 0.4463566839694977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028603488579392433, decouple_loss:0.0015214129816740751
Iteration: 1343, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44648468494415283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02931850403547287, decouple_loss:0.0014757345197722316
The modified gen p mean: 0.4537200927734375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028792131692171097, decouple_loss:0.0021076814737170935
The modified gen p mean: 0.44693523645401, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030604824423789978, decouple_loss:0.0014901962131261826
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr.npz
NaN value num: 0
Iteration: 1344, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44828033447265625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034557417035102844, decouple_loss:0.0016127453418448567
The modified gen p mean: 0.44666600227355957, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4461589753627777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03425772115588188, decouple_loss:0.0015602883649989963
loss_pred:0.03194728493690491, decouple_loss:0.0015853313961997628
Iteration: 1345, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454730153083801, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03203354775905609, decouple_loss:0.0016097510233521461
The modified gen p mean: 0.44715824723243713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03262956812977791, decouple_loss:0.0015537377912551165
The modified gen p mean: 0.45158639550209045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0325930081307888, decouple_loss:0.0017702945042401552
Iteration: 1346, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476453959941864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03277610242366791, decouple_loss:0.0014874786138534546
The modified gen p mean: 0.4464162290096283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0328325554728508, decouple_loss:0.0016654006903991103
The modified gen p mean: 0.4503241777420044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03592773899435997, decouple_loss:0.0016364263137802482
Iteration: 1347, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493691027164459, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032763052731752396, decouple_loss:0.0015106973005458713
The modified gen p mean: 0.44996950030326843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03330729901790619, decouple_loss:0.0016255058581009507
The modified gen p mean: 0.4533523917198181, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034261442720890045, decouple_loss:0.0018229171400889754
Iteration: 1348, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482625722885132, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032282643020153046, decouple_loss:0.001551138935610652
The modified gen p mean: 0.44974592328071594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03252074122428894, decouple_loss:0.0016779607394710183
The modified gen p mean: 0.449020653963089, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03527803346514702, decouple_loss:0.0014865357661619782
Iteration: 1349, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45243018865585327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03351668268442154, decouple_loss:0.0014416163321584463
The modified gen p mean: 0.45011264085769653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03273705765604973, decouple_loss:0.0015622635837644339
The modified gen p mean: 0.4552948772907257, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033782295882701874, decouple_loss:0.0019309796625748277
Iteration: 1350, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4536745250225067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033871281892061234, decouple_loss:0.001583198900334537
The modified gen p mean: 0.4531904458999634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03222476691007614, decouple_loss:0.0016305706230923533
The modified gen p mean: 0.4522329568862915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034644272178411484, decouple_loss:0.0016513417940586805
2023-05-26 12:39:21 testing...
The modified gen p mean: 0.45383352041244507, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032561641186475754, decouple_loss:0.001757476944476366
The modified gen p mean: 0.4536241590976715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03389967605471611, decouple_loss:0.0017263471381738782
The modified gen p mean: 0.451917439699173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032625168561935425, decouple_loss:0.0016815739218145609
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03311492130160332, avg_mse: 0.04474629461765289
current test mse: 0.044746
Iteration: 1351, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45158401131629944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03190135955810547, decouple_loss:0.0016781272133812308
The modified gen p mean: 0.4514986574649811, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03200571611523628, decouple_loss:0.0015243989182636142
The modified gen p mean: 0.44769805669784546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032738346606492996, decouple_loss:0.001488705980591476
Iteration: 1352, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44837498664855957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03219032287597656, decouple_loss:0.0015999714378267527
The modified gen p mean: 0.45159077644348145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0327887088060379, decouple_loss:0.0015861326828598976
The modified gen p mean: 0.447581946849823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031187476590275764, decouple_loss:0.0014778979821130633
Iteration: 1353, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498851001262665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032668065279722214, decouple_loss:0.0015352535992860794
The modified gen p mean: 0.44670528173446655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03390626981854439, decouple_loss:0.001549053704366088
The modified gen p mean: 0.44627058506011963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03245484083890915, decouple_loss:0.0015744257252663374
Iteration: 1354, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480244815349579, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031556811183691025, decouple_loss:0.0016185741405934095
The modified gen p mean: 0.44815269112586975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0321209691464901, decouple_loss:0.0015123272314667702
The modified gen p mean: 0.4446689486503601, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03438280522823334, decouple_loss:0.0015002201544120908
Iteration: 1355, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44896119832992554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03344867005944252, decouple_loss:0.0016276988899335265
The modified gen p mean: 0.44323664903640747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03473358228802681, decouple_loss:0.0015410546911880374
The modified gen p mean: 0.4493389427661896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03280799090862274, decouple_loss:0.0016922333743423223
Iteration: 1356, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489613473415375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029837124049663544, decouple_loss:0.001478909864090383
The modified gen p mean: 0.4478200376033783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03195302560925484, decouple_loss:0.0016410753596574068
The modified gen p mean: 0.4476239085197449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0329994298517704, decouple_loss:0.001441120752133429
Iteration: 1357, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44967833161354065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03250792622566223, decouple_loss:0.0015247941482812166
The modified gen p mean: 0.44558313488960266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03353845700621605, decouple_loss:0.0014181981096044183
The modified gen p mean: 0.44622325897216797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033779751509428024, decouple_loss:0.0014798600459471345
Iteration: 1358, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484376907348633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03301170840859413, decouple_loss:0.0016360346926376224
The modified gen p mean: 0.4502447545528412, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033583614975214005, decouple_loss:0.00153651915024966
The modified gen p mean: 0.44627347588539124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035111263394355774, decouple_loss:0.0016803686739876866
Iteration: 1359, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45281121134757996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03189956396818161, decouple_loss:0.0015717240748926997
The modified gen p mean: 0.4529847800731659, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033636048436164856, decouple_loss:0.0015212595462799072
The modified gen p mean: 0.4499170780181885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034568268805742264, decouple_loss:0.0015492772217839956
Iteration: 1360, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487389028072357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03276009112596512, decouple_loss:0.0014704512432217598
The modified gen p mean: 0.45297059416770935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03157329559326172, decouple_loss:0.0014787078835070133
The modified gen p mean: 0.4520389139652252, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030393444001674652, decouple_loss:0.0015300301602110267
2023-05-26 12:43:27 testing...
The modified gen p mean: 0.45431771874427795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03223704174160957, decouple_loss:0.0016019836766645312
The modified gen p mean: 0.4527091979980469, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4543839991092682, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230177238583565, decouple_loss:0.0015579244354739785
loss_pred:0.03352132439613342, decouple_loss:0.0016425931826233864
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03276675567030907, avg_mse: 0.04424406215548515
current test mse: 0.044244
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1361, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45032650232315063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02828723005950451, decouple_loss:0.0015155774308368564
The modified gen p mean: 0.4534973204135895, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4522967040538788, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028843943029642105, decouple_loss:0.0016370377270504832
loss_pred:0.027600765228271484, decouple_loss:0.0014933953061699867
Iteration: 1362, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465681314468384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030299954116344452, decouple_loss:0.0013523352099582553
The modified gen p mean: 0.4520832598209381, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028555020689964294, decouple_loss:0.0015853227814659476
The modified gen p mean: 0.4503891170024872, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030304962769150734, decouple_loss:0.0015068256761878729
Iteration: 1363, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486948549747467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028563225641846657, decouple_loss:0.001499267527833581
The modified gen p mean: 0.45084404945373535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02859812043607235, decouple_loss:0.0015447442419826984
The modified gen p mean: 0.4474680721759796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028050774708390236, decouple_loss:0.0016209036111831665
Iteration: 1364, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499233067035675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02780035324394703, decouple_loss:0.0015390313928946853
The modified gen p mean: 0.4458881616592407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029141845181584358, decouple_loss:0.0015597967430949211
The modified gen p mean: 0.44655272364616394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029733680188655853, decouple_loss:0.0015128293307498097
Iteration: 1365, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478795528411865, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4437835216522217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028533460572361946, decouple_loss:0.0014993279473856091
loss_pred:0.029235053807497025, decouple_loss:0.001626084791496396
The modified gen p mean: 0.4430670738220215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03020593523979187, decouple_loss:0.0015660995850339532
Iteration: 1366, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44390982389450073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030540267005562782, decouple_loss:0.001386794145219028
The modified gen p mean: 0.44475865364074707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028583865612745285, decouple_loss:0.0016788300126791
The modified gen p mean: 0.44535011053085327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028974123299121857, decouple_loss:0.0014935489743947983
Iteration: 1367, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44364693760871887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027948390692472458, decouple_loss:0.0013994199689477682
The modified gen p mean: 0.44292986392974854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027997756376862526, decouple_loss:0.0015277250204235315
The modified gen p mean: 0.4506516456604004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028030242770910263, decouple_loss:0.0015245977556332946
Iteration: 1368, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4435265064239502, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02947899140417576, decouple_loss:0.0016308770282194018
The modified gen p mean: 0.4505956768989563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028023434802889824, decouple_loss:0.001689248369075358
The modified gen p mean: 0.4490359127521515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027993813157081604, decouple_loss:0.0019791917875409126
Iteration: 1369, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44857293367385864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02836841344833374, decouple_loss:0.00161709263920784
The modified gen p mean: 0.44640108942985535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02832130342721939, decouple_loss:0.001598015776835382
The modified gen p mean: 0.44994407892227173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0280638225376606, decouple_loss:0.0017970431363210082
Iteration: 1370, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486324191093445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029050283133983612, decouple_loss:0.0018502817256376147
The modified gen p mean: 0.45168808102607727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028152691200375557, decouple_loss:0.0016636401414871216
The modified gen p mean: 0.4485459327697754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028212621808052063, decouple_loss:0.0019160424126312137
2023-05-26 12:48:11 testing...
The modified gen p mean: 0.4500023424625397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03236197680234909, decouple_loss:0.0017021551029756665
The modified gen p mean: 0.448211669921875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03252064064145088, decouple_loss:0.0015733990585431457
The modified gen p mean: 0.4500701427459717, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0336637981235981, decouple_loss:0.0017141143325716257
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032931968569755554, avg_mse: 0.0445370152592659
current test mse: 0.044537
Iteration: 1371, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4424147605895996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02953842282295227, decouple_loss:0.0014537681126967072
The modified gen p mean: 0.4431571960449219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029004285112023354, decouple_loss:0.0016659966204315424
The modified gen p mean: 0.4444637894630432, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02915770933032036, decouple_loss:0.0014890175079926848
Iteration: 1372, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44214221835136414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029088124632835388, decouple_loss:0.001464418019168079
The modified gen p mean: 0.44083231687545776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028642911463975906, decouple_loss:0.0015044375322759151
The modified gen p mean: 0.44386807084083557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027097368612885475, decouple_loss:0.0016817849827930331
Iteration: 1373, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44363388419151306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820056490600109, decouple_loss:0.0016865992220118642
The modified gen p mean: 0.4403948485851288, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028698790818452835, decouple_loss:0.001362571376375854
The modified gen p mean: 0.44376352429389954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028727231547236443, decouple_loss:0.0016567406710237265
Iteration: 1374, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44198697805404663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028380775824189186, decouple_loss:0.0019011643016710877
The modified gen p mean: 0.44659289717674255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027689216658473015, decouple_loss:0.0014775064773857594
The modified gen p mean: 0.44197288155555725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027936888858675957, decouple_loss:0.0016243726713582873
Iteration: 1375, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4421299695968628, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028518259525299072, decouple_loss:0.00154494633898139
The modified gen p mean: 0.43995201587677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02914775162935257, decouple_loss:0.0016187707660719752
The modified gen p mean: 0.4403567612171173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02797161228954792, decouple_loss:0.0014705592766404152
Iteration: 1376, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4419705867767334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028453471139073372, decouple_loss:0.001619453658349812
The modified gen p mean: 0.4464685022830963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027107832953333855, decouple_loss:0.0015558477025479078
The modified gen p mean: 0.4418160021305084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02844761125743389, decouple_loss:0.0014448656002059579
Iteration: 1377, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4426749348640442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0282428078353405, decouple_loss:0.0018596157897263765
The modified gen p mean: 0.44438403844833374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02752005122601986, decouple_loss:0.0016305494355037808
The modified gen p mean: 0.44307711720466614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028617320582270622, decouple_loss:0.0015803588321432471
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr.npz
NaN value num: 0
Iteration: 1378, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454936683177948, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029017435386776924, decouple_loss:0.0016071486752480268
The modified gen p mean: 0.44632166624069214, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4463781416416168, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028396952897310257, decouple_loss:0.0017720793839544058
loss_pred:0.027206767350435257, decouple_loss:0.001695596263743937
Iteration: 1379, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444836288690567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028667587786912918, decouple_loss:0.00176826654933393
The modified gen p mean: 0.44221511483192444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030193351209163666, decouple_loss:0.0017756738234311342
The modified gen p mean: 0.442889541387558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030040159821510315, decouple_loss:0.0016869817627593875
Iteration: 1380, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44917842745780945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028665337711572647, decouple_loss:0.001994909020140767
The modified gen p mean: 0.4466317594051361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02751244604587555, decouple_loss:0.0019333367235958576
The modified gen p mean: 0.44534334540367126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028464512899518013, decouple_loss:0.001499712117947638
2023-05-26 12:52:55 testing...
The modified gen p mean: 0.45125851035118103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03264346718788147, decouple_loss:0.001706757117062807
The modified gen p mean: 0.449354350566864, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4513552188873291, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03276819363236427, decouple_loss:0.0015949736116454005
loss_pred:0.034068379551172256, decouple_loss:0.001732534496113658
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033243920654058456, avg_mse: 0.045111142098903656
current test mse: 0.045111
Iteration: 1381, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4448419511318207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028626082465052605, decouple_loss:0.001522467122413218
The modified gen p mean: 0.44657987356185913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027812331914901733, decouple_loss:0.0016225174767896533
The modified gen p mean: 0.44660380482673645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028384529054164886, decouple_loss:0.0015634439187124372
Iteration: 1382, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480051100254059, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03060150146484375, decouple_loss:0.001644541509449482
The modified gen p mean: 0.4473578929901123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03030414506793022, decouple_loss:0.0016076616011559963
The modified gen p mean: 0.44926580786705017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02707699127495289, decouple_loss:0.0016432615229859948
Iteration: 1383, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44959694147109985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02739311009645462, decouple_loss:0.0015542252222076058
The modified gen p mean: 0.4479981064796448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027476221323013306, decouple_loss:0.0018133623525500298
The modified gen p mean: 0.4482479393482208, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029109539464116096, decouple_loss:0.0016493493458256125
Iteration: 1384, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45635977387428284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02821645885705948, decouple_loss:0.0015868108021095395
The modified gen p mean: 0.45355090498924255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028339337557554245, decouple_loss:0.0017010251758620143
The modified gen p mean: 0.4547038972377777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026933986693620682, decouple_loss:0.0017693990375846624
Iteration: 1385, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490869343280792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028897307813167572, decouple_loss:0.0015591912670060992
The modified gen p mean: 0.44930872321128845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02851811610162258, decouple_loss:0.0015086560742929578
The modified gen p mean: 0.449266254901886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028411591425538063, decouple_loss:0.0016341485315933824
Iteration: 1386, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45353612303733826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0275564044713974, decouple_loss:0.0017323042266070843
The modified gen p mean: 0.45373502373695374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029261579737067223, decouple_loss:0.001729814219288528
The modified gen p mean: 0.4522969126701355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02857263758778572, decouple_loss:0.0016354431863874197
Iteration: 1387, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482795298099518, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029022149741649628, decouple_loss:0.0015805547591298819
The modified gen p mean: 0.45103374123573303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029323160648345947, decouple_loss:0.0018343478441238403
The modified gen p mean: 0.4505588412284851, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027498766779899597, decouple_loss:0.0016957564512267709
Iteration: 1388, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44702816009521484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02821292355656624, decouple_loss:0.0016706715105101466
The modified gen p mean: 0.44730666279792786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02752772346138954, decouple_loss:0.001551382360048592
The modified gen p mean: 0.4457404911518097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027982495725154877, decouple_loss:0.0016193065093830228
Iteration: 1389, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44765397906303406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02856958843767643, decouple_loss:0.0016610868042334914
The modified gen p mean: 0.4460156261920929, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028846407309174538, decouple_loss:0.0015792910708114505
The modified gen p mean: 0.449158251285553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02711743302643299, decouple_loss:0.001773124560713768
Iteration: 1390, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447751522064209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028153549879789352, decouple_loss:0.0016502693761140108
The modified gen p mean: 0.4458102285861969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02983354777097702, decouple_loss:0.0016826344653964043
The modified gen p mean: 0.4494779706001282, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028325792402029037, decouple_loss:0.001711984514258802
2023-05-26 12:56:59 testing...
The modified gen p mean: 0.4510822296142578, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03270178660750389, decouple_loss:0.0016571778105571866
The modified gen p mean: 0.44916611909866333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03280269727110863, decouple_loss:0.0015840936684980989
The modified gen p mean: 0.451251745223999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03403792902827263, decouple_loss:0.001680695335380733
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03326283395290375, avg_mse: 0.04522944986820221
current test mse: 0.045229
Iteration: 1391, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44987860321998596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02751203626394272, decouple_loss:0.0017564358422532678
The modified gen p mean: 0.4461362957954407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029534319415688515, decouple_loss:0.001482208725064993
The modified gen p mean: 0.446515828371048, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027990322560071945, decouple_loss:0.001644280506297946
Iteration: 1392, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514659643173218, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027012567967176437, decouple_loss:0.0015457127010449767
The modified gen p mean: 0.4450247585773468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02912464365363121, decouple_loss:0.0017130783526226878
The modified gen p mean: 0.4480462968349457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02655414678156376, decouple_loss:0.0017991820350289345
Iteration: 1393, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45258092880249023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028066955506801605, decouple_loss:0.001533151720650494
The modified gen p mean: 0.4465213716030121, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027952371165156364, decouple_loss:0.0015801279805600643
The modified gen p mean: 0.4516860246658325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028282787650823593, decouple_loss:0.001580539857968688
Iteration: 1394, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514353573322296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02695104479789734, decouple_loss:0.0016850209794938564
The modified gen p mean: 0.44983750581741333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0270596481859684, decouple_loss:0.0016029024263843894
The modified gen p mean: 0.44737324118614197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029622945934534073, decouple_loss:0.0015701109077781439
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1395, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44802790880203247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033449120819568634, decouple_loss:0.001366832759231329
The modified gen p mean: 0.45029211044311523, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45100492238998413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03268839418888092, decouple_loss:0.001499544712714851
loss_pred:0.03280647099018097, decouple_loss:0.0015123605262488127
Iteration: 1396, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503045678138733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033502619713544846, decouple_loss:0.0015861004358157516
The modified gen p mean: 0.452989786863327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03491203114390373, decouple_loss:0.001614289591088891
The modified gen p mean: 0.4486542046070099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032232049852609634, decouple_loss:0.0014072561170905828
Iteration: 1397, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519667625427246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03523372486233711, decouple_loss:0.0015775641659274697
The modified gen p mean: 0.45431697368621826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03526031970977783, decouple_loss:0.0017570176860317588
The modified gen p mean: 0.4514440596103668, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03275172784924507, decouple_loss:0.00150847970508039
Iteration: 1398, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45202356576919556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033450622111558914, decouple_loss:0.0014569663908332586
The modified gen p mean: 0.45288538932800293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230833634734154, decouple_loss:0.0015833341749385
The modified gen p mean: 0.4551185369491577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0345798134803772, decouple_loss:0.00151610909961164
Iteration: 1399, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4557603597640991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03319990634918213, decouple_loss:0.0015982170589268208
The modified gen p mean: 0.45835983753204346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03422734886407852, decouple_loss:0.0017088361782953143
The modified gen p mean: 0.45674705505371094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03245127201080322, decouple_loss:0.001621872535906732
Iteration: 1400, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4574664533138275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03225037083029747, decouple_loss:0.0017008887371048331
The modified gen p mean: 0.45502007007598877, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033111438155174255, decouple_loss:0.001633711508475244
The modified gen p mean: 0.4528680741786957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032728713005781174, decouple_loss:0.0012660904321819544
2023-05-26 13:01:45 testing...
The modified gen p mean: 0.4583570957183838, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03214825317263603, decouple_loss:0.0015613674186170101
The modified gen p mean: 0.45639291405677795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230823576450348, decouple_loss:0.0014936341904103756
The modified gen p mean: 0.4584085941314697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03360224887728691, decouple_loss:0.0016239460092037916
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03276422619819641, avg_mse: 0.04418124258518219
current test mse: 0.044181
Iteration: 1401, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45220234990119934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032868824899196625, decouple_loss:0.0014060009270906448
The modified gen p mean: 0.45492443442344666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03433508053421974, decouple_loss:0.0015845682937651873
The modified gen p mean: 0.4575115144252777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03290674090385437, decouple_loss:0.0015837798127904534
Iteration: 1402, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.452646940946579, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03318195790052414, decouple_loss:0.0014463234692811966
The modified gen p mean: 0.44961825013160706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032372381538152695, decouple_loss:0.001335327746346593
The modified gen p mean: 0.4520544111728668, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03203270211815834, decouple_loss:0.001472958829253912
Iteration: 1403, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44898924231529236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032958023250103, decouple_loss:0.0014380567008629441
The modified gen p mean: 0.4495808780193329, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03392060846090317, decouple_loss:0.001446124049834907
The modified gen p mean: 0.45267030596733093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0328034870326519, decouple_loss:0.0015102127799764276
Iteration: 1404, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499529302120209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033381927758455276, decouple_loss:0.0014481267426162958
The modified gen p mean: 0.4462796449661255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03252701461315155, decouple_loss:0.0013865397777408361
The modified gen p mean: 0.44925791025161743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03209231421351433, decouple_loss:0.0015161269111558795
Iteration: 1405, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4436251223087311, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03402251750230789, decouple_loss:0.0015671482542529702
The modified gen p mean: 0.44312912225723267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03331219404935837, decouple_loss:0.0013533991295844316
The modified gen p mean: 0.4442838430404663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03162318468093872, decouple_loss:0.0014105815207585692
Iteration: 1406, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449872076511383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033257223665714264, decouple_loss:0.0013731453800573945
The modified gen p mean: 0.4427652657032013, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03349074721336365, decouple_loss:0.001812407630495727
The modified gen p mean: 0.44174787402153015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033817507326602936, decouple_loss:0.0014065728755667806
Iteration: 1407, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4405311048030853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03279523178935051, decouple_loss:0.0013122532982379198
The modified gen p mean: 0.44764575362205505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032737985253334045, decouple_loss:0.0015088282525539398
The modified gen p mean: 0.4397566616535187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03413044288754463, decouple_loss:0.0013431819388642907
Iteration: 1408, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44566577672958374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03280854970216751, decouple_loss:0.001455555553548038
The modified gen p mean: 0.4424559473991394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03405475988984108, decouple_loss:0.0015024535823613405
The modified gen p mean: 0.44558730721473694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03403216972947121, decouple_loss:0.0013496455503627658
Iteration: 1409, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438735842704773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03243536129593849, decouple_loss:0.0014660753076896071
The modified gen p mean: 0.44881007075309753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253185376524925, decouple_loss:0.00164293113630265
The modified gen p mean: 0.448315292596817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03382006660103798, decouple_loss:0.0015600967453792691
Iteration: 1410, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483298063278198, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03296026214957237, decouple_loss:0.0013451364357024431
The modified gen p mean: 0.4465818405151367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0326882041990757, decouple_loss:0.001384152565151453
The modified gen p mean: 0.44984427094459534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033695682883262634, decouple_loss:0.0015326382126659155
2023-05-26 13:05:51 testing...
The modified gen p mean: 0.4522484242916107, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03200729191303253, decouple_loss:0.0015366437146440148
The modified gen p mean: 0.45059260725975037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03214219585061073, decouple_loss:0.0013700284762308002
The modified gen p mean: 0.45230141282081604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033508434891700745, decouple_loss:0.0015629930421710014
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03262713551521301, avg_mse: 0.04402633756399155
current test mse: 0.044026
Iteration: 1411, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477517008781433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03107430785894394, decouple_loss:0.0013417289592325687
The modified gen p mean: 0.44666701555252075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03477436676621437, decouple_loss:0.0013772831298410892
The modified gen p mean: 0.44841131567955017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03526875749230385, decouple_loss:0.0013607542496174574
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr.npz
NaN value num: 0
Iteration: 1412, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506092071533203, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03073107823729515, decouple_loss:0.0016630856553092599
The modified gen p mean: 0.45073768496513367, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4501504600048065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030692685395479202, decouple_loss:0.0015348066808655858
loss_pred:0.02939375676214695, decouple_loss:0.001485671498812735
Iteration: 1413, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45006150007247925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02989586628973484, decouple_loss:0.0014173899544402957
The modified gen p mean: 0.44998058676719666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030650129541754723, decouple_loss:0.0014288859674707055
The modified gen p mean: 0.45040497183799744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02823285013437271, decouple_loss:0.0014263694174587727
Iteration: 1414, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519736170768738, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027147768065333366, decouple_loss:0.0015138265443965793
The modified gen p mean: 0.4514366388320923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03097197785973549, decouple_loss:0.0015132451662793756
The modified gen p mean: 0.44847214221954346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030077757313847542, decouple_loss:0.0014747139066457748
Iteration: 1415, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498450756072998, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02766428142786026, decouple_loss:0.0016489890404045582
The modified gen p mean: 0.4467935562133789, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027416108176112175, decouple_loss:0.0015245742397382855
The modified gen p mean: 0.4508874714374542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03074379824101925, decouple_loss:0.0014926204457879066
Iteration: 1416, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481333792209625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029419677332043648, decouple_loss:0.0015610825503244996
The modified gen p mean: 0.4450041949748993, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03037595935165882, decouple_loss:0.0015127595979720354
The modified gen p mean: 0.4450698792934418, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028450211510062218, decouple_loss:0.0015869676135480404
Iteration: 1417, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44419386982917786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028930839151144028, decouple_loss:0.001390906167216599
The modified gen p mean: 0.44771307706832886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028667042031884193, decouple_loss:0.0016676972154527903
The modified gen p mean: 0.4445571005344391, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029658781364560127, decouple_loss:0.001436039456166327
Iteration: 1418, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44298267364501953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029228001832962036, decouple_loss:0.0014843582175672054
The modified gen p mean: 0.44719478487968445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028967496007680893, decouple_loss:0.0017727181548252702
The modified gen p mean: 0.4424266815185547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030899861827492714, decouple_loss:0.0015150380786508322
Iteration: 1419, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44264617562294006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02981777861714363, decouple_loss:0.0015767252771183848
The modified gen p mean: 0.4460751712322235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028300350531935692, decouple_loss:0.001629206701181829
The modified gen p mean: 0.4442472755908966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0281282477080822, decouple_loss:0.0015284803230315447
Iteration: 1420, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4417962431907654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029076920822262764, decouple_loss:0.0016297685215249658
The modified gen p mean: 0.4401618242263794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028164297342300415, decouple_loss:0.0013430921826511621
The modified gen p mean: 0.4442456066608429, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027515262365341187, decouple_loss:0.001647746772505343
2023-05-26 13:10:32 testing...
The modified gen p mean: 0.44704732298851013, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032266780734062195, decouple_loss:0.001688287127763033
The modified gen p mean: 0.4471362233161926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033744048327207565, decouple_loss:0.0016963965026661754
The modified gen p mean: 0.44539573788642883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03243899717926979, decouple_loss:0.00150901114102453
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03289817273616791, avg_mse: 0.044511765241622925
current test mse: 0.044512
Iteration: 1421, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44299787282943726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02800280600786209, decouple_loss:0.0018456599209457636
The modified gen p mean: 0.4413142502307892, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02984207682311535, decouple_loss:0.0017035616328939795
The modified gen p mean: 0.4414472281932831, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029017502442002296, decouple_loss:0.001484091393649578
Iteration: 1422, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44165682792663574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028961630538105965, decouple_loss:0.0014496903168037534
The modified gen p mean: 0.44141966104507446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030141204595565796, decouple_loss:0.0017320537008345127
The modified gen p mean: 0.4432325065135956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028426244854927063, decouple_loss:0.001701317261904478
Iteration: 1423, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506949484348297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028193620964884758, decouple_loss:0.0015346012078225613
The modified gen p mean: 0.4491361081600189, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027069272473454475, decouple_loss:0.0017232295358553529
The modified gen p mean: 0.44894394278526306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027523867785930634, decouple_loss:0.0018673143349587917
Iteration: 1424, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481724798679352, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02914605103433132, decouple_loss:0.0014031650498509407
The modified gen p mean: 0.45109081268310547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028493313118815422, decouple_loss:0.0017217922722920775
The modified gen p mean: 0.45107704401016235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027568146586418152, decouple_loss:0.0016979137435555458
Iteration: 1425, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45352739095687866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02735018916428089, decouple_loss:0.001747890724800527
The modified gen p mean: 0.45086750388145447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029822789132595062, decouple_loss:0.0015995712019503117
The modified gen p mean: 0.4519706666469574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028826536610722542, decouple_loss:0.0017869950970634818
Iteration: 1426, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4521690309047699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0270070917904377, decouple_loss:0.0016798431752249599
The modified gen p mean: 0.4491936266422272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028171122074127197, decouple_loss:0.0016334112733602524
The modified gen p mean: 0.4528314173221588, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02841082774102688, decouple_loss:0.0017610538052394986
Iteration: 1427, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515681564807892, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028100397437810898, decouple_loss:0.0015184038784354925
The modified gen p mean: 0.45117583870887756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029069678857922554, decouple_loss:0.0014308021636679769
The modified gen p mean: 0.4477089047431946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0286245234310627, decouple_loss:0.0013724731979891658
Iteration: 1428, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45397087931632996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0292972382158041, decouple_loss:0.001845085876993835
The modified gen p mean: 0.45051562786102295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027689972892403603, decouple_loss:0.0015621769707649946
The modified gen p mean: 0.4500432014465332, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03073383867740631, decouple_loss:0.001623738557100296
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1429, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44845426082611084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029475970193743706, decouple_loss:0.0014127175090834498
The modified gen p mean: 0.45320969820022583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028545835986733437, decouple_loss:0.0015952608082443476
The modified gen p mean: 0.4514644145965576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029127923771739006, decouple_loss:0.0015945821069180965
Iteration: 1430, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44874224066734314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029886901378631592, decouple_loss:0.0016125731635838747
The modified gen p mean: 0.44676387310028076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029695695266127586, decouple_loss:0.0014918384840711951
The modified gen p mean: 0.4523736536502838, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028726881369948387, decouple_loss:0.0016344340983778238
2023-05-26 13:15:21 testing...
The modified gen p mean: 0.4533548951148987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032378822565078735, decouple_loss:0.0016629267483949661
The modified gen p mean: 0.45336803793907166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033737536519765854, decouple_loss:0.0016986705595627427
The modified gen p mean: 0.4514968693256378, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03249121457338333, decouple_loss:0.0015322136459872127
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0329507552087307, avg_mse: 0.044677190482616425
current test mse: 0.044677
Iteration: 1431, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469292163848877, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030154244974255562, decouple_loss:0.0015980646712705493
The modified gen p mean: 0.45122912526130676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028003456071019173, decouple_loss:0.0016040256014093757
The modified gen p mean: 0.4477328062057495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029555421322584152, decouple_loss:0.0014172806404531002
Iteration: 1432, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45086491107940674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027289431542158127, decouple_loss:0.0014966309536248446
The modified gen p mean: 0.4506864845752716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027889246121048927, decouple_loss:0.0016113391611725092
The modified gen p mean: 0.4503014087677002, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027420584112405777, decouple_loss:0.0015590076800435781
Iteration: 1433, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488636553287506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027662260457873344, decouple_loss:0.0015565248904749751
The modified gen p mean: 0.44665899872779846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029871733859181404, decouple_loss:0.0015248677227646112
The modified gen p mean: 0.44925013184547424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02752547897398472, decouple_loss:0.0014866633573547006
Iteration: 1434, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474605917930603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028930433094501495, decouple_loss:0.0015260878717526793
The modified gen p mean: 0.44933852553367615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02922206185758114, decouple_loss:0.0015320339007303119
The modified gen p mean: 0.4452098608016968, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0292674470692873, decouple_loss:0.001528422930277884
Iteration: 1435, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44467711448669434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02882026694715023, decouple_loss:0.0015281870728358626
The modified gen p mean: 0.44951948523521423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028304237872362137, decouple_loss:0.0015867146430537105
The modified gen p mean: 0.44581642746925354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029457949101924896, decouple_loss:0.0014917886583134532
Iteration: 1436, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44728392362594604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028455527499318123, decouple_loss:0.0016411867691203952
The modified gen p mean: 0.4439934492111206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030187608674168587, decouple_loss:0.0016699527623131871
The modified gen p mean: 0.44616541266441345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02826821245253086, decouple_loss:0.0014960606349632144
Iteration: 1437, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44691377878189087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027433834969997406, decouple_loss:0.0016322783194482327
The modified gen p mean: 0.44837069511413574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028835367411375046, decouple_loss:0.0016724014421924949
The modified gen p mean: 0.4423249661922455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029580630362033844, decouple_loss:0.0013454374857246876
Iteration: 1438, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44679656624794006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02840747870504856, decouple_loss:0.0015824370784685016
The modified gen p mean: 0.4471466541290283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02740134298801422, decouple_loss:0.0014452056493610144
The modified gen p mean: 0.4447687268257141, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02733396552503109, decouple_loss:0.0015281731029972434
Iteration: 1439, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44713297486305237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028222989290952682, decouple_loss:0.0015099644660949707
The modified gen p mean: 0.44404953718185425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0263823252171278, decouple_loss:0.001736280508339405
The modified gen p mean: 0.4467593729496002, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02753523737192154, decouple_loss:0.001572595676407218
Iteration: 1440, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4432588815689087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029448948800563812, decouple_loss:0.0016714356606826186
The modified gen p mean: 0.4463196396827698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02721291594207287, decouple_loss:0.0016197144286707044
The modified gen p mean: 0.446920245885849, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027546120807528496, decouple_loss:0.001956864958629012
2023-05-26 13:19:32 testing...
The modified gen p mean: 0.4510197341442108, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251985087990761, decouple_loss:0.001704607275314629
The modified gen p mean: 0.45086541771888733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03396156057715416, decouple_loss:0.0017424526158720255
The modified gen p mean: 0.4489232301712036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03291069343686104, decouple_loss:0.0016546007245779037
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033215731382369995, avg_mse: 0.04512558877468109
current test mse: 0.045126
Iteration: 1441, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44619444012641907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029245777055621147, decouple_loss:0.0019261590205132961
The modified gen p mean: 0.4464121162891388, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026476765051484108, decouple_loss:0.0016947775147855282
The modified gen p mean: 0.44545936584472656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028947575017809868, decouple_loss:0.0016477671451866627
Iteration: 1442, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44866466522216797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028540337458252907, decouple_loss:0.0014889846788719296
The modified gen p mean: 0.4451673924922943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02919638901948929, decouple_loss:0.001565395388752222
The modified gen p mean: 0.4480105936527252, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027189409360289574, decouple_loss:0.0016357117565348744
Iteration: 1443, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444662868976593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02806744910776615, decouple_loss:0.0016868786187842488
The modified gen p mean: 0.4506291151046753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02854926325380802, decouple_loss:0.0018148767994716763
The modified gen p mean: 0.4491739571094513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028940945863723755, decouple_loss:0.0015692187007516623
Iteration: 1444, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44601956009864807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02837715670466423, decouple_loss:0.0014528363244608045
The modified gen p mean: 0.44730716943740845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028620265424251556, decouple_loss:0.001710681477561593
The modified gen p mean: 0.4455329179763794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02844063751399517, decouple_loss:0.001510447938926518
Iteration: 1445, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44864344596862793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028026890009641647, decouple_loss:0.0015209345147013664
The modified gen p mean: 0.4477056562900543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028897659853100777, decouple_loss:0.0016360729932785034
The modified gen p mean: 0.44966456294059753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029032010585069656, decouple_loss:0.0016276913229376078
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1446, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44944772124290466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029036207124590874, decouple_loss:0.0016265528975054622
The modified gen p mean: 0.45006999373435974, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44634130597114563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030084608122706413, decouple_loss:0.0015583541244268417
loss_pred:0.02688196860253811, decouple_loss:0.0018671829020604491
Iteration: 1447, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487147033214569, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026973415166139603, decouple_loss:0.0017091786721721292
The modified gen p mean: 0.4473792314529419, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027715226635336876, decouple_loss:0.0015921954764053226
The modified gen p mean: 0.4458184540271759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03000546060502529, decouple_loss:0.0016957054613158107
Iteration: 1448, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453164041042328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028000790625810623, decouple_loss:0.0014734993455931544
The modified gen p mean: 0.4452730715274811, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028219683095812798, decouple_loss:0.001487928326241672
The modified gen p mean: 0.4454408586025238, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026999451220035553, decouple_loss:0.0015093792462721467
Iteration: 1449, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44492024183273315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029588062316179276, decouple_loss:0.0015917139826342463
The modified gen p mean: 0.4451519846916199, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027273621410131454, decouple_loss:0.0016349860234186053
The modified gen p mean: 0.4459294080734253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02824735827744007, decouple_loss:0.0016758638666942716
Iteration: 1450, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486401677131653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027301114052534103, decouple_loss:0.00167370296549052
The modified gen p mean: 0.44620180130004883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028650978580117226, decouple_loss:0.001672247308306396
The modified gen p mean: 0.4439934492111206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028534797951579094, decouple_loss:0.001521274447441101
2023-05-26 13:24:22 testing...
The modified gen p mean: 0.44905218482017517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03270534798502922, decouple_loss:0.0017057794611901045
The modified gen p mean: 0.4469914138317108, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033103182911872864, decouple_loss:0.0016418080776929855
The modified gen p mean: 0.44882091879844666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034279778599739075, decouple_loss:0.0018251555738970637
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03344898298382759, avg_mse: 0.04548140615224838
current test mse: 0.045481
Iteration: 1451, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44789209961891174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027965014800429344, decouple_loss:0.0015962468460202217
The modified gen p mean: 0.44457772374153137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02827366068959236, decouple_loss:0.0015336209908127785
The modified gen p mean: 0.4465115964412689, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029503419995307922, decouple_loss:0.001474398304708302
Iteration: 1452, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44442218542099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029886290431022644, decouple_loss:0.0016643386334180832
The modified gen p mean: 0.4474469721317291, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028126316145062447, decouple_loss:0.0014743470819666982
The modified gen p mean: 0.446641743183136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027113841846585274, decouple_loss:0.001622966374270618
Iteration: 1453, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476729929447174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02706770971417427, decouple_loss:0.0019045672379434109
The modified gen p mean: 0.4456632137298584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02709471434354782, decouple_loss:0.001727876951918006
The modified gen p mean: 0.445099800825119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02807713858783245, decouple_loss:0.001573619432747364
Iteration: 1454, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44829413294792175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027240566909313202, decouple_loss:0.0017314838478341699
The modified gen p mean: 0.44681864976882935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02881264127790928, decouple_loss:0.0014778285985812545
The modified gen p mean: 0.44880497455596924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02863423340022564, decouple_loss:0.0016145601402968168
Iteration: 1455, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44578245282173157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02868032455444336, decouple_loss:0.0015233453596010804
The modified gen p mean: 0.44603344798088074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02946161851286888, decouple_loss:0.0016729525523260236
The modified gen p mean: 0.446922242641449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027411742135882378, decouple_loss:0.0016906793462112546
Iteration: 1456, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472816586494446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030459169298410416, decouple_loss:0.001802914310246706
The modified gen p mean: 0.4495357871055603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027638418599963188, decouple_loss:0.0017002793028950691
The modified gen p mean: 0.4494922161102295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029102571308612823, decouple_loss:0.0015274141915142536
Iteration: 1457, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497394263744354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02815687097609043, decouple_loss:0.0016555370530113578
The modified gen p mean: 0.4469847083091736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02743704430758953, decouple_loss:0.0016144291730597615
The modified gen p mean: 0.44666630029678345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030015146359801292, decouple_loss:0.001612123684026301
Iteration: 1458, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44675981998443604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028327522799372673, decouple_loss:0.0017940709367394447
The modified gen p mean: 0.4489038288593292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0295192152261734, decouple_loss:0.0015147083904594183
The modified gen p mean: 0.44948917627334595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026536840945482254, decouple_loss:0.002004323760047555
Iteration: 1459, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45099055767059326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02726036123931408, decouple_loss:0.0016640714602544904
The modified gen p mean: 0.44921132922172546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027820227667689323, decouple_loss:0.001707663293927908
The modified gen p mean: 0.44529250264167786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028039563447237015, decouple_loss:0.0014930764446035028
Iteration: 1460, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468362629413605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03035491518676281, decouple_loss:0.0016317666741088033
The modified gen p mean: 0.447087824344635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02747836336493492, decouple_loss:0.0015708545688539743
The modified gen p mean: 0.44934263825416565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027001941576600075, decouple_loss:0.0016007646918296814
2023-05-26 13:28:30 testing...
The modified gen p mean: 0.45320138335227966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03347112238407135, decouple_loss:0.0017217876156792045
The modified gen p mean: 0.4530046284198761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03518224135041237, decouple_loss:0.0017386249965056777
The modified gen p mean: 0.4508822560310364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03356803581118584, decouple_loss:0.0016014031134545803
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03415816277265549, avg_mse: 0.04667152836918831
current test mse: 0.046672
Iteration: 1461, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476146996021271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029190436005592346, decouple_loss:0.001536503667011857
The modified gen p mean: 0.4515981078147888, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027899131178855896, decouple_loss:0.0017366469837725163
The modified gen p mean: 0.44832882285118103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030143648386001587, decouple_loss:0.0016820549499243498
Iteration: 1462, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497808516025543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026111556217074394, decouple_loss:0.001544533995911479
The modified gen p mean: 0.4495321214199066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026810847222805023, decouple_loss:0.0014985271263867617
The modified gen p mean: 0.448058545589447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02828141115605831, decouple_loss:0.0015752764884382486
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1463, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494639039039612, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026611898094415665, decouple_loss:0.0016667074523866177
The modified gen p mean: 0.44698384404182434, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4544799029827118, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027888424694538116, decouple_loss:0.0017952221678569913
loss_pred:0.027087070047855377, decouple_loss:0.0018879028502851725
Iteration: 1464, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44892290234565735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02641163393855095, decouple_loss:0.001797620439901948
The modified gen p mean: 0.45068037509918213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027823008596897125, decouple_loss:0.001651880331337452
The modified gen p mean: 0.4527287185192108, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02719758450984955, decouple_loss:0.001749149989336729
Iteration: 1465, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485292136669159, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028163546696305275, decouple_loss:0.0016324690077453852
The modified gen p mean: 0.4485456645488739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029531151056289673, decouple_loss:0.0016947577241808176
The modified gen p mean: 0.44800418615341187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027897272258996964, decouple_loss:0.00148488930426538
Iteration: 1466, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44938376545906067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027044150978326797, decouple_loss:0.0014334580628201365
The modified gen p mean: 0.4490441679954529, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026627391576766968, decouple_loss:0.0016879737377166748
The modified gen p mean: 0.45016059279441833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027876781299710274, decouple_loss:0.0015054590767249465
Iteration: 1467, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4440588355064392, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02759082429111004, decouple_loss:0.0015602933708578348
The modified gen p mean: 0.4493423104286194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028359951451420784, decouple_loss:0.001544486847706139
The modified gen p mean: 0.4533962905406952, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026480617001652718, decouple_loss:0.0014900118112564087
Iteration: 1468, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44747504591941833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02741262875497341, decouple_loss:0.0015294250333681703
The modified gen p mean: 0.4457857608795166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02899143099784851, decouple_loss:0.0016147337155416608
The modified gen p mean: 0.44564715027809143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027957314625382423, decouple_loss:0.0015771599719300866
Iteration: 1469, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44447270035743713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02796970307826996, decouple_loss:0.0015593980206176639
The modified gen p mean: 0.44331467151641846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027749255299568176, decouple_loss:0.0015253127785399556
The modified gen p mean: 0.44488760828971863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026148535311222076, decouple_loss:0.0014312299899756908
Iteration: 1470, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44419988989830017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027379043400287628, decouple_loss:0.0016031833365559578
The modified gen p mean: 0.4500010013580322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026128273457288742, decouple_loss:0.0015493882820010185
The modified gen p mean: 0.4429348111152649, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02857901342213154, decouple_loss:0.0014576188987120986
2023-05-26 13:33:27 testing...
The modified gen p mean: 0.4507048428058624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033011261373758316, decouple_loss:0.001727285678498447
The modified gen p mean: 0.4484492838382721, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03313785418868065, decouple_loss:0.0015743314288556576
The modified gen p mean: 0.4505952298641205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034542266279459, decouple_loss:0.0017001822125166655
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03364715725183487, avg_mse: 0.04583054035902023
current test mse: 0.045831
Iteration: 1471, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45024633407592773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02597048133611679, decouple_loss:0.0016140792286023498
The modified gen p mean: 0.44260576367378235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027997195720672607, decouple_loss:0.0014207853237167
The modified gen p mean: 0.44344562292099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02811632864177227, decouple_loss:0.001560188946314156
Iteration: 1472, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45041006803512573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025946777313947678, decouple_loss:0.001737656770274043
The modified gen p mean: 0.44411152601242065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028436360880732536, decouple_loss:0.001499131671153009
The modified gen p mean: 0.44284331798553467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028232131153345108, decouple_loss:0.001664176699705422
Iteration: 1473, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491848945617676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02726416103541851, decouple_loss:0.0016101297223940492
The modified gen p mean: 0.45073315501213074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026154356077313423, decouple_loss:0.001721804728731513
The modified gen p mean: 0.44505736231803894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02765282429754734, decouple_loss:0.001661886926740408
Iteration: 1474, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44271132349967957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028162335976958275, decouple_loss:0.0016770388465374708
The modified gen p mean: 0.4495944082736969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02576461434364319, decouple_loss:0.0015688061248511076
The modified gen p mean: 0.4521971642971039, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026009242981672287, decouple_loss:0.0015821740962564945
Iteration: 1475, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452558755874634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0272295530885458, decouple_loss:0.0017392339650541544
The modified gen p mean: 0.44522741436958313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02764555625617504, decouple_loss:0.001817374606616795
The modified gen p mean: 0.4473494589328766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0275872852653265, decouple_loss:0.0015066153137013316
Iteration: 1476, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44739997386932373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028025304898619652, decouple_loss:0.0015220909845083952
The modified gen p mean: 0.4473496675491333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028901176527142525, decouple_loss:0.0018102905014529824
The modified gen p mean: 0.45202064514160156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027189508080482483, decouple_loss:0.0018542925827205181
Iteration: 1477, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450034201145172, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027944106608629227, decouple_loss:0.0015434179222211242
The modified gen p mean: 0.4453139007091522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02573636919260025, decouple_loss:0.0015739367809146643
The modified gen p mean: 0.4434266984462738, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783920243382454, decouple_loss:0.0014166898326948285
Iteration: 1478, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479365050792694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02594688907265663, decouple_loss:0.0016259936382994056
The modified gen p mean: 0.44929951429367065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025976194068789482, decouple_loss:0.001707702875137329
The modified gen p mean: 0.4479643404483795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027430562302470207, decouple_loss:0.00150957889854908
Iteration: 1479, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44681429862976074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771601267158985, decouple_loss:0.0016289055347442627
The modified gen p mean: 0.44458943605422974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028501935303211212, decouple_loss:0.0013717282563447952
The modified gen p mean: 0.44578057527542114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02766742743551731, decouple_loss:0.0014350248966366053
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1480, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44801339507102966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028196291998028755, decouple_loss:0.0015173471765592694
The modified gen p mean: 0.4468008577823639, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44925588369369507, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028345581144094467, decouple_loss:0.0014942976413294673
loss_pred:0.02708967588841915, decouple_loss:0.0017019177321344614
2023-05-26 13:38:13 testing...
The modified gen p mean: 0.45240873098373413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0328763872385025, decouple_loss:0.0016998344799503684
The modified gen p mean: 0.4503110945224762, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03297802805900574, decouple_loss:0.0015557811129838228
The modified gen p mean: 0.4522148072719574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03432077914476395, decouple_loss:0.0016887570964172482
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033474139869213104, avg_mse: 0.04556989669799805
current test mse: 0.04557
Iteration: 1481, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44883134961128235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027523385360836983, decouple_loss:0.001643329975195229
The modified gen p mean: 0.44645312428474426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02886444330215454, decouple_loss:0.0015472299419343472
The modified gen p mean: 0.45123961567878723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027151519432663918, decouple_loss:0.0017727176891639829
Iteration: 1482, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44814103841781616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02868802472949028, decouple_loss:0.0015242068329825997
The modified gen p mean: 0.44956615567207336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02768038958311081, decouple_loss:0.0015016969991847873
The modified gen p mean: 0.4502521753311157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027435781434178352, decouple_loss:0.0017008095746859908
Iteration: 1483, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518052637577057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027129126712679863, decouple_loss:0.0015058903954923153
The modified gen p mean: 0.44854825735092163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02780027687549591, decouple_loss:0.0014532334171235561
The modified gen p mean: 0.4475950300693512, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027209175750613213, decouple_loss:0.0016818107105791569
Iteration: 1484, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466985762119293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02809712290763855, decouple_loss:0.0014887771103531122
The modified gen p mean: 0.44680556654930115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02778269164264202, decouple_loss:0.0014979301486164331
The modified gen p mean: 0.4437704384326935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02811061404645443, decouple_loss:0.0016445976216346025
Iteration: 1485, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4435940384864807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02737940289080143, decouple_loss:0.0016189662273973227
The modified gen p mean: 0.443263441324234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02835814282298088, decouple_loss:0.0015386218437924981
The modified gen p mean: 0.44390594959259033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02779845893383026, decouple_loss:0.0015163231873884797
Iteration: 1486, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.443443238735199, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027864838019013405, decouple_loss:0.001433032564818859
The modified gen p mean: 0.44554203748703003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028042161837220192, decouple_loss:0.0014691886026412249
The modified gen p mean: 0.4456269443035126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0265439972281456, decouple_loss:0.0016944620292633772
Iteration: 1487, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492802917957306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027667725458741188, decouple_loss:0.0015115597052499652
The modified gen p mean: 0.44914132356643677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0279446579515934, decouple_loss:0.0014898490626364946
The modified gen p mean: 0.44783809781074524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027544690296053886, decouple_loss:0.0016633482882753015
Iteration: 1488, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44364914298057556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027655575424432755, decouple_loss:0.0014288427773863077
The modified gen p mean: 0.4466521441936493, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028226414695382118, decouple_loss:0.0015262884553521872
The modified gen p mean: 0.44686535000801086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02720237709581852, decouple_loss:0.001523660495877266
Iteration: 1489, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45041659474372864, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4461241066455841, gen p mean: 0.0, mean p set: 0.448loss_pred:0.027005553245544434, decouple_loss:0.0014935866929590702
loss_pred:0.027745481580495834, decouple_loss:0.0015640784986317158
The modified gen p mean: 0.4463474154472351, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027756161987781525, decouple_loss:0.0017556556267663836
Iteration: 1490, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463208317756653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027165187522768974, decouple_loss:0.001504888292402029
The modified gen p mean: 0.45231109857559204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02754802443087101, decouple_loss:0.0016906190430745482
The modified gen p mean: 0.4492025673389435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026379089802503586, decouple_loss:0.0016332679660990834
2023-05-26 13:42:19 testing...
The modified gen p mean: 0.45372357964515686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03334491327404976, decouple_loss:0.0016399685991927981
The modified gen p mean: 0.451664537191391, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0332648791372776, decouple_loss:0.0015314801130443811
The modified gen p mean: 0.4534645080566406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03495112434029579, decouple_loss:0.0016993074677884579
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0339348167181015, avg_mse: 0.04627111181616783
current test mse: 0.046271
Iteration: 1491, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44752511382102966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02764861099421978, decouple_loss:0.0015017243567854166
The modified gen p mean: 0.45040974020957947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0286756232380867, decouple_loss:0.001768875983543694
The modified gen p mean: 0.4505264461040497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028438208624720573, decouple_loss:0.0015027477638795972
Iteration: 1492, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466451406478882, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02743762545287609, decouple_loss:0.0015490885125473142
The modified gen p mean: 0.44799718260765076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028790626674890518, decouple_loss:0.0017440536757931113
The modified gen p mean: 0.45387497544288635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027327880263328552, decouple_loss:0.0016794949769973755
Iteration: 1493, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44823890924453735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02764471247792244, decouple_loss:0.0013196631334722042
The modified gen p mean: 0.44704270362854004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029220130294561386, decouple_loss:0.0014805060345679522
The modified gen p mean: 0.4487989842891693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027730567380785942, decouple_loss:0.0016356841661036015
Iteration: 1494, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495353698730469, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027610041201114655, decouple_loss:0.0015563162742182612
The modified gen p mean: 0.4465893507003784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027941323816776276, decouple_loss:0.0015049728099256754
The modified gen p mean: 0.44597676396369934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027821417897939682, decouple_loss:0.0014298297464847565
Iteration: 1495, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490734934806824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027179144322872162, decouple_loss:0.0017303988570347428
The modified gen p mean: 0.44813916087150574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026565294712781906, decouple_loss:0.0016571534797549248
The modified gen p mean: 0.4474814832210541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028035368770360947, decouple_loss:0.001515855430625379
Iteration: 1496, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44771894812583923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02813802659511566, decouple_loss:0.0016324961325153708
The modified gen p mean: 0.4466395378112793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028718993067741394, decouple_loss:0.0015666123945266008
The modified gen p mean: 0.4469635784626007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028667360544204712, decouple_loss:0.0014728341484442353
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1497, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44778162240982056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03278927505016327, decouple_loss:0.0014095414662733674
The modified gen p mean: 0.44623085856437683, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44862106442451477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03281670808792114, decouple_loss:0.0016208677552640438
loss_pred:0.033872563391923904, decouple_loss:0.0015132589032873511
Iteration: 1498, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496447741985321, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03226643055677414, decouple_loss:0.0015838155522942543
The modified gen p mean: 0.4471178352832794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03262542188167572, decouple_loss:0.0015050142537802458
The modified gen p mean: 0.4512695372104645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03235599771142006, decouple_loss:0.0016899051843211055
Iteration: 1499, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45362067222595215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03228352591395378, decouple_loss:0.0015708361752331257
The modified gen p mean: 0.4547058641910553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031490493565797806, decouple_loss:0.0014974087243899703
The modified gen p mean: 0.4532027542591095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031781721860170364, decouple_loss:0.0015274598263204098
Iteration: 1500, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508979618549347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033374279737472534, decouple_loss:0.0014384116511791945
The modified gen p mean: 0.4530584216117859, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03148629516363144, decouple_loss:0.0015914126997813582
The modified gen p mean: 0.4508018493652344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03165798261761665, decouple_loss:0.0015151937259361148
2023-05-26 13:47:07 testing...
The modified gen p mean: 0.4550837278366089, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03247316554188728, decouple_loss:0.001619664835743606
The modified gen p mean: 0.4532938301563263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03260142728686333, decouple_loss:0.0014945934526622295
The modified gen p mean: 0.4551165997982025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03396322950720787, decouple_loss:0.0016112644225358963
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03309136629104614, avg_mse: 0.04485270008444786
current test mse: 0.044853
Iteration: 1501, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505446255207062, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03220915049314499, decouple_loss:0.0013006646186113358
The modified gen p mean: 0.45176976919174194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03117447905242443, decouple_loss:0.0015947913052514195
The modified gen p mean: 0.451811283826828, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03180956840515137, decouple_loss:0.0015566967194899917
Iteration: 1502, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44946280121803284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230532258749008, decouple_loss:0.0012849032646045089
The modified gen p mean: 0.45333337783813477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03317861631512642, decouple_loss:0.0017108856700360775
The modified gen p mean: 0.4536442160606384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032542601227760315, decouple_loss:0.0014576292596757412
Iteration: 1503, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45087358355522156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03185214102268219, decouple_loss:0.001413340913131833
The modified gen p mean: 0.44823095202445984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03082888573408127, decouple_loss:0.0014319202164188027
The modified gen p mean: 0.4503307342529297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03270721063017845, decouple_loss:0.0015486973570659757
Iteration: 1504, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45504114031791687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032847754657268524, decouple_loss:0.0016502615762874484
The modified gen p mean: 0.44885170459747314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03238043189048767, decouple_loss:0.0013692143838852644
The modified gen p mean: 0.4517344534397125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265679255127907, decouple_loss:0.001546266721561551
Iteration: 1505, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45188188552856445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032445814460515976, decouple_loss:0.0015700770309194922
The modified gen p mean: 0.44759219884872437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03352690488100052, decouple_loss:0.0014770454727113247
The modified gen p mean: 0.4478488564491272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032881252467632294, decouple_loss:0.0015042276354506612
Iteration: 1506, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468936026096344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03354903683066368, decouple_loss:0.0014511484187096357
The modified gen p mean: 0.4466811716556549, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03119583986699581, decouple_loss:0.0013346984051167965
The modified gen p mean: 0.4512036144733429, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03235837444663048, decouple_loss:0.001401793910190463
Iteration: 1507, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478050470352173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032585520297288895, decouple_loss:0.0014274390414357185
The modified gen p mean: 0.4496140480041504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03241787478327751, decouple_loss:0.0013171526370570064
The modified gen p mean: 0.44976717233657837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03196937218308449, decouple_loss:0.00140595983248204
Iteration: 1508, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44894787669181824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03301110118627548, decouple_loss:0.0015072590904310346
The modified gen p mean: 0.44898924231529236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030920686200261116, decouple_loss:0.0015010028146207333
The modified gen p mean: 0.44808605313301086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03286367282271385, decouple_loss:0.0015027457848191261
Iteration: 1509, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45127618312835693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03199067711830139, decouple_loss:0.001613514730706811
The modified gen p mean: 0.45095908641815186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032148074358701706, decouple_loss:0.0016039279289543629
The modified gen p mean: 0.44883066415786743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03376292064785957, decouple_loss:0.0014030929887667298
Iteration: 1510, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45035454630851746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03201877325773239, decouple_loss:0.0014264816418290138
The modified gen p mean: 0.45276495814323425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032796431332826614, decouple_loss:0.0016038661124184728
The modified gen p mean: 0.45085710287094116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03287340700626373, decouple_loss:0.001551886205561459
2023-05-26 13:51:13 testing...
The modified gen p mean: 0.45331916213035583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03203562647104263, decouple_loss:0.0016262984136119485
The modified gen p mean: 0.4516732096672058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0323590449988842, decouple_loss:0.0015072671230882406
The modified gen p mean: 0.4531956613063812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0334332175552845, decouple_loss:0.0015844355802983046
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03268793225288391, avg_mse: 0.044141579419374466
current test mse: 0.044142
Iteration: 1511, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497027099132538, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03336471691727638, decouple_loss:0.0014007155550643802
The modified gen p mean: 0.44954371452331543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03272568807005882, decouple_loss:0.001504636136814952
The modified gen p mean: 0.4479822516441345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033856358379125595, decouple_loss:0.0013339536963030696
Iteration: 1512, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502626061439514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03086121194064617, decouple_loss:0.0014992763753980398
The modified gen p mean: 0.45009732246398926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03119676373898983, decouple_loss:0.0015237699262797832
The modified gen p mean: 0.4518204927444458, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032682739198207855, decouple_loss:0.0016091710422188044
Iteration: 1513, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44904208183288574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03272698074579239, decouple_loss:0.0014455454656854272
The modified gen p mean: 0.44804129004478455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03194162994623184, decouple_loss:0.0015563644701614976
The modified gen p mean: 0.45287472009658813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033557165414094925, decouple_loss:0.0014897632645443082
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr.npz
NaN value num: 0
Iteration: 1514, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476703703403473, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4517534375190735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259202465415001, decouple_loss:0.0014874382177367806
loss_pred:0.03129485622048378, decouple_loss:0.0016821044264361262
The modified gen p mean: 0.4492187798023224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03217258304357529, decouple_loss:0.0016587452264502645
Iteration: 1515, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473330080509186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029927833005785942, decouple_loss:0.0014184995088726282
The modified gen p mean: 0.4514046907424927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032298166304826736, decouple_loss:0.0015216364990919828
The modified gen p mean: 0.45221084356307983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030761562287807465, decouple_loss:0.0014259384479373693
Iteration: 1516, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467948377132416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030264902859926224, decouple_loss:0.0015868475893512368
The modified gen p mean: 0.44567880034446716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230034187436104, decouple_loss:0.0014098562533035874
The modified gen p mean: 0.4485774636268616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031764496117830276, decouple_loss:0.0015312645118683577
Iteration: 1517, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472561478614807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03201666474342346, decouple_loss:0.0015331846661865711
The modified gen p mean: 0.4481242299079895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03105388768017292, decouple_loss:0.0016358628636226058
The modified gen p mean: 0.4482450783252716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031971149146556854, decouple_loss:0.0015242224326357245
Iteration: 1518, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462830126285553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03156168758869171, decouple_loss:0.0014797378098592162
The modified gen p mean: 0.4484970271587372, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032232288271188736, decouple_loss:0.0014709061942994595
The modified gen p mean: 0.4463839530944824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03145722299814224, decouple_loss:0.001516704331152141
Iteration: 1519, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499668776988983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03164606913924217, decouple_loss:0.0016546357655897737
The modified gen p mean: 0.44841939210891724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031938083469867706, decouple_loss:0.001456896890886128
The modified gen p mean: 0.44627800583839417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030907852575182915, decouple_loss:0.0014268673257902265
Iteration: 1520, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44957083463668823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0307296235114336, decouple_loss:0.0015732251340523362
The modified gen p mean: 0.45195895433425903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03192448988556862, decouple_loss:0.0015154960565268993
The modified gen p mean: 0.4491593539714813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03057316318154335, decouple_loss:0.0017038935329765081
2023-05-26 13:56:01 testing...
The modified gen p mean: 0.4521307647228241, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03197203204035759, decouple_loss:0.0016454530414193869
The modified gen p mean: 0.45038825273513794, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4521099627017975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03240806236863136, decouple_loss:0.0015547833172604442
loss_pred:0.03340131416916847, decouple_loss:0.0016755324322730303
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03267506882548332, avg_mse: 0.04408746585249901
current test mse: 0.044087
Iteration: 1521, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480687975883484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032869692891836166, decouple_loss:0.0014728883979842067
The modified gen p mean: 0.4501563310623169, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031990256160497665, decouple_loss:0.0016416240250691772
The modified gen p mean: 0.44598808884620667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03338036686182022, decouple_loss:0.0016326979966834188
Iteration: 1522, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44508159160614014, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03212017938494682, decouple_loss:0.0014672743855044246
The modified gen p mean: 0.4479634463787079, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031161068007349968, decouple_loss:0.0016922126524150372
The modified gen p mean: 0.445811003446579, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032028332352638245, decouple_loss:0.0015918047865852714
Iteration: 1523, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460376501083374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0317879281938076, decouple_loss:0.0015992142725735903
The modified gen p mean: 0.4449845552444458, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031663451343774796, decouple_loss:0.00138913094997406
The modified gen p mean: 0.4471341371536255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03155103325843811, decouple_loss:0.0016819414449855685
Iteration: 1524, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44852685928344727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033365070819854736, decouple_loss:0.001548674888908863
The modified gen p mean: 0.44876569509506226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03231259435415268, decouple_loss:0.0015797251835465431
The modified gen p mean: 0.4461786150932312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03141985461115837, decouple_loss:0.0014721241313964128
Iteration: 1525, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444863200187683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03146906569600105, decouple_loss:0.0014341798378154635
The modified gen p mean: 0.44709357619285583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0316719152033329, decouple_loss:0.0014126617461442947
The modified gen p mean: 0.4437653124332428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03129212558269501, decouple_loss:0.0014483798295259476
Iteration: 1526, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455903470516205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030703140422701836, decouple_loss:0.0016652962658554316
The modified gen p mean: 0.44560009241104126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03327230364084244, decouple_loss:0.001484982087276876
The modified gen p mean: 0.4480684995651245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03178557753562927, decouple_loss:0.001586730359122157
Iteration: 1527, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504625201225281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032430678606033325, decouple_loss:0.0015449379570782185
The modified gen p mean: 0.4490809142589569, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03042002208530903, decouple_loss:0.0016139770159497857
The modified gen p mean: 0.4497911036014557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030189307406544685, decouple_loss:0.001642274553887546
Iteration: 1528, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514314830303192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03122325800359249, decouple_loss:0.0016244646394625306
The modified gen p mean: 0.44912150502204895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03199789673089981, decouple_loss:0.0015887105837464333
The modified gen p mean: 0.4478778541088104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03262145817279816, decouple_loss:0.0014460956444963813
Iteration: 1529, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44744789600372314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030921760946512222, decouple_loss:0.0014612114755436778
The modified gen p mean: 0.4515239894390106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03179279714822769, decouple_loss:0.0015196390450000763
The modified gen p mean: 0.4508122503757477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03117770329117775, decouple_loss:0.0013906313106417656
Iteration: 1530, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45311155915260315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03237011283636093, decouple_loss:0.0014921743422746658
The modified gen p mean: 0.4502497911453247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030824167653918266, decouple_loss:0.0014746318338438869
The modified gen p mean: 0.4492427706718445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03158397227525711, decouple_loss:0.0014360527275130153
2023-05-26 14:00:06 testing...
The modified gen p mean: 0.45673054456710815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03190041705965996, decouple_loss:0.0015909320209175348
The modified gen p mean: 0.45516490936279297, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45683956146240234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032233405858278275, decouple_loss:0.001510250847786665
loss_pred:0.03338610380887985, decouple_loss:0.0016162552637979388
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0325852669775486, avg_mse: 0.04391566663980484
current test mse: 0.043916
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr.npz
NaN value num: 0
Iteration: 1531, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4557318091392517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028368450701236725, decouple_loss:0.0015165935037657619
The modified gen p mean: 0.4540572762489319, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026384318247437477, decouple_loss:0.0014810266438871622
The modified gen p mean: 0.45113900303840637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029079996049404144, decouple_loss:0.0015408844919875264
Iteration: 1532, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45125123858451843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02818000689148903, decouple_loss:0.0015685332473367453
The modified gen p mean: 0.45280709862709045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029191581532359123, decouple_loss:0.0015185975935310125
The modified gen p mean: 0.45397329330444336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029098406434059143, decouple_loss:0.0013911420246586204
Iteration: 1533, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44837358593940735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02913806028664112, decouple_loss:0.0014862975804135203
The modified gen p mean: 0.44638124108314514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028388211503624916, decouple_loss:0.0014327740063890815
The modified gen p mean: 0.45331984758377075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028153760358691216, decouple_loss:0.0018449017079547048
Iteration: 1534, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443788528442383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027663499116897583, decouple_loss:0.0015046898042783141
The modified gen p mean: 0.4486623704433441, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026582621037960052, decouple_loss:0.0016174502670764923
The modified gen p mean: 0.4443594813346863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02914382331073284, decouple_loss:0.0016720893327146769
Iteration: 1535, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4424045979976654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027605710551142693, decouple_loss:0.0015161479823291302
The modified gen p mean: 0.4429418444633484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02833983488380909, decouple_loss:0.001626536250114441
The modified gen p mean: 0.4415273666381836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02781284600496292, decouple_loss:0.001401780522428453
Iteration: 1536, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.441398561000824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028474697843194008, decouple_loss:0.001522306352853775
The modified gen p mean: 0.4404687285423279, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026529064401984215, decouple_loss:0.001647984841838479
The modified gen p mean: 0.44339245557785034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027043959125876427, decouple_loss:0.0016362430760636926
Iteration: 1537, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447161555290222, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02799995429813862, decouple_loss:0.0016597225330770016
The modified gen p mean: 0.4411904215812683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028443720191717148, decouple_loss:0.0015266151167452335
The modified gen p mean: 0.4392333924770355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732652984559536, decouple_loss:0.0016636312939226627
Iteration: 1538, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44010934233665466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027620499953627586, decouple_loss:0.0015865593450143933
The modified gen p mean: 0.4401628077030182, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02767089381814003, decouple_loss:0.0014351410791277885
The modified gen p mean: 0.4462200105190277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02899828739464283, decouple_loss:0.0017140662530437112
Iteration: 1539, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44759419560432434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02624417282640934, decouple_loss:0.0016605088021606207
The modified gen p mean: 0.44473281502723694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028220416978001595, decouple_loss:0.001520130899734795
The modified gen p mean: 0.4454306364059448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026737889274954796, decouple_loss:0.0016571218147873878
Iteration: 1540, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473799765110016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02717662788927555, decouple_loss:0.0016459185862913728
The modified gen p mean: 0.4499576985836029, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029441265389323235, decouple_loss:0.0015640852507203817
The modified gen p mean: 0.4536425471305847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029190082103013992, decouple_loss:0.00197779037989676
2023-05-26 14:04:47 testing...
The modified gen p mean: 0.4578205347061157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03233714774250984, decouple_loss:0.0016841527540236712
The modified gen p mean: 0.45628684759140015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254695236682892, decouple_loss:0.001532915746793151
The modified gen p mean: 0.4580078125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033888768404722214, decouple_loss:0.0016025432851165533
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03300461918115616, avg_mse: 0.04470515996217728
current test mse: 0.044705
Iteration: 1541, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4538503885269165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732645720243454, decouple_loss:0.0014185858890414238
The modified gen p mean: 0.4555298686027527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026949459686875343, decouple_loss:0.0015773760387673974
The modified gen p mean: 0.4579959213733673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02624603733420372, decouple_loss:0.001540564582683146
Iteration: 1542, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4564549922943115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029037149623036385, decouple_loss:0.0014774722512811422
The modified gen p mean: 0.45370131731033325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028332574293017387, decouple_loss:0.0015441235154867172
The modified gen p mean: 0.45745575428009033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026159871369600296, decouple_loss:0.0016900182235985994
Iteration: 1543, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4572776257991791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026429422199726105, decouple_loss:0.001406969502568245
The modified gen p mean: 0.4591178297996521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027559593319892883, decouple_loss:0.0017319234320893884
The modified gen p mean: 0.45893552899360657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02648267149925232, decouple_loss:0.0015708539867773652
Iteration: 1544, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4565871059894562, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027847517281770706, decouple_loss:0.001453310251235962
The modified gen p mean: 0.45523253083229065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026950594037771225, decouple_loss:0.0016080468194559216
The modified gen p mean: 0.45778632164001465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02851732075214386, decouple_loss:0.001594959176145494
Iteration: 1545, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4547039270401001, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028432028368115425, decouple_loss:0.0016219659009948373
The modified gen p mean: 0.455318808555603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026495544239878654, decouple_loss:0.001872944994829595
The modified gen p mean: 0.4516105353832245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027308078482747078, decouple_loss:0.0012594027211889625
Iteration: 1546, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492139220237732, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027356920763850212, decouple_loss:0.001700331107713282
The modified gen p mean: 0.4490833282470703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028406117111444473, decouple_loss:0.0014330416452139616
The modified gen p mean: 0.45074161887168884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027282413095235825, decouple_loss:0.0014631552621722221
Iteration: 1547, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473755359649658, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02589087188243866, decouple_loss:0.0015842006541788578
The modified gen p mean: 0.44460320472717285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028344841673970222, decouple_loss:0.0013960994547232985
The modified gen p mean: 0.44563594460487366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028729770332574844, decouple_loss:0.0016440664185211062
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr.npz
NaN value num: 0
Iteration: 1548, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4424651563167572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03244993835687637, decouple_loss:0.0015791713958606124
The modified gen p mean: 0.4470822811126709, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03380369767546654, decouple_loss:0.001527382293716073
The modified gen p mean: 0.44186797738075256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031767845153808594, decouple_loss:0.0013692941283807158
Iteration: 1549, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4427694082260132, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030439862981438637, decouple_loss:0.001452807686291635
The modified gen p mean: 0.44243714213371277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03280757740139961, decouple_loss:0.0013782148016616702
The modified gen p mean: 0.44219326972961426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03250236064195633, decouple_loss:0.0015222581569105387
Iteration: 1550, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475535750389099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03199852630496025, decouple_loss:0.0014257056172937155
The modified gen p mean: 0.4472319185733795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031109623610973358, decouple_loss:0.0014801648212596774
The modified gen p mean: 0.44386109709739685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03177081048488617, decouple_loss:0.00143872678745538
2023-05-26 14:09:34 testing...
The modified gen p mean: 0.45187851786613464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03228852152824402, decouple_loss:0.001584010198712349
The modified gen p mean: 0.450486958026886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246466442942619, decouple_loss:0.0014155430253595114
The modified gen p mean: 0.4520786702632904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033842623233795166, decouple_loss:0.001585632679052651
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03294169157743454, avg_mse: 0.044609326869249344
current test mse: 0.044609
Iteration: 1551, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44846001267433167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031575318425893784, decouple_loss:0.0014107447350397706
The modified gen p mean: 0.447201669216156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03211132809519768, decouple_loss:0.0014156330144032836
The modified gen p mean: 0.4480849802494049, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03247556835412979, decouple_loss:0.0013409352395683527
Iteration: 1552, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.455218642950058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03303486481308937, decouple_loss:0.0015158355236053467
The modified gen p mean: 0.4512753188610077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03364512696862221, decouple_loss:0.0014180863508954644
The modified gen p mean: 0.4552405774593353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031236661598086357, decouple_loss:0.0014293870190158486
Iteration: 1553, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4574923515319824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03189123049378395, decouple_loss:0.0014038350200280547
The modified gen p mean: 0.4571993350982666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03148667886853218, decouple_loss:0.0014279612805694342
The modified gen p mean: 0.4519701302051544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03140607103705406, decouple_loss:0.001439807005226612
Iteration: 1554, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4550838768482208, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4549144208431244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032402005046606064, decouple_loss:0.0013847987866029143
loss_pred:0.0305889081209898, decouple_loss:0.0014092674246057868
The modified gen p mean: 0.4537733793258667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03163187950849533, decouple_loss:0.0014186579501256347
Iteration: 1555, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4561688303947449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03402281552553177, decouple_loss:0.0015608317917212844
The modified gen p mean: 0.4564657509326935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0315161794424057, decouple_loss:0.001381977810524404
The modified gen p mean: 0.45901957154273987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03341913968324661, decouple_loss:0.001558097661472857
Iteration: 1556, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45449066162109375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0336332768201828, decouple_loss:0.0013494042214006186
The modified gen p mean: 0.4560139775276184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03273867815732956, decouple_loss:0.0014145731693133712
The modified gen p mean: 0.45237478613853455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03077740967273712, decouple_loss:0.0014148595510050654
Iteration: 1557, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512762129306793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03197416663169861, decouple_loss:0.00147012819070369
The modified gen p mean: 0.45117026567459106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030352281406521797, decouple_loss:0.0014079711399972439
The modified gen p mean: 0.45050591230392456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030947569757699966, decouple_loss:0.0014530335320159793
Iteration: 1558, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44761812686920166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031381137669086456, decouple_loss:0.001350439852103591
The modified gen p mean: 0.4504365622997284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030139587819576263, decouple_loss:0.0013979380019009113
The modified gen p mean: 0.4504411220550537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033982109278440475, decouple_loss:0.0014924734132364392
Iteration: 1559, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44682222604751587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03024105727672577, decouple_loss:0.001328295562416315
The modified gen p mean: 0.4506889581680298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03235623240470886, decouple_loss:0.0015061839949339628
The modified gen p mean: 0.4469650685787201, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03208807110786438, decouple_loss:0.001425282098352909
Iteration: 1560, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44935768842697144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032350778579711914, decouple_loss:0.0015752658946439624
The modified gen p mean: 0.4477476477622986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03170899301767349, decouple_loss:0.0014798998599871993
The modified gen p mean: 0.45063719153404236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030996423214673996, decouple_loss:0.0014988175826147199
2023-05-26 14:13:37 testing...
The modified gen p mean: 0.45093902945518494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03202467039227486, decouple_loss:0.0015916661359369755
The modified gen p mean: 0.45086467266082764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03360908478498459, decouple_loss:0.0016131966840475798
The modified gen p mean: 0.4492322504520416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03234579414129257, decouple_loss:0.0014553595101460814
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032737523317337036, avg_mse: 0.04424554109573364
current test mse: 0.044246
Iteration: 1561, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44811081886291504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030631110072135925, decouple_loss:0.0015445542521774769
The modified gen p mean: 0.44599267840385437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03146436810493469, decouple_loss:0.0014711992116644979
The modified gen p mean: 0.4498037099838257, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031138615682721138, decouple_loss:0.0013799029402434826
Iteration: 1562, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44862043857574463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030725495889782906, decouple_loss:0.0015156810404732823
The modified gen p mean: 0.4484771490097046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033384405076503754, decouple_loss:0.001410478726029396
The modified gen p mean: 0.44969338178634644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032766398042440414, decouple_loss:0.001437056576833129
Iteration: 1563, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45201554894447327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031836606562137604, decouple_loss:0.0015598968602716923
The modified gen p mean: 0.45223715901374817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029109463095664978, decouple_loss:0.00148007832467556
The modified gen p mean: 0.4515173137187958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03120199777185917, decouple_loss:0.0015889933565631509
Iteration: 1564, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514234662055969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03276944160461426, decouple_loss:0.001401410554535687
The modified gen p mean: 0.45055750012397766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03042040579020977, decouple_loss:0.001443606917746365
The modified gen p mean: 0.4560035169124603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03123204968869686, decouple_loss:0.0015426385216414928
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr.npz
NaN value num: 0
Iteration: 1565, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45416876673698425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0317443311214447, decouple_loss:0.0016224682331085205
The modified gen p mean: 0.4525633752346039, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03281624615192413, decouple_loss:0.0015966122737154365
The modified gen p mean: 0.4535335898399353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03332718834280968, decouple_loss:0.00144613953307271
Iteration: 1566, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514547288417816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031470246613025665, decouple_loss:0.0014891976024955511
The modified gen p mean: 0.45150378346443176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03198111802339554, decouple_loss:0.001453648554161191
The modified gen p mean: 0.4492226243019104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03275210037827492, decouple_loss:0.0015442338772118092
Iteration: 1567, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45165354013442993, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032106250524520874, decouple_loss:0.0016649023164063692
The modified gen p mean: 0.4522171914577484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03205840289592743, decouple_loss:0.0014436737401410937
The modified gen p mean: 0.45036908984184265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032812442630529404, decouple_loss:0.001515184878371656
Iteration: 1568, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45140284299850464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031167825683951378, decouple_loss:0.0016121885273605585
The modified gen p mean: 0.45306748151779175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0306598749011755, decouple_loss:0.001910328515805304
The modified gen p mean: 0.45239484310150146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030620921403169632, decouple_loss:0.0017266051145270467
Iteration: 1569, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44913676381111145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03379879519343376, decouple_loss:0.0015088742366060615
The modified gen p mean: 0.44919925928115845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030833568423986435, decouple_loss:0.0014969197800382972
The modified gen p mean: 0.4538876414299011, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03112458623945713, decouple_loss:0.001490255817770958
Iteration: 1570, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501253366470337, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03222232311964035, decouple_loss:0.001559997326694429
The modified gen p mean: 0.4493594467639923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03194839507341385, decouple_loss:0.0013720144052058458
The modified gen p mean: 0.448647677898407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03305734321475029, decouple_loss:0.0015177024761214852
2023-05-26 14:18:30 testing...
The modified gen p mean: 0.4521944224834442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03190464526414871, decouple_loss:0.0015941596357151866
The modified gen p mean: 0.45061635971069336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03228622302412987, decouple_loss:0.0014649225631728768
The modified gen p mean: 0.4522113800048828, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03345910459756851, decouple_loss:0.0016513620503246784
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03262849897146225, avg_mse: 0.04401455447077751
current test mse: 0.044015
Iteration: 1571, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484771490097046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03202725574374199, decouple_loss:0.0015145611250773072
The modified gen p mean: 0.44652846455574036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031160535290837288, decouple_loss:0.0014718376332893968
The modified gen p mean: 0.4485336244106293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03172117471694946, decouple_loss:0.0013930090935900807
Iteration: 1572, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451171875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254134580492973, decouple_loss:0.0015079264994710684
The modified gen p mean: 0.44909146428108215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031628839671611786, decouple_loss:0.001535414019599557
The modified gen p mean: 0.45008331537246704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030781542882323265, decouple_loss:0.0014070101315155625
Iteration: 1573, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495197832584381, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03241296112537384, decouple_loss:0.001539934310130775
The modified gen p mean: 0.4455071687698364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032430555671453476, decouple_loss:0.0014739750185981393
The modified gen p mean: 0.4445926249027252, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031200164929032326, decouple_loss:0.001471240073442459
Iteration: 1574, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479837119579315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032269787043333054, decouple_loss:0.0015652603469789028
The modified gen p mean: 0.44933921098709106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03083919733762741, decouple_loss:0.0014114172663539648
The modified gen p mean: 0.44452425837516785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033044103533029556, decouple_loss:0.0013177350629121065
Iteration: 1575, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484531283378601, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030725888907909393, decouple_loss:0.0016477970639243722
The modified gen p mean: 0.4471617341041565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03194635361433029, decouple_loss:0.0014311943668872118
The modified gen p mean: 0.44462883472442627, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03128344193100929, decouple_loss:0.0013704982120543718
Iteration: 1576, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459144175052643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032547105103731155, decouple_loss:0.0015194667503237724
The modified gen p mean: 0.44690030813217163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031595490872859955, decouple_loss:0.001533395261503756
The modified gen p mean: 0.44274529814720154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033136654645204544, decouple_loss:0.0015604947693645954
Iteration: 1577, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44644805788993835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03186122700572014, decouple_loss:0.0014933464117348194
The modified gen p mean: 0.4492260217666626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031085338443517685, decouple_loss:0.001613463507965207
The modified gen p mean: 0.4452339708805084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03201913461089134, decouple_loss:0.0015292760217562318
Iteration: 1578, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442816376686096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03186919912695885, decouple_loss:0.001484663924202323
The modified gen p mean: 0.44735515117645264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032226163893938065, decouple_loss:0.0014765218365937471
The modified gen p mean: 0.4488738179206848, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032965511083602905, decouple_loss:0.0014378014020621777
Iteration: 1579, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506222605705261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031800977885723114, decouple_loss:0.0016272387001663446
The modified gen p mean: 0.4494660496711731, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230896592140198, decouple_loss:0.0013771267840638757
The modified gen p mean: 0.4475264251232147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03183082491159439, decouple_loss:0.0014303370844572783
Iteration: 1580, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44754695892333984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031797856092453, decouple_loss:0.0015137225855141878
The modified gen p mean: 0.4471606910228729, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03118259645998478, decouple_loss:0.0014230423839762807
The modified gen p mean: 0.4505525827407837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03238074481487274, decouple_loss:0.00140253861900419
2023-05-26 14:22:36 testing...
The modified gen p mean: 0.4528433382511139, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031764741986989975, decouple_loss:0.001570201711729169
The modified gen p mean: 0.4530077874660492, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033357683569192886, decouple_loss:0.0015637868782505393
The modified gen p mean: 0.45147451758384705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03220516815781593, decouple_loss:0.001408696174621582
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03251824527978897, avg_mse: 0.04386357590556145
current test mse: 0.043864
Iteration: 1581, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44831591844558716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03174853324890137, decouple_loss:0.001525225699879229
The modified gen p mean: 0.4508862793445587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032454703003168106, decouple_loss:0.001318381167948246
The modified gen p mean: 0.4511127173900604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03225722163915634, decouple_loss:0.0014400468207895756
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1582, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497831165790558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03092551790177822, decouple_loss:0.0014710153918713331
The modified gen p mean: 0.4509660303592682, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028534289449453354, decouple_loss:0.0014911064645275474
The modified gen p mean: 0.447316974401474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02985510043799877, decouple_loss:0.0013823428889736533
Iteration: 1583, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45002320408821106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029036642983555794, decouple_loss:0.0015280420193448663
The modified gen p mean: 0.4471691846847534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031470075249671936, decouple_loss:0.0014681463362649083
The modified gen p mean: 0.44760048389434814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030569827184081078, decouple_loss:0.0013363186735659838
Iteration: 1584, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44980698823928833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02929675206542015, decouple_loss:0.0016159209189936519
The modified gen p mean: 0.4467640221118927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02974759228527546, decouple_loss:0.0013679317198693752
The modified gen p mean: 0.4461360275745392, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029162835329771042, decouple_loss:0.0015068436041474342
Iteration: 1585, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44767194986343384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029961736872792244, decouple_loss:0.0017200926085934043
The modified gen p mean: 0.4455002546310425, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4492660462856293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03035479597747326, decouple_loss:0.0015098669100552797
loss_pred:0.029291875660419464, decouple_loss:0.001486623426899314
Iteration: 1586, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452049434185028, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028607863932847977, decouple_loss:0.0016391921089962125
The modified gen p mean: 0.44704943895339966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029072938486933708, decouple_loss:0.0014963903231546283
The modified gen p mean: 0.4457063674926758, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02745632827281952, decouple_loss:0.001440616324543953
Iteration: 1587, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44262152910232544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03128295764327049, decouple_loss:0.0014201642479747534
The modified gen p mean: 0.44630515575408936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027957959100604057, decouple_loss:0.0014509032480418682
The modified gen p mean: 0.4435727298259735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030621938407421112, decouple_loss:0.0015210661804303527
Iteration: 1588, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461357891559601, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028883136808872223, decouple_loss:0.0017314843134954572
The modified gen p mean: 0.44636210799217224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0287068672478199, decouple_loss:0.0015250775031745434
The modified gen p mean: 0.44484418630599976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029195258393883705, decouple_loss:0.001466888003051281
Iteration: 1589, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472552537918091, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028004880994558334, decouple_loss:0.001454872195608914
The modified gen p mean: 0.44485896825790405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02910444140434265, decouple_loss:0.0015308281872421503
The modified gen p mean: 0.4449976086616516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030481871217489243, decouple_loss:0.0015029868809506297
Iteration: 1590, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44392892718315125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029694054275751114, decouple_loss:0.0014264265773817897
The modified gen p mean: 0.44434258341789246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03045826405286789, decouple_loss:0.0016250525368377566
The modified gen p mean: 0.4432295262813568, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030468417331576347, decouple_loss:0.0015000250423327088
2023-05-26 14:27:34 testing...
The modified gen p mean: 0.4500364065170288, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03195877745747566, decouple_loss:0.0016421652399003506
The modified gen p mean: 0.44847559928894043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03243730962276459, decouple_loss:0.0014829478459432721
The modified gen p mean: 0.45001792907714844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03376303240656853, decouple_loss:0.0016718209953978658
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03279965743422508, avg_mse: 0.04432705044746399
current test mse: 0.044327
Iteration: 1591, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456706643104553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03168248385190964, decouple_loss:0.0015095206908881664
The modified gen p mean: 0.44667255878448486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029887301847338676, decouple_loss:0.001483052154071629
The modified gen p mean: 0.44715747237205505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029363146051764488, decouple_loss:0.001675909967161715
Iteration: 1592, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494880735874176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027675751596689224, decouple_loss:0.0017589827766641974
The modified gen p mean: 0.44873934984207153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02764817886054516, decouple_loss:0.0015634268056601286
The modified gen p mean: 0.4502492845058441, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027654994279146194, decouple_loss:0.0016442236956208944
Iteration: 1593, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44988635182380676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030756240710616112, decouple_loss:0.0014459430240094662
The modified gen p mean: 0.4505033493041992, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029462553560733795, decouple_loss:0.001530112000182271
The modified gen p mean: 0.44613227248191833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02958039939403534, decouple_loss:0.0014274936402216554
Iteration: 1594, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44806402921676636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02993856742978096, decouple_loss:0.0015973367262631655
The modified gen p mean: 0.4556894302368164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02830936200916767, decouple_loss:0.0015998480375856161
The modified gen p mean: 0.44895920157432556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02752341516315937, decouple_loss:0.0016673736972734332
Iteration: 1595, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496666491031647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02996419183909893, decouple_loss:0.0017976899398490787
The modified gen p mean: 0.45036253333091736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029512550681829453, decouple_loss:0.001633314648643136
The modified gen p mean: 0.44827425479888916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030796444043517113, decouple_loss:0.0016585931880399585
Iteration: 1596, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45039302110671997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028371309861540794, decouple_loss:0.0016707386821508408
The modified gen p mean: 0.45056676864624023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030013205483555794, decouple_loss:0.0015955694252625108
The modified gen p mean: 0.4497290253639221, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029001053422689438, decouple_loss:0.0015153423883020878
Iteration: 1597, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483962655067444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028261234983801842, decouple_loss:0.0014200226869434118
The modified gen p mean: 0.4529672861099243, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030164390802383423, decouple_loss:0.001610721810720861
The modified gen p mean: 0.4514751434326172, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02797328680753708, decouple_loss:0.0015382439596578479
Iteration: 1598, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4533347487449646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02964188903570175, decouple_loss:0.0018280291697010398
The modified gen p mean: 0.4503960907459259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028203846886754036, decouple_loss:0.0015509589575231075
The modified gen p mean: 0.4488222599029541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029034629464149475, decouple_loss:0.0015871701762080193
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1599, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45187580585479736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028389403596520424, decouple_loss:0.0014818527270108461
The modified gen p mean: 0.44937998056411743, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44795820116996765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02787114307284355, decouple_loss:0.0015053125098347664
loss_pred:0.02986752986907959, decouple_loss:0.0014388842973858118
Iteration: 1600, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44850659370422363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028437398374080658, decouple_loss:0.001461840351112187
The modified gen p mean: 0.446747750043869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029597021639347076, decouple_loss:0.0015083573525771499
The modified gen p mean: 0.44257834553718567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03003714233636856, decouple_loss:0.0014171106740832329
2023-05-26 14:32:21 testing...
The modified gen p mean: 0.44965746998786926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032478682696819305, decouple_loss:0.0017843716777861118
The modified gen p mean: 0.44789502024650574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03274160251021385, decouple_loss:0.001612941618077457
The modified gen p mean: 0.44950178265571594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034172650426626205, decouple_loss:0.0017277353908866644
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03321639820933342, avg_mse: 0.04503965005278587
current test mse: 0.04504
Iteration: 1601, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44355860352516174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029583845287561417, decouple_loss:0.0014567177277058363
The modified gen p mean: 0.4453321397304535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027081966400146484, decouple_loss:0.001504417392425239
The modified gen p mean: 0.4484887719154358, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02790820226073265, decouple_loss:0.0016057061729952693
Iteration: 1602, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44140496850013733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029755594208836555, decouple_loss:0.0014986034948378801
The modified gen p mean: 0.4395151436328888, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030123498290777206, decouple_loss:0.0013353137765079737
The modified gen p mean: 0.4406106770038605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028552621603012085, decouple_loss:0.0014202643651515245
Iteration: 1603, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44400736689567566, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4417682886123657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027775168418884277, decouple_loss:0.0014782550279051065
loss_pred:0.02956240624189377, decouple_loss:0.001429438591003418
The modified gen p mean: 0.4419829547405243, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028146518394351006, decouple_loss:0.0015023089945316315
Iteration: 1604, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.43973565101623535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029826153069734573, decouple_loss:0.0014216173440217972
The modified gen p mean: 0.441488653421402, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029882170259952545, decouple_loss:0.00143928243778646
The modified gen p mean: 0.44279220700263977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027223654091358185, decouple_loss:0.0015133722918108106
Iteration: 1605, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458179473876953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027240214869379997, decouple_loss:0.0015850478084757924
The modified gen p mean: 0.4470982551574707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0274162907153368, decouple_loss:0.001649439800530672
The modified gen p mean: 0.44359636306762695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027149276807904243, decouple_loss:0.0016527706757187843
Iteration: 1606, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44595256447792053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026803433895111084, decouple_loss:0.0015881716972216964
The modified gen p mean: 0.44259724020957947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029097924008965492, decouple_loss:0.0014894292689859867
The modified gen p mean: 0.44185400009155273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027403319254517555, decouple_loss:0.0014449256705120206
Iteration: 1607, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44537824392318726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02701096422970295, decouple_loss:0.00146040681283921
The modified gen p mean: 0.44513553380966187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029596364125609398, decouple_loss:0.0015257518971338868
The modified gen p mean: 0.4453140199184418, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029328476637601852, decouple_loss:0.001598066184669733
Iteration: 1608, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449372261762619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027315516024827957, decouple_loss:0.0015173355350270867
The modified gen p mean: 0.4477391541004181, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027814675122499466, decouple_loss:0.0014406157424673438
The modified gen p mean: 0.44603055715560913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029271606355905533, decouple_loss:0.0014989451738074422
Iteration: 1609, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473794400691986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029254723340272903, decouple_loss:0.0014216924319043756
The modified gen p mean: 0.44585660099983215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02908671274781227, decouple_loss:0.0014693763805553317
The modified gen p mean: 0.4461483359336853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02707838825881481, decouple_loss:0.0015682281227782369
Iteration: 1610, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468216001987457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028567060828208923, decouple_loss:0.0015436410903930664
The modified gen p mean: 0.4466620981693268, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028892911970615387, decouple_loss:0.0015929925721138716
The modified gen p mean: 0.4452589750289917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02892245724797249, decouple_loss:0.0015912450617179275
2023-05-26 14:36:26 testing...
The modified gen p mean: 0.4525507986545563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03345753997564316, decouple_loss:0.0017185733886435628
The modified gen p mean: 0.4502801299095154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03350602835416794, decouple_loss:0.001571384258568287
The modified gen p mean: 0.4523567259311676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035241857171058655, decouple_loss:0.0016731545329093933
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03415119647979736, avg_mse: 0.046539485454559326
current test mse: 0.046539
Iteration: 1611, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44900867342948914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027095288038253784, decouple_loss:0.001477855839766562
The modified gen p mean: 0.4477764070034027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02696189656853676, decouple_loss:0.0016875335713848472
The modified gen p mean: 0.44712623953819275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02657877467572689, decouple_loss:0.0015708822757005692
Iteration: 1612, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479164183139801, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027096524834632874, decouple_loss:0.0016560276271775365
The modified gen p mean: 0.44875138998031616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02799289859831333, decouple_loss:0.001607397454790771
The modified gen p mean: 0.44617724418640137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028104573488235474, decouple_loss:0.0014198441058397293
Iteration: 1613, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45012399554252625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026952292770147324, decouple_loss:0.0016301453579217196
The modified gen p mean: 0.44634678959846497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027530096471309662, decouple_loss:0.0015104323392733932
The modified gen p mean: 0.449495792388916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02790086157619953, decouple_loss:0.0015342411352321506
Iteration: 1614, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486405849456787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027347352355718613, decouple_loss:0.0016876020235940814
The modified gen p mean: 0.44507426023483276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028531750664114952, decouple_loss:0.0014590355567634106
The modified gen p mean: 0.4487975537776947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026640543714165688, decouple_loss:0.001480947365052998
Iteration: 1615, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461097717285156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027713071554899216, decouple_loss:0.001519234967418015
The modified gen p mean: 0.4428190588951111, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02977536991238594, decouple_loss:0.0014759337063878775
The modified gen p mean: 0.44417667388916016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028758395463228226, decouple_loss:0.001628173515200615
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1616, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441075325012207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0286069605499506, decouple_loss:0.0015100190648809075
The modified gen p mean: 0.44499319791793823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027668168768286705, decouple_loss:0.0015392238274216652
The modified gen p mean: 0.44919541478157043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027439119294285774, decouple_loss:0.0016258113319054246
Iteration: 1617, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466648995876312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027501385658979416, decouple_loss:0.0016353888204321265
The modified gen p mean: 0.4436609745025635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028742600232362747, decouple_loss:0.001423929468728602
The modified gen p mean: 0.4437808394432068, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026891233399510384, decouple_loss:0.001385051291435957
Iteration: 1618, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4432651400566101, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026627998799085617, decouple_loss:0.001657784217968583
The modified gen p mean: 0.4419633448123932, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03046458214521408, decouple_loss:0.0013773912796750665
The modified gen p mean: 0.44798099994659424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02725382335484028, decouple_loss:0.0015732597094029188
Iteration: 1619, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44911348819732666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02653076872229576, decouple_loss:0.0015443268930539489
The modified gen p mean: 0.4429847002029419, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027715444564819336, decouple_loss:0.0013304409803822637
The modified gen p mean: 0.44396713376045227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02817405015230179, decouple_loss:0.0016263817669823766
Iteration: 1620, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44222456216812134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028229158371686935, decouple_loss:0.0015401047421619296
The modified gen p mean: 0.44454941153526306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028431667014956474, decouple_loss:0.001556330593302846
The modified gen p mean: 0.44551536440849304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02851465530693531, decouple_loss:0.0013779728906229138
2023-05-26 14:41:15 testing...
The modified gen p mean: 0.45118626952171326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03291495889425278, decouple_loss:0.0016928520053625107
The modified gen p mean: 0.4490523040294647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03307320177555084, decouple_loss:0.0015417736722156405
The modified gen p mean: 0.4510556161403656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034693192690610886, decouple_loss:0.00168895092792809
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03364251181483269, avg_mse: 0.045748669654130936
current test mse: 0.045749
Iteration: 1621, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466586112976074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027719469740986824, decouple_loss:0.0017495000502094626
The modified gen p mean: 0.44357797503471375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02875581383705139, decouple_loss:0.0013789241202175617
The modified gen p mean: 0.44480034708976746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02818792499601841, decouple_loss:0.0016163202235475183
Iteration: 1622, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44583290815353394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0279416274279356, decouple_loss:0.0013546001864597201
The modified gen p mean: 0.44487541913986206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028453078120946884, decouple_loss:0.0014721967745572329
The modified gen p mean: 0.4482235312461853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028609732165932655, decouple_loss:0.0015260680811479688
Iteration: 1623, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478168487548828, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02770020067691803, decouple_loss:0.0016183193074539304
The modified gen p mean: 0.44684305787086487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02828185260295868, decouple_loss:0.0013250544434413314
The modified gen p mean: 0.4462301433086395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027892261743545532, decouple_loss:0.00160927081014961
Iteration: 1624, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446645587682724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027643917128443718, decouple_loss:0.0014874202897772193
The modified gen p mean: 0.44513368606567383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028575483709573746, decouple_loss:0.0015609184047207236
The modified gen p mean: 0.45022305846214294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028127986937761307, decouple_loss:0.0017016195924952626
Iteration: 1625, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44840022921562195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02689089998602867, decouple_loss:0.0015285350382328033
The modified gen p mean: 0.44691693782806396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029073329642415047, decouple_loss:0.0014683095505461097
The modified gen p mean: 0.4511266052722931, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02640398032963276, decouple_loss:0.0015290470328181982
Iteration: 1626, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464937746524811, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02961193397641182, decouple_loss:0.001424001413397491
The modified gen p mean: 0.44745564460754395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028993628919124603, decouple_loss:0.0014166934415698051
The modified gen p mean: 0.44697150588035583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028325103223323822, decouple_loss:0.0014207374770194292
Iteration: 1627, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44925856590270996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026844218373298645, decouple_loss:0.0016102907247841358
The modified gen p mean: 0.4531667232513428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026458991691470146, decouple_loss:0.0014321095077320933
The modified gen p mean: 0.44929438829421997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02808339335024357, decouple_loss:0.0015870570205152035
Iteration: 1628, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4511381685733795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027351580560207367, decouple_loss:0.001636355766095221
The modified gen p mean: 0.4464697539806366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02873147837817669, decouple_loss:0.0013979716459289193
The modified gen p mean: 0.45024529099464417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027439739555120468, decouple_loss:0.0015485974727198482
Iteration: 1629, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515744149684906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02749144285917282, decouple_loss:0.0015713706379756331
The modified gen p mean: 0.4495950937271118, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028364531695842743, decouple_loss:0.0017382372170686722
The modified gen p mean: 0.4523196220397949, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028413785621523857, decouple_loss:0.001577467774040997
Iteration: 1630, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504376947879791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027600420638918877, decouple_loss:0.0018678115447983146
The modified gen p mean: 0.4521600604057312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02726227603852749, decouple_loss:0.0015692986780777574
The modified gen p mean: 0.4521993398666382, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02675921842455864, decouple_loss:0.0015291929012164474
2023-05-26 14:45:23 testing...
The modified gen p mean: 0.4517088532447815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032951973378658295, decouple_loss:0.0016742420848459005
The modified gen p mean: 0.4518672823905945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03464740142226219, decouple_loss:0.0016716488171368837
The modified gen p mean: 0.4497932195663452, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033123888075351715, decouple_loss:0.0015403713332489133
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033655859529972076, avg_mse: 0.04568999260663986
current test mse: 0.04569
Iteration: 1631, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44855064153671265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029000550508499146, decouple_loss:0.0015693425666540861
The modified gen p mean: 0.44581446051597595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02618403173983097, decouple_loss:0.0014812842709943652
The modified gen p mean: 0.4523394703865051, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027606254443526268, decouple_loss:0.0015342321712523699
Iteration: 1632, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453941583633423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027347348630428314, decouple_loss:0.0015975125133991241
The modified gen p mean: 0.44899359345436096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027721907943487167, decouple_loss:0.0014184978790581226
The modified gen p mean: 0.44705143570899963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02765340358018875, decouple_loss:0.0015198378823697567
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1633, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44133272767066956, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4428768754005432, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028109807521104813, decouple_loss:0.0014725473010912538
loss_pred:0.02813529781997204, decouple_loss:0.0014497875235974789
The modified gen p mean: 0.4423447549343109, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028340866789221764, decouple_loss:0.0015038872370496392
Iteration: 1634, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499296247959137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02667325548827648, decouple_loss:0.0017495580250397325
The modified gen p mean: 0.44231802225112915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02880435436964035, decouple_loss:0.0014759943587705493
The modified gen p mean: 0.44771939516067505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026980815455317497, decouple_loss:0.0016248766332864761
Iteration: 1635, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44295236468315125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029177552089095116, decouple_loss:0.0014993997756391764
The modified gen p mean: 0.444365531206131, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027770865708589554, decouple_loss:0.00136054668109864
The modified gen p mean: 0.4465959966182709, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027816765010356903, decouple_loss:0.0016797491116449237
Iteration: 1636, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44607314467430115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820388600230217, decouple_loss:0.0017015099292621017
The modified gen p mean: 0.4492819011211395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027157098054885864, decouple_loss:0.0015480940928682685
The modified gen p mean: 0.44649890065193176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02651257999241352, decouple_loss:0.0016555693000555038
Iteration: 1637, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485395550727844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027639731764793396, decouple_loss:0.0016358583234250546
The modified gen p mean: 0.4459216594696045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029396701604127884, decouple_loss:0.001618803828023374
The modified gen p mean: 0.44906798005104065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02639259770512581, decouple_loss:0.0015891182702034712
Iteration: 1638, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4431873857975006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027697669342160225, decouple_loss:0.0014219298027455807
The modified gen p mean: 0.4454653263092041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026992226019501686, decouple_loss:0.0015141343465074897
The modified gen p mean: 0.44571301341056824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02923540398478508, decouple_loss:0.0015943010803312063
Iteration: 1639, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44912806153297424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02768913097679615, decouple_loss:0.0017303485656157136
The modified gen p mean: 0.44941025972366333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027009161189198494, decouple_loss:0.0015035381074994802
The modified gen p mean: 0.4462047517299652, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028591588139533997, decouple_loss:0.0017352718859910965
Iteration: 1640, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480264186859131, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690442092716694, decouple_loss:0.0015598088502883911
The modified gen p mean: 0.44529658555984497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028095027431845665, decouple_loss:0.001664021867327392
The modified gen p mean: 0.44550082087516785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02892502024769783, decouple_loss:0.0015522349858656526
2023-05-26 14:50:14 testing...
The modified gen p mean: 0.4528401792049408, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033582914620637894, decouple_loss:0.0017348952824249864
The modified gen p mean: 0.4507628381252289, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0336737185716629, decouple_loss:0.0015892722876742482
The modified gen p mean: 0.45295819640159607, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035501979291439056, decouple_loss:0.0017627687193453312
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03433765470981598, avg_mse: 0.04687049984931946
current test mse: 0.04687
Iteration: 1641, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470376670360565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027526509016752243, decouple_loss:0.0014143545413389802
The modified gen p mean: 0.4510754644870758, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027191510424017906, decouple_loss:0.001540379598736763
The modified gen p mean: 0.4451390206813812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028256796300411224, decouple_loss:0.0014768727123737335
Iteration: 1642, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455885887145996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028784973546862602, decouple_loss:0.001404128735885024
The modified gen p mean: 0.44598135352134705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027676213532686234, decouple_loss:0.001544356462545693
The modified gen p mean: 0.4459514915943146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0276942178606987, decouple_loss:0.001514633884653449
Iteration: 1643, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45110416412353516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027034100145101547, decouple_loss:0.0016048896359279752
The modified gen p mean: 0.4437297284603119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027307653799653053, decouple_loss:0.0015021616127341986
The modified gen p mean: 0.4463610351085663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027230337262153625, decouple_loss:0.0016659731045365334
Iteration: 1644, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4440385699272156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027573861181735992, decouple_loss:0.001516728545539081
The modified gen p mean: 0.4470593333244324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027089515700936317, decouple_loss:0.0014869923470541835
The modified gen p mean: 0.4473972022533417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02725370042026043, decouple_loss:0.00151914544403553
Iteration: 1645, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44340428709983826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02808982878923416, decouple_loss:0.0016021656338125467
The modified gen p mean: 0.44565677642822266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026669081300497055, decouple_loss:0.0015975370770320296
The modified gen p mean: 0.44339919090270996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026974139735102654, decouple_loss:0.0015113574918359518
Iteration: 1646, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4423547089099884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02760007046163082, decouple_loss:0.0016021603951230645
The modified gen p mean: 0.44389140605926514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028171518817543983, decouple_loss:0.0014431907329708338
The modified gen p mean: 0.4446994960308075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02911166101694107, decouple_loss:0.0015182048082351685
Iteration: 1647, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4436984360218048, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027745286002755165, decouple_loss:0.0014850767329335213
The modified gen p mean: 0.44652989506721497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026927590370178223, decouple_loss:0.0017343509243801236
The modified gen p mean: 0.4479188621044159, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026768291369080544, decouple_loss:0.0017601025756448507
Iteration: 1648, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438652992248535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02685498632490635, decouple_loss:0.0019186268327757716
The modified gen p mean: 0.44310346245765686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02735915407538414, decouple_loss:0.0015362189151346684
The modified gen p mean: 0.44548535346984863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026842908933758736, decouple_loss:0.0016624840209260583
Iteration: 1649, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4430171847343445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027704719454050064, decouple_loss:0.0014197428245097399
The modified gen p mean: 0.44862642884254456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026678498834371567, decouple_loss:0.0016529946587979794
The modified gen p mean: 0.44554466009140015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027298998087644577, decouple_loss:0.0016589779406785965
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr.npz
NaN value num: 0
Iteration: 1650, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507533609867096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03430712968111038, decouple_loss:0.0015370708424597979
The modified gen p mean: 0.4502018690109253, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44426974654197693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02873031236231327, decouple_loss:0.0013899700716137886
loss_pred:0.03174537047743797, decouple_loss:0.0015548825031146407
2023-05-26 14:55:04 testing...
The modified gen p mean: 0.45298317074775696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032654985785484314, decouple_loss:0.001726818853057921
The modified gen p mean: 0.4510612189769745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03280068561434746, decouple_loss:0.0015813116915524006
The modified gen p mean: 0.4529998302459717, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03425317257642746, decouple_loss:0.0016945310635492206
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033319659531116486, avg_mse: 0.045284636318683624
current test mse: 0.045285
Iteration: 1651, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494449198246002, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031002555042505264, decouple_loss:0.001592549728229642
The modified gen p mean: 0.44747859239578247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03032040037214756, decouple_loss:0.0014158963458612561
The modified gen p mean: 0.4484158456325531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03326624259352684, decouple_loss:0.0015335234347730875
Iteration: 1652, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497721493244171, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031838782131671906, decouple_loss:0.0015899906866252422
The modified gen p mean: 0.45507755875587463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254023566842079, decouple_loss:0.0018181654158979654
The modified gen p mean: 0.45346254110336304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033999182283878326, decouple_loss:0.0015393018256872892
Iteration: 1653, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509975016117096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03176334127783775, decouple_loss:0.0014821271179243922
The modified gen p mean: 0.45499536395072937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0317876823246479, decouple_loss:0.0016033394495025277
The modified gen p mean: 0.45252734422683716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031118933111429214, decouple_loss:0.0014609349891543388
Iteration: 1654, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534984529018402, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03183964267373085, decouple_loss:0.0015498000429943204
The modified gen p mean: 0.45545899868011475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032701484858989716, decouple_loss:0.0014840688090771437
The modified gen p mean: 0.4537738263607025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03126778081059456, decouple_loss:0.0014955385122448206
Iteration: 1655, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45841532945632935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02930377423763275, decouple_loss:0.0014214948751032352
The modified gen p mean: 0.4552294909954071, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031193764880299568, decouple_loss:0.0015649842098355293
The modified gen p mean: 0.455969899892807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259049355983734, decouple_loss:0.0015096471179276705
Iteration: 1656, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4548863172531128, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033413756638765335, decouple_loss:0.0014610326616093516
The modified gen p mean: 0.4551931619644165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03165462613105774, decouple_loss:0.0015497920103371143
The modified gen p mean: 0.45428308844566345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03238669037818909, decouple_loss:0.0013966099359095097
Iteration: 1657, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4556412398815155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034012023359537125, decouple_loss:0.0015049189096316695
The modified gen p mean: 0.4514927268028259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03407343849539757, decouple_loss:0.0015787385636940598
The modified gen p mean: 0.4531828463077545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03149858117103577, decouple_loss:0.0014815828762948513
Iteration: 1658, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45014384388923645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03178480640053749, decouple_loss:0.0014348834520205855
The modified gen p mean: 0.45109349489212036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251143544912338, decouple_loss:0.0014225313207134604
The modified gen p mean: 0.4542357623577118, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03187096118927002, decouple_loss:0.001638866262510419
Iteration: 1659, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44758352637290955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03240196034312248, decouple_loss:0.0013915603049099445
The modified gen p mean: 0.4489709734916687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03153131157159805, decouple_loss:0.0013018843019381166
The modified gen p mean: 0.45093902945518494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032321590930223465, decouple_loss:0.0016660988330841064
Iteration: 1660, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45269298553466797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03288350999355316, decouple_loss:0.0015419977717101574
The modified gen p mean: 0.4508976340293884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030929094180464745, decouple_loss:0.001475900411605835
The modified gen p mean: 0.4484313130378723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03142368048429489, decouple_loss:0.0014675292186439037
2023-05-26 14:59:11 testing...
The modified gen p mean: 0.451114684343338, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03214845433831215, decouple_loss:0.0016084323870018125
The modified gen p mean: 0.45095643401145935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033611517399549484, decouple_loss:0.0016452311538159847
The modified gen p mean: 0.4492913484573364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032343827188014984, decouple_loss:0.0015121394535526633
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03278069943189621, avg_mse: 0.04431900754570961
current test mse: 0.044319
Iteration: 1661, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482508897781372, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030432021245360374, decouple_loss:0.0013648130698129535
The modified gen p mean: 0.4465608596801758, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031337350606918335, decouple_loss:0.0013911658897995949
The modified gen p mean: 0.4474918842315674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03117111511528492, decouple_loss:0.0013997397618368268
Iteration: 1662, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460883140563965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03238213434815407, decouple_loss:0.0014593139057978988
The modified gen p mean: 0.4477940499782562, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03244023397564888, decouple_loss:0.0015314789488911629
The modified gen p mean: 0.4458461105823517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031147189438343048, decouple_loss:0.0014411915326490998
Iteration: 1663, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462493360042572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031600870192050934, decouple_loss:0.0013571332674473524
The modified gen p mean: 0.44582822918891907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031098369508981705, decouple_loss:0.0015055045951157808
The modified gen p mean: 0.44582584500312805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032065216451883316, decouple_loss:0.0014446229906752706
Iteration: 1664, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491707682609558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03275582939386368, decouple_loss:0.001466334448195994
The modified gen p mean: 0.4478690028190613, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03240349516272545, decouple_loss:0.0016206862637773156
The modified gen p mean: 0.4472295641899109, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03179359808564186, decouple_loss:0.0015032239025458694
Iteration: 1665, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44853490591049194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031840886920690536, decouple_loss:0.001513507915660739
The modified gen p mean: 0.44785261154174805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03149282932281494, decouple_loss:0.001540562603622675
The modified gen p mean: 0.44974759221076965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031201090663671494, decouple_loss:0.0015648938715457916
Iteration: 1666, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492192566394806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031559016555547714, decouple_loss:0.0014996117679402232
The modified gen p mean: 0.4516073167324066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030901659280061722, decouple_loss:0.0017599660204723477
The modified gen p mean: 0.4480457007884979, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031827446073293686, decouple_loss:0.0013644675491377711
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1667, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512666165828705, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44886818528175354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029499156400561333, decouple_loss:0.0015148092061281204
loss_pred:0.03036239743232727, decouple_loss:0.0014853514730930328The modified gen p mean: 0.44961532950401306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027770716696977615, decouple_loss:0.001599712180905044
Iteration: 1668, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518754184246063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02804214134812355, decouple_loss:0.0015441352734342217
The modified gen p mean: 0.44833511114120483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0292077474296093, decouple_loss:0.0015214045997709036
The modified gen p mean: 0.4543874263763428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028491854667663574, decouple_loss:0.0014975228114053607
Iteration: 1669, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45188814401626587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02952183410525322, decouple_loss:0.0016892895800992846
The modified gen p mean: 0.449971467256546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029169073328375816, decouple_loss:0.001541566802188754
The modified gen p mean: 0.44954636693000793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030019192025065422, decouple_loss:0.001642639166675508
Iteration: 1670, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44925352931022644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02851671539247036, decouple_loss:0.0016144553665071726
The modified gen p mean: 0.44820594787597656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029381057247519493, decouple_loss:0.001754844095557928
The modified gen p mean: 0.44922059774398804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029447905719280243, decouple_loss:0.0016134426696226
2023-05-26 15:03:54 testing...
The modified gen p mean: 0.45287102460861206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03212311118841171, decouple_loss:0.0016595338238403201
The modified gen p mean: 0.45105791091918945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032427866011857986, decouple_loss:0.0015745168784633279
The modified gen p mean: 0.4526400566101074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033705778419971466, decouple_loss:0.001710809301584959
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03283466771245003, avg_mse: 0.04430240020155907
current test mse: 0.044302
Iteration: 1671, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44642174243927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029273707419633865, decouple_loss:0.0016185451531782746
The modified gen p mean: 0.44833865761756897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026668516919016838, decouple_loss:0.0016149954171851277
The modified gen p mean: 0.45292219519615173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027116898447275162, decouple_loss:0.0016192290931940079
Iteration: 1672, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44915249943733215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028320608660578728, decouple_loss:0.0015373488422483206
The modified gen p mean: 0.4478016197681427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027514377608895302, decouple_loss:0.0018261141376569867
The modified gen p mean: 0.44835177063941956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02874506451189518, decouple_loss:0.0016371691599488258
Iteration: 1673, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4437240958213806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02948252484202385, decouple_loss:0.0015500474255532026
The modified gen p mean: 0.4438221752643585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028980113565921783, decouple_loss:0.0014823699602857232
The modified gen p mean: 0.44654715061187744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02902546338737011, decouple_loss:0.001619628514163196
Iteration: 1674, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44245168566703796, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4451283812522888, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029732421040534973, decouple_loss:0.0015915428521111608
loss_pred:0.028808247298002243, decouple_loss:0.0018123423215001822
The modified gen p mean: 0.44343799352645874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028879208490252495, decouple_loss:0.0016171288443729281
Iteration: 1675, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44451138377189636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028049582615494728, decouple_loss:0.0016439512837678194
The modified gen p mean: 0.44300124049186707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028989475220441818, decouple_loss:0.0015821204287931323
The modified gen p mean: 0.44109246134757996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026296086609363556, decouple_loss:0.001570200896821916
Iteration: 1676, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44520068168640137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027976712211966515, decouple_loss:0.0015960248420014977
The modified gen p mean: 0.443942666053772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027987461537122726, decouple_loss:0.0017539040418341756
The modified gen p mean: 0.4452011287212372, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0275313388556242, decouple_loss:0.00154356739949435
Iteration: 1677, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44380876421928406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02912234701216221, decouple_loss:0.001548711210489273
The modified gen p mean: 0.449756920337677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02710828185081482, decouple_loss:0.001509902998805046
The modified gen p mean: 0.4445652365684509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028928767889738083, decouple_loss:0.0015568757662549615
Iteration: 1678, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491560161113739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027677617967128754, decouple_loss:0.0015351915499195457
The modified gen p mean: 0.44680285453796387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028445059433579445, decouple_loss:0.0016586945857852697
The modified gen p mean: 0.4508194625377655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027016907930374146, decouple_loss:0.0015623035142198205
Iteration: 1679, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44893985986709595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028339968994259834, decouple_loss:0.001718321698717773
The modified gen p mean: 0.44899043440818787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02802969515323639, decouple_loss:0.0017571334028616548
The modified gen p mean: 0.44563719630241394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02924165688455105, decouple_loss:0.0016421504551544785
Iteration: 1680, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44773322343826294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02764105796813965, decouple_loss:0.0016488319961354136
The modified gen p mean: 0.4537163972854614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026384172961115837, decouple_loss:0.001536112162284553
The modified gen p mean: 0.4472716748714447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02963860332965851, decouple_loss:0.001410915283486247
2023-05-26 15:08:01 testing...
The modified gen p mean: 0.4540717601776123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03258358687162399, decouple_loss:0.0017722826451063156
The modified gen p mean: 0.4539041817188263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03424440324306488, decouple_loss:0.0018607163801789284
The modified gen p mean: 0.45229068398475647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03301047533750534, decouple_loss:0.0016737246187403798
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033367931842803955, avg_mse: 0.045241352170705795
current test mse: 0.045241
Iteration: 1681, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45343661308288574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02827688679099083, decouple_loss:0.0015989473322406411
The modified gen p mean: 0.4480559527873993, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026142887771129608, decouple_loss:0.001718826126307249
The modified gen p mean: 0.4502491354942322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030030176043510437, decouple_loss:0.0014760103076696396
Iteration: 1682, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512999355792999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027909809723496437, decouple_loss:0.0016576078487560153
The modified gen p mean: 0.44930315017700195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02828671596944332, decouple_loss:0.0016249521868303418
The modified gen p mean: 0.4472176432609558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02858750708401203, decouple_loss:0.0016637886874377728
Iteration: 1683, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45276176929473877, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02880450338125229, decouple_loss:0.0016013551503419876
The modified gen p mean: 0.447617769241333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02935899794101715, decouple_loss:0.0015477212145924568
The modified gen p mean: 0.4504871964454651, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028559507802128792, decouple_loss:0.001813042676076293
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1684, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481555223464966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030208274722099304, decouple_loss:0.0016343080205842853
The modified gen p mean: 0.4485795795917511, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4490237534046173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029889695346355438, decouple_loss:0.0014340193010866642
loss_pred:0.029438044875860214, decouple_loss:0.0016538649797439575
Iteration: 1685, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4524405598640442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03035065345466137, decouple_loss:0.0017451475141569972
The modified gen p mean: 0.4474802017211914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03133765235543251, decouple_loss:0.0017007077112793922
The modified gen p mean: 0.45160648226737976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03137340396642685, decouple_loss:0.0017732302658259869
Iteration: 1686, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519804120063782, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030212577432394028, decouple_loss:0.0014852063031867146
The modified gen p mean: 0.4504537880420685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03175279498100281, decouple_loss:0.0014710247050970793
The modified gen p mean: 0.4524674415588379, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030587220564484596, decouple_loss:0.001688363146968186
Iteration: 1687, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45303165912628174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029925208538770676, decouple_loss:0.00175503920763731
The modified gen p mean: 0.44983816146850586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029869593679904938, decouple_loss:0.001499868230894208
The modified gen p mean: 0.4523763060569763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03238768130540848, decouple_loss:0.00146411859896034
Iteration: 1688, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534471929073334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030705399811267853, decouple_loss:0.0015959532465785742
The modified gen p mean: 0.4495584964752197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032587260007858276, decouple_loss:0.0015065647894516587
The modified gen p mean: 0.45000433921813965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030193503946065903, decouple_loss:0.0016763708554208279
Iteration: 1689, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45139390230178833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030918104574084282, decouple_loss:0.0016063207294791937
The modified gen p mean: 0.45228737592697144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030803898349404335, decouple_loss:0.0015712107997387648
The modified gen p mean: 0.45205190777778625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031535547226667404, decouple_loss:0.001637097098864615
Iteration: 1690, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44991904497146606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03147511184215546, decouple_loss:0.0015495932893827558
The modified gen p mean: 0.4534970819950104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0308233592659235, decouple_loss:0.0015356461517512798
The modified gen p mean: 0.4514046311378479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032312504947185516, decouple_loss:0.0015167939709499478
2023-05-26 15:12:47 testing...
The modified gen p mean: 0.4553617238998413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032363519072532654, decouple_loss:0.0016955445753410459
The modified gen p mean: 0.4550829827785492, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03406583517789841, decouple_loss:0.001678727101534605
The modified gen p mean: 0.4536013901233673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032669708132743835, decouple_loss:0.0015392052009701729
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03311491012573242, avg_mse: 0.04486474022269249
current test mse: 0.044865
Iteration: 1691, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45293059945106506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031199682503938675, decouple_loss:0.0015893304953351617
The modified gen p mean: 0.4526352882385254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029987631365656853, decouple_loss:0.0016909179976209998
The modified gen p mean: 0.45211461186408997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029933128505945206, decouple_loss:0.001660508569329977
Iteration: 1692, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4537556767463684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02935180626809597, decouple_loss:0.0015174238942563534
The modified gen p mean: 0.45017147064208984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031381744891405106, decouple_loss:0.0014950992772355676
The modified gen p mean: 0.45028331875801086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031121643260121346, decouple_loss:0.0015949137741699815
Iteration: 1693, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44913557171821594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03082123026251793, decouple_loss:0.0014237930299714208
The modified gen p mean: 0.44864413142204285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03144647181034088, decouple_loss:0.0014684583293274045
The modified gen p mean: 0.4491613209247589, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031784575432538986, decouple_loss:0.0013501545181497931
Iteration: 1694, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44969892501831055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031290508806705475, decouple_loss:0.0014109548646956682
The modified gen p mean: 0.446612149477005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03077419474720955, decouple_loss:0.0014563505537807941
The modified gen p mean: 0.4498599171638489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030638158321380615, decouple_loss:0.0015350456815212965
Iteration: 1695, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478181004524231, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031550776213407516, decouple_loss:0.0014775361632928252
The modified gen p mean: 0.44840386509895325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031025487929582596, decouple_loss:0.0013956407783553004
The modified gen p mean: 0.44702616333961487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03131553903222084, decouple_loss:0.0013177415821701288
Iteration: 1696, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446867972612381, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03062279149889946, decouple_loss:0.0014931733021512628
The modified gen p mean: 0.4449886977672577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0326119065284729, decouple_loss:0.001498947269283235
The modified gen p mean: 0.44711166620254517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031652532517910004, decouple_loss:0.0015797690721228719
Iteration: 1697, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458496570587158, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029882581904530525, decouple_loss:0.0014210406225174665
The modified gen p mean: 0.4469911456108093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031168607994914055, decouple_loss:0.0016782062593847513
The modified gen p mean: 0.446072518825531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03000684268772602, decouple_loss:0.0016706062015146017
Iteration: 1698, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497792422771454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031197192147374153, decouple_loss:0.0015858457190915942
The modified gen p mean: 0.4464729428291321, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03187418356537819, decouple_loss:0.0013500155182555318
The modified gen p mean: 0.4475189745426178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03079088404774666, decouple_loss:0.0014509224565699697
Iteration: 1699, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45170530676841736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03099662810564041, decouple_loss:0.0015305025735870004
The modified gen p mean: 0.4475781321525574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030660243704915047, decouple_loss:0.0014193154638633132
The modified gen p mean: 0.44660693407058716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03137243539094925, decouple_loss:0.0013481371570378542
Iteration: 1700, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499954283237457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030857324600219727, decouple_loss:0.001388721982948482
The modified gen p mean: 0.4510755240917206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030281005427241325, decouple_loss:0.0014379461063072085
The modified gen p mean: 0.44765782356262207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031052902340888977, decouple_loss:0.001422978239133954
2023-05-26 15:16:54 testing...
The modified gen p mean: 0.4531349837779999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032140448689460754, decouple_loss:0.001728300005197525
The modified gen p mean: 0.451455295085907, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4529767632484436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03244532272219658, decouple_loss:0.001494689262472093
loss_pred:0.03378579765558243, decouple_loss:0.0016644032439216971
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032871976494789124, avg_mse: 0.04448842257261276
current test mse: 0.044488
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1701, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45234405994415283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02737036719918251, decouple_loss:0.0015851549105718732
The modified gen p mean: 0.45181453227996826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027079373598098755, decouple_loss:0.0014438880607485771
The modified gen p mean: 0.4480105936527252, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028388777747750282, decouple_loss:0.00142730085644871
Iteration: 1702, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493105709552765, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44752994179725647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028489932417869568, decouple_loss:0.0014512616908177733
loss_pred:0.029011381790041924, decouple_loss:0.0013603197876363993
The modified gen p mean: 0.44811540842056274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02796976827085018, decouple_loss:0.001346700475551188
Iteration: 1703, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44773566722869873, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44667482376098633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02812095545232296, decouple_loss:0.0014226336497813463
loss_pred:0.029148738831281662, decouple_loss:0.0015583725180476904
The modified gen p mean: 0.44851115345954895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028145667165517807, decouple_loss:0.0014361093053594232
Iteration: 1704, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4448357820510864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02821195311844349, decouple_loss:0.0014722897903993726
The modified gen p mean: 0.4465133249759674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027919951826334, decouple_loss:0.0015225466340780258
The modified gen p mean: 0.44994986057281494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026620352640748024, decouple_loss:0.0014767602551728487
Iteration: 1705, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471426010131836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027581822127103806, decouple_loss:0.001451950054615736
The modified gen p mean: 0.4448190927505493, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027704978361725807, decouple_loss:0.0014230372617021203
The modified gen p mean: 0.4463857114315033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027933981269598007, decouple_loss:0.0014020312810316682
Iteration: 1706, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4437572956085205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02965738996863365, decouple_loss:0.0015007525216788054
The modified gen p mean: 0.4442950487136841, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02780393697321415, decouple_loss:0.0015718891518190503
The modified gen p mean: 0.4504648447036743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02792154625058174, decouple_loss:0.001544104190543294
Iteration: 1707, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443681836128235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030035395175218582, decouple_loss:0.0014100540429353714
The modified gen p mean: 0.44768026471138, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02663312666118145, decouple_loss:0.001397949643433094
The modified gen p mean: 0.44595348834991455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028351405635476112, decouple_loss:0.0013884019572287798
Iteration: 1708, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44320374727249146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028715653344988823, decouple_loss:0.0016677118837833405
The modified gen p mean: 0.44751429557800293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026969516649842262, decouple_loss:0.001454184646718204
The modified gen p mean: 0.44764575362205505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028635691851377487, decouple_loss:0.0013724451418966055
Iteration: 1709, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44419142603874207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02816239930689335, decouple_loss:0.0015391717897728086
The modified gen p mean: 0.44520777463912964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02782791294157505, decouple_loss:0.0014509728644043207
The modified gen p mean: 0.44820547103881836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027935290709137917, decouple_loss:0.00165198661852628
Iteration: 1710, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458843171596527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02677779272198677, decouple_loss:0.0015822169370949268
The modified gen p mean: 0.44610530138015747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029178107157349586, decouple_loss:0.0014715446159243584
The modified gen p mean: 0.44658929109573364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02779221162199974, decouple_loss:0.0015490035293623805
2023-05-26 15:21:41 testing...
The modified gen p mean: 0.45180743932724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03236640617251396, decouple_loss:0.0016762990271672606
The modified gen p mean: 0.45170286297798157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034127503633499146, decouple_loss:0.0016478594625368714
The modified gen p mean: 0.45027175545692444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03271510452032089, decouple_loss:0.001503917039372027
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033150140196084976, avg_mse: 0.044967517256736755
current test mse: 0.044968
Iteration: 1711, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44824010133743286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027965717017650604, decouple_loss:0.0014830066356807947
The modified gen p mean: 0.44629231095314026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028873592615127563, decouple_loss:0.001655195839703083
The modified gen p mean: 0.4469663202762604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028788499534130096, decouple_loss:0.0014165104366838932
Iteration: 1712, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44847002625465393, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027912277728319168, decouple_loss:0.0016557384515181184
The modified gen p mean: 0.44870612025260925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02867819555103779, decouple_loss:0.0015997772570699453
The modified gen p mean: 0.4501645863056183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027587054297327995, decouple_loss:0.0015223128721117973
Iteration: 1713, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44984498620033264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027173658832907677, decouple_loss:0.001533218310214579
The modified gen p mean: 0.4512149393558502, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02768680825829506, decouple_loss:0.0016284930752590299
The modified gen p mean: 0.446042001247406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027885086834430695, decouple_loss:0.001846115104854107
Iteration: 1714, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45059657096862793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02767234854400158, decouple_loss:0.0014660840388387442
The modified gen p mean: 0.4502120018005371, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027661459520459175, decouple_loss:0.0015869701746851206
The modified gen p mean: 0.45219236612319946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02660776488482952, decouple_loss:0.0014745104126632214
Iteration: 1715, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4533100724220276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027254614979028702, decouple_loss:0.001498125959187746
The modified gen p mean: 0.4490679204463959, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027509482577443123, decouple_loss:0.0015009625349193811
The modified gen p mean: 0.4490017890930176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027686243876814842, decouple_loss:0.001531396759673953
Iteration: 1716, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465197026729584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02746610902249813, decouple_loss:0.001657844171859324
The modified gen p mean: 0.45153310894966125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02748843841254711, decouple_loss:0.001714639482088387
The modified gen p mean: 0.44741135835647583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029080986976623535, decouple_loss:0.0015298478538170457
Iteration: 1717, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44762274622917175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027896415442228317, decouple_loss:0.0014885151758790016
The modified gen p mean: 0.4495334327220917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02827472798526287, decouple_loss:0.001732014468871057
The modified gen p mean: 0.4473112225532532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027157969772815704, decouple_loss:0.0014179337304085493
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr.npz
NaN value num: 0
Iteration: 1718, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44728976488113403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02851317636668682, decouple_loss:0.001599738490767777
The modified gen p mean: 0.45108920335769653, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44799941778182983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028070930391550064, decouple_loss:0.001572081120684743
loss_pred:0.02862030640244484, decouple_loss:0.0019069541012868285
Iteration: 1719, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485152065753937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026861783117055893, decouple_loss:0.001611732179298997
The modified gen p mean: 0.44745150208473206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02814050018787384, decouple_loss:0.001770573784597218
The modified gen p mean: 0.44402116537094116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02825246751308441, decouple_loss:0.001501389779150486
Iteration: 1720, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44896525144577026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027778316289186478, decouple_loss:0.0015517334686592221
The modified gen p mean: 0.44700783491134644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028247393667697906, decouple_loss:0.0015330684836953878
The modified gen p mean: 0.44813093543052673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026597775518894196, decouple_loss:0.0014835241017863154
2023-05-26 15:26:29 testing...
The modified gen p mean: 0.44825655221939087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032554544508457184, decouple_loss:0.0017070552567020059
The modified gen p mean: 0.44664058089256287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283409774303436, decouple_loss:0.001519440789707005
The modified gen p mean: 0.4481063187122345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034341901540756226, decouple_loss:0.001726160873658955
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03332605957984924, avg_mse: 0.045385491102933884
current test mse: 0.045385
Iteration: 1721, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44630733132362366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027643686160445213, decouple_loss:0.0016521179350093007
The modified gen p mean: 0.44137120246887207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028128668665885925, decouple_loss:0.0014625679468736053
The modified gen p mean: 0.44567546248435974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02818593755364418, decouple_loss:0.0014035877538844943
Iteration: 1722, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4418942630290985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029801703989505768, decouple_loss:0.0015306520508602262
The modified gen p mean: 0.44287458062171936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029991740360856056, decouple_loss:0.0015775475185364485
The modified gen p mean: 0.44460344314575195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027767665684223175, decouple_loss:0.001503745443187654
Iteration: 1723, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44259804487228394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028735820204019547, decouple_loss:0.0014888569712638855
The modified gen p mean: 0.44253844022750854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02731628529727459, decouple_loss:0.0014490137109532952
The modified gen p mean: 0.4468124806880951, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027911517769098282, decouple_loss:0.001860997756011784
Iteration: 1724, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487736225128174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028000369668006897, decouple_loss:0.0015124119818210602
The modified gen p mean: 0.44217783212661743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027824431657791138, decouple_loss:0.001450789044611156
The modified gen p mean: 0.4435405433177948, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02857823111116886, decouple_loss:0.0014055061619728804
Iteration: 1725, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44603976607322693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028411412611603737, decouple_loss:0.001445264439098537
The modified gen p mean: 0.4518987536430359, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02743201144039631, decouple_loss:0.0017300659092143178
The modified gen p mean: 0.4460469186306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02953958325088024, decouple_loss:0.0014179949648678303
Iteration: 1726, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44756680727005005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02831091731786728, decouple_loss:0.0015420758863911033
The modified gen p mean: 0.4462962746620178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028202136978507042, decouple_loss:0.001478537218645215
The modified gen p mean: 0.44900834560394287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771054022014141, decouple_loss:0.0013852427946403623
Iteration: 1727, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500539302825928, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027689151465892792, decouple_loss:0.0016065873205661774
The modified gen p mean: 0.4542335867881775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0276486799120903, decouple_loss:0.001665464136749506
The modified gen p mean: 0.4478091299533844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027202287688851357, decouple_loss:0.001372656086459756
Iteration: 1728, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45042863488197327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02762233279645443, decouple_loss:0.00155679602175951
The modified gen p mean: 0.45439785718917847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027949007228016853, decouple_loss:0.0020280659664422274
The modified gen p mean: 0.453752726316452, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027365075424313545, decouple_loss:0.0015777212101966143
Iteration: 1729, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44827884435653687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028459789231419563, decouple_loss:0.001564966281875968
The modified gen p mean: 0.44992366433143616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027183448895812035, decouple_loss:0.0014920717803761363
The modified gen p mean: 0.44922810792922974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027645254507660866, decouple_loss:0.0014117842074483633
Iteration: 1730, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479660391807556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027942873537540436, decouple_loss:0.0014785185921937227
The modified gen p mean: 0.4554860591888428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02768152952194214, decouple_loss:0.0014993434306234121
The modified gen p mean: 0.4533328711986542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027643244713544846, decouple_loss:0.0017615706892684102
2023-05-26 15:30:38 testing...
The modified gen p mean: 0.45303377509117126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255413472652435, decouple_loss:0.0016502499347552657
The modified gen p mean: 0.45143216848373413, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45301559567451477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032689135521650314, decouple_loss:0.0014994848752394319
loss_pred:0.03426700085401535, decouple_loss:0.0016470293048769236
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03325003385543823, avg_mse: 0.045210689306259155
current test mse: 0.045211
Iteration: 1731, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45101815462112427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028412414714694023, decouple_loss:0.001519406563602388
The modified gen p mean: 0.44930821657180786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027113355696201324, decouple_loss:0.0013941422803327441
The modified gen p mean: 0.4468047618865967, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027965474873781204, decouple_loss:0.0015142838237807155
Iteration: 1732, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44862645864486694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028610579669475555, decouple_loss:0.0015863956650719047
The modified gen p mean: 0.44641825556755066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028213629499077797, decouple_loss:0.0016335316468030214
The modified gen p mean: 0.45086273550987244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02832665853202343, decouple_loss:0.0015552962431684136
Iteration: 1733, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44575148820877075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027830399572849274, decouple_loss:0.0014895627973601222
The modified gen p mean: 0.44725146889686584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027013521641492844, decouple_loss:0.0015700733056291938
The modified gen p mean: 0.4480019807815552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02753317728638649, decouple_loss:0.001429071999154985
Iteration: 1734, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449298620223999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02688433788716793, decouple_loss:0.0018399055115878582
The modified gen p mean: 0.44446834921836853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026726968586444855, decouple_loss:0.001452735043130815
The modified gen p mean: 0.4460568130016327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027610082179307938, decouple_loss:0.0014845866244286299
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr.npz
NaN value num: 0
Iteration: 1735, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44313299655914307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027510344982147217, decouple_loss:0.0013154051266610622
The modified gen p mean: 0.4475112855434418, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4429541826248169, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026727115735411644, decouple_loss:0.0014509492320939898
loss_pred:0.025752464309334755, decouple_loss:0.0014552833745256066
Iteration: 1736, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4435708820819855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026573527604341507, decouple_loss:0.0014337640022858977
The modified gen p mean: 0.44914451241493225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02589665725827217, decouple_loss:0.001519621815532446
The modified gen p mean: 0.448149174451828, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02683958224952221, decouple_loss:0.0016184077830985188
Iteration: 1737, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462261497974396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027194298803806305, decouple_loss:0.0013909854460507631
The modified gen p mean: 0.4452839493751526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027861202135682106, decouple_loss:0.0013847097288817167
The modified gen p mean: 0.4451059401035309, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610458806157112, decouple_loss:0.0015612792922183871
Iteration: 1738, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446087121963501, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026827696710824966, decouple_loss:0.0015018011908978224The modified gen p mean: 0.4466749429702759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02563599683344364, decouple_loss:0.0016648240853101015
The modified gen p mean: 0.44794806838035583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02647876925766468, decouple_loss:0.0016929975245147943
Iteration: 1739, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461938440799713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02718372456729412, decouple_loss:0.001485625165514648
The modified gen p mean: 0.44682198762893677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026068178936839104, decouple_loss:0.0014533554203808308
The modified gen p mean: 0.4450675845146179, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026207322254776955, decouple_loss:0.0014817753108218312
Iteration: 1740, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449018269777298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026515385136008263, decouple_loss:0.0014671545941382647
The modified gen p mean: 0.447369247674942, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026716316118836403, decouple_loss:0.0016483956715092063
The modified gen p mean: 0.4463198482990265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02667648158967495, decouple_loss:0.00141339807305485
2023-05-26 15:35:26 testing...
The modified gen p mean: 0.4525001645088196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032587725669145584, decouple_loss:0.001639097579754889
The modified gen p mean: 0.4507508873939514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283330425620079, decouple_loss:0.0015427102334797382
The modified gen p mean: 0.45240768790245056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03423471748828888, decouple_loss:0.001640586880967021
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033298954367637634, avg_mse: 0.04533463716506958
current test mse: 0.045335
Iteration: 1741, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447007477283478, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028195304796099663, decouple_loss:0.0015232730656862259
The modified gen p mean: 0.44684216380119324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027071725577116013, decouple_loss:0.0013840986648574471
The modified gen p mean: 0.44621092081069946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026972932741045952, decouple_loss:0.0013138700742274523
Iteration: 1742, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465000629425049, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02724580653011799, decouple_loss:0.0013974459143355489
The modified gen p mean: 0.44995325803756714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026242921128869057, decouple_loss:0.0015365262515842915
The modified gen p mean: 0.4486244320869446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026460640132427216, decouple_loss:0.0015543955378234386
Iteration: 1743, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44977685809135437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02643638662993908, decouple_loss:0.0016139197396114469
The modified gen p mean: 0.4457768201828003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02671547420322895, decouple_loss:0.0015859267441555858
The modified gen p mean: 0.4457859694957733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027668630704283714, decouple_loss:0.001493421965278685
Iteration: 1744, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449247121810913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02607952617108822, decouple_loss:0.0013372983084991574
The modified gen p mean: 0.44656190276145935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026028988882899284, decouple_loss:0.0016792402602732182
The modified gen p mean: 0.44575172662734985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026835981756448746, decouple_loss:0.001442318200133741
Iteration: 1745, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44662049412727356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026332193985581398, decouple_loss:0.0014916668878868222
The modified gen p mean: 0.4440184235572815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02671545371413231, decouple_loss:0.0013483718503266573
The modified gen p mean: 0.4485110342502594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026829874143004417, decouple_loss:0.0015487251803278923
Iteration: 1746, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4429377317428589, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027140550315380096, decouple_loss:0.001561469049192965
The modified gen p mean: 0.44608622789382935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026696251705288887, decouple_loss:0.0014078246895223856
The modified gen p mean: 0.44504719972610474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025141650810837746, decouple_loss:0.0015022892039269209
Iteration: 1747, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471248388290405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025813037529587746, decouple_loss:0.0014243510086089373
The modified gen p mean: 0.44382959604263306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026420259848237038, decouple_loss:0.0014921741094440222
The modified gen p mean: 0.445670485496521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026253551244735718, decouple_loss:0.001450026175007224
Iteration: 1748, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4421302080154419, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026544075459241867, decouple_loss:0.0012673093006014824
The modified gen p mean: 0.4425143599510193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02684124931693077, decouple_loss:0.0013274725060909986
The modified gen p mean: 0.4436211884021759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026730109006166458, decouple_loss:0.0012554986169561744
Iteration: 1749, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4422548711299896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027126584202051163, decouple_loss:0.0014803067315369844
The modified gen p mean: 0.4469913840293884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026272298768162727, decouple_loss:0.0015121513279154897
The modified gen p mean: 0.44378766417503357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02830023691058159, decouple_loss:0.0014162554871290922
Iteration: 1750, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475095570087433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0261620432138443, decouple_loss:0.0014330220874398947
The modified gen p mean: 0.4425498843193054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027546802535653114, decouple_loss:0.0014637680724263191
The modified gen p mean: 0.4447040557861328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026843704283237457, decouple_loss:0.0014175268588587642
2023-05-26 15:39:32 testing...
The modified gen p mean: 0.45004475116729736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03250788524746895, decouple_loss:0.0016247642925009131
The modified gen p mean: 0.44816672801971436, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44990742206573486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03282715007662773, decouple_loss:0.0015189188998192549
loss_pred:0.03414788469672203, decouple_loss:0.0016464893706142902
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03324081003665924, avg_mse: 0.0452679879963398
current test mse: 0.045268
Iteration: 1751, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494363069534302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025516966357827187, decouple_loss:0.0015517526771873236
The modified gen p mean: 0.4498395025730133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026521144434809685, decouple_loss:0.001472471165470779
The modified gen p mean: 0.4481433629989624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025389155372977257, decouple_loss:0.0014102847781032324
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1752, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445195496082306, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44446301460266113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028851337730884552, decouple_loss:0.0014139030827209353
The modified gen p mean: 0.44579067826271057, gen p mean: 0.0, mean p set: 0.448loss_pred:0.029771072790026665, decouple_loss:0.0013749514473602176
loss_pred:0.02973427064716816, decouple_loss:0.0013127111596986651
Iteration: 1753, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502008855342865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02888910286128521, decouple_loss:0.0013861568877473474
The modified gen p mean: 0.4460909068584442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03097921423614025, decouple_loss:0.0014345903182402253
The modified gen p mean: 0.4517815411090851, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029511984437704086, decouple_loss:0.0015908869681879878
Iteration: 1754, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492729902267456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02893987111747265, decouple_loss:0.0015355830546468496
The modified gen p mean: 0.44898977875709534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028096824884414673, decouple_loss:0.0015780662652105093
The modified gen p mean: 0.4478948712348938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030141662806272507, decouple_loss:0.0013820475433021784
Iteration: 1755, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45181602239608765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02789752557873726, decouple_loss:0.0015942781465128064
The modified gen p mean: 0.447030633687973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029216622933745384, decouple_loss:0.0013930995482951403
The modified gen p mean: 0.45134297013282776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027423109859228134, decouple_loss:0.0015320394886657596
Iteration: 1756, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4538615643978119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028105000033974648, decouple_loss:0.0014326170785352588
The modified gen p mean: 0.45352819561958313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029029158875346184, decouple_loss:0.0017540714470669627
The modified gen p mean: 0.45560982823371887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02882886491715908, decouple_loss:0.0014690187526866794
Iteration: 1757, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449613481760025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029167991131544113, decouple_loss:0.0014484552666544914
The modified gen p mean: 0.4548238515853882, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027521178126335144, decouple_loss:0.001529107103124261
The modified gen p mean: 0.45190122723579407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028426073491573334, decouple_loss:0.001627027173526585
Iteration: 1758, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45442160964012146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02801361493766308, decouple_loss:0.0015204786323010921
The modified gen p mean: 0.45386579632759094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02850285917520523, decouple_loss:0.0015653090085834265
The modified gen p mean: 0.45252272486686707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027968697249889374, decouple_loss:0.0016776517732068896
Iteration: 1759, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45037639141082764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02751384861767292, decouple_loss:0.0014346115058287978
The modified gen p mean: 0.4495544135570526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02880254201591015, decouple_loss:0.0015554230194538832
The modified gen p mean: 0.4497411549091339, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028716523200273514, decouple_loss:0.0014396767364814878
Iteration: 1760, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45246797800064087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028253057971596718, decouple_loss:0.0016584177501499653
The modified gen p mean: 0.4560948312282562, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028811372816562653, decouple_loss:0.0016366009367629886
The modified gen p mean: 0.44986045360565186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030051464214920998, decouple_loss:0.0014637756394222379
2023-05-26 15:44:20 testing...
The modified gen p mean: 0.45303091406822205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03244972601532936, decouple_loss:0.0017410857835784554
The modified gen p mean: 0.4511730372905731, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45277684926986694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032878972589969635, decouple_loss:0.0015983752673491836
loss_pred:0.0342409685254097, decouple_loss:0.001732132863253355
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03327441215515137, avg_mse: 0.045199137181043625
current test mse: 0.045199
Iteration: 1761, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44952860474586487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02804996259510517, decouple_loss:0.001569629879668355
The modified gen p mean: 0.4514305293560028, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02794485352933407, decouple_loss:0.0014692330732941628
The modified gen p mean: 0.45188769698143005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028573835268616676, decouple_loss:0.0016488790279254317
Iteration: 1762, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486806094646454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028914369642734528, decouple_loss:0.001522462465800345
The modified gen p mean: 0.4470766484737396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02988891303539276, decouple_loss:0.0015735899796709418
The modified gen p mean: 0.44455772638320923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028498422354459763, decouple_loss:0.0015461418079212308
Iteration: 1763, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44678744673728943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02788400836288929, decouple_loss:0.0015843030996620655
The modified gen p mean: 0.44671446084976196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027402210980653763, decouple_loss:0.0015761017566546798
The modified gen p mean: 0.4497615694999695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02796454168856144, decouple_loss:0.0014833236346021295
Iteration: 1764, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44753721356391907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028915610164403915, decouple_loss:0.0015263260575011373
The modified gen p mean: 0.44876036047935486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028348246589303017, decouple_loss:0.0015713577158749104
The modified gen p mean: 0.44749578833580017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027506915852427483, decouple_loss:0.0016209769528359175
Iteration: 1765, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480150043964386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028956685215234756, decouple_loss:0.0014599582646042109
The modified gen p mean: 0.4474468231201172, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027854900807142258, decouple_loss:0.0016463787760585546
The modified gen p mean: 0.4455122649669647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027819806709885597, decouple_loss:0.0015837865648791194
Iteration: 1766, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44624677300453186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02862635627388954, decouple_loss:0.0015034751268103719
The modified gen p mean: 0.4474940001964569, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027782326564192772, decouple_loss:0.0015094219706952572
The modified gen p mean: 0.4468449652194977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027924111112952232, decouple_loss:0.0017453809268772602
Iteration: 1767, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507240355014801, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027899527922272682, decouple_loss:0.001653551240451634
The modified gen p mean: 0.44739532470703125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02857515588402748, decouple_loss:0.001522964215837419
The modified gen p mean: 0.44640785455703735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027853447943925858, decouple_loss:0.0016533536836504936
Iteration: 1768, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44990453124046326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028992097824811935, decouple_loss:0.0015821765409782529
The modified gen p mean: 0.44885191321372986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027764175087213516, decouple_loss:0.0016860540490597486
The modified gen p mean: 0.4507412910461426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0280874315649271, decouple_loss:0.0015576606383547187
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1769, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510025084018707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028773842379450798, decouple_loss:0.0015585332876071334
The modified gen p mean: 0.4493849575519562, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44843342900276184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030047446489334106, decouple_loss:0.0015316270291805267
loss_pred:0.02904350310564041, decouple_loss:0.0015603395877406001
Iteration: 1770, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4531486928462982, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026644285768270493, decouple_loss:0.001500266487710178
The modified gen p mean: 0.4486250579357147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028364326804876328, decouple_loss:0.0015325585845857859
The modified gen p mean: 0.4494877755641937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027837445959448814, decouple_loss:0.0014872848987579346
2023-05-26 15:49:07 testing...
The modified gen p mean: 0.45323729515075684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032798293977975845, decouple_loss:0.0017076443182304502
The modified gen p mean: 0.4512999653816223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03323354944586754, decouple_loss:0.0016182694816961884
The modified gen p mean: 0.45286276936531067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03451275825500488, decouple_loss:0.0017235296545550227
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03359902650117874, avg_mse: 0.04569670557975769
current test mse: 0.045697
Iteration: 1771, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45078301429748535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028860874474048615, decouple_loss:0.0015233262674883008
The modified gen p mean: 0.4509947597980499, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02731192111968994, decouple_loss:0.001660449430346489
The modified gen p mean: 0.44994354248046875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02676023542881012, decouple_loss:0.0018752309260889888
Iteration: 1772, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44741153717041016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027648909017443657, decouple_loss:0.001526530715636909
The modified gen p mean: 0.4498637914657593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026871981099247932, decouple_loss:0.001568931620568037
The modified gen p mean: 0.44769659638404846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026697145774960518, decouple_loss:0.0017617604462429881
Iteration: 1773, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447636604309082, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029183601960539818, decouple_loss:0.0015831765485927463
The modified gen p mean: 0.4475019574165344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0281610619276762, decouple_loss:0.0014571270439773798
The modified gen p mean: 0.4489268362522125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027869386598467827, decouple_loss:0.0016977472696453333
Iteration: 1774, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479612410068512, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029076941311359406, decouple_loss:0.0017184832831844687
The modified gen p mean: 0.4469009339809418, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026510868221521378, decouple_loss:0.0016346139600500464
The modified gen p mean: 0.44686201214790344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028650028631091118, decouple_loss:0.0014937513042241335
Iteration: 1775, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502631425857544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028504539281129837, decouple_loss:0.0016539432108402252
The modified gen p mean: 0.4468092620372772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02765376679599285, decouple_loss:0.001572074368596077
The modified gen p mean: 0.4483215808868408, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029083900153636932, decouple_loss:0.001493449555709958
Iteration: 1776, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44877341389656067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02775745280086994, decouple_loss:0.0019902819767594337
The modified gen p mean: 0.44936010241508484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028463762253522873, decouple_loss:0.0015313966432586312
The modified gen p mean: 0.44643014669418335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028033940121531487, decouple_loss:0.0015080212615430355
Iteration: 1777, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491535425186157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02630014903843403, decouple_loss:0.001540950732305646
The modified gen p mean: 0.4469701647758484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02625565603375435, decouple_loss:0.0015685281250625849
The modified gen p mean: 0.44688084721565247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027260668575763702, decouple_loss:0.0017490971367806196
Iteration: 1778, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44640326499938965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026847340166568756, decouple_loss:0.0016452783020213246
The modified gen p mean: 0.44619113206863403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028250286355614662, decouple_loss:0.0017802627990022302
The modified gen p mean: 0.4462321400642395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027212709188461304, decouple_loss:0.0014135580277070403
Iteration: 1779, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451562762260437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026426861062645912, decouple_loss:0.0016838371520861983
The modified gen p mean: 0.44520267844200134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028393618762493134, decouple_loss:0.0016362802125513554
The modified gen p mean: 0.44373300671577454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03016098588705063, decouple_loss:0.0015057363780215383
Iteration: 1780, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44881919026374817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02824883721768856, decouple_loss:0.0017135386588051915
The modified gen p mean: 0.4457007348537445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02702992968261242, decouple_loss:0.0015299235237762332
The modified gen p mean: 0.443981796503067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028312845155596733, decouple_loss:0.0014340410707518458
2023-05-26 15:53:15 testing...
The modified gen p mean: 0.45092687010765076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033013228327035904, decouple_loss:0.0016551893204450607
The modified gen p mean: 0.4486646056175232, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03330456092953682, decouple_loss:0.0015157231828197837
The modified gen p mean: 0.4504832625389099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03459462150931358, decouple_loss:0.0016445419751107693
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03371772915124893, avg_mse: 0.04588986560702324
current test mse: 0.04589
Iteration: 1781, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44787338376045227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02804236300289631, decouple_loss:0.0015614934964105487
The modified gen p mean: 0.44947123527526855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02713584341108799, decouple_loss:0.0014274967834353447
The modified gen p mean: 0.44903361797332764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02862469293177128, decouple_loss:0.0018590926192700863
Iteration: 1782, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475522041320801, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028314512223005295, decouple_loss:0.0015307466965168715
The modified gen p mean: 0.4472508430480957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028404105454683304, decouple_loss:0.0015441188588738441
The modified gen p mean: 0.448000967502594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027274740859866142, decouple_loss:0.0015528305666521192
Iteration: 1783, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462421238422394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02795884758234024, decouple_loss:0.0014357412001118064
The modified gen p mean: 0.44773122668266296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028170624747872353, decouple_loss:0.0014931437326595187
The modified gen p mean: 0.4484800696372986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02723258174955845, decouple_loss:0.0015966022619977593
Iteration: 1784, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508431851863861, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028053374961018562, decouple_loss:0.0016241234261542559
The modified gen p mean: 0.45086878538131714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027132241055369377, decouple_loss:0.0015087834326550364
The modified gen p mean: 0.4502088725566864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027588168159127235, decouple_loss:0.0015487722121179104
Iteration: 1785, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460373818874359, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028914451599121094, decouple_loss:0.0014465437270700932
The modified gen p mean: 0.4495577812194824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026677360758185387, decouple_loss:0.0015426449244841933
The modified gen p mean: 0.4507933259010315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026656046509742737, decouple_loss:0.001427602139301598
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr.npz
NaN value num: 0
Iteration: 1786, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44912177324295044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02636977843940258, decouple_loss:0.0014763224171474576
The modified gen p mean: 0.4498561918735504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02781757526099682, decouple_loss:0.0013872318668290973
The modified gen p mean: 0.4473520517349243, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02741079218685627, decouple_loss:0.0012298790970817208
Iteration: 1787, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452827572822571, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027572115883231163, decouple_loss:0.0013630035100504756
The modified gen p mean: 0.44601160287857056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027249235659837723, decouple_loss:0.0014295302098616958
The modified gen p mean: 0.44986316561698914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026811489835381508, decouple_loss:0.0013906150124967098
Iteration: 1788, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444596529006958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026977116242051125, decouple_loss:0.0013715567765757442
The modified gen p mean: 0.44614744186401367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025956112891435623, decouple_loss:0.0016037330497056246
The modified gen p mean: 0.4443030059337616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027605248615145683, decouple_loss:0.0013992955209687352
Iteration: 1789, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444049894809723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026590518653392792, decouple_loss:0.0012873080559074879
The modified gen p mean: 0.4458067715167999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026958825066685677, decouple_loss:0.0016519868513569236
The modified gen p mean: 0.44595444202423096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027004659175872803, decouple_loss:0.0015222313813865185
Iteration: 1790, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44383591413497925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02721232734620571, decouple_loss:0.0017006017733365297
The modified gen p mean: 0.4454043209552765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027813643217086792, decouple_loss:0.0015064494218677282
The modified gen p mean: 0.44599366188049316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026162663474678993, decouple_loss:0.001533722272142768
2023-05-26 15:58:06 testing...
The modified gen p mean: 0.44782325625419617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03300797566771507, decouple_loss:0.0016933092847466469
The modified gen p mean: 0.44765713810920715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03448859602212906, decouple_loss:0.0016572943422943354
The modified gen p mean: 0.4457261562347412, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033355630934238434, decouple_loss:0.0015057019190862775
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03369833901524544, avg_mse: 0.04601844772696495
current test mse: 0.046018
Iteration: 1791, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476146996021271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02626570500433445, decouple_loss:0.0015315237687900662
The modified gen p mean: 0.44476744532585144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02700137160718441, decouple_loss:0.001441973727196455
The modified gen p mean: 0.44760870933532715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026451868936419487, decouple_loss:0.0013883181381970644
Iteration: 1792, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4425086975097656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028087612241506577, decouple_loss:0.0016004962380975485
The modified gen p mean: 0.44619184732437134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025768239051103592, decouple_loss:0.0014141218271106482
The modified gen p mean: 0.44340357184410095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026374710723757744, decouple_loss:0.0014340471243485808
Iteration: 1793, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444107711315155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027838651090860367, decouple_loss:0.0015395719092339277
The modified gen p mean: 0.4476749897003174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026555117219686508, decouple_loss:0.0014435439370572567
The modified gen p mean: 0.4471612870693207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026176780462265015, decouple_loss:0.0015641169156879187
Iteration: 1794, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467610716819763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026632916182279587, decouple_loss:0.0015043382300063968
The modified gen p mean: 0.4464019238948822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02787381038069725, decouple_loss:0.0014747352106496692
The modified gen p mean: 0.44735583662986755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02719760127365589, decouple_loss:0.0016011502593755722
Iteration: 1795, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44768083095550537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0277231577783823, decouple_loss:0.0015536751598119736
The modified gen p mean: 0.4496007561683655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027173073962330818, decouple_loss:0.001550605520606041
The modified gen p mean: 0.45057693123817444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025912411510944366, decouple_loss:0.0014971066266298294
Iteration: 1796, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516094923019409, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02647564560174942, decouple_loss:0.0013867516536265612
The modified gen p mean: 0.4546792805194855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026107946410775185, decouple_loss:0.0014914205530658364
The modified gen p mean: 0.4478697180747986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026561453938484192, decouple_loss:0.0013511247234418988
Iteration: 1797, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510372281074524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02505723387002945, decouple_loss:0.0014992579817771912
The modified gen p mean: 0.45435163378715515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026074741035699844, decouple_loss:0.001407112693414092
The modified gen p mean: 0.4486944377422333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026989616453647614, decouple_loss:0.0013193433405831456
Iteration: 1798, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44900041818618774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026912493631243706, decouple_loss:0.001466079382225871
The modified gen p mean: 0.4536775052547455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025928152725100517, decouple_loss:0.001452877651900053
The modified gen p mean: 0.4504563808441162, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026798652485013008, decouple_loss:0.0013619986129924655
Iteration: 1799, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44800227880477905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026374410837888718, decouple_loss:0.0015631216811016202
The modified gen p mean: 0.4473540782928467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027536658570170403, decouple_loss:0.0016048807883635163
The modified gen p mean: 0.4521259665489197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026006711646914482, decouple_loss:0.0016003722557798028
Iteration: 1800, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44920095801353455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0259917750954628, decouple_loss:0.0014744384679943323
The modified gen p mean: 0.44991159439086914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025918813422322273, decouple_loss:0.0014524766011163592
The modified gen p mean: 0.44621384143829346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026023920625448227, decouple_loss:0.0013948780251666903
2023-05-26 16:02:11 testing...
The modified gen p mean: 0.45124927163124084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032756783068180084, decouple_loss:0.0016537107294425368
The modified gen p mean: 0.44925084710121155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032919742166996, decouple_loss:0.0014983913861215115
The modified gen p mean: 0.45111551880836487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0342952199280262, decouple_loss:0.0017145086312666535
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03340502828359604, avg_mse: 0.045544132590293884
current test mse: 0.045544
Iteration: 1801, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45138171315193176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026821957901120186, decouple_loss:0.0014864986296743155
The modified gen p mean: 0.4487311542034149, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02617439441382885, decouple_loss:0.0014604066964238882
The modified gen p mean: 0.4454844295978546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026534220203757286, decouple_loss:0.0013134349137544632
Iteration: 1802, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450318217277527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026658795773983, decouple_loss:0.0014198849676176906
The modified gen p mean: 0.4440290927886963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026090610772371292, decouple_loss:0.0014267039950937033
The modified gen p mean: 0.44710662961006165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026361679658293724, decouple_loss:0.0014485844876617193
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr.npz
NaN value num: 0
Iteration: 1803, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473508596420288, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02729490026831627, decouple_loss:0.0013723112642765045
The modified gen p mean: 0.44222185015678406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027865566313266754, decouple_loss:0.0015631754649803042
The modified gen p mean: 0.4461835026741028, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025956129655241966, decouple_loss:0.0014838962815701962
Iteration: 1804, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44315287470817566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027440311387181282, decouple_loss:0.001515097450464964
The modified gen p mean: 0.44506967067718506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02507656253874302, decouple_loss:0.0016077659092843533
The modified gen p mean: 0.44312942028045654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028401266783475876, decouple_loss:0.0014615246327593923
Iteration: 1805, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44470250606536865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02757250890135765, decouple_loss:0.0014763298677280545
The modified gen p mean: 0.44647300243377686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026592126116156578, decouple_loss:0.0014294383581727743
The modified gen p mean: 0.44648975133895874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02682817541062832, decouple_loss:0.0014427796704694629
Iteration: 1806, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44858604669570923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02586125209927559, decouple_loss:0.0014197910204529762
The modified gen p mean: 0.44818809628486633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027041638270020485, decouple_loss:0.0014857870992273092
The modified gen p mean: 0.44434595108032227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027246972545981407, decouple_loss:0.001476965262554586
Iteration: 1807, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44663023948669434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771669253706932, decouple_loss:0.0015365533763542771
The modified gen p mean: 0.4456855356693268, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0277094766497612, decouple_loss:0.0014131373027339578
The modified gen p mean: 0.44673147797584534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027418751269578934, decouple_loss:0.0014829077990725636
Iteration: 1808, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471537172794342, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02751876786351204, decouple_loss:0.001342553412541747
The modified gen p mean: 0.4482302665710449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026091622188687325, decouple_loss:0.0016802827594801784
The modified gen p mean: 0.445500910282135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0277837086468935, decouple_loss:0.0015618177130818367
Iteration: 1809, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45105627179145813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02713671140372753, decouple_loss:0.0016791290836408734
The modified gen p mean: 0.4493071436882019, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026822475716471672, decouple_loss:0.001521311467513442
The modified gen p mean: 0.44829559326171875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02606421336531639, decouple_loss:0.00148137123323977
Iteration: 1810, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44796961545944214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027225926518440247, decouple_loss:0.001344515709206462
The modified gen p mean: 0.4520666003227234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026379933580756187, decouple_loss:0.0016750853974372149
The modified gen p mean: 0.4510582387447357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02611209638416767, decouple_loss:0.0016271884087473154
2023-05-26 16:06:57 testing...
The modified gen p mean: 0.4543828070163727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032671473920345306, decouple_loss:0.0016267674509435892
The modified gen p mean: 0.4543243646621704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03420969098806381, decouple_loss:0.0016581874806433916
The modified gen p mean: 0.4525548219680786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03290463238954544, decouple_loss:0.0015374996000900865
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033342309296131134, avg_mse: 0.045466262847185135
current test mse: 0.045466
Iteration: 1811, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479452073574066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025033775717020035, decouple_loss:0.0016255247173830867
The modified gen p mean: 0.44728925824165344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027590971440076828, decouple_loss:0.0013925147941336036
The modified gen p mean: 0.4519106149673462, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026095271110534668, decouple_loss:0.001493695075623691
Iteration: 1812, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44947439432144165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027213294059038162, decouple_loss:0.0016362617025151849
The modified gen p mean: 0.4504142701625824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025788908824324608, decouple_loss:0.0016768253408372402
The modified gen p mean: 0.4517227113246918, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02632272057235241, decouple_loss:0.0015286991838365793
Iteration: 1813, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44575467705726624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027013929560780525, decouple_loss:0.0014425816480070353
The modified gen p mean: 0.45006874203681946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02590252086520195, decouple_loss:0.0014957988169044256
The modified gen p mean: 0.4500364661216736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02648274227976799, decouple_loss:0.0015040342696011066
Iteration: 1814, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44778817892074585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026799675077199936, decouple_loss:0.001555952476337552
The modified gen p mean: 0.4510001242160797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02676272578537464, decouple_loss:0.001599073875695467
The modified gen p mean: 0.4492119252681732, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027329185977578163, decouple_loss:0.0016521941870450974
Iteration: 1815, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461958110332489, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44816574454307556, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02591650001704693, decouple_loss:0.0014446653658524156
loss_pred:0.025827886536717415, decouple_loss:0.0014491714537143707
The modified gen p mean: 0.44382229447364807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027627773582935333, decouple_loss:0.0012916306732222438
Iteration: 1816, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466756284236908, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025538230314850807, decouple_loss:0.001798163983039558
The modified gen p mean: 0.444465696811676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02744501270353794, decouple_loss:0.0014546146849170327
The modified gen p mean: 0.4474911391735077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025741688907146454, decouple_loss:0.0015978720039129257
Iteration: 1817, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4430418908596039, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027746256440877914, decouple_loss:0.0014999021077528596
The modified gen p mean: 0.4456598460674286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025948846712708473, decouple_loss:0.0014816370094195008
The modified gen p mean: 0.4453587830066681, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027594568207859993, decouple_loss:0.0014754858566448092
Iteration: 1818, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464159607887268, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025684788823127747, decouple_loss:0.0015464163152500987
The modified gen p mean: 0.44362807273864746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026764163747429848, decouple_loss:0.001500842161476612
The modified gen p mean: 0.44723284244537354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026786651462316513, decouple_loss:0.0014677919680252671
Iteration: 1819, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449712336063385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025230202823877335, decouple_loss:0.001536051626317203
The modified gen p mean: 0.4458387792110443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02653454802930355, decouple_loss:0.0016171763418242335
The modified gen p mean: 0.4409922659397125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02813037298619747, decouple_loss:0.0018123872578144073
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr.npz
NaN value num: 0
Iteration: 1820, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44611164927482605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02637902833521366, decouple_loss:0.0016009279061108828
The modified gen p mean: 0.44419848918914795, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44497984647750854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027861082926392555, decouple_loss:0.0015566879883408546
loss_pred:0.02687518112361431, decouple_loss:0.0016134135657921433
2023-05-26 16:11:35 testing...
The modified gen p mean: 0.4499145746231079, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03263727203011513, decouple_loss:0.0015918497228994966
The modified gen p mean: 0.4480594992637634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032903000712394714, decouple_loss:0.0014654076658189297
The modified gen p mean: 0.44983503222465515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03418239578604698, decouple_loss:0.0016225549625232816
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033318884670734406, avg_mse: 0.04544978588819504
current test mse: 0.04545
Iteration: 1821, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.443022221326828, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028532931581139565, decouple_loss:0.0015113803092390299
The modified gen p mean: 0.44526779651641846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026531118899583817, decouple_loss:0.0017373276641592383
The modified gen p mean: 0.44767069816589355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027980394661426544, decouple_loss:0.001573649002239108
Iteration: 1822, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44785240292549133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027205592021346092, decouple_loss:0.0017400282667949796
The modified gen p mean: 0.44534045457839966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028731754049658775, decouple_loss:0.0014657170977443457
The modified gen p mean: 0.4502508342266083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026202403008937836, decouple_loss:0.0014843411045148969
Iteration: 1823, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44473162293434143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028017379343509674, decouple_loss:0.0014174864627420902
The modified gen p mean: 0.4515833854675293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025819752365350723, decouple_loss:0.0015667300904169679
The modified gen p mean: 0.45257458090782166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027066215872764587, decouple_loss:0.001504042069427669
Iteration: 1824, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519501030445099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026212496683001518, decouple_loss:0.0016316627152264118
The modified gen p mean: 0.4539276957511902, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026149922981858253, decouple_loss:0.0017671424429863691
The modified gen p mean: 0.45087072253227234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026510894298553467, decouple_loss:0.001541792880743742
Iteration: 1825, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45216870307922363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02713765576481819, decouple_loss:0.00143236864823848
The modified gen p mean: 0.45330777764320374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026499731466174126, decouple_loss:0.0015122104668989778
The modified gen p mean: 0.45544561743736267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026565756648778915, decouple_loss:0.0014954712241888046
Iteration: 1826, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45732107758522034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02758173830807209, decouple_loss:0.0014384838286787271
The modified gen p mean: 0.45241352915763855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02677653543651104, decouple_loss:0.0014610138023272157
The modified gen p mean: 0.4533643126487732, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027737028896808624, decouple_loss:0.0013973884051665664
Iteration: 1827, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45384666323661804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732762321829796, decouple_loss:0.0016432420816272497
The modified gen p mean: 0.4527391791343689, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02703593298792839, decouple_loss:0.0015009721973910928
The modified gen p mean: 0.45672667026519775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0274000633507967, decouple_loss:0.001471049850806594
Iteration: 1828, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4542027711868286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027373282238841057, decouple_loss:0.0014589672209694982
The modified gen p mean: 0.4516066908836365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02620544098317623, decouple_loss:0.0014430996961891651
The modified gen p mean: 0.45094576478004456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02786151133477688, decouple_loss:0.0014326300006359816
Iteration: 1829, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44590815901756287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02817116491496563, decouple_loss:0.00159369723405689
The modified gen p mean: 0.44977495074272156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026509251445531845, decouple_loss:0.0015190381091088057
The modified gen p mean: 0.44821813702583313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02848384901881218, decouple_loss:0.0018761485116556287
Iteration: 1830, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494732618331909, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026566995307803154, decouple_loss:0.0014984396984800696
The modified gen p mean: 0.4443877339363098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027633529156446457, decouple_loss:0.0014348308322951198
The modified gen p mean: 0.44968247413635254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026941435411572456, decouple_loss:0.0015448560006916523
2023-05-26 16:15:43 testing...
The modified gen p mean: 0.44955378770828247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255367651581764, decouple_loss:0.0016723459120839834
The modified gen p mean: 0.4478355050086975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032929420471191406, decouple_loss:0.0014820352662354708
The modified gen p mean: 0.4496194124221802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03419378772377968, decouple_loss:0.0017044305568560958
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033306609839200974, avg_mse: 0.04538003355264664
current test mse: 0.04538
Iteration: 1831, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4418441355228424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02754165232181549, decouple_loss:0.0015501471934840083
The modified gen p mean: 0.44661426544189453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027508791536092758, decouple_loss:0.0016233541537076235
The modified gen p mean: 0.4421554207801819, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027413051575422287, decouple_loss:0.001422813511453569
Iteration: 1832, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478093683719635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02648376114666462, decouple_loss:0.0015424663433805108
The modified gen p mean: 0.44293293356895447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690221183001995, decouple_loss:0.0014372194418683648
The modified gen p mean: 0.4492433965206146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02628389187157154, decouple_loss:0.0016308724880218506
Iteration: 1833, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44589763879776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026365185156464577, decouple_loss:0.0017406693659722805
The modified gen p mean: 0.44402584433555603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02776964195072651, decouple_loss:0.001429234049282968
The modified gen p mean: 0.44374585151672363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026392169296741486, decouple_loss:0.0013752965023741126
Iteration: 1834, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470400810241699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025823630392551422, decouple_loss:0.0014104696456342936
The modified gen p mean: 0.4468536078929901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026421068236231804, decouple_loss:0.001686439267359674
The modified gen p mean: 0.4475747048854828, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02856118604540825, decouple_loss:0.0015936587005853653
Iteration: 1835, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502721428871155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026898853480815887, decouple_loss:0.0015077601419761777
The modified gen p mean: 0.44648119807243347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026361240074038506, decouple_loss:0.0015380942495539784
The modified gen p mean: 0.45078134536743164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026122216135263443, decouple_loss:0.001491071074269712
Iteration: 1836, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468768239021301, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02734268084168434, decouple_loss:0.0015972632681950927
The modified gen p mean: 0.4469199478626251, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026674803346395493, decouple_loss:0.0014577226247638464
The modified gen p mean: 0.4488098919391632, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027463547885417938, decouple_loss:0.0014614773681387305
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1837, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45206817984580994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027120884507894516, decouple_loss:0.001348908175714314
The modified gen p mean: 0.45426255464553833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026513906195759773, decouple_loss:0.001412183977663517
The modified gen p mean: 0.45290684700012207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027249202132225037, decouple_loss:0.0014316444285213947
Iteration: 1838, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4547818899154663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028634274378418922, decouple_loss:0.0013926866231486201
The modified gen p mean: 0.45213255286216736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028177902102470398, decouple_loss:0.0013836468569934368
The modified gen p mean: 0.45114341378211975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029765216633677483, decouple_loss:0.0015529529191553593
Iteration: 1839, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45502397418022156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02733783796429634, decouple_loss:0.0013708504848182201
The modified gen p mean: 0.457302451133728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027126053348183632, decouple_loss:0.0014738020254299045
The modified gen p mean: 0.45186781883239746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028949899598956108, decouple_loss:0.0013548487331718206
Iteration: 1840, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45395705103874207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028811851516366005, decouple_loss:0.00154099240899086
The modified gen p mean: 0.45511096715927124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026795344427227974, decouple_loss:0.001471858355216682
The modified gen p mean: 0.45580458641052246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027949171140789986, decouple_loss:0.0014334823936223984
2023-05-26 16:20:27 testing...
The modified gen p mean: 0.4534258544445038, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032537396997213364, decouple_loss:0.0016536104958504438
The modified gen p mean: 0.45182520151138306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03294141963124275, decouple_loss:0.0014789635315537453
The modified gen p mean: 0.4535222351551056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03426341339945793, decouple_loss:0.0017180182039737701
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03332825005054474, avg_mse: 0.04534532502293587
current test mse: 0.045345
Iteration: 1841, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45012757182121277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026757322251796722, decouple_loss:0.0015962980687618256
The modified gen p mean: 0.4530969262123108, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027923980727791786, decouple_loss:0.0014896276406943798
The modified gen p mean: 0.45180729031562805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02625647746026516, decouple_loss:0.0015868867048993707
Iteration: 1842, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44739803671836853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027907660230994225, decouple_loss:0.0015772016486153007
The modified gen p mean: 0.4456543028354645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027302177622914314, decouple_loss:0.0014507730957120657
The modified gen p mean: 0.4498177468776703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026822397485375404, decouple_loss:0.0015397422248497605
Iteration: 1843, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464266002178192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027072565630078316, decouple_loss:0.001466998364776373
The modified gen p mean: 0.4452613592147827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02818307839334011, decouple_loss:0.001393332495354116
The modified gen p mean: 0.4482617676258087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027284296229481697, decouple_loss:0.0014356395695358515
Iteration: 1844, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4425095319747925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027549268677830696, decouple_loss:0.001529452856630087
The modified gen p mean: 0.4447098970413208, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027787476778030396, decouple_loss:0.0015694985631853342
The modified gen p mean: 0.4415808320045471, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027041804045438766, decouple_loss:0.0013472705613821745
Iteration: 1845, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44708389043807983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027769755572080612, decouple_loss:0.0015276477206498384
The modified gen p mean: 0.4425751566886902, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02716553397476673, decouple_loss:0.0014220610028132796
The modified gen p mean: 0.44368335604667664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02677496150135994, decouple_loss:0.0016061337664723396
Iteration: 1846, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44229933619499207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02688089944422245, decouple_loss:0.0014844847610220313
The modified gen p mean: 0.44687485694885254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026763226836919785, decouple_loss:0.0016320209251716733
The modified gen p mean: 0.44348496198654175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027016855776309967, decouple_loss:0.001553539652377367
Iteration: 1847, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4422345459461212, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028573758900165558, decouple_loss:0.001499704783782363
The modified gen p mean: 0.4453318417072296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026494765654206276, decouple_loss:0.0015151198022067547
The modified gen p mean: 0.4483768045902252, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02663579210639, decouple_loss:0.0017097627278417349
Iteration: 1848, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44752147793769836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027284692972898483, decouple_loss:0.001480728737078607
The modified gen p mean: 0.45011043548583984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027203718200325966, decouple_loss:0.001589026884175837
The modified gen p mean: 0.45171794295310974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02779477648437023, decouple_loss:0.0014824297977611423
Iteration: 1849, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44644656777381897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027446743100881577, decouple_loss:0.0016802524914965034
The modified gen p mean: 0.445911705493927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027974391356110573, decouple_loss:0.0014705935027450323
The modified gen p mean: 0.4467673599720001, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02869565598666668, decouple_loss:0.0016308209160342813
Iteration: 1850, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44835805892944336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0272744782269001, decouple_loss:0.0015401875134557486
The modified gen p mean: 0.4505845010280609, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026531869545578957, decouple_loss:0.0016406323993578553
The modified gen p mean: 0.4518134295940399, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027308503165841103, decouple_loss:0.0016362612368538976
2023-05-26 16:24:35 testing...
The modified gen p mean: 0.4555732309818268, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033067215234041214, decouple_loss:0.0017794787418097258
The modified gen p mean: 0.4554809331893921, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034856684505939484, decouple_loss:0.0017870607553049922
The modified gen p mean: 0.4539777934551239, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03358251601457596, decouple_loss:0.001599102863110602
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03392156586050987, avg_mse: 0.046189405024051666
current test mse: 0.046189
Iteration: 1851, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44703561067581177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02797083742916584, decouple_loss:0.0014492118498310447
The modified gen p mean: 0.453805148601532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02745298482477665, decouple_loss:0.0015834845835343003
The modified gen p mean: 0.45006683468818665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027870161458849907, decouple_loss:0.0014360134955495596
Iteration: 1852, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4551362097263336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026821672916412354, decouple_loss:0.0016041137278079987
The modified gen p mean: 0.4520597457885742, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028721921145915985, decouple_loss:0.0016829270171001554
The modified gen p mean: 0.45097270607948303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02798462100327015, decouple_loss:0.0014547024620696902
Iteration: 1853, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519018530845642, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026801932603120804, decouple_loss:0.0015066541964188218
The modified gen p mean: 0.4513370990753174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026239385828375816, decouple_loss:0.0015729865990579128
The modified gen p mean: 0.4490152895450592, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027731435373425484, decouple_loss:0.0015028092311695218
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr.npz
NaN value num: 0
Iteration: 1854, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44860735535621643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028142286464571953, decouple_loss:0.0015128961531445384
The modified gen p mean: 0.44794774055480957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02784554846584797, decouple_loss:0.0013795166742056608
The modified gen p mean: 0.45292311906814575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026069866493344307, decouple_loss:0.001758422004058957
Iteration: 1855, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45061802864074707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02746894396841526, decouple_loss:0.001553577953018248
The modified gen p mean: 0.4495043158531189, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027664650231599808, decouple_loss:0.0015193824656307697
The modified gen p mean: 0.4490337371826172, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028199542313814163, decouple_loss:0.001570622669532895
Iteration: 1856, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471072554588318, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02736664190888405, decouple_loss:0.0017494380008429289
The modified gen p mean: 0.4471251666545868, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028601331636309624, decouple_loss:0.0014621041482314467
The modified gen p mean: 0.4481491148471832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02607932686805725, decouple_loss:0.0015073767863214016
Iteration: 1857, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491173326969147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026618868112564087, decouple_loss:0.0014492367627099156
The modified gen p mean: 0.4460071325302124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027735834941267967, decouple_loss:0.0016289441846311092
The modified gen p mean: 0.4473262131214142, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028046606108546257, decouple_loss:0.0015499956207349896
Iteration: 1858, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44915249943733215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026474079117178917, decouple_loss:0.0016537248156964779
The modified gen p mean: 0.4496908187866211, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026072034612298012, decouple_loss:0.0017443015240132809
The modified gen p mean: 0.4483526349067688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027092335745692253, decouple_loss:0.0014257030561566353
Iteration: 1859, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489293396472931, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026074079796671867, decouple_loss:0.0013745396863669157
The modified gen p mean: 0.44994914531707764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026702184230089188, decouple_loss:0.001581433112733066
The modified gen p mean: 0.4458845257759094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026764916256070137, decouple_loss:0.0015637918841093779
Iteration: 1860, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492090940475464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02608616277575493, decouple_loss:0.0015473224921151996
The modified gen p mean: 0.44825881719589233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025586294010281563, decouple_loss:0.0017923349514603615
The modified gen p mean: 0.446577787399292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025649983435869217, decouple_loss:0.0015424995217472315
2023-05-26 16:29:23 testing...
The modified gen p mean: 0.4519703984260559, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032905906438827515, decouple_loss:0.0017456727800890803
The modified gen p mean: 0.45190319418907166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03447806462645531, decouple_loss:0.0017046527937054634
The modified gen p mean: 0.4503420293331146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03309664875268936, decouple_loss:0.0015406153397634625
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03357672318816185, avg_mse: 0.045734237879514694
current test mse: 0.045734
Iteration: 1861, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44627994298934937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027949966490268707, decouple_loss:0.0015606781234964728
The modified gen p mean: 0.44712120294570923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027348792180418968, decouple_loss:0.0016463608480989933
The modified gen p mean: 0.4504922032356262, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026824524626135826, decouple_loss:0.0014469664311036468
Iteration: 1862, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44683051109313965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026117030531167984, decouple_loss:0.0016852370463311672
The modified gen p mean: 0.44483962655067444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027762696146965027, decouple_loss:0.0015168276149779558
The modified gen p mean: 0.4489893317222595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026044011116027832, decouple_loss:0.0014944932190701365
Iteration: 1863, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463290274143219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027987975627183914, decouple_loss:0.001479318947531283
The modified gen p mean: 0.4449043571949005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027557287365198135, decouple_loss:0.0014127923641353846
The modified gen p mean: 0.4471867084503174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028060607612133026, decouple_loss:0.0014539031544700265
Iteration: 1864, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45074233412742615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02613990008831024, decouple_loss:0.0019169097067788243
The modified gen p mean: 0.44461265206336975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02822423353791237, decouple_loss:0.001436541206203401
The modified gen p mean: 0.4492324888706207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025286581367254257, decouple_loss:0.0015967590734362602
Iteration: 1865, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44603386521339417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027207767590880394, decouple_loss:0.0013823186745867133
The modified gen p mean: 0.44851216673851013, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02633732371032238, decouple_loss:0.0017783701186999679
The modified gen p mean: 0.4457184076309204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026836665347218513, decouple_loss:0.0015142470365390182
Iteration: 1866, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44888409972190857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02849370241165161, decouple_loss:0.0015920891892164946
The modified gen p mean: 0.44345080852508545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027676107361912727, decouple_loss:0.0014086631126701832
The modified gen p mean: 0.44584861397743225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02828683890402317, decouple_loss:0.0015710166189819574
Iteration: 1867, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506540894508362, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026252219453454018, decouple_loss:0.0015416579553857446
The modified gen p mean: 0.4471111595630646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026654522866010666, decouple_loss:0.0014801542274653912
The modified gen p mean: 0.44755101203918457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722194232046604, decouple_loss:0.0014746907399967313
Iteration: 1868, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44703540205955505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027739642187952995, decouple_loss:0.0014741952763870358
The modified gen p mean: 0.45248889923095703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027207018807530403, decouple_loss:0.0016238309908658266
The modified gen p mean: 0.4475140869617462, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02763175219297409, decouple_loss:0.0014127750182524323
Iteration: 1869, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44757315516471863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026304000988602638, decouple_loss:0.001476292498409748
The modified gen p mean: 0.4472004771232605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027348468080163002, decouple_loss:0.0013129330473020673
The modified gen p mean: 0.44860756397247314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02781771682202816, decouple_loss:0.0014058776432648301
Iteration: 1870, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519980847835541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025697767734527588, decouple_loss:0.0016118898056447506
The modified gen p mean: 0.4480724334716797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027209432795643806, decouple_loss:0.0015074537368491292
The modified gen p mean: 0.4484807550907135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024883966892957687, decouple_loss:0.0016862634802237153
2023-05-26 16:33:33 testing...
The modified gen p mean: 0.45299234986305237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0328369103372097, decouple_loss:0.0016995157347992063
The modified gen p mean: 0.4528779685497284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03425918146967888, decouple_loss:0.0016939162742346525
The modified gen p mean: 0.45111149549484253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03291076049208641, decouple_loss:0.0015271002193912864
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03341762721538544, avg_mse: 0.04550137743353844
current test mse: 0.045501
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1871, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44922298192977905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033312905579805374, decouple_loss:0.0015261159278452396
The modified gen p mean: 0.45003607869148254, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4492800235748291, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03217065706849098, decouple_loss:0.0014159742277115583
loss_pred:0.030841169878840446, decouple_loss:0.0017776561435312033
Iteration: 1872, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45113852620124817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031411293894052505, decouple_loss:0.0014367231633514166
The modified gen p mean: 0.45398494601249695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032586392015218735, decouple_loss:0.0014490361791104078
The modified gen p mean: 0.4505583345890045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033282648772001266, decouple_loss:0.0014463067054748535
Iteration: 1873, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.452890008687973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03319162875413895, decouple_loss:0.0016250472981482744
The modified gen p mean: 0.45088931918144226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03111373633146286, decouple_loss:0.0014423499815165997
The modified gen p mean: 0.4554286599159241, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03292300924658775, decouple_loss:0.0014798943884670734
Iteration: 1874, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519609212875366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03208557143807411, decouple_loss:0.0014018701622262597
The modified gen p mean: 0.45184552669525146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032387152314186096, decouple_loss:0.0015108291991055012
The modified gen p mean: 0.44959497451782227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032782066613435745, decouple_loss:0.001526575768366456
Iteration: 1875, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45354774594306946, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4557446539402008, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03050294890999794, decouple_loss:0.0015923220198601484
loss_pred:0.032954178750514984, decouple_loss:0.001387877855449915
The modified gen p mean: 0.4549065828323364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03352351114153862, decouple_loss:0.0013743413146585226
Iteration: 1876, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4564431607723236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03137511759996414, decouple_loss:0.0016906220698729157
The modified gen p mean: 0.4593653976917267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032617103308439255, decouple_loss:0.001463533379137516
The modified gen p mean: 0.45536959171295166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030847620218992233, decouple_loss:0.0013590211747214198
Iteration: 1877, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45459240674972534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032561324536800385, decouple_loss:0.0013223704881966114
The modified gen p mean: 0.4555070102214813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030635451897978783, decouple_loss:0.0014498968375846744
The modified gen p mean: 0.4544438123703003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03126353397965431, decouple_loss:0.0015015780227258801
Iteration: 1878, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44787049293518066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03229297325015068, decouple_loss:0.0014028080040588975
The modified gen p mean: 0.44586917757987976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03155570104718208, decouple_loss:0.0015360647812485695
The modified gen p mean: 0.4476958215236664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259807825088501, decouple_loss:0.0013513773446902633
Iteration: 1879, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450964033603668, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03320587798953056, decouple_loss:0.0014845251571387053
The modified gen p mean: 0.44729095697402954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031681813299655914, decouple_loss:0.0014973924262449145
The modified gen p mean: 0.4475126266479492, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0335819311439991, decouple_loss:0.0014578270493075252
Iteration: 1880, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483920931816101, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032086264342069626, decouple_loss:0.0017587082693353295
The modified gen p mean: 0.4473615288734436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03240222856402397, decouple_loss:0.001415367005392909
The modified gen p mean: 0.44643303751945496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031541381031274796, decouple_loss:0.0015623952494934201
2023-05-26 16:38:21 testing...
The modified gen p mean: 0.450088769197464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0320991650223732, decouple_loss:0.0016124272951856256
The modified gen p mean: 0.4497285783290863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033775459975004196, decouple_loss:0.0016667707823216915
The modified gen p mean: 0.44814708828926086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253796696662903, decouple_loss:0.0015144291101023555
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03288409113883972, avg_mse: 0.04449367895722389
current test mse: 0.044494
Iteration: 1881, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44403785467147827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03105427697300911, decouple_loss:0.0014064639108255506
The modified gen p mean: 0.4483715295791626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0335516594350338, decouple_loss:0.0013963208766654134
The modified gen p mean: 0.446292519569397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03175944462418556, decouple_loss:0.0012860256247222424
Iteration: 1882, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510277509689331, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03152977675199509, decouple_loss:0.0014744148356840014
The modified gen p mean: 0.44643980264663696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03313633054494858, decouple_loss:0.0013940741773694754
The modified gen p mean: 0.45073574781417847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033101245760917664, decouple_loss:0.0014780035708099604
Iteration: 1883, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45134320855140686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03192473575472832, decouple_loss:0.0014935160288587213
The modified gen p mean: 0.45079144835472107, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03163116052746773, decouple_loss:0.0017864519031718373
The modified gen p mean: 0.4480319023132324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03363161161541939, decouple_loss:0.0014656975399702787
Iteration: 1884, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44919246435165405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03128710761666298, decouple_loss:0.0015355326468124986
The modified gen p mean: 0.45092055201530457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03201103210449219, decouple_loss:0.0017556777456775308
The modified gen p mean: 0.4537294805049896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03241473063826561, decouple_loss:0.0014771466376259923
Iteration: 1885, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475926458835602, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03248326852917671, decouple_loss:0.0015081387246027589
The modified gen p mean: 0.45175454020500183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031156130135059357, decouple_loss:0.0015060508158057928
The modified gen p mean: 0.448271244764328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03177012503147125, decouple_loss:0.0013681186828762293
Iteration: 1886, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472459852695465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03236156329512596, decouple_loss:0.0014196628471836448
The modified gen p mean: 0.4460240602493286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03161611407995224, decouple_loss:0.0015151351690292358
The modified gen p mean: 0.44939175248146057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031806349754333496, decouple_loss:0.0014901119284331799
Iteration: 1887, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44964954257011414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032523903995752335, decouple_loss:0.0015529623487964272
The modified gen p mean: 0.4486657381057739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03099236637353897, decouple_loss:0.0014573823427781463
The modified gen p mean: 0.45267239212989807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03300612047314644, decouple_loss:0.0016088304109871387
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1888, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469436705112457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02718513272702694, decouple_loss:0.0014338938053697348
The modified gen p mean: 0.44787028431892395, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44639793038368225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028694888576865196, decouple_loss:0.001454923884011805
loss_pred:0.02855086140334606, decouple_loss:0.0013341481098905206
Iteration: 1889, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45147213339805603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02922353520989418, decouple_loss:0.0015523361507803202
The modified gen p mean: 0.4513491094112396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029380472376942635, decouple_loss:0.0015975265996530652
The modified gen p mean: 0.4467228353023529, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027458403259515762, decouple_loss:0.0013624816201627254
Iteration: 1890, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44644710421562195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028901539742946625, decouple_loss:0.0014231716049835086
The modified gen p mean: 0.4476832151412964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0280254278331995, decouple_loss:0.001440465566702187
The modified gen p mean: 0.44813060760498047, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028197484090924263, decouple_loss:0.0014871894381940365
2023-05-26 16:43:08 testing...
The modified gen p mean: 0.4521292746067047, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032186176627874374, decouple_loss:0.0016238889656960964
The modified gen p mean: 0.45025673508644104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03262654319405556, decouple_loss:0.0015118257142603397
The modified gen p mean: 0.45175701379776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033774927258491516, decouple_loss:0.001651192200370133
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032942332327365875, avg_mse: 0.04452366754412651
current test mse: 0.044524
Iteration: 1891, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44862499833106995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027482090517878532, decouple_loss:0.0016381907043978572
The modified gen p mean: 0.44617947936058044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027396777644753456, decouple_loss:0.001573343062773347
The modified gen p mean: 0.44625985622406006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027780035510659218, decouple_loss:0.0014401816297322512
Iteration: 1892, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45227089524269104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027387509122490883, decouple_loss:0.0016408556839451194
The modified gen p mean: 0.4460340738296509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029022304341197014, decouple_loss:0.001394373015500605
The modified gen p mean: 0.4490775465965271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028318533673882484, decouple_loss:0.0014310867991298437
Iteration: 1893, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44694721698760986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02865487150847912, decouple_loss:0.0016323050949722528
The modified gen p mean: 0.4458344876766205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029708994552493095, decouple_loss:0.00138365407474339
The modified gen p mean: 0.44936615228652954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027293052524328232, decouple_loss:0.001523633603937924
Iteration: 1894, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44467267394065857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02780584618449211, decouple_loss:0.0015335407806560397
The modified gen p mean: 0.4487297236919403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02919234335422516, decouple_loss:0.0016264786245301366
The modified gen p mean: 0.44878140091896057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02874000556766987, decouple_loss:0.0015660609351471066
Iteration: 1895, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44723665714263916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026744581758975983, decouple_loss:0.0016367074567824602
The modified gen p mean: 0.4430932104587555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02947504073381424, decouple_loss:0.0015038492856547236
The modified gen p mean: 0.442690372467041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026970328763127327, decouple_loss:0.0016027702949941158
Iteration: 1896, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44361937046051025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02898302488029003, decouple_loss:0.0015158294700086117
The modified gen p mean: 0.4442434012889862, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028117021545767784, decouple_loss:0.0017249564407393336
The modified gen p mean: 0.4440852105617523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02843066118657589, decouple_loss:0.0013424981152638793
Iteration: 1897, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450996518135071, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027303609997034073, decouple_loss:0.0014336887979879975
The modified gen p mean: 0.44518211483955383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029093757271766663, decouple_loss:0.0016700479900464416
The modified gen p mean: 0.4446609616279602, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027380509302020073, decouple_loss:0.001373658305965364
Iteration: 1898, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445483088493347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028269922360777855, decouple_loss:0.001594731817021966
The modified gen p mean: 0.44489049911499023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029152436181902885, decouple_loss:0.0014695649733766913
The modified gen p mean: 0.4448380768299103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029828356578946114, decouple_loss:0.0015508112264797091
Iteration: 1899, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474567770957947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02714792639017105, decouple_loss:0.0019042349886149168
The modified gen p mean: 0.4451279044151306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02802969515323639, decouple_loss:0.0014501549303531647
The modified gen p mean: 0.4466342031955719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02963607758283615, decouple_loss:0.001467212219722569
Iteration: 1900, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45059990882873535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027285117655992508, decouple_loss:0.0017176419496536255
The modified gen p mean: 0.44941896200180054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026911336928606033, decouple_loss:0.0017768270336091518
The modified gen p mean: 0.450481116771698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027443811297416687, decouple_loss:0.0016211471520364285
2023-05-26 16:47:17 testing...
The modified gen p mean: 0.4532362222671509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03258074074983597, decouple_loss:0.0017035737400874496
The modified gen p mean: 0.4516366422176361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032911572605371475, decouple_loss:0.0016277054091915488
The modified gen p mean: 0.45313581824302673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03412293270230293, decouple_loss:0.0016776644624769688
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033288564532995224, avg_mse: 0.04513794928789139
current test mse: 0.045138
Iteration: 1901, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475027620792389, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029731599614024162, decouple_loss:0.0016349582001566887
The modified gen p mean: 0.44866234064102173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026382936164736748, decouple_loss:0.0016925627132877707
The modified gen p mean: 0.45117267966270447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028377924114465714, decouple_loss:0.0014963585417717695
Iteration: 1902, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45032596588134766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025594400241971016, decouple_loss:0.0014713996788486838
The modified gen p mean: 0.4516238868236542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027961771935224533, decouple_loss:0.0016554086469113827
The modified gen p mean: 0.45217451453208923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025775592774152756, decouple_loss:0.0016637020744383335
Iteration: 1903, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44577541947364807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026717593893408775, decouple_loss:0.0016515178140252829
The modified gen p mean: 0.4521876871585846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028796778991818428, decouple_loss:0.0016719195991754532
The modified gen p mean: 0.4472452998161316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029211996123194695, decouple_loss:0.0016330661019310355
Iteration: 1904, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44982925057411194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02762877754867077, decouple_loss:0.001496823038905859
The modified gen p mean: 0.4456775188446045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025825560092926025, decouple_loss:0.0014917058870196342
The modified gen p mean: 0.4477691352367401, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02844124473631382, decouple_loss:0.0015427101170644164
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1905, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465247392654419, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029225878417491913, decouple_loss:0.0014876950299367309
The modified gen p mean: 0.4474252164363861, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44968181848526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027665620669722557, decouple_loss:0.001574596157297492
loss_pred:0.028234094381332397, decouple_loss:0.001399967004545033
Iteration: 1906, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502159059047699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027388527989387512, decouple_loss:0.0016718360129743814
The modified gen p mean: 0.45071500539779663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027450012043118477, decouple_loss:0.0016807392239570618
The modified gen p mean: 0.45175257325172424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029175350442528725, decouple_loss:0.0016730544157326221
Iteration: 1907, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44604599475860596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027612177655100822, decouple_loss:0.0016338607529178262
The modified gen p mean: 0.44610708951950073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030189108103513718, decouple_loss:0.0016187813598662615
The modified gen p mean: 0.45025649666786194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028444748371839523, decouple_loss:0.0017334712902083993
Iteration: 1908, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497487246990204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02699057199060917, decouple_loss:0.0016638417728245258
The modified gen p mean: 0.44705063104629517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028084982186555862, decouple_loss:0.0016488363035023212
The modified gen p mean: 0.4508657157421112, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028133956715464592, decouple_loss:0.0015863507287576795
Iteration: 1909, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472440481185913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030417239293456078, decouple_loss:0.0015984649071469903
The modified gen p mean: 0.44833993911743164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02656356431543827, decouple_loss:0.0016080365749076009
The modified gen p mean: 0.4465038776397705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028378602117300034, decouple_loss:0.0014445227570831776
Iteration: 1910, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44701430201530457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03044433705508709, decouple_loss:0.0015457280678674579
The modified gen p mean: 0.44845229387283325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028278212994337082, decouple_loss:0.0016707468312233686
The modified gen p mean: 0.4476206302642822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028142519295215607, decouple_loss:0.0017651562811806798
2023-05-26 16:52:04 testing...
The modified gen p mean: 0.452132910490036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03284882754087448, decouple_loss:0.0018127069342881441
The modified gen p mean: 0.452056884765625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03441214933991432, decouple_loss:0.0018473113887012005
The modified gen p mean: 0.45044735074043274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03313698619604111, decouple_loss:0.0017010688316076994
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03355534002184868, avg_mse: 0.04562918841838837
current test mse: 0.045629
Iteration: 1911, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44830575585365295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02766578458249569, decouple_loss:0.00166176853235811
The modified gen p mean: 0.4482671618461609, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029900848865509033, decouple_loss:0.0016269385814666748
The modified gen p mean: 0.4475662112236023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028217418119311333, decouple_loss:0.0016759386053308845
Iteration: 1912, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44948139786720276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02674977295100689, decouple_loss:0.0018020946299657226
The modified gen p mean: 0.4500843584537506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029146436601877213, decouple_loss:0.0020893914625048637
The modified gen p mean: 0.4469206929206848, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02968568354845047, decouple_loss:0.0015076252166181803
Iteration: 1913, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483169913291931, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028159460052847862, decouple_loss:0.0016396216815337539
The modified gen p mean: 0.44708871841430664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028333695605397224, decouple_loss:0.0016647533047944307
The modified gen p mean: 0.448478102684021, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029726479202508926, decouple_loss:0.001558712450787425
Iteration: 1914, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490126967430115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027449829503893852, decouple_loss:0.001442836015485227
The modified gen p mean: 0.4549018144607544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028300991281867027, decouple_loss:0.0016826811479404569
The modified gen p mean: 0.4472152590751648, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02986091375350952, decouple_loss:0.001605689525604248
Iteration: 1915, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480854272842407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028633762151002884, decouple_loss:0.0016024274518713355
The modified gen p mean: 0.45017102360725403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028269531205296516, decouple_loss:0.0015179624315351248
The modified gen p mean: 0.4476190507411957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028519488871097565, decouple_loss:0.0015644569648429751
Iteration: 1916, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470791816711426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028954753652215004, decouple_loss:0.0014699908206239343
The modified gen p mean: 0.4514312148094177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028348946943879128, decouple_loss:0.0015271104639396071
The modified gen p mean: 0.45199915766716003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027201740071177483, decouple_loss:0.0015448816120624542
Iteration: 1917, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44873449206352234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028355324640870094, decouple_loss:0.0014909079764038324
The modified gen p mean: 0.4502076804637909, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027727654203772545, decouple_loss:0.001477917656302452
The modified gen p mean: 0.4472067058086395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02707471139729023, decouple_loss:0.0016548744169995189
Iteration: 1918, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44659310579299927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028404949232935905, decouple_loss:0.0015299763763323426
The modified gen p mean: 0.44977670907974243, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02808416076004505, decouple_loss:0.001557248062454164
The modified gen p mean: 0.44996678829193115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028429562225937843, decouple_loss:0.0015831956407055259
Iteration: 1919, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489518702030182, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02766229398548603, decouple_loss:0.0016723485896363854
The modified gen p mean: 0.44867169857025146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027481254190206528, decouple_loss:0.0018404900329187512
The modified gen p mean: 0.4467339813709259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820705994963646, decouple_loss:0.0016624064883217216
Iteration: 1920, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476146996021271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027075039222836494, decouple_loss:0.0015255900798365474
The modified gen p mean: 0.4444745182991028, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02870245836675167, decouple_loss:0.0015238551422953606
The modified gen p mean: 0.44580045342445374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027729740366339684, decouple_loss:0.0016060593770816922
2023-05-26 16:56:12 testing...
The modified gen p mean: 0.44999438524246216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03303004056215286, decouple_loss:0.0017258047591894865
The modified gen p mean: 0.44977253675460815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034581899642944336, decouple_loss:0.001682736212387681
The modified gen p mean: 0.4479343891143799, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03324663266539574, decouple_loss:0.0015887933550402522
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03370281308889389, avg_mse: 0.0458759143948555
current test mse: 0.045876
Iteration: 1921, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44776150584220886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0270538292825222, decouple_loss:0.0014929523458704352
The modified gen p mean: 0.444653183221817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027836406603455544, decouple_loss:0.0014334337320178747
The modified gen p mean: 0.4465619921684265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027541544288396835, decouple_loss:0.0013276723911985755
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr_shift3.npz
NaN value num: 0
Iteration: 1922, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45062190294265747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0324869230389595, decouple_loss:0.001597686787135899
The modified gen p mean: 0.44395798444747925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031919367611408234, decouple_loss:0.001510313362814486
The modified gen p mean: 0.44549402594566345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032120686024427414, decouple_loss:0.0014088687021285295
Iteration: 1923, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465695321559906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031380366533994675, decouple_loss:0.0015909004723653197
The modified gen p mean: 0.44772884249687195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031001701951026917, decouple_loss:0.0016661692643538117
The modified gen p mean: 0.4455931782722473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0330500528216362, decouple_loss:0.0015099787851795554
Iteration: 1924, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44837674498558044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03131052851676941, decouple_loss:0.0014652532991021872
The modified gen p mean: 0.44854214787483215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03285599872469902, decouple_loss:0.001678049797192216
The modified gen p mean: 0.4488539397716522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03049405664205551, decouple_loss:0.0015094809932634234
Iteration: 1925, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45216405391693115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030478764325380325, decouple_loss:0.0015434223460033536
The modified gen p mean: 0.4504990875720978, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030678732320666313, decouple_loss:0.0014537189854308963
The modified gen p mean: 0.45587509870529175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03086788021028042, decouple_loss:0.0014888962032273412
Iteration: 1926, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4575481712818146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03082450106739998, decouple_loss:0.0015741119859740138
The modified gen p mean: 0.456516832113266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031603191047906876, decouple_loss:0.0015296990750357509
The modified gen p mean: 0.4501083195209503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03060457669198513, decouple_loss:0.0015692714368924499
Iteration: 1927, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4568425118923187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030888129025697708, decouple_loss:0.0015339360106736422
The modified gen p mean: 0.4538112282752991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03139838948845863, decouple_loss:0.0015512433601543307
The modified gen p mean: 0.4534338712692261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03124881349503994, decouple_loss:0.0015482560265809298
Iteration: 1928, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507533609867096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03179580718278885, decouple_loss:0.0015668711857870221
The modified gen p mean: 0.4530651867389679, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03142966330051422, decouple_loss:0.0015087558422237635
The modified gen p mean: 0.4562710225582123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032942697405815125, decouple_loss:0.0016585731646046042
Iteration: 1929, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45051202178001404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03171669319272041, decouple_loss:0.0014793380396440625
The modified gen p mean: 0.4547654092311859, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031281039118766785, decouple_loss:0.0014929714379832149
The modified gen p mean: 0.45534470677375793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031143207103013992, decouple_loss:0.001591085223481059
Iteration: 1930, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518536627292633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03107578679919243, decouple_loss:0.0016177563229575753
The modified gen p mean: 0.451480895280838, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03045223094522953, decouple_loss:0.001570607186295092
The modified gen p mean: 0.4533608853816986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031753506511449814, decouple_loss:0.0014673069817945361
2023-05-26 17:00:58 testing...
The modified gen p mean: 0.45166873931884766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032357268035411835, decouple_loss:0.0016606185818091035
The modified gen p mean: 0.4498482942581177, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4514279365539551, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032634999603033066, decouple_loss:0.0015453307423740625
loss_pred:0.03404465317726135, decouple_loss:0.0016666825395077467
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033093519508838654, avg_mse: 0.04472110792994499
current test mse: 0.044721
Iteration: 1931, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452466666698456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03281213715672493, decouple_loss:0.0013727557379752398
The modified gen p mean: 0.44880253076553345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0310443714261055, decouple_loss:0.0014228064101189375
The modified gen p mean: 0.45037421584129333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030154937878251076, decouple_loss:0.0015140599571168423
Iteration: 1932, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44898876547813416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03221761807799339, decouple_loss:0.0014031728496775031
The modified gen p mean: 0.44304120540618896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031748078763484955, decouple_loss:0.0013327606720849872
The modified gen p mean: 0.4457981288433075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265781328082085, decouple_loss:0.001393191865645349
Iteration: 1933, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44518133997917175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031409814953804016, decouple_loss:0.0017944936407729983
The modified gen p mean: 0.4433702528476715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03013485297560692, decouple_loss:0.0014226017519831657
The modified gen p mean: 0.4470328986644745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030282290652394295, decouple_loss:0.001365664997138083
Iteration: 1934, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44382473826408386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03231653943657875, decouple_loss:0.0014624715549871325
The modified gen p mean: 0.4425755441188812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032265860587358475, decouple_loss:0.001343625714071095
The modified gen p mean: 0.44673970341682434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030132172629237175, decouple_loss:0.0014569310005754232
Iteration: 1935, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44455280900001526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030117221176624298, decouple_loss:0.0014681919710710645
The modified gen p mean: 0.4444974362850189, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0324074923992157, decouple_loss:0.0015406307065859437
The modified gen p mean: 0.44348740577697754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030927283689379692, decouple_loss:0.0012797442032024264
Iteration: 1936, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44703400135040283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03130475431680679, decouple_loss:0.0014623606111854315
The modified gen p mean: 0.4451160132884979, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03298019990324974, decouple_loss:0.001495824195444584
The modified gen p mean: 0.44721800088882446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031652264297008514, decouple_loss:0.0014206664636731148
Iteration: 1937, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44756194949150085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030466819182038307, decouple_loss:0.001333383610472083
The modified gen p mean: 0.4467606842517853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03150685131549835, decouple_loss:0.001404318492859602
The modified gen p mean: 0.4501633644104004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03101225197315216, decouple_loss:0.0014833256136626005
Iteration: 1938, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44972965121269226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03148798272013664, decouple_loss:0.0013183315750211477
The modified gen p mean: 0.44926828145980835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03040998801589012, decouple_loss:0.0012846615863963962
The modified gen p mean: 0.44787976145744324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030723759904503822, decouple_loss:0.0013243075227364898
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr.npz
NaN value num: 0
Iteration: 1939, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44886550307273865, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4534057676792145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03453274071216583, decouple_loss:0.0013793574180454016
loss_pred:0.03326088562607765, decouple_loss:0.0013667497551068664
The modified gen p mean: 0.4537675380706787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032321445643901825, decouple_loss:0.001603766460902989
Iteration: 1940, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44937005639076233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03169324994087219, decouple_loss:0.0012748149456456304
The modified gen p mean: 0.45100539922714233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03094649687409401, decouple_loss:0.0015740477247163653
The modified gen p mean: 0.44998350739479065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03339815139770508, decouple_loss:0.001398688182234764
2023-05-26 17:05:41 testing...
The modified gen p mean: 0.45418426394462585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03224032372236252, decouple_loss:0.0016479574842378497
The modified gen p mean: 0.45272204279899597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03241767734289169, decouple_loss:0.0014490204630419612
The modified gen p mean: 0.45418256521224976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03407486900687218, decouple_loss:0.0016638168599456549
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03299030289053917, avg_mse: 0.04458312690258026
current test mse: 0.044583
Iteration: 1941, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4533995985984802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03196028247475624, decouple_loss:0.0014666594797745347
The modified gen p mean: 0.4505312740802765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03099009208381176, decouple_loss:0.0012655567843466997
The modified gen p mean: 0.4490693509578705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031822897493839264, decouple_loss:0.001417635241523385
Iteration: 1942, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44981250166893005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031042559072375298, decouple_loss:0.0016086339019238949
The modified gen p mean: 0.4514463543891907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03263089805841446, decouple_loss:0.0013321927981451154
The modified gen p mean: 0.45284682512283325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0325264148414135, decouple_loss:0.0017889245646074414
Iteration: 1943, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495283365249634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03415636345744133, decouple_loss:0.0013974709436297417
The modified gen p mean: 0.44826769828796387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03043183870613575, decouple_loss:0.0013110857689753175
The modified gen p mean: 0.4484793543815613, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031310778111219406, decouple_loss:0.0014682408655062318
Iteration: 1944, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44861653447151184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031053466722369194, decouple_loss:0.0015546414069831371
The modified gen p mean: 0.44851720333099365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03145425021648407, decouple_loss:0.001463668653741479
The modified gen p mean: 0.44872361421585083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032977502793073654, decouple_loss:0.0015486421762034297
Iteration: 1945, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492514729499817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03286279737949371, decouple_loss:0.001419323729351163
The modified gen p mean: 0.4489654004573822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03185500204563141, decouple_loss:0.0014800168573856354
The modified gen p mean: 0.4482114017009735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031725071370601654, decouple_loss:0.0013418938033282757
Iteration: 1946, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468342363834381, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032689329236745834, decouple_loss:0.0013716532848775387
The modified gen p mean: 0.4516604542732239, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031441688537597656, decouple_loss:0.0015706481644883752
The modified gen p mean: 0.4483742415904999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032331813126802444, decouple_loss:0.0014198784483596683
Iteration: 1947, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488661587238312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031190387904644012, decouple_loss:0.001437781727872789
The modified gen p mean: 0.44956690073013306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03318828344345093, decouple_loss:0.0014741442864760756
The modified gen p mean: 0.450848788022995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03169199451804161, decouple_loss:0.0014800457283854485
Iteration: 1948, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496051073074341, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03117137961089611, decouple_loss:0.0013961612712591887
The modified gen p mean: 0.45110243558883667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03162473812699318, decouple_loss:0.0016050506383180618
The modified gen p mean: 0.4486766755580902, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031293392181396484, decouple_loss:0.0016224074643105268
Iteration: 1949, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44926661252975464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03165208175778389, decouple_loss:0.001483948901295662
The modified gen p mean: 0.4480322599411011, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03014891967177391, decouple_loss:0.0013340169098228216
The modified gen p mean: 0.4484879672527313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03146734461188316, decouple_loss:0.0014110705815255642
Iteration: 1950, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495569169521332, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030693138018250465, decouple_loss:0.0016195045318454504
The modified gen p mean: 0.4514799118041992, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03154017776250839, decouple_loss:0.0015857289545238018
The modified gen p mean: 0.44848328828811646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030703319236636162, decouple_loss:0.0014565011952072382
2023-05-26 17:09:48 testing...
The modified gen p mean: 0.4516521394252777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032235901802778244, decouple_loss:0.0016330810030922294
The modified gen p mean: 0.4500037431716919, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03231232985854149, decouple_loss:0.001483825035393238
The modified gen p mean: 0.4515150785446167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034201256930828094, decouple_loss:0.0016587110003456473
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03299609199166298, avg_mse: 0.044675275683403015
current test mse: 0.044675
Iteration: 1951, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44715866446495056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031315188854932785, decouple_loss:0.0015196860767900944
The modified gen p mean: 0.44684869050979614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031197741627693176, decouple_loss:0.0014892872422933578
The modified gen p mean: 0.4485096037387848, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031067846342921257, decouple_loss:0.0016309225466102362
Iteration: 1952, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44635331630706787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031677622348070145, decouple_loss:0.0014343502698466182
The modified gen p mean: 0.44927823543548584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03048926778137684, decouple_loss:0.0016735512763261795
The modified gen p mean: 0.45147907733917236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03134267032146454, decouple_loss:0.0016208949964493513
Iteration: 1953, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513538181781769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03210574388504028, decouple_loss:0.0014514566864818335
The modified gen p mean: 0.447813481092453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03127805143594742, decouple_loss:0.0013506143586710095
The modified gen p mean: 0.44952207803726196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03174988552927971, decouple_loss:0.0015466426266357303
Iteration: 1954, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474407732486725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031214354559779167, decouple_loss:0.001612890511751175
The modified gen p mean: 0.44774389266967773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03208569064736366, decouple_loss:0.0014072386547923088
The modified gen p mean: 0.4487728476524353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031151600182056427, decouple_loss:0.001465348876081407
Iteration: 1955, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508317708969116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031953632831573486, decouple_loss:0.00136106600984931
The modified gen p mean: 0.4503934681415558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03203370422124863, decouple_loss:0.0014573520747944713
The modified gen p mean: 0.44750434160232544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031692374497652054, decouple_loss:0.0013824618654325604
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr.npz
NaN value num: 0
Iteration: 1956, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451486736536026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02579951100051403, decouple_loss:0.0014097561361268163
The modified gen p mean: 0.44673192501068115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02769140899181366, decouple_loss:0.0013364382321015
The modified gen p mean: 0.4458664357662201, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028408320620656013, decouple_loss:0.0014356391038745642
Iteration: 1957, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492259919643402, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026111511513590813, decouple_loss:0.0015418475959450006
The modified gen p mean: 0.4469200074672699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028523718938231468, decouple_loss:0.0016141621163114905
The modified gen p mean: 0.45170968770980835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027410488575696945, decouple_loss:0.0015555326826870441
Iteration: 1958, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479084014892578, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02676379680633545, decouple_loss:0.0014672308461740613
The modified gen p mean: 0.44620636105537415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027918847277760506, decouple_loss:0.0013877643505111337
The modified gen p mean: 0.4448820948600769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028042038902640343, decouple_loss:0.0015028273919597268
Iteration: 1959, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441588819026947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028105435892939568, decouple_loss:0.0013384231133386493
The modified gen p mean: 0.4486618936061859, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026902982965111732, decouple_loss:0.0015450501814484596
The modified gen p mean: 0.45062118768692017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026881733909249306, decouple_loss:0.0015264510875567794
Iteration: 1960, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44404420256614685, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.445099800825119, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02768680453300476, decouple_loss:0.00161787832621485
loss_pred:0.02704230137169361, decouple_loss:0.0014775085728615522
The modified gen p mean: 0.44339022040367126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027948157861828804, decouple_loss:0.0015216340543702245
2023-05-26 17:14:38 testing...
The modified gen p mean: 0.44660481810569763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032260481268167496, decouple_loss:0.0016423487104475498
The modified gen p mean: 0.4469035863876343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03411450237035751, decouple_loss:0.0017156556714326143
The modified gen p mean: 0.44505593180656433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032514866441488266, decouple_loss:0.0014708001399412751
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033043764531612396, avg_mse: 0.044847168028354645
current test mse: 0.044847
Iteration: 1961, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44261083006858826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02715167962014675, decouple_loss:0.0014807829866185784
The modified gen p mean: 0.4422769844532013, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027047622948884964, decouple_loss:0.0016890499973669648
The modified gen p mean: 0.4451257586479187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026733212172985077, decouple_loss:0.0015283231623470783
Iteration: 1962, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4420284628868103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027421478182077408, decouple_loss:0.001465120818465948
The modified gen p mean: 0.44332778453826904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026559051126241684, decouple_loss:0.001431761309504509
The modified gen p mean: 0.44452035427093506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026177680119872093, decouple_loss:0.0014056232757866383
Iteration: 1963, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44537535309791565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026898745447397232, decouple_loss:0.001479398924857378
The modified gen p mean: 0.44430115818977356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027256669476628304, decouple_loss:0.0015724814729765058
The modified gen p mean: 0.4448709785938263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026833131909370422, decouple_loss:0.0014205049956217408
Iteration: 1964, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467049837112427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027631880715489388, decouple_loss:0.0014124347362667322
The modified gen p mean: 0.44813087582588196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028318503871560097, decouple_loss:0.0015175469452515244
The modified gen p mean: 0.4488922357559204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02702069655060768, decouple_loss:0.0016370934899896383
Iteration: 1965, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507603049278259, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4537588953971863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026371043175458908, decouple_loss:0.001575490809045732
loss_pred:0.026799160987138748, decouple_loss:0.0015630187699571252
The modified gen p mean: 0.4486526846885681, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027558255940675735, decouple_loss:0.0014130377676337957
Iteration: 1966, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45046260952949524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028248179703950882, decouple_loss:0.001376856118440628
The modified gen p mean: 0.4542408287525177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02777154929935932, decouple_loss:0.0015712117310613394
The modified gen p mean: 0.4521932303905487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02740035578608513, decouple_loss:0.0014812477165833116
Iteration: 1967, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4540952146053314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026113227009773254, decouple_loss:0.00158681720495224
The modified gen p mean: 0.45200300216674805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02736116200685501, decouple_loss:0.0015013697557151318
The modified gen p mean: 0.4524965286254883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026858258992433548, decouple_loss:0.0016089165583252907
Iteration: 1968, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.453057199716568, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026656508445739746, decouple_loss:0.0017976559465751052
The modified gen p mean: 0.4525516927242279, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028079364448785782, decouple_loss:0.001475483295507729
The modified gen p mean: 0.45326104760169983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026300447061657906, decouple_loss:0.001624471740797162
Iteration: 1969, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45066362619400024, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45026612281799316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027474045753479004, decouple_loss:0.001393182436004281
loss_pred:0.026413317769765854, decouple_loss:0.0014623984461650252
The modified gen p mean: 0.44911664724349976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027512576431035995, decouple_loss:0.0015208481345325708
Iteration: 1970, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474826753139496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027350660413503647, decouple_loss:0.0014636593405157328
The modified gen p mean: 0.45016229152679443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026909787207841873, decouple_loss:0.0014649915974587202
The modified gen p mean: 0.4510188102722168, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025852764025330544, decouple_loss:0.0015533554833382368
2023-05-26 17:18:46 testing...
The modified gen p mean: 0.4504026472568512, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03238212689757347, decouple_loss:0.0016480152262374759
The modified gen p mean: 0.44896459579467773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032714590430259705, decouple_loss:0.0015366096049547195
The modified gen p mean: 0.4505898058414459, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034158654510974884, decouple_loss:0.0017708772793412209
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03316771611571312, avg_mse: 0.04514656960964203
current test mse: 0.045147
Iteration: 1971, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452899098396301, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026417339220643044, decouple_loss:0.0014530930202454329
The modified gen p mean: 0.448515921831131, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026280906051397324, decouple_loss:0.001576593960635364
The modified gen p mean: 0.44866764545440674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026203026995062828, decouple_loss:0.0015557741280645132
Iteration: 1972, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44735923409461975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026176996529102325, decouple_loss:0.0014871546300128102
The modified gen p mean: 0.44728654623031616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026172781363129616, decouple_loss:0.0017513483762741089
The modified gen p mean: 0.4445476830005646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026577237993478775, decouple_loss:0.00151523994281888
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr.npz
NaN value num: 0
Iteration: 1973, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44554683566093445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028162756934762, decouple_loss:0.0013519123895093799
The modified gen p mean: 0.4452153444290161, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4429038465023041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02714538387954235, decouple_loss:0.0014031960163265467loss_pred:0.027169644832611084, decouple_loss:0.0016375771956518292
Iteration: 1974, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44710689783096313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026972901076078415, decouple_loss:0.0015514144906774163
The modified gen p mean: 0.4479038417339325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027211906388401985, decouple_loss:0.0015657927142456174
The modified gen p mean: 0.44371259212493896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028179921209812164, decouple_loss:0.0015153182903304696
Iteration: 1975, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44995754957199097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027859916910529137, decouple_loss:0.0015147003578022122
The modified gen p mean: 0.44536536931991577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02654351480305195, decouple_loss:0.0013748826459050179
The modified gen p mean: 0.4477369487285614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026809893548488617, decouple_loss:0.001454116078093648
Iteration: 1976, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473300874233246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028348777443170547, decouple_loss:0.0013433103449642658
The modified gen p mean: 0.4469316601753235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02634059451520443, decouple_loss:0.0014314117142930627
The modified gen p mean: 0.44641250371932983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026937009766697884, decouple_loss:0.001551116700284183
Iteration: 1977, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45189785957336426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027001183480024338, decouple_loss:0.001402391935698688
The modified gen p mean: 0.4516228139400482, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027047067880630493, decouple_loss:0.0014304030919447541
The modified gen p mean: 0.4478718638420105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02760765701532364, decouple_loss:0.0014026880962774158
Iteration: 1978, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4527616798877716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027003822848200798, decouple_loss:0.0014899030793458223
The modified gen p mean: 0.4527725875377655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026701202616095543, decouple_loss:0.001495604868978262
The modified gen p mean: 0.4534047544002533, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027195660397410393, decouple_loss:0.001529355184175074
Iteration: 1979, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45080313086509705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029221368953585625, decouple_loss:0.00152337527833879
The modified gen p mean: 0.4518883228302002, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0267430879175663, decouple_loss:0.0013691390631720424
The modified gen p mean: 0.45096203684806824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02693863958120346, decouple_loss:0.001413595862686634
Iteration: 1980, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495617151260376, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4529005289077759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027247188612818718, decouple_loss:0.0014290959807112813
loss_pred:0.027824565768241882, decouple_loss:0.001403886592015624
The modified gen p mean: 0.4507385790348053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027778590098023415, decouple_loss:0.0015830590855330229
2023-05-26 17:23:30 testing...
The modified gen p mean: 0.4566614329814911, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03264813497662544, decouple_loss:0.0015525523340329528
The modified gen p mean: 0.4566325843334198, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034415505826473236, decouple_loss:0.0016416962025687099
The modified gen p mean: 0.45508530735969543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032920658588409424, decouple_loss:0.001500273821875453
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033406343311071396, avg_mse: 0.04556600749492645
current test mse: 0.045566
Iteration: 1981, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4536075294017792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027573121711611748, decouple_loss:0.0013781617162749171
The modified gen p mean: 0.457683801651001, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02768399566411972, decouple_loss:0.0015101147582754493
The modified gen p mean: 0.45083585381507874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02692299149930477, decouple_loss:0.0013551464071497321
Iteration: 1982, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4523877501487732, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02640506438910961, decouple_loss:0.0015266116242855787
The modified gen p mean: 0.45614853501319885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02717636525630951, decouple_loss:0.0014212686801329255
The modified gen p mean: 0.45299971103668213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673083357512951, decouple_loss:0.0015847244067117572
Iteration: 1983, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45279017090797424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02677653357386589, decouple_loss:0.0013044575462117791
The modified gen p mean: 0.451579749584198, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027489783242344856, decouple_loss:0.0013828041264787316
The modified gen p mean: 0.450296550989151, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028687575832009315, decouple_loss:0.0014102478744462132
Iteration: 1984, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44819170236587524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026710158213973045, decouple_loss:0.0013363623293116689
The modified gen p mean: 0.4453805685043335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027588849887251854, decouple_loss:0.0012890080688521266
The modified gen p mean: 0.4490106701850891, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026283469051122665, decouple_loss:0.0014309367397800088
Iteration: 1985, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488244950771332, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02588214911520481, decouple_loss:0.001364018302410841
The modified gen p mean: 0.4493052065372467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026625415310263634, decouple_loss:0.001582528231665492
The modified gen p mean: 0.4482732117176056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02863495796918869, decouple_loss:0.0015034601092338562
Iteration: 1986, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470163881778717, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027981728315353394, decouple_loss:0.0012873888481408358
The modified gen p mean: 0.4496803879737854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025918034836649895, decouple_loss:0.001387274474836886
The modified gen p mean: 0.4464193284511566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026650572195649147, decouple_loss:0.0014974122168496251
Iteration: 1987, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44926178455352783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02658815123140812, decouple_loss:0.001373951556161046
The modified gen p mean: 0.44928044080734253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026908790692687035, decouple_loss:0.0016680925618857145
The modified gen p mean: 0.450186163187027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026735767722129822, decouple_loss:0.0013954613823443651
Iteration: 1988, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44702279567718506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026231395080685616, decouple_loss:0.0015110914828255773
The modified gen p mean: 0.44985082745552063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026838302612304688, decouple_loss:0.0013936021132394671
The modified gen p mean: 0.44725722074508667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027388017624616623, decouple_loss:0.0014407761627808213
Iteration: 1989, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473129212856293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027151770889759064, decouple_loss:0.001431986689567566
The modified gen p mean: 0.4469813406467438, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027440901845693588, decouple_loss:0.0015338369412347674
The modified gen p mean: 0.4463609457015991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027719058096408844, decouple_loss:0.0013927234103903174
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr.npz
NaN value num: 0
Iteration: 1990, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45012059807777405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025938939303159714, decouple_loss:0.0016015153378248215
The modified gen p mean: 0.449955016374588, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4496764838695526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027349624782800674, decouple_loss:0.0014024238334968686
loss_pred:0.02771916054189205, decouple_loss:0.001670276396907866
2023-05-26 17:28:16 testing...
The modified gen p mean: 0.45483800768852234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032585617154836655, decouple_loss:0.001561562530696392
The modified gen p mean: 0.453218549489975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03289875015616417, decouple_loss:0.001452385215088725
The modified gen p mean: 0.4547405540943146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03430970385670662, decouple_loss:0.0015725181438028812
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03334113210439682, avg_mse: 0.0454125739634037
current test mse: 0.045413
Iteration: 1991, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44895869493484497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0258511770516634, decouple_loss:0.0014918636297807097
The modified gen p mean: 0.45260703563690186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027019763365387917, decouple_loss:0.001448692986741662
The modified gen p mean: 0.4484100043773651, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028191054239869118, decouple_loss:0.0014639210421591997
Iteration: 1992, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4524874985218048, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025177326053380966, decouple_loss:0.0015521682798862457
The modified gen p mean: 0.44972509145736694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027484577149152756, decouple_loss:0.0013217697851359844
The modified gen p mean: 0.4495429992675781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027602633461356163, decouple_loss:0.001365300384350121
Iteration: 1993, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45008599758148193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027496295049786568, decouple_loss:0.0015153361018747091
The modified gen p mean: 0.44640839099884033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027464626356959343, decouple_loss:0.0014278668677434325
The modified gen p mean: 0.4498461186885834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026246653869748116, decouple_loss:0.0015165036311373115
Iteration: 1994, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44901105761528015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025183945894241333, decouple_loss:0.001494443858973682
The modified gen p mean: 0.4519462585449219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026443541049957275, decouple_loss:0.0014493600465357304
The modified gen p mean: 0.4489062428474426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02481670305132866, decouple_loss:0.0014142347499728203
Iteration: 1995, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445791631937027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02802887186408043, decouple_loss:0.001506424625404179
The modified gen p mean: 0.44656044244766235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026758605614304543, decouple_loss:0.0014104396104812622
The modified gen p mean: 0.45151591300964355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02616892382502556, decouple_loss:0.0014515483053401113
Iteration: 1996, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487554728984833, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44448068737983704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027067197486758232, decouple_loss:0.0015379275428131223
loss_pred:0.02732681669294834, decouple_loss:0.0014469566522166133
The modified gen p mean: 0.4478037655353546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02592720463871956, decouple_loss:0.0015144821954891086
Iteration: 1997, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448557585477829, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025260133668780327, decouple_loss:0.0014540645061060786
The modified gen p mean: 0.444808691740036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027398357167840004, decouple_loss:0.0014138960978016257
The modified gen p mean: 0.44722676277160645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026941148564219475, decouple_loss:0.0014589333441108465
Iteration: 1998, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474133253097534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025833889842033386, decouple_loss:0.001591270323842764
The modified gen p mean: 0.4462898373603821, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02671186998486519, decouple_loss:0.001669062301516533
The modified gen p mean: 0.4438713788986206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02565751038491726, decouple_loss:0.001460763276554644
Iteration: 1999, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44127482175827026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02685799077153206, decouple_loss:0.0015118967276066542
The modified gen p mean: 0.4404814839363098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027644291520118713, decouple_loss:0.0013468223623931408
The modified gen p mean: 0.44521135091781616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025702599436044693, decouple_loss:0.0014808743726462126
Iteration: 2000, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4396461248397827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0274650976061821, decouple_loss:0.0014092387864366174
The modified gen p mean: 0.4442462623119354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02578972652554512, decouple_loss:0.001463159336708486
The modified gen p mean: 0.44622501730918884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610863372683525, decouple_loss:0.0015562777407467365
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_2000.ckpt
2023-05-26 17:32:27 testing...
The modified gen p mean: 0.4495866596698761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03249258175492287, decouple_loss:0.0015542303444817662
The modified gen p mean: 0.44933807849884033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034242402762174606, decouple_loss:0.0016122671077027917
The modified gen p mean: 0.44804704189300537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03287206217646599, decouple_loss:0.001414156169630587
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0332786925137043, avg_mse: 0.04527931660413742
current test mse: 0.045279
Iteration: 2001, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438624382019043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02746419422328472, decouple_loss:0.0014393076999112964
The modified gen p mean: 0.44358009099960327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0275740884244442, decouple_loss:0.0013695453526452184
The modified gen p mean: 0.4482010304927826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027257921174168587, decouple_loss:0.0017097776290029287
Iteration: 2002, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44671717286109924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026775270700454712, decouple_loss:0.0014006505953148007
The modified gen p mean: 0.4451739192008972, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027133362367749214, decouple_loss:0.0014225231716409326
The modified gen p mean: 0.4457775056362152, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027013814076781273, decouple_loss:0.001498055411502719
Iteration: 2003, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513654112815857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025864165276288986, decouple_loss:0.0014645936898887157
The modified gen p mean: 0.44976961612701416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02709335833787918, decouple_loss:0.0013970520813018084
The modified gen p mean: 0.4480767250061035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02670406922698021, decouple_loss:0.0015408566687256098
Iteration: 2004, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44945377111434937, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45159193873405457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02534976601600647, decouple_loss:0.0013778385473415256
loss_pred:0.02712712250649929, decouple_loss:0.0015646953834220767
The modified gen p mean: 0.45202693343162537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027421751990914345, decouple_loss:0.00177005457226187
Iteration: 2005, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44658833742141724, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44802433252334595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027111850678920746, decouple_loss:0.0013638926902785897
loss_pred:0.02733529731631279, decouple_loss:0.0013923166552558541
The modified gen p mean: 0.44728797674179077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026981206610798836, decouple_loss:0.0015051646623760462
Iteration: 2006, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45110487937927246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025943337008357048, decouple_loss:0.0015530786477029324
The modified gen p mean: 0.4461507201194763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02797502838075161, decouple_loss:0.0014533621724694967
The modified gen p mean: 0.4512580633163452, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02561650052666664, decouple_loss:0.0014878318179398775
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr.npz
NaN value num: 0
Iteration: 2007, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464946687221527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030873117968440056, decouple_loss:0.001344124204479158
The modified gen p mean: 0.44966185092926025, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4464474618434906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029848529025912285, decouple_loss:0.0015301201492547989
loss_pred:0.03137943148612976, decouple_loss:0.0013567296555265784
Iteration: 2008, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44995278120040894, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4500177204608917, gen p mean: 0.0, mean p set: 0.448loss_pred:0.032192662358284, decouple_loss:0.0013542426750063896
loss_pred:0.030797602608799934, decouple_loss:0.001459717401303351
The modified gen p mean: 0.4506128132343292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031841885298490524, decouple_loss:0.0014364783419296145
Iteration: 2009, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509581923484802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03257567062973976, decouple_loss:0.0014118342660367489
The modified gen p mean: 0.451347291469574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030554650351405144, decouple_loss:0.0013833221746608615
The modified gen p mean: 0.4500643014907837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02960442751646042, decouple_loss:0.001426980714313686
Iteration: 2010, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4524402618408203, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4547045826911926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03225966542959213, decouple_loss:0.0013473753351718187
loss_pred:0.029714424163103104, decouple_loss:0.0014637019485235214
The modified gen p mean: 0.4512125849723816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030225709080696106, decouple_loss:0.0013637569500133395
2023-05-26 17:37:15 testing...
The modified gen p mean: 0.45630237460136414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032209787517786026, decouple_loss:0.0015560898464173079
The modified gen p mean: 0.4548196792602539, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032598815858364105, decouple_loss:0.0014377260813489556
The modified gen p mean: 0.45598551630973816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03396964445710182, decouple_loss:0.001612433698028326
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03300285339355469, avg_mse: 0.044806107878685
current test mse: 0.044806
Iteration: 2011, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488869607448578, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03095676191151142, decouple_loss:0.001379016786813736
The modified gen p mean: 0.455713152885437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030411172658205032, decouple_loss:0.0013965829275548458
The modified gen p mean: 0.4516681134700775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032053858041763306, decouple_loss:0.001505920896306634
Iteration: 2012, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4570033550262451, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031147804111242294, decouple_loss:0.001460755942389369
The modified gen p mean: 0.45619428157806396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03082357533276081, decouple_loss:0.0014690235257148743
The modified gen p mean: 0.4546089172363281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030704738572239876, decouple_loss:0.0013776172418147326
Iteration: 2013, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4521995484828949, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029085049405694008, decouple_loss:0.001459744875319302
The modified gen p mean: 0.4511248469352722, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265945240855217, decouple_loss:0.0012789276661351323
The modified gen p mean: 0.45262548327445984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03136961907148361, decouple_loss:0.0013907232787460089
Iteration: 2014, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495188891887665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03154238685965538, decouple_loss:0.001299359486438334
The modified gen p mean: 0.45104411244392395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029665835201740265, decouple_loss:0.0015899196732789278
The modified gen p mean: 0.4526389241218567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03167653828859329, decouple_loss:0.0012959721498191357
Iteration: 2015, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45186254382133484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02948678471148014, decouple_loss:0.001604872872121632
The modified gen p mean: 0.453433632850647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029761474579572678, decouple_loss:0.0014837923226878047
The modified gen p mean: 0.4498223066329956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031318970024585724, decouple_loss:0.00123291602358222
Iteration: 2016, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508192241191864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030376117676496506, decouple_loss:0.001349277445115149
The modified gen p mean: 0.451772540807724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03156489133834839, decouple_loss:0.0014585265889763832
The modified gen p mean: 0.449510782957077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029724519699811935, decouple_loss:0.0016390987439081073
Iteration: 2017, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495355188846588, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029989881440997124, decouple_loss:0.0016074901213869452
The modified gen p mean: 0.4528186619281769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0309531781822443, decouple_loss:0.0014528526226058602
The modified gen p mean: 0.44726330041885376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031177615746855736, decouple_loss:0.0013568330323323607
Iteration: 2018, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442816972732544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02982625551521778, decouple_loss:0.0013302424922585487
The modified gen p mean: 0.4471570551395416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030046122148633003, decouple_loss:0.0015247317496687174
The modified gen p mean: 0.4479579031467438, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029457807540893555, decouple_loss:0.0013446722878143191
Iteration: 2019, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44493064284324646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03195797652006149, decouple_loss:0.0014038635417819023
The modified gen p mean: 0.44429799914360046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031288161873817444, decouple_loss:0.0013854056596755981
The modified gen p mean: 0.4436194598674774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031182657927274704, decouple_loss:0.0014255793066695333
Iteration: 2020, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44955968856811523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031945884227752686, decouple_loss:0.0016266123857349157
The modified gen p mean: 0.4480821192264557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03207908570766449, decouple_loss:0.0014616278931498528
The modified gen p mean: 0.44397956132888794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03050071746110916, decouple_loss:0.0014202325837686658
2023-05-26 17:41:21 testing...
The modified gen p mean: 0.4504512846469879, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03215166926383972, decouple_loss:0.0016547786071896553
The modified gen p mean: 0.4487563371658325, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45001599192619324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03252161666750908, decouple_loss:0.0014852936146780849
loss_pred:0.03377062454819679, decouple_loss:0.0016758897108957171
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03289490193128586, avg_mse: 0.044535908848047256
current test mse: 0.044536
Iteration: 2021, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44511741399765015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03257171809673309, decouple_loss:0.0014263386838138103
The modified gen p mean: 0.4488206207752228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03006434254348278, decouple_loss:0.001740840612910688
The modified gen p mean: 0.44999852776527405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03062487207353115, decouple_loss:0.0016235167859122157
Iteration: 2022, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519865810871124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03133848309516907, decouple_loss:0.001726705813780427
The modified gen p mean: 0.44770747423171997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03006453439593315, decouple_loss:0.001588733633980155
The modified gen p mean: 0.4475833773612976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030732952058315277, decouple_loss:0.0013833006378263235
Iteration: 2023, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45088303089141846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032046135514974594, decouple_loss:0.0015314730117097497
The modified gen p mean: 0.4482707381248474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030318401753902435, decouple_loss:0.0015400178963318467
The modified gen p mean: 0.44873374700546265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030705539509654045, decouple_loss:0.0014129913179203868
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2024, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44887182116508484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027988703921437263, decouple_loss:0.0016284415032714605
The modified gen p mean: 0.44942325353622437, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4477519392967224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02963128499686718, decouple_loss:0.0014296523295342922
loss_pred:0.029742039740085602, decouple_loss:0.0015176978195086122
Iteration: 2025, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45295393466949463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02920731157064438, decouple_loss:0.0015335972420871258
The modified gen p mean: 0.45251432061195374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028306974098086357, decouple_loss:0.0015287608839571476
The modified gen p mean: 0.44975847005844116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02860185317695141, decouple_loss:0.0015890136128291488
Iteration: 2026, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45123061537742615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027384037151932716, decouple_loss:0.0014812084846198559
The modified gen p mean: 0.4506348669528961, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02868552692234516, decouple_loss:0.0013757201377302408
The modified gen p mean: 0.4490223228931427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02857259288430214, decouple_loss:0.001388310338370502
Iteration: 2027, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482424855232239, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02889140695333481, decouple_loss:0.0014443161198869348
The modified gen p mean: 0.448925256729126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02933763898909092, decouple_loss:0.0014165665488690138
The modified gen p mean: 0.4516315758228302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028025148436427116, decouple_loss:0.0016165674896910787
Iteration: 2028, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44740554690361023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027460666373372078, decouple_loss:0.001664252020418644
The modified gen p mean: 0.4469570517539978, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028502438217401505, decouple_loss:0.0014108638279139996
The modified gen p mean: 0.44929826259613037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02751994878053665, decouple_loss:0.0016187404980883002
Iteration: 2029, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4433065950870514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029230892658233643, decouple_loss:0.0014892237959429622
The modified gen p mean: 0.4444962739944458, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026666317135095596, decouple_loss:0.0015218164771795273
The modified gen p mean: 0.44405779242515564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029049325734376907, decouple_loss:0.0015058583812788129
Iteration: 2030, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44174623489379883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028164107352495193, decouple_loss:0.0014970439951866865
The modified gen p mean: 0.438364714384079, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029020536690950394, decouple_loss:0.0015594700817018747
The modified gen p mean: 0.4433652460575104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028730958700180054, decouple_loss:0.001441165222786367
2023-05-26 17:46:10 testing...
The modified gen p mean: 0.4456298351287842, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0325666181743145, decouple_loss:0.0016830613603815436
The modified gen p mean: 0.44397804141044617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03295845165848732, decouple_loss:0.0015664213569834828
The modified gen p mean: 0.44496044516563416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03419656306505203, decouple_loss:0.0017002371605485678
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03332304209470749, avg_mse: 0.04519341140985489
current test mse: 0.045193
Iteration: 2031, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4433058202266693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0280863419175148, decouple_loss:0.001569794723764062
The modified gen p mean: 0.4407806992530823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027911143377423286, decouple_loss:0.0017038184450939298
The modified gen p mean: 0.44208627939224243, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02842656336724758, decouple_loss:0.0016890958650037646
Iteration: 2032, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44058868288993835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02589784748852253, decouple_loss:0.0018282171804457903
The modified gen p mean: 0.44422614574432373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02704666554927826, decouple_loss:0.0014554025838151574
The modified gen p mean: 0.44039472937583923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029247036203742027, decouple_loss:0.0018127914518117905
Iteration: 2033, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4418864846229553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02852969616651535, decouple_loss:0.0015462919836863875
The modified gen p mean: 0.44058674573898315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029782244935631752, decouple_loss:0.0017626320477575064
The modified gen p mean: 0.44096967577934265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027198508381843567, decouple_loss:0.0017108451575040817
Iteration: 2034, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4432675540447235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029654309153556824, decouple_loss:0.0017606603214517236
The modified gen p mean: 0.4407193958759308, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028911815956234932, decouple_loss:0.0015684732934460044
The modified gen p mean: 0.44500938057899475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02764870412647724, decouple_loss:0.00158895633649081
Iteration: 2035, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44340163469314575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028397897258400917, decouple_loss:0.0016943005612120032
The modified gen p mean: 0.4455791413784027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02860349416732788, decouple_loss:0.0015703411772847176
The modified gen p mean: 0.44396263360977173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029039014130830765, decouple_loss:0.0014006381388753653
Iteration: 2036, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480632245540619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026101358234882355, decouple_loss:0.0016703790752217174
The modified gen p mean: 0.4499579966068268, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027296384796500206, decouple_loss:0.0016106028342619538
The modified gen p mean: 0.4479958415031433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029164738953113556, decouple_loss:0.0014763032086193562
Iteration: 2037, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.454208642244339, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028079019859433174, decouple_loss:0.0017832099692896008
The modified gen p mean: 0.44775909185409546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028813423588871956, decouple_loss:0.0016595495399087667
The modified gen p mean: 0.45353105664253235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027189554646611214, decouple_loss:0.0020042983815073967
Iteration: 2038, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44797220826148987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028928615152835846, decouple_loss:0.0015114767011255026
The modified gen p mean: 0.4490959048271179, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028834426775574684, decouple_loss:0.0016338793793693185
The modified gen p mean: 0.45317816734313965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02698700688779354, decouple_loss:0.0017075358191505075
Iteration: 2039, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45318958163261414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0271967314183712, decouple_loss:0.0018555865390226245
The modified gen p mean: 0.44872790575027466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028178753331303596, decouple_loss:0.0017239722656086087
The modified gen p mean: 0.44725772738456726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029432469978928566, decouple_loss:0.0015126733342185616
Iteration: 2040, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482775628566742, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02645220421254635, decouple_loss:0.0016405141213908792
The modified gen p mean: 0.4477626085281372, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027662919834256172, decouple_loss:0.0015461082803085446
The modified gen p mean: 0.4483398497104645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028683993965387344, decouple_loss:0.0017940872348845005
2023-05-26 17:50:14 testing...
The modified gen p mean: 0.4515758752822876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03256048634648323, decouple_loss:0.0016573745524510741
The modified gen p mean: 0.4500487744808197, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4509508013725281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03292282670736313, decouple_loss:0.0015816601226106286
loss_pred:0.03417978435754776, decouple_loss:0.0017137801041826606
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033303581178188324, avg_mse: 0.04528806358575821
current test mse: 0.045288
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2041, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44691064953804016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027572359889745712, decouple_loss:0.0015267429407685995
The modified gen p mean: 0.449146032333374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027644118294119835, decouple_loss:0.0015541528118774295
The modified gen p mean: 0.44806215167045593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02716984786093235, decouple_loss:0.0014172826195135713
Iteration: 2042, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490368962287903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026810063049197197, decouple_loss:0.0015945230843499303
The modified gen p mean: 0.4443010687828064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027141233906149864, decouple_loss:0.0013957726769149303
The modified gen p mean: 0.4453420042991638, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027500389143824577, decouple_loss:0.0016994161996990442
Iteration: 2043, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44730502367019653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026654111221432686, decouple_loss:0.0016665165312588215
The modified gen p mean: 0.4443396329879761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027538828551769257, decouple_loss:0.0014998912811279297
The modified gen p mean: 0.4451023042201996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027273500338196754, decouple_loss:0.0013950974680483341
Iteration: 2044, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44547799229621887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02869539149105549, decouple_loss:0.0016012450214475393
The modified gen p mean: 0.44377538561820984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026999298483133316, decouple_loss:0.0015485009644180536
The modified gen p mean: 0.44395747780799866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02790900319814682, decouple_loss:0.0013905735686421394
Iteration: 2045, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44405490159988403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027855155989527702, decouple_loss:0.0014616172993555665
The modified gen p mean: 0.4457409977912903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02752103842794895, decouple_loss:0.0016483091749250889
The modified gen p mean: 0.4424881935119629, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02823450416326523, decouple_loss:0.0015997325535863638
Iteration: 2046, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486182630062103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026687897741794586, decouple_loss:0.0015753257321193814
The modified gen p mean: 0.44968968629837036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027256600558757782, decouple_loss:0.0015836958773434162
The modified gen p mean: 0.4495169222354889, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02698221243917942, decouple_loss:0.0017544382717460394
Iteration: 2047, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509199857711792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026936866343021393, decouple_loss:0.0015605349326506257
The modified gen p mean: 0.4523651599884033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02647024765610695, decouple_loss:0.0014660587767139077
The modified gen p mean: 0.4498521089553833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02785022184252739, decouple_loss:0.0014150649076327682
Iteration: 2048, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45265907049179077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0257919542491436, decouple_loss:0.0016639220993965864
The modified gen p mean: 0.45262670516967773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02645527757704258, decouple_loss:0.0015986525686457753
The modified gen p mean: 0.45118868350982666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02784413844347, decouple_loss:0.001431646873243153
Iteration: 2049, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4541638493537903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027157915756106377, decouple_loss:0.001563098980113864
The modified gen p mean: 0.4516865015029907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027374206110835075, decouple_loss:0.0016046401578933
The modified gen p mean: 0.45239877700805664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027845636010169983, decouple_loss:0.001851542736403644
Iteration: 2050, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4559226930141449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026547711342573166, decouple_loss:0.0016004065982997417
The modified gen p mean: 0.44996213912963867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02870013192296028, decouple_loss:0.0016388811636716127
The modified gen p mean: 0.456045925617218, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02691671997308731, decouple_loss:0.001740852720104158
2023-05-26 17:55:00 testing...
The modified gen p mean: 0.45501708984375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0329139344394207, decouple_loss:0.0017947211163118482
The modified gen p mean: 0.4533052444458008, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03336837515234947, decouple_loss:0.0016312024090439081
The modified gen p mean: 0.45458850264549255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03468294441699982, decouple_loss:0.0017787909600883722
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03374183177947998, avg_mse: 0.04594578221440315
current test mse: 0.045946
Iteration: 2051, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44930991530418396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02788127213716507, decouple_loss:0.0017159476410597563
The modified gen p mean: 0.4552425742149353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690422721207142, decouple_loss:0.0016827095532789826
The modified gen p mean: 0.44827932119369507, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027446432039141655, decouple_loss:0.0014721929328516126
Iteration: 2052, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513566195964813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026305392384529114, decouple_loss:0.0015373926144093275
The modified gen p mean: 0.4474266767501831, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02772335149347782, decouple_loss:0.0014303814386948943
The modified gen p mean: 0.4506494998931885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026324881240725517, decouple_loss:0.0014982075663283467
Iteration: 2053, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44546961784362793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02747899852693081, decouple_loss:0.0016175898490473628
The modified gen p mean: 0.4515531361103058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026767747476696968, decouple_loss:0.0015625921078026295
The modified gen p mean: 0.4480263888835907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02686680480837822, decouple_loss:0.0014089237665757537
Iteration: 2054, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479689598083496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02617129124701023, decouple_loss:0.0015636732568964362
The modified gen p mean: 0.4483678340911865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02695120871067047, decouple_loss:0.0016345437616109848
The modified gen p mean: 0.44593900442123413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026950547471642494, decouple_loss:0.00158800242934376
Iteration: 2055, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45059990882873535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026786500588059425, decouple_loss:0.0015036237891763449
The modified gen p mean: 0.44448381662368774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027310630306601524, decouple_loss:0.0015077335992828012
The modified gen p mean: 0.4450104534626007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027730392292141914, decouple_loss:0.0015841255662962794
Iteration: 2056, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476408362388611, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026970230042934418, decouple_loss:0.0014966396847739816
The modified gen p mean: 0.4442398250102997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02804594114422798, decouple_loss:0.0015594775322824717
The modified gen p mean: 0.4494452178478241, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026721281930804253, decouple_loss:0.0015269230352714658
Iteration: 2057, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44449830055236816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028030922636389732, decouple_loss:0.001510611386038363
The modified gen p mean: 0.44904765486717224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02549484558403492, decouple_loss:0.0016055107116699219
The modified gen p mean: 0.44637399911880493, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028127899393439293, decouple_loss:0.0015094127738848329
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr.npz
NaN value num: 0
Iteration: 2058, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44908231496810913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027665672823786736, decouple_loss:0.001528196851722896
The modified gen p mean: 0.4446496069431305, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44648006558418274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028657954186201096, decouple_loss:0.0018266625702381134
loss_pred:0.02984568476676941, decouple_loss:0.0014379810309037566
Iteration: 2059, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464227855205536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0260169580578804, decouple_loss:0.0015671843430027366
The modified gen p mean: 0.4454960823059082, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026984645053744316, decouple_loss:0.0016087520634755492
The modified gen p mean: 0.44895389676094055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027849016711115837, decouple_loss:0.001730074523948133
Iteration: 2060, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44925618171691895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025923507288098335, decouple_loss:0.0014111573109403253
The modified gen p mean: 0.44801971316337585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026059623807668686, decouple_loss:0.0016532548470422626
The modified gen p mean: 0.44884932041168213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026280250400304794, decouple_loss:0.0014846849953755736
2023-05-26 17:59:46 testing...
The modified gen p mean: 0.4512348175048828, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03276409953832626, decouple_loss:0.0018618052126839757
The modified gen p mean: 0.4497494399547577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03301161155104637, decouple_loss:0.0016586314886808395
The modified gen p mean: 0.45105835795402527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034419309347867966, decouple_loss:0.0018284745747223496
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03348749130964279, avg_mse: 0.045617252588272095
current test mse: 0.045617
Iteration: 2061, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44605717062950134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026197457686066628, decouple_loss:0.0018354899948462844
The modified gen p mean: 0.44844213128089905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025751356035470963, decouple_loss:0.0014779346529394388
The modified gen p mean: 0.44742318987846375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02607825957238674, decouple_loss:0.0017810693243518472
Iteration: 2062, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44612154364585876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027391046285629272, decouple_loss:0.0016342137241736054
The modified gen p mean: 0.4435817003250122, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027904437854886055, decouple_loss:0.0014360971981659532
The modified gen p mean: 0.45045706629753113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02683059498667717, decouple_loss:0.0016053436556831002
Iteration: 2063, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457496106624603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02752998284995556, decouple_loss:0.0015196423046290874
The modified gen p mean: 0.44406598806381226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028040915727615356, decouple_loss:0.0014226947678253055
The modified gen p mean: 0.4461946487426758, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025938550010323524, decouple_loss:0.0017713976558297873
Iteration: 2064, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443590044975281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027138913050293922, decouple_loss:0.0014166658511385322
The modified gen p mean: 0.44600343704223633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027540281414985657, decouple_loss:0.00143690244294703
The modified gen p mean: 0.44406768679618835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027178281918168068, decouple_loss:0.001487306784838438
Iteration: 2065, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466053545475006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0248849019408226, decouple_loss:0.0018045054748654366
The modified gen p mean: 0.4458608329296112, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028309090062975883, decouple_loss:0.0016202492406591773
The modified gen p mean: 0.44823142886161804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026528464630246162, decouple_loss:0.0015667249681428075
Iteration: 2066, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44570180773735046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027314944192767143, decouple_loss:0.001551688532344997
The modified gen p mean: 0.4482366144657135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02482907846570015, decouple_loss:0.0015987114747986197
The modified gen p mean: 0.4456014931201935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027311282232403755, decouple_loss:0.0014641734305769205
Iteration: 2067, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461652636528015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026938721537590027, decouple_loss:0.0014473551418632269
The modified gen p mean: 0.4477493464946747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027301838621497154, decouple_loss:0.001478761900216341
The modified gen p mean: 0.4447338581085205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02695821039378643, decouple_loss:0.001516557764261961
Iteration: 2068, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466218054294586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02667858824133873, decouple_loss:0.0014236074639484286
The modified gen p mean: 0.44772887229919434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026459936052560806, decouple_loss:0.0014603908639401197
The modified gen p mean: 0.4479648172855377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02640645019710064, decouple_loss:0.0014179387362673879
Iteration: 2069, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478135108947754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02565748058259487, decouple_loss:0.0014380284119397402
The modified gen p mean: 0.44759103655815125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026136551052331924, decouple_loss:0.001444807043299079
The modified gen p mean: 0.4454646408557892, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027653992176055908, decouple_loss:0.0016393898986279964
Iteration: 2070, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450210928916931, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027561349794268608, decouple_loss:0.0013156157219782472
The modified gen p mean: 0.44560620188713074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02569807507097721, decouple_loss:0.0014539361000061035
The modified gen p mean: 0.4460655152797699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027230307459831238, decouple_loss:0.001375738880597055
2023-05-26 18:03:51 testing...
The modified gen p mean: 0.45208099484443665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032637834548950195, decouple_loss:0.0016378209693357348
The modified gen p mean: 0.450446754693985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03282324597239494, decouple_loss:0.0014479869278147817
The modified gen p mean: 0.45207372307777405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03419133648276329, decouple_loss:0.001573746558278799
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03329513221979141, avg_mse: 0.04526226967573166
current test mse: 0.045262
Iteration: 2071, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45077505707740784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02544333226978779, decouple_loss:0.0013331365771591663
The modified gen p mean: 0.4474659562110901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027005568146705627, decouple_loss:0.001381838577799499
The modified gen p mean: 0.44448521733283997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02773357182741165, decouple_loss:0.0014296367298811674
Iteration: 2072, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458029568195343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027542006224393845, decouple_loss:0.001384900650009513
The modified gen p mean: 0.44817012548446655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02730618789792061, decouple_loss:0.001478279009461403
The modified gen p mean: 0.4436514377593994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02727605402469635, decouple_loss:0.0013347554486244917
Iteration: 2073, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44495776295661926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027348631992936134, decouple_loss:0.0013724169693887234
The modified gen p mean: 0.4451778829097748, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02715418115258217, decouple_loss:0.0013914796290919185
The modified gen p mean: 0.4440969228744507, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027562281116843224, decouple_loss:0.001390096265822649
Iteration: 2074, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44620516896247864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025181619450449944, decouple_loss:0.0014361267676576972
The modified gen p mean: 0.4450255334377289, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027619441971182823, decouple_loss:0.0015967782819643617
The modified gen p mean: 0.44459691643714905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027275731787085533, decouple_loss:0.0013638603268191218
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr.npz
NaN value num: 0
Iteration: 2075, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44976645708084106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029647108167409897, decouple_loss:0.001489892601966858
The modified gen p mean: 0.4451867938041687, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4469413161277771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030139219015836716, decouple_loss:0.0015168506652116776
loss_pred:0.031857773661613464, decouple_loss:0.0015214133309200406
Iteration: 2076, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473150968551636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029498182237148285, decouple_loss:0.001433406607247889
The modified gen p mean: 0.44540292024612427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030187029391527176, decouple_loss:0.0015620933845639229
The modified gen p mean: 0.44809237122535706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031500350683927536, decouple_loss:0.0014898960944265127
Iteration: 2077, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504736065864563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032188381999731064, decouple_loss:0.0014427951537072659
The modified gen p mean: 0.44921985268592834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031297553330659866, decouple_loss:0.0015074488474056125
The modified gen p mean: 0.4508485794067383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03094233199954033, decouple_loss:0.0015717410715296865
Iteration: 2078, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490993618965149, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03169379010796547, decouple_loss:0.0013875971781089902
The modified gen p mean: 0.45384666323661804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030111346393823624, decouple_loss:0.0016847329679876566
The modified gen p mean: 0.45199480652809143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030290063470602036, decouple_loss:0.0015226572286337614
Iteration: 2079, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4547319710254669, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029825782403349876, decouple_loss:0.0015439661219716072
The modified gen p mean: 0.4517815411090851, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031626880168914795, decouple_loss:0.0013944690581411123
The modified gen p mean: 0.45227867364883423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03200289234519005, decouple_loss:0.0013989787548780441
Iteration: 2080, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45352447032928467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03108733892440796, decouple_loss:0.0014229037333279848
The modified gen p mean: 0.4543500244617462, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03141522407531738, decouple_loss:0.0013296457473188639
The modified gen p mean: 0.4538889229297638, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031907133758068085, decouple_loss:0.0014146992471069098
2023-05-26 18:08:42 testing...
The modified gen p mean: 0.4593549966812134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032104432582855225, decouple_loss:0.0016119196079671383
The modified gen p mean: 0.4592219591140747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033617231994867325, decouple_loss:0.0016721872380003333
The modified gen p mean: 0.4576719105243683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032478850334882736, decouple_loss:0.0014617122942581773
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032812606543302536, avg_mse: 0.044350069016218185
current test mse: 0.04435
Iteration: 2081, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45455989241600037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03248322382569313, decouple_loss:0.001472772448323667
The modified gen p mean: 0.459475040435791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03066323697566986, decouple_loss:0.001628004014492035
The modified gen p mean: 0.45656585693359375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03317274898290634, decouple_loss:0.0015282053500413895
Iteration: 2082, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510951638221741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03173550218343735, decouple_loss:0.001346210134215653
The modified gen p mean: 0.45165929198265076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03188119828701019, decouple_loss:0.0014896841021254659
The modified gen p mean: 0.45352572202682495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030647441744804382, decouple_loss:0.001619023852981627
Iteration: 2083, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45185261964797974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03164196014404297, decouple_loss:0.0014298154274001718
The modified gen p mean: 0.45053189992904663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03160049021244049, decouple_loss:0.001550832181237638
The modified gen p mean: 0.4502951502799988, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03127221390604973, decouple_loss:0.001407478004693985
Iteration: 2084, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44577690958976746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030714334920048714, decouple_loss:0.0013772414531558752
The modified gen p mean: 0.4488829970359802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031376101076602936, decouple_loss:0.0015465443721041083
The modified gen p mean: 0.4497545063495636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03028189018368721, decouple_loss:0.0014130522031337023
Iteration: 2085, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469941258430481, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030943719670176506, decouple_loss:0.0014988937182351947
The modified gen p mean: 0.44449901580810547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03138811141252518, decouple_loss:0.00144518306478858
The modified gen p mean: 0.44313403964042664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03198612853884697, decouple_loss:0.0013571135932579637
Iteration: 2086, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4415169656276703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030827607959508896, decouple_loss:0.0015048915520310402
The modified gen p mean: 0.4432978332042694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030231643468141556, decouple_loss:0.001465130946598947
The modified gen p mean: 0.4406515061855316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030835434794425964, decouple_loss:0.001605086144991219
Iteration: 2087, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4384652376174927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029344504699110985, decouple_loss:0.0013582020765170455
The modified gen p mean: 0.4448547065258026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030760878697037697, decouple_loss:0.001671319711022079
The modified gen p mean: 0.4406394958496094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03094404749572277, decouple_loss:0.0014769098488613963
Iteration: 2088, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4416085481643677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031105076894164085, decouple_loss:0.0013986264821141958
The modified gen p mean: 0.44119128584861755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03202640637755394, decouple_loss:0.0014941253466531634
The modified gen p mean: 0.4459065794944763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031209468841552734, decouple_loss:0.0015154022257775068
Iteration: 2089, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44852855801582336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03099832311272621, decouple_loss:0.0015797372907400131
The modified gen p mean: 0.4461745023727417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030347364023327827, decouple_loss:0.0015206043608486652
The modified gen p mean: 0.4435223639011383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031008049845695496, decouple_loss:0.0013258769176900387
Iteration: 2090, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468746483325958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03013887256383896, decouple_loss:0.0014007134595885873
The modified gen p mean: 0.4511212706565857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02992173470556736, decouple_loss:0.0014123066794127226
The modified gen p mean: 0.45063984394073486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029453108087182045, decouple_loss:0.0015373496571555734
2023-05-26 18:12:50 testing...
The modified gen p mean: 0.4552493095397949, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03220495581626892, decouple_loss:0.0016088574193418026
The modified gen p mean: 0.455063134431839, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03355098515748978, decouple_loss:0.001587097067385912
The modified gen p mean: 0.45338174700737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03245880454778671, decouple_loss:0.0014316230081021786
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03281537443399429, avg_mse: 0.04431267827749252
current test mse: 0.044313
Iteration: 2091, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45100194215774536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03051334246993065, decouple_loss:0.0016065456438809633
The modified gen p mean: 0.4518131911754608, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029741395264863968, decouple_loss:0.0016679411055520177
The modified gen p mean: 0.4494294226169586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030754372477531433, decouple_loss:0.0018243130762130022
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr.npz
NaN value num: 0
Iteration: 2092, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45078709721565247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032221145927906036, decouple_loss:0.0014715315774083138
The modified gen p mean: 0.4511561393737793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03293459117412567, decouple_loss:0.0012464382452890277
The modified gen p mean: 0.4568881690502167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03183530271053314, decouple_loss:0.0014994273660704494
Iteration: 2093, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4572332501411438, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0309415515512228, decouple_loss:0.0016042763600125909
The modified gen p mean: 0.45094752311706543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030045179650187492, decouple_loss:0.0014392052544280887
The modified gen p mean: 0.45475858449935913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029431866481900215, decouple_loss:0.0015437635593116283
Iteration: 2094, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4543854296207428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031642552465200424, decouple_loss:0.001381099340505898
The modified gen p mean: 0.45664533972740173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0303615964949131, decouple_loss:0.0014562503201887012
The modified gen p mean: 0.45184972882270813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03287332132458687, decouple_loss:0.001402504974976182
Iteration: 2095, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.452665239572525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03158506751060486, decouple_loss:0.0013661853736266494
The modified gen p mean: 0.44987550377845764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03225916624069214, decouple_loss:0.0014244450721889734
The modified gen p mean: 0.45011797547340393, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03174375742673874, decouple_loss:0.0015373856294900179
Iteration: 2096, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44674375653266907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030965667217969894, decouple_loss:0.0013157164212316275
The modified gen p mean: 0.4472660422325134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03207402303814888, decouple_loss:0.0014172194059938192
The modified gen p mean: 0.4468386471271515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030396997928619385, decouple_loss:0.001345885801129043
Iteration: 2097, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471723139286041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030818410217761993, decouple_loss:0.0014569048071280122
The modified gen p mean: 0.4496155083179474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03155847266316414, decouple_loss:0.0015891374787315726
The modified gen p mean: 0.4499642252922058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03134903684258461, decouple_loss:0.0014960787957534194
Iteration: 2098, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451422393321991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03134201467037201, decouple_loss:0.0014665566850453615
The modified gen p mean: 0.4454846978187561, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02962072193622589, decouple_loss:0.0014729012036696076
The modified gen p mean: 0.44852542877197266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253497928380966, decouple_loss:0.0015561699401587248
Iteration: 2099, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439973533153534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03221594914793968, decouple_loss:0.001472810166887939
The modified gen p mean: 0.44316408038139343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032896582037210464, decouple_loss:0.0014019133523106575
The modified gen p mean: 0.4479284882545471, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030055638402700424, decouple_loss:0.0015315773198381066
Iteration: 2100, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464785158634186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0302174873650074, decouple_loss:0.001531590591184795
The modified gen p mean: 0.44841063022613525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0309965368360281, decouple_loss:0.0015097088180482388
The modified gen p mean: 0.44693800806999207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030279887840151787, decouple_loss:0.0014475680654868484
2023-05-26 18:17:41 testing...
The modified gen p mean: 0.4514187276363373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032174818217754364, decouple_loss:0.0016576051712036133
The modified gen p mean: 0.4497293531894684, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4512839615345001, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032419878989458084, decouple_loss:0.0014935899525880814
loss_pred:0.03375012427568436, decouple_loss:0.0016749476781114936
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032862044870853424, avg_mse: 0.04445144161581993
current test mse: 0.044451
Iteration: 2101, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464870095252991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03202582895755768, decouple_loss:0.0014384968671947718
The modified gen p mean: 0.4463176727294922, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03205938637256622, decouple_loss:0.001439225859940052
The modified gen p mean: 0.44702476263046265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03164663538336754, decouple_loss:0.0013583244290202856
Iteration: 2102, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489559233188629, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03066231496632099, decouple_loss:0.001470831804908812
The modified gen p mean: 0.4525236189365387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03051975555717945, decouple_loss:0.0015219376655295491
The modified gen p mean: 0.4490649998188019, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032946906983852386, decouple_loss:0.0014531109482049942
Iteration: 2103, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498944878578186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03173941373825073, decouple_loss:0.0016013139393180609
The modified gen p mean: 0.44992804527282715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030640246346592903, decouple_loss:0.0013228092575445771
The modified gen p mean: 0.4529835879802704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029944350942969322, decouple_loss:0.001532713882625103
Iteration: 2104, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4535478353500366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030916748568415642, decouple_loss:0.0013285623863339424
The modified gen p mean: 0.45489612221717834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030778292566537857, decouple_loss:0.0015204065712168813
The modified gen p mean: 0.45315122604370117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031865596771240234, decouple_loss:0.00132943713106215
Iteration: 2105, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45300278067588806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03109472617506981, decouple_loss:0.0013394270790740848
The modified gen p mean: 0.45877012610435486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029946887865662575, decouple_loss:0.001455496996641159
The modified gen p mean: 0.45494723320007324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030092060565948486, decouple_loss:0.0014243862824514508
Iteration: 2106, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4524269998073578, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030842741951346397, decouple_loss:0.0013706325553357601
The modified gen p mean: 0.45743387937545776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031393032521009445, decouple_loss:0.0016463003121316433
The modified gen p mean: 0.45730358362197876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031213846057653427, decouple_loss:0.0015335200587287545
Iteration: 2107, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519059658050537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030324334278702736, decouple_loss:0.0012486167252063751
The modified gen p mean: 0.45249447226524353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030383242294192314, decouple_loss:0.0014114566147327423
The modified gen p mean: 0.45067015290260315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03217632696032524, decouple_loss:0.0013936383184045553
Iteration: 2108, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496052861213684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031368233263492584, decouple_loss:0.0014460625825449824
The modified gen p mean: 0.44979044795036316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03149959817528725, decouple_loss:0.0013899978948757052
The modified gen p mean: 0.44610700011253357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031984541565179825, decouple_loss:0.0012273341417312622
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr.npz
NaN value num: 0
Iteration: 2109, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44698336720466614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02644258551299572, decouple_loss:0.0013587491121143103
The modified gen p mean: 0.44624266028404236, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44386526942253113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027332667261362076, decouple_loss:0.001366641721688211
loss_pred:0.02738223224878311, decouple_loss:0.001340184942819178
Iteration: 2110, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44015491008758545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02689402550458908, decouple_loss:0.0013472090940922499
The modified gen p mean: 0.4457639157772064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0266683679074049, decouple_loss:0.0015921350568532944
The modified gen p mean: 0.44138213992118835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027224309742450714, decouple_loss:0.0015125965001061559
2023-05-26 18:22:24 testing...
The modified gen p mean: 0.4468027651309967, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03208760917186737, decouple_loss:0.0015773222548887134
The modified gen p mean: 0.4451974332332611, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032562505453825, decouple_loss:0.0014821781078353524
The modified gen p mean: 0.4467974305152893, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033671483397483826, decouple_loss:0.001638873596675694
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0328521728515625, avg_mse: 0.044363874942064285
current test mse: 0.044364
Iteration: 2111, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466111958026886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026595013216137886, decouple_loss:0.0014638329157605767
The modified gen p mean: 0.44123968482017517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02804046869277954, decouple_loss:0.0014427892165258527
The modified gen p mean: 0.44076603651046753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027928784489631653, decouple_loss:0.0012708584545180202
Iteration: 2112, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470301568508148, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02653205394744873, decouple_loss:0.0014287321828305721
The modified gen p mean: 0.43990543484687805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02846633642911911, decouple_loss:0.0013772720703855157
The modified gen p mean: 0.43985456228256226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028371311724185944, decouple_loss:0.0012951871613040566
Iteration: 2113, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44014772772789, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02692018263041973, decouple_loss:0.0012917891144752502
The modified gen p mean: 0.4436161518096924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02740742638707161, decouple_loss:0.0015020201681181788
The modified gen p mean: 0.44194474816322327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025706224143505096, decouple_loss:0.001292559434659779
Iteration: 2114, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4426612854003906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02884041890501976, decouple_loss:0.0014585162280127406
The modified gen p mean: 0.441437691450119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02754324860870838, decouple_loss:0.001414459547959268
The modified gen p mean: 0.4418089687824249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027882302179932594, decouple_loss:0.0014666018541902304
Iteration: 2115, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441041648387909, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026752455160021782, decouple_loss:0.001417180523276329
The modified gen p mean: 0.4470944106578827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02668951079249382, decouple_loss:0.0014880457893013954
The modified gen p mean: 0.45043325424194336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026736391708254814, decouple_loss:0.0014146026223897934
Iteration: 2116, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516121447086334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026661342009902, decouple_loss:0.0014134173979982734
The modified gen p mean: 0.4545605480670929, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026460202410817146, decouple_loss:0.0014225449413061142
The modified gen p mean: 0.4541066884994507, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026030870154500008, decouple_loss:0.0014466532738879323
Iteration: 2117, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45164862275123596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0268259197473526, decouple_loss:0.001450070645660162
The modified gen p mean: 0.45245158672332764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02683706395328045, decouple_loss:0.0014424638357013464
The modified gen p mean: 0.45559269189834595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025642968714237213, decouple_loss:0.0014813928864896297
Iteration: 2118, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489300549030304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026879288256168365, decouple_loss:0.0014002637472003698
The modified gen p mean: 0.4531801640987396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02638477459549904, decouple_loss:0.0014046388678252697
The modified gen p mean: 0.4498354196548462, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027482224628329277, decouple_loss:0.0013090710854157805
Iteration: 2119, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45090752840042114, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4531308710575104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02790640853345394, decouple_loss:0.001501662889495492
loss_pred:0.027037423104047775, decouple_loss:0.001349309808574617
The modified gen p mean: 0.45236074924468994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026499275118112564, decouple_loss:0.001571092987433076
Iteration: 2120, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45386576652526855, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45175886154174805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026691066101193428, decouple_loss:0.0015286634443327785
loss_pred:0.027241358533501625, decouple_loss:0.0015203962102532387
The modified gen p mean: 0.449482262134552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027394892647862434, decouple_loss:0.0013940755743533373
2023-05-26 18:26:31 testing...
The modified gen p mean: 0.4535515308380127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03239995986223221, decouple_loss:0.0015213035512715578
The modified gen p mean: 0.4521310329437256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03286975994706154, decouple_loss:0.0014258219162002206
The modified gen p mean: 0.4534945785999298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033950112760066986, decouple_loss:0.0015691248700022697
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03314854949712753, avg_mse: 0.04504312202334404
current test mse: 0.045043
Iteration: 2121, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463745653629303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026430679485201836, decouple_loss:0.001353458035737276
The modified gen p mean: 0.4506060481071472, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025611773133277893, decouple_loss:0.0014126793248578906
The modified gen p mean: 0.4508934020996094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026303300634026527, decouple_loss:0.001355671789497137
Iteration: 2122, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495408535003662, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02547723799943924, decouple_loss:0.0013721301220357418
The modified gen p mean: 0.4479839503765106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027253407984972, decouple_loss:0.0013449584366753697
The modified gen p mean: 0.44769561290740967, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027426907792687416, decouple_loss:0.001402967725880444
Iteration: 2123, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469367265701294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026241743937134743, decouple_loss:0.0013376172864809632
The modified gen p mean: 0.4438638389110565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027147674933075905, decouple_loss:0.0013483152724802494
The modified gen p mean: 0.44836366176605225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026291605085134506, decouple_loss:0.0013640064280480146
Iteration: 2124, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4430915415287018, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44529271125793457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02668193355202675, decouple_loss:0.0013778662541881204
loss_pred:0.026593830436468124, decouple_loss:0.001424661953933537
The modified gen p mean: 0.4475136697292328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026241112500429153, decouple_loss:0.0013441365445032716
Iteration: 2125, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4436982572078705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02765215002000332, decouple_loss:0.001353979459963739
The modified gen p mean: 0.44249680638313293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026829026639461517, decouple_loss:0.0013700544368475676
The modified gen p mean: 0.44792604446411133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025728097185492516, decouple_loss:0.0011747261742129922
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr.npz
NaN value num: 0
Iteration: 2126, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44734078645706177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027847422286868095, decouple_loss:0.001434634323231876
The modified gen p mean: 0.4461805820465088, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0291150975972414, decouple_loss:0.001718204584904015
The modified gen p mean: 0.4448677599430084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026827266439795494, decouple_loss:0.0013764322502538562
Iteration: 2127, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44748982787132263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027034135535359383, decouple_loss:0.001446670270524919
The modified gen p mean: 0.447970449924469, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0262424536049366, decouple_loss:0.0017909466987475753
The modified gen p mean: 0.4465737044811249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026734620332717896, decouple_loss:0.0015192104037851095
Iteration: 2128, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451197385787964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02845841832458973, decouple_loss:0.001383101218380034
The modified gen p mean: 0.4454910159111023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028831440955400467, decouple_loss:0.0014490265166386962
The modified gen p mean: 0.446940153837204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02769102342426777, decouple_loss:0.0014962193090468645
Iteration: 2129, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44517695903778076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029395190998911858, decouple_loss:0.0014176869299262762
The modified gen p mean: 0.44688063859939575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027627529576420784, decouple_loss:0.0015599498292431235
The modified gen p mean: 0.4484224021434784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02706044912338257, decouple_loss:0.0015411569038406014
Iteration: 2130, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44840073585510254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02915705367922783, decouple_loss:0.0014072587946429849
The modified gen p mean: 0.44728556275367737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027533721178770065, decouple_loss:0.0014637801796197891
The modified gen p mean: 0.44566699862480164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02829884923994541, decouple_loss:0.0013777553103864193
2023-05-26 18:31:18 testing...
The modified gen p mean: 0.4504663348197937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03260969743132591, decouple_loss:0.001533118775114417
The modified gen p mean: 0.4492603838443756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032962001860141754, decouple_loss:0.0014535546069964767
The modified gen p mean: 0.45038580894470215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034017156809568405, decouple_loss:0.0016113383462652564
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033272918313741684, avg_mse: 0.04536253958940506
current test mse: 0.045363
Iteration: 2131, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44735008478164673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02562008425593376, decouple_loss:0.0014234844129532576
The modified gen p mean: 0.4492652118206024, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027425797656178474, decouple_loss:0.0013872494455426931
The modified gen p mean: 0.4518028199672699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027539432048797607, decouple_loss:0.0015912622911855578
Iteration: 2132, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472537040710449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026719849556684494, decouple_loss:0.0013804464833810925
The modified gen p mean: 0.4482296407222748, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028786757960915565, decouple_loss:0.0014618848217651248
The modified gen p mean: 0.4486820101737976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028370577841997147, decouple_loss:0.001426007249392569
Iteration: 2133, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44430941343307495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027558669447898865, decouple_loss:0.00129422708414495
The modified gen p mean: 0.450796514749527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028463808819651604, decouple_loss:0.0014993620570749044
The modified gen p mean: 0.4488317370414734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028421951457858086, decouple_loss:0.0015528794610872865
Iteration: 2134, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44383466243743896, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44405344128608704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02894449792802334, decouple_loss:0.0016945414245128632
loss_pred:0.02933465503156185, decouple_loss:0.001527876127511263
The modified gen p mean: 0.44698840379714966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02902280166745186, decouple_loss:0.0015674754977226257
Iteration: 2135, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44891440868377686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027386300265789032, decouple_loss:0.0015350929461419582
The modified gen p mean: 0.4499940574169159, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02658286690711975, decouple_loss:0.0015318728983402252
The modified gen p mean: 0.44569694995880127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027930017560720444, decouple_loss:0.0014487466542050242
Iteration: 2136, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449778288602829, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4461859166622162, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026877975091338158, decouple_loss:0.0016157333739101887
loss_pred:0.027725396677851677, decouple_loss:0.00142728874925524
The modified gen p mean: 0.45080769062042236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02727859653532505, decouple_loss:0.0015886955661699176
Iteration: 2137, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444858580827713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027499884366989136, decouple_loss:0.0014426341513171792
The modified gen p mean: 0.4486299455165863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027396997436881065, decouple_loss:0.0015061366138979793
The modified gen p mean: 0.44649142026901245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028581013903021812, decouple_loss:0.0014490430476143956
Iteration: 2138, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493175446987152, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026904098689556122, decouple_loss:0.001478011952713132
The modified gen p mean: 0.44531676173210144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027116822078824043, decouple_loss:0.0013011312112212181
The modified gen p mean: 0.4475316107273102, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027709774672985077, decouple_loss:0.0014081575209274888
Iteration: 2139, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45223140716552734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026730891317129135, decouple_loss:0.001506232307292521
The modified gen p mean: 0.45121076703071594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026706162840127945, decouple_loss:0.001403873786330223
The modified gen p mean: 0.45157185196876526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02832992561161518, decouple_loss:0.0014867684803903103
Iteration: 2140, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45051324367523193, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466576874256134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02821257710456848, decouple_loss:0.001419461565092206
loss_pred:0.026854978874325752, decouple_loss:0.0014232972171157598
The modified gen p mean: 0.4490456283092499, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026618506759405136, decouple_loss:0.0017691653920337558
2023-05-26 18:35:26 testing...
The modified gen p mean: 0.4520699679851532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261213377118111, decouple_loss:0.001639314810745418
The modified gen p mean: 0.4509510397911072, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0329037606716156, decouple_loss:0.0015642233192920685
The modified gen p mean: 0.45202314853668213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034041013568639755, decouple_loss:0.0016811892855912447
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033267050981521606, avg_mse: 0.045262642204761505
current test mse: 0.045263
Iteration: 2141, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44698262214660645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02810836397111416, decouple_loss:0.00131873763166368
The modified gen p mean: 0.4502256214618683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02699415571987629, decouple_loss:0.0014323139330372214
The modified gen p mean: 0.44648295640945435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027184320613741875, decouple_loss:0.0013104414101690054
Iteration: 2142, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44621047377586365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02785305306315422, decouple_loss:0.0014161744620651007
The modified gen p mean: 0.4510209262371063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028541889041662216, decouple_loss:0.001509506837464869
The modified gen p mean: 0.4504055678844452, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02734048292040825, decouple_loss:0.0015689159044995904
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr.npz
NaN value num: 0
Iteration: 2143, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477556645870209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027737192809581757, decouple_loss:0.0015840899432078004
The modified gen p mean: 0.4460471272468567, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4442565143108368, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026732195168733597, decouple_loss:0.0014603076269850135
loss_pred:0.026053911074995995, decouple_loss:0.001359080197289586
Iteration: 2144, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44381192326545715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02983066812157631, decouple_loss:0.0014449823647737503
The modified gen p mean: 0.4467586278915405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026016782969236374, decouple_loss:0.0013847859809175134
The modified gen p mean: 0.4500984847545624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027361875399947166, decouple_loss:0.0014413570752367377
Iteration: 2145, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456038177013397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027332255616784096, decouple_loss:0.001855667564086616
The modified gen p mean: 0.44916680455207825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027599480003118515, decouple_loss:0.0014728144742548466
The modified gen p mean: 0.4474567770957947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027623021975159645, decouple_loss:0.0013399053132161498
Iteration: 2146, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482244551181793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02823285572230816, decouple_loss:0.0018924479372799397
The modified gen p mean: 0.44744691252708435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02786349691450596, decouple_loss:0.0013252332573756576
The modified gen p mean: 0.4528573453426361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028667321428656578, decouple_loss:0.0014221729943528771
Iteration: 2147, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487690031528473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026457883417606354, decouple_loss:0.0015325970016419888
The modified gen p mean: 0.4475420117378235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028389129787683487, decouple_loss:0.001488315756432712
The modified gen p mean: 0.4515150189399719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732320874929428, decouple_loss:0.0016150826122611761
Iteration: 2148, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44917282462120056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027147816494107246, decouple_loss:0.001499944250099361
The modified gen p mean: 0.4502468407154083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02637524902820587, decouple_loss:0.0015421644784510136
The modified gen p mean: 0.4512741267681122, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028597164899110794, decouple_loss:0.0017817853949964046
Iteration: 2149, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45215874910354614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027635330334305763, decouple_loss:0.0014457966899499297
The modified gen p mean: 0.45030859112739563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029384151101112366, decouple_loss:0.001511021633632481
The modified gen p mean: 0.45238080620765686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028055207803845406, decouple_loss:0.0015996689908206463
Iteration: 2150, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507492184638977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02608143724501133, decouple_loss:0.0016678303945809603
The modified gen p mean: 0.4499145448207855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027811435982584953, decouple_loss:0.0014459777157753706
The modified gen p mean: 0.4488873779773712, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02751411497592926, decouple_loss:0.001408595941029489
2023-05-26 18:40:15 testing...
The modified gen p mean: 0.4549967050552368, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253994882106781, decouple_loss:0.001592359971255064
The modified gen p mean: 0.4537985920906067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0329325832426548, decouple_loss:0.0015271389856934547
The modified gen p mean: 0.4549647569656372, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03410444036126137, decouple_loss:0.0016359344590455294
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033271580934524536, avg_mse: 0.0453224703669548
current test mse: 0.045322
Iteration: 2151, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4528307318687439, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028558479622006416, decouple_loss:0.0015634035225957632
The modified gen p mean: 0.4541485607624054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02763938345015049, decouple_loss:0.0013965227408334613
The modified gen p mean: 0.44960618019104004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027348056435585022, decouple_loss:0.0012679467909038067
Iteration: 2152, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45057499408721924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027554376050829887, decouple_loss:0.0013672835193574429
The modified gen p mean: 0.45296981930732727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0266775693744421, decouple_loss:0.001454993267543614
The modified gen p mean: 0.44855087995529175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02631126157939434, decouple_loss:0.001354600884951651
Iteration: 2153, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45451945066452026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027935661375522614, decouple_loss:0.0017281658947467804
The modified gen p mean: 0.4512787461280823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02587367407977581, decouple_loss:0.0016142148524522781
The modified gen p mean: 0.4525757133960724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02860591560602188, decouple_loss:0.0016779489815235138
Iteration: 2154, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473346471786499, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02707749418914318, decouple_loss:0.0014155966928228736
The modified gen p mean: 0.44735220074653625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027033863589167595, decouple_loss:0.0013453093124553561
The modified gen p mean: 0.45054951310157776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027832411229610443, decouple_loss:0.0014238443691283464
Iteration: 2155, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450328052043915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027760382741689682, decouple_loss:0.0015391571214422584
The modified gen p mean: 0.45011404156684875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02812126837670803, decouple_loss:0.0013878875179216266
The modified gen p mean: 0.44636857509613037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027301259338855743, decouple_loss:0.0013681252021342516
Iteration: 2156, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456954002380371, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029781891033053398, decouple_loss:0.0014823016244918108
The modified gen p mean: 0.4458041489124298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025785483419895172, decouple_loss:0.0016061004716902971
The modified gen p mean: 0.4476744830608368, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028415661305189133, decouple_loss:0.0014676603022962809
Iteration: 2157, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44548919796943665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027928614988923073, decouple_loss:0.001517556607723236
The modified gen p mean: 0.44776633381843567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027489403262734413, decouple_loss:0.0016241075936704874
The modified gen p mean: 0.4439987242221832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02832750603556633, decouple_loss:0.0014728551032021642
Iteration: 2158, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446900874376297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027818141505122185, decouple_loss:0.0014685806818306446
The modified gen p mean: 0.4464973211288452, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02824227511882782, decouple_loss:0.0014258474111557007
The modified gen p mean: 0.45128336548805237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02712879702448845, decouple_loss:0.0015411187196150422
Iteration: 2159, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4525878131389618, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028218090534210205, decouple_loss:0.0017014893237501383
The modified gen p mean: 0.4438074827194214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028682081028819084, decouple_loss:0.0013388647930696607
The modified gen p mean: 0.4492277204990387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02607858180999756, decouple_loss:0.0014384746318683028
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr.npz
NaN value num: 0
Iteration: 2160, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45155492424964905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025627300143241882, decouple_loss:0.001563867088407278
The modified gen p mean: 0.45029592514038086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027037672698497772, decouple_loss:0.001702751382254064
The modified gen p mean: 0.4482820928096771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027898499742150307, decouple_loss:0.0016029210528358817
2023-05-26 18:45:07 testing...
The modified gen p mean: 0.4515592157840729, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253759816288948, decouple_loss:0.0016098051564767957
The modified gen p mean: 0.45022764801979065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032983433455228806, decouple_loss:0.0015269485302269459
The modified gen p mean: 0.45149528980255127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03410068526864052, decouple_loss:0.00161098747048527
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03328637033700943, avg_mse: 0.045416317880153656
current test mse: 0.045416
Iteration: 2161, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44442492723464966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02750021405518055, decouple_loss:0.001806215732358396
The modified gen p mean: 0.4526865482330322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026710260659456253, decouple_loss:0.0015743818366900086
The modified gen p mean: 0.44534629583358765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029104778543114662, decouple_loss:0.0016838881419971585
Iteration: 2162, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446281373500824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02712688036262989, decouple_loss:0.0016798352589830756
The modified gen p mean: 0.44699186086654663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025411617010831833, decouple_loss:0.0014460483798757195
The modified gen p mean: 0.44703468680381775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027072688564658165, decouple_loss:0.0016340998699888587
Iteration: 2163, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44558393955230713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673395164310932, decouple_loss:0.001527733518742025
The modified gen p mean: 0.44782283902168274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026771245524287224, decouple_loss:0.0014199067372828722
The modified gen p mean: 0.44716477394104004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027005193755030632, decouple_loss:0.0013493633596226573
Iteration: 2164, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479908347129822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722093090415001, decouple_loss:0.0016060728812590241
The modified gen p mean: 0.4474973678588867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027259675785899162, decouple_loss:0.0015488589415326715
The modified gen p mean: 0.4455726444721222, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026837030425667763, decouple_loss:0.0014878008514642715
Iteration: 2165, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444892019033432, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02682247944176197, decouple_loss:0.0015693868044763803
The modified gen p mean: 0.4470190107822418, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02569030039012432, decouple_loss:0.0016657240921631455
The modified gen p mean: 0.44624844193458557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027583416551351547, decouple_loss:0.0014748399844393134
Iteration: 2166, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44919857382774353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026076918467879295, decouple_loss:0.0015447954647243023
The modified gen p mean: 0.45174843072891235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025823893025517464, decouple_loss:0.001606549951247871
The modified gen p mean: 0.4470136761665344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02578553557395935, decouple_loss:0.0016806722851470113
Iteration: 2167, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44524991512298584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026678426191210747, decouple_loss:0.0014547179453074932
The modified gen p mean: 0.4467974901199341, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025441665202379227, decouple_loss:0.0015184911899268627
The modified gen p mean: 0.4448613226413727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027412032708525658, decouple_loss:0.0014023823896422982
Iteration: 2168, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44661593437194824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026895875111222267, decouple_loss:0.0014607412740588188
The modified gen p mean: 0.4465598464012146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027584830299019814, decouple_loss:0.0014333846047520638
The modified gen p mean: 0.4496407210826874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026225203648209572, decouple_loss:0.0015284543624147773
Iteration: 2169, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44604694843292236, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4453136920928955, gen p mean: 0.0, mean p set: 0.448loss_pred:0.026329224929213524, decouple_loss:0.0012985705398023129
loss_pred:0.02766595408320427, decouple_loss:0.0013875574804842472
The modified gen p mean: 0.45161932706832886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025204675272107124, decouple_loss:0.0014428916620090604
Iteration: 2170, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469711482524872, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02628294564783573, decouple_loss:0.0016291048377752304
The modified gen p mean: 0.45049595832824707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02553778514266014, decouple_loss:0.0013924140948802233
The modified gen p mean: 0.44750750064849854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026297500357031822, decouple_loss:0.0015862667933106422
2023-05-26 18:49:13 testing...
The modified gen p mean: 0.45091530680656433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032625291496515274, decouple_loss:0.0016509377164766192
The modified gen p mean: 0.44946885108947754, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4508484899997711, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032970719039440155, decouple_loss:0.0014401694061234593
loss_pred:0.03414800763130188, decouple_loss:0.0016200494719669223
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03332652896642685, avg_mse: 0.04544105753302574
current test mse: 0.045441
Iteration: 2171, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503155052661896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025432085618376732, decouple_loss:0.0014457149663940072
The modified gen p mean: 0.44649794697761536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026683663949370384, decouple_loss:0.0015588656533509493
The modified gen p mean: 0.4441206455230713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027603203430771828, decouple_loss:0.001359086367301643
Iteration: 2172, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44547685980796814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02688419632613659, decouple_loss:0.0015767551958560944
The modified gen p mean: 0.4442831873893738, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02725229226052761, decouple_loss:0.001425654743798077
The modified gen p mean: 0.44467654824256897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026779398322105408, decouple_loss:0.0013279443373903632
Iteration: 2173, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452638626098633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028463250026106834, decouple_loss:0.0014504765858873725
The modified gen p mean: 0.4485297203063965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02643241547048092, decouple_loss:0.0014019766822457314
The modified gen p mean: 0.44630539417266846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026469940319657326, decouple_loss:0.001378634013235569
Iteration: 2174, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44649738073349, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4505392611026764, gen p mean: 0.0, mean p set: 0.448loss_pred:0.025556514039635658, decouple_loss:0.001247753156349063
loss_pred:0.027008216828107834, decouple_loss:0.0013675624504685402
The modified gen p mean: 0.44712352752685547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026275793090462685, decouple_loss:0.0014711207477375865
Iteration: 2175, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498794376850128, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02475809119641781, decouple_loss:0.0013793375110253692
The modified gen p mean: 0.4483935832977295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026436202228069305, decouple_loss:0.0015778396045789123
The modified gen p mean: 0.4471631348133087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027095504105091095, decouple_loss:0.0014224416809156537
Iteration: 2176, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484593868255615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02593725547194481, decouple_loss:0.0014565822202712297
The modified gen p mean: 0.45201075077056885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026092981919646263, decouple_loss:0.001510085305199027
The modified gen p mean: 0.44759076833724976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02681577391922474, decouple_loss:0.001447788905352354
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr.npz
NaN value num: 0
Iteration: 2177, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44653090834617615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031020497903227806, decouple_loss:0.0013955456670373678
The modified gen p mean: 0.44731128215789795, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4495953917503357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033693715929985046, decouple_loss:0.0015884588938206434
loss_pred:0.03025813214480877, decouple_loss:0.001498037832789123
Iteration: 2178, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45181506872177124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030262673273682594, decouple_loss:0.0015232219593599439
The modified gen p mean: 0.4485761523246765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03206535801291466, decouple_loss:0.00135490158572793
The modified gen p mean: 0.44719359278678894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031545501202344894, decouple_loss:0.001453174278140068
Iteration: 2179, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45105448365211487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029954755678772926, decouple_loss:0.0013520752545446157
The modified gen p mean: 0.4490797519683838, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03191943094134331, decouple_loss:0.0015788658056408167
The modified gen p mean: 0.4498296082019806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031911153346300125, decouple_loss:0.001401551184244454
Iteration: 2180, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45109912753105164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031342413276433945, decouple_loss:0.001444613328203559
The modified gen p mean: 0.4531686305999756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03273681178689003, decouple_loss:0.0013788281939923763
The modified gen p mean: 0.450706422328949, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03257281333208084, decouple_loss:0.0012413231888785958
2023-05-26 18:53:59 testing...
The modified gen p mean: 0.4555507004261017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03229286149144173, decouple_loss:0.001631801133044064
The modified gen p mean: 0.4540484547615051, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251630812883377, decouple_loss:0.0014471167232841253
The modified gen p mean: 0.4554462432861328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033891722559928894, decouple_loss:0.0016180488746613264
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03297857940196991, avg_mse: 0.04471936449408531
current test mse: 0.044719
Iteration: 2181, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45675861835479736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032287828624248505, decouple_loss:0.0016463652718812227
The modified gen p mean: 0.45112016797065735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030650010332465172, decouple_loss:0.0014929777244105935
The modified gen p mean: 0.45642346143722534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03191656619310379, decouple_loss:0.0015561210457235575
Iteration: 2182, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4541743993759155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03114372305572033, decouple_loss:0.0015777527587488294
The modified gen p mean: 0.45390695333480835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031424373388290405, decouple_loss:0.001397381187416613
The modified gen p mean: 0.4521913528442383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03362013027071953, decouple_loss:0.001367392367683351
Iteration: 2183, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509837031364441, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03153305873274803, decouple_loss:0.001610264996998012
The modified gen p mean: 0.45389723777770996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030819082632660866, decouple_loss:0.0013270144117996097
The modified gen p mean: 0.4513435661792755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03156575560569763, decouple_loss:0.0014806410763412714
Iteration: 2184, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45445123314857483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03161595016717911, decouple_loss:0.001399804255925119
The modified gen p mean: 0.45194217562675476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032255131751298904, decouple_loss:0.001390709774568677
The modified gen p mean: 0.4531082212924957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03052615560591221, decouple_loss:0.00146664644125849
Iteration: 2185, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504493474960327, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4511716365814209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03264434635639191, decouple_loss:0.0014957283856347203
loss_pred:0.03301117196679115, decouple_loss:0.0013731506187468767
The modified gen p mean: 0.4481865167617798, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03324436396360397, decouple_loss:0.0013478855835273862
Iteration: 2186, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451146125793457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03299796208739281, decouple_loss:0.0015531291719526052
The modified gen p mean: 0.44496533274650574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03100125677883625, decouple_loss:0.0013315132819116116
The modified gen p mean: 0.4470095634460449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03315191715955734, decouple_loss:0.0014190832152962685
Iteration: 2187, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44813117384910583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030707310885190964, decouple_loss:0.001448104390874505
The modified gen p mean: 0.4461635649204254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031967177987098694, decouple_loss:0.001338290050625801
The modified gen p mean: 0.444982647895813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03180733323097229, decouple_loss:0.001344587653875351
Iteration: 2188, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44280561804771423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031857460737228394, decouple_loss:0.0014512005727738142
The modified gen p mean: 0.4416026771068573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03160766139626503, decouple_loss:0.0013759569264948368
The modified gen p mean: 0.44234126806259155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03222307935357094, decouple_loss:0.0012666574912145734
Iteration: 2189, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4427526593208313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0336109921336174, decouple_loss:0.0013688243925571442
The modified gen p mean: 0.44291868805885315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030157899484038353, decouple_loss:0.0012932076351717114
The modified gen p mean: 0.4410439133644104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0297407116740942, decouple_loss:0.0012959360610693693
Iteration: 2190, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442618489265442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032005179673433304, decouple_loss:0.001344161806628108
The modified gen p mean: 0.44293853640556335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03228375315666199, decouple_loss:0.0012743291445076466
The modified gen p mean: 0.44260165095329285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030471188947558403, decouple_loss:0.00140526017639786
2023-05-26 18:58:04 testing...
The modified gen p mean: 0.4501773715019226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03203467279672623, decouple_loss:0.001563924248330295
The modified gen p mean: 0.4485699236392975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0322263203561306, decouple_loss:0.0013676228700205684
The modified gen p mean: 0.45002394914627075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03355688601732254, decouple_loss:0.001527731423266232
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03268028423190117, avg_mse: 0.04423294588923454
current test mse: 0.044233
Iteration: 2191, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444924533367157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03240707144141197, decouple_loss:0.001374637009575963
The modified gen p mean: 0.445820689201355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032358672469854355, decouple_loss:0.001345662516541779
The modified gen p mean: 0.44541090726852417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029020780697464943, decouple_loss:0.0014350359560921788
Iteration: 2192, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482605457305908, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030889233574271202, decouple_loss:0.001410307246260345
The modified gen p mean: 0.4460335969924927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03136170655488968, decouple_loss:0.0013066319515928626
The modified gen p mean: 0.44969555735588074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031004443764686584, decouple_loss:0.0013833921402692795
Iteration: 2193, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508148729801178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0308619886636734, decouple_loss:0.001342235249467194
The modified gen p mean: 0.4522658884525299, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03158386051654816, decouple_loss:0.0013773064129054546
The modified gen p mean: 0.4522167444229126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030763909220695496, decouple_loss:0.001335791894234717
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr.npz
NaN value num: 0
Iteration: 2194, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45154044032096863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03363286331295967, decouple_loss:0.0013351899106055498
The modified gen p mean: 0.4534635543823242, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45197030901908875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032687120139598846, decouple_loss:0.0013940301723778248
loss_pred:0.031976860016584396, decouple_loss:0.0013243723660707474
Iteration: 2195, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493953287601471, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031091496348381042, decouple_loss:0.0013444856740534306
The modified gen p mean: 0.4545850157737732, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03316047787666321, decouple_loss:0.0014262250624597073
The modified gen p mean: 0.4525533616542816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03322882950305939, decouple_loss:0.0015678107738494873
Iteration: 2196, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45073455572128296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03292419761419296, decouple_loss:0.0013849479146301746
The modified gen p mean: 0.4498995244503021, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03260050341486931, decouple_loss:0.0012775802752003074
The modified gen p mean: 0.44960176944732666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03142904117703438, decouple_loss:0.0013703125296160579
Iteration: 2197, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462055265903473, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4521188735961914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03155661001801491, decouple_loss:0.0014162776060402393
loss_pred:0.030349794775247574, decouple_loss:0.001551909139379859
The modified gen p mean: 0.45094409584999084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03113134391605854, decouple_loss:0.0014951337361708283
Iteration: 2198, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483849108219147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031231453642249107, decouple_loss:0.0014846876729279757
The modified gen p mean: 0.44970986247062683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03306380286812782, decouple_loss:0.0016532380832359195
The modified gen p mean: 0.4475833773612976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03285621479153633, decouple_loss:0.0013840309111401439
Iteration: 2199, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44590142369270325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03159438818693161, decouple_loss:0.0015182774513959885
The modified gen p mean: 0.4464642107486725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031530916690826416, decouple_loss:0.0016451214905828238
The modified gen p mean: 0.44949766993522644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0321463979780674, decouple_loss:0.001398570602759719
Iteration: 2200, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44727930426597595, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4463534653186798, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03220546990633011, decouple_loss:0.0016186566790565848
loss_pred:0.03149719536304474, decouple_loss:0.0013162295799702406
The modified gen p mean: 0.44454729557037354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031335584819316864, decouple_loss:0.0013720124261453748
2023-05-26 19:02:50 testing...
The modified gen p mean: 0.45061537623405457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03183411806821823, decouple_loss:0.0016035526059567928
The modified gen p mean: 0.44903039932250977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03221308812499046, decouple_loss:0.001461002160795033
The modified gen p mean: 0.450534850358963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03343132138252258, decouple_loss:0.0016159731894731522
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03257085010409355, avg_mse: 0.044032420963048935
current test mse: 0.044032
Iteration: 2201, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467442035675049, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03368040546774864, decouple_loss:0.001444886438548565
The modified gen p mean: 0.446797639131546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031888555735349655, decouple_loss:0.0013542680535465479
The modified gen p mean: 0.44503316283226013, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03301474452018738, decouple_loss:0.0013540270738303661
Iteration: 2202, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515751004219055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03045765869319439, decouple_loss:0.0015510610537603498
The modified gen p mean: 0.44634872674942017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03089861012995243, decouple_loss:0.0014349137200042605
The modified gen p mean: 0.448427677154541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032248809933662415, decouple_loss:0.0015379033284261823
Iteration: 2203, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482724666595459, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44787582755088806, gen p mean: 0.0, mean p set: 0.448loss_pred:0.031270015984773636, decouple_loss:0.001473092008382082
loss_pred:0.03111068718135357, decouple_loss:0.0014413177268579602
The modified gen p mean: 0.44984889030456543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030796218663454056, decouple_loss:0.001459448249079287
Iteration: 2204, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45188120007514954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03114483691751957, decouple_loss:0.0014166164910420775
The modified gen p mean: 0.44994667172431946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031162166967988014, decouple_loss:0.001513680792413652
The modified gen p mean: 0.448082834482193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03346714377403259, decouple_loss:0.0013963025994598866
Iteration: 2205, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447538822889328, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466158449649811, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032040633261203766, decouple_loss:0.001535638584755361
loss_pred:0.03363368287682533, decouple_loss:0.0013149832375347614
The modified gen p mean: 0.4483887255191803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031554169952869415, decouple_loss:0.0014561180723831058
Iteration: 2206, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454403221607208, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03224732354283333, decouple_loss:0.0014334960142150521
The modified gen p mean: 0.44687357544898987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03182332590222359, decouple_loss:0.0013340275036171079
The modified gen p mean: 0.4463193714618683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03270207345485687, decouple_loss:0.0014149874914437532
Iteration: 2207, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44686466455459595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0307585671544075, decouple_loss:0.0015225706156343222
The modified gen p mean: 0.44408437609672546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0326785109937191, decouple_loss:0.001375108491629362
The modified gen p mean: 0.4482691287994385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230687603354454, decouple_loss:0.0014473495539277792
Iteration: 2208, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476657807826996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03203605115413666, decouple_loss:0.0014078308595344424
The modified gen p mean: 0.4442945420742035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03076118230819702, decouple_loss:0.001391156343743205
The modified gen p mean: 0.447296142578125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03155621141195297, decouple_loss:0.001484336913563311
Iteration: 2209, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44526806473731995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03156084194779396, decouple_loss:0.0014106985181570053
The modified gen p mean: 0.444330096244812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03334185108542442, decouple_loss:0.0014719401951879263
The modified gen p mean: 0.4491681158542633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031098514795303345, decouple_loss:0.0014293931890279055
Iteration: 2210, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44592639803886414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03217686340212822, decouple_loss:0.00152546726167202
The modified gen p mean: 0.4479639232158661, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030743716284632683, decouple_loss:0.0015674741007387638
The modified gen p mean: 0.4483287036418915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030104199424386024, decouple_loss:0.0014146850444376469
2023-05-26 19:06:57 testing...
The modified gen p mean: 0.45061981678009033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03196702152490616, decouple_loss:0.001558077521622181
The modified gen p mean: 0.4505051076412201, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03347354009747505, decouple_loss:0.0015616819728165865
The modified gen p mean: 0.4489334225654602, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03222523629665375, decouple_loss:0.00148815440479666
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032632067799568176, avg_mse: 0.044161513447761536
current test mse: 0.044162
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr.npz
NaN value num: 0
Iteration: 2211, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44425496459007263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028112953528761864, decouple_loss:0.0014137972611933947
The modified gen p mean: 0.4472578465938568, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44744977355003357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025668678805232048, decouple_loss:0.0014996083918958902
loss_pred:0.027999676764011383, decouple_loss:0.0014879184309393167
Iteration: 2212, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512331485748291, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02559894137084484, decouple_loss:0.0015606731176376343
The modified gen p mean: 0.45231518149375916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026147037744522095, decouple_loss:0.001603324431926012
The modified gen p mean: 0.4465048909187317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026494955644011497, decouple_loss:0.0013088390696793795
Iteration: 2213, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443196654319763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02712315320968628, decouple_loss:0.001338060013949871
The modified gen p mean: 0.4490869343280792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026511553674936295, decouple_loss:0.0015135244466364384
The modified gen p mean: 0.45196035504341125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025743748992681503, decouple_loss:0.0014170625945553184
Iteration: 2214, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44394055008888245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027119871228933334, decouple_loss:0.0013360854936763644
The modified gen p mean: 0.44377899169921875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025448232889175415, decouple_loss:0.0014347899705171585
The modified gen p mean: 0.44510143995285034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0274199228733778, decouple_loss:0.0013905022060498595
Iteration: 2215, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4427584409713745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027598455548286438, decouple_loss:0.0013449208345264196
The modified gen p mean: 0.44171708822250366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027468612417578697, decouple_loss:0.0014657462015748024
The modified gen p mean: 0.44265061616897583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027272406965494156, decouple_loss:0.001438672887161374
Iteration: 2216, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.43966609239578247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02658734656870365, decouple_loss:0.0015712236054241657
The modified gen p mean: 0.442596435546875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027197493240237236, decouple_loss:0.0014780160272493958
The modified gen p mean: 0.44492107629776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02678215689957142, decouple_loss:0.0014400931540876627
Iteration: 2217, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477072060108185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024941738694906235, decouple_loss:0.0014005121774971485
The modified gen p mean: 0.4446529448032379, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026039814576506615, decouple_loss:0.001382968039251864
The modified gen p mean: 0.4440681040287018, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025177976116538048, decouple_loss:0.0013708944898098707
Iteration: 2218, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44394463300704956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026313696056604385, decouple_loss:0.0015574704157188535
The modified gen p mean: 0.444202721118927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028331948444247246, decouple_loss:0.0015228937845677137
The modified gen p mean: 0.4454173445701599, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02636735700070858, decouple_loss:0.0013978291535750031
Iteration: 2219, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44422978162765503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026966815814375877, decouple_loss:0.001401411951519549
The modified gen p mean: 0.4446195960044861, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026397984474897385, decouple_loss:0.001432516030035913
The modified gen p mean: 0.44578710198402405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027839407324790955, decouple_loss:0.0015266058035194874
Iteration: 2220, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44501444697380066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026759691536426544, decouple_loss:0.0013509290292859077
The modified gen p mean: 0.4504087269306183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02650376595556736, decouple_loss:0.00153251551091671
The modified gen p mean: 0.4473954737186432, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027355821803212166, decouple_loss:0.0013689984334632754
2023-05-26 19:11:50 testing...
The modified gen p mean: 0.4525226354598999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03256155923008919, decouple_loss:0.0015625717351213098
The modified gen p mean: 0.45065414905548096, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4524519741535187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03279981389641762, decouple_loss:0.0014480592217296362
loss_pred:0.03415561467409134, decouple_loss:0.0015826714225113392
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03324888274073601, avg_mse: 0.04530523344874382
current test mse: 0.045305
Iteration: 2221, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44576117396354675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02691170945763588, decouple_loss:0.001517831813544035
The modified gen p mean: 0.4490557610988617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026574401184916496, decouple_loss:0.0013186155119910836
The modified gen p mean: 0.4446932375431061, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02744385227560997, decouple_loss:0.0013353381073102355
Iteration: 2222, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44714421033859253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027394507080316544, decouple_loss:0.001417258637957275
The modified gen p mean: 0.45237424969673157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025058230385184288, decouple_loss:0.001657007960602641
The modified gen p mean: 0.4533311724662781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025473473593592644, decouple_loss:0.0016842480981722474
Iteration: 2223, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452522397041321, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026974143460392952, decouple_loss:0.0013313762610778213
The modified gen p mean: 0.4492463171482086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025302829220891, decouple_loss:0.0014740655897185206
The modified gen p mean: 0.4463469386100769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027535904198884964, decouple_loss:0.00133874686434865
Iteration: 2224, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44690558314323425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026983901858329773, decouple_loss:0.001352163846604526
The modified gen p mean: 0.44935673475265503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026587555184960365, decouple_loss:0.001258388627320528
The modified gen p mean: 0.44774577021598816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026156872510910034, decouple_loss:0.0013994514010846615
Iteration: 2225, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45042458176612854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024942396208643913, decouple_loss:0.0016125163529068232
The modified gen p mean: 0.4464851915836334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027354834601283073, decouple_loss:0.00133536069188267
The modified gen p mean: 0.44730091094970703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0277712345123291, decouple_loss:0.0014047090662643313
Iteration: 2226, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45229053497314453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026221752166748047, decouple_loss:0.0015872371150180697
The modified gen p mean: 0.45313122868537903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024975217878818512, decouple_loss:0.0015071853995323181
The modified gen p mean: 0.4475465714931488, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024934981018304825, decouple_loss:0.001613173051737249
Iteration: 2227, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44747811555862427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026673097163438797, decouple_loss:0.0013961788499727845
The modified gen p mean: 0.4527193307876587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024830177426338196, decouple_loss:0.0016619580565020442
The modified gen p mean: 0.4480656385421753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025325367227196693, decouple_loss:0.0013872560812160373
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2228, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44793277978897095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029829297214746475, decouple_loss:0.001482000108808279
The modified gen p mean: 0.4447624683380127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03001963533461094, decouple_loss:0.001313854125328362
The modified gen p mean: 0.4497818946838379, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029197314754128456, decouple_loss:0.0014116503298282623
Iteration: 2229, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44935381412506104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028902748599648476, decouple_loss:0.001602566335350275
The modified gen p mean: 0.44960060715675354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028731506317853928, decouple_loss:0.0014275852590799332
The modified gen p mean: 0.4520152509212494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028876373544335365, decouple_loss:0.0012930436059832573
Iteration: 2230, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44971343874931335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028229856863617897, decouple_loss:0.0014167462941259146
The modified gen p mean: 0.4461752474308014, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028511183336377144, decouple_loss:0.0014336875174194574
The modified gen p mean: 0.4538451135158539, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02712833881378174, decouple_loss:0.0013600350357592106
2023-05-26 19:16:38 testing...
The modified gen p mean: 0.45368608832359314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03243187442421913, decouple_loss:0.0015789016615599394
The modified gen p mean: 0.4519139528274536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032668281346559525, decouple_loss:0.001531534013338387
The modified gen p mean: 0.45351314544677734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03397577255964279, decouple_loss:0.0016228038584813476
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033104196190834045, avg_mse: 0.04507139325141907
current test mse: 0.045071
Iteration: 2231, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488542377948761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028521275147795677, decouple_loss:0.001417999854311347
The modified gen p mean: 0.4545038342475891, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02727639302611351, decouple_loss:0.001461728592403233
The modified gen p mean: 0.44832465052604675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02874070033431053, decouple_loss:0.0013123109238222241
Iteration: 2232, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488000273704529, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029628122225403786, decouple_loss:0.0014301385963335633
The modified gen p mean: 0.4519745111465454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028079383075237274, decouple_loss:0.0013814137782901525
The modified gen p mean: 0.4496304988861084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02819453924894333, decouple_loss:0.001504008425399661
Iteration: 2233, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493926763534546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0277016032487154, decouple_loss:0.0013991218293085694
The modified gen p mean: 0.4482247233390808, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02907724305987358, decouple_loss:0.0013659405522048473
The modified gen p mean: 0.4524939954280853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027146412059664726, decouple_loss:0.001748626702465117
Iteration: 2234, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45123690366744995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028264088556170464, decouple_loss:0.0015006368048489094
The modified gen p mean: 0.4512852132320404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028561176732182503, decouple_loss:0.0013646234292536974
The modified gen p mean: 0.4494556784629822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02708805352449417, decouple_loss:0.001573391375131905
Iteration: 2235, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4521569311618805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027449635788798332, decouple_loss:0.0015162647468969226
The modified gen p mean: 0.4511007070541382, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027160804718732834, decouple_loss:0.0014702739426866174
The modified gen p mean: 0.4483506679534912, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029254646971821785, decouple_loss:0.0015230054268613458
Iteration: 2236, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44879305362701416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027424614876508713, decouple_loss:0.001469430048018694
The modified gen p mean: 0.4497489035129547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028688058257102966, decouple_loss:0.0013981076190248132
The modified gen p mean: 0.4491037428379059, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028058601543307304, decouple_loss:0.0014449909795075655
Iteration: 2237, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467158913612366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02916589006781578, decouple_loss:0.0015382081037387252
The modified gen p mean: 0.4474352300167084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02889886125922203, decouple_loss:0.0014218345750123262
The modified gen p mean: 0.4467269778251648, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02758796140551567, decouple_loss:0.0015389157924801111
Iteration: 2238, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460451006889343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029760250821709633, decouple_loss:0.0014221115270629525
The modified gen p mean: 0.4446711540222168, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029368646442890167, decouple_loss:0.0016767866909503937
The modified gen p mean: 0.44532379508018494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02803841046988964, decouple_loss:0.0016807566862553358
Iteration: 2239, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45012062788009644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026476867496967316, decouple_loss:0.001559044816531241
The modified gen p mean: 0.4455525577068329, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028257552534341812, decouple_loss:0.0015128281665965915
The modified gen p mean: 0.4428994059562683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02944113127887249, decouple_loss:0.001461118459701538
Iteration: 2240, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44429811835289, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028145503252744675, decouple_loss:0.0013893682043999434
The modified gen p mean: 0.4430232644081116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02947082929313183, decouple_loss:0.0015027167974039912
The modified gen p mean: 0.4440443217754364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028444848954677582, decouple_loss:0.0014411169104278088
2023-05-26 19:20:44 testing...
The modified gen p mean: 0.4493879973888397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032590918242931366, decouple_loss:0.001719982479698956
The modified gen p mean: 0.4475606679916382, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032963234931230545, decouple_loss:0.001699369866400957
The modified gen p mean: 0.4490678310394287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03424401581287384, decouple_loss:0.0016585950506851077
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03335069119930267, avg_mse: 0.04533986747264862
current test mse: 0.04534
Iteration: 2241, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4432598650455475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02816019393503666, decouple_loss:0.0015225833049044013
The modified gen p mean: 0.4436962604522705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028906429186463356, decouple_loss:0.0015079552540555596
The modified gen p mean: 0.44933998584747314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027915840968489647, decouple_loss:0.0016524895327165723
Iteration: 2242, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44844695925712585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026720130816102028, decouple_loss:0.0014547740574926138
The modified gen p mean: 0.44288644194602966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027515357360243797, decouple_loss:0.0014219974400475621
The modified gen p mean: 0.4503009021282196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027286862954497337, decouple_loss:0.0017120406264439225
Iteration: 2243, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44500306248664856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028384406119585037, decouple_loss:0.001607167418114841
The modified gen p mean: 0.44560694694519043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027367331087589264, decouple_loss:0.0013948248233646154
The modified gen p mean: 0.4455304443836212, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027463173493742943, decouple_loss:0.0015195412561297417
Iteration: 2244, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44664910435676575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028188331052660942, decouple_loss:0.0015549497911706567
The modified gen p mean: 0.44707217812538147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028401697054505348, decouple_loss:0.0015670222928747535
The modified gen p mean: 0.44998133182525635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0269794762134552, decouple_loss:0.0015691639855504036
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2245, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478326439857483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03047952428460121, decouple_loss:0.0014741680352017283
The modified gen p mean: 0.44776085019111633, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4538230895996094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02976073883473873, decouple_loss:0.0015882767038419843
loss_pred:0.03014160506427288, decouple_loss:0.0014284192584455013
Iteration: 2246, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4538058340549469, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029529906809329987, decouple_loss:0.0014596949331462383
The modified gen p mean: 0.44949284195899963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03025413304567337, decouple_loss:0.0013220104156062007
The modified gen p mean: 0.45232897996902466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030632827430963516, decouple_loss:0.001485648681409657
Iteration: 2247, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45254236459732056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029597299173474312, decouple_loss:0.00169073895085603
The modified gen p mean: 0.45183807611465454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03090468980371952, decouple_loss:0.0014210310764610767
The modified gen p mean: 0.45302334427833557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03153672814369202, decouple_loss:0.0014667205978184938
Iteration: 2248, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4526681900024414, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45582643151283264, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02967916801571846, decouple_loss:0.0014779984485358
loss_pred:0.03061074949800968, decouple_loss:0.0015417697140946984
The modified gen p mean: 0.4512779116630554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0293692946434021, decouple_loss:0.0014230733504518867
Iteration: 2249, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4547297954559326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02955557405948639, decouple_loss:0.0015129243256524205
The modified gen p mean: 0.45159152150154114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030514609068632126, decouple_loss:0.0013553791213780642
The modified gen p mean: 0.4518939256668091, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03025883249938488, decouple_loss:0.0014507075538858771
Iteration: 2250, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45391133427619934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029578756541013718, decouple_loss:0.0013963277451694012
The modified gen p mean: 0.4506103992462158, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030083591118454933, decouple_loss:0.0014943394344300032
The modified gen p mean: 0.45000070333480835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03018018789589405, decouple_loss:0.0014167228946462274
2023-05-26 19:25:34 testing...
The modified gen p mean: 0.45460250973701477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0324275903403759, decouple_loss:0.0016854982823133469
The modified gen p mean: 0.4527752995491028, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03288218006491661, decouple_loss:0.0015796544030308723
The modified gen p mean: 0.4541936218738556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03396964445710182, decouple_loss:0.0017074609640985727
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03317601606249809, avg_mse: 0.04498046264052391
current test mse: 0.04498
Iteration: 2251, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513370990753174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028508037328720093, decouple_loss:0.0014292518608272076
The modified gen p mean: 0.4491276741027832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0295439213514328, decouple_loss:0.0013889811234548688
The modified gen p mean: 0.4495408535003662, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03028087131679058, decouple_loss:0.0013801299501210451
Iteration: 2252, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501008689403534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030445395037531853, decouple_loss:0.0014482365222647786
The modified gen p mean: 0.44598624110221863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02895217202603817, decouple_loss:0.0013837822480127215
The modified gen p mean: 0.4498942196369171, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029029637575149536, decouple_loss:0.0015668390551581979
Iteration: 2253, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44923707842826843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030703745782375336, decouple_loss:0.0014859518269076943
The modified gen p mean: 0.4444015622138977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030979594215750694, decouple_loss:0.0014720233157277107
The modified gen p mean: 0.4475201964378357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030045676976442337, decouple_loss:0.0014855582267045975
Iteration: 2254, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451712965965271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029111849144101143, decouple_loss:0.0014215200208127499
The modified gen p mean: 0.4428882598876953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030866162851452827, decouple_loss:0.001407790114171803
The modified gen p mean: 0.4455077052116394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030064260587096214, decouple_loss:0.001496630604378879
Iteration: 2255, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44249430298805237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03145737573504448, decouple_loss:0.0013594848569482565
The modified gen p mean: 0.4428653120994568, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029952669516205788, decouple_loss:0.0015165646327659488
The modified gen p mean: 0.44259482622146606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031163347885012627, decouple_loss:0.001483145751990378
Iteration: 2256, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4424576461315155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03173829987645149, decouple_loss:0.0013473755680024624
The modified gen p mean: 0.4438399076461792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0299147330224514, decouple_loss:0.0014923247508704662
The modified gen p mean: 0.4451196491718292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029028188437223434, decouple_loss:0.0013379062293097377
Iteration: 2257, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451671838760376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028836429119110107, decouple_loss:0.0015101382741704583
The modified gen p mean: 0.4426901638507843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029939215630292892, decouple_loss:0.0013096240581944585
The modified gen p mean: 0.4437658190727234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030878184363245964, decouple_loss:0.001373868901282549
Iteration: 2258, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44324079155921936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030664265155792236, decouple_loss:0.0013504488160833716
The modified gen p mean: 0.44930335879325867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028611328452825546, decouple_loss:0.0015106915961951017
The modified gen p mean: 0.4446178674697876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030781274661421776, decouple_loss:0.001380464294925332
Iteration: 2259, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462635815143585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030036073178052902, decouple_loss:0.0014141189167276025
The modified gen p mean: 0.4461919665336609, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030080528929829597, decouple_loss:0.0013838792219758034
The modified gen p mean: 0.4505898356437683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028899382799863815, decouple_loss:0.0014826408587396145
Iteration: 2260, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45175468921661377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029117483645677567, decouple_loss:0.0014706546207889915
The modified gen p mean: 0.44776418805122375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031430434435606, decouple_loss:0.0015204171650111675
The modified gen p mean: 0.4511735141277313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029778392985463142, decouple_loss:0.0015569347888231277
2023-05-26 19:29:41 testing...
The modified gen p mean: 0.4542403817176819, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0324355848133564, decouple_loss:0.0017330324044451118
The modified gen p mean: 0.4522726833820343, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45357194542884827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03273436427116394, decouple_loss:0.0015034677926450968
loss_pred:0.033834051340818405, decouple_loss:0.0017241681925952435
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03308401256799698, avg_mse: 0.04486750811338425
current test mse: 0.044868
Iteration: 2261, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44806107878685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03125378116965294, decouple_loss:0.0015563719207420945
The modified gen p mean: 0.45064687728881836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02976779080927372, decouple_loss:0.0015284842811524868
The modified gen p mean: 0.45377588272094727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03015541471540928, decouple_loss:0.0015684483805671334
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2262, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500170648097992, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03212228789925575, decouple_loss:0.0015487362397834659
The modified gen p mean: 0.4530753493309021, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4495464265346527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030362239107489586, decouple_loss:0.001511160982772708
loss_pred:0.03250175341963768, decouple_loss:0.0014906898140907288
Iteration: 2263, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45315444469451904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265276923775673, decouple_loss:0.0016155604971572757
The modified gen p mean: 0.45408278703689575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031962789595127106, decouple_loss:0.0015679136849939823
The modified gen p mean: 0.4536105990409851, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03217389062047005, decouple_loss:0.0015277813654392958
Iteration: 2264, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45306023955345154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031605109572410583, decouple_loss:0.0014883382245898247
The modified gen p mean: 0.4562985897064209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030708851292729378, decouple_loss:0.0014257770963013172
The modified gen p mean: 0.45591995120048523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03225573152303696, decouple_loss:0.001506066764704883
Iteration: 2265, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4561595320701599, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03134797140955925, decouple_loss:0.0015870215138420463
The modified gen p mean: 0.4583747684955597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03151160851120949, decouple_loss:0.0016447596717625856
The modified gen p mean: 0.45601895451545715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031117720529437065, decouple_loss:0.001534192473627627
Iteration: 2266, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.453226774930954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03157256543636322, decouple_loss:0.0014217874268069863
The modified gen p mean: 0.4527186453342438, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032635100185871124, decouple_loss:0.0015297479694709182
The modified gen p mean: 0.4510594606399536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03237178921699524, decouple_loss:0.0015130586689338088
Iteration: 2267, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493364095687866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032562173902988434, decouple_loss:0.001574084279127419
The modified gen p mean: 0.4524783194065094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03311248496174812, decouple_loss:0.0014367493567988276
The modified gen p mean: 0.4492591619491577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030522353947162628, decouple_loss:0.0015852057840675116
Iteration: 2268, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497298002243042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03271310403943062, decouple_loss:0.0014197110431268811
The modified gen p mean: 0.4546510875225067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03152310848236084, decouple_loss:0.0014698469312861562
The modified gen p mean: 0.45253461599349976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029498346149921417, decouple_loss:0.0015164576470851898
Iteration: 2269, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44758978486061096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031219812110066414, decouple_loss:0.0013669535983353853
The modified gen p mean: 0.44686830043792725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032875701785087585, decouple_loss:0.0012641600333154202
The modified gen p mean: 0.45369070768356323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030418233945965767, decouple_loss:0.001456479774788022
Iteration: 2270, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44864609837532043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03216705471277237, decouple_loss:0.0015222795773297548
The modified gen p mean: 0.44947493076324463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03165414184331894, decouple_loss:0.0015509356744587421
The modified gen p mean: 0.44834980368614197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030933251604437828, decouple_loss:0.0014610567595809698
2023-05-26 19:34:34 testing...
The modified gen p mean: 0.45356324315071106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03189314901828766, decouple_loss:0.0016192211769521236
The modified gen p mean: 0.4530409872531891, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033527109771966934, decouple_loss:0.0016266962047666311
The modified gen p mean: 0.4515906870365143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03240685537457466, decouple_loss:0.0015993951819837093
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03268979489803314, avg_mse: 0.04412588104605675
current test mse: 0.044126
Iteration: 2271, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509953260421753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030072368681430817, decouple_loss:0.001427521463483572
The modified gen p mean: 0.4490632712841034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030251337215304375, decouple_loss:0.0018007114995270967
The modified gen p mean: 0.44838017225265503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03241904824972153, decouple_loss:0.0016685606678947806
Iteration: 2272, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476234018802643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03194151073694229, decouple_loss:0.0013883524807170033
The modified gen p mean: 0.45254039764404297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029827231541275978, decouple_loss:0.0014300956390798092
The modified gen p mean: 0.45049139857292175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029873959720134735, decouple_loss:0.0015510580269619823
Iteration: 2273, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44912517070770264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0323614664375782, decouple_loss:0.0014126477763056755
The modified gen p mean: 0.44922101497650146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03178859129548073, decouple_loss:0.0013805407797917724
The modified gen p mean: 0.44759488105773926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03066798858344555, decouple_loss:0.0014411478769034147
Iteration: 2274, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44629836082458496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030587302520871162, decouple_loss:0.0015205737436190248
The modified gen p mean: 0.4481518268585205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03093077801167965, decouple_loss:0.0014663340989500284
The modified gen p mean: 0.4507855772972107, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032537706196308136, decouple_loss:0.0015675011090934277
Iteration: 2275, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44389215111732483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03182166814804077, decouple_loss:0.0014870017766952515
The modified gen p mean: 0.4436766505241394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03137004002928734, decouple_loss:0.0015324447304010391
The modified gen p mean: 0.44678112864494324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03137655928730965, decouple_loss:0.0015287171117961407
Iteration: 2276, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44417330622673035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03170120343565941, decouple_loss:0.0014068030286580324
The modified gen p mean: 0.44436901807785034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032343294471502304, decouple_loss:0.001519196666777134
The modified gen p mean: 0.4455924332141876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02971930243074894, decouple_loss:0.0015280682127922773
Iteration: 2277, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.442522794008255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030179796740412712, decouple_loss:0.001360315945930779
The modified gen p mean: 0.44609755277633667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03058924339711666, decouple_loss:0.0016202203696593642
The modified gen p mean: 0.4463651776313782, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031030187383294106, decouple_loss:0.001456278027035296
Iteration: 2278, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44749775528907776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03185247257351875, decouple_loss:0.0015266052214428782
The modified gen p mean: 0.4478934407234192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031031686812639236, decouple_loss:0.0013883281499147415
The modified gen p mean: 0.4428897500038147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0331459566950798, decouple_loss:0.0013610192108899355
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr.npz
NaN value num: 0
Iteration: 2279, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44653379917144775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02616928517818451, decouple_loss:0.0014359182678163052
The modified gen p mean: 0.44502440094947815, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4468381404876709, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0279693640768528, decouple_loss:0.0015348036540672183
loss_pred:0.027492588385939598, decouple_loss:0.0014862760435789824
Iteration: 2280, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44627299904823303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026836249977350235, decouple_loss:0.0014203235041350126
The modified gen p mean: 0.44491469860076904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028944453224539757, decouple_loss:0.0014067686861380935
The modified gen p mean: 0.44881579279899597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02721490152180195, decouple_loss:0.0013807707000523806
2023-05-26 19:39:29 testing...
The modified gen p mean: 0.45161154866218567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03204084187746048, decouple_loss:0.0016897451132535934
The modified gen p mean: 0.44953036308288574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03238873928785324, decouple_loss:0.0014638756401836872
The modified gen p mean: 0.4510745406150818, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03358069062232971, decouple_loss:0.0016508627450093627
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032750166952610016, avg_mse: 0.044200632721185684
current test mse: 0.044201
Iteration: 2281, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487206041812897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028926154598593712, decouple_loss:0.0014016838977113366
The modified gen p mean: 0.4481968879699707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026287628337740898, decouple_loss:0.0013606945285573602
The modified gen p mean: 0.4499378502368927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0265751201659441, decouple_loss:0.0014659905573353171
Iteration: 2282, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474683105945587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02863592654466629, decouple_loss:0.0013581581879407167
The modified gen p mean: 0.4465809464454651, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02818755991756916, decouple_loss:0.0013888223329558969
The modified gen p mean: 0.4454369843006134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028636856004595757, decouple_loss:0.0014122884022071958
Iteration: 2283, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44449228048324585, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44469067454338074, gen p mean: 0.0, mean p set: 0.448loss_pred:0.026647400110960007, decouple_loss:0.0014137487160041928
loss_pred:0.027445824816823006, decouple_loss:0.0014830026775598526
The modified gen p mean: 0.4447253942489624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028446374461054802, decouple_loss:0.0016065278323367238
Iteration: 2284, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434017539024353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027149226516485214, decouple_loss:0.0014103230787441134
The modified gen p mean: 0.4441872835159302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028911437839269638, decouple_loss:0.001345608732663095
The modified gen p mean: 0.44759994745254517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02728182263672352, decouple_loss:0.0015142421470955014
Iteration: 2285, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44400063157081604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029537158086895943, decouple_loss:0.0015135336434468627
The modified gen p mean: 0.4455091655254364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026332059875130653, decouple_loss:0.0015306242275983095
The modified gen p mean: 0.4471510946750641, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0276502538472414, decouple_loss:0.0014575256500393152
Iteration: 2286, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446725457906723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02709197998046875, decouple_loss:0.0014817971969023347
The modified gen p mean: 0.446975976228714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02849120832979679, decouple_loss:0.001471400260925293
The modified gen p mean: 0.44339826703071594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028329502791166306, decouple_loss:0.0015115054557099938
Iteration: 2287, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4423947334289551, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027012983337044716, decouple_loss:0.0013430473627522588
The modified gen p mean: 0.44834384322166443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02767980471253395, decouple_loss:0.0015222340589389205
The modified gen p mean: 0.4444875121116638, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029034839943051338, decouple_loss:0.0013449088437482715
Iteration: 2288, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500923752784729, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025553066283464432, decouple_loss:0.0016148043796420097
The modified gen p mean: 0.44608402252197266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027125421911478043, decouple_loss:0.001306663965806365
The modified gen p mean: 0.4446142315864563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027632717043161392, decouple_loss:0.0013576771598309278
Iteration: 2289, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44844457507133484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025400670245289803, decouple_loss:0.0013575743651017547
The modified gen p mean: 0.4478898346424103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02742774412035942, decouple_loss:0.001441068947315216
The modified gen p mean: 0.451732873916626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02605143003165722, decouple_loss:0.0016891490668058395
Iteration: 2290, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499628245830536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028990767896175385, decouple_loss:0.001439850777387619
The modified gen p mean: 0.4487949013710022, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028993763029575348, decouple_loss:0.0014198182616382837
The modified gen p mean: 0.45006614923477173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025533797219395638, decouple_loss:0.001616817433387041
2023-05-26 19:43:39 testing...
The modified gen p mean: 0.45566853880882263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03231557086110115, decouple_loss:0.001611895626410842
The modified gen p mean: 0.4538038372993469, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261052444577217, decouple_loss:0.0015016254037618637
The modified gen p mean: 0.45535776019096375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03385009989142418, decouple_loss:0.0016277702525258064
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03300441801548004, avg_mse: 0.04477444663643837
current test mse: 0.044774
Iteration: 2291, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45354172587394714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0267057903110981, decouple_loss:0.001530309091322124
The modified gen p mean: 0.45263585448265076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02600209042429924, decouple_loss:0.001408906769938767
The modified gen p mean: 0.45232921838760376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025270789861679077, decouple_loss:0.0012823774013668299
Iteration: 2292, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4536537528038025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026694675907492638, decouple_loss:0.001491183997131884
The modified gen p mean: 0.4499586224555969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025804486125707626, decouple_loss:0.0014187913620844483
The modified gen p mean: 0.4504113793373108, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027217622846364975, decouple_loss:0.0015480483416467905
Iteration: 2293, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45395123958587646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0249739158898592, decouple_loss:0.0013673511566594243
The modified gen p mean: 0.44936320185661316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027135591953992844, decouple_loss:0.0013204278657212853
The modified gen p mean: 0.450239360332489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02631349489092827, decouple_loss:0.0015206163516268134
Iteration: 2294, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44761064648628235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02931280992925167, decouple_loss:0.0013974899193271995
The modified gen p mean: 0.45129719376564026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02573322132229805, decouple_loss:0.0014696874422952533
The modified gen p mean: 0.45088955760002136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026289118453860283, decouple_loss:0.0013652238994836807
Iteration: 2295, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449748158454895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025639258325099945, decouple_loss:0.001550940447486937
The modified gen p mean: 0.4493553936481476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025705751031637192, decouple_loss:0.001371949096210301
The modified gen p mean: 0.44959715008735657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027049178257584572, decouple_loss:0.001369219971820712
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2296, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44588643312454224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028292689472436905, decouple_loss:0.0013129699509590864
The modified gen p mean: 0.4474499821662903, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44579899311065674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02810860425233841, decouple_loss:0.0013030695263296366
loss_pred:0.027113672345876694, decouple_loss:0.0013273345539346337
Iteration: 2297, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467383325099945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02858658693730831, decouple_loss:0.001352973747998476
The modified gen p mean: 0.44346150755882263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029694948345422745, decouple_loss:0.0012884342577308416
The modified gen p mean: 0.44527819752693176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02693469449877739, decouple_loss:0.0012893836246803403
Iteration: 2298, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44369029998779297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030544133856892586, decouple_loss:0.001248141867108643
The modified gen p mean: 0.4450042247772217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027826767414808273, decouple_loss:0.001361396862193942
The modified gen p mean: 0.4445321559906006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028983866795897484, decouple_loss:0.001306066638790071
Iteration: 2299, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44896259903907776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02704000100493431, decouple_loss:0.0014089334290474653
The modified gen p mean: 0.4476550817489624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028890252113342285, decouple_loss:0.0012205590028315783
The modified gen p mean: 0.44734883308410645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02901308238506317, decouple_loss:0.00158211262896657
Iteration: 2300, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44939181208610535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03013279289007187, decouple_loss:0.0013721478171646595
The modified gen p mean: 0.4536626935005188, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028359463438391685, decouple_loss:0.001418632105924189
The modified gen p mean: 0.45259273052215576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028079014271497726, decouple_loss:0.0014666090719401836
2023-05-26 19:48:28 testing...
The modified gen p mean: 0.4550323784351349, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032517869025468826, decouple_loss:0.0016935426974669099
The modified gen p mean: 0.45305192470550537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03282833471894264, decouple_loss:0.0016301675932481885
The modified gen p mean: 0.4546985626220703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034187041223049164, decouple_loss:0.0016714485827833414
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033261001110076904, avg_mse: 0.0452316552400589
current test mse: 0.045232
Iteration: 2301, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4522228538990021, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02908523753285408, decouple_loss:0.0015520075103268027
The modified gen p mean: 0.4516083896160126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028054270893335342, decouple_loss:0.001474319607950747
The modified gen p mean: 0.45050594210624695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03054114058613777, decouple_loss:0.0013907771790400147
Iteration: 2302, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4548633396625519, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02777029015123844, decouple_loss:0.0014297766610980034
The modified gen p mean: 0.4502294361591339, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028132371604442596, decouple_loss:0.0014235428534448147
The modified gen p mean: 0.4534546732902527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02960924617946148, decouple_loss:0.0014725313521921635
Iteration: 2303, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448995441198349, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0280979685485363, decouple_loss:0.0015096742426976562
The modified gen p mean: 0.4543403089046478, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02911331318318844, decouple_loss:0.0014675986021757126
The modified gen p mean: 0.4496351480484009, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027777796611189842, decouple_loss:0.0013071182183921337
Iteration: 2304, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489840567111969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029250778257846832, decouple_loss:0.001535693067125976
The modified gen p mean: 0.4547922909259796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02908352017402649, decouple_loss:0.0015564259374514222
The modified gen p mean: 0.4503469169139862, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029270539060235023, decouple_loss:0.0016402177279815078
Iteration: 2305, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44717490673065186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02656119503080845, decouple_loss:0.0015217327745631337
The modified gen p mean: 0.44665977358818054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0272383950650692, decouple_loss:0.0014401857042685151
The modified gen p mean: 0.44790568947792053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027829742059111595, decouple_loss:0.0014372685691341758
Iteration: 2306, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44920068979263306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02648507058620453, decouple_loss:0.001484059146605432
The modified gen p mean: 0.4486817419528961, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028322109952569008, decouple_loss:0.0014485762221738696
The modified gen p mean: 0.4520901143550873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028039071708917618, decouple_loss:0.0015225219540297985
Iteration: 2307, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454156756401062, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027780625969171524, decouple_loss:0.0014780490892007947
The modified gen p mean: 0.450011670589447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027466842904686928, decouple_loss:0.0014445999404415488
The modified gen p mean: 0.44659650325775146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028497954830527306, decouple_loss:0.0014658380532637239
Iteration: 2308, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4426978826522827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03006652183830738, decouple_loss:0.0014800457283854485
The modified gen p mean: 0.4478840231895447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029166793450713158, decouple_loss:0.0014732730342075229
The modified gen p mean: 0.4503288269042969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0279071182012558, decouple_loss:0.0015038189012557268
Iteration: 2309, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44377005100250244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0282052643597126, decouple_loss:0.0014420325169339776
The modified gen p mean: 0.444767564535141, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026573840528726578, decouple_loss:0.0015749429585412145
The modified gen p mean: 0.4474536180496216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028233516961336136, decouple_loss:0.001574008259922266
Iteration: 2310, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485838711261749, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.449041485786438, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028445543721318245, decouple_loss:0.0014896199572831392loss_pred:0.026279356330633163, decouple_loss:0.0015296171186491847
The modified gen p mean: 0.4447628855705261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028836358338594437, decouple_loss:0.0014875733759254217
2023-05-26 19:52:37 testing...
The modified gen p mean: 0.45199477672576904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03301939368247986, decouple_loss:0.0017452898900955915
The modified gen p mean: 0.45153021812438965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034640971571207047, decouple_loss:0.0016910949489101768
The modified gen p mean: 0.4497867524623871, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03326939791440964, decouple_loss:0.0017198675777763128
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0337291918694973, avg_mse: 0.045937247574329376
current test mse: 0.045937
Iteration: 2311, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44989314675331116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026744699105620384, decouple_loss:0.0015606466913595796
The modified gen p mean: 0.44707825779914856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028458906337618828, decouple_loss:0.0013444155920296907
The modified gen p mean: 0.44989830255508423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027725782245397568, decouple_loss:0.001406347961165011
Iteration: 2312, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44921186566352844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026683682575821877, decouple_loss:0.00161540147382766
The modified gen p mean: 0.45028936862945557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02805112861096859, decouple_loss:0.0015154079301282763
The modified gen p mean: 0.4496600031852722, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027974529191851616, decouple_loss:0.0015130197862163186
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr.npz
NaN value num: 0
Iteration: 2313, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44888612627983093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028680337592959404, decouple_loss:0.0015342170372605324
The modified gen p mean: 0.4551076292991638, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026636457070708275, decouple_loss:0.0018593133427202702
The modified gen p mean: 0.45327165722846985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027058210223913193, decouple_loss:0.0016465415246784687
Iteration: 2314, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449411004781723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026937810704112053, decouple_loss:0.0017785030649974942
The modified gen p mean: 0.45035573840141296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02670009806752205, decouple_loss:0.0015512547688558698
The modified gen p mean: 0.4491490423679352, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027467073872685432, decouple_loss:0.0013753152452409267
Iteration: 2315, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45220017433166504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026603400707244873, decouple_loss:0.001374338287860155
The modified gen p mean: 0.44898301362991333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02880939655005932, decouple_loss:0.0014739648904651403
The modified gen p mean: 0.4477614164352417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027447344735264778, decouple_loss:0.0014754398725926876
Iteration: 2316, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44657203555107117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028216207399964333, decouple_loss:0.001368558849208057
The modified gen p mean: 0.44831767678260803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027871768921613693, decouple_loss:0.0014371611177921295
The modified gen p mean: 0.4482906758785248, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027899378910660744, decouple_loss:0.001542720478028059
Iteration: 2317, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44650566577911377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02781147137284279, decouple_loss:0.001364314230158925
The modified gen p mean: 0.44757887721061707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026875175535678864, decouple_loss:0.0015120890457183123
The modified gen p mean: 0.4456057548522949, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027386153116822243, decouple_loss:0.0016108696581795812
Iteration: 2318, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45124784111976624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026177745312452316, decouple_loss:0.001480619190260768
The modified gen p mean: 0.44829055666923523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02741640992462635, decouple_loss:0.001503450213931501
The modified gen p mean: 0.44435545802116394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026945002377033234, decouple_loss:0.0013984503457322717
Iteration: 2319, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44584596157073975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02704818733036518, decouple_loss:0.0014391893055289984
The modified gen p mean: 0.44595229625701904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027203937992453575, decouple_loss:0.0015018446138128638
The modified gen p mean: 0.4485119879245758, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02581484243273735, decouple_loss:0.001555573078803718
Iteration: 2320, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44987568259239197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026208097115159035, decouple_loss:0.0015511829406023026
The modified gen p mean: 0.4472668170928955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0270144771784544, decouple_loss:0.0012977506266906857
The modified gen p mean: 0.44585829973220825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027095874771475792, decouple_loss:0.0013642641715705395
2023-05-26 19:57:31 testing...
The modified gen p mean: 0.4535866975784302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03273965045809746, decouple_loss:0.0016259027179330587
The modified gen p mean: 0.4530543386936188, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034313928335905075, decouple_loss:0.0016225060680881143
The modified gen p mean: 0.45157554745674133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03293079137802124, decouple_loss:0.001515761250630021
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03340752422809601, avg_mse: 0.045492857694625854
current test mse: 0.045493
Iteration: 2321, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45014774799346924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026619374752044678, decouple_loss:0.0013949440326541662
The modified gen p mean: 0.4519706964492798, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026119163259863853, decouple_loss:0.0013789106160402298
The modified gen p mean: 0.4484685957431793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026932187378406525, decouple_loss:0.001448829541914165
Iteration: 2322, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501301050186157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027671027928590775, decouple_loss:0.0014546908205375075
The modified gen p mean: 0.44848141074180603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028184106573462486, decouple_loss:0.0014071750920265913
The modified gen p mean: 0.45050355792045593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026606256142258644, decouple_loss:0.0013924399390816689
Iteration: 2323, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45066025853157043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028144096955657005, decouple_loss:0.0013859926257282495
The modified gen p mean: 0.4503377079963684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02646002545952797, decouple_loss:0.0013378370786085725
The modified gen p mean: 0.4519069790840149, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026731224730610847, decouple_loss:0.001387414988130331
Iteration: 2324, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4560030400753021, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02546607330441475, decouple_loss:0.0013688094913959503
The modified gen p mean: 0.4502236247062683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027433382347226143, decouple_loss:0.0013225142611190677
The modified gen p mean: 0.45305687189102173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026654085144400597, decouple_loss:0.001326548052020371
Iteration: 2325, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507645070552826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722265012562275, decouple_loss:0.0013039454352110624
The modified gen p mean: 0.44960731267929077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02772398293018341, decouple_loss:0.0013953620800748467
The modified gen p mean: 0.45541131496429443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026250144466757774, decouple_loss:0.0013630324974656105
Iteration: 2326, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45133188366889954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722664177417755, decouple_loss:0.0013921705540269613
The modified gen p mean: 0.44922345876693726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025780601426959038, decouple_loss:0.0013406712096184492
The modified gen p mean: 0.4475094676017761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026967618614435196, decouple_loss:0.0012546986108645797
Iteration: 2327, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44715073704719543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02827533520758152, decouple_loss:0.0012914752587676048
The modified gen p mean: 0.4467760920524597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027373960241675377, decouple_loss:0.0013092024018988013
The modified gen p mean: 0.4481034278869629, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610686793923378, decouple_loss:0.0014504818245768547
Iteration: 2328, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44705262780189514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02806054800748825, decouple_loss:0.00133024831302464
The modified gen p mean: 0.4495829939842224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02650604397058487, decouple_loss:0.001320302952080965
The modified gen p mean: 0.4454556405544281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027906008064746857, decouple_loss:0.0014110052725300193
Iteration: 2329, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483218193054199, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027025507763028145, decouple_loss:0.0013228687457740307
The modified gen p mean: 0.4490075409412384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02602158859372139, decouple_loss:0.001470508286729455
The modified gen p mean: 0.45047587156295776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026714425534009933, decouple_loss:0.0013362143654376268
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2330, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4448956847190857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02892760932445526, decouple_loss:0.0013143806718289852
The modified gen p mean: 0.44890400767326355, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4447210133075714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027285868301987648, decouple_loss:0.00148481666110456
loss_pred:0.027130944654345512, decouple_loss:0.0015567822847515345
2023-05-26 20:02:16 testing...
The modified gen p mean: 0.45200806856155396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255903720855713, decouple_loss:0.0015449877828359604
The modified gen p mean: 0.4496784210205078, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03267316147685051, decouple_loss:0.0014126072637736797
The modified gen p mean: 0.4514862596988678, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03419889137148857, decouple_loss:0.0015411376953125
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03321867808699608, avg_mse: 0.04528779909014702
current test mse: 0.045288
Iteration: 2331, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467015862464905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02779966965317726, decouple_loss:0.0013492903672158718
The modified gen p mean: 0.44582775235176086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030510423704981804, decouple_loss:0.0013217432424426079
The modified gen p mean: 0.44987353682518005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027581287547945976, decouple_loss:0.00132556667085737
Iteration: 2332, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44715893268585205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783115953207016, decouple_loss:0.001323350123129785
The modified gen p mean: 0.4450325071811676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030385317280888557, decouple_loss:0.0014852365711703897
The modified gen p mean: 0.4472443163394928, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027675705030560493, decouple_loss:0.0013520570937544107
Iteration: 2333, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497223496437073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026758365333080292, decouple_loss:0.0013108047423884273
The modified gen p mean: 0.4506680965423584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029852712526917458, decouple_loss:0.001506512169726193
The modified gen p mean: 0.44820043444633484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027646435424685478, decouple_loss:0.0013767998898401856
Iteration: 2334, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492405652999878, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029004167765378952, decouple_loss:0.0013748889323323965
The modified gen p mean: 0.4487568736076355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029520319774746895, decouple_loss:0.0013283641310408711
The modified gen p mean: 0.4468860626220703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02796812728047371, decouple_loss:0.001240463345311582
Iteration: 2335, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482952058315277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029032360762357712, decouple_loss:0.0014642170863226056
The modified gen p mean: 0.44765278697013855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028853226453065872, decouple_loss:0.0014788659755140543
The modified gen p mean: 0.4475904703140259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02833072654902935, decouple_loss:0.0014600440626963973
Iteration: 2336, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465278387069702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02708997204899788, decouple_loss:0.001444277004338801
The modified gen p mean: 0.44631558656692505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029368886724114418, decouple_loss:0.0015177222667261958
The modified gen p mean: 0.4470950961112976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027811115607619286, decouple_loss:0.001770958537235856
Iteration: 2337, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44623082876205444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02874128706753254, decouple_loss:0.0014160702703520656
The modified gen p mean: 0.44835221767425537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02691127173602581, decouple_loss:0.0015835538506507874
The modified gen p mean: 0.44627952575683594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0289488285779953, decouple_loss:0.0014909779420122504
Iteration: 2338, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480762481689453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02696469984948635, decouple_loss:0.0015028138877823949
The modified gen p mean: 0.44465017318725586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02735849842429161, decouple_loss:0.00141712068580091
The modified gen p mean: 0.4475310146808624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027842262759804726, decouple_loss:0.0014783295337110758
Iteration: 2339, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44623517990112305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026844661682844162, decouple_loss:0.0015772138722240925
The modified gen p mean: 0.44297635555267334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029056619852781296, decouple_loss:0.0014739481266587973
The modified gen p mean: 0.4455673396587372, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029072701930999756, decouple_loss:0.0013937881449237466
Iteration: 2340, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454541504383087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027863655239343643, decouple_loss:0.001545244944281876
The modified gen p mean: 0.44308707118034363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02898501232266426, decouple_loss:0.0016208370216190815
The modified gen p mean: 0.4443977177143097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02912070043385029, decouple_loss:0.00155998847912997
2023-05-26 20:06:22 testing...
The modified gen p mean: 0.44932353496551514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251425549387932, decouple_loss:0.0017045685090124607
The modified gen p mean: 0.44709572196006775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032930999994277954, decouple_loss:0.0015530707314610481
The modified gen p mean: 0.4488193094730377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03410320729017258, decouple_loss:0.0017095383955165744
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0332656055688858, avg_mse: 0.04531700536608696
current test mse: 0.045317
Iteration: 2341, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44858306646347046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026883956044912338, decouple_loss:0.001573015470057726
The modified gen p mean: 0.4427691400051117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028282983228564262, decouple_loss:0.0015207360265776515
The modified gen p mean: 0.4450468420982361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02695346437394619, decouple_loss:0.0015324864070862532
Iteration: 2342, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4420873522758484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027776772156357765, decouple_loss:0.0014838788192719221
The modified gen p mean: 0.4467913806438446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026615407317876816, decouple_loss:0.0017388256965205073
The modified gen p mean: 0.44625580310821533, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027002234011888504, decouple_loss:0.0016133093740791082
Iteration: 2343, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44529446959495544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027072152122855186, decouple_loss:0.0015056204283609986
The modified gen p mean: 0.4443986713886261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02887798100709915, decouple_loss:0.0015130953397601843
The modified gen p mean: 0.445177286863327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02831786684691906, decouple_loss:0.0017015855992212892
Iteration: 2344, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44689735770225525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026975350454449654, decouple_loss:0.00142310606315732
The modified gen p mean: 0.45009928941726685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02752625197172165, decouple_loss:0.0015825704904273152
The modified gen p mean: 0.448403537273407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027179764583706856, decouple_loss:0.001558121177367866
Iteration: 2345, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44738689064979553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02826402336359024, decouple_loss:0.0016718603437766433
The modified gen p mean: 0.4514327049255371, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026596590876579285, decouple_loss:0.0015764373820275068
The modified gen p mean: 0.4479511082172394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028298038989305496, decouple_loss:0.0014932862250134349
Iteration: 2346, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467006325721741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02979946881532669, decouple_loss:0.0014281736221164465
The modified gen p mean: 0.45223814249038696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026830770075321198, decouple_loss:0.0014963621506467462
The modified gen p mean: 0.4471144676208496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029318401589989662, decouple_loss:0.001499188132584095
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr.npz
NaN value num: 0
Iteration: 2347, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504591226577759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02775408700108528, decouple_loss:0.0014831164153292775
The modified gen p mean: 0.4510546326637268, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4497644603252411, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029409954324364662, decouple_loss:0.0018248000415042043
loss_pred:0.029404692351818085, decouple_loss:0.0015828158939257264
Iteration: 2348, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45057806372642517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02880701795220375, decouple_loss:0.0016254617366939783
The modified gen p mean: 0.44800272583961487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02748969756066799, decouple_loss:0.001485512126237154
The modified gen p mean: 0.45016002655029297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026911353692412376, decouple_loss:0.0016585665289312601
Iteration: 2349, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506710469722748, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02698669582605362, decouple_loss:0.0016027474775910378
The modified gen p mean: 0.4525260031223297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028073115274310112, decouple_loss:0.0014743033098056912
The modified gen p mean: 0.4503742754459381, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028457453474402428, decouple_loss:0.0014989417977631092
Iteration: 2350, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45186761021614075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026731938123703003, decouple_loss:0.0017010633600875735
The modified gen p mean: 0.4548461139202118, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02699246071279049, decouple_loss:0.0014929104363545775
The modified gen p mean: 0.45436328649520874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02591709978878498, decouple_loss:0.0015285499393939972
2023-05-26 20:11:07 testing...
The modified gen p mean: 0.4553063213825226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032440535724163055, decouple_loss:0.0016624560812488198
The modified gen p mean: 0.45335400104522705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03278263285756111, decouple_loss:0.0015404457226395607
The modified gen p mean: 0.4550231099128723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0340147465467453, decouple_loss:0.0016601434908807278
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03316035866737366, avg_mse: 0.045092642307281494
current test mse: 0.045093
Iteration: 2351, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497325122356415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027387673035264015, decouple_loss:0.0017046824796125293
The modified gen p mean: 0.4494796395301819, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783794514834881, decouple_loss:0.0015961785102263093
The modified gen p mean: 0.4500102698802948, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027592379599809647, decouple_loss:0.001449938165023923
Iteration: 2352, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45097318291664124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02880006656050682, decouple_loss:0.0016025735531002283
The modified gen p mean: 0.44873112440109253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029013024643063545, decouple_loss:0.0015836764359846711
The modified gen p mean: 0.4498681128025055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028797728940844536, decouple_loss:0.0015530027449131012
Iteration: 2353, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45129936933517456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026247628033161163, decouple_loss:0.0013897075550630689
The modified gen p mean: 0.449465274810791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027692627161741257, decouple_loss:0.0013769046636298299
The modified gen p mean: 0.44881558418273926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02862013690173626, decouple_loss:0.001690842560492456
Iteration: 2354, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4521362781524658, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027139926329255104, decouple_loss:0.0014349680859595537
The modified gen p mean: 0.4523674249649048, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027972234413027763, decouple_loss:0.0015480571892112494
The modified gen p mean: 0.45033878087997437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026177505031228065, decouple_loss:0.0015110502718016505
Iteration: 2355, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44881319999694824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02608201839029789, decouple_loss:0.0014369244454428554
The modified gen p mean: 0.44888782501220703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025145240128040314, decouple_loss:0.0014297146117314696
The modified gen p mean: 0.4484328627586365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027294250205159187, decouple_loss:0.0014176275581121445
Iteration: 2356, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44910773634910583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027515999972820282, decouple_loss:0.0014001396484673023
The modified gen p mean: 0.449699342250824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02851366065442562, decouple_loss:0.0015877682017162442
The modified gen p mean: 0.45434290170669556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026797261089086533, decouple_loss:0.0016264677979052067
Iteration: 2357, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482324421405792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027697645127773285, decouple_loss:0.001399770611897111
The modified gen p mean: 0.4511726200580597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026576582342386246, decouple_loss:0.001400450011715293
The modified gen p mean: 0.4510163366794586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027923041954636574, decouple_loss:0.0013642023550346494
Iteration: 2358, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4511556327342987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02759525366127491, decouple_loss:0.0015242184745147824
The modified gen p mean: 0.452465683221817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027124697342514992, decouple_loss:0.0015353752532973886
The modified gen p mean: 0.4501834511756897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026581667363643646, decouple_loss:0.0015878512058407068
Iteration: 2359, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483779966831207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027558008208870888, decouple_loss:0.0013777472777292132
The modified gen p mean: 0.44841477274894714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0268147811293602, decouple_loss:0.0013643610291182995
The modified gen p mean: 0.44919562339782715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027344176545739174, decouple_loss:0.0014049835735931993
Iteration: 2360, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496098458766937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027194669470191002, decouple_loss:0.0014623539755120873
The modified gen p mean: 0.449993371963501, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028504548594355583, decouple_loss:0.0013858076417818666
The modified gen p mean: 0.4487491548061371, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027485977858304977, decouple_loss:0.0013675326481461525
2023-05-26 20:15:16 testing...
The modified gen p mean: 0.45345941185951233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032496899366378784, decouple_loss:0.0016040191985666752
The modified gen p mean: 0.45133376121520996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03271133452653885, decouple_loss:0.0014373292215168476
The modified gen p mean: 0.45335710048675537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03404812887310982, decouple_loss:0.0016238422831520438
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03316321223974228, avg_mse: 0.04517175257205963
current test mse: 0.045172
Iteration: 2361, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45127901434898376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026732072234153748, decouple_loss:0.0015670702559873462
The modified gen p mean: 0.4535887539386749, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026695111766457558, decouple_loss:0.001609735656529665
The modified gen p mean: 0.44994521141052246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026558414101600647, decouple_loss:0.0014696007128804922
Iteration: 2362, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45224812626838684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027261434122920036, decouple_loss:0.0013151094317436218
The modified gen p mean: 0.44499877095222473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027062581852078438, decouple_loss:0.0013646511361002922
The modified gen p mean: 0.44720396399497986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028271052986383438, decouple_loss:0.0015871303621679544
Iteration: 2363, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.453626811504364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02728438936173916, decouple_loss:0.0013998779468238354
The modified gen p mean: 0.45065543055534363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02634693682193756, decouple_loss:0.001409505377523601
The modified gen p mean: 0.450038343667984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02489151619374752, decouple_loss:0.0015444622840732336
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2364, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473046362400055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031393688172101974, decouple_loss:0.0014583040028810501
The modified gen p mean: 0.44799086451530457, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4459521472454071, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03050008788704872, decouple_loss:0.0015488206408917904
loss_pred:0.030759859830141068, decouple_loss:0.0014404798857867718
Iteration: 2365, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45521098375320435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03147003427147865, decouple_loss:0.001377926324494183
The modified gen p mean: 0.44801515340805054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031104406341910362, decouple_loss:0.0012286236742511392
The modified gen p mean: 0.4496782422065735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031053142622113228, decouple_loss:0.001330004190094769
Iteration: 2366, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492935538291931, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030740952119231224, decouple_loss:0.0013468252727761865
The modified gen p mean: 0.4484769105911255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030903158709406853, decouple_loss:0.00130824139341712
The modified gen p mean: 0.45132502913475037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030442284420132637, decouple_loss:0.0013864553766325116
Iteration: 2367, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45194077491760254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030082497745752335, decouple_loss:0.001343290088698268
The modified gen p mean: 0.4527796506881714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03214218094944954, decouple_loss:0.0012406088644638658
The modified gen p mean: 0.45403072237968445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030310360714793205, decouple_loss:0.0015576283913105726
Iteration: 2368, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514322280883789, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03163269907236099, decouple_loss:0.001272427849471569
The modified gen p mean: 0.45004403591156006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029142951592803, decouple_loss:0.0013224759604781866
The modified gen p mean: 0.44983452558517456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031387537717819214, decouple_loss:0.0012626841198652983
Iteration: 2369, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44752630591392517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03122885525226593, decouple_loss:0.00135686038993299
The modified gen p mean: 0.4538191854953766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03092615120112896, decouple_loss:0.0013337880373001099
The modified gen p mean: 0.4508715569972992, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03249990567564964, decouple_loss:0.00157001125626266
Iteration: 2370, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45149505138397217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02994718961417675, decouple_loss:0.001390953199006617
The modified gen p mean: 0.44924196600914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02933630906045437, decouple_loss:0.0016204207204282284
The modified gen p mean: 0.44687288999557495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03018982708454132, decouple_loss:0.0012274750042706728
2023-05-26 20:20:13 testing...
The modified gen p mean: 0.4524744749069214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032117847353219986, decouple_loss:0.0015230519929900765
The modified gen p mean: 0.45038068294525146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032431140542030334, decouple_loss:0.001539586577564478
The modified gen p mean: 0.4524761736392975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03366364166140556, decouple_loss:0.0015648524276912212
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032814666628837585, avg_mse: 0.04446166381239891
current test mse: 0.044462
Iteration: 2371, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44730716943740845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031239019706845284, decouple_loss:0.0013669601175934076
The modified gen p mean: 0.4472726881504059, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030671846121549606, decouple_loss:0.0011718492023646832
The modified gen p mean: 0.4504554867744446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031908512115478516, decouple_loss:0.0014530908083543181
Iteration: 2372, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44774946570396423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03058578260242939, decouple_loss:0.001292387954890728
The modified gen p mean: 0.4469349682331085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0310878474265337, decouple_loss:0.0014871886232867837
The modified gen p mean: 0.4479222297668457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03124060481786728, decouple_loss:0.0012733597541227937
Iteration: 2373, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494340419769287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031222252175211906, decouple_loss:0.001289576874114573
The modified gen p mean: 0.44637829065322876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03034646064043045, decouple_loss:0.0015271126758307219
The modified gen p mean: 0.44787323474884033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03001704066991806, decouple_loss:0.0014782603830099106
Iteration: 2374, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467821717262268, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029943399131298065, decouple_loss:0.001392525271512568
The modified gen p mean: 0.4456773102283478, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03231482207775116, decouple_loss:0.0012718845391646028
The modified gen p mean: 0.4453828036785126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030643144622445107, decouple_loss:0.0012872157385572791
Iteration: 2375, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445023775100708, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03018428012728691, decouple_loss:0.0013554921606555581
The modified gen p mean: 0.4464743137359619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032670605927705765, decouple_loss:0.0013459358597174287
The modified gen p mean: 0.445748507976532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031900838017463684, decouple_loss:0.00125015655066818
Iteration: 2376, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44921228289604187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03019486926496029, decouple_loss:0.0014504435239359736
The modified gen p mean: 0.4464862644672394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03124791942536831, decouple_loss:0.0013197405496612191
The modified gen p mean: 0.4465559422969818, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028609147295355797, decouple_loss:0.0013266855385154486
Iteration: 2377, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455091655254364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03188640996813774, decouple_loss:0.0013843365013599396
The modified gen p mean: 0.45157477259635925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029429001733660698, decouple_loss:0.0014084296999499202
The modified gen p mean: 0.4483315646648407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029701752588152885, decouple_loss:0.0012815471272915602
Iteration: 2378, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44582098722457886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03162046894431114, decouple_loss:0.0013120397925376892
The modified gen p mean: 0.4461773633956909, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030359165742993355, decouple_loss:0.001431645592674613
The modified gen p mean: 0.44996631145477295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032532695680856705, decouple_loss:0.0014943998539820313
Iteration: 2379, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486392140388489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03233719617128372, decouple_loss:0.0014172372175380588
The modified gen p mean: 0.4496237635612488, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02925916574895382, decouple_loss:0.0013182092225179076
The modified gen p mean: 0.45000478625297546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029500307515263557, decouple_loss:0.0013717757537961006
Iteration: 2380, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508586525917053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030819246545433998, decouple_loss:0.0014225178165361285
The modified gen p mean: 0.4465879201889038, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030111471191048622, decouple_loss:0.0014004891272634268
The modified gen p mean: 0.45189982652664185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029091956093907356, decouple_loss:0.0014031350146979094
2023-05-26 20:24:21 testing...
The modified gen p mean: 0.45337116718292236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032324809581041336, decouple_loss:0.0016185719287022948
The modified gen p mean: 0.45324403047561646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03386702015995979, decouple_loss:0.0015772278420627117
The modified gen p mean: 0.45119571685791016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03250802308320999, decouple_loss:0.0014469461748376489
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032977327704429626, avg_mse: 0.04468856751918793
current test mse: 0.044689
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr.npz
NaN value num: 0
Iteration: 2381, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447073757648468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028036892414093018, decouple_loss:0.001589544233866036
The modified gen p mean: 0.44555652141571045, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.446434885263443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02752840332686901, decouple_loss:0.00145534158218652
loss_pred:0.027670543640851974, decouple_loss:0.0014097725506871939
Iteration: 2382, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.452883780002594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026015084236860275, decouple_loss:0.0015545085771009326
The modified gen p mean: 0.446725457906723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02628481015563011, decouple_loss:0.0014348694821819663
The modified gen p mean: 0.45088374614715576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02815146930515766, decouple_loss:0.0013606005813926458
Iteration: 2383, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45176902413368225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02531937137246132, decouple_loss:0.0014820434153079987
The modified gen p mean: 0.44530874490737915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027883674949407578, decouple_loss:0.0013880494516342878
The modified gen p mean: 0.4505753219127655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026824751868844032, decouple_loss:0.0016079708002507687
Iteration: 2384, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449206292629242, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026881076395511627, decouple_loss:0.0014634649269282818
The modified gen p mean: 0.45035794377326965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026046769693493843, decouple_loss:0.0014790721470490098
The modified gen p mean: 0.4515584409236908, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02641797624528408, decouple_loss:0.0015194182051345706
Iteration: 2385, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44569823145866394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02778714895248413, decouple_loss:0.0016317918198183179
The modified gen p mean: 0.44298702478408813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027563920244574547, decouple_loss:0.0015165201621130109
The modified gen p mean: 0.4468620717525482, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025972634553909302, decouple_loss:0.001616914407350123
Iteration: 2386, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44779860973358154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028302229940891266, decouple_loss:0.0014838817296549678
The modified gen p mean: 0.4477144181728363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026690060272812843, decouple_loss:0.0015171150444075465
The modified gen p mean: 0.44279903173446655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02786719985306263, decouple_loss:0.0013762947637587786
Iteration: 2387, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45056289434432983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026032835245132446, decouple_loss:0.0015291961608454585
The modified gen p mean: 0.4482024908065796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026867138221859932, decouple_loss:0.0015409193001687527
The modified gen p mean: 0.44420143961906433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025595057755708694, decouple_loss:0.001422749599441886
Iteration: 2388, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4427691400051117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027832048013806343, decouple_loss:0.0014662814792245626
The modified gen p mean: 0.44785547256469727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026383254677057266, decouple_loss:0.0016200273530557752
The modified gen p mean: 0.4460994601249695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026798419654369354, decouple_loss:0.0014233913971111178
Iteration: 2389, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450474977493286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027090881019830704, decouple_loss:0.0013486928073689342
The modified gen p mean: 0.44930610060691833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025893431156873703, decouple_loss:0.0013552277814596891
The modified gen p mean: 0.44649234414100647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025366326794028282, decouple_loss:0.001363428309559822
Iteration: 2390, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472931921482086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025677476078271866, decouple_loss:0.0013900452759116888
The modified gen p mean: 0.4461345374584198, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026648446917533875, decouple_loss:0.001411734032444656
The modified gen p mean: 0.4464137852191925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027885394170880318, decouple_loss:0.0013426734367385507
2023-05-26 20:29:08 testing...
The modified gen p mean: 0.45242762565612793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03234941512346268, decouple_loss:0.0016099890926852822
The modified gen p mean: 0.4523889124393463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034010495990514755, decouple_loss:0.0016544238897040486
The modified gen p mean: 0.4504464268684387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03260583430528641, decouple_loss:0.001444669789634645
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033067069947719574, avg_mse: 0.044950224459171295
current test mse: 0.04495
Iteration: 2391, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44681572914123535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02792179398238659, decouple_loss:0.0013545515248551965
The modified gen p mean: 0.44937029480934143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026263374835252762, decouple_loss:0.0017568861367180943
The modified gen p mean: 0.4487055242061615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026153888553380966, decouple_loss:0.0016545617254450917
Iteration: 2392, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486844837665558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02750532515347004, decouple_loss:0.0015902293380349874
The modified gen p mean: 0.4517667591571808, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027061481028795242, decouple_loss:0.001425404567271471
The modified gen p mean: 0.44715386629104614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027560653164982796, decouple_loss:0.0015019476413726807
Iteration: 2393, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473167359828949, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027372002601623535, decouple_loss:0.0014599496498703957
The modified gen p mean: 0.450602263212204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027439570054411888, decouple_loss:0.0015942187746986747
The modified gen p mean: 0.4505513906478882, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027868248522281647, decouple_loss:0.0016548701096326113
Iteration: 2394, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44640350341796875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025900959968566895, decouple_loss:0.0014544832520186901
The modified gen p mean: 0.4499227702617645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026284361258149147, decouple_loss:0.0012926271883770823
The modified gen p mean: 0.44587209820747375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026190487667918205, decouple_loss:0.0013513200683519244
Iteration: 2395, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510757029056549, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026280086487531662, decouple_loss:0.0013555632904171944
The modified gen p mean: 0.45016923546791077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027731893584132195, decouple_loss:0.0014752739807590842
The modified gen p mean: 0.44700750708580017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027756761759519577, decouple_loss:0.0014118744293227792
Iteration: 2396, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466702938079834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027733633294701576, decouple_loss:0.0013844775967299938
The modified gen p mean: 0.44598135352134705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026621311902999878, decouple_loss:0.0012513169785961509
The modified gen p mean: 0.4504171311855316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02776861935853958, decouple_loss:0.0014762814389541745
Iteration: 2397, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471059739589691, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026548676192760468, decouple_loss:0.0013395617716014385
The modified gen p mean: 0.44613873958587646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027278298512101173, decouple_loss:0.0012118188897147775
The modified gen p mean: 0.4506130516529083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026658764109015465, decouple_loss:0.0014634932158514857
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2398, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484628736972809, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0325830802321434, decouple_loss:0.001252465066500008
The modified gen p mean: 0.4515005946159363, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4489476978778839, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031337909400463104, decouple_loss:0.0012596662854775786
loss_pred:0.030677201226353645, decouple_loss:0.0013848298694938421
Iteration: 2399, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45239076018333435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031638722866773605, decouple_loss:0.0014618027489632368
The modified gen p mean: 0.44902512431144714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029818352311849594, decouple_loss:0.0014483820414170623
The modified gen p mean: 0.45107847452163696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032205160707235336, decouple_loss:0.0013083762023597956
Iteration: 2400, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45151379704475403, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4527587592601776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031554050743579865, decouple_loss:0.0012824672739952803
loss_pred:0.03250879421830177, decouple_loss:0.0012939277803525329
The modified gen p mean: 0.45051780343055725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030434010550379753, decouple_loss:0.0014175736578181386
2023-05-26 20:33:55 testing...
The modified gen p mean: 0.4545992910861969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03207908198237419, decouple_loss:0.0014827195554971695
The modified gen p mean: 0.4525783956050873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246787190437317, decouple_loss:0.001433161785826087
The modified gen p mean: 0.45469582080841064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033830784261226654, decouple_loss:0.0015479570720344782
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03286697715520859, avg_mse: 0.044603101909160614
current test mse: 0.044603
Iteration: 2401, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44932615756988525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03114539012312889, decouple_loss:0.0013193630147725344
The modified gen p mean: 0.45192164182662964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030419934540987015, decouple_loss:0.0014131201896816492
The modified gen p mean: 0.45130226016044617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030315283685922623, decouple_loss:0.001360526424832642
Iteration: 2402, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45294493436813354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031136423349380493, decouple_loss:0.001400111010298133
The modified gen p mean: 0.4510985314846039, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030697645619511604, decouple_loss:0.0013169071171432734
The modified gen p mean: 0.45274990797042847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030532261356711388, decouple_loss:0.0013356253039091825
Iteration: 2403, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4554373323917389, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029694415628910065, decouple_loss:0.0013285535387694836
The modified gen p mean: 0.4495125412940979, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034004151821136475, decouple_loss:0.0014188237255439162
The modified gen p mean: 0.4568161368370056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032216694205999374, decouple_loss:0.0013980233343318105
Iteration: 2404, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4524325728416443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03114767000079155, decouple_loss:0.001384178875014186
The modified gen p mean: 0.45168784260749817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031604960560798645, decouple_loss:0.0013987879501655698
The modified gen p mean: 0.452528178691864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030840851366519928, decouple_loss:0.001400104141794145
Iteration: 2405, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4521166980266571, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02950429916381836, decouple_loss:0.0014633693499490619
The modified gen p mean: 0.45306137204170227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03026987612247467, decouple_loss:0.0014891773462295532
The modified gen p mean: 0.4488223195075989, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030788613483309746, decouple_loss:0.001564071630127728
Iteration: 2406, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44760411977767944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031775761395692825, decouple_loss:0.0012692358577623963
The modified gen p mean: 0.4510943591594696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0322149284183979, decouple_loss:0.0013267913600429893
The modified gen p mean: 0.448359876871109, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03288382664322853, decouple_loss:0.0012846241006627679
Iteration: 2407, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462912976741791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03021458350121975, decouple_loss:0.0012673515593633056
The modified gen p mean: 0.44681018590927124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03176332265138626, decouple_loss:0.0013279241975396872
The modified gen p mean: 0.45035821199417114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028057698160409927, decouple_loss:0.0012382070999592543
Iteration: 2408, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44679683446884155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03153767064213753, decouple_loss:0.0013120145304128528
The modified gen p mean: 0.4498671591281891, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031361427158117294, decouple_loss:0.0014435555785894394
The modified gen p mean: 0.4460410177707672, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030519653111696243, decouple_loss:0.0013988798018544912
Iteration: 2409, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483453035354614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03026253916323185, decouple_loss:0.001426287111826241
The modified gen p mean: 0.44563284516334534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03085029497742653, decouple_loss:0.0013346454361453652
The modified gen p mean: 0.4498252272605896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028898412361741066, decouple_loss:0.0013498699991032481
Iteration: 2410, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471394717693329, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02950475364923477, decouple_loss:0.001477159676142037
The modified gen p mean: 0.44389060139656067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030872927978634834, decouple_loss:0.0012826572638005018
The modified gen p mean: 0.4488592743873596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031891774386167526, decouple_loss:0.0014244000194594264
2023-05-26 20:38:03 testing...
The modified gen p mean: 0.45055121183395386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03207341209053993, decouple_loss:0.0015501013258472085
The modified gen p mean: 0.4483008086681366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03245427832007408, decouple_loss:0.0014569945633411407
The modified gen p mean: 0.450440913438797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03375372663140297, decouple_loss:0.0015416190726682544
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03283628448843956, avg_mse: 0.044467777013778687
current test mse: 0.044468
Iteration: 2411, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45022350549697876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032349325716495514, decouple_loss:0.0013800032902508974
The modified gen p mean: 0.4463488459587097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031153813004493713, decouple_loss:0.0012340364046394825
The modified gen p mean: 0.44720548391342163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030958082526922226, decouple_loss:0.0012134267017245293
Iteration: 2412, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491383731365204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030432619154453278, decouple_loss:0.0013372657122090459
The modified gen p mean: 0.4530514180660248, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03090476058423519, decouple_loss:0.0014264661585912108
The modified gen p mean: 0.44664281606674194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03003104031085968, decouple_loss:0.0012574067804962397
Iteration: 2413, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44892534613609314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030975162982940674, decouple_loss:0.0012758352095261216
The modified gen p mean: 0.44960805773735046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03174598515033722, decouple_loss:0.0013255050871521235
The modified gen p mean: 0.45117998123168945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032779812812805176, decouple_loss:0.001365581527352333
Iteration: 2414, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482501745223999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0304342620074749, decouple_loss:0.0013737272238358855
The modified gen p mean: 0.45060402154922485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031423382461071014, decouple_loss:0.0014408910647034645
The modified gen p mean: 0.4488283395767212, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031332626938819885, decouple_loss:0.0012980247847735882
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr.npz
NaN value num: 0
Iteration: 2415, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447090744972229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029063183814287186, decouple_loss:0.0013844487257301807
The modified gen p mean: 0.4467199444770813, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44787099957466125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027207477018237114, decouple_loss:0.001297513023018837
loss_pred:0.028074001893401146, decouple_loss:0.0013457754394039512
Iteration: 2416, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463099539279938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027619915083050728, decouple_loss:0.0015721541130915284
The modified gen p mean: 0.4463118612766266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026662776246666908, decouple_loss:0.0014572603395208716
The modified gen p mean: 0.4475429058074951, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026047708466649055, decouple_loss:0.0015131768304854631
Iteration: 2417, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458865523338318, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027094095945358276, decouple_loss:0.0014273370616137981
The modified gen p mean: 0.4445078670978546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02658677101135254, decouple_loss:0.0013442422496154904
The modified gen p mean: 0.44581708312034607, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027541164308786392, decouple_loss:0.001411457429639995
Iteration: 2418, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44616952538490295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025382259860634804, decouple_loss:0.001412577461451292
The modified gen p mean: 0.4449235200881958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02604118175804615, decouple_loss:0.0014091597404330969
The modified gen p mean: 0.4439319372177124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02785554900765419, decouple_loss:0.00133608584292233
Iteration: 2419, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460846483707428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026346810162067413, decouple_loss:0.0014828856801614165
The modified gen p mean: 0.44191882014274597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028324121609330177, decouple_loss:0.0014901813119649887
The modified gen p mean: 0.44636741280555725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026447905227541924, decouple_loss:0.0014238982694223523
Iteration: 2420, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44553154706954956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026730529963970184, decouple_loss:0.001480604289099574
The modified gen p mean: 0.44256392121315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027543162927031517, decouple_loss:0.001331841922365129
The modified gen p mean: 0.44662004709243774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025389282032847404, decouple_loss:0.0014644555049017072
2023-05-26 20:42:48 testing...
The modified gen p mean: 0.44982361793518066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230436518788338, decouple_loss:0.001679767738096416
The modified gen p mean: 0.4497470259666443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03394258767366409, decouple_loss:0.001578150549903512
The modified gen p mean: 0.4476023316383362, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032740600407123566, decouple_loss:0.001447560265660286
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0330742783844471, avg_mse: 0.044948872178792953
current test mse: 0.044949
Iteration: 2421, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471396505832672, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0259545985609293, decouple_loss:0.0013932684669271111
The modified gen p mean: 0.44599732756614685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028239840641617775, decouple_loss:0.0015391319757327437
The modified gen p mean: 0.44346094131469727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028344586491584778, decouple_loss:0.001439140411093831
Iteration: 2422, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4437573552131653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026184016838669777, decouple_loss:0.0014241522876545787
The modified gen p mean: 0.4443793296813965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026107078418135643, decouple_loss:0.0013143785763531923
The modified gen p mean: 0.4455077350139618, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027895763516426086, decouple_loss:0.0015653448645025492
Iteration: 2423, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44551295042037964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027535447850823402, decouple_loss:0.0016099570784717798
The modified gen p mean: 0.44555193185806274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026709474623203278, decouple_loss:0.0014618345303460956
The modified gen p mean: 0.4451122581958771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027888141572475433, decouple_loss:0.00135639903601259
Iteration: 2424, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475068151950836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027852077037096024, decouple_loss:0.0014364732196554542
The modified gen p mean: 0.44549232721328735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027689529582858086, decouple_loss:0.0013994516339153051
The modified gen p mean: 0.4465748369693756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025873402133584023, decouple_loss:0.001385962008498609
Iteration: 2425, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470139443874359, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027364583685994148, decouple_loss:0.0014722587075084448
The modified gen p mean: 0.44744008779525757, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025885099545121193, decouple_loss:0.00148249592166394
The modified gen p mean: 0.446672260761261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02677452191710472, decouple_loss:0.0013106949627399445
Iteration: 2426, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484351873397827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026011278852820396, decouple_loss:0.0015651691937819123
The modified gen p mean: 0.44776302576065063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026619575917720795, decouple_loss:0.0014570564962923527
The modified gen p mean: 0.44914090633392334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02578612044453621, decouple_loss:0.001467082416638732
Iteration: 2427, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508550763130188, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02575269527733326, decouple_loss:0.0014913122868165374
The modified gen p mean: 0.4518740773200989, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025560857728123665, decouple_loss:0.001502307364717126
The modified gen p mean: 0.4509992301464081, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025616062805056572, decouple_loss:0.0012771151959896088
Iteration: 2428, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44995662569999695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027997486293315887, decouple_loss:0.0013933584559708834
The modified gen p mean: 0.45320573449134827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02560688741505146, decouple_loss:0.0014068798627704382
The modified gen p mean: 0.45131343603134155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025691810995340347, decouple_loss:0.0013167927972972393
Iteration: 2429, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44598767161369324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02882697992026806, decouple_loss:0.0014386088587343693
The modified gen p mean: 0.4501815140247345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027346208691596985, decouple_loss:0.001381945563480258
The modified gen p mean: 0.44694703817367554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0283046904951334, decouple_loss:0.0012659005587920547
Iteration: 2430, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44617965817451477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028518659994006157, decouple_loss:0.0013313483214005828
The modified gen p mean: 0.45127740502357483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02636394463479519, decouple_loss:0.0013873438583686948
The modified gen p mean: 0.44887202978134155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026516534388065338, decouple_loss:0.0013269920600578189
2023-05-26 20:46:56 testing...
The modified gen p mean: 0.45381996035575867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0323762409389019, decouple_loss:0.001539501128718257
The modified gen p mean: 0.4538058042526245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03382453694939613, decouple_loss:0.0015283147804439068
The modified gen p mean: 0.45162633061408997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259176015853882, decouple_loss:0.0013976221671327949
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03300527110695839, avg_mse: 0.04495203495025635
current test mse: 0.044952
Iteration: 2431, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457235336303711, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02660331316292286, decouple_loss:0.0013958814088255167
The modified gen p mean: 0.4499119222164154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025701286271214485, decouple_loss:0.0013055646559223533
The modified gen p mean: 0.44751471281051636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02736722305417061, decouple_loss:0.0014614228857681155
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr.npz
NaN value num: 0
Iteration: 2432, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45073652267456055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029346732422709465, decouple_loss:0.0013675651280209422
The modified gen p mean: 0.4500805735588074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02882741205394268, decouple_loss:0.0014071654295548797
The modified gen p mean: 0.4514393210411072, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030024727806448936, decouple_loss:0.0014268520753830671
Iteration: 2433, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475575089454651, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029538704082369804, decouple_loss:0.0014047251315787435
The modified gen p mean: 0.44983893632888794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030991576611995697, decouple_loss:0.0014530991902574897
The modified gen p mean: 0.4511507451534271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031402744352817535, decouple_loss:0.0013737689005210996
Iteration: 2434, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502399265766144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028317978605628014, decouple_loss:0.0012846291065216064
The modified gen p mean: 0.44903862476348877, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03075750358402729, decouple_loss:0.0013849381357431412
The modified gen p mean: 0.4466308057308197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030640216544270515, decouple_loss:0.001325413933955133
Iteration: 2435, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44982677698135376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030888132750988007, decouple_loss:0.0014522755518555641
The modified gen p mean: 0.4515983462333679, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030062424018979073, decouple_loss:0.0013679246185347438
The modified gen p mean: 0.44772985577583313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028899038210511208, decouple_loss:0.001312765758484602
Iteration: 2436, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492983818054199, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031586866825819016, decouple_loss:0.001416343729943037
The modified gen p mean: 0.4489828050136566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030873842537403107, decouple_loss:0.0012871897779405117
The modified gen p mean: 0.45135051012039185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030923916026949883, decouple_loss:0.0013802185421809554
Iteration: 2437, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45210835337638855, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4526371955871582, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030346965417265892, decouple_loss:0.001330736791715026
loss_pred:0.0297597274184227, decouple_loss:0.0013900395715609193
The modified gen p mean: 0.4512431025505066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030864259228110313, decouple_loss:0.0013452155981212854
Iteration: 2438, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.453964501619339, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02898278646171093, decouple_loss:0.0013094341848045588
The modified gen p mean: 0.45542111992836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02822302281856537, decouple_loss:0.0014187986962497234
The modified gen p mean: 0.45349574089050293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02992364764213562, decouple_loss:0.001324021490290761
Iteration: 2439, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507353901863098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030052505433559418, decouple_loss:0.0014102640561759472
The modified gen p mean: 0.44952619075775146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031267933547496796, decouple_loss:0.0014045850839465857
The modified gen p mean: 0.44850343465805054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03092396818101406, decouple_loss:0.0012719816295430064
Iteration: 2440, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4545498490333557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029537774622440338, decouple_loss:0.001377656008116901
The modified gen p mean: 0.4512471854686737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03146349638700485, decouple_loss:0.0014018294168636203
The modified gen p mean: 0.447670578956604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031158244237303734, decouple_loss:0.0012952560791745782
2023-05-26 20:51:38 testing...
The modified gen p mean: 0.45603638887405396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032071858644485474, decouple_loss:0.001509379711933434
The modified gen p mean: 0.4536236524581909, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03244912251830101, decouple_loss:0.00133780506439507
The modified gen p mean: 0.45584022998809814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03361273184418678, decouple_loss:0.0014983410947024822
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032783664762973785, avg_mse: 0.04434126615524292
current test mse: 0.044341
Iteration: 2441, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44798925518989563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029322637245059013, decouple_loss:0.0013186221476644278
The modified gen p mean: 0.45014646649360657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028995400294661522, decouple_loss:0.0013422458432614803
The modified gen p mean: 0.4549764096736908, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031911179423332214, decouple_loss:0.0013961769873276353
Iteration: 2442, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44917038083076477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030344555154442787, decouple_loss:0.001212743460200727
The modified gen p mean: 0.44849374890327454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03180565685033798, decouple_loss:0.0013614784693345428
The modified gen p mean: 0.4485427737236023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0301889069378376, decouple_loss:0.0013944293605163693
Iteration: 2443, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45502808690071106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029551301151514053, decouple_loss:0.001652809209190309
The modified gen p mean: 0.44944170117378235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028623582795262337, decouple_loss:0.0015076113631948829
The modified gen p mean: 0.44896048307418823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030757350847125053, decouple_loss:0.0013889456167817116
Iteration: 2444, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478183686733246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030460810288786888, decouple_loss:0.0014348682016134262
The modified gen p mean: 0.4455042779445648, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030423862859606743, decouple_loss:0.001486930763348937
The modified gen p mean: 0.4469585716724396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030545787885785103, decouple_loss:0.0013356461422517896
Iteration: 2445, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44536370038986206, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.449459433555603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03091304376721382, decouple_loss:0.0014205464394763112
loss_pred:0.029351046308875084, decouple_loss:0.001433239784091711
The modified gen p mean: 0.4488503634929657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030647873878479004, decouple_loss:0.0014718812890350819
Iteration: 2446, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4431306719779968, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03214986249804497, decouple_loss:0.0013926741667091846
The modified gen p mean: 0.4426785707473755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03044191747903824, decouple_loss:0.0013552141608670354
The modified gen p mean: 0.44596198201179504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02977999672293663, decouple_loss:0.001251417095772922
Iteration: 2447, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513242840766907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029145441949367523, decouple_loss:0.0014859667280688882
The modified gen p mean: 0.44365283846855164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030402997508645058, decouple_loss:0.0013636029325425625
The modified gen p mean: 0.4453600347042084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029715126380324364, decouple_loss:0.0013223962159827352
Iteration: 2448, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444202184677124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029730772599577904, decouple_loss:0.0013104735407978296
The modified gen p mean: 0.4482625424861908, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02795335277915001, decouple_loss:0.0015228164847940207
The modified gen p mean: 0.4478333294391632, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028850290924310684, decouple_loss:0.0015173974679782987
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2449, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44706329703330994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0315200537443161, decouple_loss:0.0014609466306865215
The modified gen p mean: 0.4450274407863617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03130722790956497, decouple_loss:0.0013882272178307176
The modified gen p mean: 0.4457399547100067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03094792552292347, decouple_loss:0.0013361899182200432
Iteration: 2450, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44647136330604553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03248048946261406, decouple_loss:0.0014401976950466633
The modified gen p mean: 0.4523542821407318, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029819339513778687, decouple_loss:0.0014757408061996102
The modified gen p mean: 0.4511657655239105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03227253630757332, decouple_loss:0.0012876291293650866
2023-05-26 20:56:25 testing...
The modified gen p mean: 0.4546452462673187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0320393368601799, decouple_loss:0.001623846241272986
The modified gen p mean: 0.4519919753074646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255009278655052, decouple_loss:0.0014065952273085713
The modified gen p mean: 0.45419034361839294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033600375056266785, decouple_loss:0.001566798542626202
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032806556671857834, avg_mse: 0.04435320198535919
current test mse: 0.044353
Iteration: 2451, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4545190632343292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029788201674818993, decouple_loss:0.0013161359820514917
The modified gen p mean: 0.4481143355369568, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030798863619565964, decouple_loss:0.0013973360182717443
The modified gen p mean: 0.45177263021469116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031065447255969048, decouple_loss:0.0014837677590548992
Iteration: 2452, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45121073722839355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0312763974070549, decouple_loss:0.001447834656573832
The modified gen p mean: 0.4534062147140503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030314359813928604, decouple_loss:0.0013822268228977919
The modified gen p mean: 0.44940242171287537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031219899654388428, decouple_loss:0.001261407625861466
Iteration: 2453, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497382342815399, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030209774151444435, decouple_loss:0.0013611360918730497
The modified gen p mean: 0.45505982637405396, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44891321659088135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03198251128196716, decouple_loss:0.0014480787795037031
loss_pred:0.03080672025680542, decouple_loss:0.0014602224109694362
Iteration: 2454, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44933459162712097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031848255544900894, decouple_loss:0.0015341511461883783
The modified gen p mean: 0.4466424584388733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03097316436469555, decouple_loss:0.0012698819627985358
The modified gen p mean: 0.4460129737854004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032374996691942215, decouple_loss:0.0014811321161687374
Iteration: 2455, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504876434803009, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0321839340031147, decouple_loss:0.0012745762942358851
The modified gen p mean: 0.44889459013938904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031308602541685104, decouple_loss:0.0015641344944015145
The modified gen p mean: 0.44971904158592224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031352996826171875, decouple_loss:0.0014402936212718487
Iteration: 2456, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44389408826828003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030691133812069893, decouple_loss:0.0013441856717690825
The modified gen p mean: 0.4442365765571594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031004372984170914, decouple_loss:0.001511243637651205
The modified gen p mean: 0.44429636001586914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03185390308499336, decouple_loss:0.0013533174060285091
Iteration: 2457, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44503116607666016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03187066689133644, decouple_loss:0.0013372672256082296
The modified gen p mean: 0.4468002915382385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0312343817204237, decouple_loss:0.0013660849072039127
The modified gen p mean: 0.44931116700172424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030723251402378082, decouple_loss:0.001319188973866403
Iteration: 2458, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44810646772384644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03104288876056671, decouple_loss:0.001372321741655469
The modified gen p mean: 0.4443257451057434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031182821840047836, decouple_loss:0.0013571649324148893
The modified gen p mean: 0.4481799006462097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030366325750947, decouple_loss:0.00155116175301373
Iteration: 2459, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475754499435425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03205237165093422, decouple_loss:0.001457420876249671
The modified gen p mean: 0.44587990641593933, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031940970569849014, decouple_loss:0.0013039569603279233
The modified gen p mean: 0.4440804421901703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031722377985715866, decouple_loss:0.0013031658018007874
Iteration: 2460, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493384063243866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03165439888834953, decouple_loss:0.0014112528879195452
The modified gen p mean: 0.4449334144592285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0322326235473156, decouple_loss:0.001214773626998067
The modified gen p mean: 0.4466196298599243, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03181024268269539, decouple_loss:0.0013816780410706997
2023-05-26 21:00:33 testing...
The modified gen p mean: 0.4520471394062042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031938858330249786, decouple_loss:0.0015956407878547907
The modified gen p mean: 0.4498615860939026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0323663055896759, decouple_loss:0.0014773595612496138
The modified gen p mean: 0.45182281732559204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03347382694482803, decouple_loss:0.0015586185036227107
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032670192420482635, avg_mse: 0.044163089245557785
current test mse: 0.044163
Iteration: 2461, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470706880092621, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032020438462495804, decouple_loss:0.001348815392702818
The modified gen p mean: 0.45169949531555176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03143121302127838, decouple_loss:0.0015214377781376243
The modified gen p mean: 0.44683638215065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03065023012459278, decouple_loss:0.001439965213648975
Iteration: 2462, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4527193009853363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03193463757634163, decouple_loss:0.0013381041353568435
The modified gen p mean: 0.4499607980251312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03196357935667038, decouple_loss:0.0014300812035799026
The modified gen p mean: 0.4492332935333252, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0325242355465889, decouple_loss:0.0012926649069413543
Iteration: 2463, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4543992578983307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03066251054406166, decouple_loss:0.0014696825528517365
The modified gen p mean: 0.45291510224342346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029895713552832603, decouple_loss:0.001364509342238307
The modified gen p mean: 0.4485161602497101, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03195689618587494, decouple_loss:0.0013404436176642776
Iteration: 2464, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505678117275238, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03141217306256294, decouple_loss:0.0013424558565020561
The modified gen p mean: 0.452053040266037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032085590064525604, decouple_loss:0.0013179827947169542
The modified gen p mean: 0.4509601593017578, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03080611117184162, decouple_loss:0.0013342851307243109
Iteration: 2465, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45192569494247437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032365527004003525, decouple_loss:0.0014153484953567386
The modified gen p mean: 0.4498046934604645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03142945095896721, decouple_loss:0.0012396301608532667
The modified gen p mean: 0.45050933957099915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031175483018159866, decouple_loss:0.001334887114353478
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2466, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44808921217918396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028539037331938744, decouple_loss:0.0013866308145225048
The modified gen p mean: 0.4537069797515869, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4548631012439728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027696145698428154, decouple_loss:0.0013136807829141617
loss_pred:0.02658606320619583, decouple_loss:0.0014365342212840915
Iteration: 2467, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44605204463005066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028054118156433105, decouple_loss:0.0012584371725097299
The modified gen p mean: 0.45057782530784607, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026892248541116714, decouple_loss:0.0013631656765937805
The modified gen p mean: 0.4488842487335205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02867690846323967, decouple_loss:0.0014883594121783972
Iteration: 2468, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44705018401145935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026237845420837402, decouple_loss:0.0013588961446657777
The modified gen p mean: 0.4435380697250366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028307083994150162, decouple_loss:0.0012954208068549633
The modified gen p mean: 0.4482526481151581, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028668850660324097, decouple_loss:0.0013746937038376927
Iteration: 2469, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44245943427085876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028081323951482773, decouple_loss:0.0012890022480860353
The modified gen p mean: 0.4449099898338318, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027259662747383118, decouple_loss:0.0013400543248280883
The modified gen p mean: 0.4468555450439453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026781827211380005, decouple_loss:0.001552502391859889
Iteration: 2470, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4413520395755768, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028597787022590637, decouple_loss:0.0012856334215030074
The modified gen p mean: 0.4439854025840759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027593335136771202, decouple_loss:0.0013318241108208895
The modified gen p mean: 0.44405966997146606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028463302180171013, decouple_loss:0.001426071161404252
2023-05-26 21:05:22 testing...
The modified gen p mean: 0.4468245506286621, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03220285475254059, decouple_loss:0.0016229994362220168
The modified gen p mean: 0.4447808265686035, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466787278652191, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03276816010475159, decouple_loss:0.0014631549129262567
loss_pred:0.03386664018034935, decouple_loss:0.001582334516569972
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03302369639277458, avg_mse: 0.04469833895564079
current test mse: 0.044698
Iteration: 2471, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44174450635910034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028667503967881203, decouple_loss:0.0013898914912715554
The modified gen p mean: 0.4469837546348572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026484357193112373, decouple_loss:0.0013246375601738691
The modified gen p mean: 0.44038552045822144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028183581307530403, decouple_loss:0.001279362360946834
Iteration: 2472, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459332525730133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02826423943042755, decouple_loss:0.0012508871732279658
The modified gen p mean: 0.4444195330142975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026043163612484932, decouple_loss:0.0014183350140228868
The modified gen p mean: 0.4451136887073517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02704557217657566, decouple_loss:0.001466310233809054
Iteration: 2473, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475407302379608, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027209842577576637, decouple_loss:0.0014442732790485024
The modified gen p mean: 0.44628986716270447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027312807738780975, decouple_loss:0.0013461390044540167
The modified gen p mean: 0.44845277070999146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027688417583703995, decouple_loss:0.0014535341178998351
Iteration: 2474, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445474147796631, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02782932110130787, decouple_loss:0.0014208221109583974
The modified gen p mean: 0.4481818974018097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028368959203362465, decouple_loss:0.0016205529682338238
The modified gen p mean: 0.4455319046974182, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02859037183225155, decouple_loss:0.00138186477124691
Iteration: 2475, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455060064792633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02733505889773369, decouple_loss:0.0014786651590839028
The modified gen p mean: 0.4528755843639374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026113538071513176, decouple_loss:0.001538282842375338
The modified gen p mean: 0.4470811188220978, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028121570125222206, decouple_loss:0.0014519216492772102
Iteration: 2476, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448146790266037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027156097814440727, decouple_loss:0.001393418642692268
The modified gen p mean: 0.4530901312828064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025415314361453056, decouple_loss:0.0014975937083363533
The modified gen p mean: 0.4478883445262909, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028267016634345055, decouple_loss:0.0013841569889336824
Iteration: 2477, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512549638748169, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026819240301847458, decouple_loss:0.0015153082786127925
The modified gen p mean: 0.44844114780426025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02585165947675705, decouple_loss:0.0013247663155198097
The modified gen p mean: 0.45083752274513245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02827759087085724, decouple_loss:0.0014678117586299777
Iteration: 2478, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44633451104164124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027793264016509056, decouple_loss:0.0013872034614905715
The modified gen p mean: 0.4459822475910187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02684175781905651, decouple_loss:0.0013140433002263308
The modified gen p mean: 0.44790396094322205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02703985571861267, decouple_loss:0.0012514201225712895
Iteration: 2479, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44735339283943176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026426265016198158, decouple_loss:0.00137134303804487
The modified gen p mean: 0.4509632885456085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027052221819758415, decouple_loss:0.0015275499317795038
The modified gen p mean: 0.4462004005908966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027414711192250252, decouple_loss:0.001404444919899106
Iteration: 2480, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478517770767212, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02697817049920559, decouple_loss:0.0015180211048573256
The modified gen p mean: 0.44836509227752686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027725782245397568, decouple_loss:0.0015490020159631968
The modified gen p mean: 0.44713523983955383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028112860396504402, decouple_loss:0.0015121388714760542
2023-05-26 21:09:27 testing...
The modified gen p mean: 0.4508165121078491, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253643587231636, decouple_loss:0.0015829985495656729
The modified gen p mean: 0.4487316906452179, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03281009569764137, decouple_loss:0.0015017854748293757
The modified gen p mean: 0.45063525438308716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03419326990842819, decouple_loss:0.0015856376849114895
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033257775008678436, avg_mse: 0.04518602043390274
current test mse: 0.045186
Iteration: 2481, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448368102312088, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026170676574110985, decouple_loss:0.0016076592728495598
The modified gen p mean: 0.4485546946525574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026643922552466393, decouple_loss:0.001392023405060172
The modified gen p mean: 0.4448278546333313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026406601071357727, decouple_loss:0.0013832806143909693
Iteration: 2482, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445166677236557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027307791635394096, decouple_loss:0.0012606652453541756
The modified gen p mean: 0.44541728496551514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02790396474301815, decouple_loss:0.0014256029389798641
The modified gen p mean: 0.44520488381385803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02797725610435009, decouple_loss:0.0013240025145933032
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr.npz
NaN value num: 0
Iteration: 2483, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44816333055496216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027157554402947426, decouple_loss:0.0014533299254253507
The modified gen p mean: 0.4466623067855835, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.445728600025177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02713339775800705, decouple_loss:0.0014893094776198268
loss_pred:0.027065616101026535, decouple_loss:0.0013672513887286186
Iteration: 2484, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482004940509796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02639446035027504, decouple_loss:0.0014248833758756518
The modified gen p mean: 0.4451815187931061, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027561038732528687, decouple_loss:0.0014486052095890045
The modified gen p mean: 0.4419640600681305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02896994911134243, decouple_loss:0.0012597576715052128
Iteration: 2485, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44500532746315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02830405905842781, decouple_loss:0.0012863121228292584
The modified gen p mean: 0.447195827960968, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026613198220729828, decouple_loss:0.001409627147950232
The modified gen p mean: 0.4447011649608612, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02772003598511219, decouple_loss:0.0014432487078011036
Iteration: 2486, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44828304648399353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02567811869084835, decouple_loss:0.0015830581542104483
The modified gen p mean: 0.4479474425315857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026530148461461067, decouple_loss:0.0015766085125505924
The modified gen p mean: 0.44542092084884644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028348742052912712, decouple_loss:0.001431383308954537
Iteration: 2487, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445451498031616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028293801471590996, decouple_loss:0.0013688805047422647
The modified gen p mean: 0.44394057989120483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02804768830537796, decouple_loss:0.001408227952197194
The modified gen p mean: 0.44616469740867615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026152748614549637, decouple_loss:0.0015500761801376939
Iteration: 2488, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447007179260254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027348211035132408, decouple_loss:0.001370922545902431
The modified gen p mean: 0.4445013701915741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0277111753821373, decouple_loss:0.0012889549834653735
The modified gen p mean: 0.4461444914340973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02597632259130478, decouple_loss:0.0015021752333268523
Iteration: 2489, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44510072469711304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0259481742978096, decouple_loss:0.0016124004032462835
The modified gen p mean: 0.44688349962234497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025602761656045914, decouple_loss:0.001469721202738583
The modified gen p mean: 0.44614800810813904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028455356135964394, decouple_loss:0.001444010529667139
Iteration: 2490, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44417688250541687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027996884658932686, decouple_loss:0.0013744696043431759
The modified gen p mean: 0.44349831342697144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026265956461429596, decouple_loss:0.0014716015430167317
The modified gen p mean: 0.44195684790611267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02848632261157036, decouple_loss:0.001403817324899137
2023-05-26 21:14:16 testing...
The modified gen p mean: 0.44954127073287964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03272096812725067, decouple_loss:0.0015877706464380026
The modified gen p mean: 0.4475945234298706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032861627638339996, decouple_loss:0.0014672466786578298
The modified gen p mean: 0.44942790269851685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03430701419711113, decouple_loss:0.0016207124572247267
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033374469727277756, avg_mse: 0.04550274834036827
current test mse: 0.045503
Iteration: 2491, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447583943605423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026658503338694572, decouple_loss:0.001492118346504867
The modified gen p mean: 0.4436197578907013, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028798196464776993, decouple_loss:0.0014163382584229112
The modified gen p mean: 0.4459996223449707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026407113298773766, decouple_loss:0.0013194384519010782
Iteration: 2492, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438009262084961, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028442954644560814, decouple_loss:0.0014997153775766492
The modified gen p mean: 0.44494906067848206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02856709435582161, decouple_loss:0.001425970927812159
The modified gen p mean: 0.44560766220092773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02604316920042038, decouple_loss:0.0014591498766094446
Iteration: 2493, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44388678669929504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026081759482622147, decouple_loss:0.0014276154106482863
The modified gen p mean: 0.4470456540584564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027037082239985466, decouple_loss:0.001316322130151093
The modified gen p mean: 0.4464302062988281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027606656774878502, decouple_loss:0.0014844718389213085
Iteration: 2494, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450862407684326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027861567214131355, decouple_loss:0.0012656417675316334
The modified gen p mean: 0.44630494713783264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027015186846256256, decouple_loss:0.0014014055486768484
The modified gen p mean: 0.44626688957214355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02548196166753769, decouple_loss:0.00143511313945055
Iteration: 2495, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453248381614685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027825387194752693, decouple_loss:0.0014436902711167932
The modified gen p mean: 0.44739434123039246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026905864477157593, decouple_loss:0.0013584315311163664
The modified gen p mean: 0.44574812054634094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025829201564192772, decouple_loss:0.0015281100058928132
Iteration: 2496, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4432922303676605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027289848774671555, decouple_loss:0.001315111992880702
The modified gen p mean: 0.4445599615573883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0253964364528656, decouple_loss:0.0014557114336639643
The modified gen p mean: 0.4463677704334259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02577800862491131, decouple_loss:0.0013713804073631763
Iteration: 2497, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471640884876251, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025943627581000328, decouple_loss:0.0013965191319584846
The modified gen p mean: 0.4451691210269928, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02811739780008793, decouple_loss:0.0014754865551367402
The modified gen p mean: 0.4435383677482605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028090067207813263, decouple_loss:0.0013395624700933695
Iteration: 2498, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443991184234619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02768050879240036, decouple_loss:0.0013878701720386744
The modified gen p mean: 0.44650325179100037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026038145646452904, decouple_loss:0.0013113130116835237
The modified gen p mean: 0.445253849029541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027988461777567863, decouple_loss:0.0012830699561163783
Iteration: 2499, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44440340995788574, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44776833057403564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028253454715013504, decouple_loss:0.0013153486652299762
loss_pred:0.02624291367828846, decouple_loss:0.0014335901942104101
The modified gen p mean: 0.44517651200294495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02628236636519432, decouple_loss:0.0013980827061459422
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr.npz
NaN value num: 0
Iteration: 2500, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476073682308197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02636513113975525, decouple_loss:0.0015134750865399837
The modified gen p mean: 0.4417039752006531, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4424563944339752, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027089478448033333, decouple_loss:0.0012848738115280867
loss_pred:0.02713545225560665, decouple_loss:0.001325221499428153
2023-05-26 21:19:04 testing...
The modified gen p mean: 0.4503995478153229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255695477128029, decouple_loss:0.0015935800038278103
The modified gen p mean: 0.4484967291355133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032787710428237915, decouple_loss:0.001385775743983686
The modified gen p mean: 0.45033493638038635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03424057736992836, decouple_loss:0.0015744860284030437
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033270977437496185, avg_mse: 0.04537458345293999
current test mse: 0.045375
Iteration: 2501, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44623005390167236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025938529521226883, decouple_loss:0.001470502931624651
The modified gen p mean: 0.446161687374115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026060208678245544, decouple_loss:0.0015376436058431864
The modified gen p mean: 0.4474349021911621, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02569318190217018, decouple_loss:0.0014559794217348099
Iteration: 2502, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445427656173706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026827050372958183, decouple_loss:0.0013258494436740875
The modified gen p mean: 0.4476605951786041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0268723051995039, decouple_loss:0.001491588307544589
The modified gen p mean: 0.45101574063301086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02580784261226654, decouple_loss:0.0015992193948477507
Iteration: 2503, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473385214805603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026957357302308083, decouple_loss:0.001496755750849843
The modified gen p mean: 0.44571077823638916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026188727468252182, decouple_loss:0.0013828575611114502
The modified gen p mean: 0.45000770688056946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025899525731801987, decouple_loss:0.0014501424739137292
Iteration: 2504, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471738040447235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02724326029419899, decouple_loss:0.001313219778239727
The modified gen p mean: 0.45241960883140564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025925874710083008, decouple_loss:0.0014344560913741589
The modified gen p mean: 0.45101022720336914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026164347305893898, decouple_loss:0.0013519111089408398
Iteration: 2505, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491603672504425, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44728827476501465, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02734375, decouple_loss:0.0013733279192820191
loss_pred:0.02822418324649334, decouple_loss:0.0013942205114290118
The modified gen p mean: 0.4474610984325409, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026731090620160103, decouple_loss:0.0013060948112979531
Iteration: 2506, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45142075419425964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025702454149723053, decouple_loss:0.001551921246573329
The modified gen p mean: 0.4479122757911682, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026796922087669373, decouple_loss:0.001306541613303125
The modified gen p mean: 0.45046094059944153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026451652869582176, decouple_loss:0.001524664112366736
Iteration: 2507, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461526870727539, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027133967727422714, decouple_loss:0.001225227490067482
The modified gen p mean: 0.44688430428504944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02658355049788952, decouple_loss:0.0013392233522608876
The modified gen p mean: 0.44702816009521484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02844899334013462, decouple_loss:0.001462697284296155
Iteration: 2508, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.443513423204422, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4443962275981903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027536610141396523, decouple_loss:0.0012525696074590087loss_pred:0.025785889476537704, decouple_loss:0.001438685692846775
The modified gen p mean: 0.4447554349899292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027928655967116356, decouple_loss:0.0013110552681609988
Iteration: 2509, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4424162209033966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026607224717736244, decouple_loss:0.0013185993302613497
The modified gen p mean: 0.44266650080680847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027453189715743065, decouple_loss:0.0013261331478133798
The modified gen p mean: 0.44258010387420654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027723917737603188, decouple_loss:0.001299439580179751
Iteration: 2510, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4440690577030182, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02796592190861702, decouple_loss:0.0013505270471796393
The modified gen p mean: 0.4416722357273102, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027149276807904243, decouple_loss:0.0014483288396149874
The modified gen p mean: 0.4425448179244995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02669086493551731, decouple_loss:0.0012584204087033868
2023-05-26 21:23:10 testing...
The modified gen p mean: 0.4487178325653076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032429151237010956, decouple_loss:0.0015880962600931525
The modified gen p mean: 0.44674673676490784, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44859039783477783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03282904624938965, decouple_loss:0.001442456035874784
loss_pred:0.034220267087221146, decouple_loss:0.001609145780093968
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03323681652545929, avg_mse: 0.04535454139113426
current test mse: 0.045355
Iteration: 2511, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44885990023612976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02594456821680069, decouple_loss:0.0015086180064827204
The modified gen p mean: 0.4438503086566925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02557631954550743, decouple_loss:0.0015445121098309755
The modified gen p mean: 0.4426446557044983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026588039472699165, decouple_loss:0.0013842148473486304
Iteration: 2512, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44487395882606506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612960711121559, decouple_loss:0.0013684279983863235
The modified gen p mean: 0.44390591979026794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02669353224337101, decouple_loss:0.001379185589030385
The modified gen p mean: 0.4423801898956299, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026313891634345055, decouple_loss:0.001371009275317192
Iteration: 2513, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454144239425659, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026490652933716774, decouple_loss:0.0013618830125778913
The modified gen p mean: 0.44434136152267456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025929100811481476, decouple_loss:0.0015915404073894024
The modified gen p mean: 0.44579052925109863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026237251237034798, decouple_loss:0.001510353060439229
Iteration: 2514, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44817978143692017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025595471262931824, decouple_loss:0.001658715889789164
The modified gen p mean: 0.44604846835136414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026670770719647408, decouple_loss:0.0014929147437214851
The modified gen p mean: 0.44440191984176636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02702009491622448, decouple_loss:0.0014720138860866427
Iteration: 2515, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481140375137329, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025630097836256027, decouple_loss:0.0014511968474835157
The modified gen p mean: 0.4480273723602295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02625705674290657, decouple_loss:0.0013843021588400006
The modified gen p mean: 0.44624027609825134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027867836877703667, decouple_loss:0.0013765499461442232
Iteration: 2516, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45085227489471436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02577693574130535, decouple_loss:0.0014159784186631441
The modified gen p mean: 0.44591420888900757, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02667517587542534, decouple_loss:0.0013428244274109602
The modified gen p mean: 0.4495478868484497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02616180293262005, decouple_loss:0.0013460502959787846
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr.npz
NaN value num: 0
Iteration: 2517, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44694000482559204, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488902688026428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02774994820356369, decouple_loss:0.0013893157010897994
loss_pred:0.02651149034500122, decouple_loss:0.001439766027033329
The modified gen p mean: 0.4501707851886749, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026664750650525093, decouple_loss:0.0014704354107379913
Iteration: 2518, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44739830493927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027798693627119064, decouple_loss:0.0014823784586042166
The modified gen p mean: 0.4474501609802246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027782097458839417, decouple_loss:0.0014448714209720492
The modified gen p mean: 0.4519110918045044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026038706302642822, decouple_loss:0.001394259394146502
Iteration: 2519, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461139738559723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027164749801158905, decouple_loss:0.0014874833868816495
The modified gen p mean: 0.4490988254547119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027056550607085228, decouple_loss:0.0015380213735625148
The modified gen p mean: 0.4478225111961365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02724524773657322, decouple_loss:0.0014058102387934923
Iteration: 2520, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465596675872803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027401620522141457, decouple_loss:0.0013784316834062338
The modified gen p mean: 0.44856739044189453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026439111679792404, decouple_loss:0.001388215459883213
The modified gen p mean: 0.45285680890083313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025448942556977272, decouple_loss:0.0013816823484376073
2023-05-26 21:27:58 testing...
The modified gen p mean: 0.45245933532714844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03233153000473976, decouple_loss:0.001582279452122748
The modified gen p mean: 0.45046576857566833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03278334438800812, decouple_loss:0.001413065823726356
The modified gen p mean: 0.45239946246147156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03411877155303955, decouple_loss:0.0016414809506386518
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0331551656126976, avg_mse: 0.045176081359386444
current test mse: 0.045176
Iteration: 2521, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44680845737457275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02808256447315216, decouple_loss:0.0013393353438004851
The modified gen p mean: 0.449278324842453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02723585069179535, decouple_loss:0.0013655532384291291
The modified gen p mean: 0.4495733976364136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02658744342625141, decouple_loss:0.0013946917606517673
Iteration: 2522, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44741272926330566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783220261335373, decouple_loss:0.0014168116031214595
The modified gen p mean: 0.4483502209186554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026733988896012306, decouple_loss:0.001323342090472579
The modified gen p mean: 0.4492114782333374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02707521989941597, decouple_loss:0.0015482219168916345
Iteration: 2523, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483973979949951, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02663353830575943, decouple_loss:0.0013992763124406338
The modified gen p mean: 0.44725126028060913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02706737071275711, decouple_loss:0.0016406882787123322
The modified gen p mean: 0.44838622212409973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026581184938549995, decouple_loss:0.0015416252426803112
Iteration: 2524, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452499747276306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027503004297614098, decouple_loss:0.001433670986443758
The modified gen p mean: 0.44642412662506104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02728285826742649, decouple_loss:0.0016792725073173642
The modified gen p mean: 0.44584476947784424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027463778853416443, decouple_loss:0.001437261700630188
Iteration: 2525, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44838133454322815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02639654651284218, decouple_loss:0.00130584801081568
The modified gen p mean: 0.446675568819046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027390485629439354, decouple_loss:0.0012982810148969293
The modified gen p mean: 0.44653019309043884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027089308947324753, decouple_loss:0.0012695667101070285
Iteration: 2526, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4524224102497101, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026581136509776115, decouple_loss:0.0014064671704545617
The modified gen p mean: 0.45032384991645813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026942269876599312, decouple_loss:0.0014916440704837441
The modified gen p mean: 0.45306965708732605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02489788644015789, decouple_loss:0.0013367228675633669
Iteration: 2527, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45105645060539246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026278672739863396, decouple_loss:0.0013479467015713453
The modified gen p mean: 0.4491732716560364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024655163288116455, decouple_loss:0.0013411414111033082
The modified gen p mean: 0.4511066675186157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025744903832674026, decouple_loss:0.00128821877297014
Iteration: 2528, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44945117831230164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025565294548869133, decouple_loss:0.001513262977823615
The modified gen p mean: 0.4543486535549164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025365173816680908, decouple_loss:0.001410566852428019
The modified gen p mean: 0.45294830203056335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025772880762815475, decouple_loss:0.0014017486246302724
Iteration: 2529, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44936272501945496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027903912588953972, decouple_loss:0.0012758513912558556
The modified gen p mean: 0.4470929205417633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028021976351737976, decouple_loss:0.001406072173267603
The modified gen p mean: 0.4504372179508209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026949068531394005, decouple_loss:0.0014071572804823518
Iteration: 2530, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491422474384308, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02707207016646862, decouple_loss:0.0014230030355975032
The modified gen p mean: 0.45102378726005554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026349026709794998, decouple_loss:0.0013632039772346616
The modified gen p mean: 0.447906494140625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024818597361445427, decouple_loss:0.0013285315362736583
2023-05-26 21:32:06 testing...
The modified gen p mean: 0.4538993239402771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03233172744512558, decouple_loss:0.0014924826100468636
The modified gen p mean: 0.45186561346054077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03288741037249565, decouple_loss:0.0013601136161014438
The modified gen p mean: 0.4538748562335968, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03408009558916092, decouple_loss:0.001553406473249197
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033173177391290665, avg_mse: 0.04522239789366722
current test mse: 0.045222
Iteration: 2531, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481092691421509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02729295939207077, decouple_loss:0.0014258186565712094
The modified gen p mean: 0.44996073842048645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025453723967075348, decouple_loss:0.0013572595780715346
The modified gen p mean: 0.44835638999938965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024804135784506798, decouple_loss:0.0013967318227514625
Iteration: 2532, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515475332736969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027279376983642578, decouple_loss:0.001428704708814621
The modified gen p mean: 0.44750306010246277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02760845236480236, decouple_loss:0.0015420268755406141
The modified gen p mean: 0.4484400451183319, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02726483717560768, decouple_loss:0.0013661534758284688
Iteration: 2533, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491276443004608, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026319462805986404, decouple_loss:0.0015212675789371133
The modified gen p mean: 0.4523044228553772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02669508196413517, decouple_loss:0.001312446198426187
The modified gen p mean: 0.45100587606430054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026264529675245285, decouple_loss:0.001407019910402596
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2534, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4511772692203522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02765802852809429, decouple_loss:0.001386950141750276
The modified gen p mean: 0.4494417905807495, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44697320461273193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02833336964249611, decouple_loss:0.0012142169289290905
loss_pred:0.028078967705368996, decouple_loss:0.0013912052381783724
Iteration: 2535, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502817392349243, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02889298088848591, decouple_loss:0.001485585467889905
The modified gen p mean: 0.45069724321365356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027700472623109818, decouple_loss:0.0014863815158605576
The modified gen p mean: 0.4505847096443176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027727816253900528, decouple_loss:0.0014084127033129334
Iteration: 2536, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45117416977882385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026574615389108658, decouple_loss:0.0014940720284357667
The modified gen p mean: 0.44980281591415405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029545972123742104, decouple_loss:0.0014510767068713903
The modified gen p mean: 0.4473731517791748, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02968493662774563, decouple_loss:0.0015128380618989468
Iteration: 2537, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44596895575523376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029780669137835503, decouple_loss:0.0014483541017398238
The modified gen p mean: 0.44952309131622314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0289295744150877, decouple_loss:0.0013363902689889073
The modified gen p mean: 0.4506400227546692, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027610503137111664, decouple_loss:0.0014978855615481734
Iteration: 2538, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477883577346802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02865607477724552, decouple_loss:0.0013288665795698762
The modified gen p mean: 0.4452768862247467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02778260037302971, decouple_loss:0.001371775520965457
The modified gen p mean: 0.44933852553367615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028616003692150116, decouple_loss:0.0014288409147411585
Iteration: 2539, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445109099149704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027143649756908417, decouple_loss:0.0013906123349443078
The modified gen p mean: 0.4456947147846222, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027709636837244034, decouple_loss:0.0014459408121183515
The modified gen p mean: 0.44486480951309204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028897464275360107, decouple_loss:0.0014916773652657866
Iteration: 2540, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44576022028923035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026358896866440773, decouple_loss:0.001535501447506249
The modified gen p mean: 0.44291216135025024, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0288127101957798, decouple_loss:0.0013670267071574926
The modified gen p mean: 0.4448672831058502, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029027501121163368, decouple_loss:0.0014656145358458161
2023-05-26 21:36:55 testing...
The modified gen p mean: 0.4475165605545044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03243984654545784, decouple_loss:0.0016911725979298353
The modified gen p mean: 0.4473719596862793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03407379984855652, decouple_loss:0.0016552592860534787
The modified gen p mean: 0.4453853964805603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03289257735013962, decouple_loss:0.0015170114347711205
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03321646898984909, avg_mse: 0.0452117994427681
current test mse: 0.045212
Iteration: 2541, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449898898601532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027774697169661522, decouple_loss:0.0015420566778630018
The modified gen p mean: 0.4410989284515381, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029636386781930923, decouple_loss:0.0014716656878590584
The modified gen p mean: 0.4423028826713562, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028623314574360847, decouple_loss:0.0014849212020635605
Iteration: 2542, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44530189037323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02770323120057583, decouple_loss:0.0015358974924311042
The modified gen p mean: 0.44941002130508423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028983861207962036, decouple_loss:0.0016257388051599264
The modified gen p mean: 0.443371057510376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028080066666007042, decouple_loss:0.0013528864365071058
Iteration: 2543, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444168508052826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029702933505177498, decouple_loss:0.0013922955840826035
The modified gen p mean: 0.4492621123790741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027797821909189224, decouple_loss:0.0017222701571881771
The modified gen p mean: 0.4455012381076813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027302782982587814, decouple_loss:0.0014894737396389246
Iteration: 2544, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44826316833496094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027623791247606277, decouple_loss:0.0014208685606718063
The modified gen p mean: 0.44451531767845154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028357023373246193, decouple_loss:0.0015721006784588099
The modified gen p mean: 0.4483599066734314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027089402079582214, decouple_loss:0.0015824867878109217
Iteration: 2545, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488333463668823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028683820739388466, decouple_loss:0.0015072827227413654
The modified gen p mean: 0.4455357491970062, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02847941778600216, decouple_loss:0.0015513802645727992
The modified gen p mean: 0.44835203886032104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027475811541080475, decouple_loss:0.0017326798988506198
Iteration: 2546, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449062645435333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028777141124010086, decouple_loss:0.0017358548939228058
The modified gen p mean: 0.44529032707214355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02766317129135132, decouple_loss:0.0013527784030884504
The modified gen p mean: 0.44829508662223816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02764635719358921, decouple_loss:0.0017427464481443167
Iteration: 2547, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482548236846924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026959337294101715, decouple_loss:0.001424061949364841
The modified gen p mean: 0.44806501269340515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02931213565170765, decouple_loss:0.0015275770565494895
The modified gen p mean: 0.44349557161331177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027889514341950417, decouple_loss:0.0013273076619952917
Iteration: 2548, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44824254512786865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02730249986052513, decouple_loss:0.0016402798937633634
The modified gen p mean: 0.449131041765213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026967031881213188, decouple_loss:0.0016142547829076648
The modified gen p mean: 0.44579699635505676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027195438742637634, decouple_loss:0.0014176670229062438
Iteration: 2549, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4437054395675659, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02753284014761448, decouple_loss:0.0014745615189895034
The modified gen p mean: 0.44921961426734924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028476005420088768, decouple_loss:0.0016889834078028798
The modified gen p mean: 0.44384121894836426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029394272714853287, decouple_loss:0.0015466166660189629
Iteration: 2550, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500840902328491, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4500051438808441, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02769663743674755, decouple_loss:0.0015502495225518942
loss_pred:0.02678019553422928, decouple_loss:0.0017894351622089744
The modified gen p mean: 0.44914576411247253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026663104072213173, decouple_loss:0.0016514898743480444
2023-05-26 21:40:59 testing...
The modified gen p mean: 0.45221254229545593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03289546072483063, decouple_loss:0.00159668258856982
The modified gen p mean: 0.4521109461784363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03450963646173477, decouple_loss:0.0017293435521423817
The modified gen p mean: 0.45020362734794617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03327236324548721, decouple_loss:0.0015609348192811012
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033640604466199875, avg_mse: 0.04582605138421059
current test mse: 0.045826
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr.npz
NaN value num: 0
Iteration: 2551, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497939646244049, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02639557421207428, decouple_loss:0.0015385487349703908
The modified gen p mean: 0.449066698551178, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44510921835899353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027563290670514107, decouple_loss:0.0013809805968776345
loss_pred:0.0267596784979105, decouple_loss:0.0014868640573695302
Iteration: 2552, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461439847946167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028407853096723557, decouple_loss:0.0014357795007526875
The modified gen p mean: 0.449624627828598, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027538945898413658, decouple_loss:0.0014973597135394812
The modified gen p mean: 0.44625577330589294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026490502059459686, decouple_loss:0.0015023057349026203
Iteration: 2553, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457158148288727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028789060190320015, decouple_loss:0.0015047038905322552
The modified gen p mean: 0.44526609778404236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02570156194269657, decouple_loss:0.0013840371975675225
The modified gen p mean: 0.44896015524864197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026512790471315384, decouple_loss:0.0014489265158772469
Iteration: 2554, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504251778125763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026323797181248665, decouple_loss:0.0014027920551598072
The modified gen p mean: 0.444441556930542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028394876047968864, decouple_loss:0.001626530080102384
The modified gen p mean: 0.44511714577674866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028944626450538635, decouple_loss:0.0014575617387890816
Iteration: 2555, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44982242584228516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024807222187519073, decouple_loss:0.0013781132875010371
The modified gen p mean: 0.45070067048072815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02692304737865925, decouple_loss:0.0014286463847383857
The modified gen p mean: 0.4478091895580292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026566429063677788, decouple_loss:0.0015050703659653664
Iteration: 2556, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514639973640442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02597035840153694, decouple_loss:0.001577516901306808
The modified gen p mean: 0.4478331208229065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02772582694888115, decouple_loss:0.001376889180392027
The modified gen p mean: 0.4511702060699463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02641373872756958, decouple_loss:0.0014603411545976996
Iteration: 2557, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45278531312942505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025057794526219368, decouple_loss:0.0016576002817600965
The modified gen p mean: 0.44857057929039, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02591650001704693, decouple_loss:0.0014635309344157577
The modified gen p mean: 0.4532886743545532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025835612788796425, decouple_loss:0.0014979774132370949
Iteration: 2558, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490637481212616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025499118492007256, decouple_loss:0.0014060793910175562
The modified gen p mean: 0.449984073638916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026196841150522232, decouple_loss:0.0014009848237037659
The modified gen p mean: 0.44828808307647705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02685151994228363, decouple_loss:0.0014142512809485197
Iteration: 2559, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472695291042328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026285873726010323, decouple_loss:0.00143341813236475
The modified gen p mean: 0.4474184215068817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02734907530248165, decouple_loss:0.001356255728751421
The modified gen p mean: 0.4486965239048004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02669692412018776, decouple_loss:0.0013750542420893908
Iteration: 2560, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45088106393814087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027310963720083237, decouple_loss:0.0014127381145954132
The modified gen p mean: 0.4473707377910614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026839202269911766, decouple_loss:0.0013176043285056949
The modified gen p mean: 0.44815829396247864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025887247174978256, decouple_loss:0.0014675880083814263
2023-05-26 21:45:45 testing...
The modified gen p mean: 0.4515485167503357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03241708502173424, decouple_loss:0.001671305624768138
The modified gen p mean: 0.44975772500038147, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45136409997940063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03274703770875931, decouple_loss:0.0016457757446914911
loss_pred:0.033992085605859756, decouple_loss:0.0017155903624370694
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033135946840047836, avg_mse: 0.045063652098178864
current test mse: 0.045064
Iteration: 2561, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44492846727371216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025583356618881226, decouple_loss:0.0013655482325702906
The modified gen p mean: 0.44529059529304504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024816665798425674, decouple_loss:0.0012973606353625655
The modified gen p mean: 0.447925865650177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02749682404100895, decouple_loss:0.001458997605368495
Iteration: 2562, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455614984035492, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026974350214004517, decouple_loss:0.0012987501686438918
The modified gen p mean: 0.4445558190345764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690538577735424, decouple_loss:0.0013581073144450784
The modified gen p mean: 0.4442099332809448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026965001598000526, decouple_loss:0.001485028536990285
Iteration: 2563, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463338255882263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02651078626513481, decouple_loss:0.0014515900984406471
The modified gen p mean: 0.4479258358478546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027611205354332924, decouple_loss:0.0013811028329655528
The modified gen p mean: 0.4461989104747772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026955513283610344, decouple_loss:0.0013835070421919227
Iteration: 2564, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447844326496124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027588998898863792, decouple_loss:0.0015046759508550167
The modified gen p mean: 0.44708865880966187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027706775814294815, decouple_loss:0.001359203364700079
The modified gen p mean: 0.4457540512084961, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0274673942476511, decouple_loss:0.0013000085018575191
Iteration: 2565, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44593822956085205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02670230343937874, decouple_loss:0.001277591334655881
The modified gen p mean: 0.44779035449028015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02553410269320011, decouple_loss:0.001489574438892305
The modified gen p mean: 0.44552382826805115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02592979557812214, decouple_loss:0.0012466706102713943
Iteration: 2566, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475706219673157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02537386678159237, decouple_loss:0.0014862740645185113
The modified gen p mean: 0.44633352756500244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027014009654521942, decouple_loss:0.0013665830483660102
The modified gen p mean: 0.44971343874931335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02710467204451561, decouple_loss:0.0014578388072550297
Iteration: 2567, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44675102829933167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02616427093744278, decouple_loss:0.0013510596472769976
The modified gen p mean: 0.4460800588130951, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027756918221712112, decouple_loss:0.0013791455421596766
The modified gen p mean: 0.44622623920440674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028021838515996933, decouple_loss:0.0015656460309401155
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2568, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4528653025627136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027285611256957054, decouple_loss:0.0013609254965558648
The modified gen p mean: 0.4479150176048279, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4521717429161072, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025956960394978523, decouple_loss:0.0014002639800310135
loss_pred:0.027203259989619255, decouple_loss:0.001350844162516296
Iteration: 2569, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4532541036605835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028167832642793655, decouple_loss:0.0016900914488360286
The modified gen p mean: 0.4457593858242035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028580648824572563, decouple_loss:0.0013461781200021505
The modified gen p mean: 0.44851335883140564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029163634404540062, decouple_loss:0.001398904132656753
Iteration: 2570, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489760100841522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027806077152490616, decouple_loss:0.0014045191928744316
The modified gen p mean: 0.45091187953948975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02913028560578823, decouple_loss:0.0013565697008743882
The modified gen p mean: 0.4479675889015198, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028562143445014954, decouple_loss:0.0013274679658934474
2023-05-26 21:50:36 testing...
The modified gen p mean: 0.45540666580200195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03242705389857292, decouple_loss:0.0015185539377853274
The modified gen p mean: 0.4534112513065338, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0326472632586956, decouple_loss:0.0014366928953677416
The modified gen p mean: 0.4552313983440399, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033975809812545776, decouple_loss:0.0015800578985363245
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03309229761362076, avg_mse: 0.04507988318800926
current test mse: 0.04508
Iteration: 2571, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45282694697380066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02712170034646988, decouple_loss:0.0013179773231968284
The modified gen p mean: 0.4537021517753601, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02670852653682232, decouple_loss:0.001289881533011794
The modified gen p mean: 0.4523017108440399, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026133207604289055, decouple_loss:0.0014812062727287412
Iteration: 2572, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45132607221603394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027796654030680656, decouple_loss:0.0013490712735801935
The modified gen p mean: 0.4506440758705139, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02645941451191902, decouple_loss:0.001440267893485725
The modified gen p mean: 0.45207640528678894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026583457365632057, decouple_loss:0.0014879981754347682
Iteration: 2573, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44863930344581604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028718408197164536, decouple_loss:0.0014747657114639878
The modified gen p mean: 0.44898521900177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027293233200907707, decouple_loss:0.001355580985546112
The modified gen p mean: 0.4521605372428894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02711954340338707, decouple_loss:0.00137180439196527
Iteration: 2574, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44850659370422363, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4486311674118042, gen p mean: 0.0, mean p set: 0.448loss_pred:0.027599461376667023, decouple_loss:0.0013972609303891659
loss_pred:0.027321601286530495, decouple_loss:0.0014487613225355744
The modified gen p mean: 0.4476742744445801, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02807622030377388, decouple_loss:0.0012233484303578734
Iteration: 2575, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44758155941963196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02754058502614498, decouple_loss:0.0013186977012082934
The modified gen p mean: 0.4438370168209076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027856914326548576, decouple_loss:0.0013477536849677563
The modified gen p mean: 0.4500334560871124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026357492431998253, decouple_loss:0.0014124939916655421
Iteration: 2576, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494912922382355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026284048333764076, decouple_loss:0.0015478054992854595
The modified gen p mean: 0.44465944170951843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02756868302822113, decouple_loss:0.0013174823252484202
The modified gen p mean: 0.4461129307746887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028490817174315453, decouple_loss:0.001304561155848205
Iteration: 2577, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4431798756122589, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027092093601822853, decouple_loss:0.0013621601974591613
The modified gen p mean: 0.44399651885032654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027308642864227295, decouple_loss:0.0013743366580456495
The modified gen p mean: 0.445131778717041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029018940404057503, decouple_loss:0.0013534254394471645
Iteration: 2578, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44731613993644714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025807905942201614, decouple_loss:0.001556458999402821
The modified gen p mean: 0.44832855463027954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026090968400239944, decouple_loss:0.0013871919363737106
The modified gen p mean: 0.44349920749664307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02802378311753273, decouple_loss:0.0013727945042774081
Iteration: 2579, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44638845324516296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0264243446290493, decouple_loss:0.001539405551739037
The modified gen p mean: 0.4446844160556793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027450591325759888, decouple_loss:0.001422300934791565
The modified gen p mean: 0.44601815938949585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025162657722830772, decouple_loss:0.0014193553943186998
Iteration: 2580, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442547559738159, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027662144973874092, decouple_loss:0.0012550493702292442
The modified gen p mean: 0.44868162274360657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02588685229420662, decouple_loss:0.0015944571932777762
The modified gen p mean: 0.4459778964519501, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028347251936793327, decouple_loss:0.00142792914994061
2023-05-26 21:54:43 testing...
The modified gen p mean: 0.4525213837623596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03266337141394615, decouple_loss:0.00155344745144248
The modified gen p mean: 0.45220333337783813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03426312655210495, decouple_loss:0.00168758409563452
The modified gen p mean: 0.45019951462745667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03308958560228348, decouple_loss:0.001519292825832963
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03341803699731827, avg_mse: 0.045526374131441116
current test mse: 0.045526
Iteration: 2581, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.443701833486557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028654025867581367, decouple_loss:0.0013843452325090766
The modified gen p mean: 0.45151209831237793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026607943698763847, decouple_loss:0.0014454437186941504
The modified gen p mean: 0.44611337780952454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027856845408678055, decouple_loss:0.001443991786800325
Iteration: 2582, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44813600182533264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025938354432582855, decouple_loss:0.0013673295034095645
The modified gen p mean: 0.44869256019592285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025667859241366386, decouple_loss:0.0013858655001968145
The modified gen p mean: 0.4500836133956909, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027073504403233528, decouple_loss:0.0015358234522864223
Iteration: 2583, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456510543823242, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027664393186569214, decouple_loss:0.0013531261356547475
The modified gen p mean: 0.4491903781890869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02704993076622486, decouple_loss:0.0014813848538324237
The modified gen p mean: 0.4476671814918518, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027606697753071785, decouple_loss:0.0015930549707263708
Iteration: 2584, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44958221912384033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02685883268713951, decouple_loss:0.0014477547956630588
The modified gen p mean: 0.4487512707710266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02692645601928234, decouple_loss:0.001655685598962009
The modified gen p mean: 0.4454452395439148, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028214985504746437, decouple_loss:0.0014928722521290183
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2585, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458157420158386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03182568773627281, decouple_loss:0.0014229074586182833
The modified gen p mean: 0.45015984773635864, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4487040638923645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03108719177544117, decouple_loss:0.0014112817589193583
loss_pred:0.030886460095643997, decouple_loss:0.0014879703521728516
Iteration: 2586, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501698315143585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031881969422101974, decouple_loss:0.0013413061387836933
The modified gen p mean: 0.447704941034317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03086337447166443, decouple_loss:0.0014859227230772376
The modified gen p mean: 0.4488373398780823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032455358654260635, decouple_loss:0.0015056580305099487
Iteration: 2587, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489882290363312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03217855095863342, decouple_loss:0.0014566124882549047
The modified gen p mean: 0.4500451683998108, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261552006006241, decouple_loss:0.0014852035092189908
The modified gen p mean: 0.4481848180294037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03292082995176315, decouple_loss:0.001487101661041379
Iteration: 2588, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489282965660095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03147303685545921, decouple_loss:0.001491253380663693
The modified gen p mean: 0.44958949089050293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03097972832620144, decouple_loss:0.0013949291314929724
The modified gen p mean: 0.45286327600479126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031249171122908592, decouple_loss:0.0013537677004933357
Iteration: 2589, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45188286900520325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030358951538801193, decouple_loss:0.0014999078121036291
The modified gen p mean: 0.4478730857372284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03093631938099861, decouple_loss:0.0012543435441330075
The modified gen p mean: 0.4535313546657562, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029135530814528465, decouple_loss:0.0014285658253356814
Iteration: 2590, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44797056913375854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03209752216935158, decouple_loss:0.0013674712972715497
The modified gen p mean: 0.4494877755641937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0310917217284441, decouple_loss:0.001352973747998476
The modified gen p mean: 0.4506407082080841, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030749903991818428, decouple_loss:0.0015920809237286448
2023-05-26 21:59:32 testing...
The modified gen p mean: 0.45174214243888855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032352935522794724, decouple_loss:0.0015749887097626925
The modified gen p mean: 0.44961369037628174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03274717926979065, decouple_loss:0.0014716109726577997
The modified gen p mean: 0.45123377442359924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033980175852775574, decouple_loss:0.0015874853124842048
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033104002475738525, avg_mse: 0.04484310746192932
current test mse: 0.044843
Iteration: 2591, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485306441783905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03178708627820015, decouple_loss:0.0013709329068660736
The modified gen p mean: 0.4491812586784363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031161727383732796, decouple_loss:0.0015983496559783816
The modified gen p mean: 0.4490372836589813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029910383746027946, decouple_loss:0.0016303089214488864
Iteration: 2592, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445469468832016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03009624592959881, decouple_loss:0.0013867815723642707
The modified gen p mean: 0.4482657015323639, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03146502003073692, decouple_loss:0.0014802062651142478
The modified gen p mean: 0.4462924599647522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0329926460981369, decouple_loss:0.0013715132372453809
Iteration: 2593, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463544487953186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03082352504134178, decouple_loss:0.0014259620802477002
The modified gen p mean: 0.45057275891304016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030446257442235947, decouple_loss:0.0015077543212100863
The modified gen p mean: 0.4470192790031433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03089740127325058, decouple_loss:0.001521159429103136
Iteration: 2594, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449105829000473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03130563721060753, decouple_loss:0.0013171405298635364
The modified gen p mean: 0.4468518793582916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03041311539709568, decouple_loss:0.0014655510894954205
The modified gen p mean: 0.4485373795032501, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030874595046043396, decouple_loss:0.0014638466527685523
Iteration: 2595, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44956493377685547, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4462517201900482, gen p mean: 0.0, mean p set: 0.448loss_pred:0.03022003173828125, decouple_loss:0.0014536540256813169
loss_pred:0.03299320116639137, decouple_loss:0.0014339422341436148
The modified gen p mean: 0.448696494102478, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02913057990372181, decouple_loss:0.0013874132419005036
Iteration: 2596, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486464858055115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03233194723725319, decouple_loss:0.0014727364759892225
The modified gen p mean: 0.4466969668865204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03096546046435833, decouple_loss:0.0014781589852645993
The modified gen p mean: 0.447013258934021, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030503636226058006, decouple_loss:0.0014786305837333202
Iteration: 2597, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492409825325012, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030027450993657112, decouple_loss:0.0014442012179642916
The modified gen p mean: 0.4472324252128601, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032533109188079834, decouple_loss:0.0012815719237551093
The modified gen p mean: 0.44935712218284607, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03117379918694496, decouple_loss:0.0012461012229323387
Iteration: 2598, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480520486831665, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4495219886302948, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030544308945536613, decouple_loss:0.0015160143375396729
loss_pred:0.032331936061382294, decouple_loss:0.0013375882990658283
The modified gen p mean: 0.4481354355812073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030712934210896492, decouple_loss:0.0013209307799115777
Iteration: 2599, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487634599208832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03133348748087883, decouple_loss:0.0012894236715510488
The modified gen p mean: 0.451760858297348, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029230844229459763, decouple_loss:0.00143674504943192
The modified gen p mean: 0.44802194833755493, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031610336154699326, decouple_loss:0.0013626101426780224
Iteration: 2600, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45133501291275024, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03018796257674694, decouple_loss:0.0013475288869813085
The modified gen p mean: 0.450029581785202, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03227797895669937, decouple_loss:0.0014388925628736615
The modified gen p mean: 0.44849905371665955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030847588554024696, decouple_loss:0.001386080402880907
2023-05-26 22:03:40 testing...
The modified gen p mean: 0.45349228382110596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03232112526893616, decouple_loss:0.0015370401088148355
The modified gen p mean: 0.4531056582927704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033903010189533234, decouple_loss:0.0015576244331896305
The modified gen p mean: 0.4513394236564636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032724980264902115, decouple_loss:0.001576351816765964
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033060889691114426, avg_mse: 0.044834692031145096
current test mse: 0.044835
Iteration: 2601, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448976069688797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03128950670361519, decouple_loss:0.0014035130152478814
The modified gen p mean: 0.4530858099460602, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031098030507564545, decouple_loss:0.001504214247688651
The modified gen p mean: 0.44818320870399475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031955037266016006, decouple_loss:0.0014422598760575056
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr.npz
NaN value num: 0
Iteration: 2602, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516158998012543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030822403728961945, decouple_loss:0.001518861623480916
The modified gen p mean: 0.45211461186408997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03138669580221176, decouple_loss:0.0013384748017415404
The modified gen p mean: 0.4477790892124176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03319298475980759, decouple_loss:0.00159722869284451
Iteration: 2603, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44849488139152527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032409437000751495, decouple_loss:0.0016082535730674863
The modified gen p mean: 0.44929054379463196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032235924154520035, decouple_loss:0.0014227112988010049
The modified gen p mean: 0.4486619234085083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03172938898205757, decouple_loss:0.0015408515464514494
Iteration: 2604, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451722651720047, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4512556791305542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031992726027965546, decouple_loss:0.0014619416324421763loss_pred:0.029999693855643272, decouple_loss:0.0013951670844107866
The modified gen p mean: 0.4479195177555084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03327047824859619, decouple_loss:0.0014469032175838947
Iteration: 2605, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45295649766921997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033218469470739365, decouple_loss:0.0013442669296637177
The modified gen p mean: 0.4516339898109436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0328747034072876, decouple_loss:0.0013959528878331184
The modified gen p mean: 0.45311239361763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0336335226893425, decouple_loss:0.001568392151966691
Iteration: 2606, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45350924134254456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0321492962539196, decouple_loss:0.0013755395775660872
The modified gen p mean: 0.4518260359764099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03338530659675598, decouple_loss:0.0013411513064056635
The modified gen p mean: 0.45664089918136597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029692187905311584, decouple_loss:0.001477845129556954
Iteration: 2607, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45356136560440063, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45158928632736206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031116735190153122, decouple_loss:0.0014177182456478477
loss_pred:0.030117535963654518, decouple_loss:0.0013767117634415627
The modified gen p mean: 0.4534456133842468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03205249458551407, decouple_loss:0.0014644457260146737
Iteration: 2608, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451796293258667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031062372028827667, decouple_loss:0.0014430228620767593
The modified gen p mean: 0.45337435603141785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030608737841248512, decouple_loss:0.0016700711566954851
The modified gen p mean: 0.45193392038345337, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031119173392653465, decouple_loss:0.0014300707262009382
Iteration: 2609, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482729136943817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032434653490781784, decouple_loss:0.0013762819580733776
The modified gen p mean: 0.44756266474723816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0318734236061573, decouple_loss:0.0012786365114152431
The modified gen p mean: 0.44981858134269714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03178874030709267, decouple_loss:0.0015084340702742338
Iteration: 2610, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45086362957954407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031972505152225494, decouple_loss:0.0013783251633867621
The modified gen p mean: 0.4488750696182251, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02994750253856182, decouple_loss:0.0014261197065934539
The modified gen p mean: 0.44545894861221313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031416866928339005, decouple_loss:0.0013731096405535936
2023-05-26 22:08:29 testing...
The modified gen p mean: 0.44928082823753357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03188646212220192, decouple_loss:0.0015327626606449485
The modified gen p mean: 0.4472816586494446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03234819695353508, decouple_loss:0.0014119636034592986
The modified gen p mean: 0.4490536153316498, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03365403413772583, decouple_loss:0.001596828573383391
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03270525857806206, avg_mse: 0.04419197887182236
current test mse: 0.044192
Iteration: 2611, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44607844948768616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030437681823968887, decouple_loss:0.0013598630903288722
The modified gen p mean: 0.44865503907203674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029872413724660873, decouple_loss:0.0013675016816705465
The modified gen p mean: 0.44548994302749634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03191521018743515, decouple_loss:0.0013831001706421375
Iteration: 2612, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479407072067261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03219706937670708, decouple_loss:0.001381829148158431
The modified gen p mean: 0.44271260499954224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031178602948784828, decouple_loss:0.0015271034790202975
The modified gen p mean: 0.4431465268135071, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032587096095085144, decouple_loss:0.0014913290506228805
Iteration: 2613, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44371333718299866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031898487359285355, decouple_loss:0.0013194349594414234
The modified gen p mean: 0.44608429074287415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029206939041614532, decouple_loss:0.0013893817085772753
The modified gen p mean: 0.44735997915267944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030493246391415596, decouple_loss:0.0013608332956209779
Iteration: 2614, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443291425704956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031476523727178574, decouple_loss:0.0011937846429646015
The modified gen p mean: 0.4478721022605896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032078154385089874, decouple_loss:0.0012596354354172945
The modified gen p mean: 0.44506514072418213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030615080147981644, decouple_loss:0.0013962981756776571
Iteration: 2615, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44594284892082214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03347216919064522, decouple_loss:0.0014684980269521475
The modified gen p mean: 0.44957804679870605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03191305324435234, decouple_loss:0.001321677933447063
The modified gen p mean: 0.445625901222229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03307995945215225, decouple_loss:0.001411415752954781
Iteration: 2616, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44918668270111084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03093569353222847, decouple_loss:0.0012707074638456106
The modified gen p mean: 0.4506058394908905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029346995055675507, decouple_loss:0.0012815274531021714
The modified gen p mean: 0.45175841450691223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03167668730020523, decouple_loss:0.0013294876553118229
Iteration: 2617, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44802796840667725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03218361362814903, decouple_loss:0.0012608892284333706
The modified gen p mean: 0.45092734694480896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03067944198846817, decouple_loss:0.0012586918892338872
The modified gen p mean: 0.4542236030101776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030983369797468185, decouple_loss:0.0014816565671935678
Iteration: 2618, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45140784978866577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03346772864460945, decouple_loss:0.0012924914481118321
The modified gen p mean: 0.4483078718185425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030897745862603188, decouple_loss:0.0012412532232701778
The modified gen p mean: 0.4482470154762268, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030917158350348473, decouple_loss:0.0013124945107847452
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2619, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45041123032569885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030636940151453018, decouple_loss:0.0013408161466941237
The modified gen p mean: 0.45226338505744934, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44885340332984924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02970179356634617, decouple_loss:0.0013218187959864736
loss_pred:0.028484072536230087, decouple_loss:0.0012917902786284685
Iteration: 2620, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44930949807167053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029609382152557373, decouple_loss:0.0013652327470481396
The modified gen p mean: 0.44721609354019165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029671937227249146, decouple_loss:0.0012972928816452622
The modified gen p mean: 0.44809895753860474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02905041165649891, decouple_loss:0.001302306423895061
2023-05-26 22:13:15 testing...
The modified gen p mean: 0.44855281710624695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03191061690449715, decouple_loss:0.0014560682466253638
The modified gen p mean: 0.44636523723602295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03220349922776222, decouple_loss:0.0013575752964243293
The modified gen p mean: 0.4484245777130127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03358018770813942, decouple_loss:0.0014732856070622802
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03263621777296066, avg_mse: 0.044147539883852005
current test mse: 0.044148
Iteration: 2621, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44552159309387207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029538873583078384, decouple_loss:0.0014105758164077997
The modified gen p mean: 0.44923266768455505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02887374348938465, decouple_loss:0.0014909169403836131
The modified gen p mean: 0.4435521364212036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028715645894408226, decouple_loss:0.0011765332892537117
Iteration: 2622, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44461020827293396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028782475739717484, decouple_loss:0.0013567699352279305
The modified gen p mean: 0.44235914945602417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029709067195653915, decouple_loss:0.0012714900076389313
The modified gen p mean: 0.44035178422927856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028312591835856438, decouple_loss:0.0012844480806961656
Iteration: 2623, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44346511363983154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02715132012963295, decouple_loss:0.0014519997639581561
The modified gen p mean: 0.43982189893722534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029524896293878555, decouple_loss:0.0012346695875748992
The modified gen p mean: 0.4452670216560364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02715231664478779, decouple_loss:0.0013180217938497663
Iteration: 2624, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4430270195007324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026805691421031952, decouple_loss:0.0013254362856969237
The modified gen p mean: 0.43872907757759094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028665708377957344, decouple_loss:0.0012836965033784509
The modified gen p mean: 0.4410944879055023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029825646430253983, decouple_loss:0.0013653490459546447
Iteration: 2625, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44359344244003296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026850514113903046, decouple_loss:0.0014119390398263931The modified gen p mean: 0.4427645206451416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028303787112236023, decouple_loss:0.0015001252759248018
The modified gen p mean: 0.44326430559158325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02938329614698887, decouple_loss:0.0014085890725255013
Iteration: 2626, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444599449634552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028956357389688492, decouple_loss:0.0013992266030982137
The modified gen p mean: 0.44799908995628357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026807671412825584, decouple_loss:0.0015282584354281425
The modified gen p mean: 0.44889822602272034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028587613254785538, decouple_loss:0.0014585101744160056
Iteration: 2627, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44795355200767517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028521597385406494, decouple_loss:0.001385443494655192
The modified gen p mean: 0.45081156492233276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02765364944934845, decouple_loss:0.001451455638743937
The modified gen p mean: 0.44909054040908813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029824817553162575, decouple_loss:0.001461392967030406
Iteration: 2628, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4532613754272461, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026870613917708397, decouple_loss:0.001406714553013444
The modified gen p mean: 0.4528787136077881, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028220413252711296, decouple_loss:0.0014347537653520703
The modified gen p mean: 0.4506102502346039, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02898426540195942, decouple_loss:0.0014437360223382711
Iteration: 2629, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4569181203842163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026612842455506325, decouple_loss:0.0014548084000125527
The modified gen p mean: 0.4557878077030182, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02634265460073948, decouple_loss:0.001430221484042704
The modified gen p mean: 0.45420074462890625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02914184145629406, decouple_loss:0.0014188545756042004
Iteration: 2630, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45305371284484863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028067966923117638, decouple_loss:0.0013158993097022176
The modified gen p mean: 0.456313818693161, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026461919769644737, decouple_loss:0.0015511729288846254
The modified gen p mean: 0.45258867740631104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027825355529785156, decouple_loss:0.0012980266474187374
2023-05-26 22:17:22 testing...
The modified gen p mean: 0.4584193825721741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03256196156144142, decouple_loss:0.0015287362039089203
The modified gen p mean: 0.4582538902759552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03414720296859741, decouple_loss:0.001578375929966569
The modified gen p mean: 0.45616742968559265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032766446471214294, decouple_loss:0.001663840259425342
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03323805332183838, avg_mse: 0.04510974884033203
current test mse: 0.04511
Iteration: 2631, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4536482095718384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02841297909617424, decouple_loss:0.0017000120133161545
The modified gen p mean: 0.4510897099971771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028465988114476204, decouple_loss:0.001530430163256824
The modified gen p mean: 0.45413312315940857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027937181293964386, decouple_loss:0.0015067228814586997
Iteration: 2632, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45343753695487976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027347194030880928, decouple_loss:0.0014907503500580788
The modified gen p mean: 0.4545515179634094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02800733596086502, decouple_loss:0.0015023112064227462
The modified gen p mean: 0.45548757910728455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028457194566726685, decouple_loss:0.0015729386359453201
Iteration: 2633, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490729868412018, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02869981713593006, decouple_loss:0.0015504313632845879
The modified gen p mean: 0.4532439410686493, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027424395084381104, decouple_loss:0.0015186710515990853
The modified gen p mean: 0.45507970452308655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029566042125225067, decouple_loss:0.0016148522263392806
Iteration: 2634, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4531635046005249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029132187366485596, decouple_loss:0.0017896727658808231
The modified gen p mean: 0.44986411929130554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027292350307106972, decouple_loss:0.0016071852296590805
The modified gen p mean: 0.44755351543426514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027500465512275696, decouple_loss:0.0014427389251068234
Iteration: 2635, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45021384954452515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02603720687329769, decouple_loss:0.0015736747300252318
The modified gen p mean: 0.44745010137557983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027541527524590492, decouple_loss:0.001378522953018546
The modified gen p mean: 0.44677314162254333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028909876942634583, decouple_loss:0.0013667388120666146
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2636, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45215603709220886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030593937262892723, decouple_loss:0.0015455528628081083
The modified gen p mean: 0.4451335370540619, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4530658423900604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03197314590215683, decouple_loss:0.0013968244893476367
loss_pred:0.030876222997903824, decouple_loss:0.0014946055598556995
Iteration: 2637, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450216680765152, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031104056164622307, decouple_loss:0.0014326266245916486
The modified gen p mean: 0.44652244448661804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03103991411626339, decouple_loss:0.0014007150894030929
The modified gen p mean: 0.44515079259872437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031439781188964844, decouple_loss:0.0013000514591112733
Iteration: 2638, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44776880741119385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03244723752140999, decouple_loss:0.0013685114681720734
The modified gen p mean: 0.45261403918266296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03173323720693588, decouple_loss:0.0013975012116134167
The modified gen p mean: 0.4466809034347534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030805977061390877, decouple_loss:0.0013261268613860011
Iteration: 2639, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495643079280853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030280116945505142, decouple_loss:0.0012932912213727832
The modified gen p mean: 0.4497130811214447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03179552033543587, decouple_loss:0.0014247448416426778
The modified gen p mean: 0.4479677975177765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03164408728480339, decouple_loss:0.0015223404625430703
Iteration: 2640, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45296743512153625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03129700571298599, decouple_loss:0.0013521559303626418
The modified gen p mean: 0.4493615925312042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030998539179563522, decouple_loss:0.001397537998855114
The modified gen p mean: 0.45021042227745056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031660184264183044, decouple_loss:0.0013935304014012218
2023-05-26 22:22:08 testing...
The modified gen p mean: 0.4556736350059509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03226562216877937, decouple_loss:0.0015716735506430268
The modified gen p mean: 0.4537239074707031, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032535064965486526, decouple_loss:0.0017300746403634548
The modified gen p mean: 0.45545530319213867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03380662202835083, decouple_loss:0.0016189872985705733
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03295111656188965, avg_mse: 0.04463815689086914
current test mse: 0.044638
Iteration: 2641, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509282410144806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0332944393157959, decouple_loss:0.0013613826595246792
The modified gen p mean: 0.4552234709262848, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246326744556427, decouple_loss:0.0015224177623167634
The modified gen p mean: 0.4531938135623932, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030824776738882065, decouple_loss:0.0013490495039150119
Iteration: 2642, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45451024174690247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030345382168889046, decouple_loss:0.0015017323894426227
The modified gen p mean: 0.45571833848953247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0311504527926445, decouple_loss:0.0014842244563624263
The modified gen p mean: 0.4526062607765198, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03326455131173134, decouple_loss:0.0014450865564867854
Iteration: 2643, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4543769657611847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030728982761502266, decouple_loss:0.0013464238727465272
The modified gen p mean: 0.45162463188171387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03293294087052345, decouple_loss:0.0014331639977172017
The modified gen p mean: 0.4513514041900635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030162464827299118, decouple_loss:0.0014602337032556534
Iteration: 2644, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45132777094841003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02981233038008213, decouple_loss:0.0014459389494732022
The modified gen p mean: 0.45402589440345764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03228549659252167, decouple_loss:0.0013624322600662708
The modified gen p mean: 0.4517482817173004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03221447020769119, decouple_loss:0.0013003672938793898
Iteration: 2645, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45263853669166565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032223619520664215, decouple_loss:0.0013745236210525036
The modified gen p mean: 0.44897106289863586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03108501248061657, decouple_loss:0.0012299182126298547
The modified gen p mean: 0.452569842338562, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03004796802997589, decouple_loss:0.001414046622812748
Iteration: 2646, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496763050556183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030148891732096672, decouple_loss:0.001531289890408516
The modified gen p mean: 0.44965794682502747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03156919404864311, decouple_loss:0.0014394160825759172
The modified gen p mean: 0.4488450288772583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030816631391644478, decouple_loss:0.0015149516984820366
Iteration: 2647, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44665732979774475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030077707022428513, decouple_loss:0.0012432222720235586
The modified gen p mean: 0.44881707429885864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030237654224038124, decouple_loss:0.0013460743939504027
The modified gen p mean: 0.44806402921676636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03120211511850357, decouple_loss:0.0013441023183986545
Iteration: 2648, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45123177766799927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03045688383281231, decouple_loss:0.0013201317051425576
The modified gen p mean: 0.4465852975845337, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031516771763563156, decouple_loss:0.0014122737338766456
The modified gen p mean: 0.44932278990745544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03032088279724121, decouple_loss:0.0013528672279790044
Iteration: 2649, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501635432243347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030462011694908142, decouple_loss:0.0013584274565801024
The modified gen p mean: 0.4466361403465271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031032118946313858, decouple_loss:0.0013219694374129176
The modified gen p mean: 0.4519917666912079, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03249168023467064, decouple_loss:0.0014960974222049117
Iteration: 2650, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44790583848953247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03200983256101608, decouple_loss:0.0013263138243928552
The modified gen p mean: 0.4508591294288635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029677659273147583, decouple_loss:0.001513616181910038
The modified gen p mean: 0.4476422369480133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030074091628193855, decouple_loss:0.0014592723455280066
2023-05-26 22:26:15 testing...
The modified gen p mean: 0.45278266072273254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03224446624517441, decouple_loss:0.0016003777272999287
The modified gen p mean: 0.4508682191371918, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259708732366562, decouple_loss:0.0016680480912327766
The modified gen p mean: 0.452585369348526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03384832292795181, decouple_loss:0.00156762870028615
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03297722712159157, avg_mse: 0.04472804069519043
current test mse: 0.044728
Iteration: 2651, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4527224600315094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030343949794769287, decouple_loss:0.0015052930684760213
The modified gen p mean: 0.4519335627555847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028810525313019753, decouple_loss:0.0013690138002857566
The modified gen p mean: 0.451241135597229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033217791467905045, decouple_loss:0.0013472280697897077
Iteration: 2652, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510248601436615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033268433064222336, decouple_loss:0.001524442108348012
The modified gen p mean: 0.4517408609390259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02988313138484955, decouple_loss:0.0014487187145277858
The modified gen p mean: 0.45335063338279724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03320721909403801, decouple_loss:0.0015042196027934551
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2653, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508265256881714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029405750334262848, decouple_loss:0.0014968437608331442
The modified gen p mean: 0.4517485201358795, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45254239439964294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03220207616686821, decouple_loss:0.0014136327663436532
loss_pred:0.029900062829256058, decouple_loss:0.0014610436046496034
Iteration: 2654, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503880441188812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03086342103779316, decouple_loss:0.0013664556900039315
The modified gen p mean: 0.4493241310119629, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03214335814118385, decouple_loss:0.001472415984608233
The modified gen p mean: 0.4493689239025116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032930970191955566, decouple_loss:0.00151346274651587
Iteration: 2655, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4533383250236511, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029703283682465553, decouple_loss:0.0015658600023016334
The modified gen p mean: 0.4526771306991577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029449056833982468, decouple_loss:0.0014336721505969763
The modified gen p mean: 0.4532313346862793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030393965542316437, decouple_loss:0.0014656089479103684
Iteration: 2656, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4538707435131073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031223978847265244, decouple_loss:0.0013040894409641623
The modified gen p mean: 0.4549829363822937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02812901884317398, decouple_loss:0.0013843125198036432
The modified gen p mean: 0.45287618041038513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029911471530795097, decouple_loss:0.0013511806027963758
Iteration: 2657, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45201781392097473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030267110094428062, decouple_loss:0.001515284413471818
The modified gen p mean: 0.4522082507610321, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030429782345891, decouple_loss:0.0014733592979609966
The modified gen p mean: 0.454561322927475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029024159535765648, decouple_loss:0.001454864046536386
Iteration: 2658, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485504627227783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02984863705933094, decouple_loss:0.0013918799813836813
The modified gen p mean: 0.45116710662841797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030968906357884407, decouple_loss:0.0013851417461410165
The modified gen p mean: 0.44862619042396545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03170178830623627, decouple_loss:0.0013338816352188587
Iteration: 2659, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45139554142951965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030536582693457603, decouple_loss:0.0014472705079242587
The modified gen p mean: 0.45184120535850525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029864659532904625, decouple_loss:0.0015277572674676776
The modified gen p mean: 0.4538806676864624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031144168227910995, decouple_loss:0.0014294016873463988
Iteration: 2660, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44946596026420593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029749678447842598, decouple_loss:0.001348133198916912
The modified gen p mean: 0.4501584768295288, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02875150367617607, decouple_loss:0.001293622306548059
The modified gen p mean: 0.4487420320510864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02974540926516056, decouple_loss:0.0014415198238566518
2023-05-26 22:31:01 testing...
The modified gen p mean: 0.4509074091911316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03205741196870804, decouple_loss:0.0015732425963506103
The modified gen p mean: 0.450654000043869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03379416465759277, decouple_loss:0.0015875936951488256
The modified gen p mean: 0.449034720659256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03233032301068306, decouple_loss:0.0014630252262577415
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03280436247587204, avg_mse: 0.04433416202664375
current test mse: 0.044334
Iteration: 2661, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44787153601646423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03102046251296997, decouple_loss:0.0014640305889770389
The modified gen p mean: 0.44460344314575195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029924577102065086, decouple_loss:0.001339137670584023
The modified gen p mean: 0.44911742210388184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029569225385785103, decouple_loss:0.001278619864024222
Iteration: 2662, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472748339176178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03116455115377903, decouple_loss:0.0014127411413937807
The modified gen p mean: 0.44958120584487915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029224315658211708, decouple_loss:0.0014352244324982166
The modified gen p mean: 0.4477425515651703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029045861214399338, decouple_loss:0.0013915535528212786
Iteration: 2663, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44487494230270386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03212127089500427, decouple_loss:0.001483397907577455
The modified gen p mean: 0.4482659697532654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030722228810191154, decouple_loss:0.001542097539640963
The modified gen p mean: 0.44697004556655884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03055863082408905, decouple_loss:0.0013679584953933954
Iteration: 2664, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44700056314468384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03239638730883598, decouple_loss:0.0013578084763139486
The modified gen p mean: 0.44838884472846985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030437372624874115, decouple_loss:0.0014408132992684841
The modified gen p mean: 0.4505438208580017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029523294419050217, decouple_loss:0.0014511661138385534
Iteration: 2665, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44689467549324036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03045603446662426, decouple_loss:0.0013351243687793612
The modified gen p mean: 0.44820648431777954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030601343140006065, decouple_loss:0.0012543146731331944
The modified gen p mean: 0.44730132818222046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029683493077754974, decouple_loss:0.0014142199652269483
Iteration: 2666, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469391107559204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030500655993819237, decouple_loss:0.0012663042871281505
The modified gen p mean: 0.4476177990436554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030525481328368187, decouple_loss:0.0012615448795258999
The modified gen p mean: 0.448843777179718, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032027143985033035, decouple_loss:0.0014329173136502504
Iteration: 2667, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516773819923401, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030147874727845192, decouple_loss:0.0013943923404440284
The modified gen p mean: 0.4507569968700409, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03015216253697872, decouple_loss:0.0013082496589049697
The modified gen p mean: 0.44727909564971924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030044039711356163, decouple_loss:0.0012463046004995704
Iteration: 2668, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468875527381897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031247984617948532, decouple_loss:0.0013276441022753716
The modified gen p mean: 0.4487987458705902, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031073972582817078, decouple_loss:0.0013077426701784134
The modified gen p mean: 0.4483181834220886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03059297241270542, decouple_loss:0.0013957065530121326
Iteration: 2669, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45096322894096375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03037819266319275, decouple_loss:0.0013372462708503008
The modified gen p mean: 0.44589701294898987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03130445256829262, decouple_loss:0.0014644116163253784
The modified gen p mean: 0.45008385181427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028356213122606277, decouple_loss:0.0014291525585576892
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2670, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44956985116004944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027605103328824043, decouple_loss:0.0014303894713521004
The modified gen p mean: 0.4494372308254242, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44735637307167053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027799788862466812, decouple_loss:0.0014150728238746524
loss_pred:0.02819433994591236, decouple_loss:0.0013911939458921552
2023-05-26 22:35:47 testing...
The modified gen p mean: 0.4503030478954315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03215768560767174, decouple_loss:0.0015471024671569467
The modified gen p mean: 0.4483829736709595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032378483563661575, decouple_loss:0.0015050795627757907
The modified gen p mean: 0.4500769376754761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034017663449048996, decouple_loss:0.0015472068917006254
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03292793780565262, avg_mse: 0.04460535943508148
current test mse: 0.044605
Iteration: 2671, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44758105278015137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028296811506152153, decouple_loss:0.001412822399288416
The modified gen p mean: 0.4464799463748932, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02773240953683853, decouple_loss:0.0014163571177050471
The modified gen p mean: 0.4457458555698395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027988390997052193, decouple_loss:0.0013688512844964862
Iteration: 2672, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44543981552124023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027021924033761024, decouple_loss:0.0014751473208889365
The modified gen p mean: 0.4448449909687042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025945397093892097, decouple_loss:0.0014490390894934535
The modified gen p mean: 0.4449325203895569, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025788651779294014, decouple_loss:0.0013751244405284524
Iteration: 2673, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449927508831024, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028372948989272118, decouple_loss:0.0015229153214022517
The modified gen p mean: 0.4457201361656189, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027920637279748917, decouple_loss:0.0017321717459708452
The modified gen p mean: 0.4467754065990448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026646865531802177, decouple_loss:0.0015452168881893158
Iteration: 2674, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.43975257873535156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027977822348475456, decouple_loss:0.001428157091140747
The modified gen p mean: 0.442716121673584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02624518610537052, decouple_loss:0.0014943815767765045
The modified gen p mean: 0.44358667731285095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02754705771803856, decouple_loss:0.001482105115428567
Iteration: 2675, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44407758116722107, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027474399656057358, decouple_loss:0.001502674538642168
The modified gen p mean: 0.44210338592529297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02827370911836624, decouple_loss:0.0013812996912747622
The modified gen p mean: 0.4405305087566376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02899765409529209, decouple_loss:0.0013901777565479279
Iteration: 2676, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44180113077163696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027873866260051727, decouple_loss:0.0013718424597755075
The modified gen p mean: 0.44354376196861267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026665188372135162, decouple_loss:0.0013292536605149508
The modified gen p mean: 0.44311556220054626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028133448213338852, decouple_loss:0.0013476616004481912
Iteration: 2677, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4410407543182373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02803664654493332, decouple_loss:0.0013729636557400227
The modified gen p mean: 0.44661352038383484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026324566453695297, decouple_loss:0.0013593505136668682
The modified gen p mean: 0.44677314162254333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026678895577788353, decouple_loss:0.0013834728160873055
Iteration: 2678, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450230002403259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02827395498752594, decouple_loss:0.0012354686623439193
The modified gen p mean: 0.44718295335769653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028280818834900856, decouple_loss:0.0012538338778540492
The modified gen p mean: 0.447063148021698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02638058364391327, decouple_loss:0.0012672898592427373
Iteration: 2679, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45216894149780273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026015426963567734, decouple_loss:0.0012806493323296309
The modified gen p mean: 0.45207303762435913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027324747294187546, decouple_loss:0.0014504470163956285
The modified gen p mean: 0.4476219713687897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02787833847105503, decouple_loss:0.0014410611474886537
Iteration: 2680, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514602720737457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02724388986825943, decouple_loss:0.0014336921740323305
The modified gen p mean: 0.45331358909606934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02650812827050686, decouple_loss:0.0015167230740189552
The modified gen p mean: 0.44767019152641296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028371674939990044, decouple_loss:0.0014307837700471282
2023-05-26 22:39:54 testing...
The modified gen p mean: 0.45523500442504883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265620023012161, decouple_loss:0.001599922776222229
The modified gen p mean: 0.455169677734375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0344708189368248, decouple_loss:0.0017192070372402668
The modified gen p mean: 0.45332416892051697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032803140580654144, decouple_loss:0.0015082104364410043
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03339051082730293, avg_mse: 0.045474823564291
current test mse: 0.045475
Iteration: 2681, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4544479250907898, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026706092059612274, decouple_loss:0.0015262635424733162
The modified gen p mean: 0.4509001076221466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028074074536561966, decouple_loss:0.001410443801432848
The modified gen p mean: 0.4507614076137543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027601921930909157, decouple_loss:0.0015274237375706434
Iteration: 2682, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45268210768699646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026338927447795868, decouple_loss:0.0013850880786776543
The modified gen p mean: 0.44887295365333557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02763727866113186, decouple_loss:0.0014047088334336877
The modified gen p mean: 0.44982534646987915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02805170975625515, decouple_loss:0.0014288777019828558
Iteration: 2683, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44501200318336487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027975212782621384, decouple_loss:0.0013868720270693302
The modified gen p mean: 0.4497172236442566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026346074417233467, decouple_loss:0.001477495883591473
The modified gen p mean: 0.4516887068748474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026655245572328568, decouple_loss:0.0013732151128351688
Iteration: 2684, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492093026638031, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026281291618943214, decouple_loss:0.001587360049597919
The modified gen p mean: 0.4486595690250397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026010768488049507, decouple_loss:0.0015029256464913487
The modified gen p mean: 0.4476624131202698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027259528636932373, decouple_loss:0.001431792974472046
Iteration: 2685, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44402462244033813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028552481904625893, decouple_loss:0.0014845561236143112
The modified gen p mean: 0.444013386964798, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02737768366932869, decouple_loss:0.0014307912206277251
The modified gen p mean: 0.4442267119884491, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02725050039589405, decouple_loss:0.0014054779894649982
Iteration: 2686, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482242166996002, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025634348392486572, decouple_loss:0.001525944098830223
The modified gen p mean: 0.44599243998527527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027832042425870895, decouple_loss:0.0014716389123350382
The modified gen p mean: 0.4462962746620178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027383195236325264, decouple_loss:0.0013852783013135195
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2687, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451864957809448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03140620142221451, decouple_loss:0.001436356222257018
The modified gen p mean: 0.44278785586357117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0315387025475502, decouple_loss:0.001385975512675941
The modified gen p mean: 0.4437909424304962, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032185789197683334, decouple_loss:0.0014762439532205462
Iteration: 2688, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447286456823349, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031560204923152924, decouple_loss:0.0013981651281937957
The modified gen p mean: 0.4448166489601135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03317373991012573, decouple_loss:0.001429786323569715
The modified gen p mean: 0.44726091623306274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031515952199697495, decouple_loss:0.0014795446768403053
Iteration: 2689, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44879502058029175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03238633647561073, decouple_loss:0.0014038210501894355
The modified gen p mean: 0.4514992833137512, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03100208379328251, decouple_loss:0.001499806996434927
The modified gen p mean: 0.4463070034980774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03211229667067528, decouple_loss:0.0015459350543096662
Iteration: 2690, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45310643315315247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033448997884988785, decouple_loss:0.0014724833890795708
The modified gen p mean: 0.44757017493247986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031994808465242386, decouple_loss:0.0013227263698354363
The modified gen p mean: 0.4486885964870453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03228916600346565, decouple_loss:0.0012995746219530702
2023-05-26 22:44:38 testing...
The modified gen p mean: 0.45465564727783203, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032527677714824677, decouple_loss:0.001523727085441351
The modified gen p mean: 0.4527633786201477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032576993107795715, decouple_loss:0.0015666265971958637
The modified gen p mean: 0.45454779267311096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03413183614611626, decouple_loss:0.0015779675450176
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03315664082765579, avg_mse: 0.04499485716223717
current test mse: 0.044995
Iteration: 2691, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491368532180786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254653513431549, decouple_loss:0.0014073644997552037
The modified gen p mean: 0.4491296112537384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031420912593603134, decouple_loss:0.0015118301380425692
The modified gen p mean: 0.4533696174621582, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03350784629583359, decouple_loss:0.0013828941155225039
Iteration: 2692, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4540976881980896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03192230686545372, decouple_loss:0.0013291268842294812
The modified gen p mean: 0.45009174942970276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03208673745393753, decouple_loss:0.0013207588344812393
The modified gen p mean: 0.4497649371623993, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030570846050977707, decouple_loss:0.001417582854628563
Iteration: 2693, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486282169818878, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03236819803714752, decouple_loss:0.001617901143617928
The modified gen p mean: 0.44917213916778564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03354339301586151, decouple_loss:0.001326794852502644
The modified gen p mean: 0.4531950056552887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03199833258986473, decouple_loss:0.0014209682121872902
Iteration: 2694, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469100534915924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0333876870572567, decouple_loss:0.0013119642389938235
The modified gen p mean: 0.4480248987674713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032304976135492325, decouple_loss:0.0014687414513900876
The modified gen p mean: 0.44842830300331116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03169887512922287, decouple_loss:0.001329434453509748
Iteration: 2695, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45173946022987366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031569741666316986, decouple_loss:0.0014448813162744045
The modified gen p mean: 0.44955939054489136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03426549956202507, decouple_loss:0.0014502254780381918
The modified gen p mean: 0.44829505681991577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03277817741036415, decouple_loss:0.001336527755483985
Iteration: 2696, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467599391937256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03105197846889496, decouple_loss:0.0012655226746574044
The modified gen p mean: 0.44920358061790466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030978938564658165, decouple_loss:0.0015878143021836877
The modified gen p mean: 0.44664210081100464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03419730067253113, decouple_loss:0.0014261109754443169
Iteration: 2697, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512536823749542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031147148460149765, decouple_loss:0.0013810331001877785
The modified gen p mean: 0.45189669728279114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030626073479652405, decouple_loss:0.0015101153403520584
The modified gen p mean: 0.45193326473236084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03249587118625641, decouple_loss:0.0014298493042588234
Iteration: 2698, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484788775444031, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03196758031845093, decouple_loss:0.0014464182313531637
The modified gen p mean: 0.4492826759815216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03328103944659233, decouple_loss:0.0015428606420755386
The modified gen p mean: 0.44679126143455505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033361196517944336, decouple_loss:0.0013434692518785596
Iteration: 2699, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45125406980514526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03178487345576286, decouple_loss:0.0014336181338876486
The modified gen p mean: 0.4518001973628998, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246619179844856, decouple_loss:0.0014483722625300288
The modified gen p mean: 0.4494760036468506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253718838095665, decouple_loss:0.0014111001510173082
Iteration: 2700, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44859808683395386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032492056488990784, decouple_loss:0.0013208426535129547
The modified gen p mean: 0.4508625864982605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031800828874111176, decouple_loss:0.0014084276044741273
The modified gen p mean: 0.44998595118522644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031834181398153305, decouple_loss:0.0013489163247868419
2023-05-26 22:48:43 testing...
The modified gen p mean: 0.45177507400512695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03217451274394989, decouple_loss:0.001552402158267796
The modified gen p mean: 0.44985896348953247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032349713146686554, decouple_loss:0.001680922694504261
The modified gen p mean: 0.4517301917076111, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03371939808130264, decouple_loss:0.0015894054668024182
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032828256487846375, avg_mse: 0.04441690817475319
current test mse: 0.044417
Iteration: 2701, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44593074917793274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03210131451487541, decouple_loss:0.0012932975078001618
The modified gen p mean: 0.4495201110839844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029594242572784424, decouple_loss:0.0014754439471289515
The modified gen p mean: 0.44938623905181885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03323183208703995, decouple_loss:0.0013651070185005665
Iteration: 2702, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44581037759780884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03192613646388054, decouple_loss:0.0012354232603684068
The modified gen p mean: 0.44929325580596924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030936311930418015, decouple_loss:0.0015107220970094204
The modified gen p mean: 0.4446905851364136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032367460429668427, decouple_loss:0.0013035425217822194
Iteration: 2703, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478827714920044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029325097799301147, decouple_loss:0.0015564407221972942
The modified gen p mean: 0.4456547200679779, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03389502316713333, decouple_loss:0.0013888691319152713
The modified gen p mean: 0.4491547644138336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030846111476421356, decouple_loss:0.0014910659519955516
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr.npz
NaN value num: 0
Iteration: 2704, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463967978954315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02804318629205227, decouple_loss:0.0013147323625162244
The modified gen p mean: 0.44865983724594116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028138719499111176, decouple_loss:0.0014267002698034048
The modified gen p mean: 0.44864386320114136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02688574232161045, decouple_loss:0.0014261261094361544
Iteration: 2705, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454735517501831, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027794748544692993, decouple_loss:0.0014349960256367922
The modified gen p mean: 0.445811927318573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029647797346115112, decouple_loss:0.0014030480524525046
The modified gen p mean: 0.4503253698348999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027292005717754364, decouple_loss:0.001628252910450101
Iteration: 2706, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484311640262604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026538625359535217, decouple_loss:0.0014113396173343062
The modified gen p mean: 0.4462059438228607, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027912557125091553, decouple_loss:0.0013643200509250164
The modified gen p mean: 0.4463317096233368, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028519924730062485, decouple_loss:0.0015629675472155213
Iteration: 2707, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478043019771576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02689729444682598, decouple_loss:0.0014665568014606833
The modified gen p mean: 0.44564998149871826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025908082723617554, decouple_loss:0.0014945438597351313
The modified gen p mean: 0.4469722807407379, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026020290330052376, decouple_loss:0.0014641693560406566
Iteration: 2708, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44411715865135193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027732668444514275, decouple_loss:0.001359969493933022
The modified gen p mean: 0.4476572275161743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027764281257987022, decouple_loss:0.0015401073032990098
The modified gen p mean: 0.4478633403778076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027759449556469917, decouple_loss:0.0015909584471955895
Iteration: 2709, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44499558210372925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027367858216166496, decouple_loss:0.0014170518843457103
The modified gen p mean: 0.4456360340118408, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0261400006711483, decouple_loss:0.0015130394604057074
The modified gen p mean: 0.44454485177993774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027915170416235924, decouple_loss:0.0013601754326373339
Iteration: 2710, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44932785630226135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026623377576470375, decouple_loss:0.001367888879030943
The modified gen p mean: 0.44670698046684265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028301388025283813, decouple_loss:0.0014683831250295043
The modified gen p mean: 0.445425420999527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027701567858457565, decouple_loss:0.0015280414372682571
2023-05-26 22:53:29 testing...
The modified gen p mean: 0.4511451721191406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253272920846939, decouple_loss:0.0015925461193546653
The modified gen p mean: 0.4490709602832794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032825347036123276, decouple_loss:0.0016347859054803848
The modified gen p mean: 0.4508953094482422, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03415663540363312, decouple_loss:0.001642293413169682
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03325273096561432, avg_mse: 0.04521362856030464
current test mse: 0.045214
Iteration: 2711, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464699327945709, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02833743765950203, decouple_loss:0.0013765078037977219
The modified gen p mean: 0.4423353970050812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028692346066236496, decouple_loss:0.0015362021513283253
The modified gen p mean: 0.44560331106185913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027126947417855263, decouple_loss:0.0014094500802457333
Iteration: 2712, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483868181705475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026149939745664597, decouple_loss:0.0015448444755747914
The modified gen p mean: 0.44635987281799316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027498595416545868, decouple_loss:0.0016193109331652522
The modified gen p mean: 0.4493747055530548, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026014555245637894, decouple_loss:0.0016524676466360688
Iteration: 2713, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475332796573639, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02809511311352253, decouple_loss:0.0014249291270971298
The modified gen p mean: 0.4455917477607727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029141470789909363, decouple_loss:0.0014658948639407754
The modified gen p mean: 0.44702351093292236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0273903738707304, decouple_loss:0.00141899473965168
Iteration: 2714, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44478490948677063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028328116983175278, decouple_loss:0.0013746980112046003
The modified gen p mean: 0.44769930839538574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027082856744527817, decouple_loss:0.0014179965946823359
The modified gen p mean: 0.4493344724178314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027317872270941734, decouple_loss:0.0016776507254689932
Iteration: 2715, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479241669178009, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026417620480060577, decouple_loss:0.0013717447873204947
The modified gen p mean: 0.4508102536201477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026323946192860603, decouple_loss:0.001437526661902666
The modified gen p mean: 0.44637569785118103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027208317071199417, decouple_loss:0.0013499540509656072
Iteration: 2716, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44933417439460754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027788320556282997, decouple_loss:0.0013539779465645552
The modified gen p mean: 0.45074325799942017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025629939511418343, decouple_loss:0.0015782569535076618
The modified gen p mean: 0.44652390480041504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026485024020075798, decouple_loss:0.0014749326510354877
Iteration: 2717, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498094916343689, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025587202981114388, decouple_loss:0.0013924253871664405
The modified gen p mean: 0.4483851492404938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026799125596880913, decouple_loss:0.001474014250561595
The modified gen p mean: 0.44687607884407043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026388786733150482, decouple_loss:0.001652000704780221
Iteration: 2718, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45008185505867004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025653498247265816, decouple_loss:0.0013928442494943738
The modified gen p mean: 0.44743719696998596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025985179468989372, decouple_loss:0.0014380253851413727
The modified gen p mean: 0.44630691409111023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027089808136224747, decouple_loss:0.00134114024695009
Iteration: 2719, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44652053713798523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027992483228445053, decouple_loss:0.001329620834439993
The modified gen p mean: 0.4483112692832947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02768971025943756, decouple_loss:0.001537037082016468
The modified gen p mean: 0.4463396668434143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02559678442776203, decouple_loss:0.0013355602277442813
Iteration: 2720, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497532248497009, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026885423809289932, decouple_loss:0.0013813878176733851
The modified gen p mean: 0.44667017459869385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02637632191181183, decouple_loss:0.0012928456999361515
The modified gen p mean: 0.44672054052352905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02588399313390255, decouple_loss:0.0015190619742497802
2023-05-26 22:57:35 testing...
The modified gen p mean: 0.4521664083003998, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03252369165420532, decouple_loss:0.0015095972921699286
The modified gen p mean: 0.45015063881874084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032539252191782, decouple_loss:0.001599147915840149
The modified gen p mean: 0.45204681158065796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03402320295572281, decouple_loss:0.0015482668532058597
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03310633450746536, avg_mse: 0.045024607330560684
current test mse: 0.045025
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2721, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480511248111725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02918405272066593, decouple_loss:0.001456970232538879
The modified gen p mean: 0.44925200939178467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028715524822473526, decouple_loss:0.0014739312464371324
The modified gen p mean: 0.44671541452407837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690255641937256, decouple_loss:0.0012943868059664965
Iteration: 2722, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44953277707099915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029166650027036667, decouple_loss:0.001302663586102426
The modified gen p mean: 0.45028236508369446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027674909681081772, decouple_loss:0.0014059809036552906
The modified gen p mean: 0.44841858744621277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028558753430843353, decouple_loss:0.0012665374670177698
Iteration: 2723, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485054016113281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028646711260080338, decouple_loss:0.0012737034121528268
The modified gen p mean: 0.45183929800987244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027606789022684097, decouple_loss:0.0014521449338644743
The modified gen p mean: 0.45075663924217224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820134535431862, decouple_loss:0.0013571778545156121
Iteration: 2724, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45292219519615173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02782610058784485, decouple_loss:0.0012489635264500976
The modified gen p mean: 0.4495807886123657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027538113296031952, decouple_loss:0.0012939941370859742
The modified gen p mean: 0.45222795009613037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028900112956762314, decouple_loss:0.0013695689849555492
Iteration: 2725, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507289528846741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028202388435602188, decouple_loss:0.0012215508613735437
The modified gen p mean: 0.4563080668449402, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02634376473724842, decouple_loss:0.0013806995702907443
The modified gen p mean: 0.4514661729335785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02863185480237007, decouple_loss:0.001348972087725997
Iteration: 2726, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4539669156074524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02724156528711319, decouple_loss:0.0013464444782584906
The modified gen p mean: 0.45688045024871826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027284836396574974, decouple_loss:0.001411807956174016
The modified gen p mean: 0.45123010873794556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029055165126919746, decouple_loss:0.00164648680947721
Iteration: 2727, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45379137992858887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02772621624171734, decouple_loss:0.0016657175729051232
The modified gen p mean: 0.4505576491355896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025671396404504776, decouple_loss:0.0015370980836451054
The modified gen p mean: 0.4550018906593323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026869114488363266, decouple_loss:0.0015654691960662603
Iteration: 2728, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45177116990089417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026933826506137848, decouple_loss:0.0014430632581934333
The modified gen p mean: 0.4527519643306732, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02851218916475773, decouple_loss:0.0013868148671463132
The modified gen p mean: 0.44899824261665344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028774168342351913, decouple_loss:0.0014005218399688601
Iteration: 2729, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44780778884887695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0275910384953022, decouple_loss:0.0014009318547323346
The modified gen p mean: 0.45058462023735046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029158074408769608, decouple_loss:0.0014250308740884066
The modified gen p mean: 0.4538987874984741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02747991867363453, decouple_loss:0.0014500714605674148
Iteration: 2730, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45346561074256897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0282440148293972, decouple_loss:0.0016117951599881053
The modified gen p mean: 0.44878482818603516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02866169810295105, decouple_loss:0.0013952734880149364
The modified gen p mean: 0.4486795663833618, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029214290902018547, decouple_loss:0.0015651826979592443
2023-05-26 23:02:22 testing...
The modified gen p mean: 0.45141181349754333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032628383487463, decouple_loss:0.001666627125814557
The modified gen p mean: 0.4492288827896118, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032801028341054916, decouple_loss:0.0017042409162968397
The modified gen p mean: 0.45137256383895874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03425756096839905, decouple_loss:0.0017107800813391805
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03331368789076805, avg_mse: 0.04525623470544815
current test mse: 0.045256
Iteration: 2731, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44501566886901855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027693983167409897, decouple_loss:0.0013910095440223813
The modified gen p mean: 0.4493270218372345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026839913800358772, decouple_loss:0.0016800970770418644
The modified gen p mean: 0.44855499267578125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02724173292517662, decouple_loss:0.001543816877529025
Iteration: 2732, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4448460638523102, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02788144163787365, decouple_loss:0.0013677094830200076
The modified gen p mean: 0.4493062496185303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025318369269371033, decouple_loss:0.001628318801522255
The modified gen p mean: 0.444583535194397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02873443439602852, decouple_loss:0.0015056642005220056
Iteration: 2733, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478406012058258, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027888361364603043, decouple_loss:0.0014101624255999923
The modified gen p mean: 0.44981223344802856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026845252141356468, decouple_loss:0.0016602871473878622
The modified gen p mean: 0.4467615485191345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027803784236311913, decouple_loss:0.0014836047776043415
Iteration: 2734, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44662272930145264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02763749286532402, decouple_loss:0.0014663703041151166
The modified gen p mean: 0.45181989669799805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027162820100784302, decouple_loss:0.0015757115324959159
The modified gen p mean: 0.4480482041835785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026460248976945877, decouple_loss:0.0014716573059558868
Iteration: 2735, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44495517015457153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0282833781093359, decouple_loss:0.001367373508401215
The modified gen p mean: 0.4497411847114563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027965938672423363, decouple_loss:0.0014205091865733266
The modified gen p mean: 0.44731947779655457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029240554198622704, decouple_loss:0.001438273349776864
Iteration: 2736, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.452386736869812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028038639575242996, decouple_loss:0.001376803615130484
The modified gen p mean: 0.4482779800891876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02798660844564438, decouple_loss:0.0014160587452352047
The modified gen p mean: 0.44756758213043213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028180478140711784, decouple_loss:0.0014845823170617223
Iteration: 2737, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494054913520813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026965506374835968, decouple_loss:0.001425989787094295
The modified gen p mean: 0.4502376317977905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02867889031767845, decouple_loss:0.0014254089910537004
The modified gen p mean: 0.45064419507980347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029317019507288933, decouple_loss:0.0015643876977264881
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr.npz
NaN value num: 0
Iteration: 2738, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44717028737068176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03075012005865574, decouple_loss:0.0014485009014606476
The modified gen p mean: 0.44930770993232727, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4522157907485962, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02978326752781868, decouple_loss:0.0013669501058757305
loss_pred:0.028844527900218964, decouple_loss:0.0014980374835431576
Iteration: 2739, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45000630617141724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031101426109671593, decouple_loss:0.0014853940811008215
The modified gen p mean: 0.44910770654678345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03006354719400406, decouple_loss:0.0013672651257365942
The modified gen p mean: 0.45148229598999023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030538154765963554, decouple_loss:0.0015164052601903677
Iteration: 2740, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45072251558303833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030361995100975037, decouple_loss:0.0013908201362937689
The modified gen p mean: 0.449748158454895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02941042371094227, decouple_loss:0.0014420000370591879
The modified gen p mean: 0.45432689785957336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02929414063692093, decouple_loss:0.001407301053404808
2023-05-26 23:07:17 testing...
The modified gen p mean: 0.45668500661849976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032503627240657806, decouple_loss:0.0016635371139273047
The modified gen p mean: 0.45454612374305725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032662615180015564, decouple_loss:0.0015007192268967628
The modified gen p mean: 0.45661935210227966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034248460084199905, decouple_loss:0.0016172947362065315
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03321792930364609, avg_mse: 0.045148368924856186
current test mse: 0.045148
Iteration: 2741, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501860439777374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03109869547188282, decouple_loss:0.0013895852025598288
The modified gen p mean: 0.4523220360279083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02958776243031025, decouple_loss:0.001376098021864891
The modified gen p mean: 0.45074719190597534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032311003655195236, decouple_loss:0.0016125085530802608
Iteration: 2742, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519990384578705, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4542420506477356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02990853413939476, decouple_loss:0.0014151716604828835loss_pred:0.029547229409217834, decouple_loss:0.0013518749037757516
The modified gen p mean: 0.4513116180896759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03016001172363758, decouple_loss:0.0014399790670722723
Iteration: 2743, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4566243588924408, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030028559267520905, decouple_loss:0.001473724259994924
The modified gen p mean: 0.4509756565093994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02975074015557766, decouple_loss:0.0013882992789149284
The modified gen p mean: 0.4532003700733185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03029443882405758, decouple_loss:0.0014570910716429353
Iteration: 2744, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45425957441329956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029075980186462402, decouple_loss:0.0014653673861175776
The modified gen p mean: 0.45635122060775757, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030026784166693687, decouple_loss:0.0016175761120393872
The modified gen p mean: 0.4513130486011505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02940194308757782, decouple_loss:0.0014354471350088716
Iteration: 2745, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44879594445228577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03015170246362686, decouple_loss:0.0012862964067608118
The modified gen p mean: 0.44989442825317383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030198926106095314, decouple_loss:0.0014210955705493689
The modified gen p mean: 0.45071062445640564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031411975622177124, decouple_loss:0.0014074885984882712
Iteration: 2746, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468916952610016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029867975041270256, decouple_loss:0.0012696627527475357
The modified gen p mean: 0.4483495354652405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03031228482723236, decouple_loss:0.0013358142459765077
The modified gen p mean: 0.45396852493286133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029262855648994446, decouple_loss:0.0014731440460309386
Iteration: 2747, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44915416836738586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029305988922715187, decouple_loss:0.0013542277738451958
The modified gen p mean: 0.4461256265640259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029555579647421837, decouple_loss:0.0014309198595583439
The modified gen p mean: 0.44981276988983154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030945468693971634, decouple_loss:0.0014010965824127197
Iteration: 2748, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458387792110443, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44823214411735535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029364384710788727, decouple_loss:0.0013217200757935643
loss_pred:0.028782671317458153, decouple_loss:0.0013872891431674361
The modified gen p mean: 0.45005467534065247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03017929568886757, decouple_loss:0.0015604379586875439
Iteration: 2749, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44764575362205505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02965399995446205, decouple_loss:0.0014357030158862472
The modified gen p mean: 0.4440558850765228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029376620426774025, decouple_loss:0.0014445504639297724
The modified gen p mean: 0.4492683708667755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03154612332582474, decouple_loss:0.0016128954011946917
Iteration: 2750, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480704069137573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029923848807811737, decouple_loss:0.001484918873757124
The modified gen p mean: 0.4447965919971466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030346475541591644, decouple_loss:0.001342116273008287
The modified gen p mean: 0.4468778073787689, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030116548761725426, decouple_loss:0.0015479526482522488
2023-05-26 23:11:29 testing...
The modified gen p mean: 0.45150646567344666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032264593988657, decouple_loss:0.0015119945164769888
The modified gen p mean: 0.4515124559402466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03423505276441574, decouple_loss:0.001572305685840547
The modified gen p mean: 0.4493808448314667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032509222626686096, decouple_loss:0.0015039946883916855
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03307943046092987, avg_mse: 0.04485267400741577
current test mse: 0.044853
Iteration: 2751, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458499550819397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029915062710642815, decouple_loss:0.0013938453048467636
The modified gen p mean: 0.45137864351272583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029076818376779556, decouple_loss:0.0013990123989060521
The modified gen p mean: 0.4461987018585205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03138228505849838, decouple_loss:0.0015356708317995071
Iteration: 2752, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480147063732147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03000270202755928, decouple_loss:0.0013755348045378923
The modified gen p mean: 0.45219892263412476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0298320222645998, decouple_loss:0.0014016081113368273
The modified gen p mean: 0.4456118643283844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03099542111158371, decouple_loss:0.0012943901820108294
Iteration: 2753, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44825851917266846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030215544626116753, decouple_loss:0.0013596458593383431
The modified gen p mean: 0.4487099051475525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03000987321138382, decouple_loss:0.001497300574555993
The modified gen p mean: 0.4503025710582733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028221387416124344, decouple_loss:0.0014122265856713057
Iteration: 2754, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44869667291641235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03039240837097168, decouple_loss:0.0014754479052498937
The modified gen p mean: 0.4532477855682373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03063664399087429, decouple_loss:0.0015585083747282624
The modified gen p mean: 0.44746237993240356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03135602921247482, decouple_loss:0.0013779269065707922
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2755, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498478174209595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02878144569694996, decouple_loss:0.0013740328140556812
The modified gen p mean: 0.4471382200717926, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44722220301628113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028853319585323334, decouple_loss:0.0013303592568263412
loss_pred:0.028040006756782532, decouple_loss:0.0013556273188441992
Iteration: 2756, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44701316952705383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028651194646954536, decouple_loss:0.0012686189729720354
The modified gen p mean: 0.45426326990127563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028254471719264984, decouple_loss:0.0014200240839272738
The modified gen p mean: 0.44768214225769043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02950374409556389, decouple_loss:0.0013790263328701258
Iteration: 2757, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505559206008911, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026925738900899887, decouple_loss:0.0015411904314532876
The modified gen p mean: 0.4477185606956482, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028395337983965874, decouple_loss:0.0013599420199170709
The modified gen p mean: 0.44855472445487976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0283220112323761, decouple_loss:0.0014075749786570668
Iteration: 2758, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475511908531189, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029137836769223213, decouple_loss:0.0016202523838728666
The modified gen p mean: 0.4478071630001068, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028646891936659813, decouple_loss:0.0014333832077682018
The modified gen p mean: 0.4460412561893463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028517233207821846, decouple_loss:0.001386607182212174
Iteration: 2759, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44618502259254456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028235653415322304, decouple_loss:0.0016172857722267509
The modified gen p mean: 0.4476768672466278, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02866719290614128, decouple_loss:0.0014518334064632654
The modified gen p mean: 0.449348121881485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027367010712623596, decouple_loss:0.001355143846012652
Iteration: 2760, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44096890091896057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028830841183662415, decouple_loss:0.0013588694855570793
The modified gen p mean: 0.4450111389160156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029088597744703293, decouple_loss:0.001406043185852468
The modified gen p mean: 0.43975594639778137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029241057112812996, decouple_loss:0.001361575908958912
2023-05-26 23:16:30 testing...
The modified gen p mean: 0.44674673676490784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032447874546051025, decouple_loss:0.0015892726369202137
The modified gen p mean: 0.4446350634098053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265746682882309, decouple_loss:0.0014451505849137902
The modified gen p mean: 0.4467634856700897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03435960412025452, decouple_loss:0.0015987629303708673
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033232204616069794, avg_mse: 0.04524620994925499
current test mse: 0.045246
Iteration: 2761, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44712379574775696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028042558580636978, decouple_loss:0.001683071255683899
The modified gen p mean: 0.4447753429412842, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02794789895415306, decouple_loss:0.0014455459313467145
The modified gen p mean: 0.44637611508369446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028074132278561592, decouple_loss:0.0013637657975777984
Iteration: 2762, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4413429796695709, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029003344476222992, decouple_loss:0.0015446982579305768
The modified gen p mean: 0.44085079431533813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02719070389866829, decouple_loss:0.0014774914598092437
The modified gen p mean: 0.4375797510147095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028258079662919044, decouple_loss:0.0013803299516439438
Iteration: 2763, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.443096786737442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028516976162791252, decouple_loss:0.0013944917591288686
The modified gen p mean: 0.44057896733283997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028316283598542213, decouple_loss:0.0013353333342820406
The modified gen p mean: 0.4495480954647064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02833649143576622, decouple_loss:0.0016242250567302108
Iteration: 2764, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4433842897415161, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028381166979670525, decouple_loss:0.0014283297350630164
The modified gen p mean: 0.44600245356559753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0289479810744524, decouple_loss:0.0013626411091536283
The modified gen p mean: 0.4450855255126953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02765829674899578, decouple_loss:0.001392202451825142
Iteration: 2765, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515015780925751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028977494686841965, decouple_loss:0.0014593974919989705
The modified gen p mean: 0.45238354802131653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02868635579943657, decouple_loss:0.0016287218313664198
The modified gen p mean: 0.4511413872241974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027978453785181046, decouple_loss:0.001679768436588347
Iteration: 2766, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44706225395202637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030029870569705963, decouple_loss:0.00145526765845716
The modified gen p mean: 0.44700494408607483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028972962871193886, decouple_loss:0.0016039670445024967
The modified gen p mean: 0.4545958638191223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027829265221953392, decouple_loss:0.0014524866128340364
Iteration: 2767, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44675832986831665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028252139687538147, decouple_loss:0.001358233974315226
The modified gen p mean: 0.452040433883667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026667607948184013, decouple_loss:0.0013431862462311983
The modified gen p mean: 0.4471547603607178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029981739819049835, decouple_loss:0.0016221327241510153
Iteration: 2768, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512121379375458, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02780405431985855, decouple_loss:0.0014189573703333735
The modified gen p mean: 0.44897225499153137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027527540922164917, decouple_loss:0.0015250332653522491
The modified gen p mean: 0.44957154989242554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028134744614362717, decouple_loss:0.0013082446530461311
Iteration: 2769, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4533688724040985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027563821524381638, decouple_loss:0.0016483546933159232
The modified gen p mean: 0.4474029839038849, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028690099716186523, decouple_loss:0.0014912536134943366
The modified gen p mean: 0.44816911220550537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027523111552000046, decouple_loss:0.0014776299940422177
Iteration: 2770, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510704278945923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028539404273033142, decouple_loss:0.00142455764580518
The modified gen p mean: 0.4487563967704773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028032740578055382, decouple_loss:0.0014463405823335052
The modified gen p mean: 0.4463118612766266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02751692570745945, decouple_loss:0.001294281450100243
2023-05-26 23:20:36 testing...
The modified gen p mean: 0.45253732800483704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0326952263712883, decouple_loss:0.0016201765974983573
The modified gen p mean: 0.4524236023426056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034345537424087524, decouple_loss:0.0016557734925299883
The modified gen p mean: 0.4504231810569763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032686326652765274, decouple_loss:0.0015324776759371161
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03332250565290451, avg_mse: 0.04544553905725479
current test mse: 0.045446
Iteration: 2771, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44669729471206665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029414787888526917, decouple_loss:0.001232682028785348
The modified gen p mean: 0.4513101577758789, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027511361986398697, decouple_loss:0.001418409519828856
The modified gen p mean: 0.44517141580581665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028070496395230293, decouple_loss:0.0013396496651694179
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr.npz
NaN value num: 0
Iteration: 2772, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44799157977104187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030994677916169167, decouple_loss:0.0014118208782747388
The modified gen p mean: 0.45069536566734314, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45105886459350586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030156143009662628, decouple_loss:0.001561453565955162
loss_pred:0.031370483338832855, decouple_loss:0.0015168479876592755
Iteration: 2773, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454367458820343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030829492956399918, decouple_loss:0.0013708192855119705
The modified gen p mean: 0.45053085684776306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031864456832408905, decouple_loss:0.0014548759208992124
The modified gen p mean: 0.44953715801239014, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029855143278837204, decouple_loss:0.0015168391400948167
Iteration: 2774, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499705135822296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03076624497771263, decouple_loss:0.0013920728815719485
The modified gen p mean: 0.446630597114563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030434051528573036, decouple_loss:0.00148029625415802
The modified gen p mean: 0.4462730586528778, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03189348429441452, decouple_loss:0.0012848960468545556
Iteration: 2775, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446076363325119, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44608020782470703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02980245277285576, decouple_loss:0.001447063870728016
loss_pred:0.031482502818107605, decouple_loss:0.0015439556445926428
The modified gen p mean: 0.44889554381370544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028140941634774208, decouple_loss:0.0014832386514171958
Iteration: 2776, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44485998153686523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030486760661005974, decouple_loss:0.0014036555076017976
The modified gen p mean: 0.4473980665206909, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03110502101480961, decouple_loss:0.0014189501525834203
The modified gen p mean: 0.4502982497215271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030137183144688606, decouple_loss:0.001421135850250721
Iteration: 2777, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44555795192718506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03267733380198479, decouple_loss:0.001357473200187087
The modified gen p mean: 0.446958065032959, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02939426526427269, decouple_loss:0.0014324767980724573
The modified gen p mean: 0.44825631380081177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03006507270038128, decouple_loss:0.0014037287328392267
Iteration: 2778, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512147605419159, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029689131304621696, decouple_loss:0.0015547749353572726
The modified gen p mean: 0.44975149631500244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02845948562026024, decouple_loss:0.0013809928204864264
The modified gen p mean: 0.4504311680793762, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030289357528090477, decouple_loss:0.001416928367689252
Iteration: 2779, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44864508509635925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02996429055929184, decouple_loss:0.0014275924768298864
The modified gen p mean: 0.44896721839904785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031206965446472168, decouple_loss:0.0013391245156526566
The modified gen p mean: 0.4460977017879486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030110828578472137, decouple_loss:0.0013114530593156815
Iteration: 2780, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500686824321747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03165055811405182, decouple_loss:0.0014744893414899707
The modified gen p mean: 0.4524346590042114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03147168830037117, decouple_loss:0.0014449821319431067
The modified gen p mean: 0.4538253843784332, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03128517419099808, decouple_loss:0.0013525515096262097
2023-05-26 23:25:26 testing...
The modified gen p mean: 0.45506051182746887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03242616727948189, decouple_loss:0.0015415363013744354
The modified gen p mean: 0.4531683027744293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261655196547508, decouple_loss:0.001568635692819953
The modified gen p mean: 0.4548856317996979, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034034568816423416, decouple_loss:0.001615844783373177
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03310453146696091, avg_mse: 0.044994618743658066
current test mse: 0.044995
Iteration: 2781, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44949594140052795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030626807361841202, decouple_loss:0.0013355027185752988
The modified gen p mean: 0.4540538489818573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03123384900391102, decouple_loss:0.001455998863093555
The modified gen p mean: 0.45317980647087097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02927485853433609, decouple_loss:0.0013664596481248736
Iteration: 2782, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45209524035453796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030395125970244408, decouple_loss:0.001404198003001511
The modified gen p mean: 0.4512332081794739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03233122453093529, decouple_loss:0.0013982641976326704
The modified gen p mean: 0.44954508543014526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02959352359175682, decouple_loss:0.0014892270555719733
Iteration: 2783, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44763103127479553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03081250563263893, decouple_loss:0.0013299670536071062
The modified gen p mean: 0.4523371756076813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02931159734725952, decouple_loss:0.0015102742472663522
The modified gen p mean: 0.4492192566394806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02923661656677723, decouple_loss:0.0013708366313949227
Iteration: 2784, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506619870662689, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02931816503405571, decouple_loss:0.001429678057320416
The modified gen p mean: 0.4481118619441986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03169826790690422, decouple_loss:0.0013166009448468685
The modified gen p mean: 0.4495803117752075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030904652550816536, decouple_loss:0.0014393290039151907
Iteration: 2785, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44503000378608704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03231723606586456, decouple_loss:0.0013304288731887937
The modified gen p mean: 0.4471309781074524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029946813359856606, decouple_loss:0.0015328007284551859
The modified gen p mean: 0.44882932305336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029368529096245766, decouple_loss:0.0014576611574739218
Iteration: 2786, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4440440535545349, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265437111258507, decouple_loss:0.0014066045405343175
The modified gen p mean: 0.44492268562316895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030369559302926064, decouple_loss:0.001402657595463097
The modified gen p mean: 0.44750913977622986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03141169995069504, decouple_loss:0.0012959209270775318
Iteration: 2787, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44962313771247864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0309287142008543, decouple_loss:0.001681018271483481
The modified gen p mean: 0.4443764388561249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03071288764476776, decouple_loss:0.001382788410410285
The modified gen p mean: 0.4434169828891754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029901351779699326, decouple_loss:0.0014019180089235306
Iteration: 2788, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44399043917655945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03205815330147743, decouple_loss:0.0013010663678869605
The modified gen p mean: 0.4475017488002777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02996491640806198, decouple_loss:0.001477832323871553
The modified gen p mean: 0.4433533847332001, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029116353020071983, decouple_loss:0.0013374773552641273
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2789, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44962093234062195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026349104940891266, decouple_loss:0.0014251305256038904
The modified gen p mean: 0.44806843996047974, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44623392820358276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02720061130821705, decouple_loss:0.0014105226146057248
loss_pred:0.02786642499268055, decouple_loss:0.001326256082393229
Iteration: 2790, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451555609703064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027949258685112, decouple_loss:0.0013233890058472753
The modified gen p mean: 0.4470770061016083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02697847969830036, decouple_loss:0.0015264843823388219
The modified gen p mean: 0.4470357894897461, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027137592434883118, decouple_loss:0.0013936758041381836
2023-05-26 23:30:16 testing...
The modified gen p mean: 0.4524020254611969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03258926421403885, decouple_loss:0.001558893360197544
The modified gen p mean: 0.4504927098751068, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032480571419000626, decouple_loss:0.0014724003849551082
The modified gen p mean: 0.45224064588546753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03409329056739807, decouple_loss:0.0015423198929056525
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03313060104846954, avg_mse: 0.04506820812821388
current test mse: 0.045068
Iteration: 2791, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447353333234787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02718680538237095, decouple_loss:0.0014572322834283113
The modified gen p mean: 0.4455428123474121, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027677692472934723, decouple_loss:0.0013564258115366101
The modified gen p mean: 0.4470539391040802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610027976334095, decouple_loss:0.001403873204253614
Iteration: 2792, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491673409938812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02695501409471035, decouple_loss:0.0012897696578875184
The modified gen p mean: 0.4500778615474701, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026986248791217804, decouple_loss:0.001502994098700583
The modified gen p mean: 0.44627121090888977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028416316956281662, decouple_loss:0.0014709290117025375
Iteration: 2793, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44874680042266846, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44932007789611816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027028024196624756, decouple_loss:0.001542831538245082
loss_pred:0.028276246041059494, decouple_loss:0.0013494659215211868
The modified gen p mean: 0.4457654058933258, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027960216626524925, decouple_loss:0.0015249454881995916
Iteration: 2794, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446873277425766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029031075537204742, decouple_loss:0.001412506913766265
The modified gen p mean: 0.4478236436843872, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027635958045721054, decouple_loss:0.0014458632795140147
The modified gen p mean: 0.44716566801071167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026904210448265076, decouple_loss:0.0015483642928302288
Iteration: 2795, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45174673199653625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026310892775654793, decouple_loss:0.0013428045203909278
The modified gen p mean: 0.44823431968688965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027635235339403152, decouple_loss:0.0015052049420773983
The modified gen p mean: 0.45040833950042725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02703019790351391, decouple_loss:0.0013676534872502089
Iteration: 2796, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476475715637207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026763280853629112, decouple_loss:0.0015277775237336755
The modified gen p mean: 0.4520241320133209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027094755321741104, decouple_loss:0.001409549848176539
The modified gen p mean: 0.4464970827102661, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027736591175198555, decouple_loss:0.0012481496669352055
Iteration: 2797, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441315829753876, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4480600655078888, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0268382728099823, decouple_loss:0.0013933086302131414
loss_pred:0.027545267716050148, decouple_loss:0.0014944011345505714
The modified gen p mean: 0.4432923197746277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027100086212158203, decouple_loss:0.0015468773199245334
Iteration: 2798, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495299458503723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026650024577975273, decouple_loss:0.0014438697835430503
The modified gen p mean: 0.44692838191986084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027152420952916145, decouple_loss:0.0013708031037822366
The modified gen p mean: 0.44594642519950867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026049571111798286, decouple_loss:0.0014095945516601205
Iteration: 2799, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4419386386871338, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027078278362751007, decouple_loss:0.00127861846704036
The modified gen p mean: 0.44300904870033264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732084132730961, decouple_loss:0.0014326691161841154
The modified gen p mean: 0.4432414174079895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027825988829135895, decouple_loss:0.0013272486394271255
Iteration: 2800, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44750192761421204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026754116639494896, decouple_loss:0.001563987578265369
The modified gen p mean: 0.44015926122665405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02740570902824402, decouple_loss:0.0012938044965267181
The modified gen p mean: 0.4427243769168854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027339395135641098, decouple_loss:0.0013760796282440424
2023-05-26 23:34:23 testing...
The modified gen p mean: 0.4484565258026123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255948796868324, decouple_loss:0.0015677273040637374
The modified gen p mean: 0.44651666283607483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0326760858297348, decouple_loss:0.00147033273242414
The modified gen p mean: 0.44838520884513855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03417830541729927, decouple_loss:0.0015545901842415333
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0332145057618618, avg_mse: 0.045283667743206024
current test mse: 0.045284
Iteration: 2801, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4417845606803894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027471549808979034, decouple_loss:0.0012719942023977637
The modified gen p mean: 0.4420913755893707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027127189561724663, decouple_loss:0.0014965038280934095
The modified gen p mean: 0.4402734935283661, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028628481552004814, decouple_loss:0.0013791274977847934
Iteration: 2802, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44904354214668274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02626657858490944, decouple_loss:0.0014014528132975101
The modified gen p mean: 0.4454663097858429, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026821549981832504, decouple_loss:0.0014402830274775624
The modified gen p mean: 0.4454145133495331, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026811085641384125, decouple_loss:0.0015159102622419596
Iteration: 2803, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44668179750442505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026363272219896317, decouple_loss:0.0013655583607032895
The modified gen p mean: 0.4432640075683594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02713068202137947, decouple_loss:0.001388479140587151
The modified gen p mean: 0.44119465351104736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027662944048643112, decouple_loss:0.0014196670381352305
Iteration: 2804, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44492027163505554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02768891490995884, decouple_loss:0.0012713116593658924
The modified gen p mean: 0.44347038865089417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027971742674708366, decouple_loss:0.0013621788239106536
The modified gen p mean: 0.4422721266746521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027346527203917503, decouple_loss:0.001261683995835483
Iteration: 2805, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44437113404273987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02826336957514286, decouple_loss:0.001305551384575665
The modified gen p mean: 0.44952237606048584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026821652427315712, decouple_loss:0.001401733374223113
The modified gen p mean: 0.44512906670570374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026538332924246788, decouple_loss:0.0015017167897894979
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr.npz
NaN value num: 0
Iteration: 2806, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494621455669403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02646719478070736, decouple_loss:0.0015696492046117783
The modified gen p mean: 0.4516507089138031, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4517180025577545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02634115144610405, decouple_loss:0.001468104775995016
loss_pred:0.026739010587334633, decouple_loss:0.0014832684537395835
Iteration: 2807, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45176565647125244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02714662253856659, decouple_loss:0.0014485727297142148
The modified gen p mean: 0.44896814227104187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027798548340797424, decouple_loss:0.0013890101108700037
The modified gen p mean: 0.4537753760814667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027783889323472977, decouple_loss:0.0013717253459617496
Iteration: 2808, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44693681597709656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026407577097415924, decouple_loss:0.0013165492564439774
The modified gen p mean: 0.4544553756713867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027177171781659126, decouple_loss:0.0014578700065612793
The modified gen p mean: 0.4477463960647583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027438845485448837, decouple_loss:0.0013882265193387866
Iteration: 2809, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455043375492096, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44463810324668884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027516543865203857, decouple_loss:0.0014388073468580842
loss_pred:0.02837970107793808, decouple_loss:0.001536688068881631
The modified gen p mean: 0.4474015235900879, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027545712888240814, decouple_loss:0.0014645227929577231
Iteration: 2810, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460524618625641, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026460133492946625, decouple_loss:0.0015383356949314475
The modified gen p mean: 0.4439646303653717, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02753579244017601, decouple_loss:0.0013822222827002406
The modified gen p mean: 0.4435305595397949, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02880309522151947, decouple_loss:0.001696416875347495
2023-05-26 23:39:10 testing...
The modified gen p mean: 0.4488735496997833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03279487043619156, decouple_loss:0.0015876281540840864
The modified gen p mean: 0.447031706571579, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03297173231840134, decouple_loss:0.0016049747355282307
The modified gen p mean: 0.4489423632621765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034426186233758926, decouple_loss:0.0015637914184480906
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03347687050700188, avg_mse: 0.04576042294502258
current test mse: 0.04576
Iteration: 2811, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44576311111450195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025760546326637268, decouple_loss:0.0015402419958263636
The modified gen p mean: 0.4465339481830597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026152588427066803, decouple_loss:0.0014989981427788734
The modified gen p mean: 0.4462774097919464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026640821248292923, decouple_loss:0.0015338555676862597
Iteration: 2812, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44536298513412476, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44512078166007996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027356674894690514, decouple_loss:0.0014681355096399784
loss_pred:0.02931518666446209, decouple_loss:0.0014255271526053548
The modified gen p mean: 0.4484689235687256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02666485495865345, decouple_loss:0.001491224393248558
Iteration: 2813, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44559404253959656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02896345965564251, decouple_loss:0.0014458948280662298
The modified gen p mean: 0.4464183449745178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026750655844807625, decouple_loss:0.001573956455104053
The modified gen p mean: 0.4461266100406647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026590991765260696, decouple_loss:0.0013492233119904995
Iteration: 2814, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451944500207901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027822064235806465, decouple_loss:0.0016618266236037016
The modified gen p mean: 0.44750499725341797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029307659715414047, decouple_loss:0.0013974945759400725
The modified gen p mean: 0.4481752812862396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026866916567087173, decouple_loss:0.0013238491956144571
Iteration: 2815, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485901892185211, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027684303000569344, decouple_loss:0.001383231719955802
The modified gen p mean: 0.4495519995689392, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026990080252289772, decouple_loss:0.0013688481412827969
The modified gen p mean: 0.4497551918029785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02773808129131794, decouple_loss:0.0013841032050549984
Iteration: 2816, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45489171147346497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027248697355389595, decouple_loss:0.001649224665015936
The modified gen p mean: 0.4540537893772125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027922868728637695, decouple_loss:0.0017494655912742019
The modified gen p mean: 0.45547595620155334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027187170460820198, decouple_loss:0.0015207077376544476
Iteration: 2817, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4517465829849243, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02897939458489418, decouple_loss:0.001376303262077272
The modified gen p mean: 0.4509705603122711, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028705066069960594, decouple_loss:0.0014729765243828297
The modified gen p mean: 0.4552419185638428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026709234341979027, decouple_loss:0.001436847378499806
Iteration: 2818, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4523755609989166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026428814977407455, decouple_loss:0.0012918589636683464
The modified gen p mean: 0.45306575298309326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027542848140001297, decouple_loss:0.0013904026709496975
The modified gen p mean: 0.4562106430530548, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026195131242275238, decouple_loss:0.0015441235154867172
Iteration: 2819, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44960322976112366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02698182687163353, decouple_loss:0.0014845102559775114
The modified gen p mean: 0.4505881667137146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028675973415374756, decouple_loss:0.001435563201084733
The modified gen p mean: 0.44963860511779785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027060439810156822, decouple_loss:0.0014595328830182552
Iteration: 2820, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44823312759399414, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45082888007164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027942627668380737, decouple_loss:0.0014812247827649117
loss_pred:0.02725866064429283, decouple_loss:0.0015258798375725746
The modified gen p mean: 0.4490455687046051, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02687186375260353, decouple_loss:0.0014620848232880235
2023-05-26 23:43:17 testing...
The modified gen p mean: 0.4517526626586914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253611922264099, decouple_loss:0.0015878671547397971
The modified gen p mean: 0.4495425224304199, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0327281691133976, decouple_loss:0.0016070121200755239
The modified gen p mean: 0.4517515003681183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034189946949481964, decouple_loss:0.0015432065119966865
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03323037922382355, avg_mse: 0.04543614014983177
current test mse: 0.045436
Iteration: 2821, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501681923866272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026860425248742104, decouple_loss:0.0015761004760861397
The modified gen p mean: 0.44917577505111694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026051370427012444, decouple_loss:0.0014756664168089628
The modified gen p mean: 0.4489947557449341, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02719069831073284, decouple_loss:0.0013915210729464889
Iteration: 2822, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44382160902023315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027189496904611588, decouple_loss:0.0012875759275630116
The modified gen p mean: 0.4462478756904602, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02561337687075138, decouple_loss:0.001575091970153153
The modified gen p mean: 0.449226975440979, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025775831192731857, decouple_loss:0.0015411397907882929
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2823, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44672006368637085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03215111792087555, decouple_loss:0.0014193740207701921
The modified gen p mean: 0.4480104148387909, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44356048107147217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03179115429520607, decouple_loss:0.0014227443607524037
loss_pred:0.031023424118757248, decouple_loss:0.0012658273335546255
Iteration: 2824, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45079660415649414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03119555301964283, decouple_loss:0.0015256331535056233
The modified gen p mean: 0.4454554319381714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032497141510248184, decouple_loss:0.0014348126715049148
The modified gen p mean: 0.4441850185394287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03137952461838722, decouple_loss:0.00127699738368392
Iteration: 2825, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483988285064697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02995283715426922, decouple_loss:0.0013278513215482235
The modified gen p mean: 0.452616423368454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031377021223306656, decouple_loss:0.0016105355462059379
The modified gen p mean: 0.4478660523891449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03052942082285881, decouple_loss:0.0014718518359586596
Iteration: 2826, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4531782865524292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029999269172549248, decouple_loss:0.0014980115229263902
The modified gen p mean: 0.4502049684524536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029591122642159462, decouple_loss:0.0013847795780748129
The modified gen p mean: 0.45006558299064636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030132001265883446, decouple_loss:0.0014073716010898352
Iteration: 2827, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504907727241516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030865445733070374, decouple_loss:0.0013941916404291987
The modified gen p mean: 0.45128434896469116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03160269558429718, decouple_loss:0.0012955822749063373
The modified gen p mean: 0.4525253176689148, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030105283483862877, decouple_loss:0.001298587303608656
Iteration: 2828, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4520680904388428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031009873375296593, decouple_loss:0.0012582732597365975
The modified gen p mean: 0.4563900828361511, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03115810453891754, decouple_loss:0.0012587850214913487
The modified gen p mean: 0.4533853828907013, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031011171638965607, decouple_loss:0.0014114778023213148
Iteration: 2829, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.455729216337204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029853560030460358, decouple_loss:0.0013995226472616196
The modified gen p mean: 0.45480623841285706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03097447380423546, decouple_loss:0.0012644927483052015
The modified gen p mean: 0.45152273774147034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03179358318448067, decouple_loss:0.0012766927247866988
Iteration: 2830, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508521854877472, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030495502054691315, decouple_loss:0.0014697768492624164
The modified gen p mean: 0.45211726427078247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029981704428792, decouple_loss:0.0013483129441738129
The modified gen p mean: 0.454652339220047, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031892772763967514, decouple_loss:0.0014729805989190936
2023-05-26 23:48:06 testing...
The modified gen p mean: 0.4530355632305145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032073162496089935, decouple_loss:0.001543702557682991
The modified gen p mean: 0.4506649076938629, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03235530108213425, decouple_loss:0.0015018240083009005
The modified gen p mean: 0.45288151502609253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03375861421227455, decouple_loss:0.0015972643159329891
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032806407660245895, avg_mse: 0.04444209113717079
current test mse: 0.044442
Iteration: 2831, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45216187834739685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030505120754241943, decouple_loss:0.0014859377406537533
The modified gen p mean: 0.44626641273498535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033403925597667694, decouple_loss:0.0013753193197771907
The modified gen p mean: 0.4512650966644287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031073017045855522, decouple_loss:0.0014338769251480699
Iteration: 2832, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44480863213539124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030228495597839355, decouple_loss:0.0013599729863926768
The modified gen p mean: 0.4503830075263977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030414141714572906, decouple_loss:0.001528755179606378
The modified gen p mean: 0.449197381734848, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030596831813454628, decouple_loss:0.0015392618952319026
Iteration: 2833, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44376781582832336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030784979462623596, decouple_loss:0.0014174262760207057
The modified gen p mean: 0.4447360336780548, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03206178918480873, decouple_loss:0.0014685237547382712
The modified gen p mean: 0.44180092215538025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031528763473033905, decouple_loss:0.001393704442307353
Iteration: 2834, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4432757794857025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03038482367992401, decouple_loss:0.001263087964616716
The modified gen p mean: 0.44310206174850464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03323851898312569, decouple_loss:0.0012592582497745752
The modified gen p mean: 0.4439470171928406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03027428314089775, decouple_loss:0.001372592058032751
Iteration: 2835, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44597479701042175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029829593375325203, decouple_loss:0.0015779725508764386
The modified gen p mean: 0.4470430314540863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03194369003176689, decouple_loss:0.0014158023986965418
The modified gen p mean: 0.4484633505344391, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03119909204542637, decouple_loss:0.001696313964203
Iteration: 2836, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482691287994385, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45039013028144836, gen p mean: 0.0, mean p set: 0.448loss_pred:0.030742255970835686, decouple_loss:0.001627060235477984
loss_pred:0.030667351558804512, decouple_loss:0.0015852616634219885
The modified gen p mean: 0.4446169137954712, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0301394984126091, decouple_loss:0.001408606767654419
Iteration: 2837, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44673052430152893, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030956879258155823, decouple_loss:0.0012788078747689724
The modified gen p mean: 0.4446893036365509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030940143391489983, decouple_loss:0.0012277128407731652
The modified gen p mean: 0.4448552131652832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03147324547171593, decouple_loss:0.0014299433678388596
Iteration: 2838, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44813865423202515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031051499769091606, decouple_loss:0.0015598072204738855
The modified gen p mean: 0.44761428236961365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03190051019191742, decouple_loss:0.0014299952890723944
The modified gen p mean: 0.44653448462486267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03206018730998039, decouple_loss:0.0015103628393262625
Iteration: 2839, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45119884610176086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030196456238627434, decouple_loss:0.0014839950017631054
The modified gen p mean: 0.4494660794734955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0307831559330225, decouple_loss:0.0015875077806413174
The modified gen p mean: 0.4493328332901001, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030590517446398735, decouple_loss:0.0013560166116803885
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr.npz
NaN value num: 0
Iteration: 2840, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4529144763946533, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0268396008759737, decouple_loss:0.001574074849486351
The modified gen p mean: 0.44909176230430603, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4509353041648865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028704121708869934, decouple_loss:0.001356920343823731
loss_pred:0.029519658535718918, decouple_loss:0.0014791847206652164
2023-05-26 23:52:52 testing...
The modified gen p mean: 0.4548702836036682, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032167088240385056, decouple_loss:0.0015609691618010402
The modified gen p mean: 0.45468735694885254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03385764732956886, decouple_loss:0.0015586874214932323
The modified gen p mean: 0.45253488421440125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032347358763217926, decouple_loss:0.0015129082603380084
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0328679084777832, avg_mse: 0.04451639577746391
current test mse: 0.044516
Iteration: 2841, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45358702540397644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027939721941947937, decouple_loss:0.001491260714828968
The modified gen p mean: 0.44701823592185974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028461715206503868, decouple_loss:0.0015204797964543104
The modified gen p mean: 0.4544668197631836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027346305549144745, decouple_loss:0.0015920992009341717
Iteration: 2842, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468848407268524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03000045008957386, decouple_loss:0.0014850569423288107
The modified gen p mean: 0.4474514126777649, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02804461121559143, decouple_loss:0.0015460214344784617
The modified gen p mean: 0.4473005533218384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02825317718088627, decouple_loss:0.0017133384244516492
Iteration: 2843, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507692754268646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026248173788189888, decouple_loss:0.0016007233643904328
The modified gen p mean: 0.44574621319770813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028141291812062263, decouple_loss:0.0014298701426014304
The modified gen p mean: 0.44660961627960205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027025867253541946, decouple_loss:0.001476914738304913
Iteration: 2844, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456609785556793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028251100331544876, decouple_loss:0.001450962619856
The modified gen p mean: 0.4469996392726898, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028793940320611, decouple_loss:0.0014680041931569576
The modified gen p mean: 0.44234833121299744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02651277929544449, decouple_loss:0.0014717745361849666
Iteration: 2845, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460647404193878, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026473863050341606, decouple_loss:0.0015692966990172863
The modified gen p mean: 0.4452299475669861, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028819620609283447, decouple_loss:0.001372251776047051
The modified gen p mean: 0.4446878135204315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026493238285183907, decouple_loss:0.0015461469301953912
Iteration: 2846, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44432777166366577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026775281876325607, decouple_loss:0.0015285206027328968
The modified gen p mean: 0.44115886092185974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029228229075670242, decouple_loss:0.001426904578693211
The modified gen p mean: 0.4464229345321655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027496954426169395, decouple_loss:0.0016864424105733633
Iteration: 2847, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4407992959022522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028037013486027718, decouple_loss:0.0013365221675485373
The modified gen p mean: 0.4442892372608185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02884582057595253, decouple_loss:0.0013945071259513497
The modified gen p mean: 0.4438125789165497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028017321601510048, decouple_loss:0.0014339740155264735
Iteration: 2848, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458063244819641, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028915440663695335, decouple_loss:0.0014741788618266582
The modified gen p mean: 0.4444308876991272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028641806915402412, decouple_loss:0.0015557665610685945
The modified gen p mean: 0.4436550736427307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02731684409081936, decouple_loss:0.0013604596024379134
Iteration: 2849, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44825348258018494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02850239723920822, decouple_loss:0.001510786940343678
The modified gen p mean: 0.44855567812919617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02748921513557434, decouple_loss:0.0013466578675433993
The modified gen p mean: 0.45140859484672546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02572408691048622, decouple_loss:0.0014062761329114437
Iteration: 2850, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509579837322235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02833692915737629, decouple_loss:0.0014101361157372594
The modified gen p mean: 0.4484858214855194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028401892632246017, decouple_loss:0.0013514201855286956
The modified gen p mean: 0.45403996109962463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027374401688575745, decouple_loss:0.001544517814181745
2023-05-26 23:56:59 testing...
The modified gen p mean: 0.4574087858200073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032382782548666, decouple_loss:0.0015937663847580552
The modified gen p mean: 0.4553101062774658, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032581429928541183, decouple_loss:0.0014358034823089838
The modified gen p mean: 0.45731860399246216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033993709832429886, decouple_loss:0.0015838457038626075
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03306286409497261, avg_mse: 0.04496493935585022
current test mse: 0.044965
Iteration: 2851, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45436668395996094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02725381776690483, decouple_loss:0.0015695595648139715
The modified gen p mean: 0.4550800323486328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0278832595795393, decouple_loss:0.001673084800131619
The modified gen p mean: 0.45065590739250183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028860092163085938, decouple_loss:0.0013418893795460463
Iteration: 2852, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4561150372028351, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02671361155807972, decouple_loss:0.0015786349540576339
The modified gen p mean: 0.4510161280632019, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029057702049613, decouple_loss:0.0015521153109148145
The modified gen p mean: 0.4498994052410126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029031939804553986, decouple_loss:0.0014334291918203235
Iteration: 2853, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510965049266815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02995685301721096, decouple_loss:0.0014455808559432626
The modified gen p mean: 0.45116516947746277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028105178847908974, decouple_loss:0.001425042748451233
The modified gen p mean: 0.4522339999675751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02685278281569481, decouple_loss:0.0014483843697234988
Iteration: 2854, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507075846195221, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029352262616157532, decouple_loss:0.0015643571969121695
The modified gen p mean: 0.45284220576286316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026814747601747513, decouple_loss:0.0016264795558527112
The modified gen p mean: 0.4535895586013794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612324059009552, decouple_loss:0.001573415007442236
Iteration: 2855, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4525054693222046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02743356302380562, decouple_loss:0.0015052598901093006
The modified gen p mean: 0.44873079657554626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028239993378520012, decouple_loss:0.0013220930704846978
The modified gen p mean: 0.45198798179626465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02586759813129902, decouple_loss:0.0015366661828011274
Iteration: 2856, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44887441396713257, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028106721118092537, decouple_loss:0.001284086494706571
The modified gen p mean: 0.4482879936695099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027102436870336533, decouple_loss:0.0013425005599856377
The modified gen p mean: 0.4479995667934418, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02714000642299652, decouple_loss:0.0013965580146759748
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2857, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445499062538147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029317794367671013, decouple_loss:0.0014301894698292017
The modified gen p mean: 0.4499709904193878, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44690150022506714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028571423143148422, decouple_loss:0.0013959851348772645
loss_pred:0.026755915954709053, decouple_loss:0.001668263808824122
Iteration: 2858, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4435926377773285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02895631082355976, decouple_loss:0.0012744187843054533
The modified gen p mean: 0.44863075017929077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026897955685853958, decouple_loss:0.0014581199502572417
The modified gen p mean: 0.4473327696323395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02665604092180729, decouple_loss:0.0014671904500573874
Iteration: 2859, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44773533940315247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02728079818189144, decouple_loss:0.0014098440296947956
The modified gen p mean: 0.44756200909614563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026758411899209023, decouple_loss:0.001495157484896481
The modified gen p mean: 0.44838544726371765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027810946106910706, decouple_loss:0.001355924759991467
Iteration: 2860, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44571688771247864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025754231959581375, decouple_loss:0.0014649018412455916
The modified gen p mean: 0.4441213607788086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02806561253964901, decouple_loss:0.001303293975070119
The modified gen p mean: 0.44842830300331116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028598759323358536, decouple_loss:0.0012238705530762672
2023-05-27 00:01:46 testing...
The modified gen p mean: 0.45017364621162415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03239326924085617, decouple_loss:0.0016007341910153627
The modified gen p mean: 0.4478456974029541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261398896574974, decouple_loss:0.0014412624295800924
The modified gen p mean: 0.4500936269760132, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03400730341672897, decouple_loss:0.001585481222718954
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03308197855949402, avg_mse: 0.045045748353004456
current test mse: 0.045046
Iteration: 2861, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485476315021515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02643461339175701, decouple_loss:0.0013515809550881386
The modified gen p mean: 0.44780468940734863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02637680061161518, decouple_loss:0.0014385721879079938
The modified gen p mean: 0.44665074348449707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026338160037994385, decouple_loss:0.0013865482760593295
Iteration: 2862, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44879838824272156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028017057105898857, decouple_loss:0.00132479309104383
The modified gen p mean: 0.4430535137653351, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02843073382973671, decouple_loss:0.0014126781607046723
The modified gen p mean: 0.4470566511154175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027785716578364372, decouple_loss:0.0013433244312182069
Iteration: 2863, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44794049859046936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02723684161901474, decouple_loss:0.0013612719485536218
The modified gen p mean: 0.4438747763633728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028569420799613, decouple_loss:0.0014316894812509418
The modified gen p mean: 0.44691911339759827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026666468009352684, decouple_loss:0.0014481188263744116
Iteration: 2864, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44983890652656555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027473049238324165, decouple_loss:0.0013498259941115975
The modified gen p mean: 0.4486766457557678, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026598824188113213, decouple_loss:0.001456803292967379
The modified gen p mean: 0.4446735382080078, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027594294399023056, decouple_loss:0.001236491370946169
Iteration: 2865, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483109712600708, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027338260784745216, decouple_loss:0.0013374713016673923
The modified gen p mean: 0.4438648819923401, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02862369641661644, decouple_loss:0.001325742225162685
The modified gen p mean: 0.448447585105896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027002789080142975, decouple_loss:0.001404380425810814
Iteration: 2866, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44565466046333313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027922067791223526, decouple_loss:0.0013449449324980378
The modified gen p mean: 0.4474281668663025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026247160509228706, decouple_loss:0.001468873000703752
The modified gen p mean: 0.4450198709964752, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028220275416970253, decouple_loss:0.001357046770863235
Iteration: 2867, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448251873254776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02774433046579361, decouple_loss:0.0014086120063439012
The modified gen p mean: 0.44617748260498047, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028051381930708885, decouple_loss:0.0014455857453867793
The modified gen p mean: 0.4497435688972473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722497098147869, decouple_loss:0.001406512106768787
Iteration: 2868, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44742026925086975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02642730250954628, decouple_loss:0.0013933918671682477
The modified gen p mean: 0.44576460123062134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027448946610093117, decouple_loss:0.0013944549718871713
The modified gen p mean: 0.4488905668258667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026907775551080704, decouple_loss:0.0015278075588867068
Iteration: 2869, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44780534505844116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025992009788751602, decouple_loss:0.0015377877280116081
The modified gen p mean: 0.44571805000305176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02644983120262623, decouple_loss:0.0014772493159398437
The modified gen p mean: 0.4464050829410553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026668362319469452, decouple_loss:0.0015250514261424541
Iteration: 2870, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439564049243927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027902761474251747, decouple_loss:0.0014510512119159102
The modified gen p mean: 0.44537442922592163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027723684906959534, decouple_loss:0.0015331929316744208
The modified gen p mean: 0.4439423680305481, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0279072318226099, decouple_loss:0.0015197363682091236
2023-05-27 00:05:53 testing...
The modified gen p mean: 0.45075076818466187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03275204449892044, decouple_loss:0.0016173319891095161
The modified gen p mean: 0.4507375657558441, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03443465754389763, decouple_loss:0.001654072548262775
The modified gen p mean: 0.4484025537967682, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033099278807640076, decouple_loss:0.0016566634876653552
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03351079672574997, avg_mse: 0.04583616554737091
current test mse: 0.045836
Iteration: 2871, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446618854999542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02785317599773407, decouple_loss:0.0014352439902722836
The modified gen p mean: 0.44252845644950867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028103042393922806, decouple_loss:0.0014000211376696825
The modified gen p mean: 0.4483499526977539, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026726875454187393, decouple_loss:0.0015006079338490963
Iteration: 2872, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446819007396698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027715669944882393, decouple_loss:0.0014055912615731359
The modified gen p mean: 0.44441720843315125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0253033135086298, decouple_loss:0.0015751764876767993
The modified gen p mean: 0.44277676939964294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02720441110432148, decouple_loss:0.0013913186267018318
Iteration: 2873, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460415542125702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02709967829287052, decouple_loss:0.0016310344217345119
The modified gen p mean: 0.4428127110004425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028257012367248535, decouple_loss:0.0016518216580152512
The modified gen p mean: 0.44354915618896484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027607420459389687, decouple_loss:0.0012714301701635122
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2874, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445590615272522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029089223593473434, decouple_loss:0.001438040635548532
The modified gen p mean: 0.4494144916534424, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44921907782554626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027839770540595055, decouple_loss:0.0016977733466774225
loss_pred:0.02738700993359089, decouple_loss:0.0016103879315778613
Iteration: 2875, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493023455142975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02624998800456524, decouple_loss:0.0015433143125846982
The modified gen p mean: 0.4482150971889496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026735255494713783, decouple_loss:0.0014071499463170767
The modified gen p mean: 0.4473579525947571, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02724606730043888, decouple_loss:0.0013586552813649178
Iteration: 2876, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44797322154045105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026960885152220726, decouple_loss:0.001337691443040967
The modified gen p mean: 0.4496602714061737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028474146500229836, decouple_loss:0.0013168749865144491
The modified gen p mean: 0.44733792543411255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028325296938419342, decouple_loss:0.0015089837834239006
Iteration: 2877, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44844597578048706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025870515033602715, decouple_loss:0.001414734753780067
The modified gen p mean: 0.45136523246765137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02551305666565895, decouple_loss:0.0013996846973896027
The modified gen p mean: 0.4491008520126343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02613857015967369, decouple_loss:0.0015605551889166236
Iteration: 2878, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44732150435447693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029157700017094612, decouple_loss:0.0014816838083788753
The modified gen p mean: 0.4478159546852112, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027085157111287117, decouple_loss:0.0012237174669280648
The modified gen p mean: 0.45118072628974915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027134563773870468, decouple_loss:0.0013951208675280213
Iteration: 2879, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44761887192726135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02942834608256817, decouple_loss:0.0015706053236499429
The modified gen p mean: 0.44637972116470337, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028284547850489616, decouple_loss:0.0015390568878501654
The modified gen p mean: 0.4511910080909729, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026273852214217186, decouple_loss:0.0014370166463777423
Iteration: 2880, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44701775908470154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025878408923745155, decouple_loss:0.0014808939304202795
The modified gen p mean: 0.4468558430671692, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028864525258541107, decouple_loss:0.0014416223857551813
The modified gen p mean: 0.4486566185951233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0262896791100502, decouple_loss:0.0014475247589871287
2023-05-27 00:10:38 testing...
The modified gen p mean: 0.4515974521636963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03316476196050644, decouple_loss:0.0016121558146551251
The modified gen p mean: 0.44917190074920654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03349169343709946, decouple_loss:0.0015566692454740405
The modified gen p mean: 0.45170581340789795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035083744674921036, decouple_loss:0.0016848574159666896
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033994294703006744, avg_mse: 0.04662647843360901
current test mse: 0.046626
Iteration: 2881, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44697314500808716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02791796438395977, decouple_loss:0.0012679161736741662
The modified gen p mean: 0.4492607116699219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02778550051152706, decouple_loss:0.0014392080483958125
The modified gen p mean: 0.44984495639801025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02572917938232422, decouple_loss:0.0015053395181894302
Iteration: 2882, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4448568820953369, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028362011536955833, decouple_loss:0.0013758407440036535
The modified gen p mean: 0.4471391439437866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027376526966691017, decouple_loss:0.001391767873428762
The modified gen p mean: 0.44525378942489624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02962697669863701, decouple_loss:0.001553807989694178
Iteration: 2883, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477463960647583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028228694573044777, decouple_loss:0.0014121963176876307
The modified gen p mean: 0.4480352997779846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025965237990021706, decouple_loss:0.0016703706933185458
The modified gen p mean: 0.44518810510635376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02630394883453846, decouple_loss:0.0014798613265156746
Iteration: 2884, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461979269981384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027098190039396286, decouple_loss:0.001501582795754075
The modified gen p mean: 0.4490441679954529, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025791632011532784, decouple_loss:0.0016497750766575336
The modified gen p mean: 0.4436235725879669, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02720443718135357, decouple_loss:0.001295029534958303
Iteration: 2885, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44785478711128235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02864209935069084, decouple_loss:0.001249315100722015
The modified gen p mean: 0.44938305020332336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026131298393011093, decouple_loss:0.001534525421448052
The modified gen p mean: 0.4468002915382385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025410663336515427, decouple_loss:0.001364049850963056
Iteration: 2886, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460984170436859, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02747136726975441, decouple_loss:0.0012944006593897939
The modified gen p mean: 0.4461086392402649, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027086004614830017, decouple_loss:0.0012473087990656495
The modified gen p mean: 0.4492572844028473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026679620146751404, decouple_loss:0.0013381096068769693
Iteration: 2887, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470026195049286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028839021921157837, decouple_loss:0.001414945349097252
The modified gen p mean: 0.4497007429599762, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02605031058192253, decouple_loss:0.0013245966983959079
The modified gen p mean: 0.44630175828933716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02750897966325283, decouple_loss:0.0014060483081266284
Iteration: 2888, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490652084350586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026066618040204048, decouple_loss:0.0014600433642044663
The modified gen p mean: 0.44719240069389343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027447916567325592, decouple_loss:0.001226104679517448
The modified gen p mean: 0.4463941156864166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02741621434688568, decouple_loss:0.0013973970199003816
Iteration: 2889, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516735076904297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026822948828339577, decouple_loss:0.0013743145391345024
The modified gen p mean: 0.45135030150413513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02674815058708191, decouple_loss:0.0014949674950912595
The modified gen p mean: 0.4482695460319519, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027441300451755524, decouple_loss:0.0014842357486486435
Iteration: 2890, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45050710439682007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026039907708764076, decouple_loss:0.0013091710861772299
The modified gen p mean: 0.45193520188331604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026871884241700172, decouple_loss:0.00126614049077034
The modified gen p mean: 0.44746068120002747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029294922947883606, decouple_loss:0.0013671423075720668
2023-05-27 00:14:46 testing...
The modified gen p mean: 0.45416030287742615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03272825479507446, decouple_loss:0.001571181113831699
The modified gen p mean: 0.451850026845932, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033129140734672546, decouple_loss:0.0014504952123388648
The modified gen p mean: 0.45418092608451843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034620027989149094, decouple_loss:0.0016165743581950665
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03356977924704552, avg_mse: 0.045873627066612244
current test mse: 0.045874
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2891, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45092830061912537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025458792224526405, decouple_loss:0.0015426051104441285
The modified gen p mean: 0.4469645023345947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02685241401195526, decouple_loss:0.0013388987863436341
The modified gen p mean: 0.4465233087539673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027733439579606056, decouple_loss:0.001466176938265562
Iteration: 2892, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44705021381378174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026391098275780678, decouple_loss:0.0015308093279600143
The modified gen p mean: 0.45271003246307373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024985866621136665, decouple_loss:0.0013192257611081004
The modified gen p mean: 0.45416244864463806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025655178353190422, decouple_loss:0.0014357997570186853
Iteration: 2893, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4437323212623596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026540368795394897, decouple_loss:0.0013205171562731266
The modified gen p mean: 0.4484312832355499, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025596609339118004, decouple_loss:0.0013849379029124975
The modified gen p mean: 0.45310160517692566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610704116523266, decouple_loss:0.0016653093043714762
Iteration: 2894, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451703727245331, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026892993599176407, decouple_loss:0.0013133320026099682
The modified gen p mean: 0.44598233699798584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025187114253640175, decouple_loss:0.001397332758642733
The modified gen p mean: 0.4450748562812805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02696995437145233, decouple_loss:0.0012859649723395705
Iteration: 2895, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503285586833954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02617952972650528, decouple_loss:0.001384936855174601
The modified gen p mean: 0.44505006074905396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027117038145661354, decouple_loss:0.0014610127545893192
The modified gen p mean: 0.4465210437774658, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025946665555238724, decouple_loss:0.0014045762363821268
Iteration: 2896, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461243152618408, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026260431855916977, decouple_loss:0.0013940255157649517
The modified gen p mean: 0.44557806849479675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02698560245335102, decouple_loss:0.0014660395681858063
The modified gen p mean: 0.44910094141960144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02641982026398182, decouple_loss:0.0014592375373467803
Iteration: 2897, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455316960811615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820533514022827, decouple_loss:0.0014504633145406842
The modified gen p mean: 0.4460308253765106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02531542256474495, decouple_loss:0.0014937075320631266
The modified gen p mean: 0.443294882774353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026582112535834312, decouple_loss:0.0013887298991903663
Iteration: 2898, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45122089982032776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025070790201425552, decouple_loss:0.0013448686804622412
The modified gen p mean: 0.44717276096343994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026817698031663895, decouple_loss:0.001307639409787953
The modified gen p mean: 0.45073243975639343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0251498781144619, decouple_loss:0.0013551012380048633
Iteration: 2899, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441485106945038, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02754361368715763, decouple_loss:0.0013548691058531404
The modified gen p mean: 0.45041748881340027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026322899386286736, decouple_loss:0.0015387653838843107
The modified gen p mean: 0.44554775953292847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0273006409406662, decouple_loss:0.001420114072971046
Iteration: 2900, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44526800513267517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028286637738347054, decouple_loss:0.0014042238472029567
The modified gen p mean: 0.4431379735469818, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02785136178135872, decouple_loss:0.0012024808675050735
The modified gen p mean: 0.443477600812912, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02772652544081211, decouple_loss:0.0012914127437397838
2023-05-27 00:19:35 testing...
The modified gen p mean: 0.452048659324646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033514827489852905, decouple_loss:0.0016243451973423362
The modified gen p mean: 0.4497738480567932, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033602919429540634, decouple_loss:0.0014333976432681084
The modified gen p mean: 0.45224037766456604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03521333262324333, decouple_loss:0.001656948123127222
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03418894112110138, avg_mse: 0.04685508832335472
current test mse: 0.046855
Iteration: 2901, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44504857063293457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028129998594522476, decouple_loss:0.0013964599929749966
The modified gen p mean: 0.44572433829307556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02670603059232235, decouple_loss:0.0014188659843057394
The modified gen p mean: 0.4430652856826782, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026830393821001053, decouple_loss:0.0013198025990277529
Iteration: 2902, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485364556312561, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02730773575603962, decouple_loss:0.001334896543994546
The modified gen p mean: 0.44303253293037415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027102764695882797, decouple_loss:0.0012696807971224189
The modified gen p mean: 0.44583937525749207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02500755526125431, decouple_loss:0.0014005731791257858
Iteration: 2903, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460420608520508, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02639157325029373, decouple_loss:0.0013296757824718952
The modified gen p mean: 0.45271140336990356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025151586160063744, decouple_loss:0.001375522930175066
The modified gen p mean: 0.44579392671585083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690880000591278, decouple_loss:0.0014175194082781672
Iteration: 2904, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44499802589416504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027139807119965553, decouple_loss:0.0012784410500898957
The modified gen p mean: 0.44831839203834534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025424623861908913, decouple_loss:0.0013276649406179786
The modified gen p mean: 0.44581761956214905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027190499007701874, decouple_loss:0.0012610252015292645
Iteration: 2905, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44490480422973633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027396319434046745, decouple_loss:0.0013931214343756437
The modified gen p mean: 0.44925516843795776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026675183326005936, decouple_loss:0.0013836288126185536
The modified gen p mean: 0.44846203923225403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026410458609461784, decouple_loss:0.0014083955902606249
Iteration: 2906, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467485249042511, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026893142610788345, decouple_loss:0.0014633069513365626
The modified gen p mean: 0.4462239742279053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02723383717238903, decouple_loss:0.0013384833000600338
The modified gen p mean: 0.4543018043041229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025159992277622223, decouple_loss:0.0014230571687221527
Iteration: 2907, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477621018886566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02535368502140045, decouple_loss:0.0013168971054255962
The modified gen p mean: 0.44780614972114563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026457251980900764, decouple_loss:0.0013410380342975259
The modified gen p mean: 0.4528595507144928, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025158297270536423, decouple_loss:0.0014372385339811444
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2908, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461376965045929, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027628125622868538, decouple_loss:0.0014226424973458052
The modified gen p mean: 0.4463341534137726, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44899991154670715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027414901182055473, decouple_loss:0.0012655905447900295
loss_pred:0.02578083612024784, decouple_loss:0.0014170417562127113
Iteration: 2909, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468111991882324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027226779609918594, decouple_loss:0.0012222027871757746
The modified gen p mean: 0.44866180419921875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026439769193530083, decouple_loss:0.0013647829182446003
The modified gen p mean: 0.44847002625465393, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02559502422809601, decouple_loss:0.0014870816376060247
Iteration: 2910, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44690993428230286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027086148038506508, decouple_loss:0.0012789448956027627
The modified gen p mean: 0.45009419322013855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026633791625499725, decouple_loss:0.0013294899836182594
The modified gen p mean: 0.44557076692581177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028023777529597282, decouple_loss:0.0013930484419688582
2023-05-27 00:24:35 testing...
The modified gen p mean: 0.45119014382362366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03298879414796829, decouple_loss:0.001568966661579907
The modified gen p mean: 0.44902917742729187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033026352524757385, decouple_loss:0.0014037267537787557
The modified gen p mean: 0.45111215114593506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03461597487330437, decouple_loss:0.0015658042393624783
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03361935168504715, avg_mse: 0.04593385383486748
current test mse: 0.045934
Iteration: 2911, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504012167453766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026621749624609947, decouple_loss:0.001347299781627953
The modified gen p mean: 0.44731390476226807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027307122945785522, decouple_loss:0.0013100792421028018
The modified gen p mean: 0.44560837745666504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027441969141364098, decouple_loss:0.001314403023570776
Iteration: 2912, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4511125683784485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026674173772335052, decouple_loss:0.0014807733241468668
The modified gen p mean: 0.4467960298061371, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02594992145895958, decouple_loss:0.0015105715719982982
The modified gen p mean: 0.4445267915725708, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026509230956435204, decouple_loss:0.0013580326922237873
Iteration: 2913, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44467976689338684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02734011970460415, decouple_loss:0.001432068762369454
The modified gen p mean: 0.45063459873199463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0270684864372015, decouple_loss:0.0012666898546740413
The modified gen p mean: 0.44692832231521606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02774120308458805, decouple_loss:0.0013494060840457678
Iteration: 2914, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445089101791382, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027009446173906326, decouple_loss:0.0013034007279202342
The modified gen p mean: 0.44628626108169556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027514947578310966, decouple_loss:0.0013866351218894124
The modified gen p mean: 0.4443734586238861, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02713477984070778, decouple_loss:0.001291904947720468
Iteration: 2915, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44614970684051514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02713494375348091, decouple_loss:0.0014658143045380712
The modified gen p mean: 0.44744372367858887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02679087221622467, decouple_loss:0.0013879542239010334
The modified gen p mean: 0.4457134008407593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026775280013680458, decouple_loss:0.001371209044009447
Iteration: 2916, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44537436962127686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0273688156157732, decouple_loss:0.0013582169776782393
The modified gen p mean: 0.44779452681541443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02700541727244854, decouple_loss:0.001434019417501986
The modified gen p mean: 0.44744327664375305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027561746537685394, decouple_loss:0.0013588620349764824
Iteration: 2917, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44756433367729187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028054943308234215, decouple_loss:0.0014506623847410083
The modified gen p mean: 0.4447219967842102, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027258332818746567, decouple_loss:0.00133419968187809
The modified gen p mean: 0.45012134313583374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026157569140195847, decouple_loss:0.0012785412836819887
Iteration: 2918, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44617605209350586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026854734867811203, decouple_loss:0.0012022408191114664
The modified gen p mean: 0.4479043483734131, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673482522368431, decouple_loss:0.0013004345819354057
The modified gen p mean: 0.4441739618778229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02692684344947338, decouple_loss:0.0013361391611397266
Iteration: 2919, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445483386516571, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44541019201278687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026844358071684837, decouple_loss:0.0013199831591919065
loss_pred:0.026992980390787125, decouple_loss:0.0015010293573141098
The modified gen p mean: 0.45089542865753174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026602571830153465, decouple_loss:0.0012689684517681599
Iteration: 2920, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438015818595886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026528403162956238, decouple_loss:0.0012957670260220766
The modified gen p mean: 0.444897323846817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02842022478580475, decouple_loss:0.001298140618018806
The modified gen p mean: 0.44513052701950073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02787739969789982, decouple_loss:0.00136430817656219
2023-05-27 00:28:41 testing...
The modified gen p mean: 0.45149898529052734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03402313217520714, decouple_loss:0.0016024172073230147
The modified gen p mean: 0.4494593143463135, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4516869783401489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033930618315935135, decouple_loss:0.0014278427697718143
loss_pred:0.03572786599397659, decouple_loss:0.001615659799426794
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.034637972712516785, avg_mse: 0.047618333250284195
current test mse: 0.047618
Iteration: 2921, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45017874240875244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02599397301673889, decouple_loss:0.001511928392574191
The modified gen p mean: 0.4479674696922302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026769759133458138, decouple_loss:0.0013683242723345757
The modified gen p mean: 0.44593116641044617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0265254657715559, decouple_loss:0.0014243049081414938
Iteration: 2922, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44834062457084656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02597750723361969, decouple_loss:0.0014170319773256779
The modified gen p mean: 0.44556522369384766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0278589129447937, decouple_loss:0.0014061135007068515
The modified gen p mean: 0.4510948359966278, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02624088153243065, decouple_loss:0.0013285370077937841
Iteration: 2923, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488748610019684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026629501953721046, decouple_loss:0.0015302004758268595
The modified gen p mean: 0.44604694843292236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027986515313386917, decouple_loss:0.001227117609232664
The modified gen p mean: 0.4494195878505707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02638143301010132, decouple_loss:0.0014012116007506847
Iteration: 2924, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493023753166199, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026136960834264755, decouple_loss:0.0013405897188931704
The modified gen p mean: 0.44850394129753113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026308298110961914, decouple_loss:0.0014105801237747073
The modified gen p mean: 0.4486144781112671, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02641877718269825, decouple_loss:0.001356761553324759
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr_shift3.npz
NaN value num: 0
Iteration: 2925, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44851452112197876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031495776027441025, decouple_loss:0.001271144370548427
The modified gen p mean: 0.4513077735900879, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4460964500904083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030676867812871933, decouple_loss:0.0013839214807376266
loss_pred:0.030727699398994446, decouple_loss:0.0014099309919402003
Iteration: 2926, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44887813925743103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031571924686431885, decouple_loss:0.0014247369254007936
The modified gen p mean: 0.454474538564682, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030779795721173286, decouple_loss:0.0015180233167484403
The modified gen p mean: 0.45026132464408875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03066474385559559, decouple_loss:0.0012526294449344277
Iteration: 2927, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4546249806880951, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030868088826537132, decouple_loss:0.0013980916701257229
The modified gen p mean: 0.45561620593070984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028838764876127243, decouple_loss:0.001328289625234902
The modified gen p mean: 0.45055076479911804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030456800013780594, decouple_loss:0.0012526034843176603
Iteration: 2928, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45592355728149414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03176042065024376, decouple_loss:0.001328981132246554
The modified gen p mean: 0.4510098099708557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03200129419565201, decouple_loss:0.0013191142352297902
The modified gen p mean: 0.45462071895599365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02999095246195793, decouple_loss:0.0014749708352610469
Iteration: 2929, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45501282811164856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030959391966462135, decouple_loss:0.0012347581796348095
The modified gen p mean: 0.44932517409324646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0295193400233984, decouple_loss:0.0012539065210148692
The modified gen p mean: 0.4506778120994568, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030902300029993057, decouple_loss:0.0011741607449948788
Iteration: 2930, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503863751888275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031221775338053703, decouple_loss:0.0013603719417005777
The modified gen p mean: 0.44984129071235657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031063197180628777, decouple_loss:0.0013824159977957606
The modified gen p mean: 0.4501197338104248, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029560623690485954, decouple_loss:0.0013297797413542867
2023-05-27 00:33:30 testing...
The modified gen p mean: 0.451783686876297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230159729719162, decouple_loss:0.0014591393992304802
The modified gen p mean: 0.4498465359210968, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03245588019490242, decouple_loss:0.0013411093968898058
The modified gen p mean: 0.451703280210495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03380276635289192, decouple_loss:0.0014955791411921382
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032925013452768326, avg_mse: 0.04460558667778969
current test mse: 0.044606
Iteration: 2931, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476979374885559, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03130575641989708, decouple_loss:0.0013869332615286112
The modified gen p mean: 0.45012757182121277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029632944613695145, decouple_loss:0.0013099723728373647
The modified gen p mean: 0.44628310203552246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031877126544713974, decouple_loss:0.0012369868345558643
Iteration: 2932, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44625088572502136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030910242348909378, decouple_loss:0.0013802619650959969
The modified gen p mean: 0.4472266435623169, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03057931177318096, decouple_loss:0.001346767763607204
The modified gen p mean: 0.44852152466773987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029986048117280006, decouple_loss:0.001310699270106852
Iteration: 2933, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466795325279236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03170565515756607, decouple_loss:0.0013576534111052752
The modified gen p mean: 0.45041292905807495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029707418754696846, decouple_loss:0.0014158996054902673
The modified gen p mean: 0.4482339322566986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029817556962370872, decouple_loss:0.0013127800775691867
Iteration: 2934, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44753187894821167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03030610829591751, decouple_loss:0.0013340550940483809
The modified gen p mean: 0.45004594326019287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02992866188287735, decouple_loss:0.001297642826102674
The modified gen p mean: 0.446056604385376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030732683837413788, decouple_loss:0.0013003988424316049
Iteration: 2935, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471001923084259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03134334087371826, decouple_loss:0.001323756412602961
The modified gen p mean: 0.44805997610092163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029752783477306366, decouple_loss:0.0013158280635252595
The modified gen p mean: 0.44658327102661133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03045700676739216, decouple_loss:0.0012962674954906106
Iteration: 2936, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509027600288391, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030696187168359756, decouple_loss:0.0013244792353361845
The modified gen p mean: 0.44869741797447205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030191540718078613, decouple_loss:0.001221038051880896
The modified gen p mean: 0.4496902525424957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031676556915044785, decouple_loss:0.0012817161623388529
Iteration: 2937, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502621591091156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03013409674167633, decouple_loss:0.001250831875950098
The modified gen p mean: 0.4508116543292999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030248276889324188, decouple_loss:0.0012974413111805916
The modified gen p mean: 0.45107266306877136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029225343838334084, decouple_loss:0.0013833089033141732
Iteration: 2938, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481622278690338, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03159267455339432, decouple_loss:0.001282332930713892
The modified gen p mean: 0.4509712755680084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029420528560876846, decouple_loss:0.0014880846720188856
The modified gen p mean: 0.45012927055358887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030985193327069283, decouple_loss:0.0012738427612930536
Iteration: 2939, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506935477256775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029956623911857605, decouple_loss:0.0014873581239953637
The modified gen p mean: 0.4498729109764099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030316486954689026, decouple_loss:0.0012933871475979686
The modified gen p mean: 0.45016244053840637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02851131185889244, decouple_loss:0.00138186349067837
Iteration: 2940, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475692808628082, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03222700580954552, decouple_loss:0.001199116581119597
The modified gen p mean: 0.44832080602645874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028798384591937065, decouple_loss:0.0013475501909852028
The modified gen p mean: 0.45205751061439514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030440764501690865, decouple_loss:0.001572916517034173
2023-05-27 00:37:37 testing...
The modified gen p mean: 0.4521886706352234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032189708203077316, decouple_loss:0.0014417950296774507
The modified gen p mean: 0.45212027430534363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033831097185611725, decouple_loss:0.0015413259388878942
The modified gen p mean: 0.450350284576416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03258842974901199, decouple_loss:0.0014734882861375809
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03294402360916138, avg_mse: 0.0446840301156044
current test mse: 0.044684
Iteration: 2941, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45152243971824646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029410673305392265, decouple_loss:0.0013364468468353152
The modified gen p mean: 0.4504898190498352, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02945575676858425, decouple_loss:0.0015258225612342358
The modified gen p mean: 0.4503262937068939, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03024500608444214, decouple_loss:0.001368252676911652
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr.npz
NaN value num: 0
Iteration: 2942, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474095106124878, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0297255776822567, decouple_loss:0.0013556549092754722
The modified gen p mean: 0.4470950961112976, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4495866894721985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030342133715748787, decouple_loss:0.001319004106335342
loss_pred:0.030700767412781715, decouple_loss:0.001268613850697875
Iteration: 2943, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45118287205696106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02970917895436287, decouple_loss:0.0014513731002807617
The modified gen p mean: 0.4468822181224823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029425306245684624, decouple_loss:0.0013868672540411353
The modified gen p mean: 0.449063777923584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030131641775369644, decouple_loss:0.0014431329909712076
Iteration: 2944, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44635888934135437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030179094523191452, decouple_loss:0.0015474692918360233
The modified gen p mean: 0.45118096470832825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02906038984656334, decouple_loss:0.001353821950033307
The modified gen p mean: 0.44683364033699036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029913265258073807, decouple_loss:0.001386440941132605
Iteration: 2945, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44662541151046753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030137615278363228, decouple_loss:0.001354915089905262
The modified gen p mean: 0.45075684785842896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030348367989063263, decouple_loss:0.0013871180126443505
The modified gen p mean: 0.45094895362854004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029333889484405518, decouple_loss:0.0014040126698091626
Iteration: 2946, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45059165358543396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03063647449016571, decouple_loss:0.0012886634794995189
The modified gen p mean: 0.4501071572303772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030507877469062805, decouple_loss:0.0013193722115829587
The modified gen p mean: 0.44818949699401855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03138047829270363, decouple_loss:0.0015312503091990948
Iteration: 2947, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44911763072013855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029512031003832817, decouple_loss:0.0013790574157610536
The modified gen p mean: 0.4485708773136139, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030207738280296326, decouple_loss:0.0012866751058027148
The modified gen p mean: 0.4516846239566803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02880876511335373, decouple_loss:0.0015380991389974952
Iteration: 2948, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501233994960785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029516125097870827, decouple_loss:0.0014437964418902993
The modified gen p mean: 0.45105522871017456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02977055311203003, decouple_loss:0.0014489693567156792
The modified gen p mean: 0.45300939679145813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029635321348905563, decouple_loss:0.0014686099020764232
Iteration: 2949, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512004554271698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028692740947008133, decouple_loss:0.001251191832125187
The modified gen p mean: 0.4509243071079254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029057327657938004, decouple_loss:0.0013780916342511773
The modified gen p mean: 0.453086793422699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030135756358504295, decouple_loss:0.0014710924588143826
Iteration: 2950, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45104390382766724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03138286992907524, decouple_loss:0.001329268328845501
The modified gen p mean: 0.45068979263305664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030164062976837158, decouple_loss:0.0014776986790820956
The modified gen p mean: 0.45356953144073486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030109956860542297, decouple_loss:0.0014122225111350417
2023-05-27 00:42:24 testing...
The modified gen p mean: 0.4554033875465393, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03206108510494232, decouple_loss:0.001537861186079681
The modified gen p mean: 0.4553903341293335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03380942344665527, decouple_loss:0.0015553537523373961
The modified gen p mean: 0.4536861181259155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253984451293945, decouple_loss:0.0014542676508426666
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03287924453616142, avg_mse: 0.044542863965034485
current test mse: 0.044543
Iteration: 2951, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4523397982120514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03119099885225296, decouple_loss:0.0014015247579663992
The modified gen p mean: 0.4494404196739197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02854936011135578, decouple_loss:0.00144619878847152
The modified gen p mean: 0.45102784037590027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029919156804680824, decouple_loss:0.0013736370019614697
Iteration: 2952, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44930627942085266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029019707813858986, decouple_loss:0.0014265314675867558
The modified gen p mean: 0.4492710530757904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028992926701903343, decouple_loss:0.001481824554502964
The modified gen p mean: 0.4467129409313202, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029513228684663773, decouple_loss:0.001410320051945746
Iteration: 2953, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442073404788971, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0298064686357975, decouple_loss:0.001323361648246646
The modified gen p mean: 0.44751355051994324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028627175837755203, decouple_loss:0.001405597198754549
The modified gen p mean: 0.4447225034236908, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029813073575496674, decouple_loss:0.0014256777940317988
Iteration: 2954, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44598087668418884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03009338490664959, decouple_loss:0.0013580573722720146
The modified gen p mean: 0.44497209787368774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029521219432353973, decouple_loss:0.0012449378846213222
The modified gen p mean: 0.4441527724266052, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03020414523780346, decouple_loss:0.0012926445342600346
Iteration: 2955, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4431321918964386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029222995042800903, decouple_loss:0.0015958583680912852
The modified gen p mean: 0.4404946267604828, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030206721276044846, decouple_loss:0.0014169649221003056
The modified gen p mean: 0.44323036074638367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030729049816727638, decouple_loss:0.0013647692976519465
Iteration: 2956, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44650617241859436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03030945546925068, decouple_loss:0.0016192725161090493
The modified gen p mean: 0.44455480575561523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030077725648880005, decouple_loss:0.001546827726997435
The modified gen p mean: 0.44293075799942017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028893452137708664, decouple_loss:0.0014655505074188113
Iteration: 2957, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470946192741394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02959255874156952, decouple_loss:0.0013845361536368728
The modified gen p mean: 0.44900885224342346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028071541339159012, decouple_loss:0.0014819721691310406
The modified gen p mean: 0.4459325671195984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029093323275446892, decouple_loss:0.0014118753606453538
Iteration: 2958, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4536466598510742, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02924834005534649, decouple_loss:0.0015195454470813274
The modified gen p mean: 0.44935929775238037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030781906098127365, decouple_loss:0.0012855171225965023
The modified gen p mean: 0.45077139139175415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03019469976425171, decouple_loss:0.001379260909743607
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr.npz
NaN value num: 0
Iteration: 2959, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45086565613746643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027351990342140198, decouple_loss:0.0014466781867668033
The modified gen p mean: 0.451347291469574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02683299407362938, decouple_loss:0.0015759142115712166
The modified gen p mean: 0.4552752375602722, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026036769151687622, decouple_loss:0.0016821215394884348
Iteration: 2960, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.454012393951416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027422402054071426, decouple_loss:0.001427187817171216
The modified gen p mean: 0.4518555700778961, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02757471241056919, decouple_loss:0.0013187713921070099
The modified gen p mean: 0.45763611793518066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02593505196273327, decouple_loss:0.00149249704554677
2023-05-27 00:47:08 testing...
The modified gen p mean: 0.4578069746494293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032161206007003784, decouple_loss:0.0016224713763222098
The modified gen p mean: 0.4578515887260437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03376974165439606, decouple_loss:0.001646034186705947
The modified gen p mean: 0.45622873306274414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03240448608994484, decouple_loss:0.001415007165633142
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0328565388917923, avg_mse: 0.0445568785071373
current test mse: 0.044557
Iteration: 2961, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45473533868789673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0273591335862875, decouple_loss:0.001394574181176722
The modified gen p mean: 0.4529811441898346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02809179574251175, decouple_loss:0.0014201048761606216
The modified gen p mean: 0.4583885967731476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027330314740538597, decouple_loss:0.0014702476328238845
Iteration: 2962, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4536381661891937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02559422329068184, decouple_loss:0.0015361558180302382
The modified gen p mean: 0.4519335925579071, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026116840541362762, decouple_loss:0.0013715894892811775
The modified gen p mean: 0.451705664396286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026863662526011467, decouple_loss:0.0013597769429907203
Iteration: 2963, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512418210506439, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02774468995630741, decouple_loss:0.0012711581075564027
The modified gen p mean: 0.44774478673934937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028365103527903557, decouple_loss:0.0013376462738960981
The modified gen p mean: 0.45314255356788635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025699008256196976, decouple_loss:0.001368237193673849
Iteration: 2964, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501670300960541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02811102382838726, decouple_loss:0.0016303319716826081
The modified gen p mean: 0.44870248436927795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02713824436068535, decouple_loss:0.0014515331713482738
The modified gen p mean: 0.4456680119037628, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02591891400516033, decouple_loss:0.001453434000723064
Iteration: 2965, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4435855448246002, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027507448568940163, decouple_loss:0.0014507328160107136
The modified gen p mean: 0.44435498118400574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0259961299598217, decouple_loss:0.0012380521511659026
The modified gen p mean: 0.4416702389717102, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02666487917304039, decouple_loss:0.0013642567209899426
Iteration: 2966, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4427849352359772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028301259502768517, decouple_loss:0.0012315866770222783
The modified gen p mean: 0.4433409571647644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028510387986898422, decouple_loss:0.0013728111516684294
The modified gen p mean: 0.4418380856513977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026872264221310616, decouple_loss:0.001251807319931686
Iteration: 2967, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44224274158477783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026868967339396477, decouple_loss:0.0012969934614375234
The modified gen p mean: 0.4416421949863434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02760561928153038, decouple_loss:0.0014400772051885724
The modified gen p mean: 0.4446873068809509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02680884674191475, decouple_loss:0.00133356056176126
Iteration: 2968, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44543689489364624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02669222466647625, decouple_loss:0.0013776242267340422
The modified gen p mean: 0.44578462839126587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027632126584649086, decouple_loss:0.0014171208022162318
The modified gen p mean: 0.4495547115802765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027692139148712158, decouple_loss:0.0016684074653312564
Iteration: 2969, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484928250312805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027518255636096, decouple_loss:0.0014170458307489753
The modified gen p mean: 0.4518786370754242, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0270589180290699, decouple_loss:0.001512354239821434
The modified gen p mean: 0.45022642612457275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025195449590682983, decouple_loss:0.0015802045818418264
Iteration: 2970, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45212554931640625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025624027475714684, decouple_loss:0.001422076835297048
The modified gen p mean: 0.45045432448387146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610127441585064, decouple_loss:0.0014427823480218649
The modified gen p mean: 0.44929614663124084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027885369956493378, decouple_loss:0.0013370519736781716
2023-05-27 00:51:12 testing...
The modified gen p mean: 0.45685747265815735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032432280480861664, decouple_loss:0.0016160877421498299
The modified gen p mean: 0.4570794999599457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034136541187763214, decouple_loss:0.0015845100861042738
The modified gen p mean: 0.4552772343158722, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03264541178941727, decouple_loss:0.0015201636124402285
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033150091767311096, avg_mse: 0.04513436183333397
current test mse: 0.045134
Iteration: 2971, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45256689190864563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027865992859005928, decouple_loss:0.0014605981996282935
The modified gen p mean: 0.4529983103275299, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027671391144394875, decouple_loss:0.0014668924268335104
The modified gen p mean: 0.45074760913848877, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026916474103927612, decouple_loss:0.0013080739881843328
Iteration: 2972, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534285366535187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027932122349739075, decouple_loss:0.0013738740235567093
The modified gen p mean: 0.4539024233818054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027013251557946205, decouple_loss:0.0014800132485106587
The modified gen p mean: 0.45628994703292847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027144694700837135, decouple_loss:0.0014807394472882152
Iteration: 2973, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45460274815559387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02779287099838257, decouple_loss:0.001444889116100967
The modified gen p mean: 0.4523034393787384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026892004534602165, decouple_loss:0.0012631374411284924
The modified gen p mean: 0.4552585184574127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610059827566147, decouple_loss:0.001473642303608358
Iteration: 2974, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451604962348938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028253227472305298, decouple_loss:0.001347895828075707
The modified gen p mean: 0.453445702791214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025048648938536644, decouple_loss:0.0013738665729761124
The modified gen p mean: 0.45363670587539673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025650404393672943, decouple_loss:0.0014005026314407587
Iteration: 2975, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512746334075928, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027774691581726074, decouple_loss:0.0013477640459313989
The modified gen p mean: 0.4498220682144165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02775595337152481, decouple_loss:0.0013895499287173152
The modified gen p mean: 0.45074424147605896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02608480677008629, decouple_loss:0.0013219491811469197
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr.npz
NaN value num: 0
Iteration: 2976, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44968464970588684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029690980911254883, decouple_loss:0.0012953135883435607
The modified gen p mean: 0.4495600461959839, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4472137987613678, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030225899070501328, decouple_loss:0.0013646293664351106
loss_pred:0.028022319078445435, decouple_loss:0.0012880431022495031
Iteration: 2977, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44489428400993347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028677042573690414, decouple_loss:0.0012961082393303514
The modified gen p mean: 0.4445429742336273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030681660398840904, decouple_loss:0.0012425062013790011
The modified gen p mean: 0.4442705512046814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029891815036535263, decouple_loss:0.0012480125296860933
Iteration: 2978, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44908037781715393, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031897079199552536, decouple_loss:0.001400061883032322
The modified gen p mean: 0.4465929865837097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028999298810958862, decouple_loss:0.0014092553174123168
The modified gen p mean: 0.4471575915813446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032260652631521225, decouple_loss:0.0014051792677491903
Iteration: 2979, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445862352848053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03116118349134922, decouple_loss:0.0014413350727409124
The modified gen p mean: 0.448259562253952, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030520139262080193, decouple_loss:0.001386108691804111
The modified gen p mean: 0.44524890184402466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031198037788271904, decouple_loss:0.0012905364856123924
Iteration: 2980, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466562271118164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030160076916217804, decouple_loss:0.0011977058602496982
The modified gen p mean: 0.4466830790042877, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030048305168747902, decouple_loss:0.0012817918322980404
The modified gen p mean: 0.4476340711116791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029006512835621834, decouple_loss:0.0014018312795087695
2023-05-27 00:56:02 testing...
The modified gen p mean: 0.4533228576183319, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03225220739841461, decouple_loss:0.001632246538065374
The modified gen p mean: 0.4517214000225067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03249780088663101, decouple_loss:0.001374872401356697
The modified gen p mean: 0.45349547266960144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033921342343091965, decouple_loss:0.0016018198803067207
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03296726569533348, avg_mse: 0.044776398688554764
current test mse: 0.044776
Iteration: 2981, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4529959261417389, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02933884598314762, decouple_loss:0.0014919063542038202
The modified gen p mean: 0.4553793966770172, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029465144500136375, decouple_loss:0.0014566017780452967
The modified gen p mean: 0.4495229125022888, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02919682487845421, decouple_loss:0.0012881868751719594
Iteration: 2982, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4544928967952728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029925713315606117, decouple_loss:0.0014882796676829457
The modified gen p mean: 0.4533878266811371, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028428785502910614, decouple_loss:0.0014276612782850862
The modified gen p mean: 0.4513765871524811, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029001928865909576, decouple_loss:0.001444255467504263
Iteration: 2983, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45277726650238037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03060080297291279, decouple_loss:0.0013668352039530873
The modified gen p mean: 0.4562807083129883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02920668013393879, decouple_loss:0.001388851902447641
The modified gen p mean: 0.45290687680244446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03077138401567936, decouple_loss:0.0016623943811282516
Iteration: 2984, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4552084505558014, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02949284203350544, decouple_loss:0.0013217166997492313
The modified gen p mean: 0.4528948962688446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030391015112400055, decouple_loss:0.0013071795692667365
The modified gen p mean: 0.4572931230068207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03093108907341957, decouple_loss:0.0014374174643307924
Iteration: 2985, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507656991481781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029013779014348984, decouple_loss:0.00136425974778831
The modified gen p mean: 0.4539230167865753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031250741332769394, decouple_loss:0.0012404685840010643
The modified gen p mean: 0.4531320035457611, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029335154220461845, decouple_loss:0.0013344569597393274
Iteration: 2986, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45051220059394836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02955584228038788, decouple_loss:0.001413020770996809
The modified gen p mean: 0.4549793601036072, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029028071090579033, decouple_loss:0.0014243258628994226
The modified gen p mean: 0.45482999086380005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02979695238173008, decouple_loss:0.0014085377333685756
Iteration: 2987, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496954083442688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031442541629076004, decouple_loss:0.0013070250861346722
The modified gen p mean: 0.44837069511413574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030237842351198196, decouple_loss:0.0014131336938589811
The modified gen p mean: 0.4490881860256195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029627228155732155, decouple_loss:0.0013847097288817167
Iteration: 2988, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478856027126312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029613280668854713, decouple_loss:0.0013598379446193576
The modified gen p mean: 0.4495201110839844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030673790723085403, decouple_loss:0.0012556541478261352
The modified gen p mean: 0.4476841688156128, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030110539868474007, decouple_loss:0.001231555244885385
Iteration: 2989, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44942957162857056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029150236397981644, decouple_loss:0.0013108141720294952
The modified gen p mean: 0.4469221234321594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028673080727458, decouple_loss:0.0011908237356692553
The modified gen p mean: 0.45228731632232666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030432386323809624, decouple_loss:0.001253007911145687
Iteration: 2990, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515990912914276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030603600665926933, decouple_loss:0.0014706333167850971
The modified gen p mean: 0.4510553181171417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029244568198919296, decouple_loss:0.0013724478194490075
The modified gen p mean: 0.44963783025741577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031223442405462265, decouple_loss:0.0013310888316482306
2023-05-27 01:00:07 testing...
The modified gen p mean: 0.4524053633213043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03222155570983887, decouple_loss:0.0014956018421798944
The modified gen p mean: 0.45067089796066284, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45242902636528015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032726649194955826, decouple_loss:0.00141447177156806
loss_pred:0.03399219736456871, decouple_loss:0.0014972846256569028
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03305359184741974, avg_mse: 0.044861726462841034
current test mse: 0.044862
Iteration: 2991, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44807714223861694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028724119067192078, decouple_loss:0.0012695593759417534
The modified gen p mean: 0.45003336668014526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02986346185207367, decouple_loss:0.0014294178690761328
The modified gen p mean: 0.44727379083633423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02948075160384178, decouple_loss:0.00131643854547292
Iteration: 2992, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44839587807655334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028861792758107185, decouple_loss:0.0013545835390686989
The modified gen p mean: 0.45125964283943176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02918831817805767, decouple_loss:0.0012966060312464833
The modified gen p mean: 0.4514131247997284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028890248388051987, decouple_loss:0.001308940933085978
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr.npz
NaN value num: 0
Iteration: 2993, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45035579800605774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02970273606479168, decouple_loss:0.0013185717398300767
The modified gen p mean: 0.45132991671562195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02972588501870632, decouple_loss:0.0014142828295007348
The modified gen p mean: 0.4480420649051666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03101198747754097, decouple_loss:0.0013634712668135762
Iteration: 2994, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45017415285110474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030570004135370255, decouple_loss:0.0013863079948350787
The modified gen p mean: 0.44883453845977783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030944539234042168, decouple_loss:0.0012248557759448886
The modified gen p mean: 0.4511663019657135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029743848368525505, decouple_loss:0.0013910409761592746
Iteration: 2995, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45002251863479614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031763460487127304, decouple_loss:0.0013942711520940065
The modified gen p mean: 0.45297789573669434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03026275336742401, decouple_loss:0.001356154796667397
The modified gen p mean: 0.44994547963142395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029672225937247276, decouple_loss:0.0012087299255654216
Iteration: 2996, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4539637863636017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0288082268089056, decouple_loss:0.0014807786792516708
The modified gen p mean: 0.4518220126628876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02960159443318844, decouple_loss:0.0013807251816615462
The modified gen p mean: 0.45317503809928894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030445924028754234, decouple_loss:0.0015341035323217511
Iteration: 2997, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492320716381073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030463198199868202, decouple_loss:0.001540552475489676
The modified gen p mean: 0.4530925452709198, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02901965007185936, decouple_loss:0.0014480535173788667
The modified gen p mean: 0.4519578218460083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030302399769425392, decouple_loss:0.0013183847768232226
Iteration: 2998, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489801228046417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03025166690349579, decouple_loss:0.001246008207090199
The modified gen p mean: 0.4502532482147217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030998270958662033, decouple_loss:0.0012562550837174058
The modified gen p mean: 0.45010533928871155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03100934810936451, decouple_loss:0.0014001794625073671
Iteration: 2999, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44564875960350037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028902141377329826, decouple_loss:0.0014081845292821527
The modified gen p mean: 0.4510500133037567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030347146093845367, decouple_loss:0.0013910848647356033
The modified gen p mean: 0.4484720826148987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03037875145673752, decouple_loss:0.0013658092357218266
Iteration: 3000, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44504261016845703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03077642433345318, decouple_loss:0.001302878139540553
The modified gen p mean: 0.4428800642490387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03112560324370861, decouple_loss:0.0013700699200853705
The modified gen p mean: 0.44456014037132263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0303056500852108, decouple_loss:0.0013978277565911412
2023-05-27 01:04:48 testing...
The modified gen p mean: 0.4501643478870392, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031989432871341705, decouple_loss:0.0015299883671104908
The modified gen p mean: 0.45014384388923645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03369823470711708, decouple_loss:0.0015547570073977113
The modified gen p mean: 0.44852226972579956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255981206893921, decouple_loss:0.001431145123206079
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032824426889419556, avg_mse: 0.04446243867278099
current test mse: 0.044462
Iteration: 3001, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44523656368255615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030308788642287254, decouple_loss:0.0012652082368731499
The modified gen p mean: 0.4455469846725464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030757512897253036, decouple_loss:0.0013746557524427772
The modified gen p mean: 0.44890540838241577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02975214645266533, decouple_loss:0.0014955324586480856
Iteration: 3002, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453192353248596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030580198392271996, decouple_loss:0.0013330302899703383
The modified gen p mean: 0.4500005543231964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029094476252794266, decouple_loss:0.0014261325122788548
The modified gen p mean: 0.4445372223854065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03004913218319416, decouple_loss:0.0014808669220656157
Iteration: 3003, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456108808517456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030232831835746765, decouple_loss:0.0013063232181593776
The modified gen p mean: 0.44889429211616516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028894828632473946, decouple_loss:0.001436061691492796
The modified gen p mean: 0.4440937936306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02955622598528862, decouple_loss:0.0013619516976177692
Iteration: 3004, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503309428691864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028690921142697334, decouple_loss:0.001294005662202835
The modified gen p mean: 0.44928666949272156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029100792482495308, decouple_loss:0.0013565639965236187
The modified gen p mean: 0.44627776741981506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029933303594589233, decouple_loss:0.0013089753920212388
Iteration: 3005, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494231641292572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030470388010144234, decouple_loss:0.001310912542976439
The modified gen p mean: 0.4461248517036438, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030202968046069145, decouple_loss:0.001359446789138019
The modified gen p mean: 0.44808486104011536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03002060577273369, decouple_loss:0.001441381173208356
Iteration: 3006, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455244541168213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03082725778222084, decouple_loss:0.0012783261481672525
The modified gen p mean: 0.4463971257209778, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02966027893126011, decouple_loss:0.0014179740101099014
The modified gen p mean: 0.44773998856544495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029173577204346657, decouple_loss:0.0012935990234836936
Iteration: 3007, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488863945007324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03008819743990898, decouple_loss:0.0013517612824216485
The modified gen p mean: 0.447904109954834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0288523081690073, decouple_loss:0.001270074280910194
The modified gen p mean: 0.44536152482032776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029831381514668465, decouple_loss:0.0014496628427878022
Iteration: 3008, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44973158836364746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02839638665318489, decouple_loss:0.0013984370743855834
The modified gen p mean: 0.45145919919013977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02950899489223957, decouple_loss:0.0013948160922154784
The modified gen p mean: 0.4477984309196472, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02904057502746582, decouple_loss:0.001312839798629284
Iteration: 3009, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475537836551666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02925415337085724, decouple_loss:0.0014133333461359143
The modified gen p mean: 0.4513508975505829, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029864279553294182, decouple_loss:0.001264418475329876
The modified gen p mean: 0.4511752724647522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0286155603826046, decouple_loss:0.0015065745683386922
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3010, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476109445095062, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028933607041835785, decouple_loss:0.0014213171089068055
The modified gen p mean: 0.4513578712940216, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45262470841407776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029501374810934067, decouple_loss:0.0012681015068665147
loss_pred:0.028360918164253235, decouple_loss:0.0014372161822393537
2023-05-27 01:09:32 testing...
The modified gen p mean: 0.45346343517303467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031919583678245544, decouple_loss:0.0015602605417370796
The modified gen p mean: 0.45177310705184937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03252304345369339, decouple_loss:0.0014212203677743673
The modified gen p mean: 0.4534792900085449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03371744975447655, decouple_loss:0.001542791724205017
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03279542922973633, avg_mse: 0.04447125270962715
current test mse: 0.044471
Iteration: 3011, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45119354128837585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02678569406270981, decouple_loss:0.0016155627090483904
The modified gen p mean: 0.45148730278015137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027964524924755096, decouple_loss:0.0015310675371438265
The modified gen p mean: 0.4486691653728485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03080589510500431, decouple_loss:0.001342596486210823
Iteration: 3012, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44720199704170227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027828190475702286, decouple_loss:0.0013595231575891376
The modified gen p mean: 0.4499152600765228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028230933472514153, decouple_loss:0.0014018781948834658
The modified gen p mean: 0.4519798159599304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02895059995353222, decouple_loss:0.001429636380635202
Iteration: 3013, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44959813356399536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027164369821548462, decouple_loss:0.0015378164825960994
The modified gen p mean: 0.44741716980934143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027980178594589233, decouple_loss:0.0013652039924636483
The modified gen p mean: 0.44964632391929626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02608809433877468, decouple_loss:0.001348144025541842
Iteration: 3014, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44734060764312744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029081331565976143, decouple_loss:0.0013067765394225717
The modified gen p mean: 0.44888460636138916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026511957868933678, decouple_loss:0.0015254803001880646
The modified gen p mean: 0.4483557641506195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02731643244624138, decouple_loss:0.0013650194741785526
Iteration: 3015, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4437580406665802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029850982129573822, decouple_loss:0.0015512268291786313
The modified gen p mean: 0.44606778025627136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029044637456536293, decouple_loss:0.001355272252112627
The modified gen p mean: 0.44687923789024353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027910219505429268, decouple_loss:0.001533857430331409
Iteration: 3016, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44661155343055725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02902277745306492, decouple_loss:0.0014614134561270475
The modified gen p mean: 0.444930762052536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02764282375574112, decouple_loss:0.0015084058977663517
The modified gen p mean: 0.44665998220443726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02695314958691597, decouple_loss:0.0013567120768129826
Iteration: 3017, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446851313114166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029032504186034203, decouple_loss:0.0013580629602074623
The modified gen p mean: 0.44508233666419983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02997259609401226, decouple_loss:0.0013917279429733753
The modified gen p mean: 0.4496534764766693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027986720204353333, decouple_loss:0.0014467233559116721
Iteration: 3018, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460850954055786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028008943423628807, decouple_loss:0.0013160714879631996
The modified gen p mean: 0.4499228894710541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027621010318398476, decouple_loss:0.001608897466212511
The modified gen p mean: 0.4472219944000244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028968948870897293, decouple_loss:0.0013844448840245605
Iteration: 3019, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508953392505646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026550766080617905, decouple_loss:0.0015584755456075072
The modified gen p mean: 0.4465184211730957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028025761246681213, decouple_loss:0.0014577173860743642
The modified gen p mean: 0.44960618019104004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02810841053724289, decouple_loss:0.0014718291349709034
Iteration: 3020, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44678643345832825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0287481602281332, decouple_loss:0.0013351065572351217
The modified gen p mean: 0.44946715235710144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02711659111082554, decouple_loss:0.0016134196193888783
The modified gen p mean: 0.451321542263031, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026939330622553825, decouple_loss:0.0014330710982903838
2023-05-27 01:13:36 testing...
The modified gen p mean: 0.4528539180755615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03221151605248451, decouple_loss:0.0015854041557759047
The modified gen p mean: 0.45284757018089294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03397754579782486, decouple_loss:0.0015336809447035193
The modified gen p mean: 0.4512200355529785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03275322541594505, decouple_loss:0.0014843257376924157
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03305748850107193, avg_mse: 0.04492663964629173
current test mse: 0.044927
Iteration: 3021, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450639933347702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028293248265981674, decouple_loss:0.0013520399807021022
The modified gen p mean: 0.44634369015693665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02812635712325573, decouple_loss:0.0012689083814620972
The modified gen p mean: 0.45031195878982544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02631489746272564, decouple_loss:0.0013840239262208343
Iteration: 3022, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44882044196128845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028589678928256035, decouple_loss:0.0016340304864570498
The modified gen p mean: 0.44760218262672424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026385411620140076, decouple_loss:0.0014576422981917858
The modified gen p mean: 0.44775187969207764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02868637815117836, decouple_loss:0.0014015893684700131
Iteration: 3023, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44791939854621887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02886311337351799, decouple_loss:0.001459103892557323
The modified gen p mean: 0.4504195749759674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02925543673336506, decouple_loss:0.0013983576791360974
The modified gen p mean: 0.44850045442581177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02848954312503338, decouple_loss:0.0013918840559199452
Iteration: 3024, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487133026123047, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02708953246474266, decouple_loss:0.0013910426059737802
The modified gen p mean: 0.4521148204803467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027663741260766983, decouple_loss:0.0015184032963588834
The modified gen p mean: 0.4475599229335785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028789246454834938, decouple_loss:0.0014759255573153496
Iteration: 3025, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45379677414894104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026753410696983337, decouple_loss:0.0014851897722110152
The modified gen p mean: 0.44712215662002563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028367478400468826, decouple_loss:0.0014001051895320415
The modified gen p mean: 0.44770342111587524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027223452925682068, decouple_loss:0.0014845315599814057
Iteration: 3026, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508719742298126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026448460295796394, decouple_loss:0.0014020524686202407
The modified gen p mean: 0.4462882876396179, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029067568480968475, decouple_loss:0.0014214402763172984
The modified gen p mean: 0.4468955993652344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02928204834461212, decouple_loss:0.0014780679484829307
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3027, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44676727056503296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028853030875325203, decouple_loss:0.0014568500919267535
The modified gen p mean: 0.4500240683555603, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44626668095588684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028574204072356224, decouple_loss:0.0012678164057433605
loss_pred:0.026268472895026207, decouple_loss:0.0013532704906538129
Iteration: 3028, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44628968834877014, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0271178986877203, decouple_loss:0.0015642154030501842
The modified gen p mean: 0.44562357664108276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02867245487868786, decouple_loss:0.001362234354019165
The modified gen p mean: 0.4443866014480591, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771555259823799, decouple_loss:0.0013671801425516605
Iteration: 3029, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446239709854126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028751607984304428, decouple_loss:0.001331967650912702
The modified gen p mean: 0.4490329623222351, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026647336781024933, decouple_loss:0.001406876021064818
The modified gen p mean: 0.44863298535346985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026894647628068924, decouple_loss:0.0015064028557389975
Iteration: 3030, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457574784755707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02634313702583313, decouple_loss:0.0014688376104459167
The modified gen p mean: 0.4481351673603058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0266584362834692, decouple_loss:0.0012849075719714165
The modified gen p mean: 0.44469910860061646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732560597360134, decouple_loss:0.0013683242723345757
2023-05-27 01:18:21 testing...
The modified gen p mean: 0.44950881600379944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03264261409640312, decouple_loss:0.0015486044576391578
The modified gen p mean: 0.44782042503356934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03294279798865318, decouple_loss:0.0014249301748350263
The modified gen p mean: 0.4494725167751312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034217093139886856, decouple_loss:0.0015286754351109266
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03334254026412964, avg_mse: 0.04538475722074509
current test mse: 0.045385
Iteration: 3031, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442536234855652, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028931638225913048, decouple_loss:0.0013301640283316374
The modified gen p mean: 0.44251736998558044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028152640908956528, decouple_loss:0.0014169990317896008
The modified gen p mean: 0.44812437891960144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026569988578557968, decouple_loss:0.0013963121455162764
Iteration: 3032, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44442126154899597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612980641424656, decouple_loss:0.0016034344444051385
The modified gen p mean: 0.4441309869289398, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028431573882699013, decouple_loss:0.0014744818909093738
The modified gen p mean: 0.4468849003314972, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02642226405441761, decouple_loss:0.0013998050708323717
Iteration: 3033, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4426511526107788, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027574369683861732, decouple_loss:0.0014027671422809362
The modified gen p mean: 0.44159016013145447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028661269694566727, decouple_loss:0.0014481408288702369
The modified gen p mean: 0.44458281993865967, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02647838369011879, decouple_loss:0.0015236152103170753
Iteration: 3034, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434811472892761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026825811713933945, decouple_loss:0.001359695801511407
The modified gen p mean: 0.4435134530067444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02628239057958126, decouple_loss:0.0015275680925697088
The modified gen p mean: 0.44308528304100037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026159577071666718, decouple_loss:0.001378526445478201
Iteration: 3035, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453742206096649, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026980476453900337, decouple_loss:0.0013998976210132241
The modified gen p mean: 0.445070743560791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027338922023773193, decouple_loss:0.0014025343116372824
The modified gen p mean: 0.4429711103439331, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028083056211471558, decouple_loss:0.0014715202851220965
Iteration: 3036, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449325203895569, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02619660273194313, decouple_loss:0.0013243936700746417
The modified gen p mean: 0.44528815150260925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026897842064499855, decouple_loss:0.0012925838818773627
The modified gen p mean: 0.4422241151332855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028417348861694336, decouple_loss:0.0012957702856510878
Iteration: 3037, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44382575154304504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027759546414017677, decouple_loss:0.001357269356958568
The modified gen p mean: 0.4473261535167694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0269313957542181, decouple_loss:0.001305685262195766
The modified gen p mean: 0.44112008810043335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0289505273103714, decouple_loss:0.0012159956386312842
Iteration: 3038, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44538789987564087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02811739780008793, decouple_loss:0.0013311740476638079
The modified gen p mean: 0.44387155771255493, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02632145583629608, decouple_loss:0.001312000909820199
The modified gen p mean: 0.44533684849739075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027767309918999672, decouple_loss:0.0013207088923081756
Iteration: 3039, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4426886737346649, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028510095551609993, decouple_loss:0.0013974035391584039
The modified gen p mean: 0.44839802384376526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026931488886475563, decouple_loss:0.0013412844855338335
The modified gen p mean: 0.44501590728759766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028048992156982422, decouple_loss:0.0014420300722122192
Iteration: 3040, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475683867931366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02828352525830269, decouple_loss:0.0012242656666785479
The modified gen p mean: 0.4492904543876648, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027248848229646683, decouple_loss:0.0013721354771405458
The modified gen p mean: 0.4459207355976105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02629575878381729, decouple_loss:0.0015180797781795263
2023-05-27 01:22:26 testing...
The modified gen p mean: 0.45267948508262634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03393937274813652, decouple_loss:0.0015968758380040526
The modified gen p mean: 0.45058950781822205, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45272353291511536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033819179981946945, decouple_loss:0.0014361097710207105
loss_pred:0.035615015774965286, decouple_loss:0.001592850312590599
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03453495353460312, avg_mse: 0.04729219526052475
current test mse: 0.047292
Iteration: 3041, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464755654335022, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028935927897691727, decouple_loss:0.0012956305872648954
The modified gen p mean: 0.44738519191741943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025672288611531258, decouple_loss:0.0013808334479108453
The modified gen p mean: 0.4494975209236145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02668081969022751, decouple_loss:0.0013553132303059101
Iteration: 3042, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487336575984955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025650834664702415, decouple_loss:0.001435349928215146
The modified gen p mean: 0.451862633228302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026405151933431625, decouple_loss:0.0014786216197535396
The modified gen p mean: 0.44952845573425293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025593606755137444, decouple_loss:0.0014376877807080746
Iteration: 3043, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461802542209625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028002100065350533, decouple_loss:0.0014546650927513838
The modified gen p mean: 0.4472949504852295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02836914360523224, decouple_loss:0.0014723114436492324
The modified gen p mean: 0.4473912715911865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028408849611878395, decouple_loss:0.0013991290470585227
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3044, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4436071813106537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02790660783648491, decouple_loss:0.001460582367144525
The modified gen p mean: 0.44933179020881653, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.444184809923172, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025605283677577972, decouple_loss:0.0013918934855610132
loss_pred:0.027237506583333015, decouple_loss:0.0014618962304666638
Iteration: 3045, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465477466583252, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027766525745391846, decouple_loss:0.0013106169644743204
The modified gen p mean: 0.4448666274547577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02860347181558609, decouple_loss:0.0012510694796219468
The modified gen p mean: 0.44494640827178955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027107499539852142, decouple_loss:0.0014899501111358404
Iteration: 3046, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462916851043701, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026331830769777298, decouple_loss:0.001595479203388095
The modified gen p mean: 0.44581490755081177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027438893914222717, decouple_loss:0.00143014348577708
The modified gen p mean: 0.44489359855651855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02718670479953289, decouple_loss:0.0012184367515146732
Iteration: 3047, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4436146020889282, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02764151617884636, decouple_loss:0.0014387264382094145
The modified gen p mean: 0.44570398330688477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027363788336515427, decouple_loss:0.00157423154450953
The modified gen p mean: 0.4467542767524719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02710309438407421, decouple_loss:0.0016934990417212248
Iteration: 3048, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434589147567749, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02788269892334938, decouple_loss:0.0013690434861928225
The modified gen p mean: 0.4445464313030243, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028140971437096596, decouple_loss:0.001269098836928606
The modified gen p mean: 0.4458603858947754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025941934436559677, decouple_loss:0.001265777158550918
Iteration: 3049, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504438042640686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025564908981323242, decouple_loss:0.001438293606042862
The modified gen p mean: 0.4438149034976959, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0275912843644619, decouple_loss:0.0013578812358900905
The modified gen p mean: 0.44564035534858704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02772468887269497, decouple_loss:0.0014481879770755768
Iteration: 3050, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44830891489982605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02676008641719818, decouple_loss:0.0014872378669679165
The modified gen p mean: 0.4438117742538452, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02889799140393734, decouple_loss:0.0013700235867872834
The modified gen p mean: 0.44779375195503235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02655578963458538, decouple_loss:0.0014571478823199868
2023-05-27 01:27:17 testing...
The modified gen p mean: 0.4501388967037201, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03301616758108139, decouple_loss:0.0015628840774297714
The modified gen p mean: 0.4500793218612671, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034678757190704346, decouple_loss:0.0015980263706296682
The modified gen p mean: 0.44809600710868835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033224496990442276, decouple_loss:0.001480442238971591
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033717166632413864, avg_mse: 0.04596639797091484
current test mse: 0.045966
Iteration: 3051, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446048438549042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025490999221801758, decouple_loss:0.0015461818547919393
The modified gen p mean: 0.4496329724788666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02566446363925934, decouple_loss:0.0014250325039029121
The modified gen p mean: 0.44708654284477234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02691449224948883, decouple_loss:0.0015038899146020412
Iteration: 3052, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478333294391632, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028187351301312447, decouple_loss:0.0013209797907620668
The modified gen p mean: 0.44602230191230774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027665328234434128, decouple_loss:0.0012633391888812184
The modified gen p mean: 0.44561731815338135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025948595255613327, decouple_loss:0.0014026477001607418
Iteration: 3053, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44939014315605164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02712922729551792, decouple_loss:0.001357798115350306
The modified gen p mean: 0.4480869770050049, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027401896193623543, decouple_loss:0.0014566821046173573
The modified gen p mean: 0.44643840193748474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027383558452129364, decouple_loss:0.001362139475531876
Iteration: 3054, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44688963890075684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026791833341121674, decouple_loss:0.001301151467487216
The modified gen p mean: 0.4454672932624817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02788870595395565, decouple_loss:0.0012534662382677197
The modified gen p mean: 0.45212322473526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026438506320118904, decouple_loss:0.0014759323094040155
Iteration: 3055, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463663697242737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026610635221004486, decouple_loss:0.0012600516201928258
The modified gen p mean: 0.4511384963989258, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025971263647079468, decouple_loss:0.001391954137943685
The modified gen p mean: 0.4464171230792999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027263080701231956, decouple_loss:0.0012548706727102399
Iteration: 3056, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514676630496979, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026179851964116096, decouple_loss:0.0014240018790587783
The modified gen p mean: 0.44682469964027405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025612667202949524, decouple_loss:0.001413073274306953
The modified gen p mean: 0.44815486669540405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027366407215595245, decouple_loss:0.0015242433873936534
Iteration: 3057, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466679096221924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02716217190027237, decouple_loss:0.001444446505047381
The modified gen p mean: 0.4479784667491913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026736199855804443, decouple_loss:0.0014195836847648025
The modified gen p mean: 0.44714587926864624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026736736297607422, decouple_loss:0.0014696024591103196
Iteration: 3058, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483596682548523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026861269026994705, decouple_loss:0.0014213420217856765
The modified gen p mean: 0.4479021728038788, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02648874744772911, decouple_loss:0.001459489343687892
The modified gen p mean: 0.44931501150131226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02657075971364975, decouple_loss:0.00141472730319947
Iteration: 3059, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44458213448524475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02952083945274353, decouple_loss:0.0013127661077305675
The modified gen p mean: 0.44521835446357727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02670673280954361, decouple_loss:0.0012208158150315285
The modified gen p mean: 0.4512353837490082, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026702195405960083, decouple_loss:0.0014362538931891322
Iteration: 3060, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502183496952057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02575531043112278, decouple_loss:0.0013868388487026095
The modified gen p mean: 0.44679316878318787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026674052700400352, decouple_loss:0.0013424491044133902
The modified gen p mean: 0.44910064339637756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02745041623711586, decouple_loss:0.0013999593211337924
2023-05-27 01:31:24 testing...
The modified gen p mean: 0.45082250237464905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03323260322213173, decouple_loss:0.001488397130742669
The modified gen p mean: 0.4488087594509125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03337496519088745, decouple_loss:0.0013981425436213613
The modified gen p mean: 0.4509184658527374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034936416894197464, decouple_loss:0.0015553950797766447
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03392203152179718, avg_mse: 0.04632445424795151
current test mse: 0.046324
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3061, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44517388939857483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026884978637099266, decouple_loss:0.0013155663618817925
The modified gen p mean: 0.4427497088909149, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4466894567012787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027111368253827095, decouple_loss:0.0012640245258808136
loss_pred:0.02599683776497841, decouple_loss:0.0014147082110866904
Iteration: 3062, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503472149372101, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02650967426598072, decouple_loss:0.0013086426770314574
The modified gen p mean: 0.44849273562431335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02645631693303585, decouple_loss:0.0014373458689078689
The modified gen p mean: 0.4451436698436737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026132000610232353, decouple_loss:0.0013382809702306986
Iteration: 3063, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44616636633872986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02734270505607128, decouple_loss:0.0013757130363956094
The modified gen p mean: 0.4473673105239868, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02702188305556774, decouple_loss:0.0014991600764915347
The modified gen p mean: 0.4464340806007385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027703406289219856, decouple_loss:0.0014634091639891267
Iteration: 3064, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45036080479621887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02658674120903015, decouple_loss:0.001397176762111485
The modified gen p mean: 0.44725126028060913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026562495157122612, decouple_loss:0.0013282904401421547
The modified gen p mean: 0.44910380244255066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026121560484170914, decouple_loss:0.0013566616689786315
Iteration: 3065, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44746631383895874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0280622486025095, decouple_loss:0.0012120153987780213
The modified gen p mean: 0.4475744068622589, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026734545826911926, decouple_loss:0.0011705366196110845
The modified gen p mean: 0.4481064975261688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026887141168117523, decouple_loss:0.0013116662157699466
Iteration: 3066, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45112892985343933, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02624950371682644, decouple_loss:0.0014117322862148285
The modified gen p mean: 0.44586992263793945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02727830968797207, decouple_loss:0.001359024434350431
The modified gen p mean: 0.45059433579444885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026304539293050766, decouple_loss:0.0013400816824287176
Iteration: 3067, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477297365665436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026586154475808144, decouple_loss:0.0013743597082793713
The modified gen p mean: 0.4482977092266083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026704570278525352, decouple_loss:0.0013555119512602687
The modified gen p mean: 0.4523821771144867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02639085426926613, decouple_loss:0.001483977073803544
Iteration: 3068, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442373514175415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027531858533620834, decouple_loss:0.0014845989644527435
The modified gen p mean: 0.44614455103874207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027022678405046463, decouple_loss:0.0014117610407993197
The modified gen p mean: 0.4451131820678711, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02841775491833687, decouple_loss:0.0012813534121960402
Iteration: 3069, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44538614153862, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02836112305521965, decouple_loss:0.0013389901723712683
The modified gen p mean: 0.4435252547264099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026863737031817436, decouple_loss:0.0013889891561120749
The modified gen p mean: 0.44603779911994934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026866057887673378, decouple_loss:0.0014247681247070432
Iteration: 3070, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434360861778259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026796577498316765, decouple_loss:0.001334740431047976
The modified gen p mean: 0.447708398103714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02594893053174019, decouple_loss:0.00142900669015944
The modified gen p mean: 0.44212090969085693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0263981893658638, decouple_loss:0.0013441876508295536
2023-05-27 01:36:10 testing...
The modified gen p mean: 0.44978854060173035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03310970589518547, decouple_loss:0.0016207927837967873
The modified gen p mean: 0.44776320457458496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033175405114889145, decouple_loss:0.001437114318832755
The modified gen p mean: 0.4498165547847748, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03478136286139488, decouple_loss:0.0015817777020856738
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03376615047454834, avg_mse: 0.046119559556245804
current test mse: 0.04612
Iteration: 3071, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44264736771583557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02683436870574951, decouple_loss:0.0012838554102927446
The modified gen p mean: 0.44390374422073364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026145244017243385, decouple_loss:0.0016841526376083493
The modified gen p mean: 0.44258689880371094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027780333533883095, decouple_loss:0.0013028545072302222
Iteration: 3072, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44675973057746887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026013659313321114, decouple_loss:0.0014608170604333282
The modified gen p mean: 0.44311243295669556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027264777570962906, decouple_loss:0.0012738141231238842
The modified gen p mean: 0.443838506937027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02674901857972145, decouple_loss:0.0012911268277093768
Iteration: 3073, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450015425682068, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025883929803967476, decouple_loss:0.0014801883371546865
The modified gen p mean: 0.44402623176574707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02794569917023182, decouple_loss:0.0015384427970275283
The modified gen p mean: 0.4484555721282959, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026005659252405167, decouple_loss:0.0013759948778897524
Iteration: 3074, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44569626450538635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02734137699007988, decouple_loss:0.0013123255921527743
The modified gen p mean: 0.446698397397995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026082614436745644, decouple_loss:0.0014349243137985468
The modified gen p mean: 0.4478937089443207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02566044218838215, decouple_loss:0.0013720671413466334
Iteration: 3075, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44436025619506836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026968808844685555, decouple_loss:0.0012383176945149899
The modified gen p mean: 0.44972914457321167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025842508301138878, decouple_loss:0.0014919551322236657
The modified gen p mean: 0.44510379433631897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028432762250304222, decouple_loss:0.001402409514412284
Iteration: 3076, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44429031014442444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028376929461956024, decouple_loss:0.001315897679887712
The modified gen p mean: 0.4476885497570038, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025895997881889343, decouple_loss:0.001476687379181385
The modified gen p mean: 0.4476318061351776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026304956525564194, decouple_loss:0.0014214838156476617
Iteration: 3077, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454694390296936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027244584634900093, decouple_loss:0.0012894502142444253
The modified gen p mean: 0.44705730676651, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026573343202471733, decouple_loss:0.0014093612553551793
The modified gen p mean: 0.4445495903491974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027209920808672905, decouple_loss:0.0013833953998982906
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr.npz
NaN value num: 0
Iteration: 3078, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499940574169159, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02966752089560032, decouple_loss:0.001533301081508398
The modified gen p mean: 0.4460691213607788, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4474530816078186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028942223638296127, decouple_loss:0.0012308030854910612
loss_pred:0.030350999906659126, decouple_loss:0.0016048398101702332
Iteration: 3079, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44883471727371216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03009737841784954, decouple_loss:0.0012903239112347364
The modified gen p mean: 0.4482594430446625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02961115539073944, decouple_loss:0.0014745675725862384
The modified gen p mean: 0.4490630626678467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030275294557213783, decouple_loss:0.001502114231698215
Iteration: 3080, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45042940974235535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030600739642977715, decouple_loss:0.0012652876321226358
The modified gen p mean: 0.4540409743785858, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03143845498561859, decouple_loss:0.0014183162711560726
The modified gen p mean: 0.450702965259552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02916371263563633, decouple_loss:0.0014485628344118595
2023-05-27 01:40:56 testing...
The modified gen p mean: 0.454319030046463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0324866808950901, decouple_loss:0.0015889452770352364
The modified gen p mean: 0.4523293077945709, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259625285863876, decouple_loss:0.0014198552817106247
The modified gen p mean: 0.45412710309028625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03420402482151985, decouple_loss:0.0015616544988006353
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03317182883620262, avg_mse: 0.04520353674888611
current test mse: 0.045204
Iteration: 3081, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506029486656189, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029756544157862663, decouple_loss:0.0014091399498283863
The modified gen p mean: 0.4508521258831024, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030846843495965004, decouple_loss:0.0014486589934676886
The modified gen p mean: 0.4492133855819702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031001897528767586, decouple_loss:0.0013557899510487914
Iteration: 3082, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45053473114967346, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45183613896369934, gen p mean: 0.0, mean p set: 0.448loss_pred:0.029748428612947464, decouple_loss:0.001256064628250897
loss_pred:0.029841499403119087, decouple_loss:0.0013918381882831454
The modified gen p mean: 0.4512290060520172, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030733609572052956, decouple_loss:0.0013035075971856713
Iteration: 3083, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514240324497223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029370123520493507, decouple_loss:0.0014179424615576863
The modified gen p mean: 0.4517015814781189, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030129125341773033, decouple_loss:0.001305309822782874
The modified gen p mean: 0.4543347656726837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030403366312384605, decouple_loss:0.0013574388576671481
Iteration: 3084, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505467116832733, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4520167410373688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02993719093501568, decouple_loss:0.0012534514535218477
loss_pred:0.030579039826989174, decouple_loss:0.001370697864331305
The modified gen p mean: 0.45516398549079895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029923144727945328, decouple_loss:0.0015039554564282298
Iteration: 3085, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519682824611664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029860539361834526, decouple_loss:0.001216175383888185
The modified gen p mean: 0.4539085626602173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030883774161338806, decouple_loss:0.0014259053859859705
The modified gen p mean: 0.4528806209564209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030290275812149048, decouple_loss:0.001338315661996603
Iteration: 3086, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509788751602173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029084596782922745, decouple_loss:0.0013275530654937029
The modified gen p mean: 0.4512527883052826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029632385820150375, decouple_loss:0.00126545294187963
The modified gen p mean: 0.4524812698364258, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029839860275387764, decouple_loss:0.0013292856747284532
Iteration: 3087, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44983723759651184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02881109155714512, decouple_loss:0.001322291325777769
The modified gen p mean: 0.4512113928794861, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030938448384404182, decouple_loss:0.0012918624561280012
The modified gen p mean: 0.45478740334510803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02840694971382618, decouple_loss:0.001450266339816153
Iteration: 3088, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45430076122283936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02757616527378559, decouple_loss:0.0012331156758591533
The modified gen p mean: 0.45101800560951233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031619954854249954, decouple_loss:0.0012434027157723904
The modified gen p mean: 0.45200714468955994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03093450702726841, decouple_loss:0.0012941104359924793
Iteration: 3089, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45392847061157227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0312713086605072, decouple_loss:0.0012787645682692528
The modified gen p mean: 0.4493170380592346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029566342011094093, decouple_loss:0.0013067371910437942
The modified gen p mean: 0.44868209958076477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029550937935709953, decouple_loss:0.0013615681091323495
Iteration: 3090, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488610327243805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028839904814958572, decouple_loss:0.0014173913514241576
The modified gen p mean: 0.45157912373542786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030784983187913895, decouple_loss:0.0012765905121341348
The modified gen p mean: 0.44859546422958374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029655899852514267, decouple_loss:0.0012204049853608012
2023-05-27 01:45:01 testing...
The modified gen p mean: 0.4528641700744629, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03237034007906914, decouple_loss:0.0014595510438084602
The modified gen p mean: 0.45242780447006226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03383268043398857, decouple_loss:0.0015722546959295869
The modified gen p mean: 0.4505903720855713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03250737115740776, decouple_loss:0.0013940950157120824
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032977230846881866, avg_mse: 0.04473545029759407
current test mse: 0.044735
Iteration: 3091, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44894033670425415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030024830251932144, decouple_loss:0.0013637037482112646
The modified gen p mean: 0.4517156481742859, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028723157942295074, decouple_loss:0.0013344759354367852
The modified gen p mean: 0.45298027992248535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029688728973269463, decouple_loss:0.0015099002048373222
Iteration: 3092, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480321705341339, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028768278658390045, decouple_loss:0.0013677056413143873
The modified gen p mean: 0.4461304843425751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031559355556964874, decouple_loss:0.0015021435683593154
The modified gen p mean: 0.44771572947502136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029755407944321632, decouple_loss:0.0012969268718734384
Iteration: 3093, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447654664516449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02948974259197712, decouple_loss:0.001329729100689292
The modified gen p mean: 0.44857314229011536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030331721529364586, decouple_loss:0.0014800425851717591
The modified gen p mean: 0.4486539661884308, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031117716804146767, decouple_loss:0.0013084678212180734
Iteration: 3094, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482137858867645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028798693791031837, decouple_loss:0.0014595522079616785
The modified gen p mean: 0.4453127384185791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029988199472427368, decouple_loss:0.0012934347614645958
The modified gen p mean: 0.4498879015445709, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027124492451548576, decouple_loss:0.0012015084503218532
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3095, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44386348128318787, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4437643587589264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612418308854103, decouple_loss:0.0013909218832850456
loss_pred:0.02815575897693634, decouple_loss:0.001337849535048008The modified gen p mean: 0.4440355598926544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02877834625542164, decouple_loss:0.0013552135787904263
Iteration: 3096, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44784849882125854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02776351012289524, decouple_loss:0.0013329340144991875
The modified gen p mean: 0.4463977813720703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027230169624090195, decouple_loss:0.0013129475992172956
The modified gen p mean: 0.44624143838882446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0255759134888649, decouple_loss:0.0013456391170620918
Iteration: 3097, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44422221183776855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02549985982477665, decouple_loss:0.001457629376091063
The modified gen p mean: 0.44675883650779724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02802186831831932, decouple_loss:0.0013436205917969346
The modified gen p mean: 0.44868719577789307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027860650792717934, decouple_loss:0.0014967926545068622
Iteration: 3098, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465736448764801, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783522754907608, decouple_loss:0.001478630700148642
The modified gen p mean: 0.447053998708725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028748830780386925, decouple_loss:0.0014324821531772614
The modified gen p mean: 0.4485110640525818, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732701227068901, decouple_loss:0.0014046448050066829
Iteration: 3099, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45392781496047974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026893502101302147, decouple_loss:0.0013658219249919057
The modified gen p mean: 0.44987645745277405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026925886049866676, decouple_loss:0.0014655052218586206
The modified gen p mean: 0.4511411488056183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026604827493429184, decouple_loss:0.0014431164599955082
Iteration: 3100, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45100194215774536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02719842828810215, decouple_loss:0.0014275687281042337
The modified gen p mean: 0.4521501958370209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02818402834236622, decouple_loss:0.0013423062628135085
The modified gen p mean: 0.4550250172615051, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026065614074468613, decouple_loss:0.001355137676000595
2023-05-27 01:49:43 testing...
The modified gen p mean: 0.45331379771232605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230733424425125, decouple_loss:0.0016115800244733691
The modified gen p mean: 0.4512181282043457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03278134763240814, decouple_loss:0.0015191513812169433
The modified gen p mean: 0.4529438018798828, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03402270749211311, decouple_loss:0.001641247421503067
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033116664737463, avg_mse: 0.0449225939810276
current test mse: 0.044923
Iteration: 3101, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513227939605713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02716401033103466, decouple_loss:0.0013852999545633793
The modified gen p mean: 0.44984176754951477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027664223685860634, decouple_loss:0.00147826480679214
The modified gen p mean: 0.44694802165031433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027677735313773155, decouple_loss:0.001370316487737
Iteration: 3102, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469809830188751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028948340564966202, decouple_loss:0.0013441075570881367
The modified gen p mean: 0.4488230049610138, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02703951857984066, decouple_loss:0.001472180476412177
The modified gen p mean: 0.44647669792175293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02833845093846321, decouple_loss:0.0014549416955560446
Iteration: 3103, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44384026527404785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02800096571445465, decouple_loss:0.0017124193254858255
The modified gen p mean: 0.4450603723526001, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02752237394452095, decouple_loss:0.001470372430048883
The modified gen p mean: 0.4459421932697296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026143928989768028, decouple_loss:0.0015961822355166078
Iteration: 3104, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44228801131248474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028043268248438835, decouple_loss:0.0013360369484871626
The modified gen p mean: 0.44303056597709656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028074052184820175, decouple_loss:0.0013448819518089294
The modified gen p mean: 0.4459843933582306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026102876290678978, decouple_loss:0.00134740408975631
Iteration: 3105, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4418252408504486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028448589146137238, decouple_loss:0.0013245560694485903
The modified gen p mean: 0.44522571563720703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027283212170004845, decouple_loss:0.0014420105144381523
The modified gen p mean: 0.4461178183555603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026880519464612007, decouple_loss:0.0016856756992638111
Iteration: 3106, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443306624889374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02842889353632927, decouple_loss:0.0013586824061349034
The modified gen p mean: 0.44883108139038086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026169750839471817, decouple_loss:0.001532349968329072
The modified gen p mean: 0.44679874181747437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02754741907119751, decouple_loss:0.0015154831344261765
Iteration: 3107, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470421373844147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027455978095531464, decouple_loss:0.001495970762334764
The modified gen p mean: 0.44743460416793823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027333293110132217, decouple_loss:0.0014952374622225761
The modified gen p mean: 0.44636765122413635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027801569551229477, decouple_loss:0.0014903992414474487
Iteration: 3108, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459860324859619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028027977794408798, decouple_loss:0.0014722462510690093
The modified gen p mean: 0.4476465880870819, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027195479720830917, decouple_loss:0.001488315174356103
The modified gen p mean: 0.4486290514469147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025869781151413918, decouple_loss:0.0015056286938488483
Iteration: 3109, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4541323482990265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025567568838596344, decouple_loss:0.001418151892721653
The modified gen p mean: 0.45064616203308105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026784133166074753, decouple_loss:0.0013952926965430379
The modified gen p mean: 0.44897422194480896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027636971324682236, decouple_loss:0.0015082916943356395
Iteration: 3110, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45340970158576965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026504315435886383, decouple_loss:0.0013273699441924691
The modified gen p mean: 0.45551472902297974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02533799223601818, decouple_loss:0.0013785624178126454
The modified gen p mean: 0.45412352681159973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02718433178961277, decouple_loss:0.001329825958237052
2023-05-27 01:53:50 testing...
The modified gen p mean: 0.45550960302352905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253510966897011, decouple_loss:0.0015806873561814427
The modified gen p mean: 0.4551929533481598, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0343615859746933, decouple_loss:0.001574479159899056
The modified gen p mean: 0.45342743396759033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03303573653101921, decouple_loss:0.0014652606332674623
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033387817442417145, avg_mse: 0.045439012348651886
current test mse: 0.045439
Iteration: 3111, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497356712818146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028606364503502846, decouple_loss:0.0013165308628231287
The modified gen p mean: 0.4520268738269806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026773910969495773, decouple_loss:0.0013717346591874957
The modified gen p mean: 0.4500086009502411, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027901094406843185, decouple_loss:0.0013496093451976776
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3112, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44896477460861206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029680147767066956, decouple_loss:0.0012878894340246916
The modified gen p mean: 0.44856637716293335, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45209988951683044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029689520597457886, decouple_loss:0.001339028705842793
loss_pred:0.029144834727048874, decouple_loss:0.0014411126030609012
Iteration: 3113, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4520035684108734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02922489121556282, decouple_loss:0.0013820081949234009
The modified gen p mean: 0.4520948827266693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029395010322332382, decouple_loss:0.001294526970013976
The modified gen p mean: 0.4510655105113983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030024470761418343, decouple_loss:0.0013160777743905783
Iteration: 3114, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44855162501335144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02828535996377468, decouple_loss:0.001311869011260569
The modified gen p mean: 0.45184460282325745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02930612303316593, decouple_loss:0.0013914931332692504
The modified gen p mean: 0.44880470633506775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028580470010638237, decouple_loss:0.0015178549801930785
Iteration: 3115, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44888103008270264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02846711315214634, decouple_loss:0.001530829002149403
The modified gen p mean: 0.45096731185913086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028154145926237106, decouple_loss:0.001404228270985186
The modified gen p mean: 0.4495789110660553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029123883694410324, decouple_loss:0.001248856307938695
Iteration: 3116, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485149383544922, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02798580750823021, decouple_loss:0.001426147879101336
The modified gen p mean: 0.4540981948375702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722342684864998, decouple_loss:0.0014391484437510371
The modified gen p mean: 0.4529143273830414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02855510264635086, decouple_loss:0.0012967856600880623
Iteration: 3117, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499749541282654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02919040061533451, decouple_loss:0.0013556919293478131
The modified gen p mean: 0.4483536183834076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030655566602945328, decouple_loss:0.0013106868136674166
The modified gen p mean: 0.4503026008605957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029510434716939926, decouple_loss:0.0014729098184034228
Iteration: 3118, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504774212837219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030126182362437248, decouple_loss:0.0012646621325984597
The modified gen p mean: 0.4526788294315338, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029408665373921394, decouple_loss:0.001370975631289184
The modified gen p mean: 0.4514439105987549, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028207430616021156, decouple_loss:0.0013377629220485687
Iteration: 3119, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487055540084839, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029742874205112457, decouple_loss:0.0013724260497838259
The modified gen p mean: 0.44867753982543945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029227934777736664, decouple_loss:0.0012599892215803266
The modified gen p mean: 0.45022258162498474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028660962358117104, decouple_loss:0.0013204975984990597
Iteration: 3120, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500406086444855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029159875586628914, decouple_loss:0.0012623317306861281
The modified gen p mean: 0.44933977723121643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02990833669900894, decouple_loss:0.0011902363039553165
The modified gen p mean: 0.44966956973075867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028727015480399132, decouple_loss:0.0014116755919530988
2023-05-27 01:58:41 testing...
The modified gen p mean: 0.45293429493904114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03232555091381073, decouple_loss:0.0015122778713703156
The modified gen p mean: 0.4525621235370636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034091830253601074, decouple_loss:0.0015083905309438705
The modified gen p mean: 0.45082446932792664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03266030550003052, decouple_loss:0.0013982371892780066
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033099543303251266, avg_mse: 0.04495157673954964
current test mse: 0.044952
Iteration: 3121, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44843509793281555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030204473063349724, decouple_loss:0.0012419448466971517
The modified gen p mean: 0.449076384305954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029723912477493286, decouple_loss:0.0013078858610242605
The modified gen p mean: 0.44883760809898376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02871241793036461, decouple_loss:0.0013217467349022627
Iteration: 3122, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44873175024986267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030197083950042725, decouple_loss:0.0012739343801513314
The modified gen p mean: 0.4454292058944702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03054950013756752, decouple_loss:0.001461873180232942
The modified gen p mean: 0.4500683844089508, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029550699517130852, decouple_loss:0.0013472813880071044
Iteration: 3123, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44691672921180725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02953818254172802, decouple_loss:0.0012925880728289485
The modified gen p mean: 0.44735339283943176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029512479901313782, decouple_loss:0.0013419113820418715
The modified gen p mean: 0.4474948048591614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02969224750995636, decouple_loss:0.001385585288517177
Iteration: 3124, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44872915744781494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028019849210977554, decouple_loss:0.0013158997753635049
The modified gen p mean: 0.4494490921497345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0281208585947752, decouple_loss:0.0014088890748098493
The modified gen p mean: 0.4511709213256836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028804009780287743, decouple_loss:0.001426266273483634
Iteration: 3125, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44750335812568665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028236836194992065, decouple_loss:0.0013643387937918305
The modified gen p mean: 0.44846540689468384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028273260220885277, decouple_loss:0.0012934994883835316
The modified gen p mean: 0.4476170539855957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02960348315536976, decouple_loss:0.0012317030923441052
Iteration: 3126, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461434781551361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029617290943861008, decouple_loss:0.0012611134443432093
The modified gen p mean: 0.44860127568244934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029025385156273842, decouple_loss:0.0013312295777723193
The modified gen p mean: 0.4463976323604584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02879362553358078, decouple_loss:0.0012917008716613054
Iteration: 3127, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44832220673561096, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4470430016517639, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028667936101555824, decouple_loss:0.0013994488399475813
loss_pred:0.029465792700648308, decouple_loss:0.0014183068415150046
The modified gen p mean: 0.44703197479248047, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028612177819013596, decouple_loss:0.0013169796438887715
Iteration: 3128, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4525389075279236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028554117307066917, decouple_loss:0.0014720121398568153
The modified gen p mean: 0.4468609690666199, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029121847823262215, decouple_loss:0.0013290346832945943
The modified gen p mean: 0.45165717601776123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0284652728587389, decouple_loss:0.001359779154881835
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3129, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472542703151703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029227858409285545, decouple_loss:0.0013525071553885937
The modified gen p mean: 0.4505035877227783, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45284679532051086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027320250868797302, decouple_loss:0.0015526363858953118loss_pred:0.0263935886323452, decouple_loss:0.0012927761999890208
Iteration: 3130, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513547122478485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026286428794264793, decouple_loss:0.0012256590416654944
The modified gen p mean: 0.4517061710357666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025996599346399307, decouple_loss:0.0012552691623568535
The modified gen p mean: 0.44506824016571045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027471082285046577, decouple_loss:0.0013481291243806481
2023-05-27 02:03:25 testing...
The modified gen p mean: 0.4517623484134674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03247127681970596, decouple_loss:0.0015845262678340077
The modified gen p mean: 0.4495593011379242, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45153892040252686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032742828130722046, decouple_loss:0.0015282462118193507
loss_pred:0.03412552550435066, decouple_loss:0.0015571105759590864
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03319104015827179, avg_mse: 0.04516531154513359
current test mse: 0.045165
Iteration: 3131, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44533440470695496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0287250354886055, decouple_loss:0.0013891267590224743
The modified gen p mean: 0.45123419165611267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026390420272946358, decouple_loss:0.001330524100922048
The modified gen p mean: 0.44509875774383545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0271832924336195, decouple_loss:0.001558257034048438
Iteration: 3132, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460813105106354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02786453440785408, decouple_loss:0.0013609313173219562
The modified gen p mean: 0.4506462812423706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025786733254790306, decouple_loss:0.0013294045347720385
The modified gen p mean: 0.4461502134799957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027499273419380188, decouple_loss:0.0012725981650874019
Iteration: 3133, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4427180588245392, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027062246575951576, decouple_loss:0.0014532780041918159
The modified gen p mean: 0.4444445073604584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027137761935591698, decouple_loss:0.0014145727036520839
The modified gen p mean: 0.447939395904541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025765543803572655, decouple_loss:0.001355227897875011
Iteration: 3134, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44359636306762695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026837296783924103, decouple_loss:0.0013398461742326617
The modified gen p mean: 0.4463146924972534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026976250112056732, decouple_loss:0.001340479706414044
The modified gen p mean: 0.44482091069221497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02799847535789013, decouple_loss:0.0013965743128210306
Iteration: 3135, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467269778251648, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0271434485912323, decouple_loss:0.0013962555676698685
The modified gen p mean: 0.4463002681732178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026824215427041054, decouple_loss:0.0014957530656829476
The modified gen p mean: 0.44529029726982117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025819461792707443, decouple_loss:0.0014159930869936943
Iteration: 3136, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44495686888694763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027600308880209923, decouple_loss:0.0012242741649970412
The modified gen p mean: 0.4477655589580536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026645535603165627, decouple_loss:0.001280848286114633
The modified gen p mean: 0.4478769600391388, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027540942654013634, decouple_loss:0.0012709335424005985
Iteration: 3137, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492241144180298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026082418859004974, decouple_loss:0.0014740173937752843
The modified gen p mean: 0.44528982043266296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028279218822717667, decouple_loss:0.0012526466744020581
The modified gen p mean: 0.4489283263683319, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02679229900240898, decouple_loss:0.0013129387516528368
Iteration: 3138, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519203007221222, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026656463742256165, decouple_loss:0.001411659293808043
The modified gen p mean: 0.4478762149810791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02692408859729767, decouple_loss:0.0014239790616557002
The modified gen p mean: 0.4493087828159332, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02662096731364727, decouple_loss:0.0014104776782914996
Iteration: 3139, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44826334714889526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027631238102912903, decouple_loss:0.0012470133369788527
The modified gen p mean: 0.4477976858615875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026473483070731163, decouple_loss:0.0014140912098810077
The modified gen p mean: 0.4508460462093353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027407297864556313, decouple_loss:0.0014259376330301166
Iteration: 3140, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486074447631836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02797871083021164, decouple_loss:0.0013305378379300237
The modified gen p mean: 0.4503791332244873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027095509693026543, decouple_loss:0.0012708258582279086
The modified gen p mean: 0.4485528767108917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028294304385781288, decouple_loss:0.0016139840008690953
2023-05-27 02:07:31 testing...
The modified gen p mean: 0.4542960226535797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251609951257706, decouple_loss:0.0016464083455502987
The modified gen p mean: 0.45406341552734375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03431686758995056, decouple_loss:0.0016535804606974125
The modified gen p mean: 0.4522973299026489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283077850937843, decouple_loss:0.001631043036468327
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033303432166576385, avg_mse: 0.045384351164102554
current test mse: 0.045384
Iteration: 3141, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4523068070411682, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02642114832997322, decouple_loss:0.0015844417503103614
The modified gen p mean: 0.4499009847640991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026789017021656036, decouple_loss:0.0013580896193161607
The modified gen p mean: 0.45145171880722046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025991009548306465, decouple_loss:0.001555218710564077
Iteration: 3142, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473888874053955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026680640876293182, decouple_loss:0.0014861916424706578
The modified gen p mean: 0.4512430429458618, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026518655940890312, decouple_loss:0.0014185205800458789
The modified gen p mean: 0.4514365792274475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026617173105478287, decouple_loss:0.0013682337012141943
Iteration: 3143, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44553813338279724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027582533657550812, decouple_loss:0.001342219184152782
The modified gen p mean: 0.44552233815193176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026500141248106956, decouple_loss:0.001311223255470395
The modified gen p mean: 0.4445425570011139, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02772965282201767, decouple_loss:0.001593483961187303
Iteration: 3144, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452624022960663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02685086987912655, decouple_loss:0.0012653826270252466
The modified gen p mean: 0.4524056911468506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026725847274065018, decouple_loss:0.0014046194264665246
The modified gen p mean: 0.4471725523471832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026631956920027733, decouple_loss:0.001520924037322402
Iteration: 3145, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44879594445228577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02631775662302971, decouple_loss:0.0014666351489722729
The modified gen p mean: 0.44621413946151733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026695189997553825, decouple_loss:0.0013393727131187916
The modified gen p mean: 0.448624849319458, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026530275121331215, decouple_loss:0.001306605408899486
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr.npz
NaN value num: 0
Iteration: 3146, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501948952674866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026912663131952286, decouple_loss:0.0013615856878459454
The modified gen p mean: 0.45109468698501587, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4438803791999817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027521613985300064, decouple_loss:0.0013366597704589367
loss_pred:0.02650248445570469, decouple_loss:0.001397272921167314
Iteration: 3147, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466956853866577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027273785322904587, decouple_loss:0.0013049270492047071
The modified gen p mean: 0.44266924262046814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02753671072423458, decouple_loss:0.0012773231137543917
The modified gen p mean: 0.4501743018627167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02689851075410843, decouple_loss:0.001369809964671731
Iteration: 3148, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483200013637543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025863608345389366, decouple_loss:0.001493110554292798
The modified gen p mean: 0.445071816444397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02753637172281742, decouple_loss:0.001302588265389204
The modified gen p mean: 0.4432358741760254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028125418350100517, decouple_loss:0.001401678309775889
Iteration: 3149, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452325999736786, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44518259167671204, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02683509886264801, decouple_loss:0.0013172588078305125
loss_pred:0.02721988968551159, decouple_loss:0.00138087198138237
The modified gen p mean: 0.4487561583518982, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026712145656347275, decouple_loss:0.001531472778879106
Iteration: 3150, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44396576285362244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027461402118206024, decouple_loss:0.001323595060966909
The modified gen p mean: 0.4441232979297638, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026542842388153076, decouple_loss:0.0014162305742502213
The modified gen p mean: 0.4433780610561371, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029078250750899315, decouple_loss:0.0013902708888053894
2023-05-27 02:12:30 testing...
The modified gen p mean: 0.44962701201438904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255079686641693, decouple_loss:0.001560016768053174
The modified gen p mean: 0.44768813252449036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0328977108001709, decouple_loss:0.001431992626748979
The modified gen p mean: 0.44942164421081543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03429887071251869, decouple_loss:0.0015869576018303633
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0333254411816597, avg_mse: 0.04554866626858711
current test mse: 0.045549
Iteration: 3151, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4425579905509949, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026680123060941696, decouple_loss:0.0012815824011340737
The modified gen p mean: 0.44410642981529236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02773316763341427, decouple_loss:0.0013121833326295018
The modified gen p mean: 0.4481596350669861, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02796938829123974, decouple_loss:0.0014248719671741128
Iteration: 3152, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45062682032585144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026968147605657578, decouple_loss:0.001569989020936191
The modified gen p mean: 0.4461303949356079, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027858072891831398, decouple_loss:0.0013439205940812826
The modified gen p mean: 0.4509997069835663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0268048495054245, decouple_loss:0.0015546955401077867
Iteration: 3153, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4436839520931244, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4493231177330017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027482744306325912, decouple_loss:0.001338996342383325
loss_pred:0.02664724923670292, decouple_loss:0.0015024043386802077
The modified gen p mean: 0.445514440536499, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02620527148246765, decouple_loss:0.0012968964874744415
Iteration: 3154, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45208707451820374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02709498628973961, decouple_loss:0.0017078432720154524
The modified gen p mean: 0.44810763001441956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0264248326420784, decouple_loss:0.0015000893035903573
The modified gen p mean: 0.44510212540626526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02724050171673298, decouple_loss:0.0014347991673275828
Iteration: 3155, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472487270832062, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027032699435949326, decouple_loss:0.001281898352317512
The modified gen p mean: 0.44905370473861694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02697855979204178, decouple_loss:0.001264847000129521
The modified gen p mean: 0.4508269727230072, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026438651606440544, decouple_loss:0.0014659344451501966
Iteration: 3156, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513574242591858, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028034577146172523, decouple_loss:0.001368771307170391
The modified gen p mean: 0.45261791348457336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027005156502127647, decouple_loss:0.0013073233421891928
The modified gen p mean: 0.4544707238674164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026714986190199852, decouple_loss:0.0015165392542257905
Iteration: 3157, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515392780303955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026636552065610886, decouple_loss:0.001334206317551434
The modified gen p mean: 0.4499674141407013, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027804059907794, decouple_loss:0.0012821322306990623
The modified gen p mean: 0.45025181770324707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026823630556464195, decouple_loss:0.0014672511024400592
Iteration: 3158, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478219151496887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028855012729763985, decouple_loss:0.0012529155937954783
The modified gen p mean: 0.44745850563049316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026359694078564644, decouple_loss:0.0014276019064709544
The modified gen p mean: 0.44905877113342285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026852445676922798, decouple_loss:0.0014903458068147302
Iteration: 3159, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502287209033966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02693946473300457, decouple_loss:0.001425278838723898
The modified gen p mean: 0.45098087191581726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027200348675251007, decouple_loss:0.0013509406708180904
The modified gen p mean: 0.44755733013153076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027506565675139427, decouple_loss:0.001301044481806457
Iteration: 3160, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446164071559906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02711796574294567, decouple_loss:0.001245757914148271
The modified gen p mean: 0.4461768865585327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028717802837491035, decouple_loss:0.0012452991213649511
The modified gen p mean: 0.44545653462409973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02711017057299614, decouple_loss:0.0012592528946697712
2023-05-27 02:16:35 testing...
The modified gen p mean: 0.45214036107063293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246709331870079, decouple_loss:0.0014960343251004815
The modified gen p mean: 0.4519340693950653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03427418693900108, decouple_loss:0.0015581697225570679
The modified gen p mean: 0.4502182900905609, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032644953578710556, decouple_loss:0.001385882729664445
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03320274502038956, avg_mse: 0.04536020755767822
current test mse: 0.04536
Iteration: 3161, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449409246444702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02782340906560421, decouple_loss:0.0012497815769165754
The modified gen p mean: 0.44575953483581543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027873732149600983, decouple_loss:0.0014093498466536403
The modified gen p mean: 0.4508976340293884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026975581422448158, decouple_loss:0.0015817891107872128
Iteration: 3162, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499576985836029, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0253969207406044, decouple_loss:0.00140123232267797
The modified gen p mean: 0.4472123086452484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02699458971619606, decouple_loss:0.0013019269099459052
The modified gen p mean: 0.44837838411331177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027122627943754196, decouple_loss:0.0012510952074080706
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr.npz
NaN value num: 0
Iteration: 3163, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464934766292572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02683926746249199, decouple_loss:0.001292040222324431
The modified gen p mean: 0.44826218485832214, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44516822695732117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026123374700546265, decouple_loss:0.0013189035234972835
loss_pred:0.026088595390319824, decouple_loss:0.0012505485210567713
Iteration: 3164, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44522351026535034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02657724916934967, decouple_loss:0.0013809953816235065
The modified gen p mean: 0.44531017541885376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02623913064599037, decouple_loss:0.0013933235313743353
The modified gen p mean: 0.44352713227272034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026370616629719734, decouple_loss:0.0013314407551661134
Iteration: 3165, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4437931180000305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026384660974144936, decouple_loss:0.0013277182588353753
The modified gen p mean: 0.44483891129493713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02703932672739029, decouple_loss:0.0013538915663957596
The modified gen p mean: 0.4449603855609894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025479231029748917, decouple_loss:0.0012681713560596108
Iteration: 3166, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4429374039173126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025748595595359802, decouple_loss:0.0012068260693922639
The modified gen p mean: 0.44243189692497253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610417827963829, decouple_loss:0.0012242598459124565
The modified gen p mean: 0.44296595454216003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025727326050400734, decouple_loss:0.001259336480870843
Iteration: 3167, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44961902499198914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025235846638679504, decouple_loss:0.0014955824008211493
The modified gen p mean: 0.44831740856170654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025051908567547798, decouple_loss:0.0012636837782338262
The modified gen p mean: 0.4435756504535675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025866588577628136, decouple_loss:0.0012700727675110102
Iteration: 3168, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446430206298828, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4473312199115753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026246272027492523, decouple_loss:0.0014259314630180597
loss_pred:0.025706686079502106, decouple_loss:0.0014884331030771136
The modified gen p mean: 0.4440363347530365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02647031657397747, decouple_loss:0.0013493967708200216
Iteration: 3169, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472947120666504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02496015839278698, decouple_loss:0.0014206714695319533
The modified gen p mean: 0.44907325506210327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02583668939769268, decouple_loss:0.0013015668373554945
The modified gen p mean: 0.4445401728153229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026292338967323303, decouple_loss:0.0011179668363183737
Iteration: 3170, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473646879196167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02624727413058281, decouple_loss:0.0012593228602781892
The modified gen p mean: 0.4447697103023529, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027081144973635674, decouple_loss:0.0012110896641388535
The modified gen p mean: 0.4447252154350281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025994151830673218, decouple_loss:0.0011318657780066133
2023-05-27 02:21:25 testing...
The modified gen p mean: 0.4531814157962799, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0324774831533432, decouple_loss:0.001476490986533463
The modified gen p mean: 0.45290467143058777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034161586314439774, decouple_loss:0.0016002232441678643
The modified gen p mean: 0.4513039290904999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265179693698883, decouple_loss:0.0014746151864528656
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033172812312841415, avg_mse: 0.045327503234148026
current test mse: 0.045328
Iteration: 3171, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44847360253334045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02543703280389309, decouple_loss:0.0014538542600348592
The modified gen p mean: 0.44929543137550354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0257277674973011, decouple_loss:0.0012827292084693909
The modified gen p mean: 0.44580504298210144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026630880311131477, decouple_loss:0.0013775464612990618
Iteration: 3172, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471379220485687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612362615764141, decouple_loss:0.0014058486558496952
The modified gen p mean: 0.44832754135131836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025855043902993202, decouple_loss:0.0012192096328362823
The modified gen p mean: 0.4504912495613098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025189269334077835, decouple_loss:0.0013495867606252432
Iteration: 3173, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4521993100643158, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02591082826256752, decouple_loss:0.001319964649155736
The modified gen p mean: 0.4451278746128082, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027451196685433388, decouple_loss:0.0013492807047441602
The modified gen p mean: 0.446907639503479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025843355804681778, decouple_loss:0.0013944193487986922
Iteration: 3174, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443189799785614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02624567784368992, decouple_loss:0.0011830221628770232
The modified gen p mean: 0.4513629972934723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024852732196450233, decouple_loss:0.0012588042300194502
The modified gen p mean: 0.4494805335998535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025526177138090134, decouple_loss:0.0013980184448882937
Iteration: 3175, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481300413608551, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44804418087005615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025629296898841858, decouple_loss:0.0013503765221685171loss_pred:0.025722302496433258, decouple_loss:0.0013820984167978168
The modified gen p mean: 0.44492506980895996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02623787336051464, decouple_loss:0.0012548090890049934
Iteration: 3176, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446430802345276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02466718666255474, decouple_loss:0.0013707588659599423
The modified gen p mean: 0.44613122940063477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02549256570637226, decouple_loss:0.0013867021771147847
The modified gen p mean: 0.44482293725013733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026356488466262817, decouple_loss:0.001444112858735025
Iteration: 3177, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44249218702316284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027685020118951797, decouple_loss:0.001340858987532556
The modified gen p mean: 0.44442057609558105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02520298771560192, decouple_loss:0.0015909139765426517
The modified gen p mean: 0.4424872100353241, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027021056041121483, decouple_loss:0.001303198398090899
Iteration: 3178, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479790925979614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02586769126355648, decouple_loss:0.0014474684139713645
The modified gen p mean: 0.4485842287540436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024941733106970787, decouple_loss:0.0013927285326644778
The modified gen p mean: 0.4457889795303345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0261132400482893, decouple_loss:0.0013649552129209042
Iteration: 3179, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.440902978181839, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026602942496538162, decouple_loss:0.0013828322989866138
The modified gen p mean: 0.4421326220035553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026453286409378052, decouple_loss:0.0012961605098098516
The modified gen p mean: 0.4444214105606079, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612137608230114, decouple_loss:0.001266413601115346
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3180, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44524937868118286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028618991374969482, decouple_loss:0.0012833111686632037
The modified gen p mean: 0.44852787256240845, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44834104180336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028523266315460205, decouple_loss:0.0013495446182787418loss_pred:0.027412788942456245, decouple_loss:0.0013125750701874495
2023-05-27 02:26:17 testing...
The modified gen p mean: 0.4512080252170563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032452166080474854, decouple_loss:0.001427462906576693
The modified gen p mean: 0.44932374358177185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03266419842839241, decouple_loss:0.0014067139709368348
The modified gen p mean: 0.4509904682636261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03416444733738899, decouple_loss:0.001482289400883019
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033165544271469116, avg_mse: 0.0452948734164238
current test mse: 0.045295
Iteration: 3181, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448021799325943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027201887220144272, decouple_loss:0.001362331211566925
The modified gen p mean: 0.44752123951911926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02756810560822487, decouple_loss:0.0013626330764964223
The modified gen p mean: 0.4479510188102722, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027630189433693886, decouple_loss:0.001342814532108605
Iteration: 3182, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44885221123695374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02712118998169899, decouple_loss:0.0014701711479574442
The modified gen p mean: 0.4481215476989746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028135299682617188, decouple_loss:0.0012309373123571277
The modified gen p mean: 0.4500461518764496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028207408264279366, decouple_loss:0.001287439838051796
Iteration: 3183, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45365238189697266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02736196480691433, decouple_loss:0.0012903101742267609
The modified gen p mean: 0.45187968015670776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026959596201777458, decouple_loss:0.001382741262204945
The modified gen p mean: 0.4501150846481323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02937709353864193, decouple_loss:0.0013763458700850606
Iteration: 3184, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44934889674186707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02802182547748089, decouple_loss:0.0012536788126453757
The modified gen p mean: 0.45472291111946106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027101414278149605, decouple_loss:0.0014275964349508286
The modified gen p mean: 0.45307090878486633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690981701016426, decouple_loss:0.0014027394354343414
Iteration: 3185, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45201945304870605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028557870537042618, decouple_loss:0.0013037208700552583
The modified gen p mean: 0.44913914799690247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027679435908794403, decouple_loss:0.0013117488706484437
The modified gen p mean: 0.45085716247558594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027353735640645027, decouple_loss:0.0014275024877861142
Iteration: 3186, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534602165222168, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026004653424024582, decouple_loss:0.0014896153006702662
The modified gen p mean: 0.45412763953208923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027304159477353096, decouple_loss:0.0013625111896544695
The modified gen p mean: 0.4524569809436798, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02826746366918087, decouple_loss:0.0013571894960477948
Iteration: 3187, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44970694184303284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02959171123802662, decouple_loss:0.0014494037022814155
The modified gen p mean: 0.4537062644958496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026835797354578972, decouple_loss:0.001436319900676608
The modified gen p mean: 0.453787237405777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02733624540269375, decouple_loss:0.0014314709696918726
Iteration: 3188, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45189180970191956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027292445302009583, decouple_loss:0.0013469557743519545
The modified gen p mean: 0.4485464096069336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028935620561242104, decouple_loss:0.001292321365326643
The modified gen p mean: 0.45373669266700745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027276188135147095, decouple_loss:0.0013340654550120234
Iteration: 3189, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467903673648834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028283918276429176, decouple_loss:0.0013030116679146886
The modified gen p mean: 0.4456879496574402, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771574817597866, decouple_loss:0.001434544799849391
The modified gen p mean: 0.44999298453330994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02764907293021679, decouple_loss:0.0014019443187862635
Iteration: 3190, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44695979356765747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02700895071029663, decouple_loss:0.0013227452291175723
The modified gen p mean: 0.4461938440799713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02636830508708954, decouple_loss:0.0013382481411099434
The modified gen p mean: 0.4515131115913391, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02796785719692707, decouple_loss:0.0015465158503502607
2023-05-27 02:30:23 testing...
The modified gen p mean: 0.45021185278892517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261164203286171, decouple_loss:0.0015893848612904549
The modified gen p mean: 0.449885755777359, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034445784986019135, decouple_loss:0.0016230234177783132
The modified gen p mean: 0.44821956753730774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03312014415860176, decouple_loss:0.0015086336061358452
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033471208065748215, avg_mse: 0.04566553235054016
current test mse: 0.045666
Iteration: 3191, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441845417022705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027160953730344772, decouple_loss:0.001468201051466167
The modified gen p mean: 0.44859495759010315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027098363265395164, decouple_loss:0.0014905317220836878
The modified gen p mean: 0.4461054503917694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02704658918082714, decouple_loss:0.0014120046980679035
Iteration: 3192, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44612374901771545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027018025517463684, decouple_loss:0.0013710231287404895
The modified gen p mean: 0.4454262852668762, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027447963133454323, decouple_loss:0.001505135209299624
The modified gen p mean: 0.4497181475162506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02627994678914547, decouple_loss:0.0013059170451015234
Iteration: 3193, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44490858912467957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028168274089694023, decouple_loss:0.0012619603658095002
The modified gen p mean: 0.4456678032875061, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028351852670311928, decouple_loss:0.001466486370190978
The modified gen p mean: 0.4507705271244049, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027199121192097664, decouple_loss:0.0014215458650141954
Iteration: 3194, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45037341117858887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0268999170511961, decouple_loss:0.001393934478983283
The modified gen p mean: 0.4508632719516754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027231335639953613, decouple_loss:0.0014935112558305264
The modified gen p mean: 0.44756290316581726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026928892359137535, decouple_loss:0.0014864399563521147
Iteration: 3195, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44985297322273254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026820288971066475, decouple_loss:0.0013870637631043792
The modified gen p mean: 0.4481945037841797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026908360421657562, decouple_loss:0.0014177793636918068
The modified gen p mean: 0.45026442408561707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027844464406371117, decouple_loss:0.0013491770951077342
Iteration: 3196, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482409358024597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027795610949397087, decouple_loss:0.001346989651210606
The modified gen p mean: 0.4487825334072113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02678733505308628, decouple_loss:0.001319186994805932
The modified gen p mean: 0.4561402201652527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027698703110218048, decouple_loss:0.001388170407153666
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3197, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45118314027786255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027914585545659065, decouple_loss:0.0013168740551918745
The modified gen p mean: 0.4502500593662262, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45058178901672363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027678294107317924, decouple_loss:0.0014679540181532502
loss_pred:0.027656277641654015, decouple_loss:0.0014118262333795428
Iteration: 3198, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508618116378784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026293443515896797, decouple_loss:0.001498664729297161
The modified gen p mean: 0.44931626319885254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027603168040513992, decouple_loss:0.0014185990439727902
The modified gen p mean: 0.44918516278266907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025992553681135178, decouple_loss:0.0015822971472516656
Iteration: 3199, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4520932137966156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025721855461597443, decouple_loss:0.001434906735084951
The modified gen p mean: 0.45023947954177856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027426136657595634, decouple_loss:0.001319790375418961
The modified gen p mean: 0.45068296790122986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026964383199810982, decouple_loss:0.0017710839165374637
Iteration: 3200, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485102593898773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025982597842812538, decouple_loss:0.001459735445678234
The modified gen p mean: 0.4510584771633148, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0274412352591753, decouple_loss:0.0014484351268038154
The modified gen p mean: 0.44723978638648987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026624375954270363, decouple_loss:0.0013088624691590667
2023-05-27 02:35:11 testing...
The modified gen p mean: 0.45175886154174805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032816026359796524, decouple_loss:0.0015560531755909324
The modified gen p mean: 0.4496239423751831, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03323456645011902, decouple_loss:0.001498012337833643
The modified gen p mean: 0.45144593715667725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034767381846904755, decouple_loss:0.0015870181377977133
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03368334472179413, avg_mse: 0.0460604652762413
current test mse: 0.04606
Iteration: 3201, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499448537826538, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02621994912624359, decouple_loss:0.0012708707945421338
The modified gen p mean: 0.44636663794517517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02932976558804512, decouple_loss:0.0014033501502126455
The modified gen p mean: 0.44762834906578064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026614656671881676, decouple_loss:0.0013634591596201062
Iteration: 3202, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44541284441947937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027254192158579826, decouple_loss:0.00121711241081357
The modified gen p mean: 0.44893068075180054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02755003236234188, decouple_loss:0.0012823884608224034
The modified gen p mean: 0.44972506165504456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025640819221735, decouple_loss:0.001365984557196498
Iteration: 3203, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44707760214805603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026168838143348694, decouple_loss:0.0012658558553084731
The modified gen p mean: 0.44421932101249695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02765415795147419, decouple_loss:0.001265718718059361
The modified gen p mean: 0.4463537335395813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025722427293658257, decouple_loss:0.001361339702270925
Iteration: 3204, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44598183035850525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02549084648489952, decouple_loss:0.0013713453663513064
The modified gen p mean: 0.4491173326969147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027619659900665283, decouple_loss:0.0015401983400806785
The modified gen p mean: 0.44795894622802734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02591259963810444, decouple_loss:0.001400985405780375
Iteration: 3205, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491845369338989, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02699226140975952, decouple_loss:0.001365466509014368
The modified gen p mean: 0.4475129544734955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025544388219714165, decouple_loss:0.0014604126336053014
The modified gen p mean: 0.4491896629333496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02748720534145832, decouple_loss:0.0013517425395548344
Iteration: 3206, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44810500741004944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026520760729908943, decouple_loss:0.0014078993117436767
The modified gen p mean: 0.44651296734809875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027535410597920418, decouple_loss:0.001333283493295312
The modified gen p mean: 0.44621115922927856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027257243171334267, decouple_loss:0.001407944830134511
Iteration: 3207, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501473009586334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027382085099816322, decouple_loss:0.0014012826140969992
The modified gen p mean: 0.44881579279899597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02639826573431492, decouple_loss:0.0013681624550372362
The modified gen p mean: 0.4464624524116516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027305489405989647, decouple_loss:0.0012618110049515963
Iteration: 3208, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44803720712661743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02699568122625351, decouple_loss:0.0013571790186688304
The modified gen p mean: 0.44659265875816345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02786654606461525, decouple_loss:0.0013418918242678046
The modified gen p mean: 0.4464748799800873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027693793177604675, decouple_loss:0.0012665634276345372
Iteration: 3209, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45095664262771606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027580397203564644, decouple_loss:0.0013910910347476602
The modified gen p mean: 0.44409891963005066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028338851407170296, decouple_loss:0.0014112411299720407
The modified gen p mean: 0.451249361038208, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0258302204310894, decouple_loss:0.0012802501441910863
Iteration: 3210, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454789459705353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029227906838059425, decouple_loss:0.001245969906449318
The modified gen p mean: 0.4483413100242615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026177581399679184, decouple_loss:0.0013947781408205628
The modified gen p mean: 0.4474593698978424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026385437697172165, decouple_loss:0.0012362359557300806
2023-05-27 02:39:17 testing...
The modified gen p mean: 0.4528976082801819, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03291131556034088, decouple_loss:0.0014771184651181102
The modified gen p mean: 0.4505870044231415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033229611814022064, decouple_loss:0.0014773959992453456
The modified gen p mean: 0.45260652899742126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034765638411045074, decouple_loss:0.001543505466543138
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03371049091219902, avg_mse: 0.04613596200942993
current test mse: 0.046136
Iteration: 3211, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473857581615448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027010764926671982, decouple_loss:0.001251841546036303
The modified gen p mean: 0.44869521260261536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028228798881173134, decouple_loss:0.0012089035008102655
The modified gen p mean: 0.45146816968917847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026393180713057518, decouple_loss:0.0013309274800121784
Iteration: 3212, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453046917915344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028245920315384865, decouple_loss:0.001245735096745193
The modified gen p mean: 0.44867801666259766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025865718722343445, decouple_loss:0.0012768078595399857
The modified gen p mean: 0.4478869140148163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028167687356472015, decouple_loss:0.0012603526702150702
Iteration: 3213, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44628697633743286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027232546359300613, decouple_loss:0.0013020684709772468
The modified gen p mean: 0.44669318199157715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026819990947842598, decouple_loss:0.0013381566386669874
The modified gen p mean: 0.44809144735336304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028177296742796898, decouple_loss:0.001358934328891337
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr.npz
NaN value num: 0
Iteration: 3214, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44947755336761475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026715951040387154, decouple_loss:0.001412596320733428
The modified gen p mean: 0.44739511609077454, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4489193260669708, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027058660984039307, decouple_loss:0.0014323954237625003
loss_pred:0.026073157787322998, decouple_loss:0.00136856350582093
Iteration: 3215, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483277201652527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025721609592437744, decouple_loss:0.001509329304099083
The modified gen p mean: 0.4484875500202179, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02510727383196354, decouple_loss:0.0014481738908216357
The modified gen p mean: 0.44531023502349854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026438429951667786, decouple_loss:0.0012393714860081673
Iteration: 3216, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45090165734291077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025695394724607468, decouple_loss:0.0013328207423910499
The modified gen p mean: 0.44399094581604004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026241302490234375, decouple_loss:0.0013878027675673366
The modified gen p mean: 0.44553253054618835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026160575449466705, decouple_loss:0.0012846078025177121
Iteration: 3217, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475702941417694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025472640991210938, decouple_loss:0.001379290479235351
The modified gen p mean: 0.4497027099132538, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025706954300403595, decouple_loss:0.0014484302373602986
The modified gen p mean: 0.44315800070762634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026500089094042778, decouple_loss:0.0012337074149399996
Iteration: 3218, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4432069957256317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026676634326577187, decouple_loss:0.0014929320896044374
The modified gen p mean: 0.4426383376121521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025816842913627625, decouple_loss:0.0012768962187692523
The modified gen p mean: 0.4454783797264099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02659742161631584, decouple_loss:0.0012997499434277415
Iteration: 3219, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453302323818207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02633100189268589, decouple_loss:0.001281541190110147
The modified gen p mean: 0.44335612654685974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02668275125324726, decouple_loss:0.0013871763367205858
The modified gen p mean: 0.4491518437862396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025557801127433777, decouple_loss:0.0012878727866336703
Iteration: 3220, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4424858093261719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027380425482988358, decouple_loss:0.0012755560455843806
The modified gen p mean: 0.44614216685295105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025938550010323524, decouple_loss:0.0013805301859974861
The modified gen p mean: 0.44862687587738037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025266587734222412, decouple_loss:0.0013862206833437085
2023-05-27 02:43:56 testing...
The modified gen p mean: 0.44987285137176514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03278232738375664, decouple_loss:0.0015528857475146651
The modified gen p mean: 0.447721391916275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033024996519088745, decouple_loss:0.0014523993013426661
The modified gen p mean: 0.4496614336967468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03444529324769974, decouple_loss:0.0015831919154152274
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0334940105676651, avg_mse: 0.04587296023964882
current test mse: 0.045873
Iteration: 3221, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4436322748661041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027197621762752533, decouple_loss:0.0013888063840568066
The modified gen p mean: 0.4433603286743164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025948205962777138, decouple_loss:0.0012865017633885145
The modified gen p mean: 0.44458192586898804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026337869465351105, decouple_loss:0.0012618532637134194
Iteration: 3222, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510074555873871, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025688009336590767, decouple_loss:0.0013140958035364747
The modified gen p mean: 0.44771480560302734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02623557485640049, decouple_loss:0.0012247482081875205
The modified gen p mean: 0.4507521688938141, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025577474385499954, decouple_loss:0.0012399659026414156
Iteration: 3223, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44970178604125977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025495631620287895, decouple_loss:0.0013054362498223782
The modified gen p mean: 0.44605639576911926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02716698870062828, decouple_loss:0.0013540632789954543
The modified gen p mean: 0.4505741000175476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02542499452829361, decouple_loss:0.0013776374980807304
Iteration: 3224, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4524880051612854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025153128430247307, decouple_loss:0.0014191556256264448
The modified gen p mean: 0.44793257117271423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026250114664435387, decouple_loss:0.0012740985257551074
The modified gen p mean: 0.4494004249572754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025879571214318275, decouple_loss:0.0011434407206252217
Iteration: 3225, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44818055629730225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02707330510020256, decouple_loss:0.0012633784208446741
The modified gen p mean: 0.45412665605545044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025669444352388382, decouple_loss:0.001213529845699668
The modified gen p mean: 0.4520415961742401, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025833722203969955, decouple_loss:0.0012552624102681875
Iteration: 3226, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449581503868103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02587290294468403, decouple_loss:0.0012590407859534025
The modified gen p mean: 0.4512844383716583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02557769976556301, decouple_loss:0.0013253939105197787
The modified gen p mean: 0.45008304715156555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024897420778870583, decouple_loss:0.0014620261499658227
Iteration: 3227, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44581907987594604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026186523959040642, decouple_loss:0.0012773079797625542
The modified gen p mean: 0.4463687837123871, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02552093379199505, decouple_loss:0.0013154464541003108
The modified gen p mean: 0.4458251893520355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027482593432068825, decouple_loss:0.0012797758681699634
Iteration: 3228, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474087357521057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02703351527452469, decouple_loss:0.001399388536810875
The modified gen p mean: 0.4482024013996124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02594701759517193, decouple_loss:0.0013475518207997084
The modified gen p mean: 0.4452221691608429, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02642761543393135, decouple_loss:0.001376110129058361
Iteration: 3229, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447052925825119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02462763711810112, decouple_loss:0.0012843961594626307
The modified gen p mean: 0.4444219768047333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02595028094947338, decouple_loss:0.0012861010618507862
The modified gen p mean: 0.4425937235355377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02554735541343689, decouple_loss:0.0011770256096497178
Iteration: 3230, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44954413175582886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026251137256622314, decouple_loss:0.0012378052342683077
The modified gen p mean: 0.4454769194126129, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02663511410355568, decouple_loss:0.0013945882674306631
The modified gen p mean: 0.44393232464790344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02626989223062992, decouple_loss:0.0011056731455028057
2023-05-27 02:48:01 testing...
The modified gen p mean: 0.44979503750801086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03281779959797859, decouple_loss:0.0015022923471406102
The modified gen p mean: 0.4476274847984314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03288784995675087, decouple_loss:0.0013284363085404038
The modified gen p mean: 0.44964534044265747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034553881734609604, decouple_loss:0.0016063464572653174
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03349379450082779, avg_mse: 0.0459025576710701
current test mse: 0.045903
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr.npz
NaN value num: 0
Iteration: 3231, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457947313785553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02549142763018608, decouple_loss:0.0015580715844407678
The modified gen p mean: 0.4422846734523773, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44373491406440735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026496218517422676, decouple_loss:0.0013059634948149323
loss_pred:0.027018127962946892, decouple_loss:0.001260783290490508
Iteration: 3232, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44513851404190063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026727845892310143, decouple_loss:0.0013090114807710052
The modified gen p mean: 0.44152703881263733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02669862098991871, decouple_loss:0.0013876310549676418
The modified gen p mean: 0.44582778215408325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026300759986042976, decouple_loss:0.0013153892941772938
Iteration: 3233, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44359567761421204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02752355858683586, decouple_loss:0.00130983698181808
The modified gen p mean: 0.4461488723754883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025662975385785103, decouple_loss:0.0012413902441039681
The modified gen p mean: 0.4461718499660492, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025612905621528625, decouple_loss:0.0012460385914891958
Iteration: 3234, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456050395965576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027057599276304245, decouple_loss:0.0011750527191907167
The modified gen p mean: 0.4514086842536926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02552083320915699, decouple_loss:0.0013136634370312095
The modified gen p mean: 0.44700103998184204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026538288220763206, decouple_loss:0.0011956986272707582
Iteration: 3235, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4528750479221344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02575640194118023, decouple_loss:0.0013329223729670048
The modified gen p mean: 0.447561651468277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026487234979867935, decouple_loss:0.0013139965012669563
The modified gen p mean: 0.44607552886009216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027299508452415466, decouple_loss:0.0012230116408318281
Iteration: 3236, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45128780603408813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026160115376114845, decouple_loss:0.0013970882864668965
The modified gen p mean: 0.4493373930454254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026872623711824417, decouple_loss:0.001278569339774549
The modified gen p mean: 0.4530245363712311, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02632950432598591, decouple_loss:0.0014712843112647533
Iteration: 3237, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4526275098323822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025338664650917053, decouple_loss:0.0013710701605305076
The modified gen p mean: 0.45206931233406067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026010075584053993, decouple_loss:0.0012723576510325074
The modified gen p mean: 0.44895467162132263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02683553844690323, decouple_loss:0.0012386507587507367
Iteration: 3238, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4523017406463623, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025988738983869553, decouple_loss:0.001269098836928606
The modified gen p mean: 0.44780564308166504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027624953538179398, decouple_loss:0.0014001658419147134
The modified gen p mean: 0.45271989703178406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026431748643517494, decouple_loss:0.0012732826871797442
Iteration: 3239, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450253427028656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02584441378712654, decouple_loss:0.001357210916467011
The modified gen p mean: 0.45168861746788025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025075389072299004, decouple_loss:0.0013624881394207478
The modified gen p mean: 0.450608491897583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025370938703417778, decouple_loss:0.0013149132719263434
Iteration: 3240, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44450315833091736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027011703699827194, decouple_loss:0.0015884198946878314
The modified gen p mean: 0.44909194111824036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024987269192934036, decouple_loss:0.0014242036268115044
The modified gen p mean: 0.45022860169410706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025364534929394722, decouple_loss:0.0013719031121581793
2023-05-27 02:52:49 testing...
The modified gen p mean: 0.45178478956222534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254004195332527, decouple_loss:0.001429165480658412
The modified gen p mean: 0.4516592025756836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034308478236198425, decouple_loss:0.0015895114047452807
The modified gen p mean: 0.4497871398925781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032760974019765854, decouple_loss:0.001347887795418501
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033275943249464035, avg_mse: 0.04547950625419617
current test mse: 0.04548
Iteration: 3241, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44512027502059937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026985179632902145, decouple_loss:0.0014058317756280303
The modified gen p mean: 0.4496406316757202, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026120785623788834, decouple_loss:0.0014448927249759436
The modified gen p mean: 0.449736624956131, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02573978342115879, decouple_loss:0.0014590331120416522
Iteration: 3242, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44428765773773193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026581553742289543, decouple_loss:0.001366203185170889
The modified gen p mean: 0.4429367184638977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026677802205085754, decouple_loss:0.0014599201967939734
The modified gen p mean: 0.44756656885147095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025384709239006042, decouple_loss:0.0014558718539774418
Iteration: 3243, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456348717212677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025327201932668686, decouple_loss:0.0013742683222517371
The modified gen p mean: 0.4478984773159027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612907998263836, decouple_loss:0.001296616392210126
The modified gen p mean: 0.4440450966358185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673138864338398, decouple_loss:0.001318947528488934
Iteration: 3244, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4411536157131195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02689681574702263, decouple_loss:0.001288732630200684
The modified gen p mean: 0.44162195920944214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027079466730356216, decouple_loss:0.0013737562112510204
The modified gen p mean: 0.4444841742515564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024524960666894913, decouple_loss:0.001428204239346087
Iteration: 3245, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463112950325012, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026466891169548035, decouple_loss:0.0012912878300994635
The modified gen p mean: 0.44171345233917236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026641158387064934, decouple_loss:0.0011864822590723634
The modified gen p mean: 0.4448584318161011, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02659667283296585, decouple_loss:0.0013109823921695352
Iteration: 3246, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451398551464081, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02533920295536518, decouple_loss:0.0012545210774987936
The modified gen p mean: 0.44111594557762146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027240095660090446, decouple_loss:0.0012485779589042068
The modified gen p mean: 0.4440183639526367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025156162679195404, decouple_loss:0.001396184554323554
Iteration: 3247, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456682801246643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02527524158358574, decouple_loss:0.001384454546496272
The modified gen p mean: 0.4443890154361725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024378683418035507, decouple_loss:0.0012897939886897802
The modified gen p mean: 0.44660690426826477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024720145389437675, decouple_loss:0.0012904832838103175
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr.npz
NaN value num: 0
Iteration: 3248, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468128979206085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02589033916592598, decouple_loss:0.0016096940962597728
The modified gen p mean: 0.4460195302963257, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4500238001346588, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025857651606202126, decouple_loss:0.0013714935630559921
loss_pred:0.026864822953939438, decouple_loss:0.0012526994105428457
Iteration: 3249, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491526186466217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025544095784425735, decouple_loss:0.0013600183883681893
The modified gen p mean: 0.44949570298194885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025879185646772385, decouple_loss:0.0013799904845654964
The modified gen p mean: 0.4499870240688324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026617856696248055, decouple_loss:0.0014228766085579991
Iteration: 3250, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45358389616012573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026392946019768715, decouple_loss:0.001442192355170846
The modified gen p mean: 0.45087000727653503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025982890278100967, decouple_loss:0.001413819962181151
The modified gen p mean: 0.4495103061199188, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026649339124560356, decouple_loss:0.0013724842574447393
2023-05-27 02:57:36 testing...
The modified gen p mean: 0.45636364817619324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0325503945350647, decouple_loss:0.001494313240982592
The modified gen p mean: 0.4543141722679138, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03284357860684395, decouple_loss:0.0013269984629005194
The modified gen p mean: 0.4561956822872162, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03427768871188164, decouple_loss:0.00160052883438766
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0332975834608078, avg_mse: 0.04553370177745819
current test mse: 0.045534
Iteration: 3251, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4549640715122223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025770284235477448, decouple_loss:0.0012735952623188496
The modified gen p mean: 0.45583832263946533, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02681356482207775, decouple_loss:0.0013891591224819422
The modified gen p mean: 0.44930410385131836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028168795630335808, decouple_loss:0.0014318644534796476
Iteration: 3252, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512768089771271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027221284806728363, decouple_loss:0.001400468754582107
The modified gen p mean: 0.4547034800052643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025390958413481712, decouple_loss:0.0014598900452256203
The modified gen p mean: 0.4529566466808319, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02530704066157341, decouple_loss:0.0014297591987997293
Iteration: 3253, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534107744693756, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44870346784591675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722272463142872, decouple_loss:0.0012988701928406954
loss_pred:0.026722457259893417, decouple_loss:0.0012537986040115356
The modified gen p mean: 0.4546207785606384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02621358260512352, decouple_loss:0.0013363079633563757
Iteration: 3254, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45228976011276245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025580478832125664, decouple_loss:0.0013818454463034868
The modified gen p mean: 0.44872257113456726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027275176718831062, decouple_loss:0.0014230611268430948
The modified gen p mean: 0.45090046525001526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025865694507956505, decouple_loss:0.0012783934362232685
Iteration: 3255, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45387575030326843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025601206347346306, decouple_loss:0.001320378971286118
The modified gen p mean: 0.45227137207984924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026464521884918213, decouple_loss:0.0013455264270305634
The modified gen p mean: 0.448052316904068, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02587117999792099, decouple_loss:0.0013315512333065271
Iteration: 3256, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44444969296455383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027569212019443512, decouple_loss:0.0013452456332743168
The modified gen p mean: 0.4453468322753906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027007251977920532, decouple_loss:0.001214934978634119
The modified gen p mean: 0.4452216625213623, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027859603986144066, decouple_loss:0.0012252316810190678
Iteration: 3257, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44843924045562744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027734456583857536, decouple_loss:0.0013697224203497171
The modified gen p mean: 0.44913333654403687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02511230669915676, decouple_loss:0.0012666793772950768
The modified gen p mean: 0.4420055150985718, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027102302759885788, decouple_loss:0.0012691771844401956
Iteration: 3258, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483119249343872, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02653987891972065, decouple_loss:0.0015975143760442734
The modified gen p mean: 0.44333234429359436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02672862447798252, decouple_loss:0.0013868184760212898
The modified gen p mean: 0.45003631711006165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0266782995313406, decouple_loss:0.0013469250407069921
Iteration: 3259, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464320242404938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025741592049598694, decouple_loss:0.0012973372358828783
The modified gen p mean: 0.44593873620033264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026436710730195045, decouple_loss:0.0012570272665470839
The modified gen p mean: 0.4443739652633667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026178531348705292, decouple_loss:0.0011313586728647351
Iteration: 3260, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45070040225982666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02585803158581257, decouple_loss:0.0013619564706459641
The modified gen p mean: 0.45049649477005005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02571575716137886, decouple_loss:0.0012440001592040062
The modified gen p mean: 0.44877293705940247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02602960541844368, decouple_loss:0.001349155674688518
2023-05-27 03:01:42 testing...
The modified gen p mean: 0.4533557891845703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032592371106147766, decouple_loss:0.0014616814441978931
The modified gen p mean: 0.45317545533180237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034348756074905396, decouple_loss:0.0015535083366557956
The modified gen p mean: 0.4513513147830963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0328550860285759, decouple_loss:0.001354470499791205
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03333823382854462, avg_mse: 0.045577872544527054
current test mse: 0.045578
Iteration: 3261, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4528856575489044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026647500693798065, decouple_loss:0.0012607031967490911
The modified gen p mean: 0.4472072124481201, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025705475360155106, decouple_loss:0.0012146682711318135
The modified gen p mean: 0.45044365525245667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026430552825331688, decouple_loss:0.0013818128500133753
Iteration: 3262, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504353702068329, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025623956695199013, decouple_loss:0.001328382990323007
The modified gen p mean: 0.44802358746528625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02593538723886013, decouple_loss:0.001307506114244461
The modified gen p mean: 0.4484628438949585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690962888300419, decouple_loss:0.0012914480175822973
Iteration: 3263, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44981205463409424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025434022769331932, decouple_loss:0.0012864695163443685
The modified gen p mean: 0.4469020664691925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026185566559433937, decouple_loss:0.0013403845950961113
The modified gen p mean: 0.45270654559135437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025655701756477356, decouple_loss:0.0013056403258815408
Iteration: 3264, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487997889518738, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027115782722830772, decouple_loss:0.0012866012984886765
The modified gen p mean: 0.4478350281715393, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02757578156888485, decouple_loss:0.0013244998408481479
The modified gen p mean: 0.4456470012664795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026816681027412415, decouple_loss:0.0012210579589009285
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3265, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45263782143592834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02666216902434826, decouple_loss:0.0012705553090199828
The modified gen p mean: 0.4490780532360077, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4535798728466034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026528257876634598, decouple_loss:0.0012382881250232458
loss_pred:0.027377964928746223, decouple_loss:0.0012886507902294397
Iteration: 3266, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490194320678711, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026449598371982574, decouple_loss:0.001301007461734116
The modified gen p mean: 0.4517238438129425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026399826630949974, decouple_loss:0.0011697415029630065
The modified gen p mean: 0.45050618052482605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0257717277854681, decouple_loss:0.001184131600894034
Iteration: 3267, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495430588722229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026191305369138718, decouple_loss:0.001173503347672522
The modified gen p mean: 0.4495459198951721, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026036569848656654, decouple_loss:0.001297235838137567
The modified gen p mean: 0.452029824256897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02699897810816765, decouple_loss:0.00120298913680017
Iteration: 3268, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45080527663230896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771248109638691, decouple_loss:0.0013850464019924402
The modified gen p mean: 0.45190995931625366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026804182678461075, decouple_loss:0.0011992487125098705
The modified gen p mean: 0.4479014277458191, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026599906384944916, decouple_loss:0.0012730078306049109
Iteration: 3269, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534185826778412, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026987383142113686, decouple_loss:0.0012634770246222615
The modified gen p mean: 0.45109257102012634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025480885058641434, decouple_loss:0.0012898436980322003
The modified gen p mean: 0.44607827067375183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026791878044605255, decouple_loss:0.0012769800378009677
Iteration: 3270, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490576386451721, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026270128786563873, decouple_loss:0.0012065652990713716
The modified gen p mean: 0.4475056231021881, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026061367243528366, decouple_loss:0.001190483570098877
The modified gen p mean: 0.4459250569343567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02710464969277382, decouple_loss:0.0012616809690371156
2023-05-27 03:06:43 testing...
The modified gen p mean: 0.4529052674770355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03263910114765167, decouple_loss:0.0015273245517164469
The modified gen p mean: 0.4509499669075012, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45272111892700195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03295111656188965, decouple_loss:0.0013710029888898134
loss_pred:0.03447219356894493, decouple_loss:0.0016197451623156667
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03342944011092186, avg_mse: 0.04563888907432556
current test mse: 0.045639
Iteration: 3271, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44637516140937805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026393361389636993, decouple_loss:0.0012158103054389358
The modified gen p mean: 0.45209062099456787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026203101500868797, decouple_loss:0.001195825170725584
The modified gen p mean: 0.4480140805244446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028299547731876373, decouple_loss:0.001275929738767445
Iteration: 3272, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44763705134391785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025954946875572205, decouple_loss:0.0013083989033475518
The modified gen p mean: 0.44403204321861267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027512185275554657, decouple_loss:0.0012781379045918584
The modified gen p mean: 0.44933339953422546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026051050052046776, decouple_loss:0.0014156799297779799
Iteration: 3273, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451977401971817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025998761877417564, decouple_loss:0.001301413751207292
The modified gen p mean: 0.4468468725681305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028297442942857742, decouple_loss:0.0013039448531344533
The modified gen p mean: 0.44618186354637146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026725443080067635, decouple_loss:0.0012924784095957875
Iteration: 3274, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45108258724212646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02550084888935089, decouple_loss:0.0013941745273768902
The modified gen p mean: 0.44920116662979126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026277795433998108, decouple_loss:0.001358254929073155
The modified gen p mean: 0.4529658854007721, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025834962725639343, decouple_loss:0.0013669913168996572
Iteration: 3275, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441637098789215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027784962207078934, decouple_loss:0.0012631474528461695
The modified gen p mean: 0.4465702772140503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027125010266900063, decouple_loss:0.001256969990208745
The modified gen p mean: 0.44502657651901245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027888860553503036, decouple_loss:0.001293218694627285
Iteration: 3276, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44636476039886475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027012212201952934, decouple_loss:0.0012726978166028857
The modified gen p mean: 0.44990459084510803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025879045948386192, decouple_loss:0.0014370341086760163
The modified gen p mean: 0.44712260365486145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025630420073866844, decouple_loss:0.0013651662738993764
Iteration: 3277, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44975996017456055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025744231417775154, decouple_loss:0.0013480508932843804
The modified gen p mean: 0.4445838928222656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027086172252893448, decouple_loss:0.001296967500820756
The modified gen p mean: 0.4445602297782898, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027242716401815414, decouple_loss:0.0014073969796299934
Iteration: 3278, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463774859905243, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025679953396320343, decouple_loss:0.0013101650401949883
The modified gen p mean: 0.4453125596046448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0266929492354393, decouple_loss:0.0012811408378183842
The modified gen p mean: 0.44901302456855774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026045331731438637, decouple_loss:0.0014537307433784008
Iteration: 3279, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473022520542145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026617296040058136, decouple_loss:0.0012813863577321172
The modified gen p mean: 0.4441562592983246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027059150859713554, decouple_loss:0.0012169949477538466
The modified gen p mean: 0.4472353160381317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026792926713824272, decouple_loss:0.0014361478388309479
Iteration: 3280, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44808298349380493, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027205852791666985, decouple_loss:0.0013639109674841166
The modified gen p mean: 0.4504992961883545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026652473956346512, decouple_loss:0.0013832399854436517
The modified gen p mean: 0.4506894052028656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027284815907478333, decouple_loss:0.0014117490500211716
2023-05-27 03:10:50 testing...
The modified gen p mean: 0.4543733596801758, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03316166251897812, decouple_loss:0.0016059918561950326
The modified gen p mean: 0.4542091488838196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0350310355424881, decouple_loss:0.0017006691778078675
The modified gen p mean: 0.4524711072444916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03356766700744629, decouple_loss:0.0015113307163119316
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.034000422805547714, avg_mse: 0.04651624336838722
current test mse: 0.046516
Iteration: 3281, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45157885551452637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02641715481877327, decouple_loss:0.001444063731469214
The modified gen p mean: 0.4513363242149353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027038201689720154, decouple_loss:0.0014049193123355508
The modified gen p mean: 0.45402225852012634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026911668479442596, decouple_loss:0.0013149525038897991
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr.npz
NaN value num: 0
Iteration: 3282, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45325225591659546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025002988055348396, decouple_loss:0.0015399178955703974
The modified gen p mean: 0.447583943605423, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45260748267173767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026905756443738937, decouple_loss:0.0014052254846319556
loss_pred:0.026584895327687263, decouple_loss:0.0015016332035884261
Iteration: 3283, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4538116455078125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02548457495868206, decouple_loss:0.0014208178035914898
The modified gen p mean: 0.4496525824069977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02668718993663788, decouple_loss:0.00143156829290092
The modified gen p mean: 0.4493215084075928, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02573218382894993, decouple_loss:0.0016394443809986115
Iteration: 3284, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447252094745636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026655087247490883, decouple_loss:0.0013872015988454223
The modified gen p mean: 0.45023810863494873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026257392019033432, decouple_loss:0.001390971359796822
The modified gen p mean: 0.4515821933746338, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024915076792240143, decouple_loss:0.00154120905790478
Iteration: 3285, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482116103172302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026170747354626656, decouple_loss:0.0014597560511901975
The modified gen p mean: 0.4463518261909485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027594493702054024, decouple_loss:0.001323523698374629
The modified gen p mean: 0.44839560985565186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026585262268781662, decouple_loss:0.0015402836725115776
Iteration: 3286, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470297694206238, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02734738029539585, decouple_loss:0.0013283640146255493
The modified gen p mean: 0.4520539343357086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025991808623075485, decouple_loss:0.0012962565524503589
The modified gen p mean: 0.4499102234840393, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025333991274237633, decouple_loss:0.0013316773111000657
Iteration: 3287, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442620575428009, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027590468525886536, decouple_loss:0.0012550516985356808
The modified gen p mean: 0.4459434449672699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673259936273098, decouple_loss:0.0012597336899489164
The modified gen p mean: 0.451079785823822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02607327327132225, decouple_loss:0.0014079944230616093
Iteration: 3288, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500367343425751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02551264502108097, decouple_loss:0.0014012696919962764
The modified gen p mean: 0.44779497385025024, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026053229346871376, decouple_loss:0.0012920834124088287
The modified gen p mean: 0.4503892958164215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02686268649995327, decouple_loss:0.0015273041790351272
Iteration: 3289, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44460225105285645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02589005045592785, decouple_loss:0.0014498797245323658
The modified gen p mean: 0.4441278874874115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026696715503931046, decouple_loss:0.001125598093494773
The modified gen p mean: 0.4465188682079315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025575734674930573, decouple_loss:0.0013312611263245344
Iteration: 3290, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446052223443985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026715239509940147, decouple_loss:0.0013257901882752776
The modified gen p mean: 0.44443970918655396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026160914450883865, decouple_loss:0.0012755227508023381
The modified gen p mean: 0.44832751154899597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025560328736901283, decouple_loss:0.0012654936872422695
2023-05-27 03:15:41 testing...
The modified gen p mean: 0.4519527852535248, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03264694660902023, decouple_loss:0.001476043718867004
The modified gen p mean: 0.4516633152961731, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03434178605675697, decouple_loss:0.0015530830714851618
The modified gen p mean: 0.450156569480896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03287729248404503, decouple_loss:0.001347688608802855
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03336162120103836, avg_mse: 0.04552573338150978
current test mse: 0.045526
Iteration: 3291, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44571125507354736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026913659647107124, decouple_loss:0.0012075342237949371
The modified gen p mean: 0.4462059438228607, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027249405160546303, decouple_loss:0.001226147054694593
The modified gen p mean: 0.4465409517288208, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02765779383480549, decouple_loss:0.0014382163062691689
Iteration: 3292, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44540324807167053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026931561529636383, decouple_loss:0.0012328674783930182
The modified gen p mean: 0.4470553696155548, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026333056390285492, decouple_loss:0.0013304875465109944
The modified gen p mean: 0.446256160736084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02653493918478489, decouple_loss:0.001261634868569672
Iteration: 3293, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45056650042533875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025863543152809143, decouple_loss:0.0013774735853075981
The modified gen p mean: 0.44575485587120056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02677224762737751, decouple_loss:0.0012051297817379236
The modified gen p mean: 0.45016440749168396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025379346683621407, decouple_loss:0.0012468976201489568
Iteration: 3294, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448308527469635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027030814439058304, decouple_loss:0.001319188391789794
The modified gen p mean: 0.4458111822605133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02741205506026745, decouple_loss:0.0013637463562190533
The modified gen p mean: 0.4430541396141052, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027121853083372116, decouple_loss:0.0012456332333385944
Iteration: 3295, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44784802198410034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027085047215223312, decouple_loss:0.0013075305614620447
The modified gen p mean: 0.45138320326805115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025104988366365433, decouple_loss:0.001365936128422618
The modified gen p mean: 0.45238998532295227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025043204426765442, decouple_loss:0.00140041031409055
Iteration: 3296, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490850865840912, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024233132600784302, decouple_loss:0.0013936895411461592
The modified gen p mean: 0.4492303431034088, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025075336918234825, decouple_loss:0.0012613784056156874
The modified gen p mean: 0.4487263262271881, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02500731684267521, decouple_loss:0.0013464093208312988
Iteration: 3297, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472872018814087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02704511396586895, decouple_loss:0.0012767681619152427
The modified gen p mean: 0.45045313239097595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024465296417474747, decouple_loss:0.0013866026420146227
The modified gen p mean: 0.4457889199256897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02712300419807434, decouple_loss:0.0013873405987396836
Iteration: 3298, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44742709398269653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722836099565029, decouple_loss:0.001345944358035922
The modified gen p mean: 0.4453358054161072, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02677108906209469, decouple_loss:0.0012451993534341455
The modified gen p mean: 0.44995173811912537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026073109358549118, decouple_loss:0.001220367499627173
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3299, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44972556829452515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03108508698642254, decouple_loss:0.0011821542866528034
The modified gen p mean: 0.4483739137649536, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4485991299152374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031052203848958015, decouple_loss:0.0013142818352207541
loss_pred:0.030640514567494392, decouple_loss:0.001278811483643949
Iteration: 3300, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501889944076538, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031198635697364807, decouple_loss:0.0012998415622860193
The modified gen p mean: 0.4537944495677948, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02966967225074768, decouple_loss:0.0013973606983199716
The modified gen p mean: 0.4511485993862152, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02865702472627163, decouple_loss:0.0013940727803856134
2023-05-27 03:20:28 testing...
The modified gen p mean: 0.4551447927951813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032454248517751694, decouple_loss:0.0014974179212003946
The modified gen p mean: 0.4531457722187042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03264457359910011, decouple_loss:0.0013862877385690808
The modified gen p mean: 0.4548325836658478, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034169577062129974, decouple_loss:0.0016193549381569028
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03316451609134674, avg_mse: 0.04516074061393738
current test mse: 0.045161
Iteration: 3301, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4531686305999756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03022974543273449, decouple_loss:0.001614703331142664
The modified gen p mean: 0.45101234316825867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02968333289027214, decouple_loss:0.0013076483737677336
The modified gen p mean: 0.45372551679611206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02895198203623295, decouple_loss:0.001328488695435226
Iteration: 3302, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4548018276691437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03146148845553398, decouple_loss:0.001374819315969944
The modified gen p mean: 0.45357540249824524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02950015291571617, decouple_loss:0.0014536154922097921
The modified gen p mean: 0.4522474706172943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03047311119735241, decouple_loss:0.0012281652307137847
Iteration: 3303, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45520249009132385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029115892946720123, decouple_loss:0.0013290692586451769
The modified gen p mean: 0.4532988667488098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029748866334557533, decouple_loss:0.0012418939732015133
The modified gen p mean: 0.4505883455276489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03021680936217308, decouple_loss:0.0012705089757218957
Iteration: 3304, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45347756147384644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028605515137314796, decouple_loss:0.0013097521150484681
The modified gen p mean: 0.45345017313957214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0295611210167408, decouple_loss:0.0015115903224796057
The modified gen p mean: 0.4576858878135681, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0299904253333807, decouple_loss:0.0013095862232148647
Iteration: 3305, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450353741645813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031643811613321304, decouple_loss:0.0012852044310420752
The modified gen p mean: 0.45505666732788086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0288349948823452, decouple_loss:0.0014612419763579965
The modified gen p mean: 0.4528275728225708, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030388737097382545, decouple_loss:0.0012152628041803837
Iteration: 3306, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510924816131592, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029870254918932915, decouple_loss:0.0012555117718875408
The modified gen p mean: 0.45383626222610474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02968585304915905, decouple_loss:0.0015238962369039655
The modified gen p mean: 0.4484826326370239, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030558865517377853, decouple_loss:0.001366893877275288
Iteration: 3307, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45205771923065186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031054330989718437, decouple_loss:0.0013324449537321925
The modified gen p mean: 0.45250847935676575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031071845442056656, decouple_loss:0.0013861501356586814
The modified gen p mean: 0.4491923153400421, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030315350741147995, decouple_loss:0.001319794449955225
Iteration: 3308, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44633275270462036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031707338988780975, decouple_loss:0.0013271666830405593
The modified gen p mean: 0.44704917073249817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029380114749073982, decouple_loss:0.0011947167804464698
The modified gen p mean: 0.4458523988723755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030130138620734215, decouple_loss:0.0013311055954545736
Iteration: 3309, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464309513568878, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0304800383746624, decouple_loss:0.0012257458874955773
The modified gen p mean: 0.4410938024520874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030692577362060547, decouple_loss:0.001430197269655764
The modified gen p mean: 0.4449915289878845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030998878180980682, decouple_loss:0.0013229440664872527
Iteration: 3310, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44904860854148865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030023496598005295, decouple_loss:0.0013097296468913555
The modified gen p mean: 0.4473493695259094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029796209186315536, decouple_loss:0.0013347931671887636
The modified gen p mean: 0.44858574867248535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03011328913271427, decouple_loss:0.001395700266584754
2023-05-27 03:24:32 testing...
The modified gen p mean: 0.44760382175445557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032165367156267166, decouple_loss:0.0014411784941330552
The modified gen p mean: 0.4455854594707489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032541871070861816, decouple_loss:0.0014218443538993597
The modified gen p mean: 0.44697943329811096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03403150662779808, decouple_loss:0.0015523988986387849
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03298650681972504, avg_mse: 0.0447828583419323
current test mse: 0.044783
Iteration: 3311, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44640007615089417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029637232422828674, decouple_loss:0.0016039340989664197
The modified gen p mean: 0.44329404830932617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030330289155244827, decouple_loss:0.0013806911883875728
The modified gen p mean: 0.44764378666877747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029754366725683212, decouple_loss:0.0013780065346509218
Iteration: 3312, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44461801648139954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029281821101903915, decouple_loss:0.0013103412929922342
The modified gen p mean: 0.4449329972267151, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031699322164058685, decouple_loss:0.0013131782179698348
The modified gen p mean: 0.4454443156719208, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029746081680059433, decouple_loss:0.00137246900703758
Iteration: 3313, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44950419664382935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03146535903215408, decouple_loss:0.0013416414149105549
The modified gen p mean: 0.4453732371330261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02943328581750393, decouple_loss:0.0012446066830307245
The modified gen p mean: 0.44801759719848633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03158261626958847, decouple_loss:0.0013233028585091233
Iteration: 3314, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4511737525463104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02958163619041443, decouple_loss:0.0014731420669704676
The modified gen p mean: 0.45260196924209595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030611952766776085, decouple_loss:0.0013864324428141117
The modified gen p mean: 0.44656309485435486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030062951147556305, decouple_loss:0.0012540356256067753
Iteration: 3315, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4521205723285675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031312186270952225, decouple_loss:0.00134145631454885
The modified gen p mean: 0.45218199491500854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030994722619652748, decouple_loss:0.0013706502504646778
The modified gen p mean: 0.45032748579978943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03057274781167507, decouple_loss:0.0013428153470158577
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3316, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45065054297447205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027721170336008072, decouple_loss:0.0013595791533589363
The modified gen p mean: 0.44967690110206604, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45198875665664673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026644956320524216, decouple_loss:0.0015397201059386134
loss_pred:0.027370253577828407, decouple_loss:0.001212680246680975
Iteration: 3317, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.453083872795105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027006372809410095, decouple_loss:0.0013597881188616157
The modified gen p mean: 0.4484682083129883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02749861590564251, decouple_loss:0.0014074038481339812
The modified gen p mean: 0.45381346344947815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02667040191590786, decouple_loss:0.001471880474127829
Iteration: 3318, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514767825603485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025979114696383476, decouple_loss:0.0014499633107334375
The modified gen p mean: 0.45081958174705505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025064663961529732, decouple_loss:0.0014546558959409595
The modified gen p mean: 0.4482218027114868, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02629324607551098, decouple_loss:0.0013706473400816321
Iteration: 3319, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473640024662018, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478721022605896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028312793001532555, decouple_loss:0.0012765295105054975
loss_pred:0.027994850650429726, decouple_loss:0.0014241109602153301
The modified gen p mean: 0.4451078772544861, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02611423283815384, decouple_loss:0.001331873587332666
Iteration: 3320, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44983941316604614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026472801342606544, decouple_loss:0.001402036170475185
The modified gen p mean: 0.4459279179573059, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028587084263563156, decouple_loss:0.0013084843521937728
The modified gen p mean: 0.44827836751937866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02649516426026821, decouple_loss:0.0014290714170783758
2023-05-27 03:29:24 testing...
The modified gen p mean: 0.4517652094364166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255372494459152, decouple_loss:0.0015501677989959717
The modified gen p mean: 0.4499720335006714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032711584120988846, decouple_loss:0.0015415403759106994
The modified gen p mean: 0.45132482051849365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034221433103084564, decouple_loss:0.0015732385218143463
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033239997923374176, avg_mse: 0.04514971375465393
current test mse: 0.04515
Iteration: 3321, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458827078342438, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028376257047057152, decouple_loss:0.0014496140647679567
The modified gen p mean: 0.4466000497341156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02786637842655182, decouple_loss:0.0013382286997511983
The modified gen p mean: 0.4469979405403137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026789851486682892, decouple_loss:0.0014034159248694777
Iteration: 3322, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44445908069610596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027823280543088913, decouple_loss:0.0012812259374186397
The modified gen p mean: 0.4460814297199249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028584938496351242, decouple_loss:0.0012737251818180084
The modified gen p mean: 0.4495946168899536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027857940644025803, decouple_loss:0.0015132242115214467
Iteration: 3323, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445825517177582, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027246637269854546, decouple_loss:0.0012385679874569178
The modified gen p mean: 0.4454244375228882, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027606703341007233, decouple_loss:0.0011662745382636786
The modified gen p mean: 0.44499990344047546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028411999344825745, decouple_loss:0.0013786684721708298
Iteration: 3324, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472317397594452, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027289001271128654, decouple_loss:0.0013707642210647464
The modified gen p mean: 0.44679465889930725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026974812150001526, decouple_loss:0.0012542223557829857
The modified gen p mean: 0.4465911090373993, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026122696697711945, decouple_loss:0.0013467202661558986
Iteration: 3325, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458480477333069, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026309192180633545, decouple_loss:0.0013430005637928843
The modified gen p mean: 0.4498143494129181, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027955470606684685, decouple_loss:0.0013982339296489954
The modified gen p mean: 0.4516559839248657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02594754286110401, decouple_loss:0.0013862663181498647
Iteration: 3326, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451943337917328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027162417769432068, decouple_loss:0.0013064040103927255
The modified gen p mean: 0.450209379196167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027695894241333008, decouple_loss:0.0013844192726537585
The modified gen p mean: 0.44504860043525696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026462189853191376, decouple_loss:0.0012882616138085723
Iteration: 3327, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44424277544021606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02566603012382984, decouple_loss:0.0013014932628720999
The modified gen p mean: 0.44611451029777527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027058910578489304, decouple_loss:0.001395098166540265
The modified gen p mean: 0.44989028573036194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02740130014717579, decouple_loss:0.001326724886894226
Iteration: 3328, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4440542459487915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025023797526955605, decouple_loss:0.0012970766983926296
The modified gen p mean: 0.44641509652137756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026538165286183357, decouple_loss:0.0013558511855080724
The modified gen p mean: 0.4497735798358917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025053393095731735, decouple_loss:0.0014677583239972591
Iteration: 3329, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44970613718032837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02775258757174015, decouple_loss:0.001288190484046936
The modified gen p mean: 0.44664737582206726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025507336482405663, decouple_loss:0.001393323065713048
The modified gen p mean: 0.44646304845809937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026978805661201477, decouple_loss:0.0014175536343827844
Iteration: 3330, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45040270686149597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026124270632863045, decouple_loss:0.0014684865018352866
The modified gen p mean: 0.4504289925098419, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026988491415977478, decouple_loss:0.001316550886258483
The modified gen p mean: 0.4452064037322998, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02878746949136257, decouple_loss:0.0013861916959285736
2023-05-27 03:33:29 testing...
The modified gen p mean: 0.4521273374557495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265330567955971, decouple_loss:0.001547483610920608
The modified gen p mean: 0.450577974319458, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283311054110527, decouple_loss:0.001537679461762309
The modified gen p mean: 0.4519115388393402, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034354470670223236, decouple_loss:0.0015193787403404713
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03335703909397125, avg_mse: 0.04542335122823715
current test mse: 0.045423
Iteration: 3331, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45019352436065674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027313923463225365, decouple_loss:0.0013200094690546393
The modified gen p mean: 0.4462551772594452, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026107151061296463, decouple_loss:0.0012624479131773114
The modified gen p mean: 0.4466513991355896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026324301958084106, decouple_loss:0.0012151675764471292
Iteration: 3332, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44908571243286133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026537785306572914, decouple_loss:0.001385659328661859
The modified gen p mean: 0.44783449172973633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02554200403392315, decouple_loss:0.0015653065638616681
The modified gen p mean: 0.44656670093536377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028554676100611687, decouple_loss:0.0012908711796626449
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3333, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494236409664154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026754355058073997, decouple_loss:0.0014607463963329792
The modified gen p mean: 0.4498739242553711, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44718214869499207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820458635687828, decouple_loss:0.0012941459426656365
loss_pred:0.026758093386888504, decouple_loss:0.0013491894351318479
Iteration: 3334, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498131573200226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02606036700308323, decouple_loss:0.0013863061321899295
The modified gen p mean: 0.4471953213214874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029003575444221497, decouple_loss:0.0013674360234290361
The modified gen p mean: 0.4462834596633911, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02861100062727928, decouple_loss:0.0013770470395684242
Iteration: 3335, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509967565536499, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02702600136399269, decouple_loss:0.0014270921237766743
The modified gen p mean: 0.45161476731300354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026356102898716927, decouple_loss:0.0012847534380853176
The modified gen p mean: 0.44714677333831787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0280317272990942, decouple_loss:0.0013771516969427466
Iteration: 3336, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44901710748672485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027528921142220497, decouple_loss:0.001387943746522069
The modified gen p mean: 0.4482519030570984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026835160329937935, decouple_loss:0.0013400197494775057
The modified gen p mean: 0.4474378526210785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02824576199054718, decouple_loss:0.0013079961063340306
Iteration: 3337, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477766454219818, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02675270475447178, decouple_loss:0.0012616398744285107
The modified gen p mean: 0.4486660957336426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673632837831974, decouple_loss:0.0011893822811543941
The modified gen p mean: 0.4491382837295532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025828955695033073, decouple_loss:0.001527309650555253
Iteration: 3338, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45141154527664185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02776322327554226, decouple_loss:0.0015584379434585571
The modified gen p mean: 0.45128706097602844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02726043574512005, decouple_loss:0.0013114952016621828
The modified gen p mean: 0.45202377438545227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771138772368431, decouple_loss:0.0013200578978285193
Iteration: 3339, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476945102214813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0271396953612566, decouple_loss:0.0013958235504105687
The modified gen p mean: 0.4469511806964874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02924773283302784, decouple_loss:0.001283444231376052
The modified gen p mean: 0.44740501046180725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02924543246626854, decouple_loss:0.0013210606994107366
Iteration: 3340, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44773226976394653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02764795906841755, decouple_loss:0.0014276435831561685
The modified gen p mean: 0.4463638663291931, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02746116928756237, decouple_loss:0.0013825854985043406
The modified gen p mean: 0.4509255588054657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02698003314435482, decouple_loss:0.0013184455456212163
2023-05-27 03:38:16 testing...
The modified gen p mean: 0.45131221413612366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03298678994178772, decouple_loss:0.0016123183304443955
The modified gen p mean: 0.44948846101760864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03324773907661438, decouple_loss:0.0015391246415674686
The modified gen p mean: 0.4512605667114258, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034832555800676346, decouple_loss:0.0016126491827890277
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033768430352211, avg_mse: 0.046190086752176285
current test mse: 0.04619
Iteration: 3341, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481179118156433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027308659628033638, decouple_loss:0.0015269557479768991
The modified gen p mean: 0.4461282193660736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02639126218855381, decouple_loss:0.0013376884162425995
The modified gen p mean: 0.44680750370025635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02904606983065605, decouple_loss:0.0013712049694731832
Iteration: 3342, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489714503288269, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025504369288682938, decouple_loss:0.0014632770325988531
The modified gen p mean: 0.4465956687927246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028990810737013817, decouple_loss:0.0014424542896449566
The modified gen p mean: 0.4452541172504425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027494950219988823, decouple_loss:0.001374217914417386
Iteration: 3343, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45341524481773376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026854386553168297, decouple_loss:0.0014488435117527843
The modified gen p mean: 0.4461843967437744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027114175260066986, decouple_loss:0.0013845465146005154
The modified gen p mean: 0.44703295826911926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02707110159099102, decouple_loss:0.001385594718158245
Iteration: 3344, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44552192091941833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028329627588391304, decouple_loss:0.0013686674647033215
The modified gen p mean: 0.4523921012878418, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027441125363111496, decouple_loss:0.0013612014008685946
The modified gen p mean: 0.45191505551338196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0261157788336277, decouple_loss:0.0015156710287556052
Iteration: 3345, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484134018421173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026799585670232773, decouple_loss:0.0012767957523465157
The modified gen p mean: 0.45101049542427063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02602442353963852, decouple_loss:0.0015015002572908998
The modified gen p mean: 0.4483785927295685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026902999728918076, decouple_loss:0.0013649394968524575
Iteration: 3346, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495406448841095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026155514642596245, decouple_loss:0.0014933403581380844
The modified gen p mean: 0.44959598779678345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026258088648319244, decouple_loss:0.001406604191288352
The modified gen p mean: 0.45049408078193665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027312735095620155, decouple_loss:0.001272102352231741
Iteration: 3347, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469514489173889, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027261732146143913, decouple_loss:0.0012983811320737004
The modified gen p mean: 0.4477480947971344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027229132130742073, decouple_loss:0.0014079789398238063
The modified gen p mean: 0.45150426030158997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027035804465413094, decouple_loss:0.0013594521442428231
Iteration: 3348, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460252523422241, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028674695640802383, decouple_loss:0.001481569604948163
The modified gen p mean: 0.45052599906921387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02790716290473938, decouple_loss:0.0014449212467297912
The modified gen p mean: 0.4510901868343353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02703717164695263, decouple_loss:0.0014390118885785341
Iteration: 3349, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44661808013916016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027136778458952904, decouple_loss:0.001234488096088171
The modified gen p mean: 0.4513826370239258, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02668610028922558, decouple_loss:0.0012953388504683971
The modified gen p mean: 0.44997626543045044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732330560684204, decouple_loss:0.0013098439667373896
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3350, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45141175389289856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030248751863837242, decouple_loss:0.0013681595446541905
The modified gen p mean: 0.445139616727829, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4474167227745056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030042298138141632, decouple_loss:0.0013884707586839795
loss_pred:0.029812658205628395, decouple_loss:0.0012880668509751558
2023-05-27 03:43:05 testing...
The modified gen p mean: 0.45212244987487793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03291631117463112, decouple_loss:0.0015214568702504039
The modified gen p mean: 0.4501968324184418, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03315015882253647, decouple_loss:0.0014519314281642437
The modified gen p mean: 0.45196372270584106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03477221354842186, decouple_loss:0.0014948340831324458
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03368736803531647, avg_mse: 0.04600657522678375
current test mse: 0.046007
Iteration: 3351, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492211639881134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02971561811864376, decouple_loss:0.0016181572573259473
The modified gen p mean: 0.4474693238735199, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030809730291366577, decouple_loss:0.0013138108188286424
The modified gen p mean: 0.4460792541503906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029675908386707306, decouple_loss:0.0013616366777569056
Iteration: 3352, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508701264858246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028466224670410156, decouple_loss:0.0013082758523523808
The modified gen p mean: 0.4493340253829956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02935534529387951, decouple_loss:0.0014155360404402018
The modified gen p mean: 0.4482325613498688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028548624366521835, decouple_loss:0.0012710037408396602
Iteration: 3353, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488644003868103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030212612822651863, decouple_loss:0.0013638397213071585
The modified gen p mean: 0.44828692078590393, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029399264603853226, decouple_loss:0.0012610242702066898
The modified gen p mean: 0.44942888617515564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029237743467092514, decouple_loss:0.001276623923331499
Iteration: 3354, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44827014207839966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030841026455163956, decouple_loss:0.00121528678573668
The modified gen p mean: 0.44888684153556824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029629303142428398, decouple_loss:0.0012746576685458422
The modified gen p mean: 0.44938939809799194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030095145106315613, decouple_loss:0.0012954751728102565
Iteration: 3355, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492952227592468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02919253148138523, decouple_loss:0.0013218751410022378
The modified gen p mean: 0.4545765519142151, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029543953016400337, decouple_loss:0.0013582621468231082
The modified gen p mean: 0.4550911486148834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028969287872314453, decouple_loss:0.001369618228636682
Iteration: 3356, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4542183578014374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03067001700401306, decouple_loss:0.0013647009618580341
The modified gen p mean: 0.4493148624897003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028618933632969856, decouple_loss:0.001273498754017055
The modified gen p mean: 0.454641193151474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029464108869433403, decouple_loss:0.00132878462318331
Iteration: 3357, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45138663053512573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02823568880558014, decouple_loss:0.0012436050456017256
The modified gen p mean: 0.44751545786857605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02914794348180294, decouple_loss:0.0012436340330168605
The modified gen p mean: 0.447996586561203, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029544275254011154, decouple_loss:0.0012705376138910651
Iteration: 3358, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44588690996170044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030728314071893692, decouple_loss:0.001308284467086196
The modified gen p mean: 0.4463602304458618, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02843671664595604, decouple_loss:0.0014325715601444244
The modified gen p mean: 0.4503234326839447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029277684167027473, decouple_loss:0.0013860448962077498
Iteration: 3359, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44779258966445923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029463712126016617, decouple_loss:0.001274886424653232
The modified gen p mean: 0.45007118582725525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02803410403430462, decouple_loss:0.0013344463659450412
The modified gen p mean: 0.45225727558135986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028869470581412315, decouple_loss:0.0014155209064483643
Iteration: 3360, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476945102214813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02927517145872116, decouple_loss:0.001271399320103228
The modified gen p mean: 0.451740026473999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028710097074508667, decouple_loss:0.0013092105509713292
The modified gen p mean: 0.44555583596229553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029070435091853142, decouple_loss:0.0012910065706819296
2023-05-27 03:47:13 testing...
The modified gen p mean: 0.45044010877609253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032596342265605927, decouple_loss:0.001490945927798748
The modified gen p mean: 0.44847139716148376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0326036661863327, decouple_loss:0.0013824161142110825
The modified gen p mean: 0.45011693239212036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03443075716495514, decouple_loss:0.0015136214205995202
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03328336775302887, avg_mse: 0.04527587816119194
current test mse: 0.045276
Iteration: 3361, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44618120789527893, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03028101660311222, decouple_loss:0.0011880588717758656
The modified gen p mean: 0.4466402232646942, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02964114584028721, decouple_loss:0.0012976831058040261
The modified gen p mean: 0.4468453526496887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029396705329418182, decouple_loss:0.001322589349001646
Iteration: 3362, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44891825318336487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028374478220939636, decouple_loss:0.0013126801932230592
The modified gen p mean: 0.44564396142959595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029970621690154076, decouple_loss:0.001267740735784173
The modified gen p mean: 0.4436490833759308, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029212508350610733, decouple_loss:0.0011472363257780671
Iteration: 3363, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44584283232688904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029710931703448296, decouple_loss:0.001345743890851736
The modified gen p mean: 0.44626539945602417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029091287404298782, decouple_loss:0.0012421193532645702
The modified gen p mean: 0.45113179087638855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02944362722337246, decouple_loss:0.001421646331436932
Iteration: 3364, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468552768230438, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030928343534469604, decouple_loss:0.00135948380921036
The modified gen p mean: 0.4477323889732361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028937313705682755, decouple_loss:0.0012822351418435574
The modified gen p mean: 0.448834091424942, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028408007696270943, decouple_loss:0.0013292748481035233
Iteration: 3365, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44634541869163513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029819872230291367, decouple_loss:0.00127483403775841
The modified gen p mean: 0.45081737637519836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028928415849804878, decouple_loss:0.0012470021611079574
The modified gen p mean: 0.44681403040885925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030239589512348175, decouple_loss:0.00130021246150136
Iteration: 3366, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510533809661865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029238304123282433, decouple_loss:0.001296637230552733
The modified gen p mean: 0.4525300860404968, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02967834286391735, decouple_loss:0.0013156516943126917
The modified gen p mean: 0.4532604515552521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028507964685559273, decouple_loss:0.0012867911718785763
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr.npz
NaN value num: 0
Iteration: 3367, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45255932211875916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029532454907894135, decouple_loss:0.001363442512229085
The modified gen p mean: 0.450512558221817, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.449078768491745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029934799298644066, decouple_loss:0.0013264623703435063loss_pred:0.03054453805088997, decouple_loss:0.0014668179210275412
Iteration: 3368, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45265331864356995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03043890930712223, decouple_loss:0.0015425102319568396
The modified gen p mean: 0.44849893450737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029285017400979996, decouple_loss:0.0015382651472464204
The modified gen p mean: 0.44753316044807434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03005598857998848, decouple_loss:0.0013633002527058125
Iteration: 3369, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485208988189697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029820719733834267, decouple_loss:0.0014434607001021504
The modified gen p mean: 0.44914886355400085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02933373674750328, decouple_loss:0.0013402700424194336
The modified gen p mean: 0.4481258988380432, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029419826343655586, decouple_loss:0.0015103729674592614
Iteration: 3370, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45144665241241455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029755881056189537, decouple_loss:0.0016453800490126014
The modified gen p mean: 0.44977277517318726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028850268572568893, decouple_loss:0.0017016527708619833
The modified gen p mean: 0.45228302478790283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029564253985881805, decouple_loss:0.001551892375573516
2023-05-27 03:51:59 testing...
The modified gen p mean: 0.4525710940361023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03248698264360428, decouple_loss:0.0015992746921256185
The modified gen p mean: 0.4508489966392517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03270161524415016, decouple_loss:0.0014246213249862194
The modified gen p mean: 0.4523402750492096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03456820175051689, decouple_loss:0.001542416401207447
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033328376710414886, avg_mse: 0.045397307723760605
current test mse: 0.045397
Iteration: 3371, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512862265110016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0294667799025774, decouple_loss:0.0013777228305116296
The modified gen p mean: 0.44789090752601624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02916642837226391, decouple_loss:0.0013558740029111505
The modified gen p mean: 0.4494096636772156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028746116906404495, decouple_loss:0.0014966463204473257
Iteration: 3372, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496749937534332, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02952783927321434, decouple_loss:0.0012520751915872097
The modified gen p mean: 0.4512357711791992, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030170654878020287, decouple_loss:0.0015191844431683421
The modified gen p mean: 0.4496020972728729, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0287637896835804, decouple_loss:0.0015210368437692523
Iteration: 3373, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4558033049106598, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029713163152337074, decouple_loss:0.0013809440424665809
The modified gen p mean: 0.45507097244262695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030025411397218704, decouple_loss:0.0012395676458254457
The modified gen p mean: 0.4549205005168915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02865283191204071, decouple_loss:0.001503267791122198
Iteration: 3374, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45514217019081116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03046087920665741, decouple_loss:0.0013430006802082062
The modified gen p mean: 0.4553464949131012, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029045768082141876, decouple_loss:0.001185878412798047
The modified gen p mean: 0.4594962000846863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029432931914925575, decouple_loss:0.0013851432595402002
Iteration: 3375, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4570431411266327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02945106476545334, decouple_loss:0.0012207127874717116
The modified gen p mean: 0.4585568904876709, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029498323798179626, decouple_loss:0.0013544306857511401
The modified gen p mean: 0.45940643548965454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029654117301106453, decouple_loss:0.0013846533838659525
Iteration: 3376, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4540587067604065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029841938987374306, decouple_loss:0.0014296058798208833
The modified gen p mean: 0.4533626437187195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032117847353219986, decouple_loss:0.0013031018897891045
The modified gen p mean: 0.4547673761844635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029067756608128548, decouple_loss:0.0013207587180659175
Iteration: 3377, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4517436623573303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03152317926287651, decouple_loss:0.001238655997440219
The modified gen p mean: 0.4522703289985657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028276726603507996, decouple_loss:0.0014425137778744102
The modified gen p mean: 0.4499884247779846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0301575418561697, decouple_loss:0.0012238634517416358
Iteration: 3378, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44629478454589844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029718901962041855, decouple_loss:0.0013193645281717181
The modified gen p mean: 0.44451653957366943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03025650605559349, decouple_loss:0.0012072294484823942
The modified gen p mean: 0.44755664467811584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029979197308421135, decouple_loss:0.0012550984974950552
Iteration: 3379, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4432266354560852, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028954511508345604, decouple_loss:0.0013011232949793339
The modified gen p mean: 0.4427117705345154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03082047961652279, decouple_loss:0.0012306281132623553
The modified gen p mean: 0.445906400680542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030482009053230286, decouple_loss:0.0012268180726096034
Iteration: 3380, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44072893261909485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030818942934274673, decouple_loss:0.0013376219430938363
The modified gen p mean: 0.44049254059791565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02823466993868351, decouple_loss:0.0013165583368390799
The modified gen p mean: 0.4408230781555176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029159342870116234, decouple_loss:0.0013053839793428779
2023-05-27 03:56:05 testing...
The modified gen p mean: 0.4439884126186371, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032328277826309204, decouple_loss:0.001495909527875483
The modified gen p mean: 0.44221001863479614, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44386908411979675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032526664435863495, decouple_loss:0.0013231441844254732
loss_pred:0.034257084131240845, decouple_loss:0.0015057162381708622
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03310942277312279, avg_mse: 0.045071080327034
current test mse: 0.045071
Iteration: 3381, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.43853533267974854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029846807941794395, decouple_loss:0.0012920376611873507
The modified gen p mean: 0.43943312764167786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03095506690442562, decouple_loss:0.0012191832065582275
The modified gen p mean: 0.44033282995224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02860134467482567, decouple_loss:0.0012815353693440557
Iteration: 3382, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4408102333545685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030294084921479225, decouple_loss:0.0012994681019335985
The modified gen p mean: 0.44119158387184143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029099885374307632, decouple_loss:0.0014130532508715987
The modified gen p mean: 0.44261300563812256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029280297458171844, decouple_loss:0.0013527084374800324
Iteration: 3383, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439101219177246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02962390147149563, decouple_loss:0.0012097526341676712
The modified gen p mean: 0.44343531131744385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029829826205968857, decouple_loss:0.0013342276215553284
The modified gen p mean: 0.4454898238182068, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029064897447824478, decouple_loss:0.0014564318116754293
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr.npz
NaN value num: 0
Iteration: 3384, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497731924057007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025816939771175385, decouple_loss:0.001357379136607051
The modified gen p mean: 0.44726458191871643, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44806137681007385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02641434036195278, decouple_loss:0.0013374574482440948
loss_pred:0.027232453227043152, decouple_loss:0.0014166465261951089
Iteration: 3385, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44998985528945923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027167074382305145, decouple_loss:0.0012769234599545598
The modified gen p mean: 0.451863557100296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026788124814629555, decouple_loss:0.001274024834856391
The modified gen p mean: 0.4515940546989441, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025957264006137848, decouple_loss:0.0012842784635722637
Iteration: 3386, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45043113827705383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026126772165298462, decouple_loss:0.0013090873835608363
The modified gen p mean: 0.4547688663005829, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026200702413916588, decouple_loss:0.001348072080872953
The modified gen p mean: 0.4538953900337219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026276135817170143, decouple_loss:0.0013280096463859081
Iteration: 3387, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496963322162628, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02652452327311039, decouple_loss:0.001406811410561204
The modified gen p mean: 0.45357048511505127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026265818625688553, decouple_loss:0.0013681808486580849
The modified gen p mean: 0.45012983679771423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02649214118719101, decouple_loss:0.0015978835290297866
Iteration: 3388, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44525259733200073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026493169367313385, decouple_loss:0.0012771524488925934
The modified gen p mean: 0.4460274279117584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027027707546949387, decouple_loss:0.0012910953955724835
The modified gen p mean: 0.44945189356803894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02685084380209446, decouple_loss:0.0014106197049841285
Iteration: 3389, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44503068923950195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027187006548047066, decouple_loss:0.0012437213445082307
The modified gen p mean: 0.4475235342979431, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026219630613923073, decouple_loss:0.0014429019065573812
The modified gen p mean: 0.44742655754089355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02565518021583557, decouple_loss:0.0012849398190155625
Iteration: 3390, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461284875869751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02579730749130249, decouple_loss:0.0014871302992105484
The modified gen p mean: 0.4460941255092621, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025635037571191788, decouple_loss:0.0013613750925287604
The modified gen p mean: 0.44427424669265747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02628912404179573, decouple_loss:0.0014132247306406498
2023-05-27 04:00:54 testing...
The modified gen p mean: 0.4478352963924408, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261863812804222, decouple_loss:0.0015227257972583175
The modified gen p mean: 0.44629713892936707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032740529626607895, decouple_loss:0.001405558199621737
The modified gen p mean: 0.4478437602519989, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0344417467713356, decouple_loss:0.0015728186117485166
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033341988921165466, avg_mse: 0.045514728873968124
current test mse: 0.045515
Iteration: 3391, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44522935152053833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025943027809262276, decouple_loss:0.0013528283452615142
The modified gen p mean: 0.44391825795173645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027361270040273666, decouple_loss:0.001333738095127046
The modified gen p mean: 0.4456692934036255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025203868746757507, decouple_loss:0.001374425133690238
Iteration: 3392, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445791631937027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026306157931685448, decouple_loss:0.0013218269450590014
The modified gen p mean: 0.445158451795578, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025912096723914146, decouple_loss:0.0012959657469764352
The modified gen p mean: 0.4437989592552185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026859907433390617, decouple_loss:0.0012287591816857457
Iteration: 3393, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468860328197479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02632088214159012, decouple_loss:0.0012479046126827598
The modified gen p mean: 0.44750216603279114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02701709046959877, decouple_loss:0.0013220561668276787
The modified gen p mean: 0.4480542242527008, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025706537067890167, decouple_loss:0.0014960472472012043
Iteration: 3394, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45002612471580505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027726514264941216, decouple_loss:0.0014014815678820014
The modified gen p mean: 0.4499732553958893, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026996437460184097, decouple_loss:0.0012931409291923046
The modified gen p mean: 0.44778117537498474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027712177485227585, decouple_loss:0.0012428632471710443
Iteration: 3395, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534102976322174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024808157235383987, decouple_loss:0.001289451029151678
The modified gen p mean: 0.4526616632938385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02613784372806549, decouple_loss:0.0012236093170940876
The modified gen p mean: 0.4512489438056946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026942405849695206, decouple_loss:0.001295912661589682
Iteration: 3396, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4539515972137451, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025699086487293243, decouple_loss:0.0012863760348409414
The modified gen p mean: 0.4520055949687958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026900533586740494, decouple_loss:0.0011876171920448542
The modified gen p mean: 0.4513465166091919, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026797624304890633, decouple_loss:0.0013326684711501002
Iteration: 3397, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4558314383029938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025370581075549126, decouple_loss:0.0013252291828393936
The modified gen p mean: 0.45216038823127747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027606505900621414, decouple_loss:0.0012423332082107663
The modified gen p mean: 0.4568686783313751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610829472541809, decouple_loss:0.0016042693750932813
Iteration: 3398, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45399901270866394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026171697303652763, decouple_loss:0.0012998419115319848
The modified gen p mean: 0.4522092938423157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02577301114797592, decouple_loss:0.0014240627642720938
The modified gen p mean: 0.45698419213294983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025634581223130226, decouple_loss:0.0013563762186095119
Iteration: 3399, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45336073637008667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024457966908812523, decouple_loss:0.0012726536951959133
The modified gen p mean: 0.4493832588195801, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02634952962398529, decouple_loss:0.0015175188891589642
The modified gen p mean: 0.44709324836730957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026985350996255875, decouple_loss:0.0013231388293206692
Iteration: 3400, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484647810459137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025599556043744087, decouple_loss:0.001398287364281714
The modified gen p mean: 0.4464280307292938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026310250163078308, decouple_loss:0.0013655888615176082
The modified gen p mean: 0.446992963552475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02604982815682888, decouple_loss:0.001300556818023324
2023-05-27 04:04:59 testing...
The modified gen p mean: 0.4496577978134155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03233397752046585, decouple_loss:0.0016398930456489325
The modified gen p mean: 0.44836050271987915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032573264092206955, decouple_loss:0.0015073780668899417
The modified gen p mean: 0.44967958331108093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034153904765844345, decouple_loss:0.0017681578174233437
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033102307468652725, avg_mse: 0.04520909860730171
current test mse: 0.045209
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr.npz
NaN value num: 0
Iteration: 3401, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458051919937134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02620800957083702, decouple_loss:0.0013697042595595121
The modified gen p mean: 0.44605526328086853, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44820183515548706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025700466707348824, decouple_loss:0.0015438605332747102
loss_pred:0.02691967785358429, decouple_loss:0.001425442867912352
Iteration: 3402, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4437043368816376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02589128352701664, decouple_loss:0.0013608153676614165
The modified gen p mean: 0.4454306960105896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02727525867521763, decouple_loss:0.0013981704832985997
The modified gen p mean: 0.44423165917396545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673031948506832, decouple_loss:0.0013478639302775264
Iteration: 3403, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44472599029541016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026423132047057152, decouple_loss:0.0012547411024570465
The modified gen p mean: 0.4447624087333679, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02784068137407303, decouple_loss:0.0013820799067616463
The modified gen p mean: 0.44370564818382263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02868277207016945, decouple_loss:0.0013212859630584717
Iteration: 3404, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470272958278656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02620021440088749, decouple_loss:0.0012937255669385195
The modified gen p mean: 0.44457772374153137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02626536600291729, decouple_loss:0.0013327609049156308
The modified gen p mean: 0.4466034173965454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02530473843216896, decouple_loss:0.0012720625381916761
Iteration: 3405, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455215334892273, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44420135021209717, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02631364017724991, decouple_loss:0.001446720096282661
loss_pred:0.026676692068576813, decouple_loss:0.0013175606727600098
The modified gen p mean: 0.4462321996688843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025955285876989365, decouple_loss:0.001460976549424231
Iteration: 3406, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45142754912376404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02650868333876133, decouple_loss:0.0013716381508857012
The modified gen p mean: 0.45386284589767456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02683178149163723, decouple_loss:0.001297204871661961
The modified gen p mean: 0.44569629430770874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027017368003726006, decouple_loss:0.0012921177549287677
Iteration: 3407, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490908980369568, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02624191902577877, decouple_loss:0.0013088859850540757
The modified gen p mean: 0.45499759912490845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027006594464182854, decouple_loss:0.0013114840257912874
The modified gen p mean: 0.4493075907230377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027137279510498047, decouple_loss:0.0013052881695330143
Iteration: 3408, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4538799822330475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026081189513206482, decouple_loss:0.0012433439260348678
The modified gen p mean: 0.454633891582489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02608460746705532, decouple_loss:0.0012854296946898103
The modified gen p mean: 0.4536947011947632, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02611180767416954, decouple_loss:0.0012198665644973516
Iteration: 3409, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512058198451996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027481885626912117, decouple_loss:0.0014165842439979315
The modified gen p mean: 0.4520166218280792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028264673426747322, decouple_loss:0.0013078766642138362
The modified gen p mean: 0.4529142677783966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02691694162786007, decouple_loss:0.001491028000600636
Iteration: 3410, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4520031809806824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027221685275435448, decouple_loss:0.0012093950062990189
The modified gen p mean: 0.45471906661987305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026357049122452736, decouple_loss:0.0012553289998322725
The modified gen p mean: 0.45251479744911194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027276325970888138, decouple_loss:0.0012909226352348924
2023-05-27 04:09:55 testing...
The modified gen p mean: 0.45471298694610596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032705653458833694, decouple_loss:0.0014387131668627262
The modified gen p mean: 0.4546203315258026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03443500027060509, decouple_loss:0.0014613793464377522
The modified gen p mean: 0.45327311754226685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03278680890798569, decouple_loss:0.0014534431975334883
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033381715416908264, avg_mse: 0.045663636177778244
current test mse: 0.045664
Iteration: 3411, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534405469894409, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02613234892487526, decouple_loss:0.0012542341137304902
The modified gen p mean: 0.4537034034729004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026194920763373375, decouple_loss:0.0012429625494405627
The modified gen p mean: 0.4507542550563812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02813260816037655, decouple_loss:0.0013256536331027746
Iteration: 3412, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44730228185653687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02696048468351364, decouple_loss:0.0012640571221709251
The modified gen p mean: 0.44812747836112976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025805512443184853, decouple_loss:0.0014316211454570293
The modified gen p mean: 0.45003190636634827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027193421497941017, decouple_loss:0.0013570281444117427
Iteration: 3413, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44997143745422363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025478001683950424, decouple_loss:0.0012678108178079128
The modified gen p mean: 0.449775755405426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026366040110588074, decouple_loss:0.0013525837566703558
The modified gen p mean: 0.4457813501358032, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02694312483072281, decouple_loss:0.001308923470787704
Iteration: 3414, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44773146510124207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02582104690372944, decouple_loss:0.001269758795388043
The modified gen p mean: 0.4482227563858032, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610352449119091, decouple_loss:0.00123048503883183
The modified gen p mean: 0.4474806487560272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026981215924024582, decouple_loss:0.0011845261324197054
Iteration: 3415, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44845375418663025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0261149350553751, decouple_loss:0.0013314737007021904
The modified gen p mean: 0.4474194645881653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02581818774342537, decouple_loss:0.001446627895347774
The modified gen p mean: 0.4451598525047302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027033483609557152, decouple_loss:0.0013390558306127787
Iteration: 3416, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44681763648986816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026151597499847412, decouple_loss:0.0013347928179427981
The modified gen p mean: 0.44509467482566833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02614464797079563, decouple_loss:0.0012963099870830774
The modified gen p mean: 0.4502134323120117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026241589337587357, decouple_loss:0.001304559176787734
Iteration: 3417, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446907937526703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026566259562969208, decouple_loss:0.0013042237842455506
The modified gen p mean: 0.4492485225200653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026414072141051292, decouple_loss:0.001295120338909328
The modified gen p mean: 0.444735586643219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02636123076081276, decouple_loss:0.001194096403196454
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr.npz
NaN value num: 0
Iteration: 3418, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453882575035095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02684216946363449, decouple_loss:0.0014026535209268332
The modified gen p mean: 0.4503331780433655, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4458910822868347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024731500074267387, decouple_loss:0.0014651167439296842loss_pred:0.027242258191108704, decouple_loss:0.0011709979735314846
Iteration: 3419, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482593238353729, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0269913487136364, decouple_loss:0.0013681573327630758
The modified gen p mean: 0.44963565468788147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026174869388341904, decouple_loss:0.001289023319259286
The modified gen p mean: 0.4486810266971588, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02519557625055313, decouple_loss:0.0012929248623549938
Iteration: 3420, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501665234565735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0267409048974514, decouple_loss:0.0011992768850177526
The modified gen p mean: 0.453754186630249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025666655972599983, decouple_loss:0.0013755036052316427
The modified gen p mean: 0.451277494430542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673102542757988, decouple_loss:0.001263915910385549
2023-05-27 04:14:42 testing...
The modified gen p mean: 0.4554203748703003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03272806107997894, decouple_loss:0.0014392898883670568
The modified gen p mean: 0.4552130699157715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03440427407622337, decouple_loss:0.001508534187451005
The modified gen p mean: 0.453776091337204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0328555628657341, decouple_loss:0.0013752789236605167
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033401355147361755, avg_mse: 0.045697152614593506
current test mse: 0.045697
Iteration: 3421, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45146888494491577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02496684528887272, decouple_loss:0.0012826324673369527
The modified gen p mean: 0.4513455331325531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02516397275030613, decouple_loss:0.0012470020446926355
The modified gen p mean: 0.45102256536483765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02462945692241192, decouple_loss:0.0013358311261981726
Iteration: 3422, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44647547602653503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026825428009033203, decouple_loss:0.0012901072623208165
The modified gen p mean: 0.4524853229522705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02607591263949871, decouple_loss:0.0014313478022813797
The modified gen p mean: 0.45192766189575195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02518947422504425, decouple_loss:0.0012611625716090202
Iteration: 3423, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4522537887096405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02543548308312893, decouple_loss:0.001313061686232686
The modified gen p mean: 0.44905123114585876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026860682293772697, decouple_loss:0.0012321133399382234
The modified gen p mean: 0.4516006112098694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025958286598324776, decouple_loss:0.0013141959207132459
Iteration: 3424, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499152600765228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02677062898874283, decouple_loss:0.0013844671193510294
The modified gen p mean: 0.4492795169353485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026812568306922913, decouple_loss:0.001433111261576414
The modified gen p mean: 0.44741588830947876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025264499709010124, decouple_loss:0.001377904904074967
Iteration: 3425, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482138752937317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026034757494926453, decouple_loss:0.0013331659138202667
The modified gen p mean: 0.44258546829223633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02738441713154316, decouple_loss:0.0013082503573969007
The modified gen p mean: 0.44562458992004395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024697788059711456, decouple_loss:0.0012567810481414199
Iteration: 3426, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4432529807090759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026309853419661522, decouple_loss:0.0013255019439384341
The modified gen p mean: 0.4470113217830658, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025573214516043663, decouple_loss:0.0013775221304968
The modified gen p mean: 0.4444413483142853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0254216268658638, decouple_loss:0.0013670007465407252
Iteration: 3427, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44236811995506287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027249405160546303, decouple_loss:0.0013562639942392707
The modified gen p mean: 0.4459371268749237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02509821020066738, decouple_loss:0.0012775301001966
The modified gen p mean: 0.44307953119277954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026720136404037476, decouple_loss:0.0014387688133865595
Iteration: 3428, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4430922269821167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026578811928629875, decouple_loss:0.0014706627698615193
The modified gen p mean: 0.4466468095779419, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026204820722341537, decouple_loss:0.001456062076613307
The modified gen p mean: 0.4471321105957031, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026575390249490738, decouple_loss:0.0014378827763721347
Iteration: 3429, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44524136185646057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02417425438761711, decouple_loss:0.0012886612676084042
The modified gen p mean: 0.4488738775253296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024945812299847603, decouple_loss:0.0013409517705440521
The modified gen p mean: 0.44451653957366943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026906635612249374, decouple_loss:0.0013064659433439374
Iteration: 3430, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44629815220832825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025991512462496758, decouple_loss:0.001340279122814536
The modified gen p mean: 0.447765976190567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026481909677386284, decouple_loss:0.0013243219582363963
The modified gen p mean: 0.4505208432674408, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024427922442555428, decouple_loss:0.0013896914897486567
2023-05-27 04:18:52 testing...
The modified gen p mean: 0.4522697925567627, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03250662237405777, decouple_loss:0.001420454471372068
The modified gen p mean: 0.45075464248657227, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4519060254096985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03279772028326988, decouple_loss:0.0013836775906383991
loss_pred:0.03442297875881195, decouple_loss:0.0014871627790853381
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03331395983695984, avg_mse: 0.04550971835851669
current test mse: 0.04551
Iteration: 3431, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461320638656616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025997960940003395, decouple_loss:0.0013953829184174538
The modified gen p mean: 0.4480794072151184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026587996631860733, decouple_loss:0.0012656438630074263
The modified gen p mean: 0.44818559288978577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026535483077168465, decouple_loss:0.001214409014210105
Iteration: 3432, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466428756713867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026396356523036957, decouple_loss:0.0015498475404456258
The modified gen p mean: 0.4503558278083801, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025046110153198242, decouple_loss:0.0012423926964402199
The modified gen p mean: 0.44738373160362244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026733273640275, decouple_loss:0.001169963157735765
Iteration: 3433, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468146562576294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02720772661268711, decouple_loss:0.0012855149107053876
The modified gen p mean: 0.44497600197792053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026723982766270638, decouple_loss:0.001265555270947516
The modified gen p mean: 0.4476827085018158, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025969481095671654, decouple_loss:0.0012451736256480217
Iteration: 3434, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505826234817505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025366641581058502, decouple_loss:0.0011726879747584462
The modified gen p mean: 0.4497331976890564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0252314992249012, decouple_loss:0.0013297111727297306
The modified gen p mean: 0.4468376040458679, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026607852429151535, decouple_loss:0.001304122619330883
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr.npz
NaN value num: 0
Iteration: 3435, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467589557170868, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029628043994307518, decouple_loss:0.0012429723283275962
The modified gen p mean: 0.45194631814956665, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45132890343666077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02997308224439621, decouple_loss:0.00145259581040591
loss_pred:0.029073627665638924, decouple_loss:0.0012683881213888526
Iteration: 3436, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481337070465088, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03044733591377735, decouple_loss:0.0011470336467027664
The modified gen p mean: 0.44441717863082886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029492013156414032, decouple_loss:0.0012799411779269576
The modified gen p mean: 0.44815170764923096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028264248743653297, decouple_loss:0.0013170065358281136
Iteration: 3437, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45094984769821167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03024298883974552, decouple_loss:0.0011969872284680605
The modified gen p mean: 0.44555848836898804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029094774276018143, decouple_loss:0.001414742786437273
The modified gen p mean: 0.44823551177978516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03108610212802887, decouple_loss:0.0011530371848493814
Iteration: 3438, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4535599648952484, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.449675977230072, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029225824400782585, decouple_loss:0.0012794521171599627
loss_pred:0.03016849420964718, decouple_loss:0.0011930870823562145
The modified gen p mean: 0.4503978490829468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028099248185753822, decouple_loss:0.001380765694193542
Iteration: 3439, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45071280002593994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028697846457362175, decouple_loss:0.0012370044132694602
The modified gen p mean: 0.45452553033828735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028148090466856956, decouple_loss:0.0014366991817951202
The modified gen p mean: 0.4532105624675751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027766279876232147, decouple_loss:0.001432984252460301
Iteration: 3440, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45361328125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028816934674978256, decouple_loss:0.0012607439421117306
The modified gen p mean: 0.45445889234542847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02866215445101261, decouple_loss:0.0013739124406129122
The modified gen p mean: 0.4498768746852875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029764696955680847, decouple_loss:0.00127040920779109
2023-05-27 04:23:36 testing...
The modified gen p mean: 0.455803781747818, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03221546486020088, decouple_loss:0.0015569557435810566
The modified gen p mean: 0.4543578028678894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03279083967208862, decouple_loss:0.0014204744948074222
The modified gen p mean: 0.45541462302207947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03427255153656006, decouple_loss:0.0015956826973706484
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03316917270421982, avg_mse: 0.04515649378299713
current test mse: 0.045156
Iteration: 3441, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4565998613834381, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02911008521914482, decouple_loss:0.0013214616337791085
The modified gen p mean: 0.4522002637386322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027776775881648064, decouple_loss:0.0014753829455003142
The modified gen p mean: 0.4552440941333771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030255986377596855, decouple_loss:0.001233092974871397
Iteration: 3442, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4527502655982971, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028091663494706154, decouple_loss:0.0011860671220347285
The modified gen p mean: 0.4521803557872772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030436664819717407, decouple_loss:0.0012353794882073998
The modified gen p mean: 0.4519498944282532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027607159689068794, decouple_loss:0.001354241045191884
Iteration: 3443, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480520486831665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02909846231341362, decouple_loss:0.001275851158425212
The modified gen p mean: 0.44870880246162415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03078293986618519, decouple_loss:0.0012567644007503986
The modified gen p mean: 0.451336532831192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029386501759290695, decouple_loss:0.001214973279275
Iteration: 3444, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495126008987427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0302816741168499, decouple_loss:0.0012808075407519937
The modified gen p mean: 0.4477230906486511, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02953626960515976, decouple_loss:0.0012364530703052878
The modified gen p mean: 0.45120543241500854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028300181031227112, decouple_loss:0.0013540396466851234
Iteration: 3445, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45162302255630493, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02985539846122265, decouple_loss:0.0014091873308643699
The modified gen p mean: 0.4475926458835602, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028168626129627228, decouple_loss:0.0012746942229568958
The modified gen p mean: 0.4488458037376404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02880098856985569, decouple_loss:0.0013208886375650764
Iteration: 3446, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44646045565605164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029040776193141937, decouple_loss:0.0012997979065403342
The modified gen p mean: 0.44936713576316833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029411938041448593, decouple_loss:0.0012252250453457236
The modified gen p mean: 0.45050978660583496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028753647580742836, decouple_loss:0.0013712887885048985
Iteration: 3447, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475612938404083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030121175572276115, decouple_loss:0.0013302179286256433
The modified gen p mean: 0.4461483359336853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028538022190332413, decouple_loss:0.001236227573826909
The modified gen p mean: 0.4454251527786255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029167789965867996, decouple_loss:0.0012764735147356987
Iteration: 3448, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481883943080902, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030077489092946053, decouple_loss:0.001279607997275889
The modified gen p mean: 0.44516700506210327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030160801485180855, decouple_loss:0.0012570993276312947
The modified gen p mean: 0.44622930884361267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02901683934032917, decouple_loss:0.0012173375580459833
Iteration: 3449, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454919993877411, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028590042144060135, decouple_loss:0.0013517708284780383
The modified gen p mean: 0.4477328658103943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028420010581612587, decouple_loss:0.0013603490078821778
The modified gen p mean: 0.4457141160964966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029442884027957916, decouple_loss:0.0011640581069514155
Iteration: 3450, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44460955262184143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02845894545316696, decouple_loss:0.001223249826580286
The modified gen p mean: 0.4463876187801361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029327120631933212, decouple_loss:0.0013086473336443305
The modified gen p mean: 0.4484429359436035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820611000061035, decouple_loss:0.0015653664013370872
2023-05-27 04:27:41 testing...
The modified gen p mean: 0.4519171416759491, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03237159177660942, decouple_loss:0.0015404440928250551
The modified gen p mean: 0.4502214789390564, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.451302707195282, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03288879618048668, decouple_loss:0.0014699469320476055
loss_pred:0.03430702164769173, decouple_loss:0.0015984708443284035
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03326595202088356, avg_mse: 0.04531856253743172
current test mse: 0.045319
Iteration: 3451, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4530397355556488, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02926521934568882, decouple_loss:0.001341070979833603
The modified gen p mean: 0.44552740454673767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028938936069607735, decouple_loss:0.0012643181253224611
The modified gen p mean: 0.4484049379825592, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030148539692163467, decouple_loss:0.0012985320063307881
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3452, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492495656013489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028198331594467163, decouple_loss:0.0013862295309081674
The modified gen p mean: 0.44733643531799316, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4499613344669342, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028091713786125183, decouple_loss:0.0013338790740817785
loss_pred:0.027120307087898254, decouple_loss:0.001314741326496005
Iteration: 3453, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502476751804352, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02775532566010952, decouple_loss:0.0013443968491628766
The modified gen p mean: 0.45021459460258484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02681979537010193, decouple_loss:0.0013262705178931355
The modified gen p mean: 0.4475509822368622, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028057066723704338, decouple_loss:0.0013509395066648722
Iteration: 3454, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45170503854751587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02592194639146328, decouple_loss:0.0014537639217451215
The modified gen p mean: 0.44969436526298523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027913203462958336, decouple_loss:0.0013928984990343451
The modified gen p mean: 0.4499123692512512, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026197800412774086, decouple_loss:0.0014390568248927593
Iteration: 3455, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496747553348541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02883055806159973, decouple_loss:0.00138358143158257
The modified gen p mean: 0.4515649080276489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026761820539832115, decouple_loss:0.001319198403507471
The modified gen p mean: 0.4482335150241852, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02931503765285015, decouple_loss:0.0013810491655021906
Iteration: 3456, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477873742580414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028383810073137283, decouple_loss:0.001398315536789596
The modified gen p mean: 0.44829148054122925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02609275095164776, decouple_loss:0.001391163095831871
The modified gen p mean: 0.4469127357006073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02758408524096012, decouple_loss:0.0012215079041197896
Iteration: 3457, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489828944206238, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026366224512457848, decouple_loss:0.0013923939550295472
The modified gen p mean: 0.44804325699806213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02621244080364704, decouple_loss:0.0013249643379822373
The modified gen p mean: 0.4492512047290802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02619960717856884, decouple_loss:0.0014237579889595509
Iteration: 3458, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44527947902679443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028206201270222664, decouple_loss:0.0015248495619744062
The modified gen p mean: 0.44614800810813904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027251455932855606, decouple_loss:0.0012646493269130588
The modified gen p mean: 0.44544079899787903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028190622106194496, decouple_loss:0.001327005447819829
Iteration: 3459, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468097984790802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025980230420827866, decouple_loss:0.0013854574644938111
The modified gen p mean: 0.445606529712677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02793329767882824, decouple_loss:0.0013890241971239448
The modified gen p mean: 0.4469740390777588, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02671281434595585, decouple_loss:0.0014881463721394539
Iteration: 3460, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44198957085609436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028430907055735588, decouple_loss:0.0012818870600312948
The modified gen p mean: 0.4430646002292633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02746511995792389, decouple_loss:0.0013074860908091068
The modified gen p mean: 0.4415617287158966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027919694781303406, decouple_loss:0.001421130495145917
2023-05-27 04:32:38 testing...
The modified gen p mean: 0.44719427824020386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03258111700415611, decouple_loss:0.0015035823453217745
The modified gen p mean: 0.4466628432273865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03428297117352486, decouple_loss:0.0015671575674787164
The modified gen p mean: 0.44584280252456665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03280278295278549, decouple_loss:0.0014895072672516108
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033298294991254807, avg_mse: 0.04540480673313141
current test mse: 0.045405
Iteration: 3461, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44157809019088745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02779340371489525, decouple_loss:0.0014026716817170382
The modified gen p mean: 0.43987974524497986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028016867116093636, decouple_loss:0.0013659137766808271
The modified gen p mean: 0.4427628815174103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026220161467790604, decouple_loss:0.001397938933223486
Iteration: 3462, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44457411766052246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02714986354112625, decouple_loss:0.0012903069145977497
The modified gen p mean: 0.44210949540138245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02829037234187126, decouple_loss:0.001442799693904817
The modified gen p mean: 0.44178253412246704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028705712407827377, decouple_loss:0.0013254230143502355
Iteration: 3463, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44716453552246094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027190938591957092, decouple_loss:0.0014414539327844977
The modified gen p mean: 0.4437030255794525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027201281860470772, decouple_loss:0.001285079400986433
The modified gen p mean: 0.44786325097084045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026053449138998985, decouple_loss:0.0014070920879021287
Iteration: 3464, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44472360610961914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02728486806154251, decouple_loss:0.0014394746394827962
The modified gen p mean: 0.4427834451198578, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02812225930392742, decouple_loss:0.0013384410412982106
The modified gen p mean: 0.44395700097084045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0277109257876873, decouple_loss:0.0012997189769521356
Iteration: 3465, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449850469827652, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026889024302363396, decouple_loss:0.0013645607978105545
The modified gen p mean: 0.445666640996933, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026453839614987373, decouple_loss:0.0013923991937190294
The modified gen p mean: 0.4464786648750305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02798916958272457, decouple_loss:0.0013807881623506546
Iteration: 3466, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475236237049103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02513846941292286, decouple_loss:0.001460509141907096
The modified gen p mean: 0.44913971424102783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02595437690615654, decouple_loss:0.0013601476093754172
The modified gen p mean: 0.44845613837242126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024678528308868408, decouple_loss:0.0013709402410313487
Iteration: 3467, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44925007224082947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02675003930926323, decouple_loss:0.001496105338446796
The modified gen p mean: 0.4462023675441742, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027858879417181015, decouple_loss:0.0014353280421346426
The modified gen p mean: 0.450911283493042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027252348139882088, decouple_loss:0.0013714650413021445
Iteration: 3468, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450938105583191, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027630576863884926, decouple_loss:0.0013115291949361563
The modified gen p mean: 0.450147420167923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026681052520871162, decouple_loss:0.0014074189821258187
The modified gen p mean: 0.4462667405605316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027258317917585373, decouple_loss:0.0013727678451687098
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3469, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44821926951408386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028075028210878372, decouple_loss:0.0014754274161532521
The modified gen p mean: 0.4498370587825775, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.447065532207489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02606847509741783, decouple_loss:0.0013122463133186102
loss_pred:0.026987511664628983, decouple_loss:0.0016786875203251839
Iteration: 3470, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44647255539894104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026770468801259995, decouple_loss:0.00155225011985749
The modified gen p mean: 0.4459642767906189, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027028214186429977, decouple_loss:0.0013886099914088845
The modified gen p mean: 0.44925686717033386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02579614706337452, decouple_loss:0.0012723887339234352
2023-05-27 04:37:20 testing...
The modified gen p mean: 0.45046278834342957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259807080030441, decouple_loss:0.0015508144861087203
The modified gen p mean: 0.4491806924343109, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03280050307512283, decouple_loss:0.0014330634148791432
The modified gen p mean: 0.44999074935913086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034290798008441925, decouple_loss:0.0015922265592962503
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0333060584962368, avg_mse: 0.04549340903759003
current test mse: 0.045493
Iteration: 3471, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44606927037239075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026401761919260025, decouple_loss:0.00146230508107692
The modified gen p mean: 0.4474332928657532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025276588276028633, decouple_loss:0.0013506192481145263
The modified gen p mean: 0.44963276386260986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02565576322376728, decouple_loss:0.0015039780410006642
Iteration: 3472, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44635212421417236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027074355632066727, decouple_loss:0.0012862259754911065
The modified gen p mean: 0.44558125734329224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02810640074312687, decouple_loss:0.0012162907514721155
The modified gen p mean: 0.44574129581451416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025957627221941948, decouple_loss:0.0013350120279937983
Iteration: 3473, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451221227645874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0280197411775589, decouple_loss:0.0012504404876381159
The modified gen p mean: 0.4458163380622864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026853540912270546, decouple_loss:0.0012542870827019215
The modified gen p mean: 0.4453422725200653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026929549872875214, decouple_loss:0.0014248569495975971
Iteration: 3474, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45050403475761414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026299599558115005, decouple_loss:0.0015019717393442988
The modified gen p mean: 0.44539380073547363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027224622666835785, decouple_loss:0.001312979613430798
The modified gen p mean: 0.4509466886520386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025727273896336555, decouple_loss:0.0014100887347012758
Iteration: 3475, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45191243290901184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02605200745165348, decouple_loss:0.0014938325621187687
The modified gen p mean: 0.4484001696109772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02721700631082058, decouple_loss:0.0012742721009999514
The modified gen p mean: 0.4497653543949127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027038784697651863, decouple_loss:0.0013340695295482874
Iteration: 3476, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507652819156647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026997406035661697, decouple_loss:0.001282497076317668
The modified gen p mean: 0.4523807466030121, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025589177384972572, decouple_loss:0.0014124733861535788
The modified gen p mean: 0.4512083828449249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02643951214849949, decouple_loss:0.0014450870221480727
Iteration: 3477, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45500925183296204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024779461324214935, decouple_loss:0.0013778121210634708
The modified gen p mean: 0.4542772173881531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0254143588244915, decouple_loss:0.00136989273596555
The modified gen p mean: 0.4506724774837494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027348140254616737, decouple_loss:0.001249426044523716
Iteration: 3478, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45396217703819275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026458708569407463, decouple_loss:0.0013491291319951415
The modified gen p mean: 0.45036494731903076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610522322356701, decouple_loss:0.0013813572004437447
The modified gen p mean: 0.45511770248413086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025749456137418747, decouple_loss:0.001417045947164297
Iteration: 3479, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45113974809646606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02601982280611992, decouple_loss:0.0013573605101555586
The modified gen p mean: 0.45133551955223083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026171209290623665, decouple_loss:0.0013251390773802996
The modified gen p mean: 0.4486224353313446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026897698640823364, decouple_loss:0.0014443328836932778
Iteration: 3480, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497183561325073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02568271942436695, decouple_loss:0.0016194320050999522
The modified gen p mean: 0.4526614844799042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026061881333589554, decouple_loss:0.0014429688453674316
The modified gen p mean: 0.44782814383506775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02661365456879139, decouple_loss:0.0014481432735919952
2023-05-27 04:41:25 testing...
The modified gen p mean: 0.45205622911453247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03310682997107506, decouple_loss:0.0015912484377622604
The modified gen p mean: 0.4505264461040497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03337974101305008, decouple_loss:0.0014174046227708459
The modified gen p mean: 0.45183560252189636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03492269292473793, decouple_loss:0.001634342479519546
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03388047218322754, avg_mse: 0.04642820358276367
current test mse: 0.046428
Iteration: 3481, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518187940120697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026177125051617622, decouple_loss:0.0013178077060729265
The modified gen p mean: 0.4471740424633026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026801303029060364, decouple_loss:0.0012505411868914962
The modified gen p mean: 0.44622907042503357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027028825134038925, decouple_loss:0.0011467854492366314
Iteration: 3482, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44831979274749756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025849876925349236, decouple_loss:0.001293820678256452
The modified gen p mean: 0.44896066188812256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026233715936541557, decouple_loss:0.0012418789556249976
The modified gen p mean: 0.4481624364852905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026524890214204788, decouple_loss:0.0012983949854969978
Iteration: 3483, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44681045413017273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02657226473093033, decouple_loss:0.0014223991893231869
The modified gen p mean: 0.4463757574558258, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026951564475893974, decouple_loss:0.0013527674600481987
The modified gen p mean: 0.44990789890289307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026089763268828392, decouple_loss:0.0014284519711509347
Iteration: 3484, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44737207889556885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02614365704357624, decouple_loss:0.0012423418229445815
The modified gen p mean: 0.4505326747894287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025985848158597946, decouple_loss:0.0013091942528262734
The modified gen p mean: 0.4515395164489746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02593045122921467, decouple_loss:0.0013313922099769115
Iteration: 3485, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44754767417907715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027500974014401436, decouple_loss:0.0013083957601338625
The modified gen p mean: 0.4478825032711029, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026111222803592682, decouple_loss:0.0012314533814787865
The modified gen p mean: 0.44931837916374207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026745032519102097, decouple_loss:0.0014194095274433494
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr.npz
NaN value num: 0
Iteration: 3486, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463774859905243, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02731340005993843, decouple_loss:0.0013204171555116773
The modified gen p mean: 0.44683191180229187, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44768455624580383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024658096954226494, decouple_loss:0.0014142560539767146
loss_pred:0.026447076350450516, decouple_loss:0.0013339279685169458
Iteration: 3487, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44978857040405273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025126751512289047, decouple_loss:0.0013264924054965377
The modified gen p mean: 0.44475236535072327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027379034087061882, decouple_loss:0.0013476762687787414
The modified gen p mean: 0.44882363080978394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025280268862843513, decouple_loss:0.00144391565117985
Iteration: 3488, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4435529410839081, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02755393087863922, decouple_loss:0.0013668255414813757
The modified gen p mean: 0.44482946395874023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02683793194591999, decouple_loss:0.001294904388487339
The modified gen p mean: 0.4466802477836609, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026545455679297447, decouple_loss:0.00129693781491369
Iteration: 3489, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477193355560303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02632455714046955, decouple_loss:0.0012154118157923222
The modified gen p mean: 0.44907090067863464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025431692600250244, decouple_loss:0.001247743028216064
The modified gen p mean: 0.4453515112400055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026812413707375526, decouple_loss:0.001437637722119689
Iteration: 3490, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44572633504867554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02578837051987648, decouple_loss:0.0012661529472097754
The modified gen p mean: 0.445272833108902, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02493940107524395, decouple_loss:0.0013516577892005444
The modified gen p mean: 0.4454241693019867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02735424041748047, decouple_loss:0.0014493874041363597
2023-05-27 04:46:12 testing...
The modified gen p mean: 0.45055949687957764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032558541744947433, decouple_loss:0.0014855886111035943
The modified gen p mean: 0.4491270184516907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03288142755627632, decouple_loss:0.0014164666645228863
The modified gen p mean: 0.4503014385700226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03438660129904747, decouple_loss:0.0014789251144975424
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03334853798151016, avg_mse: 0.04557780921459198
current test mse: 0.045578
Iteration: 3491, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44616416096687317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025214243680238724, decouple_loss:0.0013108858838677406
The modified gen p mean: 0.4465029835700989, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026355763897299767, decouple_loss:0.0012447694316506386
The modified gen p mean: 0.4482528269290924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026172097772359848, decouple_loss:0.0012864458840340376
Iteration: 3492, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44509682059288025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027278708294034004, decouple_loss:0.0013617922086268663
The modified gen p mean: 0.4446220099925995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027221808210015297, decouple_loss:0.0014873490436002612
The modified gen p mean: 0.4441520869731903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02668914385139942, decouple_loss:0.0013627951266244054
Iteration: 3493, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44427552819252014, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025637533515691757, decouple_loss:0.0012489865766838193
The modified gen p mean: 0.44679388403892517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02407725714147091, decouple_loss:0.0012682556407526135
The modified gen p mean: 0.4449014365673065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026555631309747696, decouple_loss:0.0011814312310889363
Iteration: 3494, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491589665412903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02487441524863243, decouple_loss:0.0012397101381793618
The modified gen p mean: 0.4452727735042572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025598950684070587, decouple_loss:0.0012622023932635784
The modified gen p mean: 0.44474950432777405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02687213383615017, decouple_loss:0.0012591836275532842
Iteration: 3495, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44367262721061707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026326745748519897, decouple_loss:0.001171803567558527
The modified gen p mean: 0.4436296820640564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02664347179234028, decouple_loss:0.00130891939625144
The modified gen p mean: 0.44483664631843567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027517525479197502, decouple_loss:0.0012479895958676934
Iteration: 3496, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44629284739494324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024811606854200363, decouple_loss:0.0013564996188506484
The modified gen p mean: 0.44551655650138855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026983972638845444, decouple_loss:0.0012281653471291065
The modified gen p mean: 0.44431784749031067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02671358361840248, decouple_loss:0.0012191188288852572
Iteration: 3497, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44836559891700745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025716418400406837, decouple_loss:0.001321900519542396
The modified gen p mean: 0.44976767897605896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02613026089966297, decouple_loss:0.0013914102455601096
The modified gen p mean: 0.4443250000476837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027897492051124573, decouple_loss:0.0011578452540561557
Iteration: 3498, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44866862893104553, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4478610157966614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0249431561678648, decouple_loss:0.001269504427909851
loss_pred:0.025158759206533432, decouple_loss:0.001232253503985703
The modified gen p mean: 0.4473522901535034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02544558234512806, decouple_loss:0.0012986307265236974
Iteration: 3499, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447118878364563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025916187092661858, decouple_loss:0.0012286152923479676
The modified gen p mean: 0.4460468888282776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02495047263801098, decouple_loss:0.0012175677111372352
The modified gen p mean: 0.4463295340538025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026800915598869324, decouple_loss:0.0012805822771042585
Iteration: 3500, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44669631123542786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026595696806907654, decouple_loss:0.0012587412493303418
The modified gen p mean: 0.4466698169708252, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027057964354753494, decouple_loss:0.0013216340448707342
The modified gen p mean: 0.44742482900619507, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02770739607512951, decouple_loss:0.0012154639698565006
2023-05-27 04:50:18 testing...
The modified gen p mean: 0.45190027356147766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032548148185014725, decouple_loss:0.0013989044819027185
The modified gen p mean: 0.45184969902038574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03421607241034508, decouple_loss:0.0014006801648065448
The modified gen p mean: 0.45040345191955566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03260435163974762, decouple_loss:0.0012812432833015919
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03319087252020836, avg_mse: 0.04533490166068077
current test mse: 0.045335
Iteration: 3501, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441543221473694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027198785915970802, decouple_loss:0.0011735492153093219
The modified gen p mean: 0.4500601589679718, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025838688015937805, decouple_loss:0.00123639649245888
The modified gen p mean: 0.44410520792007446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026688678190112114, decouple_loss:0.0011746493401005864
Iteration: 3502, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44696420431137085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025841085240244865, decouple_loss:0.0012026299955323339
The modified gen p mean: 0.4471553564071655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026569295674562454, decouple_loss:0.0013632893096655607
The modified gen p mean: 0.44443076848983765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026581158861517906, decouple_loss:0.0011523873545229435
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr.npz
NaN value num: 0
Iteration: 3503, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476487338542938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031318120658397675, decouple_loss:0.0013364084297791123
The modified gen p mean: 0.44318756461143494, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4449330270290375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028244804590940475, decouple_loss:0.0013510717544704676loss_pred:0.029542336240410805, decouple_loss:0.0015247974079102278
Iteration: 3504, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44555506110191345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029918234795331955, decouple_loss:0.0012373676290735602
The modified gen p mean: 0.4463840425014496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029747894033789635, decouple_loss:0.0012537760194391012
The modified gen p mean: 0.4458649456501007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03025568276643753, decouple_loss:0.001364614930935204
Iteration: 3505, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45072317123413086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029692986980080605, decouple_loss:0.0012297456851229072
The modified gen p mean: 0.4483514428138733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0288397204130888, decouple_loss:0.001300452509894967
The modified gen p mean: 0.4476623833179474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030595779418945312, decouple_loss:0.0011982679134234786
Iteration: 3506, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45215991139411926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0283700842410326, decouple_loss:0.0013517517363652587
The modified gen p mean: 0.45452848076820374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027692709118127823, decouple_loss:0.0014976722886785865
The modified gen p mean: 0.44968104362487793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029372869059443474, decouple_loss:0.0012560499599203467
Iteration: 3507, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45077019929885864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029979979619383812, decouple_loss:0.0012562994379550219
The modified gen p mean: 0.451040118932724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028417309746146202, decouple_loss:0.001368812401778996
The modified gen p mean: 0.45328959822654724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02909822203218937, decouple_loss:0.0013571408344432712
Iteration: 3508, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518493115901947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02994893491268158, decouple_loss:0.001238300814293325
The modified gen p mean: 0.4545880854129791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028069576248526573, decouple_loss:0.001336683752015233
The modified gen p mean: 0.4528347849845886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029249953106045723, decouple_loss:0.0013462656643241644
Iteration: 3509, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4523327350616455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028894314542412758, decouple_loss:0.0013187213335186243
The modified gen p mean: 0.4529394507408142, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028332723304629326, decouple_loss:0.0013359356671571732
The modified gen p mean: 0.44991156458854675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02889752946794033, decouple_loss:0.0012679832288995385
Iteration: 3510, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44922709465026855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029749257490038872, decouple_loss:0.0012598899193108082
The modified gen p mean: 0.4519536793231964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02791823446750641, decouple_loss:0.0013815349666401744
The modified gen p mean: 0.45228487253189087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027964144945144653, decouple_loss:0.0012939715525135398
2023-05-27 04:55:06 testing...
The modified gen p mean: 0.45198383927345276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032235100865364075, decouple_loss:0.0014575704699382186
The modified gen p mean: 0.45016083121299744, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4516492784023285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032427262514829636, decouple_loss:0.0013460458721965551
loss_pred:0.03390742838382721, decouple_loss:0.0015180985210463405
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032928626984357834, avg_mse: 0.04474867135286331
current test mse: 0.044749
Iteration: 3511, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467988908290863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02957264520227909, decouple_loss:0.0013011549599468708
The modified gen p mean: 0.45082932710647583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028123408555984497, decouple_loss:0.0013823533663526177
The modified gen p mean: 0.45209935307502747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02855054661631584, decouple_loss:0.0014475833158940077
Iteration: 3512, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44308751821517944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02919902466237545, decouple_loss:0.0013228693278506398
The modified gen p mean: 0.44586431980133057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02787628024816513, decouple_loss:0.0014339276822283864
The modified gen p mean: 0.44826310873031616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02780831605195999, decouple_loss:0.0013884626096114516
Iteration: 3513, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44342198967933655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030068088322877884, decouple_loss:0.001355747110210359
The modified gen p mean: 0.4440959692001343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028384430333971977, decouple_loss:0.001261519966647029
The modified gen p mean: 0.44441738724708557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029557542875409126, decouple_loss:0.0013303911546245217
Iteration: 3514, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44717252254486084, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4446057975292206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0292535200715065, decouple_loss:0.0014416269259527326
loss_pred:0.02749824710190296, decouple_loss:0.0013702375581488013
The modified gen p mean: 0.44216030836105347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030320947989821434, decouple_loss:0.0013054248411208391
Iteration: 3515, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44464388489723206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029151953756809235, decouple_loss:0.0011884854175150394
The modified gen p mean: 0.4437345862388611, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028493789955973625, decouple_loss:0.0013880570186302066
The modified gen p mean: 0.4459013342857361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02848999574780464, decouple_loss:0.0015658220509067178
Iteration: 3516, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453452527523041, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.449541300535202, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028958488255739212, decouple_loss:0.0013394562993198633
loss_pred:0.028636153787374496, decouple_loss:0.0014628638746216893
The modified gen p mean: 0.44679126143455505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02860053814947605, decouple_loss:0.001362172537483275
Iteration: 3517, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44659632444381714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030424242839217186, decouple_loss:0.0013999452348798513
The modified gen p mean: 0.44797563552856445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028138240799307823, decouple_loss:0.0014907647855579853
The modified gen p mean: 0.44745683670043945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029153898358345032, decouple_loss:0.001254996401257813
Iteration: 3518, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45139333605766296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02924419566988945, decouple_loss:0.001385218696668744
The modified gen p mean: 0.44789958000183105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02901623398065567, decouple_loss:0.0014597433619201183
The modified gen p mean: 0.44937077164649963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02807152085006237, decouple_loss:0.0012898141285404563
Iteration: 3519, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490107297897339, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02907152660191059, decouple_loss:0.0012613972648978233
The modified gen p mean: 0.45069146156311035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029177824035286903, decouple_loss:0.001366048352792859
The modified gen p mean: 0.45367830991744995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029352320358157158, decouple_loss:0.001411392237059772
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr.npz
NaN value num: 0
Iteration: 3520, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45059889554977417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02962171845138073, decouple_loss:0.0012923387112095952
The modified gen p mean: 0.44900888204574585, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45384904742240906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028301481157541275, decouple_loss:0.0014317892491817474
loss_pred:0.030370119959115982, decouple_loss:0.0013589569134637713
2023-05-27 04:59:58 testing...
The modified gen p mean: 0.4543039798736572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03235338255763054, decouple_loss:0.001495101721957326
The modified gen p mean: 0.4523669183254242, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246047720313072, decouple_loss:0.0014219925506040454
The modified gen p mean: 0.4539678692817688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03393187373876572, decouple_loss:0.0015065907500684261
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03298897296190262, avg_mse: 0.044860173016786575
current test mse: 0.04486
Iteration: 3521, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44818517565727234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03050347790122032, decouple_loss:0.001280458178371191
The modified gen p mean: 0.45106059312820435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02920299395918846, decouple_loss:0.0013584013795480132
The modified gen p mean: 0.449111670255661, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029741307720541954, decouple_loss:0.0013193761697039008
Iteration: 3522, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498457610607147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02759024314582348, decouple_loss:0.0015290338778868318
The modified gen p mean: 0.4488212466239929, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030465854331851006, decouple_loss:0.0013558152131736279
The modified gen p mean: 0.4532775580883026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029103349894285202, decouple_loss:0.0013363804901018739
Iteration: 3523, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493241012096405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02920065075159073, decouple_loss:0.001295887865126133
The modified gen p mean: 0.449035108089447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029765941202640533, decouple_loss:0.0014113477664068341
The modified gen p mean: 0.4507210850715637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0287955142557621, decouple_loss:0.001398846274241805
Iteration: 3524, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45303499698638916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029682543128728867, decouple_loss:0.00130942661780864
The modified gen p mean: 0.45197874307632446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028961988165974617, decouple_loss:0.0013747448101639748
The modified gen p mean: 0.4476316571235657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029949262738227844, decouple_loss:0.0013453986030071974
Iteration: 3525, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509534239768982, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02948158234357834, decouple_loss:0.0013866776134818792
The modified gen p mean: 0.45039230585098267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029298074543476105, decouple_loss:0.0012042149901390076
The modified gen p mean: 0.4512253701686859, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028735514730215073, decouple_loss:0.0013660831609740853
Iteration: 3526, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45164868235588074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02822749875485897, decouple_loss:0.0014656762359663844
The modified gen p mean: 0.4464288651943207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02854679897427559, decouple_loss:0.0013858888996765018
The modified gen p mean: 0.4506348669528961, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029313908889889717, decouple_loss:0.0013910962734371424
Iteration: 3527, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44726991653442383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030225373804569244, decouple_loss:0.0013859433820471168
The modified gen p mean: 0.4495337903499603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028243860229849815, decouple_loss:0.0013011556584388018
The modified gen p mean: 0.4471820294857025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031214185059070587, decouple_loss:0.001167499227449298
Iteration: 3528, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505511522293091, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0283475611358881, decouple_loss:0.001289854757487774
The modified gen p mean: 0.44815731048583984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029446905478835106, decouple_loss:0.0012103380868211389
The modified gen p mean: 0.4488402009010315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02993703819811344, decouple_loss:0.0012904275208711624
Iteration: 3529, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488089084625244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02940688468515873, decouple_loss:0.0012799048563465476
The modified gen p mean: 0.4487629234790802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029994025826454163, decouple_loss:0.001202153624035418
The modified gen p mean: 0.4486280679702759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02915920503437519, decouple_loss:0.0012807617895305157
Iteration: 3530, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474670886993408, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028922714293003082, decouple_loss:0.0013012791750952601
The modified gen p mean: 0.44887521862983704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031029464676976204, decouple_loss:0.0013222661800682545
The modified gen p mean: 0.4498211443424225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02865796908736229, decouple_loss:0.0012938653817400336
2023-05-27 05:04:03 testing...
The modified gen p mean: 0.4533989131450653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032282933592796326, decouple_loss:0.0015674628084525466
The modified gen p mean: 0.4514731764793396, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4530898928642273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03256510943174362, decouple_loss:0.0013643356505781412
loss_pred:0.03404845669865608, decouple_loss:0.0016434749122709036
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03304175287485123, avg_mse: 0.04493877291679382
current test mse: 0.044939
Iteration: 3531, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447296679019928, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030355699360370636, decouple_loss:0.001216957694850862
The modified gen p mean: 0.45312005281448364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02888854220509529, decouple_loss:0.0014864978147670627
The modified gen p mean: 0.4521820843219757, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028643297031521797, decouple_loss:0.0013694274239242077
Iteration: 3532, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487400949001312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02754892408847809, decouple_loss:0.0013838076265528798
The modified gen p mean: 0.4501439332962036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02853281795978546, decouple_loss:0.0013847327791154385
The modified gen p mean: 0.44910764694213867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03028910979628563, decouple_loss:0.0011964450823143125
Iteration: 3533, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45047837495803833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02898463048040867, decouple_loss:0.0012433843221515417
The modified gen p mean: 0.45189547538757324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030036428943276405, decouple_loss:0.0012844523880630732
The modified gen p mean: 0.4500628411769867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02803540602326393, decouple_loss:0.0012838204856961966
Iteration: 3534, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44987568259239197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03034241497516632, decouple_loss:0.0013288776390254498
The modified gen p mean: 0.4513755440711975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028575021773576736, decouple_loss:0.001346076955087483
The modified gen p mean: 0.4479772746562958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03101927414536476, decouple_loss:0.0011974622029811144
Iteration: 3535, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45275983214378357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02891731634736061, decouple_loss:0.0013029861729592085
The modified gen p mean: 0.45223772525787354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02808316797018051, decouple_loss:0.0012570457765832543
The modified gen p mean: 0.4486697316169739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029375357553362846, decouple_loss:0.0012798667885363102
Iteration: 3536, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44737085700035095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028889868408441544, decouple_loss:0.0012383742723613977
The modified gen p mean: 0.44898802042007446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02894594706594944, decouple_loss:0.0012530556414276361
The modified gen p mean: 0.4506343901157379, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02938109077513218, decouple_loss:0.0012783600250259042
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr.npz
NaN value num: 0
Iteration: 3537, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44765445590019226, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4464130103588104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02501021884381771, decouple_loss:0.0012210665736347437
loss_pred:0.026485664770007133, decouple_loss:0.00131133699323982
The modified gen p mean: 0.4493187367916107, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025728518143296242, decouple_loss:0.0012469548964872956
Iteration: 3538, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44700098037719727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02601545676589012, decouple_loss:0.0014163961168378592
The modified gen p mean: 0.44905969500541687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025896413251757622, decouple_loss:0.001390083460137248
The modified gen p mean: 0.4449705183506012, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02688004821538925, decouple_loss:0.001116893719881773
Iteration: 3539, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457119107246399, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02592473477125168, decouple_loss:0.0012719177175313234
The modified gen p mean: 0.4456721246242523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02545728161931038, decouple_loss:0.0013594279298558831
The modified gen p mean: 0.4468638300895691, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025242570787668228, decouple_loss:0.0012450935319066048
Iteration: 3540, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4417385458946228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02755042351782322, decouple_loss:0.0011933395871892571
The modified gen p mean: 0.44649794697761536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02599838748574257, decouple_loss:0.00128839910030365
The modified gen p mean: 0.44084104895591736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02622816152870655, decouple_loss:0.00128753122407943
2023-05-27 05:08:58 testing...
The modified gen p mean: 0.44804078340530396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230556100606918, decouple_loss:0.00149614701513201
The modified gen p mean: 0.4462502896785736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265973925590515, decouple_loss:0.0014615863328799605
The modified gen p mean: 0.4477408826351166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03415522351861, decouple_loss:0.0014929077588021755
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03311435505747795, avg_mse: 0.04511715844273567
current test mse: 0.045117
Iteration: 3541, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4404456615447998, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02671603299677372, decouple_loss:0.0012921240413561463
The modified gen p mean: 0.4428318440914154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02693452499806881, decouple_loss:0.001269930973649025
The modified gen p mean: 0.44585752487182617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02568916603922844, decouple_loss:0.0012199805350974202
Iteration: 3542, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484737515449524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025454437360167503, decouple_loss:0.0013010049005970359
The modified gen p mean: 0.44945821166038513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025574497878551483, decouple_loss:0.0012472450034692883
The modified gen p mean: 0.4481189548969269, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025332579389214516, decouple_loss:0.0012575855944305658
Iteration: 3543, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44330844283103943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026111751794815063, decouple_loss:0.0012348865857347846
The modified gen p mean: 0.4444084167480469, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025937067344784737, decouple_loss:0.0013793790712952614
The modified gen p mean: 0.450337678194046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025680923834443092, decouple_loss:0.0012449071509763598
Iteration: 3544, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516674876213074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02492409013211727, decouple_loss:0.0013309372588992119
The modified gen p mean: 0.44638684391975403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026112794876098633, decouple_loss:0.0013547352282330394
The modified gen p mean: 0.4510241150856018, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025643598288297653, decouple_loss:0.0013516967883333564
Iteration: 3545, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490222930908203, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026607954874634743, decouple_loss:0.0012218523770570755
The modified gen p mean: 0.4514320194721222, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025000888854265213, decouple_loss:0.0012309005251154304
The modified gen p mean: 0.44948330521583557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027141692116856575, decouple_loss:0.0012796035734936595
Iteration: 3546, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45386672019958496, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45206332206726074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02584916353225708, decouple_loss:0.0013061423087492585
loss_pred:0.026464739814400673, decouple_loss:0.0013234504731371999
The modified gen p mean: 0.4491150379180908, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02602372132241726, decouple_loss:0.001217144774273038
Iteration: 3547, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44867709279060364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673448622226715, decouple_loss:0.0012047815835103393
The modified gen p mean: 0.4503594636917114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027165595442056656, decouple_loss:0.0012108634691685438
The modified gen p mean: 0.45175665616989136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025945426896214485, decouple_loss:0.0013033048016950488
Iteration: 3548, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487903118133545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026386182755231857, decouple_loss:0.0011858419748023152
The modified gen p mean: 0.4485175907611847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027603480964899063, decouple_loss:0.0011860417434945703
The modified gen p mean: 0.4519255757331848, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025726718828082085, decouple_loss:0.0012155601289123297
Iteration: 3549, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483084976673126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027140401303768158, decouple_loss:0.0013796009588986635
The modified gen p mean: 0.4527287781238556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025121646001935005, decouple_loss:0.001098316628485918
The modified gen p mean: 0.4499155879020691, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026642555370926857, decouple_loss:0.0011714588617905974
Iteration: 3550, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472942352294922, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025815458968281746, decouple_loss:0.0013364945771172643
The modified gen p mean: 0.4446086883544922, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027122562751173973, decouple_loss:0.0012951578246429563
The modified gen p mean: 0.44851958751678467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02649506740272045, decouple_loss:0.001190957031212747
2023-05-27 05:13:04 testing...
The modified gen p mean: 0.4507165849208832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03241211920976639, decouple_loss:0.0014671813696622849
The modified gen p mean: 0.45047643780708313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03420542925596237, decouple_loss:0.0015795350773259997
The modified gen p mean: 0.4492136240005493, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032714974135160446, decouple_loss:0.0013702259166166186
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03318445757031441, avg_mse: 0.0453890897333622
current test mse: 0.045389
Iteration: 3551, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44611769914627075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02570033073425293, decouple_loss:0.0011852950556203723
The modified gen p mean: 0.4489387571811676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025448355823755264, decouple_loss:0.0011640863958746195
The modified gen p mean: 0.4441761374473572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028058631345629692, decouple_loss:0.0011900730896741152
Iteration: 3552, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44169142842292786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026067743077874184, decouple_loss:0.0012853480875492096
The modified gen p mean: 0.4452816843986511, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026515379548072815, decouple_loss:0.0012935136910527945
The modified gen p mean: 0.4463266432285309, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02606901340186596, decouple_loss:0.0012655762257054448
Iteration: 3553, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4422836899757385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025579683482646942, decouple_loss:0.0013349716318771243
The modified gen p mean: 0.4457060396671295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026330452412366867, decouple_loss:0.0012990034883841872
The modified gen p mean: 0.4454248547554016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612878754734993, decouple_loss:0.0013035928132012486
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr.npz
NaN value num: 0
Iteration: 3554, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469248056411743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02750048041343689, decouple_loss:0.0012383502908051014
The modified gen p mean: 0.44545814394950867, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4449280798435211, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025903576985001564, decouple_loss:0.001236535026691854
loss_pred:0.028072888031601906, decouple_loss:0.0012882939772680402
Iteration: 3555, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451190322637558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026746390387415886, decouple_loss:0.001340151415206492
The modified gen p mean: 0.4454461932182312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028669841587543488, decouple_loss:0.0013756619300693274
The modified gen p mean: 0.4467073380947113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02605203166604042, decouple_loss:0.0013949600979685783
Iteration: 3556, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450339138507843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02680809237062931, decouple_loss:0.0013515191385522485
The modified gen p mean: 0.4478926658630371, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028011463582515717, decouple_loss:0.0014629702782258391
The modified gen p mean: 0.44932401180267334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026456516236066818, decouple_loss:0.0013176348293200135
Iteration: 3557, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493808448314667, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4440670609474182, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026936635375022888, decouple_loss:0.0013887890381738544
loss_pred:0.026854828000068665, decouple_loss:0.0011862559476867318
The modified gen p mean: 0.4478360116481781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026559285819530487, decouple_loss:0.0013828951632604003
Iteration: 3558, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481799006462097, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44890663027763367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026565978303551674, decouple_loss:0.0012959192972630262
loss_pred:0.026369331404566765, decouple_loss:0.0013888855464756489
The modified gen p mean: 0.44897228479385376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026136154308915138, decouple_loss:0.0013414061395451427
Iteration: 3559, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454561471939087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02681385912001133, decouple_loss:0.0013749661156907678
The modified gen p mean: 0.44725391268730164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026270676404237747, decouple_loss:0.0013365538325160742
The modified gen p mean: 0.44864848256111145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026503317058086395, decouple_loss:0.0014100385596975684
Iteration: 3560, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4433262348175049, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028498884290456772, decouple_loss:0.0013513758312910795
The modified gen p mean: 0.44841161370277405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026076074689626694, decouple_loss:0.001302657532505691
The modified gen p mean: 0.4450579881668091, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02741563320159912, decouple_loss:0.0011480390094220638
2023-05-27 05:18:04 testing...
The modified gen p mean: 0.45037543773651123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03243622928857803, decouple_loss:0.0014302015770226717
The modified gen p mean: 0.4489073157310486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032750897109508514, decouple_loss:0.0013637249357998371
The modified gen p mean: 0.4501419961452484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03424825891852379, decouple_loss:0.001511242939159274
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03321688249707222, avg_mse: 0.04542962461709976
current test mse: 0.04543
Iteration: 3561, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454646706581116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027529651299118996, decouple_loss:0.0011816470650956035
The modified gen p mean: 0.45036011934280396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027740642428398132, decouple_loss:0.001297222450375557
The modified gen p mean: 0.44301098585128784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02697211131453514, decouple_loss:0.0011532956268638372
Iteration: 3562, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444637656211853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026898043230175972, decouple_loss:0.0012270952574908733
The modified gen p mean: 0.4482143521308899, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027709174901247025, decouple_loss:0.0013119876384735107
The modified gen p mean: 0.44501668214797974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026969240978360176, decouple_loss:0.0012652338482439518
Iteration: 3563, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485210180282593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027485527098178864, decouple_loss:0.001313957036472857
The modified gen p mean: 0.4447406530380249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027881359681487083, decouple_loss:0.0012468466302379966
The modified gen p mean: 0.4489116072654724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027613624930381775, decouple_loss:0.0013460302725434303
Iteration: 3564, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44944775104522705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02604605071246624, decouple_loss:0.001307025901041925
The modified gen p mean: 0.44836902618408203, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026489542797207832, decouple_loss:0.0013588869478553534
The modified gen p mean: 0.45076805353164673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02663537673652172, decouple_loss:0.001311784260906279
Iteration: 3565, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510873258113861, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026212334632873535, decouple_loss:0.0014360514469444752
The modified gen p mean: 0.4510374367237091, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025852521881461143, decouple_loss:0.0013743445742875338
The modified gen p mean: 0.45150241255760193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02757830172777176, decouple_loss:0.001319159404374659
Iteration: 3566, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44678717851638794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026626918464899063, decouple_loss:0.0011746188392862678
The modified gen p mean: 0.44750410318374634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027116503566503525, decouple_loss:0.0012716292403638363
The modified gen p mean: 0.4501975178718567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026515567675232887, decouple_loss:0.0014455521013587713
Iteration: 3567, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45105260610580444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02808818221092224, decouple_loss:0.0012461349833756685
The modified gen p mean: 0.4505194127559662, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02579234167933464, decouple_loss:0.0014585457975044847
The modified gen p mean: 0.4507405459880829, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027944184839725494, decouple_loss:0.0013338355347514153
Iteration: 3568, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510617256164551, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026097862049937248, decouple_loss:0.0014012276660650969
The modified gen p mean: 0.44751036167144775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027146395295858383, decouple_loss:0.001265010447241366
The modified gen p mean: 0.45016756653785706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024975309148430824, decouple_loss:0.001367387012578547
Iteration: 3569, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489761292934418, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02565133199095726, decouple_loss:0.0012954475823789835
The modified gen p mean: 0.44689300656318665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02731381542980671, decouple_loss:0.001270412583835423
The modified gen p mean: 0.44413650035858154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02822197787463665, decouple_loss:0.0013726995093747973
Iteration: 3570, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44877728819847107, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02536424994468689, decouple_loss:0.0013819047017022967
The modified gen p mean: 0.44655099511146545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028322625905275345, decouple_loss:0.0013537021586671472
The modified gen p mean: 0.44425052404403687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026250077411532402, decouple_loss:0.0012058989377692342
2023-05-27 05:22:10 testing...
The modified gen p mean: 0.44983652234077454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032531868666410446, decouple_loss:0.0014047152362763882
The modified gen p mean: 0.4496012032032013, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03427690640091896, decouple_loss:0.0014883597614243627
The modified gen p mean: 0.448391318321228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03276800364255905, decouple_loss:0.0013398430310189724
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03326281160116196, avg_mse: 0.045414917171001434
current test mse: 0.045415
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr.npz
NaN value num: 0
Iteration: 3571, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446941912174225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02696053683757782, decouple_loss:0.0012430192437022924
The modified gen p mean: 0.44535407423973083, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4452285170555115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027977706864476204, decouple_loss:0.0012874359963461757
loss_pred:0.02585693448781967, decouple_loss:0.0012726185377687216
Iteration: 3572, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463947117328644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027592569589614868, decouple_loss:0.0012670556316152215
The modified gen p mean: 0.44990137219429016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026465360075235367, decouple_loss:0.0012850442435592413
The modified gen p mean: 0.44712820649147034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026954300701618195, decouple_loss:0.001269378699362278
Iteration: 3573, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470936357975006, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44522950053215027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02526968903839588, decouple_loss:0.0012846821919083595
loss_pred:0.025812752544879913, decouple_loss:0.0012646480463445187
The modified gen p mean: 0.44646337628364563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027463162317872047, decouple_loss:0.001454620505683124
Iteration: 3574, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44769608974456787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02705700509250164, decouple_loss:0.0012916784035041928
The modified gen p mean: 0.4500924348831177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02715528942644596, decouple_loss:0.001464432687498629
The modified gen p mean: 0.446205735206604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027218520641326904, decouple_loss:0.0012018278939649463
Iteration: 3575, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479449987411499, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027787283062934875, decouple_loss:0.0012919571017846465
The modified gen p mean: 0.4473603367805481, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027801794931292534, decouple_loss:0.001245393417775631
The modified gen p mean: 0.4490264356136322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02640342153608799, decouple_loss:0.0012812516652047634
Iteration: 3576, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45045706629753113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026552924886345863, decouple_loss:0.0012211520224809647
The modified gen p mean: 0.4514329731464386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02669970691204071, decouple_loss:0.0012623288203030825
The modified gen p mean: 0.4518970847129822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02780219539999962, decouple_loss:0.0014278723392635584
Iteration: 3577, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45134758949279785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025341857224702835, decouple_loss:0.0012510174419730902
The modified gen p mean: 0.4524160325527191, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025158237665891647, decouple_loss:0.0013673824723809958
The modified gen p mean: 0.45340830087661743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025315728038549423, decouple_loss:0.0014024495612829924
Iteration: 3578, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.454818457365036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028030576184391975, decouple_loss:0.0013810698874294758
The modified gen p mean: 0.449057400226593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02883937768638134, decouple_loss:0.0012870794162154198
The modified gen p mean: 0.45058080554008484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027062710374593735, decouple_loss:0.0012950219679623842
Iteration: 3579, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45422157645225525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02689868025481701, decouple_loss:0.001302091870456934
The modified gen p mean: 0.4528907835483551, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02563846856355667, decouple_loss:0.0012407671893015504
The modified gen p mean: 0.4509301781654358, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025342542678117752, decouple_loss:0.001425402588211
Iteration: 3580, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45197662711143494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02613166533410549, decouple_loss:0.0013078316114842892
The modified gen p mean: 0.44772642850875854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027060963213443756, decouple_loss:0.0012037166161462665
The modified gen p mean: 0.452480286359787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027497800067067146, decouple_loss:0.0011940026888623834
2023-05-27 05:26:56 testing...
The modified gen p mean: 0.4521172046661377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03258805349469185, decouple_loss:0.0014063065173104405
The modified gen p mean: 0.4520014226436615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0343400202691555, decouple_loss:0.0014801722718402743
The modified gen p mean: 0.4507555365562439, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03284449502825737, decouple_loss:0.0013573806500062346
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033328257501125336, avg_mse: 0.045600663870573044
current test mse: 0.045601
Iteration: 3581, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473068416118622, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026584357023239136, decouple_loss:0.0014291054103523493
The modified gen p mean: 0.4472181499004364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026642262935638428, decouple_loss:0.0011334811570122838
The modified gen p mean: 0.4477742612361908, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02744341641664505, decouple_loss:0.0012018586276099086
Iteration: 3582, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44598013162612915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026511603966355324, decouple_loss:0.0012957475846633315
The modified gen p mean: 0.44812166690826416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02660692296922207, decouple_loss:0.0012883967719972134
The modified gen p mean: 0.44542306661605835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028807608410716057, decouple_loss:0.0012646985705941916
Iteration: 3583, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441750645637512, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0255421232432127, decouple_loss:0.001215909025631845
The modified gen p mean: 0.4500766694545746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026486344635486603, decouple_loss:0.001307760365307331
The modified gen p mean: 0.4482306241989136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026860319077968597, decouple_loss:0.0013541087973862886
Iteration: 3584, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463498890399933, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026641765609383583, decouple_loss:0.001197171164676547
The modified gen p mean: 0.44499045610427856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02555612102150917, decouple_loss:0.0012249277206137776
The modified gen p mean: 0.4447845220565796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02913849800825119, decouple_loss:0.00130482017993927
Iteration: 3585, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485570192337036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026749907061457634, decouple_loss:0.001258922042325139
The modified gen p mean: 0.44709551334381104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027768868952989578, decouple_loss:0.0013703020522370934
The modified gen p mean: 0.4429888427257538, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028151730075478554, decouple_loss:0.001210746355354786
Iteration: 3586, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515659809112549, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027783317491412163, decouple_loss:0.0013129201252013445
The modified gen p mean: 0.4527803659439087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027413873001933098, decouple_loss:0.001439803745597601
The modified gen p mean: 0.44944605231285095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026511861011385918, decouple_loss:0.0012305084383115172
Iteration: 3587, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498039186000824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027266204357147217, decouple_loss:0.001277303439565003
The modified gen p mean: 0.45299017429351807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02687138132750988, decouple_loss:0.0013519568601623178
The modified gen p mean: 0.4501471519470215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02797362580895424, decouple_loss:0.0013442623894661665
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr.npz
NaN value num: 0
Iteration: 3588, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44810640811920166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02709406055510044, decouple_loss:0.0012194036971777678
The modified gen p mean: 0.44890421628952026, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4477349817752838, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025293467566370964, decouple_loss:0.001402937457896769
loss_pred:0.026544736698269844, decouple_loss:0.0014174033422023058
Iteration: 3589, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44990381598472595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026356957852840424, decouple_loss:0.0014860251685604453
The modified gen p mean: 0.4526531994342804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026868488639593124, decouple_loss:0.0013605672866106033
The modified gen p mean: 0.44720152020454407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027232656255364418, decouple_loss:0.001156279118731618
Iteration: 3590, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45471981167793274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02575892023742199, decouple_loss:0.0013219427783042192
The modified gen p mean: 0.44939807057380676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026308530941605568, decouple_loss:0.0012427758192643523
The modified gen p mean: 0.446919709444046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026764219626784325, decouple_loss:0.0011926916195079684
2023-05-27 05:31:57 testing...
The modified gen p mean: 0.45279863476753235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032525502145290375, decouple_loss:0.0013754706596955657
The modified gen p mean: 0.45136186480522156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283729404211044, decouple_loss:0.0013559150975197554
The modified gen p mean: 0.4526224434375763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03427682816982269, decouple_loss:0.0014719482278451324
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03328326344490051, avg_mse: 0.04557274281978607
current test mse: 0.045573
Iteration: 3591, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4528418481349945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02481367625296116, decouple_loss:0.0012942308094352484
The modified gen p mean: 0.4494631588459015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027031192556023598, decouple_loss:0.0012592822313308716
The modified gen p mean: 0.4499596953392029, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025511499494314194, decouple_loss:0.0012668605195358396
Iteration: 3592, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448698490858078, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026060091331601143, decouple_loss:0.0011841838713735342
The modified gen p mean: 0.4477709233760834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025731967762112617, decouple_loss:0.001321702729910612
The modified gen p mean: 0.4460288882255554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026065194979310036, decouple_loss:0.0014243003679439425
Iteration: 3593, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44656601548194885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02664039097726345, decouple_loss:0.0014049941673874855
The modified gen p mean: 0.4505079984664917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025146085768938065, decouple_loss:0.0012613700237125158
The modified gen p mean: 0.44610875844955444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02522052451968193, decouple_loss:0.0013400291791185737
Iteration: 3594, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4432497024536133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026677580550312996, decouple_loss:0.0011749734403565526
The modified gen p mean: 0.44454488158226013, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027244187891483307, decouple_loss:0.0013590736780315638
The modified gen p mean: 0.4455963671207428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025877663865685463, decouple_loss:0.00140275782905519
Iteration: 3595, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44402605295181274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026168342679739, decouple_loss:0.0012742079561576247
The modified gen p mean: 0.44537898898124695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025947291404008865, decouple_loss:0.0013245879672467709
The modified gen p mean: 0.44780364632606506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024250179529190063, decouple_loss:0.0012717953650280833
Iteration: 3596, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44939708709716797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024756833910942078, decouple_loss:0.0012438611593097448
The modified gen p mean: 0.4431881606578827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02618359588086605, decouple_loss:0.0013551119482144713
The modified gen p mean: 0.4443221688270569, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026918619871139526, decouple_loss:0.0011954348301514983
Iteration: 3597, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471263289451599, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02577611617743969, decouple_loss:0.0013706529280170798
The modified gen p mean: 0.4459238052368164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02507767826318741, decouple_loss:0.0013128076680004597
The modified gen p mean: 0.44566890597343445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025954073294997215, decouple_loss:0.0012501230230554938
Iteration: 3598, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446864128112793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028271228075027466, decouple_loss:0.0012692664749920368
The modified gen p mean: 0.44770288467407227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02595794014632702, decouple_loss:0.0012194321025162935
The modified gen p mean: 0.44420912861824036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026316046714782715, decouple_loss:0.001131144817918539
Iteration: 3599, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467761814594269, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024681193754076958, decouple_loss:0.0012068240903317928
The modified gen p mean: 0.44738203287124634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026142636314034462, decouple_loss:0.001330049242824316
The modified gen p mean: 0.44952958822250366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025450389832258224, decouple_loss:0.0014458431396633387
Iteration: 3600, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44623181223869324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027898844331502914, decouple_loss:0.0012275805929675698
The modified gen p mean: 0.4471389353275299, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026328885927796364, decouple_loss:0.0011996643152087927
The modified gen p mean: 0.4476625919342041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026349151507019997, decouple_loss:0.0012286913115531206
2023-05-27 05:36:04 testing...
The modified gen p mean: 0.4521839916706085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032634537667036057, decouple_loss:0.0014485513092949986
The modified gen p mean: 0.4506666660308838, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45199084281921387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03287244588136673, decouple_loss:0.0013125353725627065
loss_pred:0.03435087949037552, decouple_loss:0.001496196840889752
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033356912434101105, avg_mse: 0.045604679733514786
current test mse: 0.045605
Iteration: 3601, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4525545835494995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024695193395018578, decouple_loss:0.0012894244864583015
The modified gen p mean: 0.44602665305137634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025895243510603905, decouple_loss:0.001174118253402412
The modified gen p mean: 0.4474834203720093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02480716072022915, decouple_loss:0.0012036028783768415
Iteration: 3602, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486338198184967, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02537590079009533, decouple_loss:0.0012607809621840715
The modified gen p mean: 0.45167919993400574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02501026727259159, decouple_loss:0.0013343138853088021
The modified gen p mean: 0.44701290130615234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02591612935066223, decouple_loss:0.0011299519101157784
Iteration: 3603, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44814005494117737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026408320292830467, decouple_loss:0.0013658235548064113
The modified gen p mean: 0.4488109350204468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02582266926765442, decouple_loss:0.0013472605496644974
The modified gen p mean: 0.4527643024921417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02539764530956745, decouple_loss:0.0013467178214341402
Iteration: 3604, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44579190015792847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026866870000958443, decouple_loss:0.0011516412487253547
The modified gen p mean: 0.44834205508232117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02660210430622101, decouple_loss:0.0012287667486816645
The modified gen p mean: 0.4508707821369171, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026227576658129692, decouple_loss:0.0012544197961688042
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr.npz
NaN value num: 0
Iteration: 3605, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474165439605713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03028980642557144, decouple_loss:0.0013035974698141217
The modified gen p mean: 0.4467878043651581, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4494071900844574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029204359278082848, decouple_loss:0.0012189468834549189
loss_pred:0.02951228804886341, decouple_loss:0.0011887650471180677
Iteration: 3606, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488159120082855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0300193689763546, decouple_loss:0.0012886634794995189
The modified gen p mean: 0.4477290213108063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030841242522001266, decouple_loss:0.0011342043289914727
The modified gen p mean: 0.4467814862728119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029958093538880348, decouple_loss:0.0012812871718779206
Iteration: 3607, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502042829990387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028905998915433884, decouple_loss:0.0014206571504473686
The modified gen p mean: 0.447669118642807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027988288551568985, decouple_loss:0.001312742242589593
The modified gen p mean: 0.4488075375556946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030357470735907555, decouple_loss:0.0013735503889620304
Iteration: 3608, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4537085294723511, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02987033687531948, decouple_loss:0.0013545374386012554
The modified gen p mean: 0.44784000515937805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031131243333220482, decouple_loss:0.0012445836327970028
The modified gen p mean: 0.4478035569190979, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029435062780976295, decouple_loss:0.0012008677003905177
Iteration: 3609, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45148321986198425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030447572469711304, decouple_loss:0.0012869879137724638
The modified gen p mean: 0.4503386616706848, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028850017115473747, decouple_loss:0.0012700296938419342
The modified gen p mean: 0.44967666268348694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03159898892045021, decouple_loss:0.0012543222401291132
Iteration: 3610, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45278850197792053, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45346882939338684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028680041432380676, decouple_loss:0.001250727567821741
loss_pred:0.03016028366982937, decouple_loss:0.0012319466331973672
The modified gen p mean: 0.4529293477535248, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02979138307273388, decouple_loss:0.0012862446019425988
2023-05-27 05:40:55 testing...
The modified gen p mean: 0.4561446011066437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032236602157354355, decouple_loss:0.001430503441952169
The modified gen p mean: 0.45463234186172485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032468754798173904, decouple_loss:0.001312379608862102
The modified gen p mean: 0.45588281750679016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03398570045828819, decouple_loss:0.0014474126510322094
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03296685963869095, avg_mse: 0.04481473192572594
current test mse: 0.044815
Iteration: 3611, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45482349395751953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03026304580271244, decouple_loss:0.0012083417968824506
The modified gen p mean: 0.45264869928359985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030413402244448662, decouple_loss:0.0012531272368505597
The modified gen p mean: 0.45196735858917236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030305609107017517, decouple_loss:0.0013214307837188244
Iteration: 3612, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508230686187744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029428662732243538, decouple_loss:0.001187398680485785
The modified gen p mean: 0.45123469829559326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029136674478650093, decouple_loss:0.001287834718823433
The modified gen p mean: 0.45621946454048157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029734287410974503, decouple_loss:0.001272467547096312
Iteration: 3613, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45117807388305664, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4531637132167816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030101163312792778, decouple_loss:0.0010909854900091887
loss_pred:0.029045136645436287, decouple_loss:0.0013104522367939353
The modified gen p mean: 0.4543140232563019, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030577383935451508, decouple_loss:0.0012747119180858135
Iteration: 3614, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4537753164768219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029606955125927925, decouple_loss:0.0012924365000799298
The modified gen p mean: 0.4504811465740204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030414342880249023, decouple_loss:0.0013639670796692371
The modified gen p mean: 0.44924023747444153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028928373008966446, decouple_loss:0.0012810762273147702
Iteration: 3615, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502316117286682, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028512919321656227, decouple_loss:0.001357933389954269
The modified gen p mean: 0.4476088285446167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02923250012099743, decouple_loss:0.0012941173044964671
The modified gen p mean: 0.44593942165374756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028201289474964142, decouple_loss:0.0013036816380918026
Iteration: 3616, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44715359807014465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03133101388812065, decouple_loss:0.001362681039609015
The modified gen p mean: 0.445102721452713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029303399845957756, decouple_loss:0.0012360723922029138
The modified gen p mean: 0.444357305765152, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0291115902364254, decouple_loss:0.0012779530370607972
Iteration: 3617, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4436906576156616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02916141226887703, decouple_loss:0.0012853543739765882
The modified gen p mean: 0.4432871639728546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029223918914794922, decouple_loss:0.001292936853133142
The modified gen p mean: 0.445020854473114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0289109218865633, decouple_loss:0.0013340719742700458
Iteration: 3618, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434962570667267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030807815492153168, decouple_loss:0.0014403925742954016
The modified gen p mean: 0.44306719303131104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03011353686451912, decouple_loss:0.001264789025299251
The modified gen p mean: 0.443326860666275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027875276282429695, decouple_loss:0.0013382922625169158
Iteration: 3619, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44575002789497375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030828699469566345, decouple_loss:0.0013250706251710653
The modified gen p mean: 0.44282886385917664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029526041820645332, decouple_loss:0.0011592485243454576
The modified gen p mean: 0.4449757933616638, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029879501089453697, decouple_loss:0.0012696725316345692
Iteration: 3620, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44746726751327515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031024791300296783, decouple_loss:0.0012112784897908568
The modified gen p mean: 0.44922614097595215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028745554387569427, decouple_loss:0.0012361959088593721
The modified gen p mean: 0.45149967074394226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028863169252872467, decouple_loss:0.001265294966287911
2023-05-27 05:45:01 testing...
The modified gen p mean: 0.4537069797515869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032170370221138, decouple_loss:0.0014891448663547635
The modified gen p mean: 0.45197319984436035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03263470530509949, decouple_loss:0.001377808628603816
The modified gen p mean: 0.4534808397293091, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033962998539209366, decouple_loss:0.0015366008738055825
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03299608454108238, avg_mse: 0.044919293373823166
current test mse: 0.044919
Iteration: 3621, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44989466667175293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030070915818214417, decouple_loss:0.0011922137346118689
The modified gen p mean: 0.44962820410728455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029962098225951195, decouple_loss:0.0013697491958737373
The modified gen p mean: 0.4513053894042969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029469067230820656, decouple_loss:0.0013763901079073548
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr.npz
NaN value num: 0
Iteration: 3622, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45042696595191956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031736865639686584, decouple_loss:0.0012984757777303457
The modified gen p mean: 0.4512195587158203, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029213936999440193, decouple_loss:0.0013806357746943831
The modified gen p mean: 0.4524950683116913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029074465855956078, decouple_loss:0.001300807110965252
Iteration: 3623, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4550166726112366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028534652665257454, decouple_loss:0.0013768321368843317
The modified gen p mean: 0.451790452003479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03180700168013573, decouple_loss:0.0012358446838334203
The modified gen p mean: 0.451713502407074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030582351610064507, decouple_loss:0.001376113505102694
Iteration: 3624, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516061246395111, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4510239064693451, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029497738927602768, decouple_loss:0.0012965628411620855
loss_pred:0.02995477430522442, decouple_loss:0.0012683458626270294
The modified gen p mean: 0.4513337314128876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02942250669002533, decouple_loss:0.001273860689252615
Iteration: 3625, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494209289550781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029450390487909317, decouple_loss:0.0012356294319033623
The modified gen p mean: 0.4508998990058899, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030026018619537354, decouple_loss:0.0012463105376809835
The modified gen p mean: 0.45311328768730164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030459461733698845, decouple_loss:0.0012619744520634413
Iteration: 3626, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475904107093811, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02877138927578926, decouple_loss:0.0012804021826013923
The modified gen p mean: 0.450979083776474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029732294380664825, decouple_loss:0.0012430327478796244
The modified gen p mean: 0.45150628685951233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028552280738949776, decouple_loss:0.0013718993868678808
Iteration: 3627, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45011425018310547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0290591511875391, decouple_loss:0.0013987408019602299
The modified gen p mean: 0.44798171520233154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0298377126455307, decouple_loss:0.0015010011848062277
The modified gen p mean: 0.44504663348197937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030951673164963722, decouple_loss:0.0013171269092708826
Iteration: 3628, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44802871346473694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02825886756181717, decouple_loss:0.0012817526003345847
The modified gen p mean: 0.44791942834854126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029046950861811638, decouple_loss:0.0013561134692281485
The modified gen p mean: 0.44669947028160095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02965356409549713, decouple_loss:0.0013632605550810695
Iteration: 3629, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447490930557251, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028753163293004036, decouple_loss:0.00136233726516366
The modified gen p mean: 0.4453469514846802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030183760449290276, decouple_loss:0.0013526531402021646
The modified gen p mean: 0.4454233646392822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029428556561470032, decouple_loss:0.0013323239982128143
Iteration: 3630, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44934284687042236, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44485411047935486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02938234619796276, decouple_loss:0.0013056782772764564
loss_pred:0.031421612948179245, decouple_loss:0.0012400797568261623
The modified gen p mean: 0.44462695717811584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02985192835330963, decouple_loss:0.0012411284260451794
2023-05-27 05:49:51 testing...
The modified gen p mean: 0.45097076892852783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032103486359119415, decouple_loss:0.0014439915539696813
The modified gen p mean: 0.44933727383613586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253236785531044, decouple_loss:0.001340045128017664
The modified gen p mean: 0.4506601393222809, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03380105271935463, decouple_loss:0.0014674351550638676
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032883163541555405, avg_mse: 0.04469496011734009
current test mse: 0.044695
Iteration: 3631, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472978413105011, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03002922795712948, decouple_loss:0.0012015339452773333
The modified gen p mean: 0.448159396648407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029291775077581406, decouple_loss:0.001302996650338173
The modified gen p mean: 0.44808459281921387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03019089624285698, decouple_loss:0.0012978781014680862
Iteration: 3632, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45036882162094116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03058535046875477, decouple_loss:0.0014373656595125794
The modified gen p mean: 0.44736945629119873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029154479503631592, decouple_loss:0.0014383840607479215
The modified gen p mean: 0.44864168763160706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031240612268447876, decouple_loss:0.001415537903085351
Iteration: 3633, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44958657026290894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030565954744815826, decouple_loss:0.0013817220460623503
The modified gen p mean: 0.44891685247421265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029682250693440437, decouple_loss:0.0011808873387053609
The modified gen p mean: 0.44842976331710815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030384909361600876, decouple_loss:0.0012586392695084214
Iteration: 3634, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478640854358673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031075535342097282, decouple_loss:0.0012171977432444692
The modified gen p mean: 0.44926348328590393, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030865496024489403, decouple_loss:0.0013077957555651665
The modified gen p mean: 0.4519459009170532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02973693609237671, decouple_loss:0.0013273815857246518
Iteration: 3635, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475925862789154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03032514452934265, decouple_loss:0.001227223314344883
The modified gen p mean: 0.45064079761505127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02991626411676407, decouple_loss:0.0013123173266649246
The modified gen p mean: 0.449517160654068, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028505045920610428, decouple_loss:0.001460075145587325
Iteration: 3636, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461748003959656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030078692361712456, decouple_loss:0.0013344422914087772
The modified gen p mean: 0.44712015986442566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030519507825374603, decouple_loss:0.0012413026997819543
The modified gen p mean: 0.45016056299209595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029398785904049873, decouple_loss:0.001374950516037643
Iteration: 3637, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480961561203003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030015645548701286, decouple_loss:0.0014373386511579156
The modified gen p mean: 0.44700005650520325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02961670607328415, decouple_loss:0.0012247583363205194
The modified gen p mean: 0.4470849931240082, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0296406839042902, decouple_loss:0.0013488037511706352
Iteration: 3638, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438929855823517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029621148481965065, decouple_loss:0.001259847660548985
The modified gen p mean: 0.445314884185791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029810495674610138, decouple_loss:0.0012016571126878262
The modified gen p mean: 0.44482454657554626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02949455939233303, decouple_loss:0.0011974594090133905
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr.npz
NaN value num: 0
Iteration: 3639, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447557330131531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02684639021754265, decouple_loss:0.0012778196251019835
The modified gen p mean: 0.4495978355407715, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4458306133747101, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025962410494685173, decouple_loss:0.0014515597140416503
loss_pred:0.026167867705225945, decouple_loss:0.0013720744755119085
Iteration: 3640, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45005694031715393, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02606099285185337, decouple_loss:0.0016229485627263784
The modified gen p mean: 0.4463326334953308, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02568451315164566, decouple_loss:0.0012594645377248526
The modified gen p mean: 0.4474179148674011, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026824291795492172, decouple_loss:0.0013206254225224257
2023-05-27 05:54:41 testing...
The modified gen p mean: 0.4503072500228882, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03239872306585312, decouple_loss:0.0015134450513869524
The modified gen p mean: 0.44859763979911804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03267047181725502, decouple_loss:0.0013909809058532119
The modified gen p mean: 0.45005640387535095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03421364352107048, decouple_loss:0.0015510829398408532
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03316853940486908, avg_mse: 0.04513035714626312
current test mse: 0.04513
Iteration: 3641, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507717788219452, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025220653042197227, decouple_loss:0.001354759675450623
The modified gen p mean: 0.4435432255268097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026462441310286522, decouple_loss:0.001370306359604001
The modified gen p mean: 0.44399309158325195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026764456182718277, decouple_loss:0.0012929742224514484
Iteration: 3642, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44270220398902893, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4436045289039612, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02726496197283268, decouple_loss:0.0012627769028767943
loss_pred:0.02663535065948963, decouple_loss:0.0014487724984064698
The modified gen p mean: 0.4501645863056183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02529912069439888, decouple_loss:0.0016217182856053114
Iteration: 3643, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486430287361145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024625685065984726, decouple_loss:0.0014668793883174658
The modified gen p mean: 0.44438377022743225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025094615295529366, decouple_loss:0.0012359028914943337
The modified gen p mean: 0.44109439849853516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0265760850161314, decouple_loss:0.001240100827999413
Iteration: 3644, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44131729006767273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026396406814455986, decouple_loss:0.0013404455967247486
The modified gen p mean: 0.4483036398887634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024759801104664803, decouple_loss:0.0014636005507782102
The modified gen p mean: 0.44372421503067017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02533767744898796, decouple_loss:0.001257841824553907
Iteration: 3645, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44137582182884216, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44363754987716675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026297925040125847, decouple_loss:0.0012615249725058675
loss_pred:0.02462911047041416, decouple_loss:0.0013030280824750662
The modified gen p mean: 0.4414788484573364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025807807222008705, decouple_loss:0.0012634838931262493
Iteration: 3646, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4435063600540161, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026355745270848274, decouple_loss:0.0012660742504522204
The modified gen p mean: 0.44074568152427673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026920393109321594, decouple_loss:0.0012594033032655716
The modified gen p mean: 0.44695258140563965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02414383739233017, decouple_loss:0.0012214023154228926
Iteration: 3647, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450015425682068, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02477351762354374, decouple_loss:0.0013266062596812844
The modified gen p mean: 0.44394615292549133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027042116969823837, decouple_loss:0.0013224480208009481
The modified gen p mean: 0.4427901804447174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027356166392564774, decouple_loss:0.0012209935812279582
Iteration: 3648, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4433252215385437, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4456520974636078, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026720445603132248, decouple_loss:0.0012504254700616002
loss_pred:0.025527913123369217, decouple_loss:0.0013399750459939241
The modified gen p mean: 0.4444229304790497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02748960070312023, decouple_loss:0.0012242062948644161
Iteration: 3649, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4448336660861969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026706784963607788, decouple_loss:0.001250673783943057
The modified gen p mean: 0.4446844160556793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026088478043675423, decouple_loss:0.0012243211967870593
The modified gen p mean: 0.445118248462677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02425326034426689, decouple_loss:0.001304968143813312
Iteration: 3650, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44753971695899963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02589125744998455, decouple_loss:0.0012799887917935848
The modified gen p mean: 0.44555696845054626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025566166266798973, decouple_loss:0.0012801579432561994
The modified gen p mean: 0.44259098172187805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025861328467726707, decouple_loss:0.0012734244810417295
2023-05-27 05:58:48 testing...
The modified gen p mean: 0.4526544213294983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03260961174964905, decouple_loss:0.0014675194397568703
The modified gen p mean: 0.4508804678916931, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032825812697410583, decouple_loss:0.0013467135140672326
The modified gen p mean: 0.452455997467041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034426845610141754, decouple_loss:0.0014731999253854156
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03335888311266899, avg_mse: 0.04562315717339516
current test mse: 0.045623
Iteration: 3651, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497341811656952, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024361982941627502, decouple_loss:0.0013642115518450737
The modified gen p mean: 0.44778716564178467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026570778340101242, decouple_loss:0.0012758229859173298
The modified gen p mean: 0.45188963413238525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024400800466537476, decouple_loss:0.0014724608045071363
Iteration: 3652, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45330989360809326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02419765666127205, decouple_loss:0.001279451884329319
The modified gen p mean: 0.4459667503833771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026569727808237076, decouple_loss:0.001236925134435296
The modified gen p mean: 0.44986069202423096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025711694732308388, decouple_loss:0.0011598559794947505
Iteration: 3653, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516642093658447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02536044456064701, decouple_loss:0.0013138348003849387
The modified gen p mean: 0.45384159684181213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024491989985108376, decouple_loss:0.0012066513299942017
The modified gen p mean: 0.4479549527168274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02439972385764122, decouple_loss:0.0012702407548204064
Iteration: 3654, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44639405608177185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026675136759877205, decouple_loss:0.001249314402230084
The modified gen p mean: 0.44880297780036926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025877829641103745, decouple_loss:0.0011934167705476284
The modified gen p mean: 0.44821056723594666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026059197261929512, decouple_loss:0.0012309602461755276
Iteration: 3655, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44550827145576477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026013387367129326, decouple_loss:0.0011735273292288184
The modified gen p mean: 0.44581207633018494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025918209925293922, decouple_loss:0.0012066597118973732
The modified gen p mean: 0.449558287858963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024349289014935493, decouple_loss:0.0015043370658531785
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3656, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44787150621414185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026715068146586418, decouple_loss:0.0012136726872995496
The modified gen p mean: 0.4484149217605591, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4489952027797699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02831636369228363, decouple_loss:0.0012542144395411015
loss_pred:0.028590166941285133, decouple_loss:0.0011803244706243277
Iteration: 3657, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44844764471054077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028135456144809723, decouple_loss:0.0012736483477056026
The modified gen p mean: 0.4502464234828949, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026294922456145287, decouple_loss:0.0014079365646466613
The modified gen p mean: 0.4466802179813385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028517331928014755, decouple_loss:0.0012769019231200218
Iteration: 3658, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496525526046753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026925239711999893, decouple_loss:0.0013778875581920147
The modified gen p mean: 0.4541987478733063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026129087433218956, decouple_loss:0.0012001798022538424
The modified gen p mean: 0.44963473081588745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028114352375268936, decouple_loss:0.0011742293136194348
Iteration: 3659, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480755925178528, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028802601620554924, decouple_loss:0.001161110121756792
The modified gen p mean: 0.44875913858413696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027865957468748093, decouple_loss:0.001188569120131433
The modified gen p mean: 0.4528602659702301, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026455478742718697, decouple_loss:0.001226160442456603
Iteration: 3660, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4552497863769531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026217002421617508, decouple_loss:0.001373420236632228
The modified gen p mean: 0.4483438730239868, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027279911562800407, decouple_loss:0.0012636311585083604
The modified gen p mean: 0.45271316170692444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026721563190221786, decouple_loss:0.0013800312299281359
2023-05-27 06:03:29 testing...
The modified gen p mean: 0.454667329788208, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03249397873878479, decouple_loss:0.0014537123497575521
The modified gen p mean: 0.4528467059135437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03275648504495621, decouple_loss:0.0013640630058944225
The modified gen p mean: 0.45434969663619995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03434514254331589, decouple_loss:0.001520987250842154
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03327084705233574, avg_mse: 0.045375239104032516
current test mse: 0.045375
Iteration: 3661, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501802921295166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0268521998077631, decouple_loss:0.0012920856242999434
The modified gen p mean: 0.449855774641037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027572309598326683, decouple_loss:0.001328956801444292
The modified gen p mean: 0.4509055018424988, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028717651963233948, decouple_loss:0.0011920453980565071
Iteration: 3662, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44885486364364624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028613192960619926, decouple_loss:0.0013285072054713964
The modified gen p mean: 0.4494258165359497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02738349325954914, decouple_loss:0.0013314572861418128
The modified gen p mean: 0.4545808434486389, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025707995519042015, decouple_loss:0.0013446792727336287
Iteration: 3663, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45113304257392883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026982329785823822, decouple_loss:0.001305040786974132
The modified gen p mean: 0.4489225447177887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028214482590556145, decouple_loss:0.0013077640905976295
The modified gen p mean: 0.4490628242492676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0265643410384655, decouple_loss:0.0013429985847324133
Iteration: 3664, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44504597783088684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027032174170017242, decouple_loss:0.00116287125274539
The modified gen p mean: 0.4446074962615967, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028243552893400192, decouple_loss:0.0012427736073732376
The modified gen p mean: 0.44861260056495667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026918994262814522, decouple_loss:0.0013815489364787936
Iteration: 3665, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44976136088371277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0260296780616045, decouple_loss:0.0011719263857230544
The modified gen p mean: 0.4456724524497986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027246778830885887, decouple_loss:0.0012601781636476517
The modified gen p mean: 0.44629061222076416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02716471441090107, decouple_loss:0.0013307032641023397
Iteration: 3666, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44808703660964966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026531560346484184, decouple_loss:0.0014226142084226012
The modified gen p mean: 0.445294588804245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0281461663544178, decouple_loss:0.0013397129951044917
The modified gen p mean: 0.4489070475101471, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027148615568876266, decouple_loss:0.0014109405456110835
Iteration: 3667, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44497817754745483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028003154322504997, decouple_loss:0.001568370033055544
The modified gen p mean: 0.44611650705337524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026696262881159782, decouple_loss:0.0013091296423226595
The modified gen p mean: 0.44968488812446594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027216807007789612, decouple_loss:0.0013547850539907813
Iteration: 3668, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487779438495636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027700776234269142, decouple_loss:0.0012648170813918114
The modified gen p mean: 0.44428402185440063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02702905796468258, decouple_loss:0.0014286994701251388
The modified gen p mean: 0.4494064450263977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02689463645219803, decouple_loss:0.001297194859944284
Iteration: 3669, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450386643409729, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027370961382985115, decouple_loss:0.0013633215567097068
The modified gen p mean: 0.4457647204399109, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028366005048155785, decouple_loss:0.0012467124033719301
The modified gen p mean: 0.45276695489883423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026368962600827217, decouple_loss:0.001356934430077672
Iteration: 3670, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477408826351166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028235193341970444, decouple_loss:0.0014166533946990967
The modified gen p mean: 0.44963565468788147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02700219303369522, decouple_loss:0.0012707628775388002
The modified gen p mean: 0.4488886594772339, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027291936799883842, decouple_loss:0.0013775700936093926
2023-05-27 06:07:35 testing...
The modified gen p mean: 0.4531002342700958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032740235328674316, decouple_loss:0.0016054041916504502
The modified gen p mean: 0.45272698998451233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03455740213394165, decouple_loss:0.0016464993823319674
The modified gen p mean: 0.4512441158294678, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03304978832602501, decouple_loss:0.0014084434369578958
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033526815474033356, avg_mse: 0.04578876122832298
current test mse: 0.045789
Iteration: 3671, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481697678565979, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027144478633999825, decouple_loss:0.001435164362192154
The modified gen p mean: 0.44757774472236633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027541060000658035, decouple_loss:0.0012502737808972597
The modified gen p mean: 0.4481390416622162, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026227032765746117, decouple_loss:0.0013058260083198547
Iteration: 3672, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4524499177932739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02703801915049553, decouple_loss:0.00129396328702569
The modified gen p mean: 0.4515382945537567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026854857802391052, decouple_loss:0.0016006204532459378
The modified gen p mean: 0.4464510381221771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027399087324738503, decouple_loss:0.001513503841124475
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3673, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455815553665161, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028805119916796684, decouple_loss:0.0012940617743879557
The modified gen p mean: 0.4504702389240265, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44973519444465637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028852997347712517, decouple_loss:0.0013824524357914925
loss_pred:0.02726816013455391, decouple_loss:0.0013869813410565257
Iteration: 3674, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44497498869895935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02942480519413948, decouple_loss:0.0012004044838249683
The modified gen p mean: 0.4476945102214813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028207559138536453, decouple_loss:0.0013522848021239042
The modified gen p mean: 0.448322594165802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02841368317604065, decouple_loss:0.001315007102675736
Iteration: 3675, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45161524415016174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028675243258476257, decouple_loss:0.00139770214445889
The modified gen p mean: 0.4457145631313324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030361272394657135, decouple_loss:0.0012644557282328606
The modified gen p mean: 0.4474948048591614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02864011749625206, decouple_loss:0.00140855903737247
Iteration: 3676, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460829794406891, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030098360031843185, decouple_loss:0.00125331268645823
The modified gen p mean: 0.4505710005760193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027776749804615974, decouple_loss:0.001283313729800284
The modified gen p mean: 0.45008501410484314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029047874733805656, decouple_loss:0.0013046285603195429
Iteration: 3677, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45022052526474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02818460389971733, decouple_loss:0.0013436534209176898
The modified gen p mean: 0.4503655731678009, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02781120501458645, decouple_loss:0.0013772029196843505
The modified gen p mean: 0.44919732213020325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028292981907725334, decouple_loss:0.0013102054363116622
Iteration: 3678, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44876623153686523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029546329751610756, decouple_loss:0.0013290810165926814
The modified gen p mean: 0.4512676000595093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027609849348664284, decouple_loss:0.001255003153346479
The modified gen p mean: 0.4513876140117645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028310075402259827, decouple_loss:0.0014028691221028566
Iteration: 3679, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4563177525997162, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02787480130791664, decouple_loss:0.0014135997043922544
The modified gen p mean: 0.4509676992893219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028565235435962677, decouple_loss:0.0012703200336545706
The modified gen p mean: 0.4482406675815582, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029377665370702744, decouple_loss:0.0012716150376945734
Iteration: 3680, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44869956374168396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028769278898835182, decouple_loss:0.0013126775156706572
The modified gen p mean: 0.4527130126953125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029613452032208443, decouple_loss:0.0013733357191085815
The modified gen p mean: 0.4498286843299866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029551370069384575, decouple_loss:0.0011994033120572567
2023-05-27 06:12:21 testing...
The modified gen p mean: 0.4544075131416321, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032457366585731506, decouple_loss:0.001489427057094872
The modified gen p mean: 0.4526420831680298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032821644097566605, decouple_loss:0.0013920544879510999
The modified gen p mean: 0.45382699370384216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03424902632832527, decouple_loss:0.0015638951444998384
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0332501046359539, avg_mse: 0.04525243863463402
current test mse: 0.045252
Iteration: 3681, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44721782207489014, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029846269637346268, decouple_loss:0.0012550529791042209
The modified gen p mean: 0.45398539304733276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027590828016400337, decouple_loss:0.0013380867894738913
The modified gen p mean: 0.44963493943214417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028612298890948296, decouple_loss:0.0012619736371561885
Iteration: 3682, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44836145639419556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028380919247865677, decouple_loss:0.0013933355221524835
The modified gen p mean: 0.4492698609828949, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028978699818253517, decouple_loss:0.0012481672456488013
The modified gen p mean: 0.4477093815803528, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027768917381763458, decouple_loss:0.0014037804212421179
Iteration: 3683, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44516614079475403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027321625500917435, decouple_loss:0.0013011452974751592
The modified gen p mean: 0.4505530893802643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027226220816373825, decouple_loss:0.0013069601263850927
The modified gen p mean: 0.44991713762283325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02790355496108532, decouple_loss:0.0014955804217606783
Iteration: 3684, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44407978653907776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02951163239777088, decouple_loss:0.0013587512075901031
The modified gen p mean: 0.445151150226593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028905991464853287, decouple_loss:0.001291728811338544
The modified gen p mean: 0.44731441140174866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027648592367768288, decouple_loss:0.0013571814633905888
Iteration: 3685, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44673246145248413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028624074533581734, decouple_loss:0.001364359981380403
The modified gen p mean: 0.44362857937812805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028775585815310478, decouple_loss:0.0013469443656504154
The modified gen p mean: 0.44986143708229065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027252601459622383, decouple_loss:0.0013760902220383286
Iteration: 3686, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44535958766937256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028859060257673264, decouple_loss:0.0013496280880644917
The modified gen p mean: 0.45008644461631775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028682095929980278, decouple_loss:0.0013936030445620418
The modified gen p mean: 0.4461457133293152, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02760929986834526, decouple_loss:0.001503699109889567
Iteration: 3687, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44411489367485046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028627654537558556, decouple_loss:0.001282145851291716
The modified gen p mean: 0.4448334872722626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029513083398342133, decouple_loss:0.0014466691063717008
The modified gen p mean: 0.4477330446243286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027303533628582954, decouple_loss:0.001335871871560812
Iteration: 3688, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463180601596832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02862880565226078, decouple_loss:0.0012355489889159799
The modified gen p mean: 0.4457748830318451, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02855738066136837, decouple_loss:0.0013840433675795794
The modified gen p mean: 0.44888004660606384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027020582929253578, decouple_loss:0.0012215017341077328
Iteration: 3689, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446061372756958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027812883257865906, decouple_loss:0.0012754708295688033
The modified gen p mean: 0.4481699466705322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028072578832507133, decouple_loss:0.0013937025796622038
The modified gen p mean: 0.45033612847328186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02758787013590336, decouple_loss:0.0012897528940811753
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3690, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471566379070282, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030740443617105484, decouple_loss:0.0012008151970803738
The modified gen p mean: 0.44765782356262207, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45091381669044495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03041384369134903, decouple_loss:0.0013751797378063202
loss_pred:0.028713740408420563, decouple_loss:0.0015323597472161055
2023-05-27 06:17:04 testing...
The modified gen p mean: 0.455639511346817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03258190304040909, decouple_loss:0.0014740580227226019
The modified gen p mean: 0.45363351702690125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0328037329018116, decouple_loss:0.0014130923664197326
The modified gen p mean: 0.4549432396888733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034266166388988495, decouple_loss:0.0015427956823259592
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03329110145568848, avg_mse: 0.04533745348453522
current test mse: 0.045337
Iteration: 3691, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44889912009239197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029783928766846657, decouple_loss:0.0013783389003947377
The modified gen p mean: 0.4505501985549927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03021770343184471, decouple_loss:0.0014057493535801768
The modified gen p mean: 0.45489442348480225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030807573348283768, decouple_loss:0.0013379037845879793
Iteration: 3692, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503624439239502, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03021109662950039, decouple_loss:0.001373054226860404
The modified gen p mean: 0.4568949043750763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029349738731980324, decouple_loss:0.0013649127213284373
The modified gen p mean: 0.452142596244812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029983563348650932, decouple_loss:0.0015260381624102592
Iteration: 3693, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4531089961528778, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029874183237552643, decouple_loss:0.0013758862623944879
The modified gen p mean: 0.45093104243278503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029311567544937134, decouple_loss:0.0013598876539617777
The modified gen p mean: 0.45206013321876526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028815312311053276, decouple_loss:0.001345871714875102
Iteration: 3694, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512448012828827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030375322327017784, decouple_loss:0.0013061431236565113
The modified gen p mean: 0.45077642798423767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03007911890745163, decouple_loss:0.0012946841306984425
The modified gen p mean: 0.4478309452533722, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029062941670417786, decouple_loss:0.0012634610757231712
Iteration: 3695, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45221441984176636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029192347079515457, decouple_loss:0.0013661682605743408
The modified gen p mean: 0.4508351683616638, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028207305818796158, decouple_loss:0.0012682992964982986
The modified gen p mean: 0.4531235992908478, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02953973039984703, decouple_loss:0.0013229583855718374
Iteration: 3696, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503551721572876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02792622148990631, decouple_loss:0.0013189743040129542
The modified gen p mean: 0.4472636878490448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028609756380319595, decouple_loss:0.0013347202911973
The modified gen p mean: 0.4483344554901123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02968333289027214, decouple_loss:0.0012590906117111444
Iteration: 3697, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4436110258102417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028682976961135864, decouple_loss:0.001287398161366582
The modified gen p mean: 0.44754400849342346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02767723612487316, decouple_loss:0.0013538470957428217
The modified gen p mean: 0.44635456800460815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02936980314552784, decouple_loss:0.0012337180087342858
Iteration: 3698, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44691696763038635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02891228348016739, decouple_loss:0.0013360356679186225
The modified gen p mean: 0.44550666213035583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02769024297595024, decouple_loss:0.0013825885253027081
The modified gen p mean: 0.44249704480171204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030211549252271652, decouple_loss:0.001204140018671751
Iteration: 3699, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480966031551361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028488725423812866, decouple_loss:0.0013932628789916635
The modified gen p mean: 0.4467169940471649, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02829519845545292, decouple_loss:0.0012318561784923077
The modified gen p mean: 0.4450477659702301, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02992647886276245, decouple_loss:0.0012687086127698421
Iteration: 3700, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44613412022590637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028438732028007507, decouple_loss:0.0013386901700869203
The modified gen p mean: 0.4433739483356476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029730377718806267, decouple_loss:0.001344459829851985
The modified gen p mean: 0.4494068920612335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028766311705112457, decouple_loss:0.0014925958821550012
2023-05-27 06:21:09 testing...
The modified gen p mean: 0.45278289914131165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03237099573016167, decouple_loss:0.0015612671850249171
The modified gen p mean: 0.4508763551712036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254323825240135, decouple_loss:0.0014387174742296338
The modified gen p mean: 0.45196595788002014, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03400297835469246, decouple_loss:0.0015490902587771416
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033048223704099655, avg_mse: 0.044872429221868515
current test mse: 0.044872
Iteration: 3701, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499211311340332, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02847369946539402, decouple_loss:0.0014585187891498208
The modified gen p mean: 0.45010748505592346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029475055634975433, decouple_loss:0.0013613097835332155
The modified gen p mean: 0.44681060314178467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029440637677907944, decouple_loss:0.001281852019019425
Iteration: 3702, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503518044948578, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029959451407194138, decouple_loss:0.001326287048868835
The modified gen p mean: 0.4464135468006134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030399847775697708, decouple_loss:0.0013191013131290674
The modified gen p mean: 0.45160022377967834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0295453742146492, decouple_loss:0.0014511782210320234
Iteration: 3703, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44854727387428284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029878001660108566, decouple_loss:0.0013754330575466156
The modified gen p mean: 0.44989335536956787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02965746633708477, decouple_loss:0.0012425172608345747
The modified gen p mean: 0.4531033933162689, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028802920132875443, decouple_loss:0.0012588370591402054
Iteration: 3704, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496171176433563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031012456864118576, decouple_loss:0.0012208260595798492
The modified gen p mean: 0.4513481855392456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029244137927889824, decouple_loss:0.0013132707681506872
The modified gen p mean: 0.4538683295249939, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02982250601053238, decouple_loss:0.0013991964515298605
Iteration: 3705, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45157960057258606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03049471601843834, decouple_loss:0.0012757728109136224
The modified gen p mean: 0.454829603433609, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028401631861925125, decouple_loss:0.001372658647596836
The modified gen p mean: 0.4485182464122772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029977252706885338, decouple_loss:0.0013812874676659703
Iteration: 3706, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44894659519195557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030169110745191574, decouple_loss:0.0013526480179280043
The modified gen p mean: 0.452214777469635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027585241943597794, decouple_loss:0.001472007017582655
The modified gen p mean: 0.4484674334526062, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0309139434248209, decouple_loss:0.0012761350953951478
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr.npz
NaN value num: 0
Iteration: 3707, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448026567697525, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4481348693370819, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027130302041769028, decouple_loss:0.0012274145847186446
The modified gen p mean: 0.4535982012748718, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0284794420003891, decouple_loss:0.0012306591961532831
loss_pred:0.025086751207709312, decouple_loss:0.0012768319575116038
Iteration: 3708, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487248361110687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0253617987036705, decouple_loss:0.0012783119454979897
The modified gen p mean: 0.4486519694328308, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02803366258740425, decouple_loss:0.0012215996393933892
The modified gen p mean: 0.44858163595199585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02571835368871689, decouple_loss:0.0013443882344290614
Iteration: 3709, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4437139332294464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027360904961824417, decouple_loss:0.0012683512177318335
The modified gen p mean: 0.4443838894367218, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026663007214665413, decouple_loss:0.0011737230233848095
The modified gen p mean: 0.4486808478832245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026583503931760788, decouple_loss:0.0012969013769179583
Iteration: 3710, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44410184025764465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025295676663517952, decouple_loss:0.0014923802809789777
The modified gen p mean: 0.44168755412101746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026583125814795494, decouple_loss:0.0011217560386285186
The modified gen p mean: 0.442691832780838, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02891673520207405, decouple_loss:0.0012694133911281824
2023-05-27 06:25:51 testing...
The modified gen p mean: 0.4478233754634857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0323873907327652, decouple_loss:0.001491560717113316
The modified gen p mean: 0.44596272706985474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03273524343967438, decouple_loss:0.0015482405433431268
The modified gen p mean: 0.44710907340049744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03398849815130234, decouple_loss:0.0015340365935117006
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033113278448581696, avg_mse: 0.0450236052274704
current test mse: 0.045024
Iteration: 3711, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44316190481185913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025880731642246246, decouple_loss:0.0012801361735910177
The modified gen p mean: 0.44353610277175903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027298593893647194, decouple_loss:0.00130472204182297
The modified gen p mean: 0.44542890787124634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026263194158673286, decouple_loss:0.0015280124498531222
Iteration: 3712, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44496750831604004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02644485794007778, decouple_loss:0.001239180564880371
The modified gen p mean: 0.44036370515823364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02858925610780716, decouple_loss:0.0014045119751244783
The modified gen p mean: 0.44482824206352234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026284851133823395, decouple_loss:0.0014528949977830052
Iteration: 3713, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4405888319015503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027702080085873604, decouple_loss:0.0013294024392962456
The modified gen p mean: 0.443862646818161, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025134310126304626, decouple_loss:0.0011871734168380499
The modified gen p mean: 0.4454006552696228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025763031095266342, decouple_loss:0.0013906591339036822
Iteration: 3714, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44532135128974915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02530737780034542, decouple_loss:0.0011755148880183697
The modified gen p mean: 0.4459652304649353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026791730895638466, decouple_loss:0.0013936451869085431
The modified gen p mean: 0.44688934087753296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024895992130041122, decouple_loss:0.0014308622339740396
Iteration: 3715, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466654658317566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025389567017555237, decouple_loss:0.0012583737261593342
The modified gen p mean: 0.44449150562286377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02894432842731476, decouple_loss:0.0013346796622499824
The modified gen p mean: 0.44827866554260254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026896623894572258, decouple_loss:0.0013102691154927015
Iteration: 3716, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445410817861557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026416392996907234, decouple_loss:0.0012468787608668208
The modified gen p mean: 0.4463273584842682, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026440821588039398, decouple_loss:0.00115427584387362
The modified gen p mean: 0.44992396235466003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025773826986551285, decouple_loss:0.0012120096944272518
Iteration: 3717, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44743508100509644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028186941519379616, decouple_loss:0.0012189737753942609
The modified gen p mean: 0.45156633853912354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02615341544151306, decouple_loss:0.0013254375662654638
The modified gen p mean: 0.4489278793334961, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028326915577054024, decouple_loss:0.0013344851322472095
Iteration: 3718, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4530634582042694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02738136053085327, decouple_loss:0.0012328943703323603
The modified gen p mean: 0.45276927947998047, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025285087525844574, decouple_loss:0.001460644300095737
The modified gen p mean: 0.453220933675766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025023920461535454, decouple_loss:0.0014570200582966208
Iteration: 3719, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45477744936943054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025169705972075462, decouple_loss:0.0014161980943754315
The modified gen p mean: 0.45089197158813477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025172848254442215, decouple_loss:0.0012840309645980597
The modified gen p mean: 0.45054617524147034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732968144118786, decouple_loss:0.0012886651093140244
Iteration: 3720, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45109960436820984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026680009439587593, decouple_loss:0.0012714677723124623
The modified gen p mean: 0.4537919759750366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02769167348742485, decouple_loss:0.0012082122266292572
The modified gen p mean: 0.4514230489730835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026602299883961678, decouple_loss:0.0013494095765054226
2023-05-27 06:29:58 testing...
The modified gen p mean: 0.45592963695526123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032505568116903305, decouple_loss:0.0014799602795392275
The modified gen p mean: 0.45398828387260437, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45543697476387024, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032673176378011703, decouple_loss:0.0014749456895515323
loss_pred:0.03410196676850319, decouple_loss:0.0014637986896559596
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033167220652103424, avg_mse: 0.04531014338135719
current test mse: 0.04531
Iteration: 3721, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507654905319214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02731749787926674, decouple_loss:0.0012458177516236901
The modified gen p mean: 0.4525120258331299, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025310110300779343, decouple_loss:0.0012274427572265267
The modified gen p mean: 0.44959521293640137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02654329314827919, decouple_loss:0.001261057099327445
Iteration: 3722, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44879645109176636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025630155578255653, decouple_loss:0.00133561622351408
The modified gen p mean: 0.4493255913257599, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024752222001552582, decouple_loss:0.0011894195340573788
The modified gen p mean: 0.4509752690792084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026463551446795464, decouple_loss:0.0012246185215190053
Iteration: 3723, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44575998187065125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02793501690030098, decouple_loss:0.0012265931582078338
The modified gen p mean: 0.4480138421058655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026102133095264435, decouple_loss:0.0013164053671061993
The modified gen p mean: 0.4459821283817291, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025872698053717613, decouple_loss:0.0011266476940363646
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3724, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44243061542510986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028918389230966568, decouple_loss:0.001116001047194004
The modified gen p mean: 0.446954607963562, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4456327259540558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027562571689486504, decouple_loss:0.0011930145556107163
loss_pred:0.027348017320036888, decouple_loss:0.0011771454010158777
Iteration: 3725, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516381323337555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028448794037103653, decouple_loss:0.0012864676536992192
The modified gen p mean: 0.4431644678115845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027731213718652725, decouple_loss:0.001351790502667427
The modified gen p mean: 0.44467994570732117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028071757405996323, decouple_loss:0.0013646571896970272
Iteration: 3726, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44502440094947815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028038598597049713, decouple_loss:0.0013863405911251903
The modified gen p mean: 0.44696974754333496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025911765173077583, decouple_loss:0.0012289041187614202
The modified gen p mean: 0.4481782913208008, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02629048004746437, decouple_loss:0.0011708963429555297
Iteration: 3727, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508592188358307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028461899608373642, decouple_loss:0.0012007170589640737
The modified gen p mean: 0.44576141238212585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029288090765476227, decouple_loss:0.0012148043606430292
The modified gen p mean: 0.44530561566352844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027977488934993744, decouple_loss:0.001251519308425486
Iteration: 3728, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44798412919044495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027572283521294594, decouple_loss:0.001102255075238645
The modified gen p mean: 0.4498272240161896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02839081361889839, decouple_loss:0.0013495583552867174
The modified gen p mean: 0.4499416947364807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02571619674563408, decouple_loss:0.001327473553828895
Iteration: 3729, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45274674892425537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026468714699149132, decouple_loss:0.0013814795529469848
The modified gen p mean: 0.4487076997756958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027036627754569054, decouple_loss:0.001108660944737494
The modified gen p mean: 0.45298081636428833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027204932644963264, decouple_loss:0.001246643136255443
Iteration: 3730, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4545612931251526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02709275670349598, decouple_loss:0.001337718334980309
The modified gen p mean: 0.45587679743766785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027134861797094345, decouple_loss:0.0012703908141702414
The modified gen p mean: 0.45106199383735657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026514925062656403, decouple_loss:0.0013238536193966866
2023-05-27 06:35:09 testing...
The modified gen p mean: 0.45540592074394226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03276761621236801, decouple_loss:0.0015717281494289637
The modified gen p mean: 0.4533548653125763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03294014930725098, decouple_loss:0.001532839611172676
The modified gen p mean: 0.45501595735549927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03448580577969551, decouple_loss:0.0015074637485668063
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03347472473978996, avg_mse: 0.0457414835691452
current test mse: 0.045741
Iteration: 3731, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44828522205352783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027962034568190575, decouple_loss:0.0013719531707465649
The modified gen p mean: 0.4543810486793518, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027625029906630516, decouple_loss:0.0012003863230347633
The modified gen p mean: 0.4539901614189148, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027223749086260796, decouple_loss:0.0012576712761074305
Iteration: 3732, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45309755206108093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027350157499313354, decouple_loss:0.0014024412957951427
The modified gen p mean: 0.44882041215896606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026594026014208794, decouple_loss:0.0012341220863163471
The modified gen p mean: 0.45106780529022217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028001651167869568, decouple_loss:0.00125229568220675
Iteration: 3733, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486027657985687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02631705440580845, decouple_loss:0.001346181845292449
The modified gen p mean: 0.4473971128463745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029008757323026657, decouple_loss:0.0012988359667360783
The modified gen p mean: 0.4531562626361847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026454422622919083, decouple_loss:0.0012429062044247985
Iteration: 3734, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480826258659363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027025364339351654, decouple_loss:0.0012038106797263026
The modified gen p mean: 0.4476245641708374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026081860065460205, decouple_loss:0.001264676102437079
The modified gen p mean: 0.44779130816459656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025708850473165512, decouple_loss:0.0013595853233709931
Iteration: 3735, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459604024887085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027189280837774277, decouple_loss:0.0012893668608739972
The modified gen p mean: 0.44902917742729187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027102939784526825, decouple_loss:0.0013368589570745826
The modified gen p mean: 0.4471137225627899, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0281804371625185, decouple_loss:0.0015081042656674981
Iteration: 3736, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434453845024109, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028049413114786148, decouple_loss:0.0013231985503807664
The modified gen p mean: 0.44808781147003174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02810971438884735, decouple_loss:0.0014577675610780716
The modified gen p mean: 0.44831642508506775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027251174673438072, decouple_loss:0.0013580024242401123
Iteration: 3737, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480011761188507, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027160748839378357, decouple_loss:0.0013327267952263355
The modified gen p mean: 0.44386348128318787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027322718873620033, decouple_loss:0.0012930358061566949
The modified gen p mean: 0.4436432719230652, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029382536187767982, decouple_loss:0.0012725690612569451
Iteration: 3738, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494389593601227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02815968729555607, decouple_loss:0.0013003790518268943
The modified gen p mean: 0.44487154483795166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025672942399978638, decouple_loss:0.0012631998397409916
The modified gen p mean: 0.44383901357650757, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027383137494325638, decouple_loss:0.001386697986163199
Iteration: 3739, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44543763995170593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026990177109837532, decouple_loss:0.0013356307754293084
The modified gen p mean: 0.45122623443603516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027135558426380157, decouple_loss:0.0013763917377218604
The modified gen p mean: 0.4504256546497345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026609016582369804, decouple_loss:0.0012585533550009131
Iteration: 3740, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461617171764374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02789234183728695, decouple_loss:0.0013723747106269002
The modified gen p mean: 0.4454496502876282, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02695237658917904, decouple_loss:0.001287862891331315
The modified gen p mean: 0.4486972987651825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025486471131443977, decouple_loss:0.00135654560290277
2023-05-27 06:39:14 testing...
The modified gen p mean: 0.45232099294662476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03313163295388222, decouple_loss:0.0015414635417982936
The modified gen p mean: 0.451870322227478, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0348198302090168, decouple_loss:0.0014849111903458834
The modified gen p mean: 0.45032837986946106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03328210487961769, decouple_loss:0.0015424485318362713
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03382067009806633, avg_mse: 0.046271923929452896
current test mse: 0.046272
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr.npz
NaN value num: 0
Iteration: 3741, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4525969922542572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0251898393034935, decouple_loss:0.0014510647160932422
The modified gen p mean: 0.44480010867118835, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44968271255493164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02618817798793316, decouple_loss:0.0013291011564433575
loss_pred:0.027889935299754143, decouple_loss:0.0013764699688181281
Iteration: 3742, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471832811832428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027108628302812576, decouple_loss:0.0012361012632027268
The modified gen p mean: 0.4485709071159363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025682585313916206, decouple_loss:0.001434606732800603
The modified gen p mean: 0.448534220457077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026947351172566414, decouple_loss:0.0014050042955204844
Iteration: 3743, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44888848066329956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026485644280910492, decouple_loss:0.001342369127087295
The modified gen p mean: 0.4491991400718689, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025819947943091393, decouple_loss:0.0014116005040705204
The modified gen p mean: 0.44942429661750793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027587560936808586, decouple_loss:0.0013207567390054464
Iteration: 3744, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4553726613521576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025587208569049835, decouple_loss:0.0013410269748419523
The modified gen p mean: 0.4508739411830902, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027100475504994392, decouple_loss:0.0012972018448635936
The modified gen p mean: 0.44841814041137695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026199746876955032, decouple_loss:0.0012058926513418555
Iteration: 3745, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490363895893097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02773345820605755, decouple_loss:0.001337507856078446
The modified gen p mean: 0.450405091047287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027354249730706215, decouple_loss:0.0013907275861129165
The modified gen p mean: 0.45115888118743896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027042286470532417, decouple_loss:0.0014327882090583444
Iteration: 3746, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45272982120513916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026035459712147713, decouple_loss:0.0013551083393394947
The modified gen p mean: 0.4495945870876312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02724876068532467, decouple_loss:0.001234286930412054
The modified gen p mean: 0.4553588628768921, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025729838758707047, decouple_loss:0.0013414580607786775
Iteration: 3747, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4522525370121002, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026022236794233322, decouple_loss:0.0013713070657104254
The modified gen p mean: 0.45022687315940857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02571299858391285, decouple_loss:0.0012705848785117269
The modified gen p mean: 0.45103898644447327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026786549016833305, decouple_loss:0.001335949171334505
Iteration: 3748, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516259729862213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026350121945142746, decouple_loss:0.001172316842712462
The modified gen p mean: 0.4487638771533966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026569591835141182, decouple_loss:0.0012432232033461332
The modified gen p mean: 0.4480881690979004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02774062380194664, decouple_loss:0.001278928481042385
Iteration: 3749, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44891980290412903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025970149785280228, decouple_loss:0.0014242181787267327
The modified gen p mean: 0.4503425061702728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02575703337788582, decouple_loss:0.0013725145254284143
The modified gen p mean: 0.45291805267333984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024686357006430626, decouple_loss:0.0012497687712311745
Iteration: 3750, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445976197719574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026511358097195625, decouple_loss:0.00126571673899889
The modified gen p mean: 0.4464859664440155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026628093793988228, decouple_loss:0.0012095842976123095
The modified gen p mean: 0.4500775635242462, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025392180308699608, decouple_loss:0.0012345828581601381
2023-05-27 06:44:00 testing...
The modified gen p mean: 0.4511556029319763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032669972628355026, decouple_loss:0.001451442250981927
The modified gen p mean: 0.44920310378074646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03286506608128548, decouple_loss:0.001453242963179946
The modified gen p mean: 0.4507075846195221, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034323662519454956, decouple_loss:0.00144179945345968
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033358678221702576, avg_mse: 0.045615170150995255
current test mse: 0.045615
Iteration: 3751, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497089087963104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024897271767258644, decouple_loss:0.001198506448417902
The modified gen p mean: 0.44355154037475586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026297004893422127, decouple_loss:0.0011835378827527165
The modified gen p mean: 0.4490741193294525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025942398235201836, decouple_loss:0.0013944145757704973
Iteration: 3752, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4435413181781769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027829833328723907, decouple_loss:0.0012024338357150555
The modified gen p mean: 0.44583985209465027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025617962703108788, decouple_loss:0.0011635944247245789
The modified gen p mean: 0.44504034519195557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027403580024838448, decouple_loss:0.00124864571262151
Iteration: 3753, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44517818093299866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026366179808974266, decouple_loss:0.0012534265406429768
The modified gen p mean: 0.44540801644325256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026768794283270836, decouple_loss:0.0012392762582749128
The modified gen p mean: 0.44864070415496826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02614925429224968, decouple_loss:0.0011651314562186599
Iteration: 3754, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44550707936286926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026274066418409348, decouple_loss:0.0012638660846278071
The modified gen p mean: 0.445294588804245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026766842231154442, decouple_loss:0.001164718298241496
The modified gen p mean: 0.4495528042316437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02517448179423809, decouple_loss:0.001270368928089738
Iteration: 3755, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44844722747802734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026017840951681137, decouple_loss:0.001266564941033721
The modified gen p mean: 0.4500614404678345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025786317884922028, decouple_loss:0.0012449026107788086
The modified gen p mean: 0.4528464376926422, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02592398039996624, decouple_loss:0.0011678406735882163
Iteration: 3756, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44979479908943176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026860114187002182, decouple_loss:0.0011994362575933337
The modified gen p mean: 0.4509263336658478, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02638791874051094, decouple_loss:0.0011523121502250433
The modified gen p mean: 0.44972309470176697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025752438232302666, decouple_loss:0.0012212444562464952
Iteration: 3757, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449390709400177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027079850435256958, decouple_loss:0.0011326756794005632
The modified gen p mean: 0.45092713832855225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026278996840119362, decouple_loss:0.0012030572397634387
The modified gen p mean: 0.44859692454338074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02548694796860218, decouple_loss:0.001262195990420878
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3758, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486532509326935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028284886851906776, decouple_loss:0.0012109986273571849
The modified gen p mean: 0.4468041658401489, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4505046606063843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026703843846917152, decouple_loss:0.0012221032520756125
loss_pred:0.028798997402191162, decouple_loss:0.0011615161783993244
Iteration: 3759, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44631871581077576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027480559423565865, decouple_loss:0.001226609107106924
The modified gen p mean: 0.44800812005996704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02662324160337448, decouple_loss:0.0012271672021597624
The modified gen p mean: 0.4468424320220947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027644729241728783, decouple_loss:0.0011757145402953029
Iteration: 3760, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45152249932289124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02742939069867134, decouple_loss:0.0012681001098826528
The modified gen p mean: 0.45171719789505005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025941861793398857, decouple_loss:0.0013270367635414004
The modified gen p mean: 0.4472469091415405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028183426707983017, decouple_loss:0.0012395502999424934
2023-05-27 06:48:43 testing...
The modified gen p mean: 0.4533033072948456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032462336122989655, decouple_loss:0.0014082579873502254
The modified gen p mean: 0.4511445462703705, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45275983214378357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032639749348163605, decouple_loss:0.0013157209614291787
loss_pred:0.03402329236268997, decouple_loss:0.0013813205296173692
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03311021625995636, avg_mse: 0.045192502439022064
current test mse: 0.045193
Iteration: 3761, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465027153491974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02860044687986374, decouple_loss:0.0012318427907302976
The modified gen p mean: 0.4457748234272003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028500491753220558, decouple_loss:0.0012203541118651628
The modified gen p mean: 0.44676005840301514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0291336290538311, decouple_loss:0.0011243285844102502
Iteration: 3762, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493037462234497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026761367917060852, decouple_loss:0.0013858233578503132
The modified gen p mean: 0.4474860727787018, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026426326483488083, decouple_loss:0.0012070359662175179
The modified gen p mean: 0.4486011266708374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026665179058909416, decouple_loss:0.0012881029397249222
Iteration: 3763, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516005516052246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026021234691143036, decouple_loss:0.001190582406707108
The modified gen p mean: 0.44641974568367004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027774598449468613, decouple_loss:0.0012535040732473135
The modified gen p mean: 0.44804343581199646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026504259556531906, decouple_loss:0.0012113513657823205
Iteration: 3764, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472086727619171, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026839446276426315, decouple_loss:0.0012167904060333967
The modified gen p mean: 0.444499135017395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029188359156250954, decouple_loss:0.0012177577009424567
The modified gen p mean: 0.4482479393482208, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690468169748783, decouple_loss:0.0013577168574556708
Iteration: 3765, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44848304986953735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02621631883084774, decouple_loss:0.0012611460406333208
The modified gen p mean: 0.4467216730117798, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025928283110260963, decouple_loss:0.0013728967169299722
The modified gen p mean: 0.4446271061897278, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026071947067975998, decouple_loss:0.001161382650025189
Iteration: 3766, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44255849719047546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02708396501839161, decouple_loss:0.0011460593668743968
The modified gen p mean: 0.4460783302783966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025838149711489677, decouple_loss:0.001296438043937087
The modified gen p mean: 0.4467342793941498, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02815951220691204, decouple_loss:0.001291179796680808
Iteration: 3767, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44371548295021057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02629305236041546, decouple_loss:0.0012807027669623494
The modified gen p mean: 0.44374051690101624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02746877446770668, decouple_loss:0.0013770024525001645
The modified gen p mean: 0.44338539242744446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028022432699799538, decouple_loss:0.0013159351656213403
Iteration: 3768, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44561636447906494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02641344629228115, decouple_loss:0.0013478846522048116
The modified gen p mean: 0.4453146755695343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02678789757192135, decouple_loss:0.001344649470411241
The modified gen p mean: 0.44490164518356323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02686655893921852, decouple_loss:0.001260149758309126
Iteration: 3769, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473545253276825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02593015320599079, decouple_loss:0.0012847251491621137
The modified gen p mean: 0.449442058801651, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025747062638401985, decouple_loss:0.0014320964692160487
The modified gen p mean: 0.4442225694656372, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02819906361401081, decouple_loss:0.0013328942004591227
Iteration: 3770, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473014771938324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0257670059800148, decouple_loss:0.0015438211848959327
The modified gen p mean: 0.4490913152694702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026002906262874603, decouple_loss:0.0013847247464582324
The modified gen p mean: 0.44800856709480286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612362429499626, decouple_loss:0.0012603348586708307
2023-05-27 06:52:48 testing...
The modified gen p mean: 0.4541708827018738, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0327850878238678, decouple_loss:0.0015687961131334305
The modified gen p mean: 0.45202404260635376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03295760974287987, decouple_loss:0.0014535310911014676
The modified gen p mean: 0.4536266326904297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0342281237244606, decouple_loss:0.0015387919265776873
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03339962661266327, avg_mse: 0.04558086022734642
current test mse: 0.045581
Iteration: 3771, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490608870983124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02789757028222084, decouple_loss:0.0014693612465634942
The modified gen p mean: 0.45116862654685974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02551213651895523, decouple_loss:0.0014049464371055365
The modified gen p mean: 0.4487419128417969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02821258455514908, decouple_loss:0.0012714291224256158
Iteration: 3772, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44925373792648315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02817322313785553, decouple_loss:0.0013930920977145433
The modified gen p mean: 0.4476374089717865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028076723217964172, decouple_loss:0.0013988657156005502
The modified gen p mean: 0.44542697072029114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029139626771211624, decouple_loss:0.0015694278990849853
Iteration: 3773, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44986414909362793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025757430121302605, decouple_loss:0.001331845298409462
The modified gen p mean: 0.44694197177886963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02686462551355362, decouple_loss:0.0013247509486973286
The modified gen p mean: 0.44651296734809875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027371592819690704, decouple_loss:0.001354658743366599
Iteration: 3774, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44789671897888184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028087884187698364, decouple_loss:0.0014125447487458587The modified gen p mean: 0.45084089040756226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02572701685130596, decouple_loss:0.0013965248363092542
The modified gen p mean: 0.44692113995552063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027312392368912697, decouple_loss:0.0013917491305619478
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr.npz
NaN value num: 0
Iteration: 3775, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44752880930900574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026202192530035973, decouple_loss:0.0014472260372713208
The modified gen p mean: 0.4517471194267273, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44764643907546997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026852723211050034, decouple_loss:0.0014608795754611492
loss_pred:0.025863081216812134, decouple_loss:0.0014854896580800414
Iteration: 3776, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452999532222748, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02658967114984989, decouple_loss:0.0013849142706021667
The modified gen p mean: 0.44849473237991333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02679344080388546, decouple_loss:0.0013484995579347014
The modified gen p mean: 0.44567492604255676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02717573381960392, decouple_loss:0.0012362715788185596
Iteration: 3777, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509800672531128, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026377374306321144, decouple_loss:0.0014864560216665268
The modified gen p mean: 0.44691264629364014, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02696170099079609, decouple_loss:0.0014600809663534164
The modified gen p mean: 0.4445618987083435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028253531083464622, decouple_loss:0.0014765135711058974
Iteration: 3778, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44757530093193054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026163265109062195, decouple_loss:0.0013551694573834538
The modified gen p mean: 0.44830721616744995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027420194819569588, decouple_loss:0.0014038056833669543
The modified gen p mean: 0.450367271900177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025050440803170204, decouple_loss:0.0014001360395923257
Iteration: 3779, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44688522815704346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02819443866610527, decouple_loss:0.0013456863816827536
The modified gen p mean: 0.44709765911102295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028071094304323196, decouple_loss:0.001611146843060851
The modified gen p mean: 0.4502675533294678, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024318045005202293, decouple_loss:0.001471125055104494
Iteration: 3780, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475051462650299, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026979897171258926, decouple_loss:0.00141264742705971
The modified gen p mean: 0.4483972489833832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027818433940410614, decouple_loss:0.0013664135476574302
The modified gen p mean: 0.4498734176158905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026035156100988388, decouple_loss:0.0014174428069964051
2023-05-27 06:57:36 testing...
The modified gen p mean: 0.454655259847641, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032693155109882355, decouple_loss:0.001571808010339737
The modified gen p mean: 0.4526180326938629, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03289959952235222, decouple_loss:0.0014072260819375515
The modified gen p mean: 0.4542013704776764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03416954725980759, decouple_loss:0.001572176581248641
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033329952508211136, avg_mse: 0.04550955817103386
current test mse: 0.04551
Iteration: 3781, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44894808530807495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025292839854955673, decouple_loss:0.0013324241153895855
The modified gen p mean: 0.45213407278060913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027135765179991722, decouple_loss:0.0013210981851443648
The modified gen p mean: 0.4504026174545288, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028031736612319946, decouple_loss:0.0014074655482545495
Iteration: 3782, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45203229784965515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025422606617212296, decouple_loss:0.001193950534798205
The modified gen p mean: 0.45326700806617737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02642441913485527, decouple_loss:0.0014165225438773632
The modified gen p mean: 0.45047613978385925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026925798505544662, decouple_loss:0.0013019541511312127
Iteration: 3783, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451153963804245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02695217914879322, decouple_loss:0.0013002777704969049
The modified gen p mean: 0.4539611041545868, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02705596573650837, decouple_loss:0.001450433861464262
The modified gen p mean: 0.4514050781726837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027635157108306885, decouple_loss:0.0013681133277714252
Iteration: 3784, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4517615735530853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026686880737543106, decouple_loss:0.0013174474006518722
The modified gen p mean: 0.45255547761917114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02571021020412445, decouple_loss:0.0013288558693602681
The modified gen p mean: 0.45652419328689575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026101063936948776, decouple_loss:0.0013867367524653673
Iteration: 3785, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45043250918388367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026650458574295044, decouple_loss:0.001146793714724481
The modified gen p mean: 0.453280508518219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025863228365778923, decouple_loss:0.0014444078551605344
The modified gen p mean: 0.4508901536464691, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02659335918724537, decouple_loss:0.0012497646966949105
Iteration: 3786, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492092430591583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02638351172208786, decouple_loss:0.0012065870687365532
The modified gen p mean: 0.4517741799354553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02766803279519081, decouple_loss:0.0013081051874905825
The modified gen p mean: 0.44919851422309875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026820940896868706, decouple_loss:0.0012497801799327135
Iteration: 3787, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45053744316101074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026713496074080467, decouple_loss:0.0012487603817135096
The modified gen p mean: 0.44960659742355347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027758078649640083, decouple_loss:0.001277455477975309
The modified gen p mean: 0.4541204571723938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025913191959261894, decouple_loss:0.0013579132501035929
Iteration: 3788, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503451883792877, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027887720614671707, decouple_loss:0.0012321311514824629
The modified gen p mean: 0.44763004779815674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02687702886760235, decouple_loss:0.0012607750250026584
The modified gen p mean: 0.4470450282096863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024365253746509552, decouple_loss:0.001196439960040152
Iteration: 3789, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496716558933258, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025635557249188423, decouple_loss:0.0013124372344464064
The modified gen p mean: 0.45301494002342224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02654757723212242, decouple_loss:0.0013695548987016082
The modified gen p mean: 0.44834965467453003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026829691603779793, decouple_loss:0.0012513723922893405
Iteration: 3790, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448700875043869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025741424411535263, decouple_loss:0.0012058905558660626
The modified gen p mean: 0.4442784786224365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026291988790035248, decouple_loss:0.0011446124408394098
The modified gen p mean: 0.4498443305492401, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02593120187520981, decouple_loss:0.0013262731954455376
2023-05-27 07:01:42 testing...
The modified gen p mean: 0.4530135691165924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03263450041413307, decouple_loss:0.0014401280786842108
The modified gen p mean: 0.4508655071258545, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45277002453804016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283783048391342, decouple_loss:0.0013160905800759792
loss_pred:0.034175705164670944, decouple_loss:0.0014271329855546355
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03328573703765869, avg_mse: 0.04550690948963165
current test mse: 0.045507
Iteration: 3791, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486202895641327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027750924229621887, decouple_loss:0.0012683517998084426
The modified gen p mean: 0.44576507806777954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027118979021906853, decouple_loss:0.0012312254402786493
The modified gen p mean: 0.4460744261741638, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027744073420763016, decouple_loss:0.0013108461862429976
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3792, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45038697123527527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028434647247195244, decouple_loss:0.0012360588880255818
The modified gen p mean: 0.45390161871910095, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44937750697135925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03093879297375679, decouple_loss:0.0011001750826835632
loss_pred:0.02862834930419922, decouple_loss:0.0012921993620693684
Iteration: 3793, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504040777683258, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02995781973004341, decouple_loss:0.001391611760482192
The modified gen p mean: 0.44888290762901306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030479716137051582, decouple_loss:0.0011613599490374327
The modified gen p mean: 0.45282331109046936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030074818059802055, decouple_loss:0.0012229098938405514
Iteration: 3794, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519924223423004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029744353145360947, decouple_loss:0.0011857140343636274
The modified gen p mean: 0.4534093737602234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031037285923957825, decouple_loss:0.0012835476081818342
The modified gen p mean: 0.45061394572257996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029379863291978836, decouple_loss:0.0011347689433023334
Iteration: 3795, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497091770172119, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45573440194129944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02897440269589424, decouple_loss:0.0011459728702902794
loss_pred:0.028232060372829437, decouple_loss:0.0012182105565443635
The modified gen p mean: 0.4506727457046509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02889873832464218, decouple_loss:0.0012223251396790147
Iteration: 3796, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45002156496047974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028387369588017464, decouple_loss:0.0011500216787680984
The modified gen p mean: 0.45105329155921936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02937636338174343, decouple_loss:0.001299830968491733
The modified gen p mean: 0.45263931155204773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029786057770252228, decouple_loss:0.0011656341375783086
Iteration: 3797, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462204575538635, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4493505656719208, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02972894161939621, decouple_loss:0.0011011954629793763
loss_pred:0.029760224744677544, decouple_loss:0.0011303855571895838
The modified gen p mean: 0.4473670721054077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029822908341884613, decouple_loss:0.001259676762856543
Iteration: 3798, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44346728920936584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03027031384408474, decouple_loss:0.0012846494792029262
The modified gen p mean: 0.44360560178756714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02938133105635643, decouple_loss:0.0011411677114665508
The modified gen p mean: 0.4513169527053833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02904273197054863, decouple_loss:0.0012899262364953756
Iteration: 3799, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44459089636802673, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44140955805778503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028306547552347183, decouple_loss:0.0012862199218943715
loss_pred:0.028781892731785774, decouple_loss:0.001162729226052761
The modified gen p mean: 0.4428655803203583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028863783925771713, decouple_loss:0.001209165551699698
Iteration: 3800, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44402047991752625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029123246669769287, decouple_loss:0.0012110454263165593
The modified gen p mean: 0.44642674922943115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0284864604473114, decouple_loss:0.0012956846039742231
The modified gen p mean: 0.44684121012687683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02781982533633709, decouple_loss:0.0013130303705111146
2023-05-27 07:06:26 testing...
The modified gen p mean: 0.44886070489883423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032300833612680435, decouple_loss:0.0014391443692147732
The modified gen p mean: 0.4466796815395355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03262071684002876, decouple_loss:0.001329839345999062
The modified gen p mean: 0.44845840334892273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03398018702864647, decouple_loss:0.0014679133892059326
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03303786367177963, avg_mse: 0.044966232031583786
current test mse: 0.044966
Iteration: 3801, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439616799354553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029256155714392662, decouple_loss:0.001218644785694778
The modified gen p mean: 0.44385358691215515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0284118615090847, decouple_loss:0.0013070260174572468
The modified gen p mean: 0.44277939200401306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029073314741253853, decouple_loss:0.001170236966572702
Iteration: 3802, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44523391127586365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03077148087322712, decouple_loss:0.0011990760685876012
The modified gen p mean: 0.44443807005882263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029704494401812553, decouple_loss:0.0012031103251501918
The modified gen p mean: 0.44597020745277405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02753503806889057, decouple_loss:0.0012154181022197008
Iteration: 3803, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44822683930397034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029119154438376427, decouple_loss:0.001253609312698245
The modified gen p mean: 0.45263174176216125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02915838360786438, decouple_loss:0.0012760355602949858
The modified gen p mean: 0.4465695023536682, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030341191217303276, decouple_loss:0.0012033673701807857
Iteration: 3804, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44983556866645813, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44691285490989685, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02723768912255764, decouple_loss:0.001256655203178525
loss_pred:0.02882849983870983, decouple_loss:0.0012408467009663582
The modified gen p mean: 0.45068153738975525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02815905399620533, decouple_loss:0.0012967271031811833
Iteration: 3805, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4528759717941284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02833402343094349, decouple_loss:0.0013210575561970472
The modified gen p mean: 0.45085498690605164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030514465644955635, decouple_loss:0.0012863194569945335
The modified gen p mean: 0.45013710856437683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029030809178948402, decouple_loss:0.0011337182950228453
Iteration: 3806, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4542175233364105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029664117842912674, decouple_loss:0.001383902272209525
The modified gen p mean: 0.45466187596321106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028722083196043968, decouple_loss:0.001329619437456131
The modified gen p mean: 0.45029404759407043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029105309396982193, decouple_loss:0.0011962470598518848
Iteration: 3807, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45316609740257263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02803545631468296, decouple_loss:0.0011214211117476225
The modified gen p mean: 0.45234087109565735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027899621054530144, decouple_loss:0.0013160352827981114
The modified gen p mean: 0.453642338514328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029912762343883514, decouple_loss:0.001369971432723105
Iteration: 3808, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4535521864891052, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028324250131845474, decouple_loss:0.0013759153662249446
The modified gen p mean: 0.45128124952316284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0294030774384737, decouple_loss:0.001215537777170539
The modified gen p mean: 0.44993719458580017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028297126293182373, decouple_loss:0.0013007891830056906
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr.npz
NaN value num: 0
Iteration: 3809, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503220319747925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027396108955144882, decouple_loss:0.001321038813330233
The modified gen p mean: 0.4468638300895691, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02723742090165615, decouple_loss:0.001480451668612659
The modified gen p mean: 0.44463396072387695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02710576355457306, decouple_loss:0.0011625753249973059
Iteration: 3810, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44538402557373047, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025594437494874, decouple_loss:0.0013750192010775208
The modified gen p mean: 0.4452294707298279, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026161395013332367, decouple_loss:0.0012208586558699608
The modified gen p mean: 0.4454076290130615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02503928169608116, decouple_loss:0.0013756540138274431
2023-05-27 07:11:07 testing...
The modified gen p mean: 0.45038095116615295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03248993307352066, decouple_loss:0.00144578970503062
The modified gen p mean: 0.44825348258018494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03280359134078026, decouple_loss:0.001402545371092856
The modified gen p mean: 0.44993242621421814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03411633521318436, decouple_loss:0.0014363543596118689
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03320803493261337, avg_mse: 0.045218728482723236
current test mse: 0.045219
Iteration: 3811, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44665423035621643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025106335058808327, decouple_loss:0.0014759092591702938
The modified gen p mean: 0.44943326711654663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026455258950591087, decouple_loss:0.0012810931075364351
The modified gen p mean: 0.44532427191734314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024877140298485756, decouple_loss:0.001290231361053884
Iteration: 3812, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44318825006484985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02746930532157421, decouple_loss:0.0013121947413310409
The modified gen p mean: 0.4450664818286896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02576506696641445, decouple_loss:0.001362756360322237
The modified gen p mean: 0.4461360573768616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02739676646888256, decouple_loss:0.001305801677517593
Iteration: 3813, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44471320509910583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026147926226258278, decouple_loss:0.0012314643245190382
The modified gen p mean: 0.446077436208725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0256368238478899, decouple_loss:0.001248244196176529
The modified gen p mean: 0.4462659955024719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025512954220175743, decouple_loss:0.0013416570145636797
Iteration: 3814, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473702311515808, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025712905451655388, decouple_loss:0.001392412930727005
The modified gen p mean: 0.4463002681732178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027344457805156708, decouple_loss:0.0015073827235028148
The modified gen p mean: 0.4424496293067932, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027429228648543358, decouple_loss:0.0012176604941487312
Iteration: 3815, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4431193470954895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025828633457422256, decouple_loss:0.0014112014323472977
The modified gen p mean: 0.4489641785621643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025184793397784233, decouple_loss:0.0012214099988341331
The modified gen p mean: 0.44366568326950073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027353208512067795, decouple_loss:0.0012994416756555438
Iteration: 3816, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492422640323639, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025219159200787544, decouple_loss:0.0012838357361033559
The modified gen p mean: 0.45186397433280945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025706825777888298, decouple_loss:0.001343514653854072
The modified gen p mean: 0.44551587104797363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690984308719635, decouple_loss:0.0014357618056237698
Iteration: 3817, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44614899158477783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025379018858075142, decouple_loss:0.0012664840323850513
The modified gen p mean: 0.44797950983047485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026925327256321907, decouple_loss:0.0013972849119454622
The modified gen p mean: 0.44533371925354004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610163390636444, decouple_loss:0.0012260746443644166
Iteration: 3818, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45158571004867554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02615531161427498, decouple_loss:0.0012923189206048846
The modified gen p mean: 0.4492531418800354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024950796738266945, decouple_loss:0.0013643406564369798
The modified gen p mean: 0.4471554160118103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026698037981987, decouple_loss:0.0012195968301966786
Iteration: 3819, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448062002658844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026994993910193443, decouple_loss:0.00130232993979007
The modified gen p mean: 0.44835031032562256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026916153728961945, decouple_loss:0.00139725545886904
The modified gen p mean: 0.4515553116798401, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02695392444729805, decouple_loss:0.001379950437694788
Iteration: 3820, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4520842432975769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025808408856391907, decouple_loss:0.0012424455489963293
The modified gen p mean: 0.4539737403392792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02426804229617119, decouple_loss:0.00140304712112993
The modified gen p mean: 0.45276132225990295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027098601683974266, decouple_loss:0.0011218367144465446
2023-05-27 07:15:12 testing...
The modified gen p mean: 0.4544287323951721, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254124894738197, decouple_loss:0.0014485626015812159
The modified gen p mean: 0.45238184928894043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03285152465105057, decouple_loss:0.0013338407734408975
The modified gen p mean: 0.4539995491504669, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03415403515100479, decouple_loss:0.0014753303257748485
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03325323387980461, avg_mse: 0.04536512494087219
current test mse: 0.045365
Iteration: 3821, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509170651435852, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026736894622445107, decouple_loss:0.0014135722303763032
The modified gen p mean: 0.4524557292461395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025735341012477875, decouple_loss:0.0013340483419597149
The modified gen p mean: 0.45358017086982727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024850863963365555, decouple_loss:0.0013630856992676854
Iteration: 3822, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500797390937805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025571856647729874, decouple_loss:0.0012365547008812428
The modified gen p mean: 0.4528750479221344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025118030607700348, decouple_loss:0.0012878613779321313
The modified gen p mean: 0.4504842162132263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025514477863907814, decouple_loss:0.001266518491320312
Iteration: 3823, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462415277957916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02695659175515175, decouple_loss:0.0012162216007709503
The modified gen p mean: 0.44684597849845886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026964940130710602, decouple_loss:0.001249138847924769
The modified gen p mean: 0.44613710045814514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025716152042150497, decouple_loss:0.0012139203026890755
Iteration: 3824, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44311243295669556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026914598420262337, decouple_loss:0.0011840865481644869
The modified gen p mean: 0.4434080123901367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026471538469195366, decouple_loss:0.0012549617094919086
The modified gen p mean: 0.4444161355495453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02663545310497284, decouple_loss:0.0012036628322675824
Iteration: 3825, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443921148777008, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02615426294505596, decouple_loss:0.0012023817980661988
The modified gen p mean: 0.44373518228530884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026075460016727448, decouple_loss:0.001159896026365459
The modified gen p mean: 0.4445107579231262, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026713117957115173, decouple_loss:0.0012075334088876843
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3826, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454371929168701, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02947930246591568, decouple_loss:0.0012105278437957168
The modified gen p mean: 0.4487709403038025, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45097437500953674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030543996021151543, decouple_loss:0.001193728414364159
loss_pred:0.02990659512579441, decouple_loss:0.0012391528580337763
Iteration: 3827, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45175695419311523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031124912202358246, decouple_loss:0.0011922919657081366
The modified gen p mean: 0.4487059414386749, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030171683058142662, decouple_loss:0.0012374778743833303
The modified gen p mean: 0.4501010775566101, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029404330998659134, decouple_loss:0.0012376410886645317
Iteration: 3828, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449519544839859, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02917812392115593, decouple_loss:0.0012646532850340009
The modified gen p mean: 0.45226311683654785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03082101233303547, decouple_loss:0.0012479444267228246
The modified gen p mean: 0.45051896572113037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031419456005096436, decouple_loss:0.0012863778974860907
Iteration: 3829, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45147454738616943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028674911707639694, decouple_loss:0.0011958390241488814
The modified gen p mean: 0.4516696631908417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029349803924560547, decouple_loss:0.0013209624448791146
The modified gen p mean: 0.45291054248809814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02980007231235504, decouple_loss:0.0012094661360606551
Iteration: 3830, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45530635118484497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028045624494552612, decouple_loss:0.0011885326821357012
The modified gen p mean: 0.45688313245773315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030240220949053764, decouple_loss:0.0011304480722174048
The modified gen p mean: 0.4583527147769928, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030667591840028763, decouple_loss:0.0012015184620395303
2023-05-27 07:19:55 testing...
The modified gen p mean: 0.45673611760139465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0321769118309021, decouple_loss:0.001393188489601016
The modified gen p mean: 0.45455798506736755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032563935965299606, decouple_loss:0.0013439884642139077
The modified gen p mean: 0.4563559889793396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033979639410972595, decouple_loss:0.0014569929335266352
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03297673165798187, avg_mse: 0.044818367809057236
current test mse: 0.044818
Iteration: 3831, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508816599845886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028850844129920006, decouple_loss:0.0012268912978470325
The modified gen p mean: 0.450514018535614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03190434351563454, decouple_loss:0.001328032580204308
The modified gen p mean: 0.4547511041164398, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028976619243621826, decouple_loss:0.0013197673251852393
Iteration: 3832, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450935035943985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02896885573863983, decouple_loss:0.0012051744852215052
The modified gen p mean: 0.4547111988067627, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030129449442029, decouple_loss:0.0013141793897375464
The modified gen p mean: 0.453471302986145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028864454478025436, decouple_loss:0.0012556151486933231
Iteration: 3833, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499604105949402, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029947247356176376, decouple_loss:0.0012801969423890114
The modified gen p mean: 0.4505411684513092, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029146278277039528, decouple_loss:0.001275684335269034
The modified gen p mean: 0.44902798533439636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029196444898843765, decouple_loss:0.0011552798096090555
Iteration: 3834, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484642744064331, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02812129445374012, decouple_loss:0.0014545589219778776
The modified gen p mean: 0.445606529712677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02840537391602993, decouple_loss:0.001257711322978139
The modified gen p mean: 0.4488217830657959, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029669301584362984, decouple_loss:0.0013837403384968638
Iteration: 3835, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44801366329193115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028165249153971672, decouple_loss:0.001317279995419085
The modified gen p mean: 0.45009201765060425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027455393224954605, decouple_loss:0.0013031607959419489
The modified gen p mean: 0.4465619921684265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029227232560515404, decouple_loss:0.0012356205843389034
Iteration: 3836, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452495574951172, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029599040746688843, decouple_loss:0.001108449650928378
The modified gen p mean: 0.4449191689491272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028711222112178802, decouple_loss:0.001235086820088327
The modified gen p mean: 0.4461561441421509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029899785295128822, decouple_loss:0.0012464576866477728
Iteration: 3837, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44578808546066284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028905531391501427, decouple_loss:0.001222964026965201
The modified gen p mean: 0.44496920704841614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02973080426454544, decouple_loss:0.0012699705548584461
The modified gen p mean: 0.444221556186676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029661646112799644, decouple_loss:0.001234398572705686
Iteration: 3838, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459535479545593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028659284114837646, decouple_loss:0.0012962553882971406
The modified gen p mean: 0.44382649660110474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029289428144693375, decouple_loss:0.0013434618012979627
The modified gen p mean: 0.44495099782943726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029174257069826126, decouple_loss:0.0013061610516160727
Iteration: 3839, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462139308452606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03008420765399933, decouple_loss:0.0012251089792698622
The modified gen p mean: 0.44791680574417114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030072703957557678, decouple_loss:0.0012226613471284509
The modified gen p mean: 0.44688746333122253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02890959195792675, decouple_loss:0.0013154556509107351
Iteration: 3840, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44660958647727966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029626036062836647, decouple_loss:0.0011979511473327875
The modified gen p mean: 0.4484493136405945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028363950550556183, decouple_loss:0.0013664272846654058
The modified gen p mean: 0.4469310939311981, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030551733449101448, decouple_loss:0.001242976519279182
2023-05-27 07:24:01 testing...
The modified gen p mean: 0.4532451331615448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032428108155727386, decouple_loss:0.0015156755689531565
The modified gen p mean: 0.45093172788619995, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4526183307170868, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03269688040018082, decouple_loss:0.0014404385583475232
loss_pred:0.0341690257191658, decouple_loss:0.001518309349194169
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03317257761955261, avg_mse: 0.04512518271803856
current test mse: 0.045125
Iteration: 3841, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45333078503608704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026618758216500282, decouple_loss:0.0012965527130290866
The modified gen p mean: 0.45049625635147095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02957502380013466, decouple_loss:0.0013742500450462103
The modified gen p mean: 0.4535531997680664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027943871915340424, decouple_loss:0.001359719317406416
Iteration: 3842, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.455076664686203, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02918132208287716, decouple_loss:0.0013658314710482955
The modified gen p mean: 0.44840872287750244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029190396890044212, decouple_loss:0.0012629373231902719
The modified gen p mean: 0.45386359095573425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027872422710061073, decouple_loss:0.0012304031988605857
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr.npz
NaN value num: 0
Iteration: 3843, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488796591758728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025967201218008995, decouple_loss:0.0013946164399385452
The modified gen p mean: 0.4507240056991577, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45093587040901184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02602456882596016, decouple_loss:0.001349880127236247
loss_pred:0.027661584317684174, decouple_loss:0.0014203251339495182
Iteration: 3844, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473975598812103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025706497952342033, decouple_loss:0.001337638939730823
The modified gen p mean: 0.4481816589832306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025285419076681137, decouple_loss:0.0012402889551594853
The modified gen p mean: 0.4490137994289398, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026506474241614342, decouple_loss:0.0013270005583763123
Iteration: 3845, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449130117893219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026055416092276573, decouple_loss:0.0015310040907934308
The modified gen p mean: 0.44858506321907043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025749124586582184, decouple_loss:0.001368622062727809
The modified gen p mean: 0.44935452938079834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025190820917487144, decouple_loss:0.001376091269776225
Iteration: 3846, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44962310791015625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025322308763861656, decouple_loss:0.0011678730370476842
The modified gen p mean: 0.44765424728393555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0265214741230011, decouple_loss:0.0013040922349318862
The modified gen p mean: 0.4459366500377655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027896301820874214, decouple_loss:0.0015747608849778771
Iteration: 3847, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477783143520355, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45022809505462646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025080010294914246, decouple_loss:0.0013161576353013515
loss_pred:0.024995338171720505, decouple_loss:0.0013256714446470141
The modified gen p mean: 0.4486134946346283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026055561378598213, decouple_loss:0.0012974892742931843
Iteration: 3848, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44290921092033386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028297582641243935, decouple_loss:0.001431070500984788
The modified gen p mean: 0.4459535777568817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02682223916053772, decouple_loss:0.0015093792462721467
The modified gen p mean: 0.4488621652126312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02495243027806282, decouple_loss:0.0016027047531679273
Iteration: 3849, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445797801017761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027190985158085823, decouple_loss:0.0013085154350847006
The modified gen p mean: 0.4457811117172241, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02514084242284298, decouple_loss:0.0013973194872960448
The modified gen p mean: 0.44646593928337097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025428878143429756, decouple_loss:0.0013363800244405866
Iteration: 3850, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44410717487335205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02572844736278057, decouple_loss:0.001430441509000957
The modified gen p mean: 0.4445516765117645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027298331260681152, decouple_loss:0.0012632940197363496
The modified gen p mean: 0.44373005628585815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027323637157678604, decouple_loss:0.0013286699540913105
2023-05-27 07:28:44 testing...
The modified gen p mean: 0.44970959424972534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03250424191355705, decouple_loss:0.0015586733352392912
The modified gen p mean: 0.4475044012069702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255947679281235, decouple_loss:0.0015279620420187712
The modified gen p mean: 0.4489928185939789, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03411416336894035, decouple_loss:0.0015626128297299147
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03313678130507469, avg_mse: 0.04522363096475601
current test mse: 0.045224
Iteration: 3851, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4420609474182129, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02815348654985428, decouple_loss:0.001466532121412456
The modified gen p mean: 0.4433583915233612, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026774510741233826, decouple_loss:0.0012960137100890279
The modified gen p mean: 0.44497010111808777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026923635974526405, decouple_loss:0.0013442684430629015
Iteration: 3852, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459875822067261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025261685252189636, decouple_loss:0.0014801009092479944
The modified gen p mean: 0.44287413358688354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027478082105517387, decouple_loss:0.0013610643800348043
The modified gen p mean: 0.445283979177475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02731342799961567, decouple_loss:0.001335849636234343
Iteration: 3853, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44510704278945923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027581913396716118, decouple_loss:0.0012958201114088297
The modified gen p mean: 0.4466532766819, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025143595412373543, decouple_loss:0.0014161157887429
The modified gen p mean: 0.44539618492126465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0258802380412817, decouple_loss:0.0012386292219161987
Iteration: 3854, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446963369846344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028293151408433914, decouple_loss:0.0012278109788894653
The modified gen p mean: 0.4463001489639282, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026073625311255455, decouple_loss:0.0013626450672745705
The modified gen p mean: 0.44804346561431885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027087680995464325, decouple_loss:0.0011541101848706603
Iteration: 3855, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44951754808425903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026102574542164803, decouple_loss:0.001208329456858337
The modified gen p mean: 0.44830796122550964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026752324774861336, decouple_loss:0.0014533931389451027
The modified gen p mean: 0.44908422231674194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02521790936589241, decouple_loss:0.001403041766025126
Iteration: 3856, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519127309322357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024488843977451324, decouple_loss:0.0012213857844471931
The modified gen p mean: 0.45300039649009705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025059472769498825, decouple_loss:0.0012245686957612634
The modified gen p mean: 0.44928815960884094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02597150392830372, decouple_loss:0.0011529888724908233
Iteration: 3857, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509466886520386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027296746149659157, decouple_loss:0.001274831942282617
The modified gen p mean: 0.449849933385849, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02485395036637783, decouple_loss:0.0012268944410607219
The modified gen p mean: 0.450457900762558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026544148102402687, decouple_loss:0.001213275478221476
Iteration: 3858, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44902727007865906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025568021461367607, decouple_loss:0.0011578276753425598
The modified gen p mean: 0.4492835998535156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026903074234724045, decouple_loss:0.0012325161369517446
The modified gen p mean: 0.4476078450679779, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025920139625668526, decouple_loss:0.0012524558696895838
Iteration: 3859, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518073797225952, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024585193023085594, decouple_loss:0.0012846965109929442
The modified gen p mean: 0.44746020436286926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027010632678866386, decouple_loss:0.0012787216110154986
The modified gen p mean: 0.44762787222862244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02533303201198578, decouple_loss:0.0012094515841454268
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr.npz
NaN value num: 0
Iteration: 3860, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44655364751815796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02948158234357834, decouple_loss:0.0012749190209433436
The modified gen p mean: 0.44730034470558167, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4467635750770569, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03065766580402851, decouple_loss:0.001248684711754322
loss_pred:0.029568905010819435, decouple_loss:0.001293201930820942
2023-05-27 07:33:29 testing...
The modified gen p mean: 0.4525795578956604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032392583787441254, decouple_loss:0.0013891683192923665
The modified gen p mean: 0.4505135715007782, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03250562399625778, decouple_loss:0.0013074638554826379
The modified gen p mean: 0.45199576020240784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033942874521017075, decouple_loss:0.0014114425284788013
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03301549702882767, avg_mse: 0.04509401693940163
current test mse: 0.045094
Iteration: 3861, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44864845275878906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029459338635206223, decouple_loss:0.0012305305572226644
The modified gen p mean: 0.45134642720222473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030355090275406837, decouple_loss:0.0013275663368403912
The modified gen p mean: 0.4491228461265564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02850228361785412, decouple_loss:0.0012737689539790154
Iteration: 3862, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515635371208191, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028978796675801277, decouple_loss:0.0012463920284062624
The modified gen p mean: 0.44778212904930115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028084971010684967, decouple_loss:0.0013927954714745283
The modified gen p mean: 0.44694963097572327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029338857159018517, decouple_loss:0.0012173122959211469
Iteration: 3863, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482370913028717, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029310109093785286, decouple_loss:0.0013807942159473896
The modified gen p mean: 0.4515532851219177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0279502235352993, decouple_loss:0.0012333649210631847
The modified gen p mean: 0.4505479037761688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02898099459707737, decouple_loss:0.0013830115785822272
Iteration: 3864, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450575053691864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027719007804989815, decouple_loss:0.0013248941395431757
The modified gen p mean: 0.45488429069519043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028275467455387115, decouple_loss:0.0013963463716208935
The modified gen p mean: 0.4500325918197632, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029743622988462448, decouple_loss:0.001325000892393291
Iteration: 3865, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45175743103027344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026732470840215683, decouple_loss:0.001277012168429792
The modified gen p mean: 0.4504733979701996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028964336961507797, decouple_loss:0.0012418433325365186
The modified gen p mean: 0.4518800973892212, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027567405253648758, decouple_loss:0.0012317280052229762
Iteration: 3866, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45302021503448486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027473341673612595, decouple_loss:0.0012891802471131086
The modified gen p mean: 0.45408135652542114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028003530576825142, decouple_loss:0.0014717001467943192
The modified gen p mean: 0.45194312930107117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027691522613167763, decouple_loss:0.001337952446192503
Iteration: 3867, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.453776478767395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026955517008900642, decouple_loss:0.0012415775563567877
The modified gen p mean: 0.4513704180717468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028205659240484238, decouple_loss:0.0011644397163763642
The modified gen p mean: 0.44832953810691833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02932407148182392, decouple_loss:0.0011670842068269849
Iteration: 3868, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506002366542816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027593666687607765, decouple_loss:0.0012902319431304932
The modified gen p mean: 0.4488350749015808, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03043164126574993, decouple_loss:0.001286498736590147
The modified gen p mean: 0.4531908631324768, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027652541175484657, decouple_loss:0.0012793426867574453
Iteration: 3869, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492727816104889, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026785099878907204, decouple_loss:0.0013479102635756135
The modified gen p mean: 0.453795462846756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027583837509155273, decouple_loss:0.0012580318143591285
The modified gen p mean: 0.4500333070755005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028553487733006477, decouple_loss:0.0013953831512480974
Iteration: 3870, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44865694642066956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029864991083741188, decouple_loss:0.0013908144319429994
The modified gen p mean: 0.4497944712638855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026724370196461678, decouple_loss:0.0012435560347512364
The modified gen p mean: 0.44649311900138855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02944893389940262, decouple_loss:0.0011661667376756668
2023-05-27 07:37:35 testing...
The modified gen p mean: 0.4525523781776428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032331373542547226, decouple_loss:0.0013964849058538675
The modified gen p mean: 0.4503072500228882, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255508095026016, decouple_loss:0.0014424441615119576
The modified gen p mean: 0.4518282115459442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03390765190124512, decouple_loss:0.0014243914047256112
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033002424985170364, avg_mse: 0.04497474804520607
current test mse: 0.044975
Iteration: 3871, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465911388397217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029180258512496948, decouple_loss:0.00148005539085716
The modified gen p mean: 0.44704151153564453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02905801124870777, decouple_loss:0.0013449115213006735
The modified gen p mean: 0.4452906847000122, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029095036908984184, decouple_loss:0.0013214251957833767
Iteration: 3872, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489108622074127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820807695388794, decouple_loss:0.0013320503057911992
The modified gen p mean: 0.44613128900527954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02748126909136772, decouple_loss:0.0013063178630545735
The modified gen p mean: 0.4453706741333008, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028755834326148033, decouple_loss:0.001312849810346961
Iteration: 3873, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472253620624542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028825273737311363, decouple_loss:0.00121318269520998
The modified gen p mean: 0.44436997175216675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027909986674785614, decouple_loss:0.0013055943418294191
The modified gen p mean: 0.4459027349948883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02871592529118061, decouple_loss:0.0012459716526791453
Iteration: 3874, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44946756958961487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028752516955137253, decouple_loss:0.0014501289697363973
The modified gen p mean: 0.4458867609500885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02843349054455757, decouple_loss:0.0011416372144594789
The modified gen p mean: 0.44666630029678345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028875770047307014, decouple_loss:0.0012868618359789252
Iteration: 3875, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454987943172455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028723616153001785, decouple_loss:0.0012317419750615954
The modified gen p mean: 0.4469386041164398, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028754858300089836, decouple_loss:0.001263233134523034
The modified gen p mean: 0.450920969247818, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027417713776230812, decouple_loss:0.0012932787649333477
Iteration: 3876, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461106061935425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02744401805102825, decouple_loss:0.0014064008137211204
The modified gen p mean: 0.4486621022224426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028221484273672104, decouple_loss:0.0013224896974861622
The modified gen p mean: 0.44670620560646057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028398416936397552, decouple_loss:0.0013607031432911754
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3877, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44666704535484314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03052605129778385, decouple_loss:0.0013599918456748128
The modified gen p mean: 0.44713643193244934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028895122930407524, decouple_loss:0.0012420117855072021
The modified gen p mean: 0.44929584860801697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029482563957571983, decouple_loss:0.0013085313839837909
Iteration: 3878, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45309996604919434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029080502688884735, decouple_loss:0.0012755908537656069
The modified gen p mean: 0.4479771852493286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02973365969955921, decouple_loss:0.001424407004378736
The modified gen p mean: 0.4510372281074524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028048640117049217, decouple_loss:0.0013562218518927693
Iteration: 3879, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498210549354553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02915099635720253, decouple_loss:0.001177199766971171
The modified gen p mean: 0.45352327823638916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03003724291920662, decouple_loss:0.0012906318297609687
The modified gen p mean: 0.4483543932437897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029368575662374496, decouple_loss:0.00121124682482332
Iteration: 3880, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44837504625320435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029928255826234818, decouple_loss:0.001192497438751161
The modified gen p mean: 0.44684916734695435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03030500002205372, decouple_loss:0.001315962872467935
The modified gen p mean: 0.4494001567363739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02962525188922882, decouple_loss:0.0011914803180843592
2023-05-27 07:42:19 testing...
The modified gen p mean: 0.4535212516784668, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03227517381310463, decouple_loss:0.0014726798981428146
The modified gen p mean: 0.4514090418815613, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0324973501265049, decouple_loss:0.001449070405215025
The modified gen p mean: 0.4529419243335724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0339396595954895, decouple_loss:0.0014640407171100378
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032977160066366196, avg_mse: 0.04484708607196808
current test mse: 0.044847
Iteration: 3881, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45177438855171204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02854371815919876, decouple_loss:0.0012507541105151176
The modified gen p mean: 0.45001891255378723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028868941590189934, decouple_loss:0.001265639322809875
The modified gen p mean: 0.44616174697875977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029618436470627785, decouple_loss:0.0012447364861145616
Iteration: 3882, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44730666279792786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029626883566379547, decouple_loss:0.0012405060697346926
The modified gen p mean: 0.44772371649742126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02913777343928814, decouple_loss:0.0012886032927781343
The modified gen p mean: 0.4503175616264343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03012111969292164, decouple_loss:0.0013204121496528387
Iteration: 3883, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450825035572052, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030040936544537544, decouple_loss:0.0012197635369375348
The modified gen p mean: 0.44675973057746887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03001161478459835, decouple_loss:0.0012516860151663423
The modified gen p mean: 0.44644463062286377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028770634904503822, decouple_loss:0.0012754048220813274
Iteration: 3884, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499921202659607, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029333900660276413, decouple_loss:0.0012935410486534238
The modified gen p mean: 0.4506452679634094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02845729887485504, decouple_loss:0.0012595755979418755
The modified gen p mean: 0.44509124755859375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029177656397223473, decouple_loss:0.0013001714833080769
Iteration: 3885, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44943299889564514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029134657233953476, decouple_loss:0.001246700994670391
The modified gen p mean: 0.4450063109397888, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02880956046283245, decouple_loss:0.0012363741407170892
The modified gen p mean: 0.4452818036079407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029666731134057045, decouple_loss:0.0012327495496720076
Iteration: 3886, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44481199979782104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030406981706619263, decouple_loss:0.0011683724587783217
The modified gen p mean: 0.4451605975627899, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03012748435139656, decouple_loss:0.0012187630636617541
The modified gen p mean: 0.44751983880996704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029210779815912247, decouple_loss:0.0013071444118395448
Iteration: 3887, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44738975167274475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02920674905180931, decouple_loss:0.0012691720621660352
The modified gen p mean: 0.450330913066864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028202330693602562, decouple_loss:0.0012391831260174513
The modified gen p mean: 0.448692262172699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02984161674976349, decouple_loss:0.0012953035766258836
Iteration: 3888, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44674205780029297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02983049675822258, decouple_loss:0.0012707820860669017
The modified gen p mean: 0.44623252749443054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02971889078617096, decouple_loss:0.0013047090033069253
The modified gen p mean: 0.4482002258300781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029026411473751068, decouple_loss:0.0013002535561099648
Iteration: 3889, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45010465383529663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0296432264149189, decouple_loss:0.001348827383480966
The modified gen p mean: 0.446492075920105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030020132660865784, decouple_loss:0.001299867290072143
The modified gen p mean: 0.45023834705352783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030079003423452377, decouple_loss:0.0011516264639794827
Iteration: 3890, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496931731700897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02979995310306549, decouple_loss:0.0012131186667829752
The modified gen p mean: 0.44795170426368713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0305897556245327, decouple_loss:0.0012513319961726665
The modified gen p mean: 0.44946974515914917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028123395517468452, decouple_loss:0.0013340952573344111
2023-05-27 07:46:25 testing...
The modified gen p mean: 0.45180249214172363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03226150572299957, decouple_loss:0.001432082150131464
The modified gen p mean: 0.4513187110424042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03399726375937462, decouple_loss:0.0014727333327755332
The modified gen p mean: 0.4499097466468811, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03272382542490959, decouple_loss:0.001456230878829956
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03306688368320465, avg_mse: 0.044889096170663834
current test mse: 0.044889
Iteration: 3891, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468555450439453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02851823903620243, decouple_loss:0.0013576227938756347
The modified gen p mean: 0.4501260817050934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028656277805566788, decouple_loss:0.0013246871531009674
The modified gen p mean: 0.4460729956626892, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03040255606174469, decouple_loss:0.0012380091939121485
Iteration: 3892, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45005202293395996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0305826123803854, decouple_loss:0.001348925638012588
The modified gen p mean: 0.4473066031932831, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028391951695084572, decouple_loss:0.001167751383036375
The modified gen p mean: 0.45158955454826355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0286124125123024, decouple_loss:0.0013150036102160811
Iteration: 3893, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485711455345154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030220936983823776, decouple_loss:0.0015606906963512301
The modified gen p mean: 0.44873103499412537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03009962849318981, decouple_loss:0.0012325952993705869
The modified gen p mean: 0.44900229573249817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02986886538565159, decouple_loss:0.0012456929543986917
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3894, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44720613956451416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02720130793750286, decouple_loss:0.0012367075541988015
The modified gen p mean: 0.44992971420288086, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4480969309806824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02608702890574932, decouple_loss:0.001456517493352294
loss_pred:0.026483720168471336, decouple_loss:0.0011677704751491547
Iteration: 3895, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462544918060303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026098009198904037, decouple_loss:0.0012223843950778246
The modified gen p mean: 0.45077279210090637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0267028771340847, decouple_loss:0.0013095231261104345
The modified gen p mean: 0.446145236492157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026684056967496872, decouple_loss:0.0012174899457022548
Iteration: 3896, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456053078174591, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02752925641834736, decouple_loss:0.00124559726100415
The modified gen p mean: 0.44742050766944885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027033956721425056, decouple_loss:0.001164777553640306
The modified gen p mean: 0.45010271668434143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027584604918956757, decouple_loss:0.0012001944705843925
Iteration: 3897, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497978389263153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025516917929053307, decouple_loss:0.0013763424940407276
The modified gen p mean: 0.4447292387485504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027117548510432243, decouple_loss:0.0013200559187680483
The modified gen p mean: 0.4464026391506195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026443498209118843, decouple_loss:0.0013388529187068343
Iteration: 3898, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451732933521271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027461525052785873, decouple_loss:0.001298369257710874
The modified gen p mean: 0.4500858187675476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0261251050978899, decouple_loss:0.001379408873617649
The modified gen p mean: 0.44752025604248047, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025755872949957848, decouple_loss:0.0013902010396122932
Iteration: 3899, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444294273853302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02725018560886383, decouple_loss:0.0012900468427687883
The modified gen p mean: 0.4466145634651184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027239371091127396, decouple_loss:0.0014913787599653006
The modified gen p mean: 0.44918686151504517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02665768936276436, decouple_loss:0.0012008671183139086
Iteration: 3900, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445074796676636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02583150751888752, decouple_loss:0.0013052958529442549
The modified gen p mean: 0.44440773129463196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732711099088192, decouple_loss:0.0011701388284564018
The modified gen p mean: 0.44603708386421204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025398215278983116, decouple_loss:0.001276515075005591
2023-05-27 07:51:11 testing...
The modified gen p mean: 0.4499261677265167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032487254589796066, decouple_loss:0.0015473907114937901
The modified gen p mean: 0.4479149878025055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03297167643904686, decouple_loss:0.0014842525124549866
The modified gen p mean: 0.4496031701564789, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034297794103622437, decouple_loss:0.001466625602915883
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033327214419841766, avg_mse: 0.04542190209031105
current test mse: 0.045422
Iteration: 3901, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455069303512573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02742220275104046, decouple_loss:0.0011888014851137996
The modified gen p mean: 0.4439718723297119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02644534781575203, decouple_loss:0.0011712188133969903
The modified gen p mean: 0.4460177719593048, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026221709325909615, decouple_loss:0.0013637073570862412
Iteration: 3902, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489192068576813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025913648307323456, decouple_loss:0.001369403675198555
The modified gen p mean: 0.4476310908794403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027139853686094284, decouple_loss:0.0014475203352048993
The modified gen p mean: 0.4501202404499054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025389324873685837, decouple_loss:0.001289424835704267
Iteration: 3903, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481499493122101, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026263467967510223, decouple_loss:0.001240108977071941
The modified gen p mean: 0.44885796308517456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025559214875102043, decouple_loss:0.0012096372665837407
The modified gen p mean: 0.45183396339416504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02509341761469841, decouple_loss:0.0013595656491816044
Iteration: 3904, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44970211386680603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025620371103286743, decouple_loss:0.0015636214520782232
The modified gen p mean: 0.44910168647766113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027333248406648636, decouple_loss:0.001418040250428021
The modified gen p mean: 0.44969332218170166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02602098509669304, decouple_loss:0.0012573422864079475
Iteration: 3905, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45080652832984924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02438051626086235, decouple_loss:0.0013369418447837234
The modified gen p mean: 0.4481363892555237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02618570625782013, decouple_loss:0.001242445781826973
The modified gen p mean: 0.4485660791397095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02526426874101162, decouple_loss:0.0015056688571348786
Iteration: 3906, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44528722763061523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02729800157248974, decouple_loss:0.0013235991355031729
The modified gen p mean: 0.4468875229358673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027131590992212296, decouple_loss:0.0012997320154681802
The modified gen p mean: 0.4488508701324463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027401434257626534, decouple_loss:0.001334145781584084
Iteration: 3907, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474988281726837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024922428652644157, decouple_loss:0.00134653365239501
The modified gen p mean: 0.4445779323577881, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026161523535847664, decouple_loss:0.0012656664475798607
The modified gen p mean: 0.4460616409778595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027084574103355408, decouple_loss:0.001427790499292314
Iteration: 3908, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455331265926361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026815716177225113, decouple_loss:0.0011539257830008864
The modified gen p mean: 0.44535407423973083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02735763043165207, decouple_loss:0.0012925700284540653
The modified gen p mean: 0.4475638270378113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025138841941952705, decouple_loss:0.00123082275968045
Iteration: 3909, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508161246776581, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027369072660803795, decouple_loss:0.0012809225590899587
The modified gen p mean: 0.4471811354160309, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02759769931435585, decouple_loss:0.0012628391850739717
The modified gen p mean: 0.4484342038631439, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02717435359954834, decouple_loss:0.0012324006529524922
Iteration: 3910, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475317895412445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026853319257497787, decouple_loss:0.001215770491398871
The modified gen p mean: 0.4500126838684082, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02602209709584713, decouple_loss:0.0011745269875973463
The modified gen p mean: 0.4480317234992981, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027448507025837898, decouple_loss:0.0012680321233347058
2023-05-27 07:55:17 testing...
The modified gen p mean: 0.45365920662879944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03257037699222565, decouple_loss:0.0014525472652167082
The modified gen p mean: 0.4514928162097931, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4533892869949341, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03287439048290253, decouple_loss:0.0014291662955656648
loss_pred:0.034373003989458084, decouple_loss:0.0014881049282848835
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03334542363882065, avg_mse: 0.04550256207585335
current test mse: 0.045503
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr.npz
NaN value num: 0
Iteration: 3911, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44585278630256653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028241688385605812, decouple_loss:0.0012050651712343097
The modified gen p mean: 0.44973263144493103, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.447780579328537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028065314516425133, decouple_loss:0.0013373296242207289
loss_pred:0.027202382683753967, decouple_loss:0.0012783483834937215
Iteration: 3912, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494117498397827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02668064460158348, decouple_loss:0.0012087620561942458
The modified gen p mean: 0.45090389251708984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025826290249824524, decouple_loss:0.001215884811244905
The modified gen p mean: 0.44634419679641724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027712181210517883, decouple_loss:0.001172481570392847
Iteration: 3913, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477236270904541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025073040276765823, decouple_loss:0.0014570780331268907
The modified gen p mean: 0.4452168643474579, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025741392746567726, decouple_loss:0.0014234008267521858
The modified gen p mean: 0.44617459177970886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027683885768055916, decouple_loss:0.0011602233862504363
Iteration: 3914, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44426631927490234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025322388857603073, decouple_loss:0.0014186488697305322
The modified gen p mean: 0.4449176490306854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02570977807044983, decouple_loss:0.001574939931742847
The modified gen p mean: 0.445600301027298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02534317411482334, decouple_loss:0.001339134993031621
Iteration: 3915, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44275927543640137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026353104040026665, decouple_loss:0.0012831639032810926
The modified gen p mean: 0.44239333271980286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028155222535133362, decouple_loss:0.0012925558257848024
The modified gen p mean: 0.443045437335968, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02716728113591671, decouple_loss:0.0013498151674866676
Iteration: 3916, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44403892755508423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026527900248765945, decouple_loss:0.001310281571932137
The modified gen p mean: 0.4437916576862335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02567457966506481, decouple_loss:0.0012521118624135852
The modified gen p mean: 0.4420837461948395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02744629606604576, decouple_loss:0.0012938756262883544
Iteration: 3917, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4418866038322449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027567913755774498, decouple_loss:0.0013706237077713013
The modified gen p mean: 0.44126206636428833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025100037455558777, decouple_loss:0.0013352773385122418
The modified gen p mean: 0.4414277970790863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02767338417470455, decouple_loss:0.0013866170775145292
Iteration: 3918, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44291558861732483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02590588480234146, decouple_loss:0.00127119361422956
The modified gen p mean: 0.44255104660987854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02680090256035328, decouple_loss:0.00134146842174232
The modified gen p mean: 0.4455460011959076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02587294951081276, decouple_loss:0.0014024858828634024
Iteration: 3919, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44756048917770386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025239108130335808, decouple_loss:0.0014512663474306464
The modified gen p mean: 0.443604052066803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027270354330539703, decouple_loss:0.0011333198053762317
The modified gen p mean: 0.4431893229484558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02672710455954075, decouple_loss:0.0012223976664245129
Iteration: 3920, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472261965274811, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026181573048233986, decouple_loss:0.001257330528460443
The modified gen p mean: 0.4492029845714569, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026231754571199417, decouple_loss:0.0012964624911546707
The modified gen p mean: 0.44862446188926697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02600398100912571, decouple_loss:0.0013152043102309108
2023-05-27 08:00:04 testing...
The modified gen p mean: 0.45250561833381653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032656773924827576, decouple_loss:0.0014707314549013972
The modified gen p mean: 0.4503937065601349, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032925743609666824, decouple_loss:0.0014047690201550722
The modified gen p mean: 0.4521462023258209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03426850587129593, decouple_loss:0.0014790123095735908
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03335624933242798, avg_mse: 0.04559415206313133
current test mse: 0.045594
Iteration: 3921, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44936403632164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0256465096026659, decouple_loss:0.0011965194717049599
The modified gen p mean: 0.4468816816806793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02709398977458477, decouple_loss:0.0012669638963416219
The modified gen p mean: 0.4487537741661072, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02576383948326111, decouple_loss:0.0011164633324369788
Iteration: 3922, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483524560928345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02528761699795723, decouple_loss:0.0014025975251570344
The modified gen p mean: 0.4488053619861603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026068758219480515, decouple_loss:0.001446192036382854
The modified gen p mean: 0.4463977515697479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026734357699751854, decouple_loss:0.0011990899220108986
Iteration: 3923, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447856605052948, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02737266756594181, decouple_loss:0.0013672338100150228
The modified gen p mean: 0.4477040767669678, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027577927336096764, decouple_loss:0.001290593994781375
The modified gen p mean: 0.4465681314468384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028069205582141876, decouple_loss:0.0013385011116042733
Iteration: 3924, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483129680156708, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026189154013991356, decouple_loss:0.0011739585315808654
The modified gen p mean: 0.44612351059913635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027294587343931198, decouple_loss:0.0012739612720906734
The modified gen p mean: 0.4489370584487915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02550661191344261, decouple_loss:0.0014309296384453773
Iteration: 3925, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44513949751853943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024793047457933426, decouple_loss:0.0012452746741473675
The modified gen p mean: 0.441206693649292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027647722512483597, decouple_loss:0.001443484565243125
The modified gen p mean: 0.44269058108329773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027477139607071877, decouple_loss:0.0012915279949083924
Iteration: 3926, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460102319717407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02557237446308136, decouple_loss:0.0013284120941534638
The modified gen p mean: 0.44077950716018677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025471191853284836, decouple_loss:0.0012548711383715272
The modified gen p mean: 0.4412158131599426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027610480785369873, decouple_loss:0.001313801622018218
Iteration: 3927, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4425013065338135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02510659582912922, decouple_loss:0.0012390163028612733
The modified gen p mean: 0.44209206104278564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025378206744790077, decouple_loss:0.0013547585112974048
The modified gen p mean: 0.4393964409828186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026988642290234566, decouple_loss:0.0012920579174533486
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr.npz
NaN value num: 0
Iteration: 3928, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443647563457489, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44058722257614136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02576591819524765, decouple_loss:0.0012231040745973587
loss_pred:0.026370815932750702, decouple_loss:0.0012553943088278174
The modified gen p mean: 0.4434836506843567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0251338891685009, decouple_loss:0.0013088793493807316
Iteration: 3929, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44109299778938293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025306763127446175, decouple_loss:0.0013135477202013135
The modified gen p mean: 0.44228196144104004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02626895159482956, decouple_loss:0.0012677883496508002
The modified gen p mean: 0.4407649338245392, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025770191103219986, decouple_loss:0.0011397241614758968
Iteration: 3930, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44425350427627563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02608172409236431, decouple_loss:0.0011207630159333348
The modified gen p mean: 0.44279590249061584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027115244418382645, decouple_loss:0.0011780626373365521
The modified gen p mean: 0.44684895873069763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025288674980401993, decouple_loss:0.0012586441589519382
2023-05-27 08:04:51 testing...
The modified gen p mean: 0.45314693450927734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032493121922016144, decouple_loss:0.0014052235055714846
The modified gen p mean: 0.4509851038455963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032803118228912354, decouple_loss:0.0013479855842888355
The modified gen p mean: 0.4528138041496277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03422878310084343, decouple_loss:0.0014473531628027558
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0332450196146965, avg_mse: 0.0454716719686985
current test mse: 0.045472
Iteration: 3931, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44617876410484314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02657775953412056, decouple_loss:0.0012162430211901665
The modified gen p mean: 0.44544556736946106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02644287794828415, decouple_loss:0.0011928500607609749
The modified gen p mean: 0.4497368633747101, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02571682073175907, decouple_loss:0.0012604461517184973
Iteration: 3932, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45109686255455017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026037318632006645, decouple_loss:0.0011855335906147957
The modified gen p mean: 0.4556131660938263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025480207055807114, decouple_loss:0.0013629983877763152
The modified gen p mean: 0.44986143708229065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025437042117118835, decouple_loss:0.0012478017015382648
Iteration: 3933, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45114633440971375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0267516877502203, decouple_loss:0.0011206442723050714
The modified gen p mean: 0.45412641763687134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025158051401376724, decouple_loss:0.0012709615984931588
The modified gen p mean: 0.4487825930118561, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026359913870692253, decouple_loss:0.0011231951648369431
Iteration: 3934, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497029185295105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026597322896122932, decouple_loss:0.0011696554720401764
The modified gen p mean: 0.4515823423862457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026159804314374924, decouple_loss:0.0012656336184591055
The modified gen p mean: 0.4500850737094879, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026920372620224953, decouple_loss:0.0012401246931403875
Iteration: 3935, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507685899734497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027534792199730873, decouple_loss:0.0012048021890223026
The modified gen p mean: 0.44838622212409973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02744350954890251, decouple_loss:0.0011630525114014745
The modified gen p mean: 0.4532657563686371, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025266526266932487, decouple_loss:0.0012587002711370587
Iteration: 3936, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484948217868805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025381000712513924, decouple_loss:0.0012789538595825434
The modified gen p mean: 0.44585540890693665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026617633178830147, decouple_loss:0.0011357067851349711
The modified gen p mean: 0.44615402817726135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02599281631410122, decouple_loss:0.0011109740007668734
Iteration: 3937, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44819843769073486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025082042440772057, decouple_loss:0.0013624350540339947
The modified gen p mean: 0.44686606526374817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0258163008838892, decouple_loss:0.0011999155394732952
The modified gen p mean: 0.4459831416606903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02759379707276821, decouple_loss:0.0012635171879082918
Iteration: 3938, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44221898913383484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02607456035912037, decouple_loss:0.0012611171696335077
The modified gen p mean: 0.442532479763031, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026560155674815178, decouple_loss:0.0011713252170011401
The modified gen p mean: 0.445627361536026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025197505950927734, decouple_loss:0.0014474508352577686
Iteration: 3939, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44436731934547424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02541116066277027, decouple_loss:0.0012170433765277267
The modified gen p mean: 0.4434458911418915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025306418538093567, decouple_loss:0.0012974513228982687
The modified gen p mean: 0.44186609983444214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027438649907708168, decouple_loss:0.0012524721678346395
Iteration: 3940, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4420584440231323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02727244794368744, decouple_loss:0.001158383209258318
The modified gen p mean: 0.4430828392505646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02632157877087593, decouple_loss:0.0011842033127322793
The modified gen p mean: 0.4439306855201721, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025712937116622925, decouple_loss:0.001332818646915257
2023-05-27 08:08:58 testing...
The modified gen p mean: 0.4495202600955963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03237945958971977, decouple_loss:0.0014558453112840652
The modified gen p mean: 0.44730710983276367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03293401747941971, decouple_loss:0.0013748409692198038
The modified gen p mean: 0.44924747943878174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03420945629477501, decouple_loss:0.0015828852774575353
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033247873187065125, avg_mse: 0.045480240136384964
current test mse: 0.04548
Iteration: 3941, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4423416554927826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027058251202106476, decouple_loss:0.0011659212177619338
The modified gen p mean: 0.4473956227302551, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025232644751667976, decouple_loss:0.0012930950615555048
The modified gen p mean: 0.4449443519115448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026028603315353394, decouple_loss:0.0013692606007680297
Iteration: 3942, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444699764251709, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02609839104115963, decouple_loss:0.0012070616940036416
The modified gen p mean: 0.4474931061267853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02567610703408718, decouple_loss:0.0012695194454863667
The modified gen p mean: 0.44356024265289307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026524359360337257, decouple_loss:0.0012068815995007753
Iteration: 3943, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514467418193817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025114631280303, decouple_loss:0.0013544749235734344
The modified gen p mean: 0.44850271940231323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025400521233677864, decouple_loss:0.001269129803404212
The modified gen p mean: 0.44435977935791016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026089802384376526, decouple_loss:0.0011910544708371162
Iteration: 3944, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478932321071625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025166474282741547, decouple_loss:0.0012704464606940746
The modified gen p mean: 0.4450942575931549, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02608238160610199, decouple_loss:0.0011634617112576962
The modified gen p mean: 0.4457073509693146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02618221566081047, decouple_loss:0.0012051028897985816
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr.npz
NaN value num: 0
Iteration: 3945, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492838680744171, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026524201035499573, decouple_loss:0.0014318203320726752
The modified gen p mean: 0.4465675354003906, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44756409525871277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027388805523514748, decouple_loss:0.0013798496220260859loss_pred:0.02600274235010147, decouple_loss:0.0012450894573703408
Iteration: 3946, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44709649682044983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026637550443410873, decouple_loss:0.0012488478096202016
The modified gen p mean: 0.450030654668808, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026867326349020004, decouple_loss:0.0012861862778663635
The modified gen p mean: 0.44912177324295044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02648831531405449, decouple_loss:0.0013763606548309326
Iteration: 3947, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468812942504883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02688915841281414, decouple_loss:0.0012582667404785752
The modified gen p mean: 0.4466207027435303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026724010705947876, decouple_loss:0.0013900019694119692
The modified gen p mean: 0.44916385412216187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026467464864253998, decouple_loss:0.0013890741392970085
Iteration: 3948, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44609877467155457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026960205286741257, decouple_loss:0.001373459817841649
The modified gen p mean: 0.4518733024597168, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02472938969731331, decouple_loss:0.0011904468992725015
The modified gen p mean: 0.446422278881073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024398228153586388, decouple_loss:0.0011971918866038322
Iteration: 3949, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486446976661682, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02506345883011818, decouple_loss:0.0012789438478648663
The modified gen p mean: 0.4452836215496063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027419907972216606, decouple_loss:0.0013477191096171737
The modified gen p mean: 0.4456552565097809, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027132293209433556, decouple_loss:0.0011706766672432423
Iteration: 3950, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44606682658195496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026804259046912193, decouple_loss:0.0012810357147827744
The modified gen p mean: 0.44850462675094604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025861622765660286, decouple_loss:0.0012125945650041103
The modified gen p mean: 0.4483845829963684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02626991644501686, decouple_loss:0.0012708607828244567
2023-05-27 08:13:46 testing...
The modified gen p mean: 0.45309925079345703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03229460492730141, decouple_loss:0.001391598372720182
The modified gen p mean: 0.4510018229484558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283808007836342, decouple_loss:0.001333724008873105
The modified gen p mean: 0.4529748558998108, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03412618115544319, decouple_loss:0.0014772792346775532
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03315633535385132, avg_mse: 0.04531057924032211
current test mse: 0.045311
Iteration: 3951, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474150538444519, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026885831728577614, decouple_loss:0.0011996522080153227
The modified gen p mean: 0.4517085552215576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025329511612653732, decouple_loss:0.0011135137174278498
The modified gen p mean: 0.4491276443004608, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0258562620729208, decouple_loss:0.001374405575916171
Iteration: 3952, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45256200432777405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02618040144443512, decouple_loss:0.0013437566813081503
The modified gen p mean: 0.44902586936950684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025900445878505707, decouple_loss:0.001351257087662816
The modified gen p mean: 0.4475933313369751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027409575879573822, decouple_loss:0.0012669622665271163
Iteration: 3953, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514118731021881, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025432322174310684, decouple_loss:0.0013120074290782213
The modified gen p mean: 0.4465945363044739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026462852954864502, decouple_loss:0.00128435087390244
The modified gen p mean: 0.4475650191307068, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026476245373487473, decouple_loss:0.0012872045626863837
Iteration: 3954, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450818806886673, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4526442885398865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02593863382935524, decouple_loss:0.0012402202701196074
loss_pred:0.02525375969707966, decouple_loss:0.0013193640625104308
The modified gen p mean: 0.45114603638648987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025701694190502167, decouple_loss:0.0012236201437190175
Iteration: 3955, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44907861948013306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02628980204463005, decouple_loss:0.0012952876277267933
The modified gen p mean: 0.4540599584579468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02478906512260437, decouple_loss:0.00118206103798002
The modified gen p mean: 0.44907358288764954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02737027406692505, decouple_loss:0.0012252172455191612
Iteration: 3956, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476405382156372, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0242579597979784, decouple_loss:0.0012815720401704311
The modified gen p mean: 0.447009801864624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026775583624839783, decouple_loss:0.0013189191231504083
The modified gen p mean: 0.44701507687568665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026887252926826477, decouple_loss:0.0012384250294417143
Iteration: 3957, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496861696243286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02487720362842083, decouple_loss:0.0014889914309605956
The modified gen p mean: 0.44964319467544556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024096345528960228, decouple_loss:0.0011912439949810505
The modified gen p mean: 0.4504810571670532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025853769853711128, decouple_loss:0.0013708474580198526
Iteration: 3958, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510610103607178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026120230555534363, decouple_loss:0.0012812224449589849
The modified gen p mean: 0.4529762864112854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025923576205968857, decouple_loss:0.0012077534338459373
The modified gen p mean: 0.4505198299884796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025868838652968407, decouple_loss:0.001456101075746119
Iteration: 3959, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515639543533325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025570793077349663, decouple_loss:0.0012534287525340915
The modified gen p mean: 0.44957244396209717, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026265418156981468, decouple_loss:0.0014052042970433831
The modified gen p mean: 0.44833093881607056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027046995237469673, decouple_loss:0.0012773326598107815
Iteration: 3960, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44919461011886597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026969095692038536, decouple_loss:0.0013793372781947255
The modified gen p mean: 0.4516787827014923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024947915226221085, decouple_loss:0.0012061645975336432
The modified gen p mean: 0.45071113109588623, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025946078822016716, decouple_loss:0.0011278938036412
2023-05-27 08:17:51 testing...
The modified gen p mean: 0.45403096079826355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032295070588588715, decouple_loss:0.0013843689812347293
The modified gen p mean: 0.4517975151538849, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03292471170425415, decouple_loss:0.001302684540860355
The modified gen p mean: 0.4538924992084503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034188367426395416, decouple_loss:0.0014397469349205494
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033204831182956696, avg_mse: 0.04542030021548271
current test mse: 0.04542
Iteration: 3961, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44790080189704895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026823703199625015, decouple_loss:0.0012675218749791384
The modified gen p mean: 0.45343998074531555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024200409650802612, decouple_loss:0.0011807974660769105
The modified gen p mean: 0.44954609870910645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02620534598827362, decouple_loss:0.001283943885937333
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3962, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478735029697418, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028200974687933922, decouple_loss:0.0013703310396522284
The modified gen p mean: 0.45152145624160767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026787780225276947, decouple_loss:0.001472986419685185
The modified gen p mean: 0.451116681098938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026707299053668976, decouple_loss:0.0013717678375542164
Iteration: 3963, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464198350906372, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027266906574368477, decouple_loss:0.0011610225774347782
The modified gen p mean: 0.44652941823005676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028279263526201248, decouple_loss:0.001234253402799368
The modified gen p mean: 0.4501569867134094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02645030803978443, decouple_loss:0.001202309038490057
Iteration: 3964, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480256736278534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028529534116387367, decouple_loss:0.0013576754136011004
The modified gen p mean: 0.45013710856437683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02731895074248314, decouple_loss:0.0013846094952896237
The modified gen p mean: 0.4492906630039215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027146847918629646, decouple_loss:0.0012042551534250379
Iteration: 3965, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479784667491913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026754992082715034, decouple_loss:0.001268142950721085
The modified gen p mean: 0.44919779896736145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690546214580536, decouple_loss:0.0013597756624221802
The modified gen p mean: 0.4491684138774872, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027337582781910896, decouple_loss:0.0012998721795156598
Iteration: 3966, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44660934805870056, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44225701689720154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028547419235110283, decouple_loss:0.0013072079746052623
loss_pred:0.028995735570788383, decouple_loss:0.00135006511118263
The modified gen p mean: 0.4454396963119507, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02886282652616501, decouple_loss:0.0012609472032636404
Iteration: 3967, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445823609828949, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028095846995711327, decouple_loss:0.0012924167094752192
The modified gen p mean: 0.4452219009399414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02769891731441021, decouple_loss:0.0012717280769720674
The modified gen p mean: 0.44514015316963196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026832766830921173, decouple_loss:0.0013175945496186614
Iteration: 3968, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450041353702545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026211922988295555, decouple_loss:0.0013287975452840328
The modified gen p mean: 0.44650837779045105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027821596711874008, decouple_loss:0.001310015912167728
The modified gen p mean: 0.4450840651988983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027743304148316383, decouple_loss:0.0013990337029099464
Iteration: 3969, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476434290409088, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026952477172017097, decouple_loss:0.00128453248180449
The modified gen p mean: 0.44596877694129944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02674730494618416, decouple_loss:0.0013147075660526752
The modified gen p mean: 0.44210678339004517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027514828369021416, decouple_loss:0.0013625400606542826
Iteration: 3970, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.442898690700531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02784717082977295, decouple_loss:0.0012538708979263902
The modified gen p mean: 0.44416603446006775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673361636698246, decouple_loss:0.0014089233009144664
The modified gen p mean: 0.44635695219039917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026247814297676086, decouple_loss:0.001284128287807107
2023-05-27 08:22:42 testing...
The modified gen p mean: 0.448456346988678, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03268580138683319, decouple_loss:0.0014690865064039826
The modified gen p mean: 0.4462277889251709, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033089496195316315, decouple_loss:0.001491302507929504
The modified gen p mean: 0.4481865167617798, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034352101385593414, decouple_loss:0.0014781707432121038
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03344977647066116, avg_mse: 0.04571806266903877
current test mse: 0.045718
Iteration: 3971, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4433833360671997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0286840982735157, decouple_loss:0.001352377817966044
The modified gen p mean: 0.4475058913230896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026804592460393906, decouple_loss:0.0012352048652246594
The modified gen p mean: 0.446840763092041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025775106623768806, decouple_loss:0.0012917669955641031
Iteration: 3972, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44767653942108154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026688523590564728, decouple_loss:0.0014364308444783092
The modified gen p mean: 0.44440343976020813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02702310122549534, decouple_loss:0.0012520866002887487
The modified gen p mean: 0.4479552209377289, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027864016592502594, decouple_loss:0.0013878790196031332
Iteration: 3973, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45226162672042847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027988262474536896, decouple_loss:0.0013410523533821106
The modified gen p mean: 0.44620558619499207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027078131213784218, decouple_loss:0.001263948855921626
The modified gen p mean: 0.4438289701938629, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026946265250444412, decouple_loss:0.0011847997084259987
Iteration: 3974, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44903436303138733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025950491428375244, decouple_loss:0.0011799554340541363
The modified gen p mean: 0.4501207768917084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026210088282823563, decouple_loss:0.001365123549476266
The modified gen p mean: 0.44546782970428467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02707381173968315, decouple_loss:0.0011599189601838589
Iteration: 3975, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45026353001594543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02595456875860691, decouple_loss:0.0014824426034465432
The modified gen p mean: 0.44722309708595276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026786984875798225, decouple_loss:0.0012547329533845186
The modified gen p mean: 0.45067262649536133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02531093917787075, decouple_loss:0.001362056820653379
Iteration: 3976, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44959595799446106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026581253856420517, decouple_loss:0.0013154695043340325
The modified gen p mean: 0.44868066906929016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027044523507356644, decouple_loss:0.0012184034567326307
The modified gen p mean: 0.44771426916122437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02784797176718712, decouple_loss:0.001356345135718584
Iteration: 3977, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45064777135849, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02587527222931385, decouple_loss:0.001397419604472816
The modified gen p mean: 0.4468509256839752, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027389274910092354, decouple_loss:0.0013358191354200244
The modified gen p mean: 0.4496670067310333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026283541694283485, decouple_loss:0.001540454337373376
Iteration: 3978, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465891420841217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028309712186455727, decouple_loss:0.0012865433236584067
The modified gen p mean: 0.4488685131072998, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02760505862534046, decouple_loss:0.0013980951625853777
The modified gen p mean: 0.4450071454048157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02878345362842083, decouple_loss:0.0013680392876267433
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr.npz
NaN value num: 0
Iteration: 3979, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488319754600525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0257134810090065, decouple_loss:0.0013640716206282377
The modified gen p mean: 0.4478072226047516, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44745367765426636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025387311354279518, decouple_loss:0.001320434850640595loss_pred:0.027419043704867363, decouple_loss:0.0014171537477523088
Iteration: 3980, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44718754291534424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025365501642227173, decouple_loss:0.001482427935115993
The modified gen p mean: 0.4452723562717438, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026359738782048225, decouple_loss:0.0013139358488842845
The modified gen p mean: 0.44315430521965027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028116442263126373, decouple_loss:0.001357232453301549
2023-05-27 08:27:46 testing...
The modified gen p mean: 0.45099908113479614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03281958028674126, decouple_loss:0.0013996646739542484
The modified gen p mean: 0.4506320655345917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034547485411167145, decouple_loss:0.0014767729444429278
The modified gen p mean: 0.44882670044898987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03323374316096306, decouple_loss:0.0014679607702419162
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03360600769519806, avg_mse: 0.04602886736392975
current test mse: 0.046029
Iteration: 3981, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44452735781669617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02681565098464489, decouple_loss:0.0012469775974750519
The modified gen p mean: 0.4446808099746704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025777606293559074, decouple_loss:0.001274330890737474
The modified gen p mean: 0.4442910850048065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02648777700960636, decouple_loss:0.0011750856647267938
Iteration: 3982, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488511085510254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027119718492031097, decouple_loss:0.001309167593717575
The modified gen p mean: 0.4494553804397583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02542843669652939, decouple_loss:0.001261166064068675
The modified gen p mean: 0.44567808508872986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02530701458454132, decouple_loss:0.0012117710430175066
Iteration: 3983, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490513801574707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024943746626377106, decouple_loss:0.0013064057566225529
The modified gen p mean: 0.44615811109542847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026538174599409103, decouple_loss:0.0011964694131165743
The modified gen p mean: 0.44769254326820374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025216862559318542, decouple_loss:0.001356953987851739
Iteration: 3984, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504469633102417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02559155784547329, decouple_loss:0.001211076625622809
The modified gen p mean: 0.44730493426322937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02480235882103443, decouple_loss:0.001174474018625915
The modified gen p mean: 0.44730204343795776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027369815856218338, decouple_loss:0.0013490513665601611
Iteration: 3985, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44802796840667725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027614671736955643, decouple_loss:0.001338945934548974
The modified gen p mean: 0.4491325616836548, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026153359562158585, decouple_loss:0.0012080675223842263
The modified gen p mean: 0.44867411255836487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02801215834915638, decouple_loss:0.0012905045878142118
Iteration: 3986, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489358365535736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024968283250927925, decouple_loss:0.001326098688878119
The modified gen p mean: 0.4488605260848999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02412586472928524, decouple_loss:0.0013115936890244484
The modified gen p mean: 0.4489437937736511, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026943055912852287, decouple_loss:0.0012415200471878052
Iteration: 3987, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449384868144989, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025878051295876503, decouple_loss:0.0012716051423922181
The modified gen p mean: 0.4474039673805237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02660885453224182, decouple_loss:0.001280244905501604
The modified gen p mean: 0.45249974727630615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026041941717267036, decouple_loss:0.0012176444288343191
Iteration: 3988, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468860328197479, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4523863196372986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027039188891649246, decouple_loss:0.001203530584461987
loss_pred:0.02447550557553768, decouple_loss:0.001286915736272931
The modified gen p mean: 0.44770750403404236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026347128674387932, decouple_loss:0.0012143409112468362
Iteration: 3989, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471965432167053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025201886892318726, decouple_loss:0.00120839336887002
The modified gen p mean: 0.4506923258304596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02660146914422512, decouple_loss:0.0013060657074674964
The modified gen p mean: 0.44565248489379883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025451844558119774, decouple_loss:0.0012004259042441845
Iteration: 3990, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44710877537727356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026003822684288025, decouple_loss:0.0013218425447121263
The modified gen p mean: 0.44205406308174133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027507491409778595, decouple_loss:0.0013939534546807408
The modified gen p mean: 0.44441986083984375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02721652016043663, decouple_loss:0.00129710731562227
2023-05-27 08:31:52 testing...
The modified gen p mean: 0.44946783781051636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03255252167582512, decouple_loss:0.001429994823411107
The modified gen p mean: 0.44746118783950806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03296202793717384, decouple_loss:0.001447726390324533
The modified gen p mean: 0.44901618361473083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03426603227853775, decouple_loss:0.0014470339519903064
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03333227336406708, avg_mse: 0.04564551264047623
current test mse: 0.045646
Iteration: 3991, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445038437843323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024683753028512, decouple_loss:0.0012492187088355422
The modified gen p mean: 0.4421318471431732, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02625175379216671, decouple_loss:0.0012613056460395455
The modified gen p mean: 0.446516215801239, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027020050212740898, decouple_loss:0.0011835376499220729
Iteration: 3992, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44500842690467834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026005063205957413, decouple_loss:0.001248973305337131
The modified gen p mean: 0.4437631666660309, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02685948647558689, decouple_loss:0.001262277946807444
The modified gen p mean: 0.4434830844402313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026189347729086876, decouple_loss:0.0012100780149921775
Iteration: 3993, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487750232219696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025389375165104866, decouple_loss:0.0013706908794119954
The modified gen p mean: 0.44850608706474304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02635398879647255, decouple_loss:0.001346277422271669
The modified gen p mean: 0.4463333189487457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026264041662216187, decouple_loss:0.0013690522173419595
Iteration: 3994, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4511852562427521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025102069601416588, decouple_loss:0.0013516107574105263
The modified gen p mean: 0.4487640857696533, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025567831471562386, decouple_loss:0.0013374912086874247
The modified gen p mean: 0.44530680775642395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02529616840183735, decouple_loss:0.0012061018496751785
Iteration: 3995, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44841131567955017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025756530463695526, decouple_loss:0.0012910052901133895
The modified gen p mean: 0.45060914754867554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02634836919605732, decouple_loss:0.0012892853701487184
The modified gen p mean: 0.4497975707054138, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024008721113204956, decouple_loss:0.001217727200128138
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr_shift3.npz
NaN value num: 0
Iteration: 3996, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45090487599372864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025397833436727524, decouple_loss:0.0014302295166999102
The modified gen p mean: 0.4516950249671936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025988882407546043, decouple_loss:0.0012453290401026607
The modified gen p mean: 0.450472354888916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026736415922641754, decouple_loss:0.0012195251183584332
Iteration: 3997, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.454291969537735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02641294337809086, decouple_loss:0.0013107674894854426
The modified gen p mean: 0.4506314992904663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02572079561650753, decouple_loss:0.0012342962436378002
The modified gen p mean: 0.4511958956718445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025925474241375923, decouple_loss:0.001178956707008183
Iteration: 3998, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45162439346313477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026653625071048737, decouple_loss:0.0011303406208753586
The modified gen p mean: 0.4485274851322174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027272583916783333, decouple_loss:0.0012597044697031379
The modified gen p mean: 0.44776856899261475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027711473405361176, decouple_loss:0.001292425673455
Iteration: 3999, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499119222164154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02751314453780651, decouple_loss:0.0012299055233597755
The modified gen p mean: 0.4546615481376648, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026346320286393166, decouple_loss:0.0012081075692549348
The modified gen p mean: 0.447294682264328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027080530300736427, decouple_loss:0.001368984580039978
Iteration: 4000, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44904208183288574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026392869651317596, decouple_loss:0.0013187777949497104
The modified gen p mean: 0.4461129903793335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02748386189341545, decouple_loss:0.0012037650449201465
The modified gen p mean: 0.4475780129432678, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027120303362607956, decouple_loss:0.0011123730801045895
save model to /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_1_PC_0_EH_0_PS_40_6hrs/model_4000.ckpt
2023-05-27 08:37:02 testing...
The modified gen p mean: 0.4544326364994049, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03247644752264023, decouple_loss:0.0013904492370784283
The modified gen p mean: 0.45242321491241455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032806988805532455, decouple_loss:0.0013298800913617015
The modified gen p mean: 0.4540412425994873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034164976328611374, decouple_loss:0.0014739331090822816
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03321937471628189, avg_mse: 0.045431628823280334
current test mse: 0.045432
Iteration: 4001, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477689564228058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027394974604249, decouple_loss:0.001132433069869876
The modified gen p mean: 0.4507918357849121, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025678575038909912, decouple_loss:0.0012364995200186968
The modified gen p mean: 0.45261383056640625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025598058477044106, decouple_loss:0.0013635634677484632
Iteration: 4002, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44499823451042175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027739645913243294, decouple_loss:0.0013534133322536945
The modified gen p mean: 0.4481440782546997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02586396411061287, decouple_loss:0.0012558642774820328
The modified gen p mean: 0.4463651180267334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02664181776344776, decouple_loss:0.001206143293529749
Iteration: 4003, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44713860750198364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02679617702960968, decouple_loss:0.0013835692079737782
The modified gen p mean: 0.44893941283226013, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024942949414253235, decouple_loss:0.0014428581343963742
The modified gen p mean: 0.44608190655708313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027514249086380005, decouple_loss:0.001442912151105702
Iteration: 4004, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44546931982040405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026677733287215233, decouple_loss:0.001371001242659986
The modified gen p mean: 0.44958770275115967, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026777654886245728, decouple_loss:0.00128159299492836
The modified gen p mean: 0.4464307129383087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02735873870551586, decouple_loss:0.0013211206533014774
Iteration: 4005, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44419723749160767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026065092533826828, decouple_loss:0.0013616846408694983
The modified gen p mean: 0.4434889256954193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02730420045554638, decouple_loss:0.0012744892155751586
The modified gen p mean: 0.44932493567466736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02540126070380211, decouple_loss:0.0015828736359253526
Iteration: 4006, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44522321224212646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02674183063209057, decouple_loss:0.0012773395283147693
The modified gen p mean: 0.44262266159057617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02644999325275421, decouple_loss:0.001241631805896759
The modified gen p mean: 0.4454362988471985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026333827525377274, decouple_loss:0.0014318997273221612
Iteration: 4007, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470351040363312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02619035355746746, decouple_loss:0.0012498429277911782
The modified gen p mean: 0.4476296305656433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024984369054436684, decouple_loss:0.0014691969845443964
The modified gen p mean: 0.44830000400543213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025662750005722046, decouple_loss:0.0012193233706057072
Iteration: 4008, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497630000114441, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024834562093019485, decouple_loss:0.0013167288852855563
The modified gen p mean: 0.4476192593574524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024334730580449104, decouple_loss:0.0014011001912876964
The modified gen p mean: 0.4447500705718994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02672986499965191, decouple_loss:0.00132090097758919
Iteration: 4009, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44542667269706726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026523498818278313, decouple_loss:0.0012915387051180005
The modified gen p mean: 0.4466615617275238, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027622109279036522, decouple_loss:0.0012326906435191631
The modified gen p mean: 0.4458799660205841, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026872633025050163, decouple_loss:0.0013663358986377716
Iteration: 4010, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45097261667251587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025040913373231888, decouple_loss:0.0012525877682492137
The modified gen p mean: 0.4480106830596924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026191797107458115, decouple_loss:0.0014169163769111037
The modified gen p mean: 0.45021021366119385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02595662698149681, decouple_loss:0.00130939157679677
2023-05-27 08:41:09 testing...
The modified gen p mean: 0.45332708954811096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032750148326158524, decouple_loss:0.0014475159114226699
The modified gen p mean: 0.4511423707008362, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033128853887319565, decouple_loss:0.001443681656382978
The modified gen p mean: 0.452873557806015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034438442438840866, decouple_loss:0.0015138544840738177
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03351256996393204, avg_mse: 0.04591316729784012
current test mse: 0.045913
Iteration: 4011, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491133391857147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02490091696381569, decouple_loss:0.001289976411499083
The modified gen p mean: 0.44801706075668335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027870167046785355, decouple_loss:0.0013551810989156365
The modified gen p mean: 0.4469676613807678, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0267024002969265, decouple_loss:0.0011994028463959694
Iteration: 4012, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497146010398865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026034412905573845, decouple_loss:0.001316290465183556
The modified gen p mean: 0.4459606111049652, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027405908331274986, decouple_loss:0.0011895260540768504
The modified gen p mean: 0.44507837295532227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027580665424466133, decouple_loss:0.0012555565917864442
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4013, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504859447479248, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028839092701673508, decouple_loss:0.0013023180654272437
The modified gen p mean: 0.44985660910606384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028653787449002266, decouple_loss:0.0013782018795609474
The modified gen p mean: 0.4472995102405548, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02929515205323696, decouple_loss:0.0012368776369839907
Iteration: 4014, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484160840511322, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4474022090435028, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02989943139255047, decouple_loss:0.001301343785598874
loss_pred:0.028593596071004868, decouple_loss:0.0013216828228905797
The modified gen p mean: 0.44898223876953125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03039119578897953, decouple_loss:0.0013926548417657614
Iteration: 4015, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44789254665374756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030462250113487244, decouple_loss:0.0012232839362695813
The modified gen p mean: 0.4525044858455658, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02755405381321907, decouple_loss:0.0013919285265728831
The modified gen p mean: 0.4482663869857788, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03107810765504837, decouple_loss:0.0012886574259027839
Iteration: 4016, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493262469768524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031682755798101425, decouple_loss:0.0014194597024470568
The modified gen p mean: 0.44927409291267395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02928820066154003, decouple_loss:0.0013031942071393132
The modified gen p mean: 0.45072558522224426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0297747440636158, decouple_loss:0.0012510878732427955
Iteration: 4017, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44943517446517944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030811039730906487, decouple_loss:0.001241481862962246
The modified gen p mean: 0.4508228003978729, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02945861965417862, decouple_loss:0.0012413966469466686
The modified gen p mean: 0.4497027099132538, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02918364480137825, decouple_loss:0.0013431368861347437
Iteration: 4018, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44962233304977417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029521720483899117, decouple_loss:0.0013820127351209521
The modified gen p mean: 0.4522077739238739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028563424944877625, decouple_loss:0.0013994484907016158
The modified gen p mean: 0.4517785310745239, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028540747240185738, decouple_loss:0.0013815920101478696
Iteration: 4019, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497533440589905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028832213953137398, decouple_loss:0.0013921239878982306
The modified gen p mean: 0.4506845772266388, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029737012460827827, decouple_loss:0.0012149926042184234
The modified gen p mean: 0.4487092196941376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02911379747092724, decouple_loss:0.0013641235418617725
Iteration: 4020, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452019929885864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029261592775583267, decouple_loss:0.0012087024515494704
The modified gen p mean: 0.45061901211738586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029085299000144005, decouple_loss:0.0013523935340344906
The modified gen p mean: 0.44976574182510376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027979979291558266, decouple_loss:0.0012976372381672263
2023-05-27 08:45:51 testing...
The modified gen p mean: 0.4496936500072479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03248657286167145, decouple_loss:0.0015519282314926386
The modified gen p mean: 0.44745543599128723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0328553281724453, decouple_loss:0.0014485407155007124
The modified gen p mean: 0.4491327404975891, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034207794815301895, decouple_loss:0.0015058013377711177
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033258337527513504, avg_mse: 0.04529810696840286
current test mse: 0.045298
Iteration: 4021, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44450387358665466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031076084822416306, decouple_loss:0.001378508866764605
The modified gen p mean: 0.4475873112678528, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03043723851442337, decouple_loss:0.0014125000452622771
The modified gen p mean: 0.44580772519111633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029808180406689644, decouple_loss:0.0012423547450453043
Iteration: 4022, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44477277994155884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028958439826965332, decouple_loss:0.0015816757222637534
The modified gen p mean: 0.4473018944263458, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029047541320323944, decouple_loss:0.0014287092490121722
The modified gen p mean: 0.44607701897621155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02974572777748108, decouple_loss:0.001294900313951075
Iteration: 4023, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44685688614845276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03054278902709484, decouple_loss:0.0012466140324249864
The modified gen p mean: 0.4454851448535919, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029312781989574432, decouple_loss:0.0013027340173721313
The modified gen p mean: 0.44273680448532104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02966701239347458, decouple_loss:0.0013305761385709047
Iteration: 4024, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506611227989197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028855454176664352, decouple_loss:0.0014970737975090742
The modified gen p mean: 0.4493163526058197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027567369863390923, decouple_loss:0.0014214834664016962
The modified gen p mean: 0.44633015990257263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030185332521796227, decouple_loss:0.001238014199770987
Iteration: 4025, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45063483715057373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029491601511836052, decouple_loss:0.0013570260489359498
The modified gen p mean: 0.4511927366256714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029939046129584312, decouple_loss:0.0013016563607379794
The modified gen p mean: 0.4492141306400299, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028375141322612762, decouple_loss:0.0016453634016215801
Iteration: 4026, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4533044099807739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02865656092762947, decouple_loss:0.0013818431179970503
The modified gen p mean: 0.4532138407230377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029515333473682404, decouple_loss:0.0012195196468383074
The modified gen p mean: 0.4489958584308624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02990710735321045, decouple_loss:0.0013436904409900308
Iteration: 4027, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45110568404197693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030450832098722458, decouple_loss:0.0013055730378255248
The modified gen p mean: 0.45004895329475403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029152732342481613, decouple_loss:0.0012973824050277472
The modified gen p mean: 0.4529764950275421, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028240693733096123, decouple_loss:0.0012893310049548745
Iteration: 4028, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499099850654602, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029208486899733543, decouple_loss:0.0013629752211272717
The modified gen p mean: 0.4501982629299164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02898569591343403, decouple_loss:0.00141421752050519
The modified gen p mean: 0.4491109549999237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030123723670840263, decouple_loss:0.00150232610758394
Iteration: 4029, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44711700081825256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029055098071694374, decouple_loss:0.0012634915765374899
The modified gen p mean: 0.4471094012260437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030379122123122215, decouple_loss:0.0014011739986017346
The modified gen p mean: 0.4502270519733429, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029905125498771667, decouple_loss:0.001639150665141642
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr.npz
NaN value num: 0
Iteration: 4030, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44721662998199463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030174441635608673, decouple_loss:0.0014062377158552408
The modified gen p mean: 0.4458523392677307, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4480702877044678, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02994116023182869, decouple_loss:0.0014465022832155228loss_pred:0.028911247849464417, decouple_loss:0.0014998747501522303
2023-05-27 08:50:41 testing...
The modified gen p mean: 0.45134252309799194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03243916854262352, decouple_loss:0.00158958719111979
The modified gen p mean: 0.4492565989494324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03278021514415741, decouple_loss:0.0014852328458800912
The modified gen p mean: 0.45104238390922546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034173060208559036, decouple_loss:0.0015493595274165273
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033207885921001434, avg_mse: 0.04527224600315094
current test mse: 0.045272
Iteration: 4031, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4511003792285919, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028610415756702423, decouple_loss:0.0013429871760308743
The modified gen p mean: 0.4489345848560333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02948595955967903, decouple_loss:0.0013935731258243322
The modified gen p mean: 0.4497058093547821, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030399229377508163, decouple_loss:0.0015086126513779163
Iteration: 4032, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44757434725761414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03143056109547615, decouple_loss:0.0013222211273387074
The modified gen p mean: 0.44522446393966675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02963440679013729, decouple_loss:0.0014140353305265307
The modified gen p mean: 0.4494694173336029, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029746949672698975, decouple_loss:0.0014604077441617846
Iteration: 4033, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512364864349365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02807576395571232, decouple_loss:0.0014546287711709738
The modified gen p mean: 0.4489259719848633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030137697234749794, decouple_loss:0.0015809583710506558
The modified gen p mean: 0.44841450452804565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031575851142406464, decouple_loss:0.0015004154993221164
Iteration: 4034, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4529162645339966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029032878577709198, decouple_loss:0.0014612728264182806
The modified gen p mean: 0.4536030888557434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028558379039168358, decouple_loss:0.0015172987477853894
The modified gen p mean: 0.4507374167442322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028283217921853065, decouple_loss:0.0013036938617005944
Iteration: 4035, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4517453908920288, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029685495421290398, decouple_loss:0.0013851341791450977
The modified gen p mean: 0.4500112533569336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02982461266219616, decouple_loss:0.0013844090281054378
The modified gen p mean: 0.45445406436920166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027733340859413147, decouple_loss:0.0012566783698275685
Iteration: 4036, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45595017075538635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029333526268601418, decouple_loss:0.0014313675928860903
The modified gen p mean: 0.45115479826927185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03147654980421066, decouple_loss:0.0012702798703685403
The modified gen p mean: 0.4493156373500824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029423251748085022, decouple_loss:0.0012926228810101748
Iteration: 4037, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45685014128685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027439769357442856, decouple_loss:0.0014656931161880493
The modified gen p mean: 0.4531979262828827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029627470299601555, decouple_loss:0.001235859701409936
The modified gen p mean: 0.44955894351005554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03062143176794052, decouple_loss:0.0012410995550453663
Iteration: 4038, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4525283873081207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02805534563958645, decouple_loss:0.0012604804942384362
The modified gen p mean: 0.4540131092071533, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028073148801922798, decouple_loss:0.0012143254280090332
The modified gen p mean: 0.45323652029037476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029356325045228004, decouple_loss:0.0014105873415246606
Iteration: 4039, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502028524875641, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03049829974770546, decouple_loss:0.001357848523184657
The modified gen p mean: 0.4478791654109955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029433127492666245, decouple_loss:0.0013059393968433142
The modified gen p mean: 0.4499014914035797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02760208398103714, decouple_loss:0.0013368444051593542
Iteration: 4040, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447977215051651, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028743375092744827, decouple_loss:0.0013097526971250772
The modified gen p mean: 0.44649437069892883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029776927083730698, decouple_loss:0.0012744910782203078
The modified gen p mean: 0.44445958733558655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02979818731546402, decouple_loss:0.0013830553507432342
2023-05-27 08:54:50 testing...
The modified gen p mean: 0.44691556692123413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03220032900571823, decouple_loss:0.001374993473291397
The modified gen p mean: 0.44659119844436646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03415398299694061, decouple_loss:0.0014176189433783293
The modified gen p mean: 0.44463637471199036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03257657214999199, decouple_loss:0.001404498121701181
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0330469124019146, avg_mse: 0.0449625626206398
current test mse: 0.044963
Iteration: 4041, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459543228149414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030253160744905472, decouple_loss:0.0012762791011482477
The modified gen p mean: 0.4429818093776703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029921727254986763, decouple_loss:0.0013596783392131329
The modified gen p mean: 0.4466206431388855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029973695054650307, decouple_loss:0.0013267389731481671
Iteration: 4042, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464683532714844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028715109452605247, decouple_loss:0.001452558091841638
The modified gen p mean: 0.44080281257629395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030908063054084778, decouple_loss:0.0013457590248435736
The modified gen p mean: 0.44398272037506104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03004031628370285, decouple_loss:0.001400803099386394
Iteration: 4043, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44381824135780334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03087266907095909, decouple_loss:0.0013262686552479863
The modified gen p mean: 0.4435524642467499, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028774337843060493, decouple_loss:0.0012983601773157716
The modified gen p mean: 0.4440310597419739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028775697574019432, decouple_loss:0.0013049000408500433
Iteration: 4044, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44658052921295166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028690995648503304, decouple_loss:0.0013913431903347373
The modified gen p mean: 0.44395729899406433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029668672010302544, decouple_loss:0.0012386053567752242
The modified gen p mean: 0.44555237889289856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029795372858643532, decouple_loss:0.0013523061061277986
Iteration: 4045, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486163854598999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028894947841763496, decouple_loss:0.0011761147761717439
The modified gen p mean: 0.44878047704696655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029026346281170845, decouple_loss:0.0013993179891258478
The modified gen p mean: 0.4468854069709778, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030805451795458794, decouple_loss:0.0013133736792951822
Iteration: 4046, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44949114322662354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030044900253415108, decouple_loss:0.001440847641788423
The modified gen p mean: 0.4481731653213501, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03018178977072239, decouple_loss:0.001326369121670723
The modified gen p mean: 0.45245087146759033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02813705988228321, decouple_loss:0.0013343897880986333
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4047, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480923116207123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027987491339445114, decouple_loss:0.0011863684048876166
The modified gen p mean: 0.4522777795791626, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44884130358695984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027216119691729546, decouple_loss:0.0012406627647578716
loss_pred:0.02643376588821411, decouple_loss:0.0013581477105617523
Iteration: 4048, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44878730177879333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027250930666923523, decouple_loss:0.0012469690991565585
The modified gen p mean: 0.4548189342021942, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028553571552038193, decouple_loss:0.0015568473609164357
The modified gen p mean: 0.4540795385837555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02608385682106018, decouple_loss:0.001253681257367134
Iteration: 4049, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4517565071582794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027677446603775024, decouple_loss:0.0012494802940636873
The modified gen p mean: 0.44921785593032837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02763577736914158, decouple_loss:0.0013415708672255278
The modified gen p mean: 0.45120564103126526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02590813860297203, decouple_loss:0.0012652004370465875
Iteration: 4050, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44844114780426025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02859552763402462, decouple_loss:0.0012443888699635863
The modified gen p mean: 0.4476298391819, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027303827926516533, decouple_loss:0.0012747029541060328
The modified gen p mean: 0.4498688876628876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02596273273229599, decouple_loss:0.001344155054539442
2023-05-27 08:59:38 testing...
The modified gen p mean: 0.45065441727638245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03240440785884857, decouple_loss:0.0014069394674152136
The modified gen p mean: 0.4483563005924225, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4505174160003662, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03272552788257599, decouple_loss:0.0013613469200208783
loss_pred:0.034122247248888016, decouple_loss:0.0014063740381971002
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03315363824367523, avg_mse: 0.045158546417951584
current test mse: 0.045159
Iteration: 4051, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450862854719162, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02619701623916626, decouple_loss:0.0011709725949913263
The modified gen p mean: 0.45062148571014404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02847217582166195, decouple_loss:0.0012447041226550937
The modified gen p mean: 0.4456844627857208, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02785698138177395, decouple_loss:0.0012299445224925876
Iteration: 4052, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491063356399536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027539972215890884, decouple_loss:0.0012427542824298143
The modified gen p mean: 0.4466886818408966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026075702160596848, decouple_loss:0.0013321546139195561
The modified gen p mean: 0.4463549554347992, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026205027475953102, decouple_loss:0.0013405387289822102
Iteration: 4053, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44618356227874756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028683502227067947, decouple_loss:0.001252156449481845
The modified gen p mean: 0.4457823932170868, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02827203832566738, decouple_loss:0.0013327221386134624
The modified gen p mean: 0.4463713467121124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026586759835481644, decouple_loss:0.0013411992695182562
Iteration: 4054, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44743219017982483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02714596316218376, decouple_loss:0.0012783568818122149
The modified gen p mean: 0.4457870125770569, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028142420575022697, decouple_loss:0.001251779031008482
The modified gen p mean: 0.4446263313293457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027174698188900948, decouple_loss:0.0012266113189980388
Iteration: 4055, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44531649351119995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028389783576130867, decouple_loss:0.001358267036266625
The modified gen p mean: 0.44432470202445984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028343478217720985, decouple_loss:0.0012617040192708373
The modified gen p mean: 0.449077844619751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027971679344773293, decouple_loss:0.001357395201921463
Iteration: 4056, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44545018672943115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027623392641544342, decouple_loss:0.0012425142340362072
The modified gen p mean: 0.4471990168094635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02800561860203743, decouple_loss:0.0013573769247159362
The modified gen p mean: 0.4484466314315796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029010897502303123, decouple_loss:0.0013504816452041268
Iteration: 4057, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45449283719062805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027599534019827843, decouple_loss:0.0014772138092666864
The modified gen p mean: 0.44987213611602783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02719234861433506, decouple_loss:0.0012950421078130603
The modified gen p mean: 0.4521634578704834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026342807337641716, decouple_loss:0.0013999997172504663
Iteration: 4058, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4528311491012573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026390964165329933, decouple_loss:0.0013716521207243204
The modified gen p mean: 0.4537789523601532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025991326197981834, decouple_loss:0.0013719970593228936
The modified gen p mean: 0.45219552516937256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027069512754678726, decouple_loss:0.0012361517874523997
Iteration: 4059, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514439105987549, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4493418037891388, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027181804180145264, decouple_loss:0.0014569106278941035
loss_pred:0.02691955491900444, decouple_loss:0.001297049573622644
The modified gen p mean: 0.45493173599243164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027404453605413437, decouple_loss:0.0013773151440545917
Iteration: 4060, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44902530312538147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02809213474392891, decouple_loss:0.0012452227529138327
The modified gen p mean: 0.4529663026332855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02542019821703434, decouple_loss:0.0013265148736536503
The modified gen p mean: 0.4527651369571686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028141049668192863, decouple_loss:0.001334502943791449
2023-05-27 09:03:45 testing...
The modified gen p mean: 0.4543490707874298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032600194215774536, decouple_loss:0.001411930308677256
The modified gen p mean: 0.45220842957496643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0327337272465229, decouple_loss:0.0015430389903485775
The modified gen p mean: 0.45416703820228577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03412572294473648, decouple_loss:0.0014797885669395328
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03322712704539299, avg_mse: 0.04531402513384819
current test mse: 0.045314
Iteration: 4061, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4520411491394043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02581843174993992, decouple_loss:0.0014661462046205997
The modified gen p mean: 0.45090752840042114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028043702244758606, decouple_loss:0.0012913164682686329
The modified gen p mean: 0.4519413709640503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025526423007249832, decouple_loss:0.001343068084679544
Iteration: 4062, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469408690929413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027842354029417038, decouple_loss:0.0014190247748047113
The modified gen p mean: 0.4471057057380676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02674592100083828, decouple_loss:0.0012740150559693575
The modified gen p mean: 0.44590824842453003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027227668091654778, decouple_loss:0.0013244940200820565
Iteration: 4063, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447684645652771, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44818419218063354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027613217011094093, decouple_loss:0.001369683537632227
loss_pred:0.028608674183487892, decouple_loss:0.001368190161883831
The modified gen p mean: 0.44616830348968506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027962835505604744, decouple_loss:0.0012035364052280784
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4064, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500839412212372, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031460169702768326, decouple_loss:0.001349130179733038
The modified gen p mean: 0.4504348933696747, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44661885499954224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030143922194838524, decouple_loss:0.001244145561940968
loss_pred:0.02757171355187893, decouple_loss:0.001280614989809692
Iteration: 4065, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44716694951057434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02947120927274227, decouple_loss:0.001165235647931695
The modified gen p mean: 0.4503338038921356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03035314939916134, decouple_loss:0.0012253153836354613
The modified gen p mean: 0.4465934932231903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030284108594059944, decouple_loss:0.0012991115218028426
Iteration: 4066, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44729992747306824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028739789500832558, decouple_loss:0.0011849923757836223
The modified gen p mean: 0.452852338552475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029110072180628777, decouple_loss:0.0014353193109855056
The modified gen p mean: 0.44913148880004883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030079498887062073, decouple_loss:0.0011927953455597162
Iteration: 4067, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4532906711101532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02936404012143612, decouple_loss:0.0013683093711733818
The modified gen p mean: 0.4485289454460144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030157413333654404, decouple_loss:0.0011990852653980255
The modified gen p mean: 0.4529818296432495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028202660381793976, decouple_loss:0.001271516433916986
Iteration: 4068, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45092135667800903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02939060889184475, decouple_loss:0.001297641545534134
The modified gen p mean: 0.452788382768631, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028074471279978752, decouple_loss:0.0013670435873791575
The modified gen p mean: 0.4532986283302307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02873094193637371, decouple_loss:0.0012650449061766267
Iteration: 4069, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45020759105682373, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.452461838722229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029827430844306946, decouple_loss:0.0012020360445603728
loss_pred:0.029033005237579346, decouple_loss:0.0012012177612632513
The modified gen p mean: 0.4548909366130829, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029501061886548996, decouple_loss:0.0014193970710039139
Iteration: 4070, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514405131340027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02848251722753048, decouple_loss:0.0012306086719036102
The modified gen p mean: 0.4495531916618347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029687250033020973, decouple_loss:0.0011726559605449438
The modified gen p mean: 0.4545014500617981, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03127431869506836, decouple_loss:0.0013224976137280464
2023-05-27 09:08:30 testing...
The modified gen p mean: 0.45419543981552124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03247473016381264, decouple_loss:0.0013944061938673258
The modified gen p mean: 0.4522954225540161, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03256175294518471, decouple_loss:0.0014597626868635416
The modified gen p mean: 0.45394375920295715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03409960865974426, decouple_loss:0.0015074836555868387
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03311806172132492, avg_mse: 0.04512327164411545
current test mse: 0.045123
Iteration: 4071, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.454084575176239, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030131561681628227, decouple_loss:0.0012610601261258125
The modified gen p mean: 0.44856977462768555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028818843886256218, decouple_loss:0.0013079014606773853
The modified gen p mean: 0.4513542354106903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030301347374916077, decouple_loss:0.0012799818068742752
Iteration: 4072, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501577913761139, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029655011370778084, decouple_loss:0.0012412832584232092
The modified gen p mean: 0.4546462297439575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029192527756094933, decouple_loss:0.0014425377594307065
The modified gen p mean: 0.4520095884799957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031121792271733284, decouple_loss:0.001325000892393291
Iteration: 4073, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44962331652641296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02902502566576004, decouple_loss:0.0012808574829250574
The modified gen p mean: 0.4560592472553253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028740093111991882, decouple_loss:0.0013529303250834346
The modified gen p mean: 0.4533194303512573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029095957055687904, decouple_loss:0.001205986482091248
Iteration: 4074, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498891532421112, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03151657432317734, decouple_loss:0.0013831170508638024
The modified gen p mean: 0.45431870222091675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02891257219016552, decouple_loss:0.0014149101916700602
The modified gen p mean: 0.44954222440719604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02857547253370285, decouple_loss:0.0015168560203164816
Iteration: 4075, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44977402687072754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02836606837809086, decouple_loss:0.0014142796862870455
The modified gen p mean: 0.4477417767047882, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030418196693062782, decouple_loss:0.0012607050593942404
The modified gen p mean: 0.4524434804916382, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030514637008309364, decouple_loss:0.00129449472296983
Iteration: 4076, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4533132016658783, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44953134655952454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030540164560079575, decouple_loss:0.0012653946178033948
loss_pred:0.029482394456863403, decouple_loss:0.0011798393679782748
The modified gen p mean: 0.4493098258972168, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03058488667011261, decouple_loss:0.0012023133458569646
Iteration: 4077, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44666600227355957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02998276799917221, decouple_loss:0.0012198507320135832
The modified gen p mean: 0.448760986328125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030746955424547195, decouple_loss:0.0013513313606381416
The modified gen p mean: 0.4506434500217438, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0286423210054636, decouple_loss:0.0012346457224339247
Iteration: 4078, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44888606667518616, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4493084251880646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02852611243724823, decouple_loss:0.0012614661827683449
loss_pred:0.030718926340341568, decouple_loss:0.0013095434987917542
The modified gen p mean: 0.4497596025466919, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028347445651888847, decouple_loss:0.001355606596916914
Iteration: 4079, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494363069534302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03017340414226055, decouple_loss:0.0012321159010753036
The modified gen p mean: 0.44867023825645447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028721293434500694, decouple_loss:0.0011787848779931664
The modified gen p mean: 0.4510355293750763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028853032737970352, decouple_loss:0.00127701205201447
Iteration: 4080, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4525153636932373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029286084696650505, decouple_loss:0.0012719582300633192
The modified gen p mean: 0.4527478814125061, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02839985303580761, decouple_loss:0.0012714253971353173
The modified gen p mean: 0.44962722063064575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028354214504361153, decouple_loss:0.0012776501243934035
2023-05-27 09:12:36 testing...
The modified gen p mean: 0.45380958914756775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032498423010110855, decouple_loss:0.0015392110217362642
The modified gen p mean: 0.4519115686416626, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45365938544273376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032663945108652115, decouple_loss:0.001489726360887289
loss_pred:0.03417523205280304, decouple_loss:0.001559527707286179
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03318900987505913, avg_mse: 0.04526951536536217
current test mse: 0.04527
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4081, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44739919900894165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029091529548168182, decouple_loss:0.0012779207900166512
The modified gen p mean: 0.45174577832221985, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4523342251777649, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027591019868850708, decouple_loss:0.0013834660639986396
loss_pred:0.03009006194770336, decouple_loss:0.001323658274486661
Iteration: 4082, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499453902244568, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030620336532592773, decouple_loss:0.0011688810773193836
The modified gen p mean: 0.45258718729019165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02931791916489601, decouple_loss:0.0013388303341343999
The modified gen p mean: 0.4512544870376587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029169751331210136, decouple_loss:0.0012684834655374289
Iteration: 4083, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45384687185287476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028066596016287804, decouple_loss:0.0014131732750684023
The modified gen p mean: 0.4503544270992279, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02936869114637375, decouple_loss:0.0012427560286596417
The modified gen p mean: 0.45219528675079346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029439745470881462, decouple_loss:0.0012427448527887464
Iteration: 4084, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515863358974457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029957028105854988, decouple_loss:0.0012707238784059882
The modified gen p mean: 0.4541141092777252, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02953268215060234, decouple_loss:0.0012453565141186118
The modified gen p mean: 0.4491726756095886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02878071926534176, decouple_loss:0.0012486308114603162
Iteration: 4085, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506222605705261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029426107183098793, decouple_loss:0.0012893853709101677
The modified gen p mean: 0.4523625671863556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030465232208371162, decouple_loss:0.0012844447046518326
The modified gen p mean: 0.45148661732673645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02952549047768116, decouple_loss:0.0011706273071467876
Iteration: 4086, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45054638385772705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03066454827785492, decouple_loss:0.0013363994657993317
The modified gen p mean: 0.4508487582206726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029537329450249672, decouple_loss:0.0012625978561118245
The modified gen p mean: 0.4498516917228699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02907843329012394, decouple_loss:0.0011666951468214393
Iteration: 4087, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465351402759552, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45066070556640625, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02961016818881035, decouple_loss:0.001188402296975255
loss_pred:0.028390835970640182, decouple_loss:0.0011926408624276519
The modified gen p mean: 0.4495540261268616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02889307402074337, decouple_loss:0.0013176074717193842
Iteration: 4088, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513377547264099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028496500104665756, decouple_loss:0.0013206033036112785
The modified gen p mean: 0.4461817443370819, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030362622812390327, decouple_loss:0.0011991942301392555
The modified gen p mean: 0.4475117623806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029202084988355637, decouple_loss:0.0011371829314157367
Iteration: 4089, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44949543476104736, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44713395833969116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02843463607132435, decouple_loss:0.0012263357639312744
loss_pred:0.02818264067173004, decouple_loss:0.0013953597517684102
The modified gen p mean: 0.445241779088974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030339863151311874, decouple_loss:0.0012836350360885262
Iteration: 4090, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44884780049324036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027081411331892014, decouple_loss:0.0011489291209727526
The modified gen p mean: 0.44919365644454956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028094151988625526, decouple_loss:0.0012524762423709035
The modified gen p mean: 0.4479064345359802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02851102501153946, decouple_loss:0.001264960621483624
2023-05-27 09:17:24 testing...
The modified gen p mean: 0.45025646686553955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03225060552358627, decouple_loss:0.0014883631374686956
The modified gen p mean: 0.4484274387359619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03242726996541023, decouple_loss:0.0014255917631089687
The modified gen p mean: 0.45003217458724976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034043312072753906, decouple_loss:0.0014574421802535653
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.032979920506477356, avg_mse: 0.04485823214054108
current test mse: 0.044858
Iteration: 4091, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487922191619873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028083574026823044, decouple_loss:0.0012451140210032463
The modified gen p mean: 0.4491390287876129, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028884541243314743, decouple_loss:0.0012491445522755384
The modified gen p mean: 0.4502861201763153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02814081870019436, decouple_loss:0.0014420566149055958
Iteration: 4092, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44973498582839966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027336198836565018, decouple_loss:0.0012653074227273464
The modified gen p mean: 0.44695648550987244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027939962223172188, decouple_loss:0.0013609037268906832
The modified gen p mean: 0.44751134514808655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029814856126904488, decouple_loss:0.0012588497484102845
Iteration: 4093, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44604021310806274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028773151338100433, decouple_loss:0.0012787224259227514
The modified gen p mean: 0.4440373182296753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02968333289027214, decouple_loss:0.0013289867201820016
The modified gen p mean: 0.44486185908317566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03090805374085903, decouple_loss:0.0012281875824555755
Iteration: 4094, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44778379797935486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02857062593102455, decouple_loss:0.0014059552922844887
The modified gen p mean: 0.44810429215431213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029301993548870087, decouple_loss:0.0012873007217422128
The modified gen p mean: 0.45080316066741943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029355190694332123, decouple_loss:0.0012539513409137726
Iteration: 4095, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44892311096191406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02909502573311329, decouple_loss:0.0011978005059063435The modified gen p mean: 0.44607412815093994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029280075803399086, decouple_loss:0.0012155001750215888
The modified gen p mean: 0.44907209277153015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027633482590317726, decouple_loss:0.001258693402633071
Iteration: 4096, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45087411999702454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027612438425421715, decouple_loss:0.0013016280718147755
The modified gen p mean: 0.45006707310676575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028027977794408798, decouple_loss:0.0011814526515081525
The modified gen p mean: 0.4509536325931549, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028178773820400238, decouple_loss:0.0012575194705277681
Iteration: 4097, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44982966780662537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02834385074675083, decouple_loss:0.0013300158316269517
The modified gen p mean: 0.4520944356918335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028242401778697968, decouple_loss:0.0011790961725637317
The modified gen p mean: 0.45304033160209656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026307959109544754, decouple_loss:0.0013356923591345549
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4098, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499319791793823, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44414252042770386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027113955467939377, decouple_loss:0.0013875120785087347
loss_pred:0.027732808142900467, decouple_loss:0.0012995066354051232
The modified gen p mean: 0.4459640383720398, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027424467727541924, decouple_loss:0.0011646043276414275
Iteration: 4099, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44275084137916565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027946285903453827, decouple_loss:0.001330607570707798
The modified gen p mean: 0.4489631652832031, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026369765400886536, decouple_loss:0.001365580828860402
The modified gen p mean: 0.445944607257843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02591496706008911, decouple_loss:0.0011462243273854256
Iteration: 4100, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44359102845191956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026994923129677773, decouple_loss:0.0014085040893405676
The modified gen p mean: 0.4456867277622223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026177475228905678, decouple_loss:0.0012800105614587665
The modified gen p mean: 0.44765570759773254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02578427828848362, decouple_loss:0.0013513071462512016
2023-05-27 09:22:10 testing...
The modified gen p mean: 0.4469357430934906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032598644495010376, decouple_loss:0.001582735450938344
The modified gen p mean: 0.4451374113559723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03278201445937157, decouple_loss:0.0013938805786892772
The modified gen p mean: 0.4466712474822998, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03448515385389328, decouple_loss:0.0016651229234412313
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03336596488952637, avg_mse: 0.04561097174882889
current test mse: 0.045611
Iteration: 4101, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454710781574249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026735275983810425, decouple_loss:0.0014712699921801686
The modified gen p mean: 0.44293123483657837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02480650693178177, decouple_loss:0.001392499660141766
The modified gen p mean: 0.44117170572280884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027028976008296013, decouple_loss:0.001378967659547925
Iteration: 4102, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4413757920265198, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02760171890258789, decouple_loss:0.00126668531447649
The modified gen p mean: 0.44291484355926514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025453800335526466, decouple_loss:0.0012360862456262112
The modified gen p mean: 0.44273027777671814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027195993810892105, decouple_loss:0.0013808393850922585
Iteration: 4103, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4425845742225647, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4426456391811371, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026843231171369553, decouple_loss:0.0012091494863852859
loss_pred:0.027608299627900124, decouple_loss:0.0012252029264345765
The modified gen p mean: 0.44442805647850037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025653911754488945, decouple_loss:0.0012745826970785856
Iteration: 4104, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4420146346092224, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44211652874946594, gen p mean: 0.0, mean p set: 0.448loss_pred:0.026790553703904152, decouple_loss:0.0013237218372523785
loss_pred:0.027904123067855835, decouple_loss:0.0012968303635716438
The modified gen p mean: 0.44617411494255066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026485145092010498, decouple_loss:0.0012520867167040706
Iteration: 4105, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492504894733429, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44404345750808716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02661062590777874, decouple_loss:0.0013186767464503646
loss_pred:0.027020728215575218, decouple_loss:0.0012096913997083902
The modified gen p mean: 0.44805291295051575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02569936029613018, decouple_loss:0.0013257665559649467
Iteration: 4106, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45119500160217285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02579471282660961, decouple_loss:0.0013063151855021715
The modified gen p mean: 0.4486541450023651, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02731909789144993, decouple_loss:0.0013107541017234325
The modified gen p mean: 0.44957301020622253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026328254491090775, decouple_loss:0.0012317142682150006
Iteration: 4107, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45075517892837524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024862468242645264, decouple_loss:0.0013870252296328545
The modified gen p mean: 0.45260709524154663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027105528861284256, decouple_loss:0.0012894468382000923
The modified gen p mean: 0.4534306526184082, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025984415784478188, decouple_loss:0.0013113257009536028
Iteration: 4108, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4517330229282379, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025390146300196648, decouple_loss:0.0012724441476166248
The modified gen p mean: 0.4535149037837982, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02543277107179165, decouple_loss:0.0012894771061837673
The modified gen p mean: 0.45323610305786133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025057701393961906, decouple_loss:0.0013138287467882037
Iteration: 4109, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45309221744537354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027244621887803078, decouple_loss:0.001354416599497199
The modified gen p mean: 0.45366960763931274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024966157972812653, decouple_loss:0.001203745836392045
The modified gen p mean: 0.4508312940597534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025814929977059364, decouple_loss:0.0013875275617465377
Iteration: 4110, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45183008909225464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026323074474930763, decouple_loss:0.0012246795231476426
The modified gen p mean: 0.4488827884197235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02717730402946472, decouple_loss:0.0012989595998078585
The modified gen p mean: 0.44947853684425354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02579471282660961, decouple_loss:0.0013014087453484535
2023-05-27 09:26:14 testing...
The modified gen p mean: 0.4520941972732544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032928045839071274, decouple_loss:0.0015087808715179563
The modified gen p mean: 0.45024505257606506, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45197242498397827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03286519646644592, decouple_loss:0.0014395152684301138
loss_pred:0.034654151648283005, decouple_loss:0.0016100864158943295
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033558439463377, avg_mse: 0.04596119001507759
current test mse: 0.045961
Iteration: 4111, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473140239715576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027237573638558388, decouple_loss:0.0011944054858759046
The modified gen p mean: 0.4485931396484375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026786692440509796, decouple_loss:0.001289616571739316
The modified gen p mean: 0.4475741386413574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026902567595243454, decouple_loss:0.00123159633949399
Iteration: 4112, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44690313935279846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025271235033869743, decouple_loss:0.0012777617666870356
The modified gen p mean: 0.4446551501750946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02670503780245781, decouple_loss:0.0012587832752615213
The modified gen p mean: 0.44430968165397644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027422118932008743, decouple_loss:0.001124208909459412
Iteration: 4113, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439304769039154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02776140533387661, decouple_loss:0.0012411476345732808
The modified gen p mean: 0.44374245405197144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02705320343375206, decouple_loss:0.0013067064573988318
The modified gen p mean: 0.44532090425491333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02650420553982258, decouple_loss:0.0012904494069516659
Iteration: 4114, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44671115279197693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02528577484190464, decouple_loss:0.0013487880351021886
The modified gen p mean: 0.44152384996414185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027047080919146538, decouple_loss:0.0011825438123196363
The modified gen p mean: 0.44496089220046997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026973549276590347, decouple_loss:0.0013217567466199398
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4115, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44904136657714844, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4486030042171478, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031239870935678482, decouple_loss:0.0013106151018291712
loss_pred:0.030486030504107475, decouple_loss:0.0012482727179303765
The modified gen p mean: 0.4491712152957916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028710490092635155, decouple_loss:0.00133248430211097
Iteration: 4116, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464588463306427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0311177559196949, decouple_loss:0.0012802681885659695
The modified gen p mean: 0.4457879960536957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030625201761722565, decouple_loss:0.001182360341772437
The modified gen p mean: 0.4468076527118683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030412662774324417, decouple_loss:0.0012853313237428665
Iteration: 4117, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491996169090271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030810566619038582, decouple_loss:0.0013224916765466332
The modified gen p mean: 0.44752267003059387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02959902584552765, decouple_loss:0.0014474496711045504
The modified gen p mean: 0.4492700397968292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02930341102182865, decouple_loss:0.0013732605148106813
Iteration: 4118, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45124006271362305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0281280055642128, decouple_loss:0.0013619100209325552
The modified gen p mean: 0.44840219616889954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029301317408680916, decouple_loss:0.0013469349360093474
The modified gen p mean: 0.44898268580436707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029854722321033478, decouple_loss:0.0014237853465601802
Iteration: 4119, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4529833495616913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030214600265026093, decouple_loss:0.0012720992090180516
The modified gen p mean: 0.4522143602371216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031231418251991272, decouple_loss:0.0012902294984087348
The modified gen p mean: 0.4522312581539154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029667632654309273, decouple_loss:0.0012177216121926904
Iteration: 4120, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493028521537781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029797840863466263, decouple_loss:0.0012066131457686424
The modified gen p mean: 0.4501189589500427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028914568945765495, decouple_loss:0.001319336355663836
The modified gen p mean: 0.45258668065071106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028973625972867012, decouple_loss:0.0012226190883666277
2023-05-27 09:31:00 testing...
The modified gen p mean: 0.4531635046005249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251856938004494, decouple_loss:0.0014123672153800726
The modified gen p mean: 0.45145025849342346, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45296674966812134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261568397283554, decouple_loss:0.001568194362334907
loss_pred:0.034321919083595276, decouple_loss:0.0014836796326562762
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033226460218429565, avg_mse: 0.04524395242333412
current test mse: 0.045244
Iteration: 4121, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44650202989578247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03048883005976677, decouple_loss:0.001269458094611764
The modified gen p mean: 0.44758155941963196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029893582686781883, decouple_loss:0.0013537801569327712
The modified gen p mean: 0.452485054731369, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030261563137173653, decouple_loss:0.00140350719448179
Iteration: 4122, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491437077522278, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02888938970863819, decouple_loss:0.0013606019783765078
The modified gen p mean: 0.447791188955307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03129902109503746, decouple_loss:0.001312654814682901
The modified gen p mean: 0.45070117712020874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02940485067665577, decouple_loss:0.001325072138570249
Iteration: 4123, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44892269372940063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028826924040913582, decouple_loss:0.0013810166856274009
The modified gen p mean: 0.4464229345321655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032058753073215485, decouple_loss:0.0012744718696922064
The modified gen p mean: 0.44654545187950134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028654754161834717, decouple_loss:0.001304039848037064
Iteration: 4124, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442957937717438, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029424354434013367, decouple_loss:0.001376411528326571
The modified gen p mean: 0.448529452085495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0315067283809185, decouple_loss:0.0014117419486865401
The modified gen p mean: 0.4443119168281555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03058396279811859, decouple_loss:0.0012630672426894307
Iteration: 4125, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512229561805725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029509393498301506, decouple_loss:0.001346450299024582
The modified gen p mean: 0.4464111030101776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030789118260145187, decouple_loss:0.001393776503391564
The modified gen p mean: 0.4501652717590332, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03096906840801239, decouple_loss:0.0012820748379454017
Iteration: 4126, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44839635491371155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03112173266708851, decouple_loss:0.0011730447877198458
The modified gen p mean: 0.45118215680122375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029305079951882362, decouple_loss:0.0013458257308229804
The modified gen p mean: 0.44526058435440063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028993727639317513, decouple_loss:0.0012005637399852276
Iteration: 4127, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44930779933929443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0277359951287508, decouple_loss:0.0013295771786943078
The modified gen p mean: 0.4468969404697418, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03154881298542023, decouple_loss:0.0013048014370724559
The modified gen p mean: 0.44815143942832947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030430765822529793, decouple_loss:0.0013289953349158168
Iteration: 4128, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476270079612732, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029744377359747887, decouple_loss:0.0012934990227222443
The modified gen p mean: 0.45161619782447815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0290260948240757, decouple_loss:0.0014239568263292313
The modified gen p mean: 0.45243075489997864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03040395863354206, decouple_loss:0.0013327565975487232
Iteration: 4129, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508422315120697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030821507796645164, decouple_loss:0.0012004600139334798
The modified gen p mean: 0.44964146614074707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03179965913295746, decouple_loss:0.001302843214944005
The modified gen p mean: 0.4490521550178528, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03193974494934082, decouple_loss:0.0012041873997077346
Iteration: 4130, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500727355480194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030232183635234833, decouple_loss:0.0013084850506857038
The modified gen p mean: 0.4533945620059967, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03078460320830345, decouple_loss:0.001293675508350134
The modified gen p mean: 0.4487706422805786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030896024778485298, decouple_loss:0.0012599508045241237
2023-05-27 09:35:07 testing...
The modified gen p mean: 0.4532216787338257, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032737359404563904, decouple_loss:0.0014587712939828634
The modified gen p mean: 0.4531087875366211, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03431456536054611, decouple_loss:0.0015059795696288347
The modified gen p mean: 0.4514741599559784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032657213509082794, decouple_loss:0.001517676399089396
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03331109136343002, avg_mse: 0.045446887612342834
current test mse: 0.045447
Iteration: 4131, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45150110125541687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03002193383872509, decouple_loss:0.001344115473330021
The modified gen p mean: 0.44803765416145325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031427979469299316, decouple_loss:0.0013144223485141993
The modified gen p mean: 0.44776293635368347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030212534591555595, decouple_loss:0.0013378363801166415
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr.npz
NaN value num: 0
Iteration: 4132, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44582098722457886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026993030682206154, decouple_loss:0.0012756126234307885
The modified gen p mean: 0.44819608330726624, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44756796956062317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02759971283376217, decouple_loss:0.0013410280225798488
loss_pred:0.02617671526968479, decouple_loss:0.0012754310155287385
Iteration: 4133, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457879364490509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028074471279978752, decouple_loss:0.0012623360380530357
The modified gen p mean: 0.4450724422931671, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027771079912781715, decouple_loss:0.0012629835400730371
The modified gen p mean: 0.44436725974082947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02709101140499115, decouple_loss:0.0011896700598299503
Iteration: 4134, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44308820366859436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025436677038669586, decouple_loss:0.001287219114601612
The modified gen p mean: 0.44370782375335693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02724800445139408, decouple_loss:0.0012060620356351137
The modified gen p mean: 0.44553065299987793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028026705607771873, decouple_loss:0.0013427867088466883
Iteration: 4135, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.43999627232551575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028241658583283424, decouple_loss:0.001274564303457737
The modified gen p mean: 0.4462093412876129, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02696146070957184, decouple_loss:0.001314083463512361
The modified gen p mean: 0.4419367015361786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026136089116334915, decouple_loss:0.0013327292399480939
Iteration: 4136, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44367700815200806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026520026847720146, decouple_loss:0.0014532868517562747
The modified gen p mean: 0.4437168836593628, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026803458109498024, decouple_loss:0.0012581535847857594
The modified gen p mean: 0.4457452893257141, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026786303147673607, decouple_loss:0.0014298373134806752
Iteration: 4137, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444381296634674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026595424860715866, decouple_loss:0.001231339294463396
The modified gen p mean: 0.4438866972923279, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02674328349530697, decouple_loss:0.0012723359977826476
The modified gen p mean: 0.4443214237689972, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025607051327824593, decouple_loss:0.0015208832919597626
Iteration: 4138, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45068201422691345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02609316073358059, decouple_loss:0.0012929326621815562
The modified gen p mean: 0.4477168023586273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027617553249001503, decouple_loss:0.0013884177897125483
The modified gen p mean: 0.447383314371109, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025087708607316017, decouple_loss:0.0013259578263387084
Iteration: 4139, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491601288318634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028549477458000183, decouple_loss:0.0012339348904788494
The modified gen p mean: 0.451898992061615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02534666657447815, decouple_loss:0.0014157129917293787
The modified gen p mean: 0.4496738910675049, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026485249400138855, decouple_loss:0.0013323421590030193
Iteration: 4140, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502035975456238, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028480226173996925, decouple_loss:0.0012413618387654424
The modified gen p mean: 0.4509018659591675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026655353605747223, decouple_loss:0.001275712507776916
The modified gen p mean: 0.4518289864063263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025377904996275902, decouple_loss:0.0013850231189280748
2023-05-27 09:40:00 testing...
The modified gen p mean: 0.4567120373249054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03286001458764076, decouple_loss:0.0013711394276469946
The modified gen p mean: 0.4562418758869171, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03429054096341133, decouple_loss:0.0014257306465879083
The modified gen p mean: 0.45484283566474915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03284771367907524, decouple_loss:0.0015152913983911276
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033404625952243805, avg_mse: 0.04565519466996193
current test mse: 0.045655
Iteration: 4141, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4551847577095032, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02562294900417328, decouple_loss:0.0012295254273340106
The modified gen p mean: 0.45122790336608887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027260055765509605, decouple_loss:0.0012722586980089545
The modified gen p mean: 0.45421677827835083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026893794536590576, decouple_loss:0.001314421184360981
Iteration: 4142, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45283055305480957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026041818782687187, decouple_loss:0.0012441198341548443
The modified gen p mean: 0.4530891478061676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025524545460939407, decouple_loss:0.0012696506455540657
The modified gen p mean: 0.45391443371772766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026831001043319702, decouple_loss:0.001282155979424715
Iteration: 4143, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4528932571411133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02616690658032894, decouple_loss:0.001362516894005239
The modified gen p mean: 0.44930779933929443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026033766567707062, decouple_loss:0.001263136393390596
The modified gen p mean: 0.44939637184143066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026871640235185623, decouple_loss:0.0013152646133676171
Iteration: 4144, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493688941001892, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02753111533820629, decouple_loss:0.0012947424547746778
The modified gen p mean: 0.4488334655761719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02562456764280796, decouple_loss:0.0012742758262902498
The modified gen p mean: 0.4500053822994232, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025762200355529785, decouple_loss:0.001299181254580617
Iteration: 4145, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44617244601249695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02572420984506607, decouple_loss:0.0011514854850247502
The modified gen p mean: 0.4497990906238556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02513173408806324, decouple_loss:0.001224544015713036
The modified gen p mean: 0.44570279121398926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026973100379109383, decouple_loss:0.0011163130402565002
Iteration: 4146, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475906491279602, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024890735745429993, decouple_loss:0.0013071349821984768
The modified gen p mean: 0.44774386286735535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024954779073596, decouple_loss:0.0011652422836050391
The modified gen p mean: 0.44693174958229065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0269150473177433, decouple_loss:0.0011716728331521153
Iteration: 4147, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44464075565338135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025085294619202614, decouple_loss:0.0012786894803866744
The modified gen p mean: 0.44545572996139526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026732008904218674, decouple_loss:0.00121690786909312
The modified gen p mean: 0.4470427632331848, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026538841426372528, decouple_loss:0.0012594076106324792
Iteration: 4148, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44425827264785767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024899922311306, decouple_loss:0.0011822956148535013
The modified gen p mean: 0.44333669543266296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02617967315018177, decouple_loss:0.0013179171364754438
The modified gen p mean: 0.44138193130493164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027355967089533806, decouple_loss:0.001168948132544756
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4149, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44586411118507385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02750273048877716, decouple_loss:0.0012792489724233747
The modified gen p mean: 0.44588029384613037, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44661247730255127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02828184701502323, decouple_loss:0.001194093027152121
loss_pred:0.02752346731722355, decouple_loss:0.0013904166407883167
Iteration: 4150, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477081000804901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027826854959130287, decouple_loss:0.0013792868703603745
The modified gen p mean: 0.44473981857299805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673276513814926, decouple_loss:0.0012826152378693223
The modified gen p mean: 0.44605326652526855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027403831481933594, decouple_loss:0.001220089616253972
2023-05-27 09:45:02 testing...
The modified gen p mean: 0.4536186456680298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032703202217817307, decouple_loss:0.0014501168625429273
The modified gen p mean: 0.45169103145599365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03268539905548096, decouple_loss:0.0013560547959059477
The modified gen p mean: 0.45344048738479614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034279704093933105, decouple_loss:0.0014790260465815663
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0332941897213459, avg_mse: 0.04546092078089714
current test mse: 0.045461
Iteration: 4151, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4545729160308838, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026789337396621704, decouple_loss:0.001252863323315978
The modified gen p mean: 0.45025449991226196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028096280992031097, decouple_loss:0.0013528408017009497
The modified gen p mean: 0.4506032168865204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026650317013263702, decouple_loss:0.0013954725582152605
Iteration: 4152, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44942495226860046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027561647817492485, decouple_loss:0.0012103652115911245
The modified gen p mean: 0.4522484540939331, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025993844494223595, decouple_loss:0.0013744811294600368
The modified gen p mean: 0.45352187752723694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027382001280784607, decouple_loss:0.0011460008099675179
Iteration: 4153, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45269912481307983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026327218860387802, decouple_loss:0.0012945999624207616
The modified gen p mean: 0.45396673679351807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02634285017848015, decouple_loss:0.0014034018386155367
The modified gen p mean: 0.4548274874687195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02869459055364132, decouple_loss:0.0012893788516521454
Iteration: 4154, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45547032356262207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026070158928632736, decouple_loss:0.001329789636656642
The modified gen p mean: 0.4513605237007141, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028388146311044693, decouple_loss:0.0013729173224419355
The modified gen p mean: 0.4541403353214264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02669755555689335, decouple_loss:0.0012603006325662136
Iteration: 4155, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45165538787841797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02817865088582039, decouple_loss:0.0012735961936414242
The modified gen p mean: 0.45047885179519653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027146628126502037, decouple_loss:0.001219366560690105
The modified gen p mean: 0.4554349184036255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026529300957918167, decouple_loss:0.001262708567082882
Iteration: 4156, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476372301578522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027883056551218033, decouple_loss:0.0013624936109408736
The modified gen p mean: 0.4495736360549927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02749704197049141, decouple_loss:0.0012859356356784701
The modified gen p mean: 0.4533545672893524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027338044717907906, decouple_loss:0.001246783067472279
Iteration: 4157, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462641477584839, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027302363887429237, decouple_loss:0.0011612336384132504
The modified gen p mean: 0.446152001619339, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026597067713737488, decouple_loss:0.0012828295584768057
The modified gen p mean: 0.44722768664360046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02863251231610775, decouple_loss:0.0013329085195437074
Iteration: 4158, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508456289768219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026080872863531113, decouple_loss:0.0013723771553486586
The modified gen p mean: 0.4488586187362671, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02740582451224327, decouple_loss:0.0013709779595956206
The modified gen p mean: 0.44694745540618896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0261523574590683, decouple_loss:0.00129031075630337
Iteration: 4159, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439724087715149, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026811378076672554, decouple_loss:0.0012777659576386213
The modified gen p mean: 0.44435009360313416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025424234569072723, decouple_loss:0.0013151220045983791
The modified gen p mean: 0.44393405318260193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026783177629113197, decouple_loss:0.0013083660742267966
Iteration: 4160, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445431113243103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026851125061511993, decouple_loss:0.0012818935792893171
The modified gen p mean: 0.44931909441947937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02509249374270439, decouple_loss:0.0014322831993922591
The modified gen p mean: 0.4472475051879883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027905572205781937, decouple_loss:0.0012970702955499291
2023-05-27 09:49:07 testing...
The modified gen p mean: 0.4511181712150574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0329911932349205, decouple_loss:0.001533909817226231
The modified gen p mean: 0.45104673504829407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034535448998212814, decouple_loss:0.0015611574053764343
The modified gen p mean: 0.4490949511528015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0329587385058403, decouple_loss:0.0015314884949475527
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0335722342133522, avg_mse: 0.04587387293577194
current test mse: 0.045874
Iteration: 4161, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492930471897125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02644367702305317, decouple_loss:0.0015412020729854703
The modified gen p mean: 0.4452027380466461, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028013866394758224, decouple_loss:0.0013678583782166243
The modified gen p mean: 0.44575539231300354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02498585358262062, decouple_loss:0.0013302027946338058
Iteration: 4162, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485127329826355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027148792520165443, decouple_loss:0.0013320299331098795
The modified gen p mean: 0.45031073689460754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027823016047477722, decouple_loss:0.0012467794585973024
The modified gen p mean: 0.4509241580963135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02609722875058651, decouple_loss:0.0014639446744695306
Iteration: 4163, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514937698841095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820165827870369, decouple_loss:0.001382680842652917
The modified gen p mean: 0.45596057176589966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027173582464456558, decouple_loss:0.0013797774445265532
The modified gen p mean: 0.4525305926799774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02618536166846752, decouple_loss:0.0012631341814994812
Iteration: 4164, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4544868767261505, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4499899446964264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024404658004641533, decouple_loss:0.0013412419939413667
loss_pred:0.02703983709216118, decouple_loss:0.001285580568946898
The modified gen p mean: 0.45190536975860596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027333369478583336, decouple_loss:0.001224896521307528
Iteration: 4165, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496619403362274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02724600024521351, decouple_loss:0.0013715653913095593
The modified gen p mean: 0.45312997698783875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02590092457830906, decouple_loss:0.0013879393227398396
The modified gen p mean: 0.4546720087528229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025873392820358276, decouple_loss:0.0014061076799407601
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr.npz
NaN value num: 0
Iteration: 4166, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4556470215320587, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45614954829216003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028987610712647438, decouple_loss:0.0013585623819380999
The modified gen p mean: 0.4547102451324463, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02808900736272335, decouple_loss:0.0013636256335303187
loss_pred:0.027826938778162003, decouple_loss:0.001524970750324428
Iteration: 4167, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45123156905174255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02883797511458397, decouple_loss:0.0013515494065359235
The modified gen p mean: 0.4501984417438507, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028897559270262718, decouple_loss:0.001335573149845004
The modified gen p mean: 0.45238953828811646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028521208092570305, decouple_loss:0.0013854668941348791
Iteration: 4168, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4539722204208374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02990429289638996, decouple_loss:0.0014107264578342438
The modified gen p mean: 0.45106062293052673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02854565903544426, decouple_loss:0.0013156203785911202
The modified gen p mean: 0.44997864961624146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028634745627641678, decouple_loss:0.0013256727252155542
Iteration: 4169, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479227364063263, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4501562714576721, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02910921536386013, decouple_loss:0.0012595406733453274
loss_pred:0.02888024039566517, decouple_loss:0.0013797800056636333
The modified gen p mean: 0.45488372445106506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027864133939146996, decouple_loss:0.0012799007818102837
Iteration: 4170, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481867253780365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029834041371941566, decouple_loss:0.001395933679305017
The modified gen p mean: 0.44745635986328125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03003997541964054, decouple_loss:0.0013207431184127927
The modified gen p mean: 0.4525347054004669, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027383336797356606, decouple_loss:0.001389685203321278
2023-05-27 09:54:03 testing...
The modified gen p mean: 0.45227450132369995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261352702975273, decouple_loss:0.0015122733311727643
The modified gen p mean: 0.4504285454750061, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032667092978954315, decouple_loss:0.0016063271323218942
The modified gen p mean: 0.4521300196647644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03428848087787628, decouple_loss:0.0014482345432043076
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03326581418514252, avg_mse: 0.04535159096121788
current test mse: 0.045352
Iteration: 4171, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45146119594573975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028278391808271408, decouple_loss:0.0013937093317508698
The modified gen p mean: 0.4471953809261322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02841951698064804, decouple_loss:0.0012437156401574612
The modified gen p mean: 0.4485326409339905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028161369264125824, decouple_loss:0.0012882336741313338
Iteration: 4172, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44746387004852295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02777353674173355, decouple_loss:0.001211446477100253
The modified gen p mean: 0.4460912346839905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029244769364595413, decouple_loss:0.0011775594903156161
The modified gen p mean: 0.4458741545677185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02859061397612095, decouple_loss:0.0012275432236492634
Iteration: 4173, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44740620255470276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028432894498109818, decouple_loss:0.0012209146516397595
The modified gen p mean: 0.44845157861709595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02778090536594391, decouple_loss:0.0012112720869481564
The modified gen p mean: 0.44995585083961487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02848641574382782, decouple_loss:0.0012702184030786157
Iteration: 4174, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44944724440574646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027712320908904076, decouple_loss:0.0011801564833149314
The modified gen p mean: 0.4486004412174225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028881868347525597, decouple_loss:0.0012688558781519532
The modified gen p mean: 0.4478583335876465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027564125135540962, decouple_loss:0.0013406778452917933
Iteration: 4175, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44929105043411255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02841736376285553, decouple_loss:0.0013066751416772604
The modified gen p mean: 0.448955237865448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02869275026023388, decouple_loss:0.0012250200379639864
The modified gen p mean: 0.44912415742874146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02879421040415764, decouple_loss:0.0012610451085492969
Iteration: 4176, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45302316546440125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028506150469183922, decouple_loss:0.001374602783471346
The modified gen p mean: 0.4474125802516937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0283703301101923, decouple_loss:0.0011834159959107637
The modified gen p mean: 0.44760099053382874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02954568900167942, decouple_loss:0.0013157629873603582
Iteration: 4177, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4521656930446625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02767615206539631, decouple_loss:0.0013872206909582019
The modified gen p mean: 0.45038262009620667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027524618431925774, decouple_loss:0.0012563442578539252
The modified gen p mean: 0.44804275035858154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028743190690875053, decouple_loss:0.001111652352847159
Iteration: 4178, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491503834724426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028721235692501068, decouple_loss:0.0012025692267343402
The modified gen p mean: 0.4451749622821808, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02871471643447876, decouple_loss:0.0011817833874374628
The modified gen p mean: 0.448377788066864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028260724619030952, decouple_loss:0.0013064394006505609
Iteration: 4179, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44784265756607056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028202135115861893, decouple_loss:0.0012125750072300434
The modified gen p mean: 0.44452470541000366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027680128812789917, decouple_loss:0.0012216862523928285
The modified gen p mean: 0.44906318187713623, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028729580342769623, decouple_loss:0.0012739645317196846
Iteration: 4180, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44609153270721436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028406210243701935, decouple_loss:0.0013755615800619125
The modified gen p mean: 0.44536107778549194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029209375381469727, decouple_loss:0.0011985312448814511
The modified gen p mean: 0.44467493891716003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030008835718035698, decouple_loss:0.001411503180861473
2023-05-27 09:58:07 testing...
The modified gen p mean: 0.45045381784439087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032534681260585785, decouple_loss:0.0013934961752966046
The modified gen p mean: 0.44844117760658264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032723940908908844, decouple_loss:0.0014524395810440183
The modified gen p mean: 0.4502122104167938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034479644149541855, decouple_loss:0.0014079241082072258
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03331698477268219, avg_mse: 0.04543415084481239
current test mse: 0.045434
Iteration: 4181, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44569724798202515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028211666271090508, decouple_loss:0.0013236984377726912
The modified gen p mean: 0.4453721046447754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028786079958081245, decouple_loss:0.00118538539391011
The modified gen p mean: 0.44725126028060913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02712864615023136, decouple_loss:0.0012527670478448272
Iteration: 4182, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44727200269699097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028697974979877472, decouple_loss:0.0013681025011464953
The modified gen p mean: 0.450000137090683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027202965691685677, decouple_loss:0.0013652141205966473
The modified gen p mean: 0.4501120150089264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02692531794309616, decouple_loss:0.0012808144092559814
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4183, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446259468793869, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4513828456401825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027685051783919334, decouple_loss:0.0012148767709732056loss_pred:0.02844897471368313, decouple_loss:0.0012513729743659496
The modified gen p mean: 0.4472835958003998, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027851181104779243, decouple_loss:0.0013038639444857836
Iteration: 4184, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4525164067745209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027461543679237366, decouple_loss:0.0012762501137331128
The modified gen p mean: 0.45176416635513306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027211403474211693, decouple_loss:0.0012876195833086967
The modified gen p mean: 0.44905155897140503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029483217746019363, decouple_loss:0.0012808205792680383
Iteration: 4185, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4520721435546875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026101700961589813, decouple_loss:0.0013912502909079194
The modified gen p mean: 0.44929879903793335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028014540672302246, decouple_loss:0.001358009409159422
The modified gen p mean: 0.45313915610313416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028028368949890137, decouple_loss:0.0013753717066720128
Iteration: 4186, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4532774090766907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02740750089287758, decouple_loss:0.001377207227051258
The modified gen p mean: 0.44798552989959717, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027886787429451942, decouple_loss:0.0011914421338588
The modified gen p mean: 0.4483409523963928, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027309203520417213, decouple_loss:0.0013615122297778726
Iteration: 4187, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507695138454437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02707354910671711, decouple_loss:0.0014332981081679463
The modified gen p mean: 0.4458002746105194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027193352580070496, decouple_loss:0.001337420311756432
The modified gen p mean: 0.4429885447025299, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027631213888525963, decouple_loss:0.0013143796240910888
Iteration: 4188, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4427621364593506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02758064493536949, decouple_loss:0.0012505670310929418
The modified gen p mean: 0.4491064250469208, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027136756107211113, decouple_loss:0.0015252036973834038
The modified gen p mean: 0.44513362646102905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02707763761281967, decouple_loss:0.0012931013479828835
Iteration: 4189, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4423913061618805, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4458276331424713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02688341774046421, decouple_loss:0.0011876992648467422
loss_pred:0.02680988796055317, decouple_loss:0.0013706049649044871
The modified gen p mean: 0.4482208788394928, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026557374745607376, decouple_loss:0.0012130099348723888
Iteration: 4190, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44785577058792114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028262872248888016, decouple_loss:0.0013098801719024777
The modified gen p mean: 0.44861501455307007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02694300375878811, decouple_loss:0.0012456770054996014
The modified gen p mean: 0.4445466697216034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02754080854356289, decouple_loss:0.0014522502897307277
2023-05-27 10:02:54 testing...
The modified gen p mean: 0.4498211741447449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032769765704870224, decouple_loss:0.0014126062160357833
The modified gen p mean: 0.4477181136608124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03278311714529991, decouple_loss:0.0015078199794515967
The modified gen p mean: 0.4495561122894287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03452236205339432, decouple_loss:0.0014187906635925174
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033430736511945724, avg_mse: 0.04576487839221954
current test mse: 0.045765
Iteration: 4191, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438864588737488, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02773323655128479, decouple_loss:0.0013086351100355387
The modified gen p mean: 0.4480886459350586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025679491460323334, decouple_loss:0.001229698769748211
The modified gen p mean: 0.44803956151008606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026753215119242668, decouple_loss:0.0012542702024802566
Iteration: 4192, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507715106010437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02701871283352375, decouple_loss:0.001339463866315782
The modified gen p mean: 0.4456431567668915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026149054989218712, decouple_loss:0.0012657332699745893
The modified gen p mean: 0.44508564472198486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02825302630662918, decouple_loss:0.0014669500524178147
Iteration: 4193, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44736912846565247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02678316831588745, decouple_loss:0.001389737008139491
The modified gen p mean: 0.4483788311481476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028014445677399635, decouple_loss:0.0011587226763367653
The modified gen p mean: 0.449483722448349, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0273531973361969, decouple_loss:0.001319491770118475
Iteration: 4194, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466678202152252, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690838649868965, decouple_loss:0.0012239308562129736
The modified gen p mean: 0.451674222946167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027877455577254295, decouple_loss:0.0012810068437829614
The modified gen p mean: 0.4464692771434784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027280079200863838, decouple_loss:0.0011538134422153234
Iteration: 4195, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496515691280365, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4481475055217743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027150796726346016, decouple_loss:0.001241945312358439
loss_pred:0.026785897091031075, decouple_loss:0.0012738319346681237
The modified gen p mean: 0.452149897813797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027350403368473053, decouple_loss:0.0012829211773350835
Iteration: 4196, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534674286842346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027227027341723442, decouple_loss:0.0015364239225164056
The modified gen p mean: 0.44686248898506165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027321981266140938, decouple_loss:0.001255664974451065
The modified gen p mean: 0.44501709938049316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027248548343777657, decouple_loss:0.001135665806941688
Iteration: 4197, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487408399581909, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027395904064178467, decouple_loss:0.0011655505513772368
The modified gen p mean: 0.4481695890426636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026750784367322922, decouple_loss:0.001251337118446827
The modified gen p mean: 0.44683170318603516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02916526421904564, decouple_loss:0.0012752340408042073
Iteration: 4198, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44908830523490906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027062412351369858, decouple_loss:0.0013039555633440614
The modified gen p mean: 0.4486311376094818, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027874495834112167, decouple_loss:0.0012602303177118301
The modified gen p mean: 0.4462732672691345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02822483517229557, decouple_loss:0.0012107646325603127
Iteration: 4199, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439769685268402, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028075138106942177, decouple_loss:0.0011985256569460034
The modified gen p mean: 0.44546064734458923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027833841741085052, decouple_loss:0.0011992936488240957
The modified gen p mean: 0.4455239772796631, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0286643635481596, decouple_loss:0.001091483631171286
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr.npz
NaN value num: 0
Iteration: 4200, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461142420768738, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03048473224043846, decouple_loss:0.0013564670225605369
The modified gen p mean: 0.4457640051841736, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44486212730407715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02989097870886326, decouple_loss:0.001391356810927391
loss_pred:0.028512349352240562, decouple_loss:0.0012700239894911647
2023-05-27 10:07:47 testing...
The modified gen p mean: 0.4500822126865387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03290587291121483, decouple_loss:0.0014303866773843765
The modified gen p mean: 0.4480789005756378, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03288091719150543, decouple_loss:0.0014187251217663288
The modified gen p mean: 0.4498888850212097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03456106036901474, decouple_loss:0.0014214934781193733
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03352046012878418, avg_mse: 0.04594740644097328
current test mse: 0.045947
Iteration: 4201, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44842275977134705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029543651267886162, decouple_loss:0.0011965883895754814
The modified gen p mean: 0.4452681541442871, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028700141236186028, decouple_loss:0.001348259742371738
The modified gen p mean: 0.4436552822589874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029274817556142807, decouple_loss:0.0012527825310826302
Iteration: 4202, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44509777426719666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029509318992495537, decouple_loss:0.0013053718721494079
The modified gen p mean: 0.4452919065952301, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0308456439524889, decouple_loss:0.0013424111530184746
The modified gen p mean: 0.444835364818573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030304551124572754, decouple_loss:0.0011392106534913182
Iteration: 4203, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452861249446869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029634997248649597, decouple_loss:0.001175578567199409
The modified gen p mean: 0.4487649202346802, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029517432674765587, decouple_loss:0.0013312683440744877
The modified gen p mean: 0.449643075466156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029225846752524376, decouple_loss:0.0013835682766512036
Iteration: 4204, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490015208721161, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030158525332808495, decouple_loss:0.0011713615385815501
The modified gen p mean: 0.44870612025260925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030170755460858345, decouple_loss:0.001217749435454607
The modified gen p mean: 0.4510597586631775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029756620526313782, decouple_loss:0.0012969127856194973
Iteration: 4205, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45309633016586304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02846365049481392, decouple_loss:0.0013370361411944032
The modified gen p mean: 0.449544221162796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028236672282218933, decouple_loss:0.0013249998446553946
The modified gen p mean: 0.4498688876628876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02998182736337185, decouple_loss:0.001259228796698153
Iteration: 4206, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45249196887016296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026851413771510124, decouple_loss:0.0013385344063863158
The modified gen p mean: 0.4523242712020874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02693605050444603, decouple_loss:0.0014068854507058859
The modified gen p mean: 0.45174866914749146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028544098138809204, decouple_loss:0.0012320470996201038
Iteration: 4207, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4530709683895111, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03046521730720997, decouple_loss:0.0011984677985310555
The modified gen p mean: 0.45385313034057617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029042568057775497, decouple_loss:0.001264549558982253
The modified gen p mean: 0.45227229595184326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03010895475745201, decouple_loss:0.0011762311914935708
Iteration: 4208, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45411747694015503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027830451726913452, decouple_loss:0.0012902691960334778
The modified gen p mean: 0.45604437589645386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029488351196050644, decouple_loss:0.0013371636159718037
The modified gen p mean: 0.45058152079582214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028994929045438766, decouple_loss:0.001315235742367804
Iteration: 4209, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4532063603401184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02808329090476036, decouple_loss:0.0013551717856898904
The modified gen p mean: 0.45130378007888794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028927767649292946, decouple_loss:0.0012917183339595795
The modified gen p mean: 0.45414701104164124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028213372454047203, decouple_loss:0.0013798954896628857
Iteration: 4210, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44923242926597595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03052675351500511, decouple_loss:0.0011994770029559731
The modified gen p mean: 0.4525238275527954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029951786622405052, decouple_loss:0.001294917892664671
The modified gen p mean: 0.44874709844589233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029010029509663582, decouple_loss:0.0012005842290818691
2023-05-27 10:11:54 testing...
The modified gen p mean: 0.4517565667629242, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032472871243953705, decouple_loss:0.0013799754669889808
The modified gen p mean: 0.45003142952919006, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4515199363231659, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265194967389107, decouple_loss:0.0015558559680357575
loss_pred:0.034255340695381165, decouple_loss:0.0014110642950981855
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03319916874170303, avg_mse: 0.045315004885196686
current test mse: 0.045315
Iteration: 4211, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497821033000946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02860931120812893, decouple_loss:0.001253316062502563
The modified gen p mean: 0.44678544998168945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028539665043354034, decouple_loss:0.0014312267303466797
The modified gen p mean: 0.447149395942688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028787916526198387, decouple_loss:0.0012076316634193063
Iteration: 4212, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457682967185974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028081119060516357, decouple_loss:0.0013490435667335987
The modified gen p mean: 0.44424179196357727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030715202912688255, decouple_loss:0.001322425901889801
The modified gen p mean: 0.4447222948074341, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03062930516898632, decouple_loss:0.0011874486226588488
Iteration: 4213, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475541114807129, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029659632593393326, decouple_loss:0.0011931557673960924
The modified gen p mean: 0.4437029957771301, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028237255290150642, decouple_loss:0.0013264762237668037
The modified gen p mean: 0.44309401512145996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03056720644235611, decouple_loss:0.0012012398801743984
Iteration: 4214, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465561509132385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027694178745150566, decouple_loss:0.0012420180719345808
The modified gen p mean: 0.44235002994537354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029554538428783417, decouple_loss:0.0013218489475548267
The modified gen p mean: 0.4445718824863434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.031068995594978333, decouple_loss:0.0012848397018387914
Iteration: 4215, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439336955547333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028958521783351898, decouple_loss:0.0013752224622294307
The modified gen p mean: 0.44734805822372437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02998039871454239, decouple_loss:0.0012361775152385235
The modified gen p mean: 0.4453299641609192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02826486900448799, decouple_loss:0.001218914519995451
Iteration: 4216, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484706521034241, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02729726769030094, decouple_loss:0.0012889290228486061
The modified gen p mean: 0.44401562213897705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028918251395225525, decouple_loss:0.0011711686383932829
The modified gen p mean: 0.4491906762123108, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02813977748155594, decouple_loss:0.0012278510257601738
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4217, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44714847207069397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026935510337352753, decouple_loss:0.0012431443901732564
The modified gen p mean: 0.4483599066734314, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4454152584075928, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02653452940285206, decouple_loss:0.001290522632189095
loss_pred:0.026140689849853516, decouple_loss:0.0014899359084665775
Iteration: 4218, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473949074745178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026577306911349297, decouple_loss:0.0012592022540047765
The modified gen p mean: 0.44745102524757385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026831939816474915, decouple_loss:0.0012317924993112683
The modified gen p mean: 0.44651028513908386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02738850936293602, decouple_loss:0.0012511011445894837
Iteration: 4219, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4522249400615692, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025370867922902107, decouple_loss:0.0012673205928876996
The modified gen p mean: 0.44814372062683105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02716556005179882, decouple_loss:0.0010951297590509057
The modified gen p mean: 0.45028331875801086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026277903467416763, decouple_loss:0.0013941230718046427
Iteration: 4220, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45029619336128235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026443637907505035, decouple_loss:0.0011932640336453915
The modified gen p mean: 0.4460403323173523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026051759719848633, decouple_loss:0.001387172844260931
The modified gen p mean: 0.4485153555870056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026607654988765717, decouple_loss:0.0011498250532895327
2023-05-27 10:16:40 testing...
The modified gen p mean: 0.4516502022743225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032664187252521515, decouple_loss:0.0014168955385684967
The modified gen p mean: 0.44988811016082764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03264160826802254, decouple_loss:0.0014466322027146816
The modified gen p mean: 0.4513722062110901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034231036901474, decouple_loss:0.0014400951331481338
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03325067088007927, avg_mse: 0.04537718743085861
current test mse: 0.045377
Iteration: 4221, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44840168952941895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026218341663479805, decouple_loss:0.0013548918068408966
The modified gen p mean: 0.4467005431652069, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027143411338329315, decouple_loss:0.0012556473957374692
The modified gen p mean: 0.4458177089691162, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028302229940891266, decouple_loss:0.0011861021630465984
Iteration: 4222, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4436419606208801, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02681800164282322, decouple_loss:0.0012616108870133758
The modified gen p mean: 0.44546520709991455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026684554293751717, decouple_loss:0.0013386867940425873
The modified gen p mean: 0.4446392357349396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026233036071062088, decouple_loss:0.0011265759821981192
Iteration: 4223, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443489909172058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02696797251701355, decouple_loss:0.001184808206744492
The modified gen p mean: 0.4452909529209137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02603442221879959, decouple_loss:0.0013833363773301244
The modified gen p mean: 0.4483664333820343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026102203875780106, decouple_loss:0.0013462115311995149
Iteration: 4224, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44480806589126587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026557955890893936, decouple_loss:0.0013075342867523432
The modified gen p mean: 0.4502979815006256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02565615624189377, decouple_loss:0.0013250188203528523
The modified gen p mean: 0.44538652896881104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026013212278485298, decouple_loss:0.0012986292131245136
Iteration: 4225, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44852685928344727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02532632276415825, decouple_loss:0.0011787543771788478
The modified gen p mean: 0.4450035095214844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02570500411093235, decouple_loss:0.0012208049884065986
The modified gen p mean: 0.44292303919792175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0270594023168087, decouple_loss:0.0014175813412293792
Iteration: 4226, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44636020064353943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026170244440436363, decouple_loss:0.001209419104270637
The modified gen p mean: 0.449556440114975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02569383755326271, decouple_loss:0.0013381269527599216
The modified gen p mean: 0.44556480646133423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025315463542938232, decouple_loss:0.0014475604984909296
Iteration: 4227, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44914793968200684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02590332180261612, decouple_loss:0.001275098416954279
The modified gen p mean: 0.44346779584884644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026374289765954018, decouple_loss:0.0012894893297925591
The modified gen p mean: 0.44448405504226685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026685092598199844, decouple_loss:0.001347930170595646
Iteration: 4228, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44756606221199036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026124553754925728, decouple_loss:0.0012896049302071333
The modified gen p mean: 0.44660115242004395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02623463049530983, decouple_loss:0.0012864010641351342
The modified gen p mean: 0.443498432636261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026521293446421623, decouple_loss:0.0012015633983537555
Iteration: 4229, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44342365860939026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027046307921409607, decouple_loss:0.0013964769896119833
The modified gen p mean: 0.44288620352745056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02658502385020256, decouple_loss:0.0011324656661599874
The modified gen p mean: 0.4480178654193878, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026015672832727432, decouple_loss:0.001352251973003149
Iteration: 4230, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44622111320495605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027081575244665146, decouple_loss:0.0013057963224127889
The modified gen p mean: 0.4475725293159485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026568256318569183, decouple_loss:0.0013573195319622755
The modified gen p mean: 0.4444643259048462, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026013769209384918, decouple_loss:0.0013461996568366885
2023-05-27 10:20:46 testing...
The modified gen p mean: 0.45083343982696533, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261534124612808, decouple_loss:0.001508411020040512
The modified gen p mean: 0.44906094670295715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032777052372694016, decouple_loss:0.0013901263009756804
The modified gen p mean: 0.4506295323371887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03437456861138344, decouple_loss:0.0015666105318814516
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033330075442790985, avg_mse: 0.04558485746383667
current test mse: 0.045585
Iteration: 4231, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44537675380706787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026254992932081223, decouple_loss:0.0012402897700667381
The modified gen p mean: 0.44382771849632263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02773319184780121, decouple_loss:0.001286858692765236
The modified gen p mean: 0.4434666037559509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02736073173582554, decouple_loss:0.0011979930568486452
Iteration: 4232, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447731375694275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02731315791606903, decouple_loss:0.0013186169089749455
The modified gen p mean: 0.4456143379211426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024907099083065987, decouple_loss:0.0013514477759599686
The modified gen p mean: 0.4464716613292694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025721969082951546, decouple_loss:0.0013398616574704647
Iteration: 4233, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44548651576042175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026509318500757217, decouple_loss:0.0013594208285212517
The modified gen p mean: 0.4481067359447479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02560659870505333, decouple_loss:0.0013019843026995659
The modified gen p mean: 0.4454801678657532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026822445914149284, decouple_loss:0.0011184192262589931
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr.npz
NaN value num: 0
Iteration: 4234, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44808897376060486, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44507521390914917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02763175219297409, decouple_loss:0.0016351038357242942
The modified gen p mean: 0.4477580189704895, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02877923473715782, decouple_loss:0.0013557211495935917
loss_pred:0.026077374815940857, decouple_loss:0.0014812672743573785
Iteration: 4235, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44387105107307434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026784786954522133, decouple_loss:0.0013193476479500532
The modified gen p mean: 0.44471463561058044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029139449819922447, decouple_loss:0.001191662042401731
The modified gen p mean: 0.4478439390659332, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025966225191950798, decouple_loss:0.0014080182882025838
Iteration: 4236, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44696420431137085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026766624301671982, decouple_loss:0.0012010318459942937
The modified gen p mean: 0.4477945864200592, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02626197226345539, decouple_loss:0.0013148136204108596
The modified gen p mean: 0.44791173934936523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026209132745862007, decouple_loss:0.001318040769547224
Iteration: 4237, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457181990146637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026852784678339958, decouple_loss:0.0013073417358100414
The modified gen p mean: 0.4469514489173889, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025335170328617096, decouple_loss:0.0014065473806113005
The modified gen p mean: 0.44535961747169495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028367407619953156, decouple_loss:0.0012598729226738214
Iteration: 4238, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453045725822449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026818731799721718, decouple_loss:0.0013112514279782772
The modified gen p mean: 0.44393190741539, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02684864029288292, decouple_loss:0.001219270401634276
The modified gen p mean: 0.4477011263370514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02624702826142311, decouple_loss:0.001391356810927391
Iteration: 4239, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495152235031128, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026454294100403786, decouple_loss:0.001312080305069685
The modified gen p mean: 0.44639962911605835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026048261672258377, decouple_loss:0.0014220352750271559
The modified gen p mean: 0.4446154832839966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028066858649253845, decouple_loss:0.0012970524840056896
Iteration: 4240, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455920159816742, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027782434597611427, decouple_loss:0.0012788695748895407
The modified gen p mean: 0.4464338719844818, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026008272543549538, decouple_loss:0.0011870295275002718
The modified gen p mean: 0.4451958239078522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02721620723605156, decouple_loss:0.0012929849326610565
2023-05-27 10:25:38 testing...
The modified gen p mean: 0.45264527201652527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03273021802306175, decouple_loss:0.0014782308135181665
The modified gen p mean: 0.450833797454834, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45242705941200256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03290553018450737, decouple_loss:0.00156450888607651
loss_pred:0.03455352038145065, decouple_loss:0.0015462276060134172
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03347290679812431, avg_mse: 0.04584187641739845
current test mse: 0.045842
Iteration: 4241, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482259154319763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026919709518551826, decouple_loss:0.001314228167757392
The modified gen p mean: 0.4481692612171173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027141250669956207, decouple_loss:0.0012359035899862647
The modified gen p mean: 0.44848722219467163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02623848430812359, decouple_loss:0.0012219303753226995
Iteration: 4242, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502222239971161, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025825021788477898, decouple_loss:0.0012477043783292174
The modified gen p mean: 0.4502168893814087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02637246437370777, decouple_loss:0.0013208364835008979
The modified gen p mean: 0.44870617985725403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02645750157535076, decouple_loss:0.0013020081678405404
Iteration: 4243, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502517282962799, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026825685054063797, decouple_loss:0.001279375865124166
The modified gen p mean: 0.4506140351295471, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02813844196498394, decouple_loss:0.0012711182935163379
The modified gen p mean: 0.4525330662727356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025174813345074654, decouple_loss:0.0012843256117776036
Iteration: 4244, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45239055156707764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025520270690321922, decouple_loss:0.0013764725299552083
The modified gen p mean: 0.45055750012397766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026696931570768356, decouple_loss:0.0012901196023449302
The modified gen p mean: 0.4533637762069702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02662280574440956, decouple_loss:0.0012836982496082783
Iteration: 4245, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45721226930618286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02620769664645195, decouple_loss:0.0014709298266097903
The modified gen p mean: 0.450706422328949, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02557346597313881, decouple_loss:0.0011830024886876345
The modified gen p mean: 0.4542737603187561, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025346165522933006, decouple_loss:0.001387512544170022
Iteration: 4246, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503244161605835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026455119252204895, decouple_loss:0.0011683434713631868
The modified gen p mean: 0.4533129930496216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025537656620144844, decouple_loss:0.0012727845460176468
The modified gen p mean: 0.4552896320819855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0264398455619812, decouple_loss:0.001445914851501584
Iteration: 4247, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45413362979888916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025592587888240814, decouple_loss:0.001287952996790409
The modified gen p mean: 0.45406705141067505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02704700455069542, decouple_loss:0.0012497628340497613
The modified gen p mean: 0.45081907510757446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02529243379831314, decouple_loss:0.0014140408020466566
Iteration: 4248, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482934772968292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027318088337779045, decouple_loss:0.0014844679972156882
The modified gen p mean: 0.4497086703777313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026084430515766144, decouple_loss:0.0013670623302459717
The modified gen p mean: 0.45125994086265564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02602275460958481, decouple_loss:0.0013559547951444983
Iteration: 4249, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44589322805404663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0266292504966259, decouple_loss:0.0015678848139941692The modified gen p mean: 0.44523903727531433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02747282199561596, decouple_loss:0.0014804512029513717
The modified gen p mean: 0.44712090492248535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028119903057813644, decouple_loss:0.0012916810810565948
Iteration: 4250, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495486617088318, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02515244483947754, decouple_loss:0.0013540147338062525
The modified gen p mean: 0.4471401274204254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024946536868810654, decouple_loss:0.0012930978555232286
The modified gen p mean: 0.4503849446773529, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026780104264616966, decouple_loss:0.001184506225399673
2023-05-27 10:29:44 testing...
The modified gen p mean: 0.44948363304138184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032520443201065063, decouple_loss:0.0014727564994245768
The modified gen p mean: 0.44925329089164734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03434451296925545, decouple_loss:0.0014827668201178312
The modified gen p mean: 0.4475070834159851, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032844558358192444, decouple_loss:0.0015480117872357368
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033311568200588226, avg_mse: 0.045577555894851685
current test mse: 0.045578
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4251, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456495940685272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030353693291544914, decouple_loss:0.0012531288666650653
The modified gen p mean: 0.44516226649284363, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4478228986263275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028233978897333145, decouple_loss:0.0013266027672216296
loss_pred:0.029101595282554626, decouple_loss:0.001377707696519792
Iteration: 4252, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44650763273239136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029185999184846878, decouple_loss:0.0015645659295842052
The modified gen p mean: 0.44667086005210876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02953425794839859, decouple_loss:0.0013180460082367063
The modified gen p mean: 0.44985759258270264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028975391760468483, decouple_loss:0.0014818493509665132
Iteration: 4253, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480955898761749, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03071977011859417, decouple_loss:0.0012796111404895782
The modified gen p mean: 0.45076826214790344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029620623216032982, decouple_loss:0.0012551449472084641
The modified gen p mean: 0.44714266061782837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02883949503302574, decouple_loss:0.0012777065858244896
Iteration: 4254, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44989094138145447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03180930018424988, decouple_loss:0.0011975967790931463
The modified gen p mean: 0.454073965549469, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028584538027644157, decouple_loss:0.0013466650852933526
The modified gen p mean: 0.4497533440589905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029506783932447433, decouple_loss:0.0012066796189174056
Iteration: 4255, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513989984989166, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4529567360877991, gen p mean: 0.0, mean p set: 0.448loss_pred:0.029382506385445595, decouple_loss:0.0012749121524393559
loss_pred:0.028179822489619255, decouple_loss:0.0014601146103814244
The modified gen p mean: 0.4498403072357178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029784509912133217, decouple_loss:0.001136259874328971
Iteration: 4256, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45574408769607544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02988388203084469, decouple_loss:0.0014586236793547869
The modified gen p mean: 0.4521634876728058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028572259470820427, decouple_loss:0.0012589532416313887
The modified gen p mean: 0.45700159668922424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028854453936219215, decouple_loss:0.0014443759573623538
Iteration: 4257, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45299655199050903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028576429933309555, decouple_loss:0.001144798588939011
The modified gen p mean: 0.4517843723297119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029200980439782143, decouple_loss:0.0013004225911572576
The modified gen p mean: 0.4543657600879669, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029478857293725014, decouple_loss:0.001205537817440927
Iteration: 4258, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449415922164917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02937362715601921, decouple_loss:0.0012997437734156847
The modified gen p mean: 0.4495130479335785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029633423313498497, decouple_loss:0.0012045935727655888
The modified gen p mean: 0.4527583718299866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029580533504486084, decouple_loss:0.001331931329332292
Iteration: 4259, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464784562587738, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03171559050679207, decouple_loss:0.0012218686752021313
The modified gen p mean: 0.448759526014328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029793590307235718, decouple_loss:0.0012117995647713542
The modified gen p mean: 0.44843223690986633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028520654886960983, decouple_loss:0.001145204994827509
Iteration: 4260, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44729796051979065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02978086844086647, decouple_loss:0.0012606338132172823
The modified gen p mean: 0.44535574316978455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028957556933164597, decouple_loss:0.0012954887934029102
The modified gen p mean: 0.44757699966430664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02929571270942688, decouple_loss:0.001198706915602088
2023-05-27 10:34:35 testing...
The modified gen p mean: 0.44794201850891113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03231186792254448, decouple_loss:0.0013972896849736571
The modified gen p mean: 0.44585326313972473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03257513418793678, decouple_loss:0.001435616402886808
The modified gen p mean: 0.44752058386802673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03409084677696228, decouple_loss:0.0014348062686622143
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033063746988773346, avg_mse: 0.044900376349687576
current test mse: 0.0449
Iteration: 4261, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44236060976982117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029175160452723503, decouple_loss:0.0012432700023055077
The modified gen p mean: 0.4457176625728607, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028292838484048843, decouple_loss:0.0013812797842547297
The modified gen p mean: 0.4427037537097931, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030316732823848724, decouple_loss:0.001145138987340033
Iteration: 4262, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44152137637138367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030199091881513596, decouple_loss:0.0012482755118981004
The modified gen p mean: 0.4458002746105194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0291452519595623, decouple_loss:0.0014182355953380466
The modified gen p mean: 0.4460146725177765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02974962443113327, decouple_loss:0.0012295035412535071
Iteration: 4263, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459960460662842, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4432890713214874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028817515820264816, decouple_loss:0.0012820226838812232
loss_pred:0.02863573282957077, decouple_loss:0.0011637520510703325
The modified gen p mean: 0.4433780610561371, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028623275458812714, decouple_loss:0.001202919753268361
Iteration: 4264, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44587740302085876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027971912175416946, decouple_loss:0.0014467656146734953
The modified gen p mean: 0.4464259147644043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029495039954781532, decouple_loss:0.0011616726405918598
The modified gen p mean: 0.44502049684524536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030150284990668297, decouple_loss:0.001258327392861247
Iteration: 4265, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44820132851600647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02795984223484993, decouple_loss:0.0012900439323857427
The modified gen p mean: 0.4444320797920227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029278164729475975, decouple_loss:0.0012384654255583882
The modified gen p mean: 0.44461026787757874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029932256788015366, decouple_loss:0.0012300540693104267
Iteration: 4266, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474915564060211, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029476765543222427, decouple_loss:0.001141332439146936
The modified gen p mean: 0.44852545857429504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028778111562132835, decouple_loss:0.0011334692826494575
The modified gen p mean: 0.4478398561477661, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028482260182499886, decouple_loss:0.0013578628422692418
Iteration: 4267, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45001351833343506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029684940353035927, decouple_loss:0.0014618587447330356
The modified gen p mean: 0.4504314661026001, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02868458442389965, decouple_loss:0.0012194716837257147
The modified gen p mean: 0.45188838243484497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028477992862462997, decouple_loss:0.0014633028768002987
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr.npz
NaN value num: 0
Iteration: 4268, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4547121822834015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027272798120975494, decouple_loss:0.0014789382694289088
The modified gen p mean: 0.45047256350517273, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45437267422676086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026065615937113762, decouple_loss:0.001324223936535418
loss_pred:0.027960577979683876, decouple_loss:0.0013666481245309114
Iteration: 4269, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45272889733314514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02619786746799946, decouple_loss:0.001386882970109582
The modified gen p mean: 0.45209190249443054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027328183874487877, decouple_loss:0.0013652866473421454
The modified gen p mean: 0.45565110445022583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026985805481672287, decouple_loss:0.0015001078136265278
Iteration: 4270, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44994398951530457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028359845280647278, decouple_loss:0.0014444789849221706
The modified gen p mean: 0.448333740234375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028753291815519333, decouple_loss:0.0014655048726126552
The modified gen p mean: 0.4509020149707794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028066447004675865, decouple_loss:0.0013124099932610989
2023-05-27 10:39:33 testing...
The modified gen p mean: 0.4537648856639862, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03244349732995033, decouple_loss:0.0014700969913974404
The modified gen p mean: 0.4518417716026306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03274957090616226, decouple_loss:0.0014989030314609408
The modified gen p mean: 0.45332786440849304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03421987593173981, decouple_loss:0.0014159402344375849
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03321073204278946, avg_mse: 0.04519978538155556
current test mse: 0.0452
Iteration: 4271, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480077624320984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028470993041992188, decouple_loss:0.001372688915580511
The modified gen p mean: 0.44914576411247253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0270699355751276, decouple_loss:0.0012656409526243806
The modified gen p mean: 0.4477732479572296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02672608010470867, decouple_loss:0.0013118230272084475
Iteration: 4272, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44792890548706055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026229342445731163, decouple_loss:0.0015108739025890827
The modified gen p mean: 0.4488009214401245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027831148356199265, decouple_loss:0.001370379002764821
The modified gen p mean: 0.44810056686401367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027909008786082268, decouple_loss:0.0013333495007827878
Iteration: 4273, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4433615803718567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026780016720294952, decouple_loss:0.001458045793697238
The modified gen p mean: 0.4478057324886322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025506436824798584, decouple_loss:0.0015043041203171015
The modified gen p mean: 0.44461333751678467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026959678158164024, decouple_loss:0.0014618263812735677
Iteration: 4274, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4400045871734619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027093136683106422, decouple_loss:0.00120725657325238
The modified gen p mean: 0.4446026384830475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025565514340996742, decouple_loss:0.0015758310910314322
The modified gen p mean: 0.4437122941017151, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02641521394252777, decouple_loss:0.0014550912892445922
Iteration: 4275, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4414043724536896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02675553597509861, decouple_loss:0.0011545444140210748
The modified gen p mean: 0.4424160122871399, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027845388278365135, decouple_loss:0.001242616679519415
The modified gen p mean: 0.4458511769771576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025584347546100616, decouple_loss:0.0013252960052341223
Iteration: 4276, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44376885890960693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02942524291574955, decouple_loss:0.0013745313044637442
The modified gen p mean: 0.4486675560474396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026273256167769432, decouple_loss:0.00146576389670372
The modified gen p mean: 0.44427576661109924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027789685875177383, decouple_loss:0.0012652266304939985
Iteration: 4277, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482474625110626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027658553794026375, decouple_loss:0.0013638210948556662
The modified gen p mean: 0.4472772777080536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027395477518439293, decouple_loss:0.0012731836177408695
The modified gen p mean: 0.44947347044944763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722611092031002, decouple_loss:0.0015059001743793488
Iteration: 4278, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498584568500519, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45035597681999207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02625417336821556, decouple_loss:0.0012329000746831298
loss_pred:0.0275997593998909, decouple_loss:0.0013402029871940613
The modified gen p mean: 0.45299363136291504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02617000788450241, decouple_loss:0.0013184462441131473
Iteration: 4279, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4533146619796753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02552293799817562, decouple_loss:0.0014197435230016708
The modified gen p mean: 0.45096713304519653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028080610558390617, decouple_loss:0.001319507951848209
The modified gen p mean: 0.4509977400302887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027477018535137177, decouple_loss:0.0012394823133945465
Iteration: 4280, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.455140620470047, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4539383351802826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026422401890158653, decouple_loss:0.0012949680676683784
loss_pred:0.027500543743371964, decouple_loss:0.0011905176797881722
The modified gen p mean: 0.45126304030418396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025473225861787796, decouple_loss:0.001378742977976799
2023-05-27 10:43:39 testing...
The modified gen p mean: 0.4582689106464386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254976123571396, decouple_loss:0.0014304626965895295
The modified gen p mean: 0.4576966464519501, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03415800258517265, decouple_loss:0.0014009367441758513
The modified gen p mean: 0.45615091919898987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032674193382263184, decouple_loss:0.0013875879812985659
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033197637647390366, avg_mse: 0.04530308023095131
current test mse: 0.045303
Iteration: 4281, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45586684346199036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02466689608991146, decouple_loss:0.0012177660828456283
The modified gen p mean: 0.4522775411605835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028855733573436737, decouple_loss:0.0012453024974092841
The modified gen p mean: 0.4546366333961487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028111182153224945, decouple_loss:0.0011737481690943241
Iteration: 4282, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513457417488098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027095668017864227, decouple_loss:0.0011662330944091082
The modified gen p mean: 0.45090752840042114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027293864637613297, decouple_loss:0.0011854355689138174
The modified gen p mean: 0.4543873965740204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0272637028247118, decouple_loss:0.0012965123169124126
Iteration: 4283, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4544680416584015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026237590238451958, decouple_loss:0.0013871099799871445
The modified gen p mean: 0.4486652910709381, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02717086672782898, decouple_loss:0.001099562388844788
The modified gen p mean: 0.45569372177124023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02584446407854557, decouple_loss:0.001174373086541891
Iteration: 4284, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44882237911224365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028608016669750214, decouple_loss:0.0012638760963454843
The modified gen p mean: 0.44938603043556213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027649668976664543, decouple_loss:0.001173588214442134
The modified gen p mean: 0.45108410716056824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025067688897252083, decouple_loss:0.0013382642064243555
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4285, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454612731933594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027457820251584053, decouple_loss:0.001255758455954492
The modified gen p mean: 0.44800201058387756, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44974711537361145, gen p mean: 0.0, mean p set: 0.448loss_pred:0.025701740756630898, decouple_loss:0.001266610692255199
loss_pred:0.02647826075553894, decouple_loss:0.0013435764703899622
Iteration: 4286, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44526639580726624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025873659178614616, decouple_loss:0.001287815161049366
The modified gen p mean: 0.4478411376476288, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025802938267588615, decouple_loss:0.0012402348220348358
The modified gen p mean: 0.445700466632843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026053039357066154, decouple_loss:0.0011831154115498066
Iteration: 4287, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454892575740814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026514286175370216, decouple_loss:0.001311171450652182
The modified gen p mean: 0.443564236164093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02704804763197899, decouple_loss:0.0012267278507351875
The modified gen p mean: 0.44393086433410645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026267800480127335, decouple_loss:0.0013006511144340038
Iteration: 4288, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4417974054813385, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4410206377506256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027656571939587593, decouple_loss:0.0013022618368268013
loss_pred:0.02806277573108673, decouple_loss:0.0014172944938763976
The modified gen p mean: 0.4446324110031128, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026605267077684402, decouple_loss:0.0012626807438209653
Iteration: 4289, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4423663914203644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025029558688402176, decouple_loss:0.00130277790594846
The modified gen p mean: 0.4453078508377075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025457149371504784, decouple_loss:0.0012727726716548204
The modified gen p mean: 0.4412546157836914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027953552082180977, decouple_loss:0.0011456443462520838
Iteration: 4290, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44806167483329773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02657475881278515, decouple_loss:0.001191625720821321
The modified gen p mean: 0.4471978545188904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02620789036154747, decouple_loss:0.001253210473805666
The modified gen p mean: 0.448580801486969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02664114534854889, decouple_loss:0.0012568205129355192
2023-05-27 10:48:38 testing...
The modified gen p mean: 0.45142996311187744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03269074484705925, decouple_loss:0.001463323482312262
The modified gen p mean: 0.4490371346473694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03289152681827545, decouple_loss:0.0015157527523115277
The modified gen p mean: 0.45086491107940674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03431377932429314, decouple_loss:0.0014162466395646334
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0333719402551651, avg_mse: 0.04566176235675812
current test mse: 0.045662
Iteration: 4291, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448853999376297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02606799826025963, decouple_loss:0.0012558640446513891
The modified gen p mean: 0.4437839388847351, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027451664209365845, decouple_loss:0.0012961324537172914
The modified gen p mean: 0.44836363196372986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025780852884054184, decouple_loss:0.0013052767608314753
Iteration: 4292, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447886198759079, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026543619111180305, decouple_loss:0.0014809913700446486
The modified gen p mean: 0.4482114911079407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02681150659918785, decouple_loss:0.0012269034050405025
The modified gen p mean: 0.44855639338493347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025722164660692215, decouple_loss:0.0012334096245467663
Iteration: 4293, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494859278202057, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44718408584594727, gen p mean: 0.0, mean p set: 0.448loss_pred:0.027149837464094162, decouple_loss:0.0011697657173499465
loss_pred:0.02478984370827675, decouple_loss:0.00135908555239439
The modified gen p mean: 0.4459921419620514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026959102600812912, decouple_loss:0.0011932275956496596
Iteration: 4294, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464647173881531, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4449676275253296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027667328715324402, decouple_loss:0.001443873392418027
loss_pred:0.02714315615594387, decouple_loss:0.001199541031382978
The modified gen p mean: 0.4494743049144745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02669476345181465, decouple_loss:0.0012381040723994374
Iteration: 4295, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488731622695923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0252731554210186, decouple_loss:0.001252754358574748
The modified gen p mean: 0.44808998703956604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027117451652884483, decouple_loss:0.0012169932015240192
The modified gen p mean: 0.44907912611961365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02653081715106964, decouple_loss:0.0011861006496474147
Iteration: 4296, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4436246454715729, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4446505904197693, gen p mean: 0.0, mean p set: 0.448loss_pred:0.027669087052345276, decouple_loss:0.0012514740228652954
loss_pred:0.027579305693507195, decouple_loss:0.0012312412727624178
The modified gen p mean: 0.4463224411010742, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0270971842110157, decouple_loss:0.0012340768007561564
Iteration: 4297, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455043077468872, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027272943407297134, decouple_loss:0.0012754152994602919
The modified gen p mean: 0.44474995136260986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02762395516037941, decouple_loss:0.001328083104453981
The modified gen p mean: 0.44751885533332825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025830568745732307, decouple_loss:0.0013993073953315616
Iteration: 4298, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446561723947525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025676295161247253, decouple_loss:0.0014995300443843007
The modified gen p mean: 0.4444715082645416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026999471709132195, decouple_loss:0.0011633619433268905
The modified gen p mean: 0.4444689154624939, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026886258274316788, decouple_loss:0.0011770582059398293
Iteration: 4299, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445679485797882, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4450659453868866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02699967846274376, decouple_loss:0.0012971825199201703
loss_pred:0.025683371350169182, decouple_loss:0.0012976895086467266
The modified gen p mean: 0.44765254855155945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02544795162975788, decouple_loss:0.0013942939694970846
Iteration: 4300, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434880018234253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027392759919166565, decouple_loss:0.001233261777088046
The modified gen p mean: 0.44395506381988525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027124760672450066, decouple_loss:0.0013109812280163169
The modified gen p mean: 0.44750404357910156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025443563237786293, decouple_loss:0.001372104394249618
2023-05-27 10:52:44 testing...
The modified gen p mean: 0.4509662985801697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0328473336994648, decouple_loss:0.0014812458539381623
The modified gen p mean: 0.44865307211875916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03298339992761612, decouple_loss:0.0014963895082473755
The modified gen p mean: 0.45056408643722534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03442535176873207, decouple_loss:0.0015016874531283975
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03349335119128227, avg_mse: 0.045823145657777786
current test mse: 0.045823
Iteration: 4301, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4429749846458435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026603156700730324, decouple_loss:0.0013207868905737996
The modified gen p mean: 0.4469048082828522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026461021974682808, decouple_loss:0.0013224993599578738
The modified gen p mean: 0.44852498173713684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02672339230775833, decouple_loss:0.0013598010409623384
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4302, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44895124435424805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02559809386730194, decouple_loss:0.0013468373799696565
The modified gen p mean: 0.4458337426185608, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.445591539144516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028354672715067863, decouple_loss:0.0014217522693797946
loss_pred:0.025400899350643158, decouple_loss:0.0013647843152284622
Iteration: 4303, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44999825954437256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025399036705493927, decouple_loss:0.0014031986938789487
The modified gen p mean: 0.44610655307769775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02723054029047489, decouple_loss:0.0012892899103462696
The modified gen p mean: 0.44579270482063293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612435817718506, decouple_loss:0.0011549765476956964
Iteration: 4304, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502181112766266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026425931602716446, decouple_loss:0.0013639922253787518
The modified gen p mean: 0.44870421290397644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026372568681836128, decouple_loss:0.001311181578785181
The modified gen p mean: 0.4464757740497589, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026756618171930313, decouple_loss:0.00124667352065444
Iteration: 4305, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44982361793518066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02574826404452324, decouple_loss:0.0012821059208363295
The modified gen p mean: 0.44825032353401184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025821402668952942, decouple_loss:0.001253536669537425
The modified gen p mean: 0.4474153220653534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027341680601239204, decouple_loss:0.0012472114758566022
Iteration: 4306, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447986364364624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027047570794820786, decouple_loss:0.0012654258171096444
The modified gen p mean: 0.45193469524383545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027043558657169342, decouple_loss:0.0012886797776445746
The modified gen p mean: 0.4492088258266449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02774723619222641, decouple_loss:0.001243246952071786
Iteration: 4307, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514024257659912, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025418780744075775, decouple_loss:0.0012654179008677602
The modified gen p mean: 0.4528767466545105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02565368451178074, decouple_loss:0.001344384509138763
The modified gen p mean: 0.45106884837150574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025321034714579582, decouple_loss:0.0013195157516747713
Iteration: 4308, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45097896456718445, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.449158251285553, gen p mean: 0.0, mean p set: 0.448loss_pred:0.027844877913594246, decouple_loss:0.001171911833807826
loss_pred:0.02902977541089058, decouple_loss:0.0013115770416334271
The modified gen p mean: 0.4517841339111328, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026952652260661125, decouple_loss:0.0013796754647046328
Iteration: 4309, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477784335613251, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026976769790053368, decouple_loss:0.0011381950462237
The modified gen p mean: 0.45073461532592773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026115063577890396, decouple_loss:0.0011863630497828126
The modified gen p mean: 0.44960281252861023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027246028184890747, decouple_loss:0.001194662181660533
Iteration: 4310, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44560590386390686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02668747678399086, decouple_loss:0.0011273004347458482
The modified gen p mean: 0.4458491802215576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026860393583774567, decouple_loss:0.001228619134053588
The modified gen p mean: 0.44740065932273865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024950670078396797, decouple_loss:0.0011527716415002942
2023-05-27 10:57:28 testing...
The modified gen p mean: 0.4516107439994812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033832911401987076, decouple_loss:0.0015105358324944973
The modified gen p mean: 0.4514462351799011, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.035458583384752274, decouple_loss:0.0014968601753935218
The modified gen p mean: 0.44914254546165466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03371809422969818, decouple_loss:0.0015374772483482957
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03441227972507477, avg_mse: 0.04742365702986717
current test mse: 0.047424
Iteration: 4311, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496137499809265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026470033451914787, decouple_loss:0.0013511471915990114
The modified gen p mean: 0.4459483027458191, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028372660279273987, decouple_loss:0.0013275317614898086
The modified gen p mean: 0.4485428035259247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026508085429668427, decouple_loss:0.0013663043500855565
Iteration: 4312, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456401765346527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0286767166107893, decouple_loss:0.0013099065981805325
The modified gen p mean: 0.44841617345809937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02754966914653778, decouple_loss:0.0014011862222105265
The modified gen p mean: 0.4459913671016693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025391897186636925, decouple_loss:0.0014065266586840153
Iteration: 4313, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446587473154068, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025377552956342697, decouple_loss:0.0013503534719347954
The modified gen p mean: 0.44441136717796326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028307128697633743, decouple_loss:0.0012843299191445112
The modified gen p mean: 0.44533076882362366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025111187249422073, decouple_loss:0.0011630773078650236
Iteration: 4314, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44895628094673157, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44735100865364075, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02633366361260414, decouple_loss:0.001195818418636918
loss_pred:0.026777220889925957, decouple_loss:0.0012614586157724261
The modified gen p mean: 0.4451347291469574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026442421600222588, decouple_loss:0.0011156470282003284
Iteration: 4315, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44846048951148987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02552804723381996, decouple_loss:0.0013446916127577424
The modified gen p mean: 0.44827836751937866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02803373523056507, decouple_loss:0.0010997338686138391
The modified gen p mean: 0.44895684719085693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025083182379603386, decouple_loss:0.0013471515849232674
Iteration: 4316, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461713433265686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026790322735905647, decouple_loss:0.0013737466651946306
The modified gen p mean: 0.44573038816452026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02672351524233818, decouple_loss:0.001386266783811152
The modified gen p mean: 0.44857072830200195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02639976143836975, decouple_loss:0.0012342350091785192
Iteration: 4317, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44602692127227783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028600800782442093, decouple_loss:0.0013575318735092878
The modified gen p mean: 0.44816622138023376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02549368515610695, decouple_loss:0.0012650920543819666
The modified gen p mean: 0.4456198811531067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027797618880867958, decouple_loss:0.001299101859331131
Iteration: 4318, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45068392157554626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02484123967587948, decouple_loss:0.0012745301937684417
The modified gen p mean: 0.44653379917144775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028391005471348763, decouple_loss:0.0012498070718720555
The modified gen p mean: 0.44788220524787903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025845598429441452, decouple_loss:0.0012225486570969224
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4319, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44813454151153564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025530634447932243, decouple_loss:0.0012261458905413747
The modified gen p mean: 0.44537001848220825, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.448129266500473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02745060622692108, decouple_loss:0.001116366358473897loss_pred:0.025748860090970993, decouple_loss:0.0012071492383256555
Iteration: 4320, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44869863986968994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02495037019252777, decouple_loss:0.0012880064314231277
The modified gen p mean: 0.44656556844711304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026180146262049675, decouple_loss:0.0011201254092156887
The modified gen p mean: 0.44725701212882996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026588579639792442, decouple_loss:0.0012554323766380548
2023-05-27 11:02:32 testing...
The modified gen p mean: 0.4516471326351166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03319761902093887, decouple_loss:0.0014262977056205273
The modified gen p mean: 0.454069584608078, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03307319059967995, decouple_loss:0.0014316991437226534
The modified gen p mean: 0.4537467360496521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03471088036894798, decouple_loss:0.0014733595307916403
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03373275324702263, avg_mse: 0.04624723270535469
current test mse: 0.046247
Iteration: 4321, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44623297452926636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026692358776926994, decouple_loss:0.001149832271039486
The modified gen p mean: 0.4483647346496582, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02640301175415516, decouple_loss:0.0011850852752104402
The modified gen p mean: 0.4477536976337433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02449045702815056, decouple_loss:0.0012651784345507622
Iteration: 4322, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444975256919861, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02662053517997265, decouple_loss:0.0013127857819199562
The modified gen p mean: 0.4478848874568939, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02631915546953678, decouple_loss:0.0013059821212664247
The modified gen p mean: 0.4532650411128998, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025138404220342636, decouple_loss:0.001273051486350596
Iteration: 4323, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445682764053345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02693754807114601, decouple_loss:0.0011758723994717002The modified gen p mean: 0.44998013973236084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025659749284386635, decouple_loss:0.0013503163354471326
The modified gen p mean: 0.4456222653388977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026038791984319687, decouple_loss:0.001251281937584281
Iteration: 4324, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45292791724205017, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4517868459224701, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024696005508303642, decouple_loss:0.001208217814564705
loss_pred:0.02535811811685562, decouple_loss:0.0014023958938196301
The modified gen p mean: 0.4514022171497345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024794040247797966, decouple_loss:0.001288255793042481
Iteration: 4325, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4428671598434448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02648855186998844, decouple_loss:0.0012164961080998182
The modified gen p mean: 0.4496382474899292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025787891820073128, decouple_loss:0.0012302168179303408
The modified gen p mean: 0.44646158814430237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02608981356024742, decouple_loss:0.0012213048757985234
Iteration: 4326, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44483682513237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02428567036986351, decouple_loss:0.0011768920812755823
The modified gen p mean: 0.4434644281864166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026752209290862083, decouple_loss:0.0011665265774354339
The modified gen p mean: 0.4428330957889557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02708801068365574, decouple_loss:0.001190566923469305
Iteration: 4327, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44421592354774475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025600718334317207, decouple_loss:0.0012571223778650165
The modified gen p mean: 0.4418025314807892, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025843895971775055, decouple_loss:0.0013057334581390023
The modified gen p mean: 0.45067065954208374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024523984640836716, decouple_loss:0.0012583512580022216
Iteration: 4328, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44433584809303284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02595682628452778, decouple_loss:0.0012152609415352345
The modified gen p mean: 0.44482526183128357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026486800983548164, decouple_loss:0.0013086071703583002
The modified gen p mean: 0.45181044936180115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024303365498781204, decouple_loss:0.00123498123139143
Iteration: 4329, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450784295797348, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024274248629808426, decouple_loss:0.0011979921255260706
The modified gen p mean: 0.4478461444377899, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024839840829372406, decouple_loss:0.0012215090682730079
The modified gen p mean: 0.4487455189228058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026052124798297882, decouple_loss:0.0012090711388736963
Iteration: 4330, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454028010368347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026759997010231018, decouple_loss:0.0011621919693425298
The modified gen p mean: 0.4453839659690857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02609965391457081, decouple_loss:0.0011627934873104095
The modified gen p mean: 0.4474341571331024, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025648539885878563, decouple_loss:0.001202541054226458
2023-05-27 11:06:37 testing...
The modified gen p mean: 0.45291873812675476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03329147398471832, decouple_loss:0.0014275792054831982
The modified gen p mean: 0.4526233375072479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03485963121056557, decouple_loss:0.0014375553000718355
The modified gen p mean: 0.45052480697631836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033219799399375916, decouple_loss:0.00135488947853446
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03386063501238823, avg_mse: 0.046483542770147324
current test mse: 0.046484
Iteration: 4331, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446435809135437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026586636900901794, decouple_loss:0.0012987027876079082
The modified gen p mean: 0.44572263956069946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027518276125192642, decouple_loss:0.0013237870298326015
The modified gen p mean: 0.44386959075927734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02674286998808384, decouple_loss:0.0011931064072996378
Iteration: 4332, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44839778542518616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024748103693127632, decouple_loss:0.0012688077986240387
The modified gen p mean: 0.4457453489303589, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026170434430241585, decouple_loss:0.001315582194365561
The modified gen p mean: 0.45090410113334656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025859925895929337, decouple_loss:0.0013470774283632636
Iteration: 4333, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45174041390419006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02442319132387638, decouple_loss:0.0012865213211625814
The modified gen p mean: 0.44702842831611633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024592798203229904, decouple_loss:0.0012097915168851614
The modified gen p mean: 0.4456174671649933, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027559148147702217, decouple_loss:0.0011804086389020085
Iteration: 4334, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466754198074341, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025106152519583702, decouple_loss:0.0011906579602509737
The modified gen p mean: 0.4454987347126007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026842376217246056, decouple_loss:0.0011887713335454464
The modified gen p mean: 0.44828182458877563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026526544243097305, decouple_loss:0.0012057615676894784
Iteration: 4335, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44516119360923767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026100121438503265, decouple_loss:0.0012591197155416012
The modified gen p mean: 0.4458105266094208, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026303861290216446, decouple_loss:0.001241748221218586
The modified gen p mean: 0.44668638706207275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02720743417739868, decouple_loss:0.001291763735935092
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4336, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473365247249603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02634223736822605, decouple_loss:0.0012606517411768436
The modified gen p mean: 0.4455077648162842, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4458972215652466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02757769264280796, decouple_loss:0.0013011322589591146
loss_pred:0.026064874604344368, decouple_loss:0.0012451672228053212
Iteration: 4337, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44971606135368347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026692025363445282, decouple_loss:0.0013222664128988981
The modified gen p mean: 0.44841161370277405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02675088308751583, decouple_loss:0.0012284086551517248
The modified gen p mean: 0.44792360067367554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026017382740974426, decouple_loss:0.0013054845621809363
Iteration: 4338, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4451669752597809, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02653377503156662, decouple_loss:0.0011098535032942891
The modified gen p mean: 0.4456092119216919, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02661598101258278, decouple_loss:0.0013114501489326358
The modified gen p mean: 0.4506387412548065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025562556460499763, decouple_loss:0.0013078106567263603
Iteration: 4339, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445944219827652, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4456848204135895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026371335610747337, decouple_loss:0.0011462627444416285
loss_pred:0.026740672066807747, decouple_loss:0.0011576514225453138
The modified gen p mean: 0.444804310798645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026534127071499825, decouple_loss:0.001156300539150834
Iteration: 4340, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44783815741539, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02566642127931118, decouple_loss:0.0014287895755842328
The modified gen p mean: 0.4440031349658966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732965163886547, decouple_loss:0.0011764471419155598
The modified gen p mean: 0.45076999068260193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025796998292207718, decouple_loss:0.0012736201751977205
2023-05-27 11:11:51 testing...
The modified gen p mean: 0.4511149525642395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03358858823776245, decouple_loss:0.0014487976441159844
The modified gen p mean: 0.4488395154476166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03351013362407684, decouple_loss:0.0014813250163570046
The modified gen p mean: 0.4508214592933655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03529605641961098, decouple_loss:0.0014531617052853107
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.034204646944999695, avg_mse: 0.047126658260822296
current test mse: 0.047127
Iteration: 4341, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446951687335968, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024999085813760757, decouple_loss:0.001306444755755365
The modified gen p mean: 0.44567611813545227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673451229929924, decouple_loss:0.0010778038995340466
The modified gen p mean: 0.4454019367694855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02676089107990265, decouple_loss:0.001241151592694223
Iteration: 4342, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44531482458114624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02714383974671364, decouple_loss:0.0012003188021481037
The modified gen p mean: 0.4508321285247803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025963056832551956, decouple_loss:0.0012904811883345246
The modified gen p mean: 0.4491380453109741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0258597731590271, decouple_loss:0.001310955616645515
Iteration: 4343, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44770243763923645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02677830681204796, decouple_loss:0.001196045195683837
The modified gen p mean: 0.4473823606967926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026456518098711967, decouple_loss:0.0012444856110960245
The modified gen p mean: 0.4473264515399933, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02757234498858452, decouple_loss:0.0012840240960940719
Iteration: 4344, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503202438354492, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02587694674730301, decouple_loss:0.001241506775841117
The modified gen p mean: 0.4496757686138153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025965532287955284, decouple_loss:0.0012333522317931056
The modified gen p mean: 0.4449115991592407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02649828791618347, decouple_loss:0.0011610095389187336
Iteration: 4345, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44445720314979553, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44624704122543335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026646140962839127, decouple_loss:0.0012088781222701073
loss_pred:0.027061892673373222, decouple_loss:0.0012880937429144979
The modified gen p mean: 0.44776636362075806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024944521486759186, decouple_loss:0.001342478790320456
Iteration: 4346, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44711050391197205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025307906791567802, decouple_loss:0.0013235965743660927
The modified gen p mean: 0.4466232359409332, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026216698810458183, decouple_loss:0.0011955503141507506
The modified gen p mean: 0.44513431191444397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026591479778289795, decouple_loss:0.001283767051063478
Iteration: 4347, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446170926094055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026031222194433212, decouple_loss:0.001230877824127674
The modified gen p mean: 0.4458305239677429, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026552416384220123, decouple_loss:0.0012070281663909554
The modified gen p mean: 0.4492299258708954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026014229282736778, decouple_loss:0.001252122805453837
Iteration: 4348, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44950294494628906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026233043521642685, decouple_loss:0.0011424010153859854
The modified gen p mean: 0.4461846351623535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783079631626606, decouple_loss:0.001233516726642847
The modified gen p mean: 0.4500669538974762, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02605494298040867, decouple_loss:0.0012552691623568535
Iteration: 4349, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449160099029541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026212554425001144, decouple_loss:0.0012128518428653479
The modified gen p mean: 0.4518756866455078, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025730015709996223, decouple_loss:0.0012572843115776777
The modified gen p mean: 0.44727063179016113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027609270066022873, decouple_loss:0.0011458111694082618
Iteration: 4350, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505913257598877, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025416366755962372, decouple_loss:0.0011520357802510262
The modified gen p mean: 0.4465901255607605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02629416063427925, decouple_loss:0.0011449026642367244
The modified gen p mean: 0.45273974537849426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026381606236100197, decouple_loss:0.0012261226074770093
2023-05-27 11:15:57 testing...
The modified gen p mean: 0.4532395303249359, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033668506890535355, decouple_loss:0.0013882920611649752
The modified gen p mean: 0.45110633969306946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03364571928977966, decouple_loss:0.0013527729315683246
The modified gen p mean: 0.45308783650398254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03531467914581299, decouple_loss:0.001483549945987761
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.034280046820640564, avg_mse: 0.04721667990088463
current test mse: 0.047217
Iteration: 4351, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44717276096343994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02595720812678337, decouple_loss:0.0012153638526797295
The modified gen p mean: 0.44967716932296753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02553289383649826, decouple_loss:0.001152500743046403
The modified gen p mean: 0.4479072093963623, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026762399822473526, decouple_loss:0.0011530114570632577
Iteration: 4352, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45289236307144165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025891529396176338, decouple_loss:0.0013311465736478567
The modified gen p mean: 0.4485192894935608, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02579822577536106, decouple_loss:0.0012625643284991384
The modified gen p mean: 0.4467466175556183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02684945799410343, decouple_loss:0.0013147459831088781
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4353, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502997100353241, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029140906408429146, decouple_loss:0.0012536653084680438
The modified gen p mean: 0.4477873146533966, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4455872178077698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029395384714007378, decouple_loss:0.0011698644375428557
loss_pred:0.029390642419457436, decouple_loss:0.0012394501827657223
Iteration: 4354, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44670408964157104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02939976193010807, decouple_loss:0.0012530068634077907
The modified gen p mean: 0.4501675069332123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028915129601955414, decouple_loss:0.0013433637795969844
The modified gen p mean: 0.4473133385181427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030149446800351143, decouple_loss:0.0012887255288660526
Iteration: 4355, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45270344614982605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028350627049803734, decouple_loss:0.0012870021164417267
The modified gen p mean: 0.45194512605667114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028408465906977654, decouple_loss:0.0012630096171051264
The modified gen p mean: 0.44874146580696106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029265793040394783, decouple_loss:0.0012292417231947184
Iteration: 4356, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4558238983154297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028678249567747116, decouple_loss:0.0013652597554028034
The modified gen p mean: 0.45052024722099304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029885999858379364, decouple_loss:0.0011650158558040857
The modified gen p mean: 0.4503030776977539, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029712002724409103, decouple_loss:0.001132508390583098
Iteration: 4357, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494190514087677, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4520978331565857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029484767466783524, decouple_loss:0.001307373633608222
loss_pred:0.028921902179718018, decouple_loss:0.0011953440262004733
The modified gen p mean: 0.451498419046402, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029572274535894394, decouple_loss:0.0013106612022966146
Iteration: 4358, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484790861606598, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028918759897351265, decouple_loss:0.0011094800429418683
The modified gen p mean: 0.4546518623828888, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0295595433562994, decouple_loss:0.001204548287205398
The modified gen p mean: 0.4512946605682373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028098417446017265, decouple_loss:0.0012542015174403787
Iteration: 4359, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44996941089630127, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44903597235679626, gen p mean: 0.0, mean p set: 0.448loss_pred:0.029410991817712784, decouple_loss:0.0012507044011726975
loss_pred:0.02944398857653141, decouple_loss:0.0011505321599543095
The modified gen p mean: 0.4491579830646515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030169356614351273, decouple_loss:0.0012147577945142984
Iteration: 4360, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504832923412323, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45001691579818726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028414838016033173, decouple_loss:0.0012146041262894869
loss_pred:0.02857540175318718, decouple_loss:0.001371040241792798
The modified gen p mean: 0.45269569754600525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028911292552947998, decouple_loss:0.0011465451680123806
2023-05-27 11:21:21 testing...
The modified gen p mean: 0.4513499438762665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03245798125863075, decouple_loss:0.0013670624466612935
The modified gen p mean: 0.4509461522102356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03395979851484299, decouple_loss:0.0014678091974928975
The modified gen p mean: 0.4492782652378082, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03259045630693436, decouple_loss:0.001292326720431447
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03307153284549713, avg_mse: 0.0450182780623436
current test mse: 0.045018
Iteration: 4361, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472733438014984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027316154912114143, decouple_loss:0.0012480836594477296
The modified gen p mean: 0.44897669553756714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029304778203368187, decouple_loss:0.0013324313331395388
The modified gen p mean: 0.4473991096019745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030440235510468483, decouple_loss:0.0011393354507163167
Iteration: 4362, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478825032711029, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027694327756762505, decouple_loss:0.0013941865181550384
The modified gen p mean: 0.44938719272613525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02814548648893833, decouple_loss:0.00135191495064646
The modified gen p mean: 0.4501579999923706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02808673307299614, decouple_loss:0.0013494653394445777
Iteration: 4363, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4437088072299957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028298137709498405, decouple_loss:0.0012582456693053246
The modified gen p mean: 0.4451739490032196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029614005237817764, decouple_loss:0.0011687763035297394
The modified gen p mean: 0.44556760787963867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0286294836550951, decouple_loss:0.0012099983869120479
Iteration: 4364, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44563978910446167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030701929703354836, decouple_loss:0.0011519071413204074
The modified gen p mean: 0.4451296627521515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029766090214252472, decouple_loss:0.001195439137518406
The modified gen p mean: 0.44998252391815186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027885714545845985, decouple_loss:0.0012854813830927014
Iteration: 4365, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44821858406066895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028484130278229713, decouple_loss:0.0013237162493169308
The modified gen p mean: 0.44952666759490967, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02787247858941555, decouple_loss:0.0013138597132638097
The modified gen p mean: 0.44792085886001587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029039153829216957, decouple_loss:0.0011756463209167123
Iteration: 4366, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4517033100128174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02861752361059189, decouple_loss:0.001413328223861754
The modified gen p mean: 0.4495103359222412, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02897178754210472, decouple_loss:0.0011773668229579926
The modified gen p mean: 0.44873377680778503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028391262516379356, decouple_loss:0.0011968016624450684
Iteration: 4367, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45029130578041077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027582380920648575, decouple_loss:0.0012665875256061554
The modified gen p mean: 0.4493286907672882, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028682943433523178, decouple_loss:0.0011106864549219608
The modified gen p mean: 0.44802144169807434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030363747850060463, decouple_loss:0.001117978128604591
Iteration: 4368, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44834718108177185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02979235351085663, decouple_loss:0.0012195344315841794
The modified gen p mean: 0.4490697681903839, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027281707152724266, decouple_loss:0.0011918514501303434
The modified gen p mean: 0.4523330330848694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02858901582658291, decouple_loss:0.001319300034083426
Iteration: 4369, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485706388950348, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028289351612329483, decouple_loss:0.0013754282845184207
The modified gen p mean: 0.45012134313583374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02849718928337097, decouple_loss:0.0013092783046886325
The modified gen p mean: 0.44815030694007874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029542401432991028, decouple_loss:0.0012942092726007104
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr.npz
NaN value num: 0
Iteration: 4370, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518316090106964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028419502079486847, decouple_loss:0.0012223157100379467
The modified gen p mean: 0.44999220967292786, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4497807025909424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029733896255493164, decouple_loss:0.0013240063562989235
loss_pred:0.02840648777782917, decouple_loss:0.0013930905843153596
2023-05-27 11:26:06 testing...
The modified gen p mean: 0.4526195824146271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032434798777103424, decouple_loss:0.0013938115444034338
The modified gen p mean: 0.4522255063056946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034124087542295456, decouple_loss:0.001483065658248961
The modified gen p mean: 0.4506034851074219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032781220972537994, decouple_loss:0.0013958093477413058
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03318458050489426, avg_mse: 0.045238297432661057
current test mse: 0.045238
Iteration: 4371, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469612240791321, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028881298378109932, decouple_loss:0.0013054050505161285
The modified gen p mean: 0.44732344150543213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02972152642905712, decouple_loss:0.001255989889614284
The modified gen p mean: 0.44754812121391296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028151866048574448, decouple_loss:0.0012231167638674378
Iteration: 4372, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45071646571159363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02843869850039482, decouple_loss:0.0013195029459893703
The modified gen p mean: 0.44679802656173706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028532356023788452, decouple_loss:0.001261258265003562
The modified gen p mean: 0.4487055242061615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028248867020010948, decouple_loss:0.0012175991432741284
Iteration: 4373, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496341347694397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028979869559407234, decouple_loss:0.0013474979205057025
The modified gen p mean: 0.44832178950309753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02815122716128826, decouple_loss:0.0013091850560158491
The modified gen p mean: 0.4483776390552521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02856902778148651, decouple_loss:0.0012973722768947482
Iteration: 4374, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466768503189087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028460757806897163, decouple_loss:0.0012299204245209694
The modified gen p mean: 0.45298707485198975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02797948382794857, decouple_loss:0.001334396773017943
The modified gen p mean: 0.4475652873516083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029849370941519737, decouple_loss:0.0013724863529205322
Iteration: 4375, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483327567577362, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027627993375062943, decouple_loss:0.001285891281440854
The modified gen p mean: 0.45197367668151855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027170132845640182, decouple_loss:0.001553871901705861
The modified gen p mean: 0.4503372609615326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02938574180006981, decouple_loss:0.0012572138803079724
Iteration: 4376, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449301540851593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028192749246954918, decouple_loss:0.0013914849841967225
The modified gen p mean: 0.45014891028404236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027899790555238724, decouple_loss:0.0013885559746995568
The modified gen p mean: 0.4527946710586548, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029186910018324852, decouple_loss:0.0016346201300621033
Iteration: 4377, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45079585909843445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0286707766354084, decouple_loss:0.0013659364776685834
The modified gen p mean: 0.4486197829246521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028811722993850708, decouple_loss:0.0013052814174443483
The modified gen p mean: 0.4508090615272522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027344616129994392, decouple_loss:0.0013612679904326797
Iteration: 4378, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44993188977241516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0289109218865633, decouple_loss:0.0012924146139994264
The modified gen p mean: 0.44978341460227966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02733762376010418, decouple_loss:0.0013000370236113667
The modified gen p mean: 0.4505082070827484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02909214235842228, decouple_loss:0.0012061581946909428
Iteration: 4379, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44914013147354126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02845747396349907, decouple_loss:0.0013382890028879046
The modified gen p mean: 0.44682055711746216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027058035135269165, decouple_loss:0.0014478411758318543
The modified gen p mean: 0.4468817114830017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028866693377494812, decouple_loss:0.0013347561471164227
Iteration: 4380, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490225613117218, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027503712102770805, decouple_loss:0.0012789075262844563
The modified gen p mean: 0.4507252871990204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02844967134296894, decouple_loss:0.0012798203388229012
The modified gen p mean: 0.44845691323280334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02790810912847519, decouple_loss:0.0013313295785337687
2023-05-27 11:30:14 testing...
The modified gen p mean: 0.4519801735877991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03237840533256531, decouple_loss:0.0014066832372918725
The modified gen p mean: 0.4517659544944763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03387119248509407, decouple_loss:0.001517687807790935
The modified gen p mean: 0.45015600323677063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03268442675471306, decouple_loss:0.0013286923058331013
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03304889425635338, avg_mse: 0.045094240456819534
current test mse: 0.045094
Iteration: 4381, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44665783643722534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028007056564092636, decouple_loss:0.0012820373522117734
The modified gen p mean: 0.4457888603210449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028541574254631996, decouple_loss:0.001176011748611927
The modified gen p mean: 0.4465474784374237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0278924610465765, decouple_loss:0.0013176632346585393
Iteration: 4382, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458727538585663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02755301631987095, decouple_loss:0.0012685596011579037
The modified gen p mean: 0.4466257691383362, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028314806520938873, decouple_loss:0.0012522279284894466
The modified gen p mean: 0.4472101330757141, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02799176052212715, decouple_loss:0.0012441641883924603
Iteration: 4383, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45165324211120605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027410535141825676, decouple_loss:0.0012575123691931367
The modified gen p mean: 0.4474600851535797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029173757880926132, decouple_loss:0.001118068932555616
The modified gen p mean: 0.44777432084083557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027731481939554214, decouple_loss:0.0013496964238584042
Iteration: 4384, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500262439250946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0276052076369524, decouple_loss:0.0012253939639776945
The modified gen p mean: 0.44886574149131775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02887345477938652, decouple_loss:0.0012541296891868114
The modified gen p mean: 0.4509905278682709, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026529783383011818, decouple_loss:0.001351365353912115
Iteration: 4385, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44897711277008057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02734493650496006, decouple_loss:0.001272239605896175
The modified gen p mean: 0.4491807818412781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02865924872457981, decouple_loss:0.001279371907003224
The modified gen p mean: 0.4480357766151428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02724570967257023, decouple_loss:0.0013049982953816652
Iteration: 4386, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.452119916677475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027463074773550034, decouple_loss:0.0013627009466290474
The modified gen p mean: 0.4473619759082794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02818780392408371, decouple_loss:0.0012225073296576738
The modified gen p mean: 0.45087093114852905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028405101969838142, decouple_loss:0.0012887518387287855
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr.npz
NaN value num: 0
Iteration: 4387, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497414231300354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028373299166560173, decouple_loss:0.0013384574558585882
The modified gen p mean: 0.4535326063632965, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.449405699968338, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02660645917057991, decouple_loss:0.0013467230601236224
loss_pred:0.02684461884200573, decouple_loss:0.0013190862955525517
Iteration: 4388, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503934383392334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027265584096312523, decouple_loss:0.001194672891870141
The modified gen p mean: 0.45261165499687195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027629809454083443, decouple_loss:0.0013128612190485
The modified gen p mean: 0.45141616463661194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024997040629386902, decouple_loss:0.0013016554294154048
Iteration: 4389, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454423189163208, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026593517512083054, decouple_loss:0.0012252669548615813
The modified gen p mean: 0.4474504590034485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025829346850514412, decouple_loss:0.001252485322766006
The modified gen p mean: 0.44897377490997314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02483169175684452, decouple_loss:0.0013366112252697349
Iteration: 4390, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44619491696357727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02750307321548462, decouple_loss:0.0012190536363050342
The modified gen p mean: 0.4473363161087036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026602165773510933, decouple_loss:0.0012823475990444422
The modified gen p mean: 0.45080190896987915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025256676599383354, decouple_loss:0.0011094564106315374
2023-05-27 11:35:02 testing...
The modified gen p mean: 0.45065927505493164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03235949948430061, decouple_loss:0.0014534816145896912
The modified gen p mean: 0.44897428154945374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03278272598981857, decouple_loss:0.0013316184049472213
The modified gen p mean: 0.4505710005760193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034006908535957336, decouple_loss:0.0014573587104678154
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03312041983008385, avg_mse: 0.04519457370042801
current test mse: 0.045195
Iteration: 4391, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454633593559265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026280490681529045, decouple_loss:0.001176638645119965
The modified gen p mean: 0.44488266110420227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026525860652327538, decouple_loss:0.0011482042027637362
The modified gen p mean: 0.4446270167827606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027174798771739006, decouple_loss:0.00118936353828758
Iteration: 4392, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44425898790359497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026108983904123306, decouple_loss:0.001307326485402882
The modified gen p mean: 0.44731178879737854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027576664462685585, decouple_loss:0.001331046223640442
The modified gen p mean: 0.44647839665412903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025064464658498764, decouple_loss:0.0014163588639348745
Iteration: 4393, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474935233592987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025382643565535545, decouple_loss:0.0014050829922780395
The modified gen p mean: 0.4480433464050293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02637350931763649, decouple_loss:0.0013510760618373752
The modified gen p mean: 0.44570279121398926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027530724182724953, decouple_loss:0.0012608695542439818
Iteration: 4394, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44842296838760376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02504982426762581, decouple_loss:0.001424126443453133
The modified gen p mean: 0.4474382698535919, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02648334763944149, decouple_loss:0.001190518494695425
The modified gen p mean: 0.44509580731391907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732267417013645, decouple_loss:0.0013025443768128753
Iteration: 4395, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478475749492645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02702064998447895, decouple_loss:0.001147655420936644
The modified gen p mean: 0.44919276237487793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025587277486920357, decouple_loss:0.0015043519670143723
The modified gen p mean: 0.45022204518318176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026393214240670204, decouple_loss:0.001195850083604455
Iteration: 4396, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490897059440613, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026796109974384308, decouple_loss:0.0012150225229561329
The modified gen p mean: 0.4507938325405121, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026463167741894722, decouple_loss:0.001270849141292274
The modified gen p mean: 0.4515284597873688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027303816750645638, decouple_loss:0.001269704313017428
Iteration: 4397, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4542120099067688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027425436303019524, decouple_loss:0.0013773627579212189
The modified gen p mean: 0.45012983679771423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026739491149783134, decouple_loss:0.0011825116816908121
The modified gen p mean: 0.4506879150867462, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026152705773711205, decouple_loss:0.0012144942302256823
Iteration: 4398, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491821527481079, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02678576298058033, decouple_loss:0.0012931405799463391
The modified gen p mean: 0.4533923864364624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02478128857910633, decouple_loss:0.0012663500383496284
The modified gen p mean: 0.4501107335090637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02624860405921936, decouple_loss:0.0012014616513624787
Iteration: 4399, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4522819519042969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02780785597860813, decouple_loss:0.0011942613637074828
The modified gen p mean: 0.45218929648399353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0252581425011158, decouple_loss:0.0011990973725914955
The modified gen p mean: 0.45226240158081055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026911785826086998, decouple_loss:0.0011514272773638368
Iteration: 4400, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.452079713344574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026145007461309433, decouple_loss:0.0011662744218483567
The modified gen p mean: 0.45240235328674316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025216534733772278, decouple_loss:0.0012291029561311007
The modified gen p mean: 0.4509322941303253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027017081156373024, decouple_loss:0.0011668546358123422
2023-05-27 11:39:10 testing...
The modified gen p mean: 0.4550861418247223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03245820850133896, decouple_loss:0.0014311671257019043
The modified gen p mean: 0.4533626139163971, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03271545097231865, decouple_loss:0.0013371871318668127
The modified gen p mean: 0.45497336983680725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0340886116027832, decouple_loss:0.001420584274455905
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033157240599393845, avg_mse: 0.04527104273438454
current test mse: 0.045271
Iteration: 4401, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44971197843551636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026118608191609383, decouple_loss:0.0012451432412490249
The modified gen p mean: 0.45427101850509644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026270508766174316, decouple_loss:0.0012097700964659452
The modified gen p mean: 0.4507227838039398, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027440575882792473, decouple_loss:0.0012361599365249276
Iteration: 4402, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499227702617645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026828592643141747, decouple_loss:0.0013070644345134497
The modified gen p mean: 0.45025840401649475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025496188551187515, decouple_loss:0.0012018338311463594
The modified gen p mean: 0.4513612687587738, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02560298703610897, decouple_loss:0.001212707837112248
Iteration: 4403, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44869500398635864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02776125632226467, decouple_loss:0.0013943210942670703
The modified gen p mean: 0.44943517446517944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027369078248739243, decouple_loss:0.0013231950579211116
The modified gen p mean: 0.45026931166648865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02466380037367344, decouple_loss:0.0012955290731042624
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr.npz
NaN value num: 0
Iteration: 4404, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473172128200531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029103407636284828, decouple_loss:0.001125238835811615
The modified gen p mean: 0.44783836603164673, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4514314830303192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02909192629158497, decouple_loss:0.001101369154639542loss_pred:0.028786292299628258, decouple_loss:0.001324187614955008
Iteration: 4405, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479982256889343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030732305720448494, decouple_loss:0.0012924184557050467
The modified gen p mean: 0.45320481061935425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0281381756067276, decouple_loss:0.001260525081306696
The modified gen p mean: 0.4482062757015228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02926516719162464, decouple_loss:0.0011532476637512445
Iteration: 4406, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44831010699272156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028210651129484177, decouple_loss:0.0012130688410252333
The modified gen p mean: 0.4476723074913025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02787959761917591, decouple_loss:0.0011171550722792745
The modified gen p mean: 0.4483233392238617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029729757457971573, decouple_loss:0.0013364374171942472
Iteration: 4407, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471489191055298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028712613508105278, decouple_loss:0.0012588497484102845
The modified gen p mean: 0.4518277645111084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03034055233001709, decouple_loss:0.001294485293328762
The modified gen p mean: 0.4469049870967865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029281673952937126, decouple_loss:0.001283216872252524
Iteration: 4408, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486415386199951, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028049908578395844, decouple_loss:0.0011413668980821967
The modified gen p mean: 0.44770345091819763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028684016317129135, decouple_loss:0.0011454218765720725
The modified gen p mean: 0.45152321457862854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02646644227206707, decouple_loss:0.0011845920234918594
Iteration: 4409, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506703019142151, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028721852228045464, decouple_loss:0.0011898669181391597
The modified gen p mean: 0.4488072991371155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029491659253835678, decouple_loss:0.001095735700801015
The modified gen p mean: 0.453414648771286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027974490076303482, decouple_loss:0.0010600285604596138
Iteration: 4410, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45441964268684387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028057251125574112, decouple_loss:0.0012182833161205053
The modified gen p mean: 0.45076045393943787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029545025900006294, decouple_loss:0.0012118484592065215
The modified gen p mean: 0.4518304169178009, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028028881177306175, decouple_loss:0.0011471997713670135
2023-05-27 11:43:55 testing...
The modified gen p mean: 0.4548916518688202, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032300420105457306, decouple_loss:0.0013816424179822206
The modified gen p mean: 0.45299139618873596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03274717926979065, decouple_loss:0.0012991941766813397
The modified gen p mean: 0.45468080043792725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03410233184695244, decouple_loss:0.0014387015253305435
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033118635416030884, avg_mse: 0.045155566185712814
current test mse: 0.045156
Iteration: 4411, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45325005054473877, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02743268385529518, decouple_loss:0.001106203650124371
The modified gen p mean: 0.4527767598628998, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029952945187687874, decouple_loss:0.0012909207725897431
The modified gen p mean: 0.45558738708496094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027725130319595337, decouple_loss:0.0011583918239921331
Iteration: 4412, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451628714799881, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027356715872883797, decouple_loss:0.0011692348634824157
The modified gen p mean: 0.44967541098594666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028599964454770088, decouple_loss:0.0011454980121925473
The modified gen p mean: 0.45443853735923767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028382012620568275, decouple_loss:0.001243269769474864
Iteration: 4413, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44917795062065125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028633225709199905, decouple_loss:0.001145534566603601
The modified gen p mean: 0.44831156730651855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02903398871421814, decouple_loss:0.0011544966837391257
The modified gen p mean: 0.45370858907699585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027980880811810493, decouple_loss:0.0012841869611293077
Iteration: 4414, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489389657974243, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02758733183145523, decouple_loss:0.0011223729234188795
The modified gen p mean: 0.4488287568092346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0292081069201231, decouple_loss:0.0011695983121171594
The modified gen p mean: 0.44963333010673523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0291985422372818, decouple_loss:0.0011644704500213265
Iteration: 4415, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502899646759033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027893656864762306, decouple_loss:0.0011404764372855425
The modified gen p mean: 0.45159560441970825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029021786525845528, decouple_loss:0.0010993564501404762
The modified gen p mean: 0.4479835033416748, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027603527531027794, decouple_loss:0.0012219161726534367
Iteration: 4416, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508834481239319, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028011253103613853, decouple_loss:0.0013033767463639379
The modified gen p mean: 0.4514661729335785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029660312458872795, decouple_loss:0.0012908556964248419
The modified gen p mean: 0.44663774967193604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0276271291077137, decouple_loss:0.0011162285227328539
Iteration: 4417, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4511260390281677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029411697760224342, decouple_loss:0.0012890604557469487
The modified gen p mean: 0.44855883717536926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027356339618563652, decouple_loss:0.0012668210547417402
The modified gen p mean: 0.45298129320144653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02971898764371872, decouple_loss:0.001215884811244905
Iteration: 4418, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512704014778137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02869071625173092, decouple_loss:0.0012399873230606318
The modified gen p mean: 0.44827377796173096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030018508434295654, decouple_loss:0.001238674158230424
The modified gen p mean: 0.4499264061450958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027415448799729347, decouple_loss:0.001196378841996193
Iteration: 4419, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488767087459564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0283882524818182, decouple_loss:0.001174245961010456
The modified gen p mean: 0.4492044150829315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027522439137101173, decouple_loss:0.0012914007529616356
The modified gen p mean: 0.4525977373123169, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02759966067969799, decouple_loss:0.001105212839320302
Iteration: 4420, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.452297568321228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03030230849981308, decouple_loss:0.0012301425449550152
The modified gen p mean: 0.4516761898994446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029520150274038315, decouple_loss:0.0011277898447588086
The modified gen p mean: 0.4536884129047394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02785337157547474, decouple_loss:0.0012241211952641606
2023-05-27 11:48:01 testing...
The modified gen p mean: 0.45576974749565125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03233112394809723, decouple_loss:0.00142477301415056
The modified gen p mean: 0.4537626802921295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03280721604824066, decouple_loss:0.001355277607217431
The modified gen p mean: 0.4554254710674286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034075915813446045, decouple_loss:0.0014574337983503938
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03314204514026642, avg_mse: 0.0452166423201561
current test mse: 0.045217
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr.npz
NaN value num: 0
Iteration: 4421, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45397865772247314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028730640187859535, decouple_loss:0.001285947160795331
The modified gen p mean: 0.4540567994117737, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4509972631931305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029162418097257614, decouple_loss:0.001253942959010601
loss_pred:0.02876444160938263, decouple_loss:0.0013353190151974559
Iteration: 4422, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45444729924201965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028761504217982292, decouple_loss:0.0012341691181063652
The modified gen p mean: 0.45047369599342346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02906198240816593, decouple_loss:0.0011902761179953814
The modified gen p mean: 0.44878527522087097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029673462733626366, decouple_loss:0.0012990770628675818
Iteration: 4423, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518120586872101, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028640348464250565, decouple_loss:0.0011295148869976401
The modified gen p mean: 0.4520229995250702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029512222856283188, decouple_loss:0.001124915899708867
The modified gen p mean: 0.4474339783191681, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0296928808093071, decouple_loss:0.0013447579694911838
Iteration: 4424, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45016229152679443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02889154851436615, decouple_loss:0.0012728002620860934
The modified gen p mean: 0.4503830671310425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02770954743027687, decouple_loss:0.00128364737611264
The modified gen p mean: 0.45128414034843445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02706303261220455, decouple_loss:0.001281044096685946
Iteration: 4425, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44949761033058167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02819588966667652, decouple_loss:0.0011724478099495173
The modified gen p mean: 0.4529140591621399, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771785669028759, decouple_loss:0.0011648256331682205
The modified gen p mean: 0.4527117908000946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029037563130259514, decouple_loss:0.0012905513867735863
Iteration: 4426, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45081186294555664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027517011389136314, decouple_loss:0.0011585346655920148
The modified gen p mean: 0.4482455551624298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028922032564878464, decouple_loss:0.0011483982671052217
The modified gen p mean: 0.4471890926361084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028559887781739235, decouple_loss:0.0012447366025298834
Iteration: 4427, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514946937561035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027528123930096626, decouple_loss:0.0012432048097252846
The modified gen p mean: 0.44511762261390686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02880733273923397, decouple_loss:0.001348257064819336
The modified gen p mean: 0.4504082500934601, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027126459404826164, decouple_loss:0.0012085583293810487
Iteration: 4428, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44901242852211, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029465090483427048, decouple_loss:0.0012019635178148746
The modified gen p mean: 0.44737154245376587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028857773169875145, decouple_loss:0.0013040147023275495
The modified gen p mean: 0.4480563700199127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027862871065735817, decouple_loss:0.0011478825472295284
Iteration: 4429, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44637420773506165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029038241133093834, decouple_loss:0.001316080684773624
The modified gen p mean: 0.4486125707626343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02874365821480751, decouple_loss:0.001290566986426711
The modified gen p mean: 0.44640934467315674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029400896281003952, decouple_loss:0.0011891659814864397
Iteration: 4430, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44568097591400146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02884703315794468, decouple_loss:0.0012364175636321306
The modified gen p mean: 0.4466078281402588, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029947461560368538, decouple_loss:0.0012418619589880109
The modified gen p mean: 0.44569653272628784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027818957343697548, decouple_loss:0.0012742545222863555
2023-05-27 11:52:44 testing...
The modified gen p mean: 0.4520518183708191, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032075364142656326, decouple_loss:0.001393200014717877
The modified gen p mean: 0.4501367509365082, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0327969528734684, decouple_loss:0.001299573457799852
The modified gen p mean: 0.451673686504364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03394249826669693, decouple_loss:0.0014454093761742115
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033007241785526276, avg_mse: 0.04493800550699234
current test mse: 0.044938
Iteration: 4431, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44737425446510315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02905910462141037, decouple_loss:0.0012605314841493964
The modified gen p mean: 0.4463351368904114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02770247682929039, decouple_loss:0.001194932498037815
The modified gen p mean: 0.44624844193458557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029656345024704933, decouple_loss:0.0012160163605585694
Iteration: 4432, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503006637096405, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44683173298835754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02871330827474594, decouple_loss:0.0012420988641679287
loss_pred:0.028470579534769058, decouple_loss:0.0012366634327918291
The modified gen p mean: 0.4467286765575409, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02905263379216194, decouple_loss:0.0011603961465880275
Iteration: 4433, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44702285528182983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029100127518177032, decouple_loss:0.0012385172303766012
The modified gen p mean: 0.4473069906234741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02766009420156479, decouple_loss:0.0012073725229129195
The modified gen p mean: 0.44562751054763794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028407208621501923, decouple_loss:0.0012751951580867171
Iteration: 4434, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45056551694869995, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4466364085674286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02754594385623932, decouple_loss:0.001312251202762127
loss_pred:0.027723999693989754, decouple_loss:0.001160689047537744
The modified gen p mean: 0.44530320167541504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027986474335193634, decouple_loss:0.0011787679977715015
Iteration: 4435, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44762885570526123, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44925355911254883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028078196570277214, decouple_loss:0.0012675975449383259
loss_pred:0.028295887634158134, decouple_loss:0.0011828632559627295
The modified gen p mean: 0.44577160477638245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028002649545669556, decouple_loss:0.0012312863254919648
Iteration: 4436, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482971131801605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02831997163593769, decouple_loss:0.0012084429617971182
The modified gen p mean: 0.45112258195877075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02777661569416523, decouple_loss:0.001225444138981402
The modified gen p mean: 0.44640353322029114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028389859944581985, decouple_loss:0.0011695100693032146
Iteration: 4437, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498683512210846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028056994080543518, decouple_loss:0.0011633452959358692
The modified gen p mean: 0.44707632064819336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02897997945547104, decouple_loss:0.0012084557674825191
The modified gen p mean: 0.4502508044242859, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027239566668868065, decouple_loss:0.001215670257806778
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4438, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44666504859924316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027310902252793312, decouple_loss:0.0012308983132243156
The modified gen p mean: 0.4492773115634918, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02634577825665474, decouple_loss:0.0012194348964840174
The modified gen p mean: 0.44656893610954285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028432883322238922, decouple_loss:0.0011984179727733135
Iteration: 4439, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471473693847656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028772549703717232, decouple_loss:0.0012344978749752045
The modified gen p mean: 0.45300573110580444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02671327255666256, decouple_loss:0.0014198151184245944
The modified gen p mean: 0.4469118118286133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783086709678173, decouple_loss:0.0012409326154738665
Iteration: 4440, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45197704434394836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027378853410482407, decouple_loss:0.0013142148964107037
The modified gen p mean: 0.4461303651332855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02924179658293724, decouple_loss:0.0012628007680177689
The modified gen p mean: 0.451874703168869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026241816580295563, decouple_loss:0.0012667113915085793
2023-05-27 11:57:40 testing...
The modified gen p mean: 0.4531545042991638, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03223155438899994, decouple_loss:0.001388366799801588
The modified gen p mean: 0.45134681463241577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03290342167019844, decouple_loss:0.0013896255986765027
The modified gen p mean: 0.45283690094947815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03421572595834732, decouple_loss:0.0014422705862671137
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03318724036216736, avg_mse: 0.04521673172712326
current test mse: 0.045217
Iteration: 4441, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44840162992477417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027302592992782593, decouple_loss:0.0011656981660053134
The modified gen p mean: 0.45150285959243774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026733756065368652, decouple_loss:0.0011702805059030652
The modified gen p mean: 0.4475333094596863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02765258029103279, decouple_loss:0.0012125293724238873
Iteration: 4442, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45046210289001465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02894478105008602, decouple_loss:0.0012695470359176397
The modified gen p mean: 0.4506067633628845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02619941160082817, decouple_loss:0.0012057108106091619
The modified gen p mean: 0.45152074098587036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02805543690919876, decouple_loss:0.001150895725004375
Iteration: 4443, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451248437166214, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45054900646209717, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025974631309509277, decouple_loss:0.0012044004397466779
loss_pred:0.02786954678595066, decouple_loss:0.0012414423981681466
The modified gen p mean: 0.4463891088962555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029557624831795692, decouple_loss:0.0011989852646365762
Iteration: 4444, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44682133197784424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02781054750084877, decouple_loss:0.0014379373751580715
The modified gen p mean: 0.4469248056411743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027015041559934616, decouple_loss:0.001189057482406497
The modified gen p mean: 0.44768232107162476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027914443984627724, decouple_loss:0.0012348112650215626
Iteration: 4445, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44388964772224426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025619857013225555, decouple_loss:0.0012607417302206159
The modified gen p mean: 0.4477619230747223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02688673324882984, decouple_loss:0.001400660490617156
The modified gen p mean: 0.4471273124217987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02630343660712242, decouple_loss:0.001405496965162456
Iteration: 4446, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44304683804512024, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027267543599009514, decouple_loss:0.0011871373280882835
The modified gen p mean: 0.4473702609539032, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02556384727358818, decouple_loss:0.001307260012254119
The modified gen p mean: 0.4487476646900177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026722967624664307, decouple_loss:0.0013644230784848332
Iteration: 4447, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4448447525501251, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02667156234383583, decouple_loss:0.0011401898227632046
The modified gen p mean: 0.4460107088088989, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732844650745392, decouple_loss:0.0012819799594581127
The modified gen p mean: 0.4442673921585083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027543021366000175, decouple_loss:0.0011223509209230542
Iteration: 4448, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446609765291214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027888942509889603, decouple_loss:0.0012260675430297852
The modified gen p mean: 0.4478718638420105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026700664311647415, decouple_loss:0.0013639084063470364
The modified gen p mean: 0.4471484422683716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029048511758446693, decouple_loss:0.0012800598051398993
Iteration: 4449, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44958290457725525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028557660058140755, decouple_loss:0.0013224765425547957
The modified gen p mean: 0.44888392090797424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02776121161878109, decouple_loss:0.0012045502662658691
The modified gen p mean: 0.45084476470947266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026157237589359283, decouple_loss:0.0012369242031127214
Iteration: 4450, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499645531177521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02785254269838333, decouple_loss:0.0012743242550641298
The modified gen p mean: 0.4527050256729126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02490675263106823, decouple_loss:0.0012013626983389258
The modified gen p mean: 0.4528336822986603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02742340788245201, decouple_loss:0.0013771789381280541
2023-05-27 12:01:46 testing...
The modified gen p mean: 0.45542073249816895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03235084190964699, decouple_loss:0.00147692218888551
The modified gen p mean: 0.4536173343658447, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.455194354057312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0330197736620903, decouple_loss:0.0014909630408510566
loss_pred:0.03439287096261978, decouple_loss:0.0014221066376194358
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03332766145467758, avg_mse: 0.0453847199678421
current test mse: 0.045385
Iteration: 4451, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510067105293274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027909424155950546, decouple_loss:0.0012404972221702337
The modified gen p mean: 0.4541891813278198, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026469212025403976, decouple_loss:0.00138120970223099
The modified gen p mean: 0.4494074285030365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02832329086959362, decouple_loss:0.0013000712497159839
Iteration: 4452, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4530157744884491, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025467243045568466, decouple_loss:0.0013490737183019519
The modified gen p mean: 0.45001304149627686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027721328660845757, decouple_loss:0.001180147402919829
The modified gen p mean: 0.4505408704280853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026791468262672424, decouple_loss:0.0012469968060031533
Iteration: 4453, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485052227973938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027912026271224022, decouple_loss:0.0012254297034814954
The modified gen p mean: 0.4480598270893097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02774249203503132, decouple_loss:0.0012456014519557357
The modified gen p mean: 0.45003288984298706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027229521423578262, decouple_loss:0.0011701745679602027
Iteration: 4454, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44972360134124756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027193419635295868, decouple_loss:0.001325034536421299
The modified gen p mean: 0.4451984167098999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0280290637165308, decouple_loss:0.0013951772125437856
The modified gen p mean: 0.4491302967071533, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025883473455905914, decouple_loss:0.001363694784231484
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4455, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44893938302993774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025833895429968834, decouple_loss:0.0013019852340221405
The modified gen p mean: 0.44802138209342957, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4439283311367035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02541378326714039, decouple_loss:0.0012482464080676436loss_pred:0.026132097467780113, decouple_loss:0.0012084742775186896
Iteration: 4456, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44532066583633423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02794049121439457, decouple_loss:0.0012702870881184936
The modified gen p mean: 0.441556453704834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028376704081892967, decouple_loss:0.0011903258273378015
The modified gen p mean: 0.4455304443836212, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028093472123146057, decouple_loss:0.00121204589959234
Iteration: 4457, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439833164215088, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610795572400093, decouple_loss:0.0012316008796915412
The modified gen p mean: 0.44403696060180664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027903830632567406, decouple_loss:0.0013193924678489566
The modified gen p mean: 0.4447759985923767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026469869539141655, decouple_loss:0.0012891775695607066
Iteration: 4458, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44139328598976135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02689020149409771, decouple_loss:0.0011928073363378644
The modified gen p mean: 0.4433288276195526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026395250111818314, decouple_loss:0.0012102980399504304
The modified gen p mean: 0.4459376931190491, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026602547615766525, decouple_loss:0.0013601592509076
Iteration: 4459, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44382819533348083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0257918331772089, decouple_loss:0.0013395611895248294
The modified gen p mean: 0.4426555931568146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02792034111917019, decouple_loss:0.0012607594253495336
The modified gen p mean: 0.4471590220928192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02596457488834858, decouple_loss:0.0013697182293981314
Iteration: 4460, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4436579644680023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028056643903255463, decouple_loss:0.0012059953296557069
The modified gen p mean: 0.4432799518108368, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02585310861468315, decouple_loss:0.0013103991514071822
The modified gen p mean: 0.44540148973464966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025382576510310173, decouple_loss:0.001398234162479639
2023-05-27 12:06:30 testing...
The modified gen p mean: 0.4492347538471222, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03303934633731842, decouple_loss:0.0015546093927696347
The modified gen p mean: 0.4471701383590698, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44911277294158936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03337755426764488, decouple_loss:0.0014028797158971429
loss_pred:0.034800123423337936, decouple_loss:0.001474152086302638
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03381286934018135, avg_mse: 0.046267278492450714
current test mse: 0.046267
Iteration: 4461, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44175755977630615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027378680184483528, decouple_loss:0.0013118041679263115
The modified gen p mean: 0.4435116648674011, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028308890759944916, decouple_loss:0.001195538672618568
The modified gen p mean: 0.4452054798603058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02681124396622181, decouple_loss:0.0012181138154119253
Iteration: 4462, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459854066371918, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025967000052332878, decouple_loss:0.00132010190282017
The modified gen p mean: 0.44434988498687744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027603507041931152, decouple_loss:0.0012981913750991225
The modified gen p mean: 0.4470261037349701, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025846924632787704, decouple_loss:0.0012147667584940791
Iteration: 4463, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4448114335536957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02533029206097126, decouple_loss:0.0012095265556126833
The modified gen p mean: 0.4428809583187103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02797679975628853, decouple_loss:0.0012530495878309011
The modified gen p mean: 0.4432118237018585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026762371882796288, decouple_loss:0.001176130142994225
Iteration: 4464, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444334805011749, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0277839545160532, decouple_loss:0.0012277550995349884
The modified gen p mean: 0.4463579058647156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026688184589147568, decouple_loss:0.0013323005987331271
The modified gen p mean: 0.44380617141723633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02712932601571083, decouple_loss:0.0012825607554987073
Iteration: 4465, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44899627566337585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025796635076403618, decouple_loss:0.0012615559389814734
The modified gen p mean: 0.4481070339679718, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025243064388632774, decouple_loss:0.0012582400813698769
The modified gen p mean: 0.44800686836242676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026285696774721146, decouple_loss:0.0012699145590886474
Iteration: 4466, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455505609512329, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025355488061904907, decouple_loss:0.001332587213255465
The modified gen p mean: 0.4435507655143738, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02782941795885563, decouple_loss:0.0011824555695056915
The modified gen p mean: 0.4458227753639221, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027798283845186234, decouple_loss:0.0011503284331411123
Iteration: 4467, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489276707172394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025934556499123573, decouple_loss:0.001170171657577157
The modified gen p mean: 0.4454328715801239, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027568869292736053, decouple_loss:0.0011749237310141325
The modified gen p mean: 0.44692176580429077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026165438815951347, decouple_loss:0.0011442110408097506
Iteration: 4468, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473355710506439, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02546454221010208, decouple_loss:0.0013431616825982928
The modified gen p mean: 0.44505542516708374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027527015656232834, decouple_loss:0.0011187979253008962
The modified gen p mean: 0.4439067542552948, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027401497587561607, decouple_loss:0.0012916810810565948
Iteration: 4469, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476740062236786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02511490322649479, decouple_loss:0.001197519595734775
The modified gen p mean: 0.4469030499458313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02545734867453575, decouple_loss:0.0013286133762449026
The modified gen p mean: 0.4461234211921692, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02791881188750267, decouple_loss:0.0012438090052455664
Iteration: 4470, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44812795519828796, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4457685053348541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025732744485139847, decouple_loss:0.0011261660838499665
loss_pred:0.027267150580883026, decouple_loss:0.0012222303776070476
The modified gen p mean: 0.44565990567207336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02726634405553341, decouple_loss:0.0011956222588196397
2023-05-27 12:10:36 testing...
The modified gen p mean: 0.4514000713825226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033246856182813644, decouple_loss:0.001506564556621015
The modified gen p mean: 0.4491770565509796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03344326093792915, decouple_loss:0.0013203336857259274
The modified gen p mean: 0.45128685235977173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03502923622727394, decouple_loss:0.0014781377976760268
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03397820144891739, avg_mse: 0.04656495526432991
current test mse: 0.046565
Iteration: 4471, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44267338514328003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028106028214097023, decouple_loss:0.0010728324996307492
The modified gen p mean: 0.44787919521331787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02642204239964485, decouple_loss:0.0011209147050976753
The modified gen p mean: 0.4474121332168579, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025482743978500366, decouple_loss:0.001125964685343206
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4472, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45104357600212097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025731978937983513, decouple_loss:0.0012889561476185918
The modified gen p mean: 0.44762545824050903, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45135316252708435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025069251656532288, decouple_loss:0.0012206770479679108
loss_pred:0.026445865631103516, decouple_loss:0.0011986017925664783
Iteration: 4473, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.443517804145813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026392102241516113, decouple_loss:0.0012092984979972243
The modified gen p mean: 0.4441291391849518, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029024194926023483, decouple_loss:0.0011990630300715566
The modified gen p mean: 0.4465514123439789, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025241348892450333, decouple_loss:0.0011529470793902874
Iteration: 4474, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489651918411255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025930052623152733, decouple_loss:0.0012893882812932134
The modified gen p mean: 0.44417595863342285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028386207297444344, decouple_loss:0.0011926883598789573
The modified gen p mean: 0.4442514479160309, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027074284851551056, decouple_loss:0.0012228615814819932
Iteration: 4475, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449024200439453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026628218591213226, decouple_loss:0.0013347974745556712The modified gen p mean: 0.4476008713245392, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026250017806887627, decouple_loss:0.0012262121308594942
The modified gen p mean: 0.4477270543575287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027308786287903786, decouple_loss:0.0013296529650688171
Iteration: 4476, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44472283124923706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02638271637260914, decouple_loss:0.001417997875250876
The modified gen p mean: 0.4461919665336609, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02687673456966877, decouple_loss:0.0011619930155575275
The modified gen p mean: 0.4450956881046295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026534004136919975, decouple_loss:0.0011340804630890489
Iteration: 4477, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510764479637146, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.447661817073822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02541338838636875, decouple_loss:0.001304370234720409
loss_pred:0.026791585609316826, decouple_loss:0.0011939695104956627
The modified gen p mean: 0.4451679587364197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02668590098619461, decouple_loss:0.0011497577652335167
Iteration: 4478, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472132623195648, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44501233100891113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025169746950268745, decouple_loss:0.0012017841218039393
loss_pred:0.026349835097789764, decouple_loss:0.0012552286498248577
The modified gen p mean: 0.44901007413864136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02564729005098343, decouple_loss:0.001426391419954598
Iteration: 4479, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474378526210785, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4491046369075775, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02679436281323433, decouple_loss:0.0013392263790592551
loss_pred:0.027120277285575867, decouple_loss:0.0012125320499762893
The modified gen p mean: 0.4516189992427826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025279749184846878, decouple_loss:0.0012515767011791468
Iteration: 4480, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443439543247223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02727595530450344, decouple_loss:0.0010698549449443817
The modified gen p mean: 0.44523799419403076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027463335543870926, decouple_loss:0.001264297403395176
The modified gen p mean: 0.4490492343902588, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024606669321656227, decouple_loss:0.0013502297224476933
2023-05-27 12:15:22 testing...
The modified gen p mean: 0.4510696828365326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033336617052555084, decouple_loss:0.0015109324594959617
The modified gen p mean: 0.4489634931087494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03350214287638664, decouple_loss:0.0014030239544808865
The modified gen p mean: 0.45116734504699707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03514627739787102, decouple_loss:0.0015857825055718422
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.034070007503032684, avg_mse: 0.04670605808496475
current test mse: 0.046706
Iteration: 4481, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44509032368659973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02617560885846615, decouple_loss:0.001314914203248918
The modified gen p mean: 0.45107588171958923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025679685175418854, decouple_loss:0.0013101777294650674
The modified gen p mean: 0.45119351148605347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024878736585378647, decouple_loss:0.001316075911745429
Iteration: 4482, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4448094069957733, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44648706912994385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02638976089656353, decouple_loss:0.0011020328383892775
loss_pred:0.02664981409907341, decouple_loss:0.0013465513475239277
The modified gen p mean: 0.4483925998210907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026459576562047005, decouple_loss:0.0011862757382914424
Iteration: 4483, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44597557187080383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02611064910888672, decouple_loss:0.0013282087165862322
The modified gen p mean: 0.4462267756462097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025424102321267128, decouple_loss:0.0012142766499891877
The modified gen p mean: 0.44715607166290283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026158541440963745, decouple_loss:0.0012372235069051385
Iteration: 4484, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493863880634308, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025926195085048676, decouple_loss:0.0013991049490869045
The modified gen p mean: 0.44857096672058105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02626340463757515, decouple_loss:0.0014301054179668427
The modified gen p mean: 0.4464087188243866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02513081766664982, decouple_loss:0.001379104913212359
Iteration: 4485, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464172124862671, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026721663773059845, decouple_loss:0.001237162621691823
The modified gen p mean: 0.44623854756355286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0268483255058527, decouple_loss:0.001263284357264638
The modified gen p mean: 0.45200812816619873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025842996314167976, decouple_loss:0.001304797362536192
Iteration: 4486, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44442009925842285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027151010930538177, decouple_loss:0.001115546328946948
The modified gen p mean: 0.44756439328193665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025786127895116806, decouple_loss:0.001315292902290821
The modified gen p mean: 0.44759005308151245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025949349626898766, decouple_loss:0.0012823304859921336
Iteration: 4487, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449050724506378, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026580089703202248, decouple_loss:0.001141279237344861
The modified gen p mean: 0.44598209857940674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024745464324951172, decouple_loss:0.0011684081982821226
The modified gen p mean: 0.4437297284603119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027058281004428864, decouple_loss:0.0012071053497493267
Iteration: 4488, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44624510407447815, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44703441858291626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027236392721533775, decouple_loss:0.0011766314273700118
loss_pred:0.02691730111837387, decouple_loss:0.0012457164702937007
The modified gen p mean: 0.44678977131843567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026613373309373856, decouple_loss:0.0011379149509593844
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4489, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44826456904411316, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44873401522636414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026015518233180046, decouple_loss:0.0012246125843375921
loss_pred:0.02544449456036091, decouple_loss:0.0012480912264436483
The modified gen p mean: 0.44934791326522827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025921478867530823, decouple_loss:0.001161574968136847
Iteration: 4490, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44559919834136963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02658447064459324, decouple_loss:0.0011605541221797466
The modified gen p mean: 0.44512277841567993, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026742374524474144, decouple_loss:0.0012176819145679474
The modified gen p mean: 0.4529021382331848, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02553711086511612, decouple_loss:0.0013179938541725278
2023-05-27 12:20:09 testing...
The modified gen p mean: 0.453965961933136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033140409737825394, decouple_loss:0.0015130669344216585
The modified gen p mean: 0.4519001245498657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03343521058559418, decouple_loss:0.0013590292073786259
The modified gen p mean: 0.45409876108169556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034998923540115356, decouple_loss:0.001504043466411531
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03393111750483513, avg_mse: 0.04646088555455208
current test mse: 0.046461
Iteration: 4491, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501532316207886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025630688294768333, decouple_loss:0.0013161033857613802
The modified gen p mean: 0.44848722219467163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0277462936937809, decouple_loss:0.0012393768411129713
The modified gen p mean: 0.4492513835430145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025599543005228043, decouple_loss:0.0012444856110960245
Iteration: 4492, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44940224289894104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026044093072414398, decouple_loss:0.0012296787463128567
The modified gen p mean: 0.45222529768943787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025504080578684807, decouple_loss:0.0012237218907102942
The modified gen p mean: 0.448274165391922, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02601535990834236, decouple_loss:0.0012734407791867852
Iteration: 4493, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44805988669395447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026447489857673645, decouple_loss:0.0012128332164138556
The modified gen p mean: 0.4495844542980194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026167480275034904, decouple_loss:0.001228783163242042
The modified gen p mean: 0.4462432563304901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025766268372535706, decouple_loss:0.0011193673126399517
Iteration: 4494, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4530307948589325, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44681528210639954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025600574910640717, decouple_loss:0.0013980476651340723
loss_pred:0.027367213740944862, decouple_loss:0.001068330486305058
The modified gen p mean: 0.4449188709259033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026467300951480865, decouple_loss:0.0011874815681949258
Iteration: 4495, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44550222158432007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026595916599035263, decouple_loss:0.0011386529076844454
The modified gen p mean: 0.4455583095550537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02688884362578392, decouple_loss:0.0011731794802471995
The modified gen p mean: 0.4455687403678894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025399750098586082, decouple_loss:0.001215871307067573
Iteration: 4496, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44756585359573364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02538294717669487, decouple_loss:0.0011770478449761868
The modified gen p mean: 0.44538283348083496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02641073428094387, decouple_loss:0.0011423808755353093
The modified gen p mean: 0.444612979888916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02632029354572296, decouple_loss:0.0011262333719059825
Iteration: 4497, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44498321413993835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027755947783589363, decouple_loss:0.001175855053588748
The modified gen p mean: 0.4438058137893677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026825880631804466, decouple_loss:0.001226372318342328
The modified gen p mean: 0.443503201007843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02764176018536091, decouple_loss:0.0011922233970835805
Iteration: 4498, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44589030742645264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02634354867041111, decouple_loss:0.001245632185600698
The modified gen p mean: 0.4472849667072296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025508582592010498, decouple_loss:0.001281114062294364
The modified gen p mean: 0.4425605833530426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0272640623152256, decouple_loss:0.0012029623612761497
Iteration: 4499, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444426894187927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026487626135349274, decouple_loss:0.0011440374655649066
The modified gen p mean: 0.4426911473274231, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027370888739824295, decouple_loss:0.0012242230586707592
The modified gen p mean: 0.44264477491378784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026396898552775383, decouple_loss:0.0011882412945851684
Iteration: 4500, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44704142212867737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025702914223074913, decouple_loss:0.001207711873576045
The modified gen p mean: 0.44589197635650635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026310408487915993, decouple_loss:0.001274189678952098
The modified gen p mean: 0.44474300742149353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026378437876701355, decouple_loss:0.0012779608368873596
2023-05-27 12:24:14 testing...
The modified gen p mean: 0.4511432945728302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03306619077920914, decouple_loss:0.0016279539559036493
The modified gen p mean: 0.4510493576526642, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034936852753162384, decouple_loss:0.001590590225532651
The modified gen p mean: 0.4490145146846771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03342628851532936, decouple_loss:0.0013636111980304122
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033886149525642395, avg_mse: 0.04647750034928322
current test mse: 0.046478
Iteration: 4501, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478150010108948, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02526557818055153, decouple_loss:0.0013863970525562763
The modified gen p mean: 0.4443020224571228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027989475056529045, decouple_loss:0.0012645847164094448
The modified gen p mean: 0.4494183361530304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025644781067967415, decouple_loss:0.0012719751102849841
Iteration: 4502, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44865691661834717, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02506890706717968, decouple_loss:0.0011821661610156298
The modified gen p mean: 0.44495952129364014, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026339055970311165, decouple_loss:0.0012133580166846514
The modified gen p mean: 0.4491541087627411, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025427568703889847, decouple_loss:0.0012974324636161327
Iteration: 4503, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458807110786438, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025125576183199883, decouple_loss:0.001236350741237402
The modified gen p mean: 0.44389593601226807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026717692613601685, decouple_loss:0.0011372411390766501
The modified gen p mean: 0.44397813081741333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026536501944065094, decouple_loss:0.0011669836239889264
Iteration: 4504, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44600725173950195, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4455912411212921, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02619427628815174, decouple_loss:0.0010543335229158401
loss_pred:0.025898046791553497, decouple_loss:0.0011870223097503185
The modified gen p mean: 0.44640690088272095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026885872706770897, decouple_loss:0.0011238515144214034
Iteration: 4505, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44942155480384827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025817550718784332, decouple_loss:0.0012342043919488788
The modified gen p mean: 0.4472103416919708, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025459734722971916, decouple_loss:0.001300287083722651
The modified gen p mean: 0.4457700252532959, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02647981606423855, decouple_loss:0.0012042773887515068
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr.npz
NaN value num: 0
Iteration: 4506, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449201375246048, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44908949732780457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028748633340001106, decouple_loss:0.0011649420484900475
loss_pred:0.028665468096733093, decouple_loss:0.00132856797426939The modified gen p mean: 0.45271673798561096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027590854093432426, decouple_loss:0.001253122347407043
Iteration: 4507, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486512541770935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028846129775047302, decouple_loss:0.00127694895491004
The modified gen p mean: 0.45239877700805664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029722334817051888, decouple_loss:0.0014063657727092505
The modified gen p mean: 0.44810765981674194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02877020835876465, decouple_loss:0.0013924004742875695
Iteration: 4508, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492103159427643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028141219168901443, decouple_loss:0.0012091589160263538
The modified gen p mean: 0.45025792717933655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029193615540862083, decouple_loss:0.0012204929953441024
The modified gen p mean: 0.44968897104263306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029555492103099823, decouple_loss:0.0011907486477866769
Iteration: 4509, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4533650577068329, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4518064558506012, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029584389179944992, decouple_loss:0.0013884506188333035
loss_pred:0.028121231123805046, decouple_loss:0.001197724137455225
The modified gen p mean: 0.45191675424575806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029566142708063126, decouple_loss:0.001273301080800593
Iteration: 4510, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45260751247406006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02870519459247589, decouple_loss:0.0012799957767128944
The modified gen p mean: 0.45325881242752075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027443358674645424, decouple_loss:0.001186223467811942
The modified gen p mean: 0.45207470655441284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028161777183413506, decouple_loss:0.0012506205821409822
2023-05-27 12:29:00 testing...
The modified gen p mean: 0.45650729537010193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03243264555931091, decouple_loss:0.0014294855063781142
The modified gen p mean: 0.45442789793014526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032720617949962616, decouple_loss:0.0013034549774602056
The modified gen p mean: 0.45611289143562317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034140244126319885, decouple_loss:0.0013981166994199157
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033166687935590744, avg_mse: 0.04516182839870453
current test mse: 0.045162
Iteration: 4511, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4517647325992584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02862638235092163, decouple_loss:0.0011190988589078188
The modified gen p mean: 0.45271819829940796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02830612286925316, decouple_loss:0.0012464270694181323
The modified gen p mean: 0.4499647617340088, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0305135827511549, decouple_loss:0.0012711073504760861
Iteration: 4512, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512088894844055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02861090935766697, decouple_loss:0.0012227349216118455
The modified gen p mean: 0.45300137996673584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029617009684443474, decouple_loss:0.0012149452231824398
The modified gen p mean: 0.45034781098365784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028698168694972992, decouple_loss:0.0011448472505435348
Iteration: 4513, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450344443321228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0289931520819664, decouple_loss:0.0011391171719878912
The modified gen p mean: 0.45245370268821716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02849719487130642, decouple_loss:0.0012941650347784162
The modified gen p mean: 0.45210564136505127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02834763191640377, decouple_loss:0.001261253491975367
Iteration: 4514, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518806040287018, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028102921321988106, decouple_loss:0.0012800695840269327
The modified gen p mean: 0.45179423689842224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027557777240872383, decouple_loss:0.0013091806322336197
The modified gen p mean: 0.45578086376190186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029750345274806023, decouple_loss:0.0012241258518770337
Iteration: 4515, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4526006579399109, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027140075340867043, decouple_loss:0.0012250069994479418
The modified gen p mean: 0.44951486587524414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02868288941681385, decouple_loss:0.001165415975265205
The modified gen p mean: 0.4539976119995117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02849160134792328, decouple_loss:0.0013443914940580726
Iteration: 4516, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448314368724823, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466252624988556, gen p mean: 0.0, mean p set: 0.448loss_pred:0.029488204047083855, decouple_loss:0.0013512761797755957
loss_pred:0.028818635269999504, decouple_loss:0.0012291532475501299
The modified gen p mean: 0.44902166724205017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029028357937932014, decouple_loss:0.0012727647554129362
Iteration: 4517, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44525346159935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029645008966326714, decouple_loss:0.0012644993839785457
The modified gen p mean: 0.4465911090373993, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027617530897259712, decouple_loss:0.0013558405917137861
The modified gen p mean: 0.44460737705230713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028807975351810455, decouple_loss:0.001303813885897398
Iteration: 4518, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44283267855644226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028063464909791946, decouple_loss:0.001135735772550106
The modified gen p mean: 0.4451355040073395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027803663164377213, decouple_loss:0.0014014587504789233
The modified gen p mean: 0.44402679800987244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029248107224702835, decouple_loss:0.0012796539813280106
Iteration: 4519, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462537169456482, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4429054260253906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029198119416832924, decouple_loss:0.0011702601332217455loss_pred:0.027089249342679977, decouple_loss:0.0012442485895007849
The modified gen p mean: 0.445854514837265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028548723086714745, decouple_loss:0.0012739051599055529
Iteration: 4520, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446916878223419, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02825925685465336, decouple_loss:0.0013976511545479298
The modified gen p mean: 0.44503745436668396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027470003813505173, decouple_loss:0.0014036265201866627
The modified gen p mean: 0.4477429986000061, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612200751900673, decouple_loss:0.0011843785177916288
2023-05-27 12:33:06 testing...
The modified gen p mean: 0.45227423310279846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03235471993684769, decouple_loss:0.0014454304473474622
The modified gen p mean: 0.4500126242637634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032909780740737915, decouple_loss:0.0013553486205637455
The modified gen p mean: 0.45180705189704895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03410667926073074, decouple_loss:0.0015023595187813044
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03319544345140457, avg_mse: 0.045231226831674576
current test mse: 0.045231
Iteration: 4521, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447277694940567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028317801654338837, decouple_loss:0.0013181769754737616
The modified gen p mean: 0.44931283593177795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028976060450077057, decouple_loss:0.0013637845404446125
The modified gen p mean: 0.4506380259990692, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029545899480581284, decouple_loss:0.0012844073353335261
Iteration: 4522, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506618082523346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030211355537176132, decouple_loss:0.001233839662745595
The modified gen p mean: 0.4500206708908081, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027874255552887917, decouple_loss:0.0014083986170589924
The modified gen p mean: 0.45065128803253174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02934134751558304, decouple_loss:0.001266204402782023
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4523, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4535417854785919, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026592815294861794, decouple_loss:0.0014430690789595246
The modified gen p mean: 0.4539051353931427, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4546324610710144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02809961326420307, decouple_loss:0.0012926703784614801
loss_pred:0.027433454990386963, decouple_loss:0.001398721244186163
Iteration: 4524, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45612984895706177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026841050013899803, decouple_loss:0.0013073362642899156
The modified gen p mean: 0.4556187391281128, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026776472106575966, decouple_loss:0.0014208038337528706
The modified gen p mean: 0.4551171660423279, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026394419372081757, decouple_loss:0.0014402767410501838
Iteration: 4525, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45182690024375916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027117297053337097, decouple_loss:0.001417289488017559
The modified gen p mean: 0.4569821059703827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027233414351940155, decouple_loss:0.0012931794626638293
The modified gen p mean: 0.4556609094142914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026913098990917206, decouple_loss:0.0014024140546098351
Iteration: 4526, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4549647867679596, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45549237728118896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025589250028133392, decouple_loss:0.0013908264227211475
loss_pred:0.02535439468920231, decouple_loss:0.0012430056231096387
The modified gen p mean: 0.4555962383747101, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02547357976436615, decouple_loss:0.0013666555751115084
Iteration: 4527, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445948988199234, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44862374663352966, gen p mean: 0.0, mean p set: 0.448loss_pred:0.027538340538740158, decouple_loss:0.001671522855758667
loss_pred:0.025871586054563522, decouple_loss:0.0015361305559054017
The modified gen p mean: 0.4453270435333252, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027622396126389503, decouple_loss:0.001606135512702167
Iteration: 4528, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44188007712364197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02706756256520748, decouple_loss:0.0014069064054638147
The modified gen p mean: 0.44180163741111755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027943212538957596, decouple_loss:0.0012610408011823893
The modified gen p mean: 0.4445694386959076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02547709457576275, decouple_loss:0.0014146395260468125
Iteration: 4529, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438055157661438, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027124473825097084, decouple_loss:0.0014971914933994412
The modified gen p mean: 0.4415417015552521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027295244857668877, decouple_loss:0.0014110207557678223
The modified gen p mean: 0.4426785111427307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026621438562870026, decouple_loss:0.0016938193002715707
Iteration: 4530, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.440170019865036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027241794392466545, decouple_loss:0.00147299247328192
The modified gen p mean: 0.439340204000473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02734667994081974, decouple_loss:0.0015192737337201834
The modified gen p mean: 0.4425637125968933, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026534657925367355, decouple_loss:0.0016988374991342425
2023-05-27 12:37:49 testing...
The modified gen p mean: 0.4474027454853058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032620251178741455, decouple_loss:0.00174979236908257
The modified gen p mean: 0.4452971816062927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03317691758275032, decouple_loss:0.0017453338950872421
The modified gen p mean: 0.4469524025917053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034543465822935104, decouple_loss:0.0017264042980968952
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03353390097618103, avg_mse: 0.04573766887187958
current test mse: 0.045738
Iteration: 4531, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438776671886444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025287488475441933, decouple_loss:0.0015819370746612549
The modified gen p mean: 0.4417458474636078, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02625705674290657, decouple_loss:0.0014623788883909583
The modified gen p mean: 0.4436429440975189, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02645769715309143, decouple_loss:0.0016315261600539088
Iteration: 4532, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446289539337158, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02478131465613842, decouple_loss:0.0013309505302459002
The modified gen p mean: 0.4425153136253357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02718629129230976, decouple_loss:0.0014177762204781175
The modified gen p mean: 0.44553014636039734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673344314098358, decouple_loss:0.0012819849653169513
Iteration: 4533, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482862055301666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025135254487395287, decouple_loss:0.0014996241079643369
The modified gen p mean: 0.4464011490345001, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02744279056787491, decouple_loss:0.0014643538743257523
The modified gen p mean: 0.45199283957481384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024839764460921288, decouple_loss:0.0013631442561745644
Iteration: 4534, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482789635658264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02481875568628311, decouple_loss:0.0015439437702298164
The modified gen p mean: 0.4506619870662689, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026349972933530807, decouple_loss:0.0013268929906189442
The modified gen p mean: 0.4487125277519226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02734806202352047, decouple_loss:0.0014915370848029852
Iteration: 4535, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513007700443268, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027276769280433655, decouple_loss:0.001346841105259955
The modified gen p mean: 0.4545243978500366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02585112489759922, decouple_loss:0.0012507268693298101
The modified gen p mean: 0.45218420028686523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02784474939107895, decouple_loss:0.0013598030200228095
Iteration: 4536, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4550086259841919, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026080720126628876, decouple_loss:0.0012138388119637966
The modified gen p mean: 0.4505642056465149, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024538759142160416, decouple_loss:0.0013770887162536383
The modified gen p mean: 0.45212677121162415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0265815332531929, decouple_loss:0.0013282723957672715
Iteration: 4537, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4531116187572479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026297416538000107, decouple_loss:0.0015179822221398354
The modified gen p mean: 0.45183226466178894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026601385325193405, decouple_loss:0.001499202917329967
The modified gen p mean: 0.45334720611572266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026185957714915276, decouple_loss:0.0015032992232590914
Iteration: 4538, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4541926085948944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026080802083015442, decouple_loss:0.0013831298565492034
The modified gen p mean: 0.4492870271205902, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02775086648762226, decouple_loss:0.001383740920573473
The modified gen p mean: 0.4500979781150818, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026920437812805176, decouple_loss:0.0016160280210897326
Iteration: 4539, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45097655057907104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026054205372929573, decouple_loss:0.0014747775858268142
The modified gen p mean: 0.4472663998603821, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02726546861231327, decouple_loss:0.001547108986414969
The modified gen p mean: 0.4483641982078552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0279084462672472, decouple_loss:0.0012511751847341657
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4540, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475546181201935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028867149725556374, decouple_loss:0.0013112230226397514
The modified gen p mean: 0.450246125459671, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466560482978821, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02665112353861332, decouple_loss:0.0013348468346521258
loss_pred:0.027268141508102417, decouple_loss:0.0012340956600382924
2023-05-27 12:42:36 testing...
The modified gen p mean: 0.4516310393810272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03251953795552254, decouple_loss:0.0016028728568926454
The modified gen p mean: 0.44980883598327637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03310759738087654, decouple_loss:0.0014770490815863013
The modified gen p mean: 0.4510885775089264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03436442092061043, decouple_loss:0.0016083101509138942
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03340865671634674, avg_mse: 0.04556572064757347
current test mse: 0.045566
Iteration: 4541, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453887939453125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028649060055613518, decouple_loss:0.0013318220153450966
The modified gen p mean: 0.44743919372558594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028743397444486618, decouple_loss:0.001308239414356649
The modified gen p mean: 0.4492165744304657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028278104960918427, decouple_loss:0.0013697441900148988
Iteration: 4542, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44598841667175293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027272166684269905, decouple_loss:0.0013565304689109325
The modified gen p mean: 0.44564560055732727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028745440766215324, decouple_loss:0.001317510730586946
The modified gen p mean: 0.44592633843421936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028336456045508385, decouple_loss:0.0013739913702011108
Iteration: 4543, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499753713607788, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45010989904403687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027773423120379448, decouple_loss:0.001481338287703693
loss_pred:0.02791527658700943, decouple_loss:0.0012733895564451814
The modified gen p mean: 0.44605016708374023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771061286330223, decouple_loss:0.0013644312275573611
Iteration: 4544, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500589072704315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027882050722837448, decouple_loss:0.001338836969807744
The modified gen p mean: 0.45031270384788513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02719365805387497, decouple_loss:0.0013407940277829766
The modified gen p mean: 0.44959917664527893, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029097609221935272, decouple_loss:0.0012546738144010305
Iteration: 4545, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44994163513183594, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4514212906360626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02847588248550892, decouple_loss:0.0015084597980603576
loss_pred:0.02838105708360672, decouple_loss:0.001624319702386856
The modified gen p mean: 0.4517539441585541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02767181769013405, decouple_loss:0.0015344481216743588
Iteration: 4546, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45299333333969116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02886291779577732, decouple_loss:0.0014545094454661012
The modified gen p mean: 0.4521348178386688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0276787206530571, decouple_loss:0.001370410667732358
The modified gen p mean: 0.4516041576862335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029424764215946198, decouple_loss:0.0012995903380215168
Iteration: 4547, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512869417667389, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029327038675546646, decouple_loss:0.0014270748943090439
The modified gen p mean: 0.4552261233329773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02801278978586197, decouple_loss:0.0012207797262817621
The modified gen p mean: 0.4533018171787262, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02832021750509739, decouple_loss:0.0012027740012854338
Iteration: 4548, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.455279141664505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027414819225668907, decouple_loss:0.001176279503852129
The modified gen p mean: 0.45107778906822205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027552466839551926, decouple_loss:0.001173317665234208
The modified gen p mean: 0.4520581364631653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02769867703318596, decouple_loss:0.0012376154772937298
Iteration: 4549, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45090001821517944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02699347957968712, decouple_loss:0.0013203498674556613
The modified gen p mean: 0.45150676369667053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027259403839707375, decouple_loss:0.0012656027683988214
The modified gen p mean: 0.4529087543487549, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02666652202606201, decouple_loss:0.0013626242289319634
Iteration: 4550, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45102784037590027, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44753849506378174, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02845996990799904, decouple_loss:0.001347274985164404
loss_pred:0.027476971969008446, decouple_loss:0.0014984454028308392
The modified gen p mean: 0.449054479598999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0276962798088789, decouple_loss:0.001290382002480328
2023-05-27 12:46:41 testing...
The modified gen p mean: 0.451649010181427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03249703347682953, decouple_loss:0.0013955403119325638
The modified gen p mean: 0.44961410760879517, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45109984278678894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03303736448287964, decouple_loss:0.0013470398262143135
loss_pred:0.03425966575741768, decouple_loss:0.0014732596464455128
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03333495557308197, avg_mse: 0.04556168243288994
current test mse: 0.045562
Iteration: 4551, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480482041835785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02716868370771408, decouple_loss:0.0011857538484036922
The modified gen p mean: 0.44592902064323425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028414133936166763, decouple_loss:0.0011474776547402143
The modified gen p mean: 0.44605499505996704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027797266840934753, decouple_loss:0.0011743656359612942
Iteration: 4552, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44654592871665955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02808719500899315, decouple_loss:0.0014138537226244807
The modified gen p mean: 0.44894787669181824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027366312220692635, decouple_loss:0.0014222220052033663
The modified gen p mean: 0.44390803575515747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02761925756931305, decouple_loss:0.0012513021938502789
Iteration: 4553, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44663453102111816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027579577639698982, decouple_loss:0.0014454028569161892
The modified gen p mean: 0.4469749331474304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02689724788069725, decouple_loss:0.0014497622614726424
The modified gen p mean: 0.44531816244125366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027723398059606552, decouple_loss:0.0014023504918441176
Iteration: 4554, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44624876976013184, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44707974791526794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028079399839043617, decouple_loss:0.0012338643427938223
loss_pred:0.028984686359763145, decouple_loss:0.0011590092908591032
The modified gen p mean: 0.4456707537174225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820664830505848, decouple_loss:0.0011785986134782434
Iteration: 4555, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474236071109772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02815210074186325, decouple_loss:0.001208161236718297
The modified gen p mean: 0.44809475541114807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028629139065742493, decouple_loss:0.0011405472178012133
The modified gen p mean: 0.4502832293510437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026132134720683098, decouple_loss:0.0012481986777856946
Iteration: 4556, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45163702964782715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027160517871379852, decouple_loss:0.0012936157872900367
The modified gen p mean: 0.4494929611682892, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02689616195857525, decouple_loss:0.0013612272450700402
The modified gen p mean: 0.44811752438545227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027444664388895035, decouple_loss:0.0011798955965787172
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4557, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474460184574127, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44668373465538025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026456814259290695, decouple_loss:0.001294944784604013
The modified gen p mean: 0.44573524594306946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02761368453502655, decouple_loss:0.0013346797786653042
loss_pred:0.026742985472083092, decouple_loss:0.0013085532700642943
Iteration: 4558, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45094603300094604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025906506925821304, decouple_loss:0.0012334630591794848
The modified gen p mean: 0.4498039186000824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026740416884422302, decouple_loss:0.001240527373738587
The modified gen p mean: 0.449841171503067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025602133944630623, decouple_loss:0.0013853594427928329
Iteration: 4559, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506847560405731, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02580328844487667, decouple_loss:0.0012450529029592872
The modified gen p mean: 0.448334664106369, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026566335931420326, decouple_loss:0.0013202171539887786
The modified gen p mean: 0.44746723771095276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026396891102194786, decouple_loss:0.0013327657943591475
Iteration: 4560, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449441134929657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02602553740143776, decouple_loss:0.0013415766879916191
The modified gen p mean: 0.44789648056030273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026228077709674835, decouple_loss:0.0012225550599396229
The modified gen p mean: 0.44610241055488586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026392484083771706, decouple_loss:0.001281576231122017
2023-05-27 12:51:26 testing...
The modified gen p mean: 0.45214414596557617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03271864727139473, decouple_loss:0.0013952747685834765
The modified gen p mean: 0.4498867094516754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03320113942027092, decouple_loss:0.0013939299387857318
The modified gen p mean: 0.4516780376434326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03450607880949974, decouple_loss:0.001437525381334126
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033545732498168945, avg_mse: 0.045899469405412674
current test mse: 0.045899
Iteration: 4561, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44538912177085876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027112534269690514, decouple_loss:0.0012154175201430917
The modified gen p mean: 0.4459174871444702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027756202965974808, decouple_loss:0.0012682051165029407
The modified gen p mean: 0.44979429244995117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025984497740864754, decouple_loss:0.0012474164832383394
Iteration: 4562, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45174187421798706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025885043665766716, decouple_loss:0.0014042379334568977
The modified gen p mean: 0.4461778998374939, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026437407359480858, decouple_loss:0.0011322672944515944
The modified gen p mean: 0.44799116253852844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026367925107479095, decouple_loss:0.0012356439838185906
Iteration: 4563, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449566125869751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02529764175415039, decouple_loss:0.001171704032458365
The modified gen p mean: 0.444304496049881, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02590363845229149, decouple_loss:0.001241916324943304
The modified gen p mean: 0.4441484212875366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02639782801270485, decouple_loss:0.0013061144854873419
Iteration: 4564, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445197582244873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02692931704223156, decouple_loss:0.0011720011243596673
The modified gen p mean: 0.4469433128833771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026002371683716774, decouple_loss:0.0012774131027981639
The modified gen p mean: 0.4461730122566223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027056459337472916, decouple_loss:0.0011633894173428416
Iteration: 4565, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45052003860473633, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44445711374282837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025763660669326782, decouple_loss:0.0012190415291115642
loss_pred:0.02699495665729046, decouple_loss:0.0011724578216671944
The modified gen p mean: 0.44816890358924866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025944754481315613, decouple_loss:0.0012195637682452798
Iteration: 4566, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44544318318367004, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44542738795280457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026085853576660156, decouple_loss:0.0011702135670930147
loss_pred:0.02630334347486496, decouple_loss:0.0012980435276404023
The modified gen p mean: 0.44925594329833984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02586834505200386, decouple_loss:0.0011375016765668988
Iteration: 4567, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463861286640167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028080135583877563, decouple_loss:0.0011507330927997828
The modified gen p mean: 0.4470091164112091, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027293844148516655, decouple_loss:0.0011180795263499022
The modified gen p mean: 0.4457067549228668, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02621714398264885, decouple_loss:0.0014062359696254134
Iteration: 4568, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492739140987396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026608483865857124, decouple_loss:0.0011553403455764055
The modified gen p mean: 0.45207300782203674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025856485590338707, decouple_loss:0.001262269215658307
The modified gen p mean: 0.4499465227127075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02634138986468315, decouple_loss:0.0013713747030124068
Iteration: 4569, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45012056827545166, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44766518473625183, gen p mean: 0.0, mean p set: 0.448loss_pred:0.026063598692417145, decouple_loss:0.0012478332500904799
loss_pred:0.025859825313091278, decouple_loss:0.0012968924129381776
The modified gen p mean: 0.452610045671463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024949761107563972, decouple_loss:0.0012436251854524016
Iteration: 4570, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.452242374420166, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44998157024383545, gen p mean: 0.0, mean p set: 0.448loss_pred:0.0251545961946249, decouple_loss:0.0011689881794154644
loss_pred:0.02628113143146038, decouple_loss:0.0012444580206647515
The modified gen p mean: 0.45328524708747864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02500544860959053, decouple_loss:0.001166521105915308
2023-05-27 12:55:30 testing...
The modified gen p mean: 0.45315021276474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032624419778585434, decouple_loss:0.0014126207679510117
The modified gen p mean: 0.4526103138923645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03453703597187996, decouple_loss:0.0013993870234116912
The modified gen p mean: 0.450903058052063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03308165445923805, decouple_loss:0.0014011533930897713
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03348458930850029, avg_mse: 0.045828770846128464
current test mse: 0.045829
Iteration: 4571, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484986662864685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026186352595686913, decouple_loss:0.0012802426936104894
The modified gen p mean: 0.44778504967689514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027268828824162483, decouple_loss:0.0012085025664418936
The modified gen p mean: 0.4509037435054779, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025923699140548706, decouple_loss:0.0011897945078089833
Iteration: 4572, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455112814903259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027386078611016273, decouple_loss:0.0012126702349632978
The modified gen p mean: 0.44595178961753845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028205720707774162, decouple_loss:0.0012020866852253675
The modified gen p mean: 0.45155471563339233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02547626569867134, decouple_loss:0.0011832949239760637
Iteration: 4573, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44732949137687683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02487858012318611, decouple_loss:0.0011790147982537746
The modified gen p mean: 0.44876015186309814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02527252957224846, decouple_loss:0.001146937720477581
The modified gen p mean: 0.4480249583721161, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02665328048169613, decouple_loss:0.001258180825971067
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr.npz
NaN value num: 0
Iteration: 4574, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44802185893058777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026532765477895737, decouple_loss:0.0016072823200374842
The modified gen p mean: 0.44454425573349, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4457504451274872, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027762118726968765, decouple_loss:0.001227906090207398loss_pred:0.027342602610588074, decouple_loss:0.0012063159374520183
Iteration: 4575, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44623422622680664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02675313875079155, decouple_loss:0.0011824783869087696
The modified gen p mean: 0.45059293508529663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026418011635541916, decouple_loss:0.0014175198739394546
The modified gen p mean: 0.44978994131088257, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026793168857693672, decouple_loss:0.0015838544350117445
Iteration: 4576, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4436168074607849, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02742287889122963, decouple_loss:0.001133764861151576
The modified gen p mean: 0.44493597745895386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026198875159025192, decouple_loss:0.001288201310671866
The modified gen p mean: 0.44253337383270264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02651263028383255, decouple_loss:0.001207968802191317
Iteration: 4577, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44773080945014954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027429411187767982, decouple_loss:0.0012230330612510443
The modified gen p mean: 0.4482254981994629, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02606450580060482, decouple_loss:0.0012455788673833013
The modified gen p mean: 0.4451683461666107, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026791883632540703, decouple_loss:0.001183197135105729
Iteration: 4578, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44937533140182495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026448886841535568, decouple_loss:0.0012080534361302853
The modified gen p mean: 0.4449704587459564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02659359946846962, decouple_loss:0.0012369900941848755
The modified gen p mean: 0.4436722695827484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0267771128565073, decouple_loss:0.0011889763409271836
Iteration: 4579, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44919341802597046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026283176615834236, decouple_loss:0.0014059710083529353
The modified gen p mean: 0.4449751675128937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027223266661167145, decouple_loss:0.0014981884742155671
The modified gen p mean: 0.44423216581344604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026413293555378914, decouple_loss:0.0012382607674226165
Iteration: 4580, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4435325264930725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02655498869717121, decouple_loss:0.0011391470907256007
The modified gen p mean: 0.44208571314811707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026711834594607353, decouple_loss:0.0011643284233286977
The modified gen p mean: 0.4472144544124603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02607748843729496, decouple_loss:0.001195815042592585
2023-05-27 13:00:15 testing...
The modified gen p mean: 0.4515671730041504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261016309261322, decouple_loss:0.0013742782175540924
The modified gen p mean: 0.44921597838401794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03303931653499603, decouple_loss:0.0013737545814365149
The modified gen p mean: 0.45107272267341614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03437088057398796, decouple_loss:0.0014371185097843409
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03340987488627434, avg_mse: 0.045758213847875595
current test mse: 0.045758
Iteration: 4581, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467584192752838, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026572665199637413, decouple_loss:0.001249791239388287
The modified gen p mean: 0.4452078938484192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820751629769802, decouple_loss:0.0012367565650492907
The modified gen p mean: 0.4485055208206177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02693377062678337, decouple_loss:0.001231216243468225
Iteration: 4582, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450936019420624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027672501280903816, decouple_loss:0.0013540158979594707
The modified gen p mean: 0.4468255341053009, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02681046351790428, decouple_loss:0.0012407252797856927
The modified gen p mean: 0.4454387128353119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026815153658390045, decouple_loss:0.0012055413099005818
Iteration: 4583, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492921829223633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025880150496959686, decouple_loss:0.0012710023438557982
The modified gen p mean: 0.4460598826408386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027151349931955338, decouple_loss:0.0011360954958945513
The modified gen p mean: 0.4477332532405853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028482306748628616, decouple_loss:0.0011784054804593325
Iteration: 4584, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45121005177497864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026455966755747795, decouple_loss:0.001160599640570581
The modified gen p mean: 0.45295944809913635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0265317652374506, decouple_loss:0.001415724284015596
The modified gen p mean: 0.45458143949508667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02659243531525135, decouple_loss:0.001453871838748455
Iteration: 4585, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485744833946228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02536494843661785, decouple_loss:0.0011558308033272624
The modified gen p mean: 0.4460793137550354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02647644281387329, decouple_loss:0.0011731890263035893
The modified gen p mean: 0.45306411385536194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024910172447562218, decouple_loss:0.0011396962217986584
Iteration: 4586, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45029690861701965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026196522638201714, decouple_loss:0.001175189740024507
The modified gen p mean: 0.4538496732711792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026223594322800636, decouple_loss:0.0012801913544535637
The modified gen p mean: 0.451962411403656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025137322023510933, decouple_loss:0.0012196321040391922
Iteration: 4587, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4528340697288513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02564544603228569, decouple_loss:0.001328470534645021
The modified gen p mean: 0.44644448161125183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028348660096526146, decouple_loss:0.0011696447618305683
The modified gen p mean: 0.44574791193008423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02670033648610115, decouple_loss:0.0011547382455319166
Iteration: 4588, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516819417476654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026079470291733742, decouple_loss:0.0013093265006318688
The modified gen p mean: 0.4484740197658539, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027038317173719406, decouple_loss:0.0011003605322912335
The modified gen p mean: 0.45023971796035767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02569619193673134, decouple_loss:0.001289001782424748
Iteration: 4589, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45002391934394836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02619597129523754, decouple_loss:0.0012625092640519142
The modified gen p mean: 0.44701504707336426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025893554091453552, decouple_loss:0.0011608995264396071
The modified gen p mean: 0.44459599256515503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02668488770723343, decouple_loss:0.0011216242564842105
Iteration: 4590, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44485706090927124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026568498462438583, decouple_loss:0.0011190512450411916
The modified gen p mean: 0.4485170543193817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027341727167367935, decouple_loss:0.001138697494752705
The modified gen p mean: 0.44520777463912964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025782309472560883, decouple_loss:0.0012000440619885921
2023-05-27 13:04:20 testing...
The modified gen p mean: 0.4516593813896179, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03247087448835373, decouple_loss:0.0013320615980774164
The modified gen p mean: 0.4512074589729309, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034251052886247635, decouple_loss:0.0013795231934636831
The modified gen p mean: 0.4493787884712219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0326811783015728, decouple_loss:0.0013049474218860269
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03320131450891495, avg_mse: 0.04536154121160507
current test mse: 0.045362
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr.npz
NaN value num: 0
Iteration: 4591, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483761787414551, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02550053782761097, decouple_loss:0.0012063839239999652
The modified gen p mean: 0.44454818964004517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025560537353157997, decouple_loss:0.001238754135556519
The modified gen p mean: 0.4479953348636627, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02534714713692665, decouple_loss:0.0012255345936864614
Iteration: 4592, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457673132419586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024463476613163948, decouple_loss:0.00114622269757092
The modified gen p mean: 0.4444010853767395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025154853239655495, decouple_loss:0.0011510943295434117
The modified gen p mean: 0.4502195417881012, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025457506999373436, decouple_loss:0.0011079052928835154
Iteration: 4593, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505406618118286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025532066822052002, decouple_loss:0.0012670167488977313
The modified gen p mean: 0.44409409165382385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026034383103251457, decouple_loss:0.0010945245157927275
The modified gen p mean: 0.4511667490005493, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024804171174764633, decouple_loss:0.0013836922589689493
Iteration: 4594, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468749165534973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02588464505970478, decouple_loss:0.0012421563733369112
The modified gen p mean: 0.4483475685119629, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025753578171133995, decouple_loss:0.001183501910418272
The modified gen p mean: 0.4451262354850769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025752397254109383, decouple_loss:0.0012748580193147063
Iteration: 4595, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477580487728119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02479981631040573, decouple_loss:0.0012330696918070316
The modified gen p mean: 0.4464794993400574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02630779519677162, decouple_loss:0.0010825714562088251
The modified gen p mean: 0.4481457769870758, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025272119790315628, decouple_loss:0.0012140882899984717
Iteration: 4596, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441714882850647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02578568086028099, decouple_loss:0.0011026638094335794
The modified gen p mean: 0.4506259560585022, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024540968239307404, decouple_loss:0.0011110686464235187
The modified gen p mean: 0.4485490620136261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025479115545749664, decouple_loss:0.0012043971801176667
Iteration: 4597, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44572627544403076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02587875910103321, decouple_loss:0.0011165551841259003
The modified gen p mean: 0.4449402093887329, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025724444538354874, decouple_loss:0.00110338325612247
The modified gen p mean: 0.44664424657821655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025627339258790016, decouple_loss:0.0012769042514264584
Iteration: 4598, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44352057576179504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026583541184663773, decouple_loss:0.0011954241199418902
The modified gen p mean: 0.44495388865470886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026183340698480606, decouple_loss:0.001102436799556017
The modified gen p mean: 0.44688093662261963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02637079730629921, decouple_loss:0.001167441951110959
Iteration: 4599, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44641008973121643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025265643373131752, decouple_loss:0.0011832418385893106
The modified gen p mean: 0.446900874376297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024409610778093338, decouple_loss:0.0013060569763183594
The modified gen p mean: 0.4436261057853699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026933789253234863, decouple_loss:0.001247319160029292
Iteration: 4600, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444526731967926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027321452274918556, decouple_loss:0.0012070804368704557
The modified gen p mean: 0.44838908314704895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024784570559859276, decouple_loss:0.001188113703392446
The modified gen p mean: 0.4454292058944702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025818048045039177, decouple_loss:0.0011003169929608703
2023-05-27 13:09:04 testing...
The modified gen p mean: 0.450969934463501, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032483961433172226, decouple_loss:0.00131786591373384
The modified gen p mean: 0.4486936628818512, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03277203440666199, decouple_loss:0.0012814347865059972
The modified gen p mean: 0.4504481852054596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03412379324436188, decouple_loss:0.0014289147220551968
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03319373354315758, avg_mse: 0.04547491297125816
current test mse: 0.045475
Iteration: 4601, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44610393047332764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024741079658269882, decouple_loss:0.0011706460500136018
The modified gen p mean: 0.4493171274662018, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024253908544778824, decouple_loss:0.001070248312316835
The modified gen p mean: 0.4460257291793823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024810651317238808, decouple_loss:0.0011023168917745352
Iteration: 4602, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44421902298927307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025765391066670418, decouple_loss:0.0010928354458883405
The modified gen p mean: 0.4467439651489258, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025329388678073883, decouple_loss:0.0011549617629498243
The modified gen p mean: 0.4454416036605835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025810549035668373, decouple_loss:0.0012022968148812652
Iteration: 4603, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44349443912506104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02647748962044716, decouple_loss:0.0012729408917948604
The modified gen p mean: 0.44460925459861755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025890067219734192, decouple_loss:0.0011802155058830976
The modified gen p mean: 0.4425165355205536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025613142177462578, decouple_loss:0.0010693925432860851
Iteration: 4604, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439905881881714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025124158710241318, decouple_loss:0.0012758418451994658
The modified gen p mean: 0.4455966353416443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025814475491642952, decouple_loss:0.001058568712323904
The modified gen p mean: 0.44751590490341187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025300955399870872, decouple_loss:0.001232731039635837
Iteration: 4605, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44143375754356384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026103967800736427, decouple_loss:0.0011515221558511257
The modified gen p mean: 0.4496549367904663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02454737015068531, decouple_loss:0.0012069187359884381
The modified gen p mean: 0.44409215450286865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025606172159314156, decouple_loss:0.0011023253900930285
Iteration: 4606, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472142457962036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025159213691949844, decouple_loss:0.0012183437356725335
The modified gen p mean: 0.4430764615535736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02571467123925686, decouple_loss:0.0010142205283045769
The modified gen p mean: 0.4439452886581421, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02603716030716896, decouple_loss:0.0011558177648112178
Iteration: 4607, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4431949853897095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02620522677898407, decouple_loss:0.001222564373165369
The modified gen p mean: 0.4437435269355774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025195585563778877, decouple_loss:0.0011247823713347316
The modified gen p mean: 0.44841283559799194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025097686797380447, decouple_loss:0.0012097737053409219
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4608, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44912147521972656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026627417653799057, decouple_loss:0.0011552858632057905
The modified gen p mean: 0.4456300437450409, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02766517736017704, decouple_loss:0.0010653580538928509
The modified gen p mean: 0.4474028944969177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02788843959569931, decouple_loss:0.0011167563498020172
Iteration: 4609, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4538573920726776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027564292773604393, decouple_loss:0.0011848395224660635
The modified gen p mean: 0.44671788811683655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026860039681196213, decouple_loss:0.0011238976148888469
The modified gen p mean: 0.44459041953086853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027276335284113884, decouple_loss:0.0011755814775824547
Iteration: 4610, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44844743609428406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028601350262761116, decouple_loss:0.0012062268797308207
The modified gen p mean: 0.4507772624492645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02681436762213707, decouple_loss:0.0011734580621123314
The modified gen p mean: 0.4530523717403412, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025923939421772957, decouple_loss:0.0012317841174080968
2023-05-27 13:13:50 testing...
The modified gen p mean: 0.45518991351127625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032403621822595596, decouple_loss:0.0013446132652461529
The modified gen p mean: 0.4547256827354431, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03408366069197655, decouple_loss:0.001379141816869378
The modified gen p mean: 0.4530315399169922, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03274532034993172, decouple_loss:0.0013240377884358168
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0331449992954731, avg_mse: 0.045315708965063095
current test mse: 0.045316
Iteration: 4611, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4530003070831299, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026436371728777885, decouple_loss:0.0012313934275880456
The modified gen p mean: 0.4540727138519287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02697719819843769, decouple_loss:0.00119129684753716
The modified gen p mean: 0.45024868845939636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027904415503144264, decouple_loss:0.0011137087130919099
Iteration: 4612, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45103177428245544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0268456619232893, decouple_loss:0.0012644699309021235
The modified gen p mean: 0.45344555377960205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025492848828434944, decouple_loss:0.001292773406021297
The modified gen p mean: 0.44835516810417175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027453739196062088, decouple_loss:0.0010772761888802052
Iteration: 4613, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45170754194259644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02630171924829483, decouple_loss:0.0012807648163288832
The modified gen p mean: 0.4516870379447937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02601543813943863, decouple_loss:0.0011278389720246196
The modified gen p mean: 0.45246174931526184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026215875521302223, decouple_loss:0.0013026549713686109
Iteration: 4614, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506833553314209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027374211698770523, decouple_loss:0.0011595106916502118
The modified gen p mean: 0.4534757435321808, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026761142536997795, decouple_loss:0.00134777941275388
The modified gen p mean: 0.4540563225746155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026545092463493347, decouple_loss:0.0012703994289040565
Iteration: 4615, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487450420856476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026509245857596397, decouple_loss:0.0013084275415167212
The modified gen p mean: 0.44771459698677063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02797851525247097, decouple_loss:0.0011941936099901795
The modified gen p mean: 0.4476560056209564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027136683464050293, decouple_loss:0.0012222500517964363
Iteration: 4616, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512690007686615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02627062425017357, decouple_loss:0.001322912285104394
The modified gen p mean: 0.4462626278400421, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026958439499139786, decouple_loss:0.0012235974427312613
The modified gen p mean: 0.4484366476535797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026799598708748817, decouple_loss:0.0013422769261524081
Iteration: 4617, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44728514552116394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02731359377503395, decouple_loss:0.001229240675456822
The modified gen p mean: 0.45279043912887573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02707715518772602, decouple_loss:0.0013855805154889822
The modified gen p mean: 0.44949817657470703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026348000392317772, decouple_loss:0.0014018584042787552
Iteration: 4618, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44560009241104126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026254752650856972, decouple_loss:0.001192631432786584
The modified gen p mean: 0.44466525316238403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026525083929300308, decouple_loss:0.0012901632580906153
The modified gen p mean: 0.4455569386482239, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027499083429574966, decouple_loss:0.0011545473244041204
Iteration: 4619, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446865439414978, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026200897991657257, decouple_loss:0.0012276438064873219
The modified gen p mean: 0.4507783353328705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02649884857237339, decouple_loss:0.0012273145839571953
The modified gen p mean: 0.4452504515647888, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027125660330057144, decouple_loss:0.0013059080811217427
Iteration: 4620, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459383189678192, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02572142705321312, decouple_loss:0.001383947441354394
The modified gen p mean: 0.44894248247146606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026364563032984734, decouple_loss:0.0015249403659254313
The modified gen p mean: 0.44727444648742676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026277678087353706, decouple_loss:0.0014380576321855187
2023-05-27 13:17:56 testing...
The modified gen p mean: 0.45161738991737366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03281346708536148, decouple_loss:0.0015101879835128784
The modified gen p mean: 0.4495977461338043, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45121821761131287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03329841047525406, decouple_loss:0.0015297905774787068
loss_pred:0.03454479202628136, decouple_loss:0.0015130492392927408
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033628106117248535, avg_mse: 0.04603522643446922
current test mse: 0.046035
Iteration: 4621, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44976192712783813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02656976319849491, decouple_loss:0.0013044843217357993
The modified gen p mean: 0.4482978582382202, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02744969166815281, decouple_loss:0.0013878727331757545
The modified gen p mean: 0.448069304227829, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025732791051268578, decouple_loss:0.0012680512154474854
Iteration: 4622, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514836072921753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026400256901979446, decouple_loss:0.0013235523365437984
The modified gen p mean: 0.44849836826324463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026643984019756317, decouple_loss:0.0013101967051625252
The modified gen p mean: 0.45084232091903687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02645391970872879, decouple_loss:0.0013300514547154307
Iteration: 4623, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489893913269043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026205861940979958, decouple_loss:0.0012220845092087984
The modified gen p mean: 0.4515537619590759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026336416602134705, decouple_loss:0.0013480224879458547
The modified gen p mean: 0.45348212122917175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02699476294219494, decouple_loss:0.0014741478953510523
Iteration: 4624, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492376148700714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028737280517816544, decouple_loss:0.001261286437511444
The modified gen p mean: 0.4486880600452423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027530424296855927, decouple_loss:0.0012470475630834699
The modified gen p mean: 0.44990745186805725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02844703383743763, decouple_loss:0.0012698799837380648
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4625, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501478672027588, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0257110558450222, decouple_loss:0.0013944734819233418
The modified gen p mean: 0.4534362256526947, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4509546756744385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02716449834406376, decouple_loss:0.0013220743276178837
loss_pred:0.025738731026649475, decouple_loss:0.0013482889626175165
Iteration: 4626, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487656354904175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028912026435136795, decouple_loss:0.0012022381415590644
The modified gen p mean: 0.45176634192466736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02807053178548813, decouple_loss:0.0013311716029420495
The modified gen p mean: 0.4498303532600403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026685556396842003, decouple_loss:0.001340903458185494
Iteration: 4627, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45071786642074585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025986023247241974, decouple_loss:0.0013702405849471688
The modified gen p mean: 0.4499742388725281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02548464946448803, decouple_loss:0.001312843058258295
The modified gen p mean: 0.45146095752716064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026503562927246094, decouple_loss:0.0014209565706551075
Iteration: 4628, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44801121950149536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026652755215764046, decouple_loss:0.0011452509788796306
The modified gen p mean: 0.44874686002731323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027246475219726562, decouple_loss:0.001220974256284535
The modified gen p mean: 0.4482162594795227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02863898314535618, decouple_loss:0.001305585028603673
Iteration: 4629, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505269229412079, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026982426643371582, decouple_loss:0.0014397688210010529
The modified gen p mean: 0.4486415982246399, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025121837854385376, decouple_loss:0.0012343220878392458
The modified gen p mean: 0.4481491148471832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026048345491290092, decouple_loss:0.0011785924434661865
Iteration: 4630, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44728487730026245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027072984725236893, decouple_loss:0.0012953642290085554
The modified gen p mean: 0.4489523470401764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026979437097907066, decouple_loss:0.0012054616818204522
The modified gen p mean: 0.4501205384731293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027051441371440887, decouple_loss:0.0012181340716779232
2023-05-27 13:22:44 testing...
The modified gen p mean: 0.4500141441822052, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03306150436401367, decouple_loss:0.001493668183684349
The modified gen p mean: 0.4496186077594757, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034779828041791916, decouple_loss:0.0015164475189521909
The modified gen p mean: 0.4478677213191986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033439744263887405, decouple_loss:0.0014595410320907831
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03383485600352287, avg_mse: 0.046357329934835434
current test mse: 0.046357
Iteration: 4631, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44615715742111206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026148101314902306, decouple_loss:0.001247486798092723
The modified gen p mean: 0.4489043354988098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026932643726468086, decouple_loss:0.001236520940437913
The modified gen p mean: 0.44550472497940063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02538665384054184, decouple_loss:0.0012222157092764974
Iteration: 4632, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447227716445923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026859048753976822, decouple_loss:0.001302686519920826
The modified gen p mean: 0.4457411766052246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025874147191643715, decouple_loss:0.001388352015055716
The modified gen p mean: 0.44664114713668823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02770926058292389, decouple_loss:0.0011867418652400374
Iteration: 4633, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460636079311371, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026012711226940155, decouple_loss:0.0012314118212088943
The modified gen p mean: 0.44402259588241577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02596322074532509, decouple_loss:0.0012109448434785008
The modified gen p mean: 0.44446036219596863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02515711635351181, decouple_loss:0.0014545704470947385
Iteration: 4634, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473174810409546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026013171300292015, decouple_loss:0.0012545549543574452
The modified gen p mean: 0.44525426626205444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0274796299636364, decouple_loss:0.0012701415689662099
The modified gen p mean: 0.44661518931388855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026499159634113312, decouple_loss:0.0011572157964110374
Iteration: 4635, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460628032684326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026531200855970383, decouple_loss:0.0011680575553327799
The modified gen p mean: 0.4494147002696991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026950476691126823, decouple_loss:0.001584729878231883
The modified gen p mean: 0.44422951340675354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027623141184449196, decouple_loss:0.001168557209894061
Iteration: 4636, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466325640678406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027315160259604454, decouple_loss:0.0011467919684946537
The modified gen p mean: 0.4467533528804779, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026261642575263977, decouple_loss:0.0011910164030268788
The modified gen p mean: 0.45002132654190063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02596731297671795, decouple_loss:0.0014022907707840204
Iteration: 4637, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487901031970978, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02727579139173031, decouple_loss:0.0010922965593636036
The modified gen p mean: 0.4495103359222412, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02554905042052269, decouple_loss:0.001265695900656283
The modified gen p mean: 0.45115235447883606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026955362409353256, decouple_loss:0.0013930253917351365
Iteration: 4638, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44861143827438354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025414494797587395, decouple_loss:0.0012797489762306213
The modified gen p mean: 0.44674161076545715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02667008712887764, decouple_loss:0.0012357725063338876
The modified gen p mean: 0.44571250677108765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027035346254706383, decouple_loss:0.0011830227449536324
Iteration: 4639, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497929811477661, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025291480123996735, decouple_loss:0.0013152387691661716
The modified gen p mean: 0.4512796700000763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025122370570898056, decouple_loss:0.0012127297231927514
The modified gen p mean: 0.45154812932014465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025089722126722336, decouple_loss:0.0011953774373978376
Iteration: 4640, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44451430439949036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028270969167351723, decouple_loss:0.0013591243186965585
The modified gen p mean: 0.45059117674827576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02556624822318554, decouple_loss:0.0012066038325428963
The modified gen p mean: 0.4506191611289978, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026311466470360756, decouple_loss:0.0012123921187594533
2023-05-27 13:26:52 testing...
The modified gen p mean: 0.45234522223472595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03317737579345703, decouple_loss:0.0013837245060130954
The modified gen p mean: 0.4499848484992981, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03347443789243698, decouple_loss:0.0014298396417871118
The modified gen p mean: 0.45205551385879517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03501543775200844, decouple_loss:0.0014154501259326935
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03395956754684448, avg_mse: 0.04658865928649902
current test mse: 0.046589
Iteration: 4641, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491526186466217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026813920587301254, decouple_loss:0.0012272907188162208
The modified gen p mean: 0.44805362820625305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027572602033615112, decouple_loss:0.0011691967956721783
The modified gen p mean: 0.44782525300979614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026910126209259033, decouple_loss:0.0011776082683354616
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr.npz
NaN value num: 0
Iteration: 4642, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45200490951538086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025820404291152954, decouple_loss:0.001235713018104434
The modified gen p mean: 0.44667598605155945, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4491150975227356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02628483437001705, decouple_loss:0.0013236593222245574
loss_pred:0.026468465104699135, decouple_loss:0.0011448014993220568
Iteration: 4643, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44992026686668396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02631516568362713, decouple_loss:0.0013829133240506053
The modified gen p mean: 0.44537508487701416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025496676564216614, decouple_loss:0.001262565841898322
The modified gen p mean: 0.44561800360679626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02607794478535652, decouple_loss:0.001244226237758994
Iteration: 4644, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44812577962875366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025310654193162918, decouple_loss:0.0010900124907493591
The modified gen p mean: 0.44588395953178406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025951998308300972, decouple_loss:0.0011249218368902802
The modified gen p mean: 0.4493166208267212, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02535846456885338, decouple_loss:0.001236526994034648
Iteration: 4645, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442816972732544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02564983442425728, decouple_loss:0.0012038246495649219
The modified gen p mean: 0.44275084137916565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025506149977445602, decouple_loss:0.0011819255305454135
The modified gen p mean: 0.44508272409439087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025686586275696754, decouple_loss:0.001270586741156876
Iteration: 4646, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44087815284729004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025886977091431618, decouple_loss:0.0012105409987270832
The modified gen p mean: 0.4454444944858551, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025214074179530144, decouple_loss:0.0012458792189136147
The modified gen p mean: 0.4437808394432068, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02592460811138153, decouple_loss:0.0011050929315388203
Iteration: 4647, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4432462751865387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02639511227607727, decouple_loss:0.0011963703436776996
The modified gen p mean: 0.4489009976387024, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025306589901447296, decouple_loss:0.001237934222444892
The modified gen p mean: 0.4417436718940735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026886137202382088, decouple_loss:0.0012757902732118964
Iteration: 4648, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461686313152313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02577630802989006, decouple_loss:0.0012872471706941724
The modified gen p mean: 0.4449745714664459, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025428883731365204, decouple_loss:0.0012947561917826533
The modified gen p mean: 0.44369205832481384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026983721181750298, decouple_loss:0.001166138332337141
Iteration: 4649, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514191746711731, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024762246757745743, decouple_loss:0.0011792061850428581
The modified gen p mean: 0.44952553510665894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024787472561001778, decouple_loss:0.0011157372500747442
The modified gen p mean: 0.44636860489845276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025964627042412758, decouple_loss:0.001097343279980123
Iteration: 4650, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475719630718231, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02575833350419998, decouple_loss:0.0011688974918797612
The modified gen p mean: 0.4507749378681183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02500692754983902, decouple_loss:0.0011801491491496563
The modified gen p mean: 0.4531615674495697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02521759271621704, decouple_loss:0.001122159417718649
2023-05-27 13:31:35 testing...
The modified gen p mean: 0.45498260855674744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0329485759139061, decouple_loss:0.0014046576106920838
The modified gen p mean: 0.4527204632759094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03323470801115036, decouple_loss:0.001393460319377482
The modified gen p mean: 0.4546574056148529, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03473706915974617, decouple_loss:0.0014462410472333431
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03371085971593857, avg_mse: 0.046311795711517334
current test mse: 0.046312
Iteration: 4651, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44873160123825073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025765806436538696, decouple_loss:0.001100771827623248
The modified gen p mean: 0.45183005928993225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024465052410960197, decouple_loss:0.0011610148940235376
The modified gen p mean: 0.44864794611930847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026244958862662315, decouple_loss:0.0011418918147683144
Iteration: 4652, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45271897315979004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025191128253936768, decouple_loss:0.0012856131652370095
The modified gen p mean: 0.45068755745887756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025603095069527626, decouple_loss:0.0010425625368952751
The modified gen p mean: 0.4495050609111786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02668941579759121, decouple_loss:0.0012153333518654108
Iteration: 4653, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45276108384132385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025565993040800095, decouple_loss:0.001226657535880804
The modified gen p mean: 0.4508906900882721, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024525463581085205, decouple_loss:0.0012163289356976748
The modified gen p mean: 0.45085254311561584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026153286918997765, decouple_loss:0.0012036508414894342
Iteration: 4654, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468920826911926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027058057487010956, decouple_loss:0.0010992944007739425
The modified gen p mean: 0.45131659507751465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025021962821483612, decouple_loss:0.001166895148344338
The modified gen p mean: 0.45045608282089233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025165682658553123, decouple_loss:0.0012080249143764377
Iteration: 4655, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475333094596863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02646196447312832, decouple_loss:0.001232111593708396
The modified gen p mean: 0.44665712118148804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025935066863894463, decouple_loss:0.0011660476448014379
The modified gen p mean: 0.4486449062824249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024821540340781212, decouple_loss:0.0012573034036904573
Iteration: 4656, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484354853630066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025393648073077202, decouple_loss:0.0012260274961590767
The modified gen p mean: 0.4457203149795532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02647833712399006, decouple_loss:0.0013705231249332428
The modified gen p mean: 0.44734060764312744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027044273912906647, decouple_loss:0.0013617075746878982
Iteration: 4657, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4433581531047821, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026544472202658653, decouple_loss:0.0011007598368451
The modified gen p mean: 0.44472262263298035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025922009721398354, decouple_loss:0.0010576826753094792
The modified gen p mean: 0.449568510055542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02510015107691288, decouple_loss:0.001152183162048459
Iteration: 4658, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44212448596954346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025184139609336853, decouple_loss:0.0011346625396981835
The modified gen p mean: 0.44285205006599426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02571365423500538, decouple_loss:0.0011059397365897894
The modified gen p mean: 0.4460030496120453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024126354604959488, decouple_loss:0.001258021336980164
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr.npz
NaN value num: 0
Iteration: 4659, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44682925939559937, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4463721513748169, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0257166288793087, decouple_loss:0.0012584872310981154
The modified gen p mean: 0.4458461105823517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026045886799693108, decouple_loss:0.00127130385953933
loss_pred:0.02481602318584919, decouple_loss:0.0013129935832694173
Iteration: 4660, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482952356338501, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02591746859252453, decouple_loss:0.0011100312694907188
The modified gen p mean: 0.4463014602661133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02396737039089203, decouple_loss:0.0012501876335591078
The modified gen p mean: 0.4442199170589447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026628321036696434, decouple_loss:0.0010986833367496729
2023-05-27 13:36:22 testing...
The modified gen p mean: 0.4525389075279236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261658921837807, decouple_loss:0.0013425303623080254
The modified gen p mean: 0.4503386318683624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03294706717133522, decouple_loss:0.0013667989987879992
The modified gen p mean: 0.452140212059021, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034408509731292725, decouple_loss:0.0014731731498613954
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03339376673102379, avg_mse: 0.04574745148420334
current test mse: 0.045747
Iteration: 4661, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44334787130355835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02679079957306385, decouple_loss:0.0010439393809065223
The modified gen p mean: 0.4490111172199249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02468891814351082, decouple_loss:0.0011810091091319919
The modified gen p mean: 0.4449314773082733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026033412665128708, decouple_loss:0.001211497699841857
Iteration: 4662, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44987520575523376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026070432737469673, decouple_loss:0.0012218632036820054
The modified gen p mean: 0.4467787444591522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02632962167263031, decouple_loss:0.0011963272700086236
The modified gen p mean: 0.447842538356781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025864379480481148, decouple_loss:0.0014016757486388087
Iteration: 4663, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4521547853946686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025796018540859222, decouple_loss:0.0011682708282023668
The modified gen p mean: 0.4499010145664215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02488340623676777, decouple_loss:0.0011660096934065223
The modified gen p mean: 0.4484279453754425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024916058406233788, decouple_loss:0.00113600492477417
Iteration: 4664, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44962000846862793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025753522291779518, decouple_loss:0.0011203059693798423
The modified gen p mean: 0.44853898882865906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026323385536670685, decouple_loss:0.0011592290829867125
The modified gen p mean: 0.4499257802963257, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024995528161525726, decouple_loss:0.0011998459231108427
Iteration: 4665, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485110640525818, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02562595345079899, decouple_loss:0.0011499052634462714
The modified gen p mean: 0.4448343813419342, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026113444939255714, decouple_loss:0.0012260967632755637
The modified gen p mean: 0.44501468539237976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02706330642104149, decouple_loss:0.0011846580309793353
Iteration: 4666, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44987252354621887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025621885433793068, decouple_loss:0.0013158769579604268
The modified gen p mean: 0.4446263313293457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026547491550445557, decouple_loss:0.0012314387131482363
The modified gen p mean: 0.4461899399757385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026059936732053757, decouple_loss:0.0011781303910538554
Iteration: 4667, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444460928440094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027072548866271973, decouple_loss:0.0012791308108717203
The modified gen p mean: 0.4484357237815857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024853534996509552, decouple_loss:0.0010948616545647383
The modified gen p mean: 0.44454917311668396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026332374662160873, decouple_loss:0.0011762336362153292
Iteration: 4668, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44357830286026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02672339789569378, decouple_loss:0.0012419756967574358
The modified gen p mean: 0.449110746383667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02519311010837555, decouple_loss:0.0014379655476659536
The modified gen p mean: 0.4433493912220001, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0266150813549757, decouple_loss:0.001153735676780343
Iteration: 4669, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44885724782943726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02525360696017742, decouple_loss:0.0012611446436494589
The modified gen p mean: 0.4461623430252075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026290498673915863, decouple_loss:0.0011769678676500916
The modified gen p mean: 0.4460667669773102, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026119284331798553, decouple_loss:0.0011652164394035935
Iteration: 4670, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444461762905121, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026233136653900146, decouple_loss:0.0011148412013426423
The modified gen p mean: 0.44824129343032837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024776065722107887, decouple_loss:0.0012080557644367218
The modified gen p mean: 0.44816702604293823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024419397115707397, decouple_loss:0.0013392481487244368
2023-05-27 13:40:28 testing...
The modified gen p mean: 0.4519985020160675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03270518407225609, decouple_loss:0.0013401815667748451
The modified gen p mean: 0.4498228132724762, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03302336484193802, decouple_loss:0.001388562610372901
The modified gen p mean: 0.4515664279460907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03461584448814392, decouple_loss:0.0014018046204000711
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03351697325706482, avg_mse: 0.04599350318312645
current test mse: 0.045994
Iteration: 4671, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445435106754303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026263752952218056, decouple_loss:0.001240560901351273
The modified gen p mean: 0.4489736258983612, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024980753660202026, decouple_loss:0.0012093964032828808
The modified gen p mean: 0.44639357924461365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024943342432379723, decouple_loss:0.0012160807382315397
Iteration: 4672, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44437962770462036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02656375989317894, decouple_loss:0.001081967493519187
The modified gen p mean: 0.4487445652484894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025723854079842567, decouple_loss:0.0012121725594624877
The modified gen p mean: 0.4460861384868622, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024068742990493774, decouple_loss:0.001342212432064116
Iteration: 4673, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485216736793518, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02534506283700466, decouple_loss:0.0012267029378563166
The modified gen p mean: 0.44856172800064087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02431168220937252, decouple_loss:0.001252296264283359
The modified gen p mean: 0.4477715492248535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02541804313659668, decouple_loss:0.001285888021811843
Iteration: 4674, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469446837902069, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024988414719700813, decouple_loss:0.001226202119141817
The modified gen p mean: 0.4480430483818054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02483280561864376, decouple_loss:0.0011816906044259667
The modified gen p mean: 0.4455174505710602, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02682008221745491, decouple_loss:0.001358895329758525
Iteration: 4675, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44967344403266907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024570433422923088, decouple_loss:0.0010947142727673054
The modified gen p mean: 0.44654178619384766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026624592021107674, decouple_loss:0.0010654751677066088
The modified gen p mean: 0.4497941732406616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024693123996257782, decouple_loss:0.0012467365013435483
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr.npz
NaN value num: 0
Iteration: 4676, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443919062614441, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026596220210194588, decouple_loss:0.0013004199136048555
The modified gen p mean: 0.44869929552078247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025585290044546127, decouple_loss:0.0012907952768728137
The modified gen p mean: 0.4484836459159851, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02511494606733322, decouple_loss:0.0012169003020972013
Iteration: 4677, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44698742032051086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025622878223657608, decouple_loss:0.0013038988690823317
The modified gen p mean: 0.44801780581474304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0252957995980978, decouple_loss:0.0013009347021579742
The modified gen p mean: 0.4494922161102295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027326658368110657, decouple_loss:0.0012560788309201598
Iteration: 4678, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44528645277023315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027338577434420586, decouple_loss:0.0013359267031773925
The modified gen p mean: 0.45055609941482544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025599583983421326, decouple_loss:0.0012429009657353163
The modified gen p mean: 0.45038193464279175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024898648262023926, decouple_loss:0.0013029073597863317
Iteration: 4679, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477311074733734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025565791875123978, decouple_loss:0.001183612970635295
The modified gen p mean: 0.4518370032310486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02618248574435711, decouple_loss:0.0012695101322606206
The modified gen p mean: 0.4491541087627411, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02533920854330063, decouple_loss:0.0011954838410019875
Iteration: 4680, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502963125705719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026059113442897797, decouple_loss:0.0012374457437545061
The modified gen p mean: 0.444966584444046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027178585529327393, decouple_loss:0.001222300110384822
The modified gen p mean: 0.45148804783821106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025276165455579758, decouple_loss:0.001134569407440722
2023-05-27 13:45:19 testing...
The modified gen p mean: 0.4540296494960785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03257620707154274, decouple_loss:0.0013903951039537787
The modified gen p mean: 0.4535897374153137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03445691987872124, decouple_loss:0.0014786164974793792
The modified gen p mean: 0.45181313157081604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032928936183452606, decouple_loss:0.0013524361420422792
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03339105099439621, avg_mse: 0.04574434459209442
current test mse: 0.045744
Iteration: 4681, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518299400806427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025240633636713028, decouple_loss:0.0012346982257440686
The modified gen p mean: 0.45313024520874023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026309803128242493, decouple_loss:0.0011439791414886713
The modified gen p mean: 0.44768914580345154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026733726263046265, decouple_loss:0.0011211484670639038
Iteration: 4682, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44685593247413635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026169443503022194, decouple_loss:0.0011099845869466662
The modified gen p mean: 0.45027974247932434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025324083864688873, decouple_loss:0.001205259351991117
The modified gen p mean: 0.4486566185951233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02545376867055893, decouple_loss:0.001154705067165196
Iteration: 4683, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485825002193451, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026570003479719162, decouple_loss:0.0011049978202208877
The modified gen p mean: 0.45011091232299805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02551228180527687, decouple_loss:0.0011644118931144476
The modified gen p mean: 0.4446339011192322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026661448180675507, decouple_loss:0.0011039272649213672
Iteration: 4684, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474172294139862, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026222292333841324, decouple_loss:0.0011298866011202335
The modified gen p mean: 0.45261749625205994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025181546807289124, decouple_loss:0.0011304495856165886
The modified gen p mean: 0.4517821967601776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0259394533932209, decouple_loss:0.001221936079673469
Iteration: 4685, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501820206642151, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02588322013616562, decouple_loss:0.0013245305744931102
The modified gen p mean: 0.4471563994884491, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02716854400932789, decouple_loss:0.0012075705453753471
The modified gen p mean: 0.4519345164299011, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025183239951729774, decouple_loss:0.0011703339405357838
Iteration: 4686, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469413161277771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026099950075149536, decouple_loss:0.0011961766285821795
The modified gen p mean: 0.44464021921157837, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02628541924059391, decouple_loss:0.001146196504123509
The modified gen p mean: 0.44551631808280945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025706922635436058, decouple_loss:0.0010797021677717566
Iteration: 4687, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44633570313453674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0268031544983387, decouple_loss:0.001150592346675694
The modified gen p mean: 0.4453599750995636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02576415240764618, decouple_loss:0.0012042410671710968
The modified gen p mean: 0.44869282841682434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02484026923775673, decouple_loss:0.0011941025732085109
Iteration: 4688, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449851930141449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024759136140346527, decouple_loss:0.001118303625844419
The modified gen p mean: 0.44888320565223694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02520741894841194, decouple_loss:0.0012046885676681995
The modified gen p mean: 0.45152655243873596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025352230295538902, decouple_loss:0.0011327476240694523
Iteration: 4689, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486091136932373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025441884994506836, decouple_loss:0.0010734726674854755
The modified gen p mean: 0.446228951215744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027477998286485672, decouple_loss:0.0011120385024696589
The modified gen p mean: 0.4502881169319153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02505853958427906, decouple_loss:0.0012419461272656918
Iteration: 4690, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45301756262779236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025074729695916176, decouple_loss:0.001299434807151556
The modified gen p mean: 0.45020052790641785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025945473462343216, decouple_loss:0.001216271659359336
The modified gen p mean: 0.45162561535835266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025810720399022102, decouple_loss:0.0012532728724181652
2023-05-27 13:49:28 testing...
The modified gen p mean: 0.4539995491504669, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4518473744392395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265756368637085, decouple_loss:0.001387210562825203
loss_pred:0.03298242762684822, decouple_loss:0.0012876488035544753
The modified gen p mean: 0.453601211309433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034492891281843185, decouple_loss:0.001471475581638515
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03344673663377762, avg_mse: 0.04583711922168732
current test mse: 0.045837
Iteration: 4691, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45330333709716797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026206249371170998, decouple_loss:0.001162003492936492
The modified gen p mean: 0.4470345377922058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026372665539383888, decouple_loss:0.001075460691936314
The modified gen p mean: 0.44859349727630615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026006897911429405, decouple_loss:0.0010577281937003136
Iteration: 4692, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44777461886405945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025225507095456123, decouple_loss:0.0012074941769242287
The modified gen p mean: 0.4520419239997864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026752788573503494, decouple_loss:0.0011471050092950463
The modified gen p mean: 0.4490104019641876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026425451040267944, decouple_loss:0.0011113594518974423
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4693, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478664994239807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027629179880023003, decouple_loss:0.0010725207393988967
The modified gen p mean: 0.4534361660480499, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4526881277561188, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02676808089017868, decouple_loss:0.0011206658091396093
loss_pred:0.025989428162574768, decouple_loss:0.001115871942602098
Iteration: 4694, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44810545444488525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02573157474398613, decouple_loss:0.0011292723938822746
The modified gen p mean: 0.45111796259880066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025065172463655472, decouple_loss:0.0011366010876372457
The modified gen p mean: 0.4494810402393341, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025728173553943634, decouple_loss:0.0010267070028930902
Iteration: 4695, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45280522108078003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026069357991218567, decouple_loss:0.0010783508187159896
The modified gen p mean: 0.4502922296524048, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025668788701295853, decouple_loss:0.0011539648985490203
The modified gen p mean: 0.4505403935909271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0255903247743845, decouple_loss:0.0010945271933451295
Iteration: 4696, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467644989490509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026573561131954193, decouple_loss:0.0012054649414494634
The modified gen p mean: 0.44831612706184387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025645211338996887, decouple_loss:0.0012254465837031603
The modified gen p mean: 0.452059268951416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02649437077343464, decouple_loss:0.0011490507749840617
Iteration: 4697, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45308059453964233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025349164381623268, decouple_loss:0.001079520327039063
The modified gen p mean: 0.4492063522338867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026412341743707657, decouple_loss:0.0011036961805075407
The modified gen p mean: 0.44873517751693726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026833342388272285, decouple_loss:0.0011008455185219646
Iteration: 4698, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490368962287903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02547154389321804, decouple_loss:0.001091697602532804
The modified gen p mean: 0.4483855068683624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02557721920311451, decouple_loss:0.0010967329144477844
The modified gen p mean: 0.44831740856170654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026657752692699432, decouple_loss:0.0010778374271467328
Iteration: 4699, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44876211881637573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025321830064058304, decouple_loss:0.0012120355386286974
The modified gen p mean: 0.44553080201148987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026131685823202133, decouple_loss:0.001154331723228097
The modified gen p mean: 0.4501146078109741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02714357152581215, decouple_loss:0.0012512545799836516
Iteration: 4700, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515676200389862, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026372717693448067, decouple_loss:0.0012393458746373653
The modified gen p mean: 0.4497566521167755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025516385212540627, decouple_loss:0.0011478664819151163
The modified gen p mean: 0.4489404261112213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026128122583031654, decouple_loss:0.0012874370440840721
2023-05-27 13:54:14 testing...
The modified gen p mean: 0.45085054636001587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032887428998947144, decouple_loss:0.0015275288606062531
The modified gen p mean: 0.44877639412879944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0332200787961483, decouple_loss:0.0014412844320759177
The modified gen p mean: 0.45045390725135803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034721553325653076, decouple_loss:0.0015122678596526384
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033684372901916504, avg_mse: 0.04613377898931503
current test mse: 0.046134
Iteration: 4701, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492620527744293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025210794061422348, decouple_loss:0.0011999254347756505
The modified gen p mean: 0.44476544857025146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027658430859446526, decouple_loss:0.0012203253572806716
The modified gen p mean: 0.4459717869758606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02524816431105137, decouple_loss:0.0012005312601104379
Iteration: 4702, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499513804912567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025241144001483917, decouple_loss:0.0011864292901009321
The modified gen p mean: 0.44847697019577026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024926837533712387, decouple_loss:0.0011679204180836678
The modified gen p mean: 0.44314995408058167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0268036387860775, decouple_loss:0.0011347084073349833
Iteration: 4703, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44286656379699707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02724829688668251, decouple_loss:0.0011866253335028887
The modified gen p mean: 0.44586798548698425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026192106306552887, decouple_loss:0.0012558014132082462
The modified gen p mean: 0.4447600841522217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026362473145127296, decouple_loss:0.0011157976696267724
Iteration: 4704, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499460756778717, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025464629754424095, decouple_loss:0.0012559156166389585
The modified gen p mean: 0.4490770697593689, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02640187181532383, decouple_loss:0.001324540819041431
The modified gen p mean: 0.4520150125026703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025125743821263313, decouple_loss:0.0011945328442379832
Iteration: 4705, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513854682445526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025647973641753197, decouple_loss:0.0012466834159567952
The modified gen p mean: 0.44868332147598267, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02513524517416954, decouple_loss:0.0012770808534696698
The modified gen p mean: 0.4457929730415344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025879308581352234, decouple_loss:0.0011333120055496693
Iteration: 4706, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45203518867492676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024877192452549934, decouple_loss:0.0011720099719241261
The modified gen p mean: 0.4476114809513092, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02670920267701149, decouple_loss:0.0012098480947315693
The modified gen p mean: 0.4465528726577759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02595261111855507, decouple_loss:0.0012663662200793624
Iteration: 4707, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4523680806159973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026157457381486893, decouple_loss:0.0012981892796233296
The modified gen p mean: 0.45197778940200806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026531754061579704, decouple_loss:0.0012412653304636478
The modified gen p mean: 0.4445778727531433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026725446805357933, decouple_loss:0.0011541589628905058
Iteration: 4708, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4539821445941925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02633490040898323, decouple_loss:0.0011473032645881176
The modified gen p mean: 0.4492267072200775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02732643112540245, decouple_loss:0.001214030897244811
The modified gen p mean: 0.4476885497570038, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027268273755908012, decouple_loss:0.0011320344638079405
Iteration: 4709, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45019498467445374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025368306785821915, decouple_loss:0.00125934649258852
The modified gen p mean: 0.4483499228954315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026699122041463852, decouple_loss:0.0011214822297915816
The modified gen p mean: 0.4518258273601532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025655487552285194, decouple_loss:0.001195681863464415
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr.npz
NaN value num: 0
Iteration: 4710, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44534724950790405, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45219334959983826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027180125936865807, decouple_loss:0.0011614528484642506
loss_pred:0.02532266639173031, decouple_loss:0.0012978671584278345
The modified gen p mean: 0.44678443670272827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0272346381098032, decouple_loss:0.001206564367748797
2023-05-27 13:59:05 testing...
The modified gen p mean: 0.45357099175453186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03315157815814018, decouple_loss:0.0014272949192672968
The modified gen p mean: 0.4515571594238281, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4531848728656769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03346780315041542, decouple_loss:0.001438594306819141
loss_pred:0.03491942211985588, decouple_loss:0.0014763826038688421
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03391864150762558, avg_mse: 0.0465206541121006
current test mse: 0.046521
Iteration: 4711, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519555866718292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025829531252384186, decouple_loss:0.0012495059054344893
The modified gen p mean: 0.45190325379371643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02482416480779648, decouple_loss:0.0013117658672854304
The modified gen p mean: 0.45037949085235596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02422470785677433, decouple_loss:0.001347768702544272
Iteration: 4712, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441540539264679, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027229050174355507, decouple_loss:0.0012086366768926382
The modified gen p mean: 0.4453122019767761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026249924674630165, decouple_loss:0.0012018647976219654
The modified gen p mean: 0.44506365060806274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02590913325548172, decouple_loss:0.0012269351864233613
Iteration: 4713, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480806887149811, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02563936822116375, decouple_loss:0.0011407583951950073
The modified gen p mean: 0.449697881937027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024774054065346718, decouple_loss:0.0012930829543620348
The modified gen p mean: 0.4490017294883728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02419246919453144, decouple_loss:0.0013872268609702587
Iteration: 4714, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450255334377289, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027008114382624626, decouple_loss:0.001223331899382174
The modified gen p mean: 0.4444296360015869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026899592950940132, decouple_loss:0.0012647712137550116
The modified gen p mean: 0.4430474042892456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026008279994130135, decouple_loss:0.001102654729038477
Iteration: 4715, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453224539756775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026870710775256157, decouple_loss:0.0011882544495165348
The modified gen p mean: 0.44651561975479126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025612207129597664, decouple_loss:0.0013438458554446697
The modified gen p mean: 0.44738614559173584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025360869243741035, decouple_loss:0.0012623328948393464
Iteration: 4716, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44907188415527344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02414248138666153, decouple_loss:0.0012043187161907554
The modified gen p mean: 0.4471759498119354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025026995688676834, decouple_loss:0.0011715918080881238
The modified gen p mean: 0.4436261057853699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02660600282251835, decouple_loss:0.001188189024105668
Iteration: 4717, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447140634059906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026407575234770775, decouple_loss:0.0011118365218862891
The modified gen p mean: 0.4459327161312103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026365116238594055, decouple_loss:0.0011745771626010537
The modified gen p mean: 0.4520866274833679, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025350982323288918, decouple_loss:0.0012640353525057435
Iteration: 4718, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4532272517681122, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024697689339518547, decouple_loss:0.0012119862949475646
The modified gen p mean: 0.4491792321205139, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02697872929275036, decouple_loss:0.0013199342647567391
The modified gen p mean: 0.4518685042858124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024926815181970596, decouple_loss:0.0011034387862309813
Iteration: 4719, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44966578483581543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025703903287649155, decouple_loss:0.001140123582445085
The modified gen p mean: 0.4495353698730469, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026039747521281242, decouple_loss:0.0011994115775451064
The modified gen p mean: 0.4484746754169464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025252167135477066, decouple_loss:0.0012186147505417466
Iteration: 4720, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4532829523086548, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025339603424072266, decouple_loss:0.0011652298271656036
The modified gen p mean: 0.4484255313873291, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026596656069159508, decouple_loss:0.0011845189146697521
The modified gen p mean: 0.45017313957214355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026516573503613472, decouple_loss:0.0012448746711015701
2023-05-27 14:03:11 testing...
The modified gen p mean: 0.45507436990737915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03271154314279556, decouple_loss:0.0013926636893302202
The modified gen p mean: 0.45304620265960693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032900627702474594, decouple_loss:0.0014381955843418837
The modified gen p mean: 0.4545173645019531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034492433071136475, decouple_loss:0.0014055613428354263
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03343880921602249, avg_mse: 0.045750271528959274
current test mse: 0.04575
Iteration: 4721, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509027600288391, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02481701970100403, decouple_loss:0.0011571623617783189
The modified gen p mean: 0.4495706558227539, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026064055040478706, decouple_loss:0.001137747778557241
The modified gen p mean: 0.4517239034175873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02504202164709568, decouple_loss:0.001154084107838571
Iteration: 4722, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44683459401130676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02604450285434723, decouple_loss:0.0010517383925616741
The modified gen p mean: 0.44599610567092896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025649171322584152, decouple_loss:0.0011541852727532387
The modified gen p mean: 0.44763562083244324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0256370659917593, decouple_loss:0.0011520981788635254
Iteration: 4723, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44825029373168945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024261929094791412, decouple_loss:0.001124795526266098
The modified gen p mean: 0.44717833399772644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025622744113206863, decouple_loss:0.001181833096779883
The modified gen p mean: 0.4485291540622711, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024478711187839508, decouple_loss:0.0012254378525540233
Iteration: 4724, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492107331752777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02504117600619793, decouple_loss:0.0011625606566667557
The modified gen p mean: 0.44592028856277466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026067513972520828, decouple_loss:0.001050282851792872
The modified gen p mean: 0.4460843503475189, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024750076234340668, decouple_loss:0.001163473236374557
Iteration: 4725, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45090436935424805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025646232068538666, decouple_loss:0.0011713715502992272
The modified gen p mean: 0.4447239637374878, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02595643326640129, decouple_loss:0.0009684649994596839
The modified gen p mean: 0.4464907944202423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02652694843709469, decouple_loss:0.001177920144982636
Iteration: 4726, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4420298635959625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026419630274176598, decouple_loss:0.0011919292155653238
The modified gen p mean: 0.44999733567237854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024058815091848373, decouple_loss:0.0011430599261075258
The modified gen p mean: 0.44396543502807617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026607349514961243, decouple_loss:0.0011727627133950591
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4727, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45085766911506653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028391914442181587, decouple_loss:0.0013015188742429018
The modified gen p mean: 0.4488168954849243, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4513237774372101, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02891884744167328, decouple_loss:0.0013803658075630665
loss_pred:0.02897845394909382, decouple_loss:0.0011869031004607677
Iteration: 4728, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4520968496799469, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028511477634310722, decouple_loss:0.0014218216529116035
The modified gen p mean: 0.4474104046821594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02898477390408516, decouple_loss:0.0011910549364984035
The modified gen p mean: 0.4516015350818634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028165370225906372, decouple_loss:0.0011164158349856734
Iteration: 4729, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44995126128196716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02964593842625618, decouple_loss:0.001284398720599711
The modified gen p mean: 0.45192259550094604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028500502929091454, decouple_loss:0.001102818758226931
The modified gen p mean: 0.4551165997982025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028004510328173637, decouple_loss:0.0013291158247739077
Iteration: 4730, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45252782106399536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028975797817111015, decouple_loss:0.0011393656022846699
The modified gen p mean: 0.45243439078330994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027336103841662407, decouple_loss:0.0013056438183411956
The modified gen p mean: 0.4575998783111572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028704920783638954, decouple_loss:0.0011557803954929113
2023-05-27 14:07:57 testing...
The modified gen p mean: 0.4567340314388275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03228897228837013, decouple_loss:0.0013692853972315788
The modified gen p mean: 0.4546491503715515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03284052759408951, decouple_loss:0.0014902984257787466
The modified gen p mean: 0.4561555087566376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03426080569624901, decouple_loss:0.0014206614578142762
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033201441168785095, avg_mse: 0.04526405408978462
current test mse: 0.045264
Iteration: 4731, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4518279433250427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029204996302723885, decouple_loss:0.0011458653025329113
The modified gen p mean: 0.45551279187202454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029671916738152504, decouple_loss:0.0011918343370780349
The modified gen p mean: 0.4514547288417816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02896345779299736, decouple_loss:0.0011869597947224975
Iteration: 4732, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44912925362586975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028413359075784683, decouple_loss:0.0010566696291789412
The modified gen p mean: 0.45489999651908875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028413493186235428, decouple_loss:0.00151267577894032
The modified gen p mean: 0.45082393288612366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02800581604242325, decouple_loss:0.0011719411704689264
Iteration: 4733, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478638768196106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029172997921705246, decouple_loss:0.0013153444742783904
The modified gen p mean: 0.45266100764274597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027917146682739258, decouple_loss:0.0011986432364210486
The modified gen p mean: 0.4529432952404022, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02996382862329483, decouple_loss:0.0012204890372231603
Iteration: 4734, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4523928165435791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02858699858188629, decouple_loss:0.0012145119253546
The modified gen p mean: 0.4512832462787628, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027264093980193138, decouple_loss:0.0013194577768445015
The modified gen p mean: 0.4455702602863312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028897996991872787, decouple_loss:0.0010930682765319943
Iteration: 4735, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485378563404083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03003408946096897, decouple_loss:0.0013044450897723436
The modified gen p mean: 0.45158249139785767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029666801914572716, decouple_loss:0.001217591343447566
The modified gen p mean: 0.44824865460395813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029762854799628258, decouple_loss:0.0011452636681497097
Iteration: 4736, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461875557899475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027831288054585457, decouple_loss:0.0012862090952694416
The modified gen p mean: 0.44782790541648865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028029683977365494, decouple_loss:0.0011816335609182715
The modified gen p mean: 0.446757972240448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029649412259459496, decouple_loss:0.0012177928583696485
Iteration: 4737, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462454617023468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029173921793699265, decouple_loss:0.0012273418251425028
The modified gen p mean: 0.44660210609436035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028821198269724846, decouple_loss:0.0011899806559085846
The modified gen p mean: 0.45064371824264526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02951993979513645, decouple_loss:0.0012609956320375204
Iteration: 4738, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44930097460746765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029825353994965553, decouple_loss:0.0012480220757424831
The modified gen p mean: 0.4479301869869232, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030070582404732704, decouple_loss:0.001240781508386135
The modified gen p mean: 0.4458286166191101, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02903514914214611, decouple_loss:0.001168411923572421
Iteration: 4739, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44743937253952026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030043525621294975, decouple_loss:0.0012865063035860658
The modified gen p mean: 0.4472651183605194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029604002833366394, decouple_loss:0.0012203982332721353
The modified gen p mean: 0.44771525263786316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030077166855335236, decouple_loss:0.0012159690959379077
Iteration: 4740, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451773077249527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028312506154179573, decouple_loss:0.0012205231469124556
The modified gen p mean: 0.4533579349517822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028706060722470284, decouple_loss:0.0012018760899081826
The modified gen p mean: 0.44832903146743774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02809840440750122, decouple_loss:0.0013513312442228198
2023-05-27 14:12:04 testing...
The modified gen p mean: 0.4526882767677307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03238547593355179, decouple_loss:0.0013899181503802538
The modified gen p mean: 0.4505327343940735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03294503688812256, decouple_loss:0.0015163616044446826
The modified gen p mean: 0.4519560933113098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034285493195056915, decouple_loss:0.0014507070882245898
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033277951180934906, avg_mse: 0.04539141431450844
current test mse: 0.045391
Iteration: 4741, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499012231826782, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02883257158100605, decouple_loss:0.0012323391856625676
The modified gen p mean: 0.4526009261608124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02819761261343956, decouple_loss:0.0012380019761621952
The modified gen p mean: 0.4462524354457855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029323464259505272, decouple_loss:0.00125851109623909
Iteration: 4742, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500848352909088, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02958587184548378, decouple_loss:0.0011869677109643817
The modified gen p mean: 0.4515851140022278, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029095351696014404, decouple_loss:0.001154443365521729
The modified gen p mean: 0.44680166244506836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03024953044950962, decouple_loss:0.0011746007949113846
Iteration: 4743, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45033249258995056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027789264917373657, decouple_loss:0.0012803858844563365
The modified gen p mean: 0.4493802487850189, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028919151052832603, decouple_loss:0.0011195146944373846
The modified gen p mean: 0.45046907663345337, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027391131967306137, decouple_loss:0.0013120912481099367
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4744, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458850622177124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026554051786661148, decouple_loss:0.0011667064391076565
The modified gen p mean: 0.44859516620635986, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44609320163726807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0285611804574728, decouple_loss:0.0012672081356868148
loss_pred:0.02597230114042759, decouple_loss:0.0012142261257395148
Iteration: 4745, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492844343185425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025595376268029213, decouple_loss:0.0013216196093708277
The modified gen p mean: 0.45004358887672424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024975528940558434, decouple_loss:0.001283360761590302
The modified gen p mean: 0.4503214955329895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026809630915522575, decouple_loss:0.0012431425275281072
Iteration: 4746, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469684958457947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026347752660512924, decouple_loss:0.0011772953439503908
The modified gen p mean: 0.4482872784137726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024288173764944077, decouple_loss:0.0012256562476977706
The modified gen p mean: 0.44494304060935974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027099421247839928, decouple_loss:0.0012113854754716158
Iteration: 4747, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450278103351593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02705228328704834, decouple_loss:0.0012012928491458297
The modified gen p mean: 0.4495936930179596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026262778788805008, decouple_loss:0.0012262525269761682
The modified gen p mean: 0.44633129239082336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027014626190066338, decouple_loss:0.0010106618283316493
Iteration: 4748, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467860758304596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024989262223243713, decouple_loss:0.001228158944286406
The modified gen p mean: 0.4445837438106537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02450888603925705, decouple_loss:0.001151351141743362
The modified gen p mean: 0.4504952132701874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02691076323390007, decouple_loss:0.0013544932007789612
Iteration: 4749, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45072245597839355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02558259107172489, decouple_loss:0.0011411516461521387
The modified gen p mean: 0.4464688003063202, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026652328670024872, decouple_loss:0.001102021080441773
The modified gen p mean: 0.4467697739601135, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026955200359225273, decouple_loss:0.0012137115700170398
Iteration: 4750, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44729122519493103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026038283482193947, decouple_loss:0.0011668098159134388
The modified gen p mean: 0.45073434710502625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025695975869894028, decouple_loss:0.001459806109778583
The modified gen p mean: 0.44611454010009766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02583342231810093, decouple_loss:0.0011207446223124862
2023-05-27 14:16:54 testing...
The modified gen p mean: 0.45231252908706665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032831329852342606, decouple_loss:0.0014547065366059542
The modified gen p mean: 0.4516558349132538, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03450344130396843, decouple_loss:0.0013954882742837071
The modified gen p mean: 0.45038777589797974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0330471470952034, decouple_loss:0.0015297573991119862
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03353364020586014, avg_mse: 0.04580084607005119
current test mse: 0.045801
Iteration: 4751, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44618692994117737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027189411222934723, decouple_loss:0.001161794876679778
The modified gen p mean: 0.44663357734680176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027127999812364578, decouple_loss:0.0011468981392681599
The modified gen p mean: 0.44718778133392334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02590363845229149, decouple_loss:0.0011734674917533994
Iteration: 4752, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44926461577415466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025851361453533173, decouple_loss:0.001231716014444828
The modified gen p mean: 0.4460052251815796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025569293648004532, decouple_loss:0.0012189174303784966
The modified gen p mean: 0.4518812298774719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025334976613521576, decouple_loss:0.001316626789048314
Iteration: 4753, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498966634273529, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673603780567646, decouple_loss:0.0012496565468609333
The modified gen p mean: 0.44819310307502747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025839127600193024, decouple_loss:0.0012981718173250556
The modified gen p mean: 0.447166383266449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02625645324587822, decouple_loss:0.0012684207176789641
Iteration: 4754, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478462040424347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02642730064690113, decouple_loss:0.001178754959255457
The modified gen p mean: 0.4448469877243042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027819953858852386, decouple_loss:0.0013233539648354053
The modified gen p mean: 0.4458179473876953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0280827134847641, decouple_loss:0.0012187373358756304
Iteration: 4755, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467499256134033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02668243832886219, decouple_loss:0.0011123967124149203
The modified gen p mean: 0.44536149501800537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026423510164022446, decouple_loss:0.0011995105305686593
The modified gen p mean: 0.4442577660083771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025203149765729904, decouple_loss:0.0011703093769028783
Iteration: 4756, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496418833732605, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4462794363498688, gen p mean: 0.0, mean p set: 0.448loss_pred:0.025513123720884323, decouple_loss:0.0012504708720371127
loss_pred:0.02625277452170849, decouple_loss:0.0011125007877126336
The modified gen p mean: 0.44601163268089294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025359323248267174, decouple_loss:0.001340318936854601
Iteration: 4757, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44603854417800903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025301145389676094, decouple_loss:0.0011403035605326295
The modified gen p mean: 0.45095211267471313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026538431644439697, decouple_loss:0.0011747083626687527
The modified gen p mean: 0.4498900771141052, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027099572122097015, decouple_loss:0.0013380178716033697
Iteration: 4758, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44562822580337524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027459217235445976, decouple_loss:0.0012322752736508846
The modified gen p mean: 0.44848304986953735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025290636345744133, decouple_loss:0.0013003346975892782
The modified gen p mean: 0.4476569592952728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0259245652705431, decouple_loss:0.0011918701929971576
Iteration: 4759, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454256594181061, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024988660588860512, decouple_loss:0.001290587242692709
The modified gen p mean: 0.44518014788627625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02638564445078373, decouple_loss:0.0012633108999580145
The modified gen p mean: 0.45038339495658875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02713880129158497, decouple_loss:0.001229995395988226
Iteration: 4760, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461652636528015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027427732944488525, decouple_loss:0.0012007083278149366
The modified gen p mean: 0.4483940601348877, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02491740696132183, decouple_loss:0.0013227233430370688
The modified gen p mean: 0.44717156887054443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02761320397257805, decouple_loss:0.0011661401949822903
2023-05-27 14:21:02 testing...
The modified gen p mean: 0.4532175064086914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032729580998420715, decouple_loss:0.0014319928595796227
The modified gen p mean: 0.45148158073425293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03293251991271973, decouple_loss:0.0014832989545539021
The modified gen p mean: 0.45268726348876953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03438086062669754, decouple_loss:0.0013918816111981869
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03341944143176079, avg_mse: 0.04567397013306618
current test mse: 0.045674
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4761, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4526808261871338, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02577195130288601, decouple_loss:0.001179138314910233
The modified gen p mean: 0.4506032466888428, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4461641311645508, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02726913057267666, decouple_loss:0.0012230718275532126
loss_pred:0.025935227051377296, decouple_loss:0.00129051529802382
Iteration: 4762, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481123685836792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026818789541721344, decouple_loss:0.001224585808813572
The modified gen p mean: 0.44797661900520325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02769162692129612, decouple_loss:0.0011595607502385974
The modified gen p mean: 0.4489534795284271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026156967505812645, decouple_loss:0.0011042301775887609
Iteration: 4763, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499177634716034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02606329880654812, decouple_loss:0.0011322608916088939
The modified gen p mean: 0.4509032666683197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027522562071681023, decouple_loss:0.0014044406125321984
The modified gen p mean: 0.45053425431251526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027078300714492798, decouple_loss:0.0012248223647475243
Iteration: 4764, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44913214445114136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02699652872979641, decouple_loss:0.0012365722795948386
The modified gen p mean: 0.45194950699806213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02560882270336151, decouple_loss:0.0012975347926840186
The modified gen p mean: 0.44803738594055176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02860591560602188, decouple_loss:0.0012410070048645139
Iteration: 4765, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44855064153671265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026175498962402344, decouple_loss:0.0011556445388123393
The modified gen p mean: 0.4459133446216583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027760861441493034, decouple_loss:0.0011746295494958758
The modified gen p mean: 0.4475233852863312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026806386187672615, decouple_loss:0.0011500538093969226
Iteration: 4766, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472726583480835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028101256117224693, decouple_loss:0.0011946960585191846
The modified gen p mean: 0.45156073570251465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026826445013284683, decouple_loss:0.00122349476441741
The modified gen p mean: 0.4479985237121582, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02614249661564827, decouple_loss:0.0012172290589660406
Iteration: 4767, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44632688164711, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026604417711496353, decouple_loss:0.0013483318034559488The modified gen p mean: 0.4500797688961029, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026095708832144737, decouple_loss:0.0013020524056628346
The modified gen p mean: 0.44852137565612793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690161019563675, decouple_loss:0.0012053372338414192
Iteration: 4768, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485131800174713, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4449041783809662, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0252164788544178, decouple_loss:0.0012165977386757731
loss_pred:0.026480181142687798, decouple_loss:0.0012335107894614339
The modified gen p mean: 0.44923076033592224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026343580335378647, decouple_loss:0.0012083317851647735
Iteration: 4769, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44959431886672974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026659997180104256, decouple_loss:0.001204217434860766
The modified gen p mean: 0.4436275064945221, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027863306924700737, decouple_loss:0.0012608427787199616
The modified gen p mean: 0.44700348377227783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02503090538084507, decouple_loss:0.0012942138127982616
Iteration: 4770, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44829779863357544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026240147650241852, decouple_loss:0.0012674478348344564
The modified gen p mean: 0.4449910521507263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027331054210662842, decouple_loss:0.0011814554454758763
The modified gen p mean: 0.4486348032951355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026127824559807777, decouple_loss:0.001219008699990809
2023-05-27 14:25:52 testing...
The modified gen p mean: 0.45066434144973755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03301568701863289, decouple_loss:0.0014321405906230211
The modified gen p mean: 0.44865965843200684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03343505412340164, decouple_loss:0.0014932042686268687
The modified gen p mean: 0.4502609074115753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034810733050107956, decouple_loss:0.00140326505061239
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03382597118616104, avg_mse: 0.04640110582113266
current test mse: 0.046401
Iteration: 4771, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454733431339264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026495320722460747, decouple_loss:0.0012523019686341286
The modified gen p mean: 0.4456993341445923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028779812157154083, decouple_loss:0.001312363427132368
The modified gen p mean: 0.44793152809143066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025143375620245934, decouple_loss:0.0013462660135701299
Iteration: 4772, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45054298639297485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0261268001049757, decouple_loss:0.0012220994103699923
The modified gen p mean: 0.4462085962295532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02727600187063217, decouple_loss:0.0012166517553851008
The modified gen p mean: 0.4469543695449829, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02677217312157154, decouple_loss:0.0011421256931498647
Iteration: 4773, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45047634840011597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026147497817873955, decouple_loss:0.0011802365770563483
The modified gen p mean: 0.44676339626312256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026639947667717934, decouple_loss:0.0011157888220623136
The modified gen p mean: 0.45338866114616394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026518311351537704, decouple_loss:0.0011590039357542992
Iteration: 4774, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44954293966293335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025503724813461304, decouple_loss:0.001224266947247088
The modified gen p mean: 0.45167893171310425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025292426347732544, decouple_loss:0.001279299845919013
The modified gen p mean: 0.44809436798095703, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028134668245911598, decouple_loss:0.0012167481472715735
Iteration: 4775, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480445384979248, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026501620188355446, decouple_loss:0.0011860026279464364
The modified gen p mean: 0.4528505802154541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02711084485054016, decouple_loss:0.0013808626681566238
The modified gen p mean: 0.4515199661254883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025600682944059372, decouple_loss:0.0011460231617093086
Iteration: 4776, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500792622566223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026396816596388817, decouple_loss:0.0013122960226610303
The modified gen p mean: 0.44838014245033264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02570674754679203, decouple_loss:0.0010930481366813183
The modified gen p mean: 0.4504401981830597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02536212094128132, decouple_loss:0.0013155320193618536
Iteration: 4777, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467391073703766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0280452910810709, decouple_loss:0.0012263807002454996
The modified gen p mean: 0.44931527972221375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02615044265985489, decouple_loss:0.0011406155535951257
The modified gen p mean: 0.4481198191642761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028463659808039665, decouple_loss:0.0012144093634560704
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4778, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485611617565155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027626898139715195, decouple_loss:0.0012429830385372043
The modified gen p mean: 0.4483402669429779, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028934041038155556, decouple_loss:0.0012018444249406457
The modified gen p mean: 0.448207288980484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02841578982770443, decouple_loss:0.0011917618103325367
Iteration: 4779, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4520326256752014, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029077937826514244, decouple_loss:0.0013073340523988008
The modified gen p mean: 0.44831517338752747, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029034234583377838, decouple_loss:0.0011158748529851437
The modified gen p mean: 0.44681423902511597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028525715693831444, decouple_loss:0.0010929831769317389
Iteration: 4780, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481496512889862, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4511757791042328, gen p mean: 0.0, mean p set: 0.448loss_pred:0.027515262365341187, decouple_loss:0.0011884000850841403
loss_pred:0.027037259191274643, decouple_loss:0.0012960868189111352
The modified gen p mean: 0.44764477014541626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028246644884347916, decouple_loss:0.001200634054839611
2023-05-27 14:30:41 testing...
The modified gen p mean: 0.4537222385406494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032883692532777786, decouple_loss:0.0014650531811639667
The modified gen p mean: 0.45340079069137573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03467915207147598, decouple_loss:0.0014459544327110052
The modified gen p mean: 0.4516724646091461, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03326531872153282, decouple_loss:0.001546961604617536
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03368368744850159, avg_mse: 0.04612763598561287
current test mse: 0.046128
Iteration: 4781, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487014412879944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028071895241737366, decouple_loss:0.0011634259717538953
The modified gen p mean: 0.44764819741249084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029635172337293625, decouple_loss:0.0012216501636430621
The modified gen p mean: 0.452959805727005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028225773945450783, decouple_loss:0.0013480627676472068
Iteration: 4782, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504654109477997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02754521556198597, decouple_loss:0.0010970106814056635
The modified gen p mean: 0.4512919485569, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028208263218402863, decouple_loss:0.0012925483752042055
The modified gen p mean: 0.44882839918136597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02800874598324299, decouple_loss:0.0012397278333082795
Iteration: 4783, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45127615332603455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02798187918961048, decouple_loss:0.0014679982559755445
The modified gen p mean: 0.4503670930862427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027448279783129692, decouple_loss:0.0011435888009145856
The modified gen p mean: 0.4486400783061981, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02956598438322544, decouple_loss:0.0012773353373631835
Iteration: 4784, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45434483885765076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026755448430776596, decouple_loss:0.0011725494405254722
The modified gen p mean: 0.4480404257774353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02845553122460842, decouple_loss:0.0011619407450780272
The modified gen p mean: 0.4529823064804077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028393715620040894, decouple_loss:0.001169867697171867
Iteration: 4785, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491235911846161, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02803223580121994, decouple_loss:0.001205761102028191
The modified gen p mean: 0.4534151256084442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028792310506105423, decouple_loss:0.0012928523356094956
The modified gen p mean: 0.4499382972717285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02813294529914856, decouple_loss:0.0014291047118604183
Iteration: 4786, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480929970741272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0295105017721653, decouple_loss:0.001243405626155436
The modified gen p mean: 0.44622349739074707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028185321018099785, decouple_loss:0.0010880294721573591
The modified gen p mean: 0.4489258825778961, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02793961763381958, decouple_loss:0.0012444659369066358
Iteration: 4787, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480148255825043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02752717025578022, decouple_loss:0.001196487108245492
The modified gen p mean: 0.45100346207618713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028170449659228325, decouple_loss:0.0011818517232313752
The modified gen p mean: 0.4518887996673584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027665814384818077, decouple_loss:0.001266712206415832
Iteration: 4788, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446089267730713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028351571410894394, decouple_loss:0.0012108634691685438
The modified gen p mean: 0.44990551471710205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028255645185709, decouple_loss:0.0011306694941595197
The modified gen p mean: 0.4451512098312378, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028034038841724396, decouple_loss:0.0011640489101409912
Iteration: 4789, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489530324935913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02795400284230709, decouple_loss:0.0012043822789564729
The modified gen p mean: 0.4439549744129181, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027263935655355453, decouple_loss:0.0012331262696534395
The modified gen p mean: 0.447735071182251, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026837050914764404, decouple_loss:0.0011822168016806245
Iteration: 4790, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44867539405822754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02722208760678768, decouple_loss:0.001379932276904583
The modified gen p mean: 0.4454032778739929, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028023237362504005, decouple_loss:0.00117951026186347
The modified gen p mean: 0.44744938611984253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028139518573880196, decouple_loss:0.0012539620511233807
2023-05-27 14:34:48 testing...
The modified gen p mean: 0.4505075514316559, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032709814608097076, decouple_loss:0.0014126402093097568
The modified gen p mean: 0.4501439929008484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03469527140259743, decouple_loss:0.0014122504508122802
The modified gen p mean: 0.4486168324947357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03291713446378708, decouple_loss:0.0013653142377734184
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03351058065891266, avg_mse: 0.04578125849366188
current test mse: 0.045781
Iteration: 4791, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44344863295555115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02873903512954712, decouple_loss:0.0011391533771529794
The modified gen p mean: 0.44487258791923523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028594480827450752, decouple_loss:0.0012322721304371953
The modified gen p mean: 0.4505956768989563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027257926762104034, decouple_loss:0.001240873010829091
Iteration: 4792, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44830188155174255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027971714735031128, decouple_loss:0.0011345093371346593
The modified gen p mean: 0.4459991157054901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028695905581116676, decouple_loss:0.0012891676742583513
The modified gen p mean: 0.4447488784790039, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029271937906742096, decouple_loss:0.0011023989645764232
Iteration: 4793, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484175741672516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0281168632209301, decouple_loss:0.0011624753242358565
The modified gen p mean: 0.4467135965824127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02861197106540203, decouple_loss:0.0011312481947243214
The modified gen p mean: 0.4479188621044159, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028640275821089745, decouple_loss:0.0011859596706926823
Iteration: 4794, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44884446263313293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02846556156873703, decouple_loss:0.0011404977412894368
The modified gen p mean: 0.4510548412799835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027662698179483414, decouple_loss:0.0012717250501736999
The modified gen p mean: 0.45185795426368713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026836318895220757, decouple_loss:0.001149529591202736
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr.npz
NaN value num: 0
Iteration: 4795, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503841698169708, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4537435472011566, gen p mean: 0.0, mean p set: 0.448loss_pred:0.028107043355703354, decouple_loss:0.001319040427915752
loss_pred:0.02786090411245823, decouple_loss:0.0012635445455089211
The modified gen p mean: 0.4491161108016968, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029770027846097946, decouple_loss:0.0011937126982957125
Iteration: 4796, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516083598136902, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02765512280166149, decouple_loss:0.001267612329684198
The modified gen p mean: 0.4541410505771637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028843490406870842, decouple_loss:0.0013789704535156488
The modified gen p mean: 0.452251672744751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027350256219506264, decouple_loss:0.0013912504073232412
Iteration: 4797, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45273181796073914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028692001476883888, decouple_loss:0.0011314585572108626
The modified gen p mean: 0.4517602324485779, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02855464443564415, decouple_loss:0.001277668634429574
The modified gen p mean: 0.4529518783092499, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028927726671099663, decouple_loss:0.0011946024606004357
Iteration: 4798, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45208922028541565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02792358584702015, decouple_loss:0.0014065451687201858
The modified gen p mean: 0.44943881034851074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028115876019001007, decouple_loss:0.0012671769363805652
The modified gen p mean: 0.449461966753006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02828875556588173, decouple_loss:0.0013529658317565918
Iteration: 4799, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471745491027832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02782745659351349, decouple_loss:0.001177365193143487
The modified gen p mean: 0.4451088607311249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030597509816288948, decouple_loss:0.0011962356511503458
The modified gen p mean: 0.4471472203731537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029449349269270897, decouple_loss:0.0011677882866933942
Iteration: 4800, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482686221599579, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027387740090489388, decouple_loss:0.0013344198232516646
The modified gen p mean: 0.4498458802700043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02816619910299778, decouple_loss:0.0013352393871173263
The modified gen p mean: 0.4474925398826599, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02938256785273552, decouple_loss:0.0014891212340444326
2023-05-27 14:39:35 testing...
The modified gen p mean: 0.45291784405708313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03257843852043152, decouple_loss:0.0014447967987507582
The modified gen p mean: 0.45235204696655273, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45090171694755554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03460027649998665, decouple_loss:0.0013926307437941432
loss_pred:0.03274887427687645, decouple_loss:0.0013720104470849037
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03337935730814934, avg_mse: 0.04562320187687874
current test mse: 0.045623
Iteration: 4801, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503110349178314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027158992365002632, decouple_loss:0.0013522629160434008
The modified gen p mean: 0.44797536730766296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0278371162712574, decouple_loss:0.0011769557604566216
The modified gen p mean: 0.44817647337913513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027503764256834984, decouple_loss:0.0012460610596463084
Iteration: 4802, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492870271205902, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02979150414466858, decouple_loss:0.001143262255936861
The modified gen p mean: 0.45267394185066223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028142958879470825, decouple_loss:0.0012963343178853393
The modified gen p mean: 0.4493127763271332, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028760429471731186, decouple_loss:0.0013053345028311014
Iteration: 4803, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516565501689911, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02812187373638153, decouple_loss:0.0011271529365330935
The modified gen p mean: 0.45046818256378174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02877126634120941, decouple_loss:0.0011393324239179492
The modified gen p mean: 0.45562607049942017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028051307424902916, decouple_loss:0.0012107513612136245
Iteration: 4804, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45215681195259094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027872338891029358, decouple_loss:0.0010906403185799718
The modified gen p mean: 0.45371225476264954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028387945145368576, decouple_loss:0.0012781608384102583
The modified gen p mean: 0.4515872895717621, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027905883267521858, decouple_loss:0.0011829970171675086
Iteration: 4805, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500083327293396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02873809263110161, decouple_loss:0.00107007403858006
The modified gen p mean: 0.45103102922439575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028472431004047394, decouple_loss:0.001330839702859521
The modified gen p mean: 0.4501515328884125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0279910396784544, decouple_loss:0.0013394065899774432
Iteration: 4806, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44709041714668274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02859656885266304, decouple_loss:0.0013417506124824286
The modified gen p mean: 0.44973447918891907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02806614525616169, decouple_loss:0.0012945993803441525
The modified gen p mean: 0.44956672191619873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027112923562526703, decouple_loss:0.0013260833220556378
Iteration: 4807, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502827227115631, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027844060212373734, decouple_loss:0.0013092741137370467
The modified gen p mean: 0.4479333758354187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028044315055012703, decouple_loss:0.0012650592252612114
The modified gen p mean: 0.4470422863960266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029947251081466675, decouple_loss:0.0012067023199051619
Iteration: 4808, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44545939564704895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028960978612303734, decouple_loss:0.001201846287585795
The modified gen p mean: 0.4426622986793518, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028730718418955803, decouple_loss:0.0012703898828476667
The modified gen p mean: 0.4435099959373474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820122055709362, decouple_loss:0.001092408667318523
Iteration: 4809, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44505611062049866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02762436866760254, decouple_loss:0.0011959290131926537
The modified gen p mean: 0.44417309761047363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028392905369400978, decouple_loss:0.0012733283219859004
The modified gen p mean: 0.4438900053501129, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02864917553961277, decouple_loss:0.0011718053137883544
Iteration: 4810, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447875440120697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02704637311398983, decouple_loss:0.001291270600631833
The modified gen p mean: 0.44793879985809326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02749515511095524, decouple_loss:0.00118677516002208
The modified gen p mean: 0.45086249709129333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028019074350595474, decouple_loss:0.0012913566315546632
2023-05-27 14:43:41 testing...
The modified gen p mean: 0.453769326210022, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03236566111445427, decouple_loss:0.0014667025534436107
The modified gen p mean: 0.45174795389175415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03268542140722275, decouple_loss:0.0012774865608662367
The modified gen p mean: 0.4533158540725708, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03438683599233627, decouple_loss:0.0014799585333094
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03321637958288193, avg_mse: 0.04534786939620972
current test mse: 0.045348
Iteration: 4811, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44855648279190063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027565011754631996, decouple_loss:0.0012259760405868292
The modified gen p mean: 0.4490426480770111, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02765679359436035, decouple_loss:0.0013546431437134743
The modified gen p mean: 0.451979398727417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02806917019188404, decouple_loss:0.0014044626150280237
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr.npz
NaN value num: 0
Iteration: 4812, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481803774833679, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02698349952697754, decouple_loss:0.0012060296721756458
The modified gen p mean: 0.4507642686367035, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4521813988685608, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02568056806921959, decouple_loss:0.0012928046053275466
loss_pred:0.025530250743031502, decouple_loss:0.0012607176322489977
Iteration: 4813, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479456841945648, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026742927730083466, decouple_loss:0.0011975488159805536
The modified gen p mean: 0.44981640577316284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02638893947005272, decouple_loss:0.0012733524199575186
The modified gen p mean: 0.45049265027046204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026626771315932274, decouple_loss:0.0011875666677951813
Iteration: 4814, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45366370677948, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02606329321861267, decouple_loss:0.0012416428653523326
The modified gen p mean: 0.45074692368507385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02607688121497631, decouple_loss:0.0011413292959332466
The modified gen p mean: 0.45315998792648315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025351621210575104, decouple_loss:0.0013428600504994392
Iteration: 4815, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44573700428009033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02637857012450695, decouple_loss:0.0010728636989369988
The modified gen p mean: 0.44773364067077637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026894716545939445, decouple_loss:0.001234745723195374
The modified gen p mean: 0.4481084942817688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025775639340281487, decouple_loss:0.0010566693963482976
Iteration: 4816, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4440459907054901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025560764595866203, decouple_loss:0.0011333352886140347
The modified gen p mean: 0.4487304985523224, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024158937856554985, decouple_loss:0.0011671163374558091
The modified gen p mean: 0.4450814723968506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026444945484399796, decouple_loss:0.0011118878610432148
Iteration: 4817, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44356343150138855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025876017287373543, decouple_loss:0.0012504684273153543
The modified gen p mean: 0.44670164585113525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025294844061136246, decouple_loss:0.001298939692787826
The modified gen p mean: 0.44378647208213806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02605532296001911, decouple_loss:0.001368695986457169
Iteration: 4818, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4452196955680847, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44222989678382874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025644149631261826, decouple_loss:0.001319232047535479
loss_pred:0.026202894747257233, decouple_loss:0.001251851674169302
The modified gen p mean: 0.44682320952415466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02553369477391243, decouple_loss:0.0012091714888811111
Iteration: 4819, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44294473528862, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4437680244445801, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026432232931256294, decouple_loss:0.0013001495972275734
loss_pred:0.025685986503958702, decouple_loss:0.0012688330607488751
The modified gen p mean: 0.4414149224758148, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027245260775089264, decouple_loss:0.0012101023457944393
Iteration: 4820, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438473582267761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026863064616918564, decouple_loss:0.0012196716852486134
The modified gen p mean: 0.44330695271492004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026015304028987885, decouple_loss:0.0011261437321081758
The modified gen p mean: 0.4485926628112793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02545337937772274, decouple_loss:0.0013221058761700988
2023-05-27 14:48:26 testing...
The modified gen p mean: 0.45166799426078796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265516832470894, decouple_loss:0.0014556942041963339
The modified gen p mean: 0.4501432478427887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03284495696425438, decouple_loss:0.0013416967121884227
The modified gen p mean: 0.4514364004135132, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034501198679208755, decouple_loss:0.001449260744266212
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033404555171728134, avg_mse: 0.045750584453344345
current test mse: 0.045751
Iteration: 4821, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44866132736206055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02525966241955757, decouple_loss:0.0015083039179444313
The modified gen p mean: 0.45056790113449097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025296220555901527, decouple_loss:0.0012919089058414102
The modified gen p mean: 0.4476190507411957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025415310636162758, decouple_loss:0.0012595361331477761
Iteration: 4822, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498980641365051, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4505641460418701, gen p mean: 0.0, mean p set: 0.448loss_pred:0.025647420436143875, decouple_loss:0.001315714092925191
loss_pred:0.025213202461600304, decouple_loss:0.001205791370011866
The modified gen p mean: 0.4513922929763794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0248546339571476, decouple_loss:0.0011976780369877815
Iteration: 4823, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45412352681159973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0248587466776371, decouple_loss:0.0012003767769783735
The modified gen p mean: 0.4507928490638733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02666318602859974, decouple_loss:0.0011557815596461296
The modified gen p mean: 0.4537317156791687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024241186678409576, decouple_loss:0.001161006628535688
Iteration: 4824, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4544004797935486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026058288291096687, decouple_loss:0.0013649186585098505
The modified gen p mean: 0.4584031105041504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025255968794226646, decouple_loss:0.001160535728558898
The modified gen p mean: 0.4521262049674988, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025702938437461853, decouple_loss:0.001295500434935093
Iteration: 4825, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.454389750957489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02491173893213272, decouple_loss:0.0014362756628543139
The modified gen p mean: 0.4513700306415558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026366466656327248, decouple_loss:0.0010913349688053131
The modified gen p mean: 0.4553295969963074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02484685741364956, decouple_loss:0.001331325271166861
Iteration: 4826, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4528394937515259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025813184678554535, decouple_loss:0.0012372761266306043
The modified gen p mean: 0.4547838568687439, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024370845407247543, decouple_loss:0.001289195497520268
The modified gen p mean: 0.45142513513565063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027077889069914818, decouple_loss:0.0011851656017825007
Iteration: 4827, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44959557056427, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025595592334866524, decouple_loss:0.0012746816501021385
The modified gen p mean: 0.45341989398002625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024967201054096222, decouple_loss:0.0011945231817662716
The modified gen p mean: 0.4503893554210663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0252810288220644, decouple_loss:0.0012479042634367943
Iteration: 4828, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465445280075073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026176143437623978, decouple_loss:0.0011650312226265669
The modified gen p mean: 0.4478335380554199, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025616765022277832, decouple_loss:0.0014475032221525908
The modified gen p mean: 0.45144569873809814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024750841781497, decouple_loss:0.001201118342578411
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr.npz
NaN value num: 0
Iteration: 4829, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44758155941963196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026774873957037926, decouple_loss:0.0011846679262816906
The modified gen p mean: 0.4517475366592407, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44718044996261597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026019904762506485, decouple_loss:0.0011416568886488676
loss_pred:0.026477044448256493, decouple_loss:0.0012494709808379412
Iteration: 4830, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44617149233818054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026894288137555122, decouple_loss:0.0011397622292861342
The modified gen p mean: 0.44596976041793823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026869773864746094, decouple_loss:0.0011762004578486085
The modified gen p mean: 0.44435814023017883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026607636362314224, decouple_loss:0.0010907513787969947
2023-05-27 14:53:16 testing...
The modified gen p mean: 0.4488382935523987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253760561347008, decouple_loss:0.00152964040171355
The modified gen p mean: 0.4473230540752411, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032655566930770874, decouple_loss:0.0013158348156139255
The modified gen p mean: 0.4486532509326935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03432967886328697, decouple_loss:0.0015858975239098072
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033248141407966614, avg_mse: 0.045550212264060974
current test mse: 0.04555
Iteration: 4831, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434598386287689, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02768750675022602, decouple_loss:0.001275770366191864
The modified gen p mean: 0.4439280927181244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025680439546704292, decouple_loss:0.0011313611175864935
The modified gen p mean: 0.4427303075790405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02628708817064762, decouple_loss:0.001311259693466127
Iteration: 4832, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44389644265174866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024988770484924316, decouple_loss:0.0012286470737308264
The modified gen p mean: 0.4436592161655426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026164686307311058, decouple_loss:0.0011823944514617324
The modified gen p mean: 0.44617167115211487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025613704696297646, decouple_loss:0.0012748255394399166
Iteration: 4833, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487922191619873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610641159117222, decouple_loss:0.0011852524476125836
The modified gen p mean: 0.44420620799064636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02659040130674839, decouple_loss:0.001411236124113202
The modified gen p mean: 0.44475850462913513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026869701221585274, decouple_loss:0.0012778392992913723
Iteration: 4834, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45062553882598877, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025692522525787354, decouple_loss:0.0011908671585842967
The modified gen p mean: 0.4506082534790039, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025903258472681046, decouple_loss:0.0012400627601891756
The modified gen p mean: 0.4466249942779541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026894308626651764, decouple_loss:0.0012312784092500806
Iteration: 4835, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44787850975990295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026271546259522438, decouple_loss:0.0011465329444035888
The modified gen p mean: 0.4471731185913086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026417821645736694, decouple_loss:0.0011540894629433751
The modified gen p mean: 0.45044687390327454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02589493989944458, decouple_loss:0.0012678590137511492
Iteration: 4836, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4526447653770447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025387456640601158, decouple_loss:0.0011706440709531307
The modified gen p mean: 0.45282161235809326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025773975998163223, decouple_loss:0.0013092971639707685
The modified gen p mean: 0.453508198261261, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02559417113661766, decouple_loss:0.0012211810098960996
Iteration: 4837, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4537148177623749, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026381127536296844, decouple_loss:0.0010825166245922446
The modified gen p mean: 0.4551634192466736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02496173046529293, decouple_loss:0.0011036173673346639
The modified gen p mean: 0.45374780893325806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02533959224820137, decouple_loss:0.0011792308650910854
Iteration: 4838, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506562650203705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02803206816315651, decouple_loss:0.0012302922550588846
The modified gen p mean: 0.45482370257377625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0258488766849041, decouple_loss:0.0011814458994194865
The modified gen p mean: 0.4522830843925476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026040928438305855, decouple_loss:0.0011931994231417775
Iteration: 4839, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499565362930298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025691716000437737, decouple_loss:0.0011317945318296552
The modified gen p mean: 0.44964322447776794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026378361508250237, decouple_loss:0.0011425599223002791
The modified gen p mean: 0.4492281377315521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025581084191799164, decouple_loss:0.0011344014201313257
Iteration: 4840, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501778483390808, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025789542123675346, decouple_loss:0.001119687338359654
The modified gen p mean: 0.448496550321579, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02752537652850151, decouple_loss:0.001172912190668285
The modified gen p mean: 0.44874101877212524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02516227774322033, decouple_loss:0.001170419272966683
2023-05-27 14:57:23 testing...
The modified gen p mean: 0.45098447799682617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0327153317630291, decouple_loss:0.0013464197982102633
The modified gen p mean: 0.44935092329978943, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45078322291374207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283306211233139, decouple_loss:0.0013446937082335353
loss_pred:0.03447887301445007, decouple_loss:0.0013305373722687364
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03340945020318031, avg_mse: 0.04583160951733589
current test mse: 0.045832
Iteration: 4841, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456362724304199, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025088969618082047, decouple_loss:0.0011276680743321776
The modified gen p mean: 0.45143643021583557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025589996948838234, decouple_loss:0.001120159518904984
The modified gen p mean: 0.4467181861400604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027156373485922813, decouple_loss:0.001121331355534494
Iteration: 4842, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471687376499176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025584299117326736, decouple_loss:0.001062825322151184
The modified gen p mean: 0.4509781002998352, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026431472972035408, decouple_loss:0.001173054100945592
The modified gen p mean: 0.44447195529937744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02589571103453636, decouple_loss:0.0011665856000036001
Iteration: 4843, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457062780857086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026549771428108215, decouple_loss:0.001036189147271216
The modified gen p mean: 0.4444619417190552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025839339941740036, decouple_loss:0.0012459356803447008
The modified gen p mean: 0.44793495535850525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025348760187625885, decouple_loss:0.0011747670359909534
Iteration: 4844, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44860514998435974, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44994205236434937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024597255513072014, decouple_loss:0.0011556250974535942
loss_pred:0.02557528205215931, decouple_loss:0.0011822625529021025
The modified gen p mean: 0.44885751605033875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02561909705400467, decouple_loss:0.0011609341017901897
Iteration: 4845, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45155638456344604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026108630001544952, decouple_loss:0.0012900407891720533
The modified gen p mean: 0.45076730847358704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02577267773449421, decouple_loss:0.001175448764115572
The modified gen p mean: 0.45115989446640015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025655724108219147, decouple_loss:0.0011341997887939215
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr.npz
NaN value num: 0
Iteration: 4846, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512768089771271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02523050084710121, decouple_loss:0.0011509889736771584
The modified gen p mean: 0.449982225894928, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025809917598962784, decouple_loss:0.0011176648549735546
The modified gen p mean: 0.45216619968414307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02487201616168022, decouple_loss:0.0012756490614265203
Iteration: 4847, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512874484062195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024608416482806206, decouple_loss:0.0011788478586822748
The modified gen p mean: 0.45160263776779175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025089703500270844, decouple_loss:0.0012971332762390375
The modified gen p mean: 0.45175036787986755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026143770664930344, decouple_loss:0.0011493200436234474
Iteration: 4848, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44798702001571655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026489926502108574, decouple_loss:0.0011790608987212181
The modified gen p mean: 0.45518264174461365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024268118664622307, decouple_loss:0.0012119896709918976
The modified gen p mean: 0.45228832960128784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02624710649251938, decouple_loss:0.0011334950104355812
Iteration: 4849, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499496519565582, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025570543482899666, decouple_loss:0.0011787592666223645
The modified gen p mean: 0.4493665099143982, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026396261528134346, decouple_loss:0.0012174720177426934
The modified gen p mean: 0.44857552647590637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026006020605564117, decouple_loss:0.0014017053181305528
Iteration: 4850, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510236978530884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026357322931289673, decouple_loss:0.0012856778921559453
The modified gen p mean: 0.451121985912323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025024166330695152, decouple_loss:0.0012272597523406148
The modified gen p mean: 0.45099058747291565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024957766756415367, decouple_loss:0.001201922190375626
2023-05-27 15:02:08 testing...
The modified gen p mean: 0.4507812559604645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032752059400081635, decouple_loss:0.0013373924884945154
The modified gen p mean: 0.44911709427833557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032889995723962784, decouple_loss:0.001301787793636322
The modified gen p mean: 0.45042917132377625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03446212038397789, decouple_loss:0.0013975286856293678
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033435337245464325, avg_mse: 0.045828770846128464
current test mse: 0.045829
Iteration: 4851, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44779542088508606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02474238909780979, decouple_loss:0.0011254450073465705
The modified gen p mean: 0.44451743364334106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026228925213217735, decouple_loss:0.001165621681138873
The modified gen p mean: 0.4493529498577118, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025980517268180847, decouple_loss:0.0012614099541679025
Iteration: 4852, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4424758553504944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026958556845784187, decouple_loss:0.0011673535918816924
The modified gen p mean: 0.446805864572525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02554922178387642, decouple_loss:0.0011879875091835856
The modified gen p mean: 0.44356027245521545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02669399417936802, decouple_loss:0.0009972630068659782
Iteration: 4853, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44315046072006226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02437925711274147, decouple_loss:0.0012584292562678456
The modified gen p mean: 0.44292300939559937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610071189701557, decouple_loss:0.001250451779924333
The modified gen p mean: 0.44704291224479675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02483837865293026, decouple_loss:0.001292633474804461
Iteration: 4854, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4418240487575531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025828102603554726, decouple_loss:0.0012172313872724771
The modified gen p mean: 0.4456515610218048, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025381365790963173, decouple_loss:0.001176295685581863
The modified gen p mean: 0.44543248414993286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024980073794722557, decouple_loss:0.0011370782740414143
Iteration: 4855, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44235947728157043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024740898981690407, decouple_loss:0.001229468616656959
The modified gen p mean: 0.4452393352985382, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02576771192252636, decouple_loss:0.0012164239306002855
The modified gen p mean: 0.44276711344718933, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02638067863881588, decouple_loss:0.0011446792632341385
Iteration: 4856, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442811608314514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026406288146972656, decouple_loss:0.0010516251204535365
The modified gen p mean: 0.44710201025009155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02546709030866623, decouple_loss:0.0011394600151106715
The modified gen p mean: 0.4451518654823303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026203377172350883, decouple_loss:0.0011049264576286077
Iteration: 4857, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44428303837776184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026627905666828156, decouple_loss:0.0010727184126153588
The modified gen p mean: 0.44450756907463074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02677019126713276, decouple_loss:0.0011493260972201824
The modified gen p mean: 0.4460797905921936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024236269295215607, decouple_loss:0.0011045066639780998
Iteration: 4858, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44899195432662964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024144494906067848, decouple_loss:0.0012385370209813118
The modified gen p mean: 0.4467625916004181, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02377178892493248, decouple_loss:0.0010888987453654408
The modified gen p mean: 0.44653505086898804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026423383504152298, decouple_loss:0.0012202796060591936
Iteration: 4859, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45125076174736023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024470539763569832, decouple_loss:0.0012667959090322256
The modified gen p mean: 0.4496517479419708, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02446923404932022, decouple_loss:0.0011760792694985867
The modified gen p mean: 0.4485953748226166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026169272139668465, decouple_loss:0.0011496457736939192
Iteration: 4860, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44959190487861633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024715567007660866, decouple_loss:0.0011890666792169213
The modified gen p mean: 0.4478960633277893, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.023966295644640923, decouple_loss:0.001182335545308888
The modified gen p mean: 0.44534265995025635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026373835280537605, decouple_loss:0.001073087565600872
2023-05-27 15:06:15 testing...
The modified gen p mean: 0.45285308361053467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03265010565519333, decouple_loss:0.0013332271482795477
The modified gen p mean: 0.4523949921131134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03440989926457405, decouple_loss:0.0013936653267592192
The modified gen p mean: 0.4511725604534149, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03287534788250923, decouple_loss:0.0012749501038342714
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0333784818649292, avg_mse: 0.045727599412202835
current test mse: 0.045728
Iteration: 4861, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479047954082489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025622492656111717, decouple_loss:0.0011705225333571434
The modified gen p mean: 0.44846224784851074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02649526298046112, decouple_loss:0.0010620079701766372
The modified gen p mean: 0.4480384290218353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02548074536025524, decouple_loss:0.0011835381155833602
Iteration: 4862, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487675726413727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026233896613121033, decouple_loss:0.0011677846778184175
The modified gen p mean: 0.4478069245815277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026142776012420654, decouple_loss:0.0012153341667726636
The modified gen p mean: 0.4502224326133728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025985591113567352, decouple_loss:0.0013026779051870108
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr.npz
NaN value num: 0
Iteration: 4863, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501346945762634, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471261203289032, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026819318532943726, decouple_loss:0.0012917870189994574
The modified gen p mean: 0.45163416862487793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02846420370042324, decouple_loss:0.0012289198348298669
loss_pred:0.028885984793305397, decouple_loss:0.0012098978040739894
Iteration: 4864, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465445280075073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028351353481411934, decouple_loss:0.001137320650741458
The modified gen p mean: 0.4489288032054901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029134709388017654, decouple_loss:0.0010717512341216207
The modified gen p mean: 0.45147544145584106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029398441314697266, decouple_loss:0.0012088989606127143
Iteration: 4865, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474404454231262, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028348788619041443, decouple_loss:0.0011517800157889724
The modified gen p mean: 0.4513418674468994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02906719222664833, decouple_loss:0.0010424840729683638
The modified gen p mean: 0.448481023311615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02909054420888424, decouple_loss:0.0012224633246660233
Iteration: 4866, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45009922981262207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0268891379237175, decouple_loss:0.001318161841481924
The modified gen p mean: 0.4501974582672119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028226368129253387, decouple_loss:0.0012042905436828732
The modified gen p mean: 0.4504420757293701, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029786337167024612, decouple_loss:0.001161386026069522
Iteration: 4867, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45157507061958313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029469521716237068, decouple_loss:0.0011980942217633128
The modified gen p mean: 0.45141980051994324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02829001285135746, decouple_loss:0.00105712516233325
The modified gen p mean: 0.45107924938201904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029437126591801643, decouple_loss:0.0010720508871600032
Iteration: 4868, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4525521993637085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02766035497188568, decouple_loss:0.0012177835451439023
The modified gen p mean: 0.4540468752384186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028961554169654846, decouple_loss:0.0012388491304591298
The modified gen p mean: 0.4564098119735718, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026747001335024834, decouple_loss:0.0013143126852810383
Iteration: 4869, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4549461603164673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027099940925836563, decouple_loss:0.0013162973336875439
The modified gen p mean: 0.45214998722076416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028834953904151917, decouple_loss:0.0012416807003319263
The modified gen p mean: 0.45439016819000244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029306570068001747, decouple_loss:0.0011514152865856886
Iteration: 4870, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45070433616638184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027699828147888184, decouple_loss:0.0010944388341158628
The modified gen p mean: 0.4526505768299103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02778983674943447, decouple_loss:0.001047839061357081
The modified gen p mean: 0.4515098035335541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027174582704901695, decouple_loss:0.0011124820448458195
2023-05-27 15:11:04 testing...
The modified gen p mean: 0.4541552662849426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03242163732647896, decouple_loss:0.0014165955362841487
The modified gen p mean: 0.45240283012390137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03294984996318817, decouple_loss:0.0013626725412905216
The modified gen p mean: 0.45367690920829773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034301042556762695, decouple_loss:0.0015206615207716823
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03329584375023842, avg_mse: 0.045526742935180664
current test mse: 0.045527
Iteration: 4871, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45039665699005127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0281931534409523, decouple_loss:0.0011842175154015422
The modified gen p mean: 0.45097455382347107, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026982832700014114, decouple_loss:0.0013622831320390105
The modified gen p mean: 0.45101669430732727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02917054295539856, decouple_loss:0.0012073194375261664
Iteration: 4872, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508613646030426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029110012575984, decouple_loss:0.0012696626363322139
The modified gen p mean: 0.4483181834220886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02949448488652706, decouple_loss:0.001293514738790691
The modified gen p mean: 0.4487553834915161, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027047477662563324, decouple_loss:0.0013878648169338703
Iteration: 4873, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474506080150604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027152415364980698, decouple_loss:0.0011064817663282156
The modified gen p mean: 0.4485774636268616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02913866750895977, decouple_loss:0.0011558703845366836
The modified gen p mean: 0.44386768341064453, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028309203684329987, decouple_loss:0.0011539841070771217
Iteration: 4874, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471176266670227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027331583201885223, decouple_loss:0.0012074006954208016
The modified gen p mean: 0.44644996523857117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027764813974499702, decouple_loss:0.001412440207786858
The modified gen p mean: 0.44798725843429565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02745729312300682, decouple_loss:0.0012068509822711349
Iteration: 4875, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44675180315971375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02836492285132408, decouple_loss:0.0012621252099052072
The modified gen p mean: 0.44519689679145813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028148172423243523, decouple_loss:0.001304136123508215
The modified gen p mean: 0.4456111788749695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026720959693193436, decouple_loss:0.0013455114094540477
Iteration: 4876, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491885006427765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027577687054872513, decouple_loss:0.0012363273417577147
The modified gen p mean: 0.44500258564949036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028343355283141136, decouple_loss:0.001253591850399971
The modified gen p mean: 0.44446849822998047, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02964603900909424, decouple_loss:0.0012113534612581134
Iteration: 4877, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454224109649658, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028669437393546104, decouple_loss:0.0011981814168393612
The modified gen p mean: 0.44876837730407715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027639240026474, decouple_loss:0.0012289849109947681
The modified gen p mean: 0.44987133145332336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027438441291451454, decouple_loss:0.0011481489054858685
Iteration: 4878, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501233696937561, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02726447395980358, decouple_loss:0.0012931308010593057
The modified gen p mean: 0.4498223662376404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028123071417212486, decouple_loss:0.0011573209194466472
The modified gen p mean: 0.45422038435935974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028074730187654495, decouple_loss:0.001211076625622809
Iteration: 4879, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45538339018821716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0277591310441494, decouple_loss:0.0012269499711692333
The modified gen p mean: 0.4540013074874878, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027483027428388596, decouple_loss:0.0014397010672837496
The modified gen p mean: 0.45750918984413147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028067227452993393, decouple_loss:0.0013064537197351456
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4880, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488241672515869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028460513800382614, decouple_loss:0.0012913645477965474
The modified gen p mean: 0.45022475719451904, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44896990060806274, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028195450082421303, decouple_loss:0.0012894232058897614
loss_pred:0.028022684156894684, decouple_loss:0.0013350124936550856
2023-05-27 15:15:49 testing...
The modified gen p mean: 0.4560738503932953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03241635113954544, decouple_loss:0.0013708050828427076
The modified gen p mean: 0.45437684655189514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03302856534719467, decouple_loss:0.001375950057990849
The modified gen p mean: 0.4555915594100952, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03441088646650314, decouple_loss:0.0014149014605209231
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033354632556438446, avg_mse: 0.04563076049089432
current test mse: 0.045631
Iteration: 4881, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450554221868515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02837800234556198, decouple_loss:0.0011006112908944488
The modified gen p mean: 0.4512409269809723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026836520060896873, decouple_loss:0.001377166947349906
The modified gen p mean: 0.4536764323711395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02664594165980816, decouple_loss:0.0011306648375466466
Iteration: 4882, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449441134929657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027016958221793175, decouple_loss:0.0011599721619859338
The modified gen p mean: 0.44751524925231934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02693578228354454, decouple_loss:0.0012112658005207777
The modified gen p mean: 0.44922956824302673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02504817396402359, decouple_loss:0.001381727633997798
Iteration: 4883, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44652503728866577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027706801891326904, decouple_loss:0.0012515755370259285
The modified gen p mean: 0.44681572914123535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026721080765128136, decouple_loss:0.0012784266145899892
The modified gen p mean: 0.4484056830406189, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026133442297577858, decouple_loss:0.0013601294485852122
Iteration: 4884, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443889558315277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027249202132225037, decouple_loss:0.0012900889851152897
The modified gen p mean: 0.44642913341522217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025772899389266968, decouple_loss:0.0013064936501905322
The modified gen p mean: 0.44391223788261414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025473304092884064, decouple_loss:0.001305030775256455
Iteration: 4885, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4415990710258484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027226842939853668, decouple_loss:0.0013228459283709526
The modified gen p mean: 0.4425584077835083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02491236850619316, decouple_loss:0.001309667364694178
The modified gen p mean: 0.4423236846923828, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027148788794875145, decouple_loss:0.0012162387138232589
Iteration: 4886, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44169050455093384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02734494023025036, decouple_loss:0.0012806642334908247
The modified gen p mean: 0.4444475769996643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026660675182938576, decouple_loss:0.001310034771449864
The modified gen p mean: 0.44448453187942505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02626926079392433, decouple_loss:0.0012447002809494734
Iteration: 4887, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4419879913330078, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026513375341892242, decouple_loss:0.0011811787262558937
The modified gen p mean: 0.44107767939567566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026843365281820297, decouple_loss:0.001222513266839087
The modified gen p mean: 0.4463559091091156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02526046149432659, decouple_loss:0.0012854889500886202
Iteration: 4888, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449838399887085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025546420365571976, decouple_loss:0.0011680872412398458
The modified gen p mean: 0.44319948554039, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02566189505159855, decouple_loss:0.0012591308914124966
The modified gen p mean: 0.443576842546463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026719218119978905, decouple_loss:0.0012442448642104864
Iteration: 4889, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4424181878566742, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027555719017982483, decouple_loss:0.0011231465032324195
The modified gen p mean: 0.44444674253463745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027366770431399345, decouple_loss:0.001199889462441206
The modified gen p mean: 0.4448401629924774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027518518269062042, decouple_loss:0.0013091189321130514
Iteration: 4890, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493015706539154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02586236223578453, decouple_loss:0.00131085398606956
The modified gen p mean: 0.44575777649879456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027041545137763023, decouple_loss:0.0013785531045868993
The modified gen p mean: 0.4451819956302643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027025435119867325, decouple_loss:0.0012129731476306915
2023-05-27 15:19:55 testing...
The modified gen p mean: 0.4530363976955414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0327170267701149, decouple_loss:0.0014527452876791358
The modified gen p mean: 0.4514758884906769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033057983964681625, decouple_loss:0.0015314705669879913
The modified gen p mean: 0.4524391293525696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03437532112002373, decouple_loss:0.0015000634593889117
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03345818445086479, avg_mse: 0.04581594094634056
current test mse: 0.045816
Iteration: 4891, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4449407756328583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027436459437012672, decouple_loss:0.001287328079342842
The modified gen p mean: 0.44706329703330994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02691769041121006, decouple_loss:0.0012272472959011793
The modified gen p mean: 0.4469895362854004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025644127279520035, decouple_loss:0.0012998593738302588
Iteration: 4892, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45002028346061707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02695181407034397, decouple_loss:0.0014606222975999117
The modified gen p mean: 0.44489625096321106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027088642120361328, decouple_loss:0.0012777268420904875
The modified gen p mean: 0.4509832561016083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025100771337747574, decouple_loss:0.0012145204236730933
Iteration: 4893, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44633930921554565, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44870156049728394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690068632364273, decouple_loss:0.0012258111964911222
loss_pred:0.025728322565555573, decouple_loss:0.0011831555748358369
The modified gen p mean: 0.45008915662765503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024960612878203392, decouple_loss:0.0013019845355302095
Iteration: 4894, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484003484249115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024171587079763412, decouple_loss:0.0014767465181648731
The modified gen p mean: 0.44828951358795166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02556341327726841, decouple_loss:0.0012815098743885756
The modified gen p mean: 0.4479854106903076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025333216413855553, decouple_loss:0.0013760245637968183
Iteration: 4895, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44517964124679565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027949530631303787, decouple_loss:0.001372824190184474
The modified gen p mean: 0.4441121518611908, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026682747527956963, decouple_loss:0.0013108778512105346
The modified gen p mean: 0.4499230980873108, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026300715282559395, decouple_loss:0.0012885648757219315
Iteration: 4896, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4473348557949066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025058332830667496, decouple_loss:0.0013274222146719694
The modified gen p mean: 0.4481409192085266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026482777670025826, decouple_loss:0.0011947709135711193
The modified gen p mean: 0.44577836990356445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027143092826008797, decouple_loss:0.0013968385756015778
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr_shift3.npz
NaN value num: 0
Iteration: 4897, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44591379165649414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026598839089274406, decouple_loss:0.0011512227356433868
The modified gen p mean: 0.4473492503166199, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4480617940425873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026211846619844437, decouple_loss:0.0013724694726988673
loss_pred:0.025619909167289734, decouple_loss:0.0013610365567728877
Iteration: 4898, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453657865524292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025618156418204308, decouple_loss:0.0014454618794843554
The modified gen p mean: 0.44608017802238464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0265754833817482, decouple_loss:0.0012657990446314216
The modified gen p mean: 0.44787800312042236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025478074327111244, decouple_loss:0.0016233543865382671
Iteration: 4899, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448779433965683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02580444887280464, decouple_loss:0.0012912199599668384
The modified gen p mean: 0.4494522511959076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025870434939861298, decouple_loss:0.0011442422401160002
The modified gen p mean: 0.4504978060722351, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02505495399236679, decouple_loss:0.0011962918797507882
Iteration: 4900, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44792604446411133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026685141026973724, decouple_loss:0.0013322628801688552
The modified gen p mean: 0.4464680850505829, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026522070169448853, decouple_loss:0.0012784393038600683
The modified gen p mean: 0.4518848657608032, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025667322799563408, decouple_loss:0.0012953440891578794
2023-05-27 15:24:44 testing...
The modified gen p mean: 0.4531313180923462, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4515777826309204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03272764012217522, decouple_loss:0.001513115013949573
loss_pred:0.032981161028146744, decouple_loss:0.0013977355556562543
The modified gen p mean: 0.4525257349014282, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03452502191066742, decouple_loss:0.001554297050461173
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03348569571971893, avg_mse: 0.045936405658721924
current test mse: 0.045936
Iteration: 4901, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44696497917175293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026983505114912987, decouple_loss:0.0012066360795870423
The modified gen p mean: 0.4482937455177307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025719206780195236, decouple_loss:0.0012947490904480219
The modified gen p mean: 0.44490858912467957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026800895109772682, decouple_loss:0.0012611154234036803
Iteration: 4902, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45068496465682983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024483632296323776, decouple_loss:0.0012197933392599225
The modified gen p mean: 0.4473993182182312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026867585256695747, decouple_loss:0.001151316100731492
The modified gen p mean: 0.44812920689582825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026925623416900635, decouple_loss:0.0012000113492831588
Iteration: 4903, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44975391030311584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025728123262524605, decouple_loss:0.0011993556981906295
The modified gen p mean: 0.4508291780948639, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02503872476518154, decouple_loss:0.0012632659636437893
The modified gen p mean: 0.4524828791618347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024057088419795036, decouple_loss:0.0011850589653477073
Iteration: 4904, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4521816670894623, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025135979056358337, decouple_loss:0.0012959986925125122
The modified gen p mean: 0.44923946261405945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02597525157034397, decouple_loss:0.0015377976233139634
The modified gen p mean: 0.4482702910900116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02578161284327507, decouple_loss:0.0012025294126942754
Iteration: 4905, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45206311345100403, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4528519809246063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025411926209926605, decouple_loss:0.0011897966032847762
loss_pred:0.025511322543025017, decouple_loss:0.0011429344303905964
The modified gen p mean: 0.45058444142341614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025240018963813782, decouple_loss:0.0012171671260148287
Iteration: 4906, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44934090971946716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02597220242023468, decouple_loss:0.001115501276217401
The modified gen p mean: 0.4514588415622711, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025675084441900253, decouple_loss:0.0011928528547286987
The modified gen p mean: 0.4452266991138458, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02750200591981411, decouple_loss:0.0011354571906849742
Iteration: 4907, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44889429211616516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026000404730439186, decouple_loss:0.001276003778912127
The modified gen p mean: 0.4459519684314728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02625892125070095, decouple_loss:0.0012395931407809258
The modified gen p mean: 0.4467809796333313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02611718140542507, decouple_loss:0.0012789939064532518
Iteration: 4908, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446693480014801, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44972240924835205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027161328122019768, decouple_loss:0.0012771724723279476
loss_pred:0.025663211941719055, decouple_loss:0.001335897482931614
The modified gen p mean: 0.44479358196258545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027528639882802963, decouple_loss:0.001115485210902989
Iteration: 4909, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45002853870391846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024821698665618896, decouple_loss:0.0013707252219319344
The modified gen p mean: 0.44986769556999207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02553512528538704, decouple_loss:0.001436821068637073
The modified gen p mean: 0.44803908467292786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025945985689759254, decouple_loss:0.0012342717964202166
Iteration: 4910, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45057883858680725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025357568636536598, decouple_loss:0.0015318304067477584
The modified gen p mean: 0.4485887289047241, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026781726628541946, decouple_loss:0.0012374466750770807
The modified gen p mean: 0.44924670457839966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025944141671061516, decouple_loss:0.0012766793370246887
2023-05-27 15:28:49 testing...
The modified gen p mean: 0.4533361494541168, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03343352675437927, decouple_loss:0.0014544000150635839
The modified gen p mean: 0.45314669609069824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03520676866173744, decouple_loss:0.001498784520663321
The modified gen p mean: 0.45182931423187256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03356843441724777, decouple_loss:0.0013243801658973098
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03414086997509003, avg_mse: 0.04705963283777237
current test mse: 0.04706
Iteration: 4911, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509820342063904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024663761258125305, decouple_loss:0.0012070880038663745
The modified gen p mean: 0.4467962086200714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026087937876582146, decouple_loss:0.0012043619062751532
The modified gen p mean: 0.44817766547203064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025464439764618874, decouple_loss:0.0011947655584663153
Iteration: 4912, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516526162624359, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02523588389158249, decouple_loss:0.00128280243370682
The modified gen p mean: 0.4488244354724884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026367278769612312, decouple_loss:0.001228855922818184
The modified gen p mean: 0.4522661566734314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025214022025465965, decouple_loss:0.0013632187619805336
Iteration: 4913, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44831445813179016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025584135204553604, decouple_loss:0.0013856606092303991
The modified gen p mean: 0.4491410553455353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026106657460331917, decouple_loss:0.0012751906178891659
The modified gen p mean: 0.4474865794181824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026223184540867805, decouple_loss:0.0012622667709365487
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr.npz
NaN value num: 0
Iteration: 4914, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44730404019355774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027825891971588135, decouple_loss:0.001430904376320541
The modified gen p mean: 0.44609370827674866, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44846245646476746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024531707167625427, decouple_loss:0.0013662762939929962
loss_pred:0.02690776437520981, decouple_loss:0.0013805911876261234
Iteration: 4915, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44907525181770325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02572971023619175, decouple_loss:0.0013676147209480405
The modified gen p mean: 0.44746825098991394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02516975998878479, decouple_loss:0.0012080157175660133
The modified gen p mean: 0.44633322954177856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026855070143938065, decouple_loss:0.0013265105662867427
Iteration: 4916, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468693137168884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0240612905472517, decouple_loss:0.001204573200084269
The modified gen p mean: 0.4420584440231323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027714576572179794, decouple_loss:0.0013613258488476276
The modified gen p mean: 0.44592177867889404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026345612481236458, decouple_loss:0.0013487739488482475
Iteration: 4917, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.443146675825119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026441367343068123, decouple_loss:0.001182570238597691
The modified gen p mean: 0.4448533058166504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025036528706550598, decouple_loss:0.0013496082974597812
The modified gen p mean: 0.4470050036907196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02586325630545616, decouple_loss:0.001214893301948905
Iteration: 4918, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4430614411830902, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026221206411719322, decouple_loss:0.0012801435077562928
The modified gen p mean: 0.4453568160533905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025106200948357582, decouple_loss:0.0012481994926929474
The modified gen p mean: 0.44597649574279785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025372859090566635, decouple_loss:0.0014202219899743795
Iteration: 4919, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447729289531708, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026268208399415016, decouple_loss:0.001253716996870935
The modified gen p mean: 0.44456395506858826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025290466845035553, decouple_loss:0.001360990689136088
The modified gen p mean: 0.44697755575180054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02568996697664261, decouple_loss:0.0012768126325681806
Iteration: 4920, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44624871015548706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026196017861366272, decouple_loss:0.0013249792391434312
The modified gen p mean: 0.4468190670013428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026157021522521973, decouple_loss:0.0012632693396881223
The modified gen p mean: 0.44728121161460876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02688600681722164, decouple_loss:0.0011946518206968904
2023-05-27 15:33:42 testing...
The modified gen p mean: 0.45353245735168457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261392191052437, decouple_loss:0.0014870990999042988
The modified gen p mean: 0.45213449001312256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0329042449593544, decouple_loss:0.0014016920467838645
The modified gen p mean: 0.45328980684280396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03434624895453453, decouple_loss:0.0015227030962705612
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03336166590452194, avg_mse: 0.04558945447206497
current test mse: 0.045589
Iteration: 4921, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44580256938934326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027322489768266678, decouple_loss:0.0011040448443964124
The modified gen p mean: 0.44960808753967285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02623024210333824, decouple_loss:0.001456830999813974
The modified gen p mean: 0.4479859471321106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026174386963248253, decouple_loss:0.0011087286984547973
Iteration: 4922, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475862979888916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026790039613842964, decouple_loss:0.0011772738071158528
The modified gen p mean: 0.447288453578949, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02729213424026966, decouple_loss:0.001182104111649096
The modified gen p mean: 0.4475976526737213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026713939383625984, decouple_loss:0.001193250180222094
Iteration: 4923, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459618926048279, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026588600128889084, decouple_loss:0.0012643035734072328
The modified gen p mean: 0.4448980689048767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026586806401610374, decouple_loss:0.0011578218545764685
The modified gen p mean: 0.4452914297580719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026154663413763046, decouple_loss:0.00122705043759197
Iteration: 4924, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44774624705314636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02474335953593254, decouple_loss:0.0012866983888670802
The modified gen p mean: 0.44926637411117554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02557414397597313, decouple_loss:0.0013452983694151044
The modified gen p mean: 0.44730210304260254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024464279413223267, decouple_loss:0.0014549557818099856
Iteration: 4925, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44721657037734985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02536845952272415, decouple_loss:0.0012367414310574532
The modified gen p mean: 0.44905951619148254, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024385498836636543, decouple_loss:0.0012413552030920982
The modified gen p mean: 0.4458353519439697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024116316810250282, decouple_loss:0.0012683667009696364
Iteration: 4926, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4429648518562317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02592843398451805, decouple_loss:0.0013143025571480393
The modified gen p mean: 0.44299134612083435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026615407317876816, decouple_loss:0.0012431975919753313
The modified gen p mean: 0.4443238079547882, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02559620514512062, decouple_loss:0.0012348125455901027
Iteration: 4927, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44376489520072937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027251310646533966, decouple_loss:0.0011657039867714047
The modified gen p mean: 0.44679105281829834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024431876838207245, decouple_loss:0.0011293733259662986
The modified gen p mean: 0.442339152097702, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026710668578743935, decouple_loss:0.0010680760024115443
Iteration: 4928, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446447789669037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026643212884664536, decouple_loss:0.0013020718470215797
The modified gen p mean: 0.44399550557136536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02458215318620205, decouple_loss:0.0011956932721659541
The modified gen p mean: 0.4442620873451233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026271061971783638, decouple_loss:0.0011074444046244025
Iteration: 4929, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457755982875824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026516616344451904, decouple_loss:0.001156942336820066
The modified gen p mean: 0.4469604194164276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025872016325592995, decouple_loss:0.001179216313175857
The modified gen p mean: 0.4491269588470459, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025581372901797295, decouple_loss:0.0012457430129870772
Iteration: 4930, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463406503200531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025019975379109383, decouple_loss:0.001156131736934185
The modified gen p mean: 0.449500173330307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024747055023908615, decouple_loss:0.0011372736189514399
The modified gen p mean: 0.44838032126426697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024789385497570038, decouple_loss:0.001171426149085164
2023-05-27 15:37:49 testing...
The modified gen p mean: 0.4528687000274658, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03269697725772858, decouple_loss:0.0013598863733932376
The modified gen p mean: 0.4511904716491699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283587470650673, decouple_loss:0.001335084205493331
The modified gen p mean: 0.45267167687416077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03426579758524895, decouple_loss:0.0013507182011380792
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03333364427089691, avg_mse: 0.04569067806005478
current test mse: 0.045691
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr.npz
NaN value num: 0
Iteration: 4931, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495772123336792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028464319184422493, decouple_loss:0.0010888882679864764
The modified gen p mean: 0.4463256299495697, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44895660877227783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028903167694807053, decouple_loss:0.001247938023880124
loss_pred:0.0277569442987442, decouple_loss:0.0012425363529473543
Iteration: 4932, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509751796722412, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029419993981719017, decouple_loss:0.0012155771255493164
The modified gen p mean: 0.44946518540382385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028266435489058495, decouple_loss:0.0012918994762003422
The modified gen p mean: 0.45236095786094666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028009194880723953, decouple_loss:0.0012904597679153085
Iteration: 4933, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45043230056762695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027528494596481323, decouple_loss:0.0011749598197638988
The modified gen p mean: 0.452498197555542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02696949802339077, decouple_loss:0.001245749182999134
The modified gen p mean: 0.4491785764694214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02924974635243416, decouple_loss:0.0012396982638165355
Iteration: 4934, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4552234709262848, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02683515101671219, decouple_loss:0.0011688811937347054
The modified gen p mean: 0.45130056142807007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027959058061242104, decouple_loss:0.0012625091476365924
The modified gen p mean: 0.45328056812286377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027511820197105408, decouple_loss:0.0013562932144850492
Iteration: 4935, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4564213156700134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028234083205461502, decouple_loss:0.0013309878995642066
The modified gen p mean: 0.45260217785835266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028839891776442528, decouple_loss:0.0012398818507790565
The modified gen p mean: 0.453705757856369, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026654578745365143, decouple_loss:0.001146507216617465
Iteration: 4936, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4527311325073242, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027279725298285484, decouple_loss:0.001206656452268362
The modified gen p mean: 0.45118391513824463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027633186429739, decouple_loss:0.0012820411939173937
The modified gen p mean: 0.45172157883644104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027307575568556786, decouple_loss:0.0012658077757805586
Iteration: 4937, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512034058570862, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027819229289889336, decouple_loss:0.0012609597761183977
The modified gen p mean: 0.44946056604385376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02937268279492855, decouple_loss:0.0012115581193938851
The modified gen p mean: 0.4543885886669159, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02676149271428585, decouple_loss:0.0012759218225255609
Iteration: 4938, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467625319957733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028683308511972427, decouple_loss:0.0011900969548150897
The modified gen p mean: 0.4480861723423004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028412090614438057, decouple_loss:0.0011492359917610884
The modified gen p mean: 0.44804298877716064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027934156358242035, decouple_loss:0.001327922334894538
Iteration: 4939, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44617199897766113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028690248727798462, decouple_loss:0.0012158133322373033
The modified gen p mean: 0.4507318437099457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820049226284027, decouple_loss:0.001292314031161368
The modified gen p mean: 0.44852861762046814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027882004156708717, decouple_loss:0.00128695007879287
Iteration: 4940, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4437136650085449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028045017272233963, decouple_loss:0.0012092078104615211
The modified gen p mean: 0.4443991780281067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028094245120882988, decouple_loss:0.001186078181490302
The modified gen p mean: 0.4453791677951813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0268239863216877, decouple_loss:0.001337422407232225
2023-05-27 15:42:49 testing...
The modified gen p mean: 0.4487428069114685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03246445208787918, decouple_loss:0.001519848476164043
The modified gen p mean: 0.44672298431396484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03292982280254364, decouple_loss:0.00147568981628865
The modified gen p mean: 0.44834041595458984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03411620110273361, decouple_loss:0.0015404142905026674
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0332457572221756, avg_mse: 0.0453658364713192
current test mse: 0.045366
Iteration: 4941, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44380638003349304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027984626591205597, decouple_loss:0.0014381890650838614
The modified gen p mean: 0.4473780393600464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02688358724117279, decouple_loss:0.001394273480400443
The modified gen p mean: 0.44256436824798584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027888188138604164, decouple_loss:0.0013072742149233818
Iteration: 4942, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464147686958313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026570528745651245, decouple_loss:0.0012187283718958497
The modified gen p mean: 0.44482433795928955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027316203340888023, decouple_loss:0.0012838152470067143
The modified gen p mean: 0.44240638613700867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02846100740134716, decouple_loss:0.0011466456344351172
Iteration: 4943, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457527995109558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027025539427995682, decouple_loss:0.0012628256808966398
The modified gen p mean: 0.4485996961593628, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02721952274441719, decouple_loss:0.0012912764213979244
The modified gen p mean: 0.4455034136772156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02817729115486145, decouple_loss:0.0012912576785311103
Iteration: 4944, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466315805912018, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026733562350273132, decouple_loss:0.0012879829155281186
The modified gen p mean: 0.44514554738998413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027012083679437637, decouple_loss:0.0012274716282263398
The modified gen p mean: 0.44347459077835083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02920251525938511, decouple_loss:0.0014605987817049026
Iteration: 4945, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44484177231788635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028203506022691727, decouple_loss:0.001170334406197071
The modified gen p mean: 0.44474029541015625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02862260490655899, decouple_loss:0.0013049518456682563
The modified gen p mean: 0.44655996561050415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026881074532866478, decouple_loss:0.0012370266485959291
Iteration: 4946, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44581907987594604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02806192822754383, decouple_loss:0.0013198968954384327
The modified gen p mean: 0.4478113055229187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02714836597442627, decouple_loss:0.0012159281177446246
The modified gen p mean: 0.4445446729660034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026766765862703323, decouple_loss:0.0011999080888926983
Iteration: 4947, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475697875022888, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02793857827782631, decouple_loss:0.0012732099276036024
The modified gen p mean: 0.4482799768447876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028285343199968338, decouple_loss:0.001254006288945675
The modified gen p mean: 0.4472109079360962, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02847202494740486, decouple_loss:0.0012275296030566096
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr.npz
NaN value num: 0
Iteration: 4948, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4490877091884613, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028662851080298424, decouple_loss:0.001238479046151042
The modified gen p mean: 0.45163634419441223, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44916975498199463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028992492705583572, decouple_loss:0.0011813309974968433
loss_pred:0.027550362050533295, decouple_loss:0.0012358755338937044
Iteration: 4949, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4540831744670868, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027295999228954315, decouple_loss:0.0014130845665931702
The modified gen p mean: 0.45511293411254883, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02801884338259697, decouple_loss:0.0012038317508995533
The modified gen p mean: 0.4546554684638977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02885068580508232, decouple_loss:0.0012157727032899857
Iteration: 4950, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514143764972687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0286627858877182, decouple_loss:0.0012965549249202013
The modified gen p mean: 0.45331135392189026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02792222611606121, decouple_loss:0.001151330885477364
The modified gen p mean: 0.45286720991134644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028538305312395096, decouple_loss:0.0012513475958257914
2023-05-27 15:47:42 testing...
The modified gen p mean: 0.45658499002456665, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03257283195853233, decouple_loss:0.0014539393596351147
The modified gen p mean: 0.4545614719390869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03276770934462547, decouple_loss:0.0014059549430385232
The modified gen p mean: 0.4559515714645386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03420058637857437, decouple_loss:0.0014444898115471005
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03325211629271507, avg_mse: 0.04538450390100479
current test mse: 0.045385
Iteration: 4951, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534059166908264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027739180251955986, decouple_loss:0.0011367235565558076
The modified gen p mean: 0.4551164209842682, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027387095615267754, decouple_loss:0.0012989648384973407
The modified gen p mean: 0.45068690180778503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029188470914959908, decouple_loss:0.001249218243174255
Iteration: 4952, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.452980637550354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027155812829732895, decouple_loss:0.001413644291460514
The modified gen p mean: 0.45181140303611755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02666701190173626, decouple_loss:0.001241273246705532
The modified gen p mean: 0.4519990086555481, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028538955375552177, decouple_loss:0.0011415800545364618
Iteration: 4953, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4514901041984558, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029102010652422905, decouple_loss:0.0012543612392619252
The modified gen p mean: 0.45316916704177856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027583321556448936, decouple_loss:0.0012705271365121007
The modified gen p mean: 0.44920992851257324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029909802600741386, decouple_loss:0.001246762927621603
Iteration: 4954, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45140540599823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027558758854866028, decouple_loss:0.0011386036640033126
The modified gen p mean: 0.4504307508468628, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02875690720975399, decouple_loss:0.0011488961754366755
The modified gen p mean: 0.4502323865890503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026336481794714928, decouple_loss:0.0012067323550581932
Iteration: 4955, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483869969844818, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028237655758857727, decouple_loss:0.001178987673483789
The modified gen p mean: 0.4497426450252533, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028458483517169952, decouple_loss:0.0011506363516673446
The modified gen p mean: 0.4493441879749298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028315996751189232, decouple_loss:0.001273972331546247
Iteration: 4956, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45003095269203186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027868689969182014, decouple_loss:0.001255849259905517
The modified gen p mean: 0.4467225670814514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029721641913056374, decouple_loss:0.0011065233265981078
The modified gen p mean: 0.4491952955722809, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02741227112710476, decouple_loss:0.0012975172139704227
Iteration: 4957, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474891126155853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027507582679390907, decouple_loss:0.0011382617522031069
The modified gen p mean: 0.4483301043510437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026772189885377884, decouple_loss:0.0011840860825031996
The modified gen p mean: 0.44452521204948425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027727872133255005, decouple_loss:0.0010482536163181067
Iteration: 4958, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456545412540436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02972601167857647, decouple_loss:0.0012013994855806231
The modified gen p mean: 0.4449421167373657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028003565967082977, decouple_loss:0.0011260303435847163
The modified gen p mean: 0.4496537446975708, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02765420451760292, decouple_loss:0.0013082672376185656
Iteration: 4959, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44485631585121155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02889484539628029, decouple_loss:0.0010463952785357833
The modified gen p mean: 0.44608527421951294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02899511717259884, decouple_loss:0.0011813673190772533
The modified gen p mean: 0.4462936222553253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027027038857340813, decouple_loss:0.0012897528940811753
Iteration: 4960, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44753310084342957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027859631925821304, decouple_loss:0.0011083711870014668
The modified gen p mean: 0.44655877351760864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028178347274661064, decouple_loss:0.00113499176222831
The modified gen p mean: 0.4467643201351166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029489297419786453, decouple_loss:0.0011217044666409492
2023-05-27 15:51:47 testing...
The modified gen p mean: 0.45382535457611084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254600241780281, decouple_loss:0.0013765968615189195
The modified gen p mean: 0.4532724618911743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034219346940517426, decouple_loss:0.001503672800026834
The modified gen p mean: 0.45188313722610474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03294428810477257, decouple_loss:0.0013719124253839254
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03330741450190544, avg_mse: 0.045467808842659
current test mse: 0.045468
Iteration: 4961, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4502986669540405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027541333809494972, decouple_loss:0.0012101697502657771
The modified gen p mean: 0.4523260295391083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027752310037612915, decouple_loss:0.0012304034316912293
The modified gen p mean: 0.4496220350265503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027486128732562065, decouple_loss:0.001210094545967877
Iteration: 4962, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500524699687958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02764483168721199, decouple_loss:0.001216414850205183
The modified gen p mean: 0.45216554403305054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771645411849022, decouple_loss:0.0011976242531090975
The modified gen p mean: 0.44887974858283997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027523061260581017, decouple_loss:0.0012229931307956576
Iteration: 4963, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506157338619232, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028472237288951874, decouple_loss:0.001096190419048071
The modified gen p mean: 0.45307230949401855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02706441469490528, decouple_loss:0.0011404695687815547
The modified gen p mean: 0.4550185203552246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0281391404569149, decouple_loss:0.0011575870448723435
Iteration: 4964, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4537380635738373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026930982246994972, decouple_loss:0.0012934866826981306
The modified gen p mean: 0.4525197744369507, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028238406404852867, decouple_loss:0.001221313257701695
The modified gen p mean: 0.45181789994239807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02775009348988533, decouple_loss:0.0011395071633160114
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr.npz
NaN value num: 0
Iteration: 4965, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4511742889881134, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4521855115890503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025019006803631783, decouple_loss:0.0011666786158457398
loss_pred:0.02522343210875988, decouple_loss:0.0012918655993416905
The modified gen p mean: 0.45516160130500793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02520490251481533, decouple_loss:0.0012306695571169257
Iteration: 4966, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451835036277771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025029662996530533, decouple_loss:0.001213285606354475
The modified gen p mean: 0.44662243127822876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025729546323418617, decouple_loss:0.0012682402739301324
The modified gen p mean: 0.4452721178531647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026893150061368942, decouple_loss:0.0012400946579873562
Iteration: 4967, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461808204650879, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02572270855307579, decouple_loss:0.0010883489158004522
The modified gen p mean: 0.4489043056964874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02537481114268303, decouple_loss:0.001157107064500451
The modified gen p mean: 0.44384509325027466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025441095232963562, decouple_loss:0.0012275134213268757
Iteration: 4968, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4427904188632965, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4429666996002197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026514673605561256, decouple_loss:0.001078709028661251
loss_pred:0.025740042328834534, decouple_loss:0.0010853538988158107
The modified gen p mean: 0.4434357285499573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026177098974585533, decouple_loss:0.0011219180887565017
Iteration: 4969, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4428478479385376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026965927332639694, decouple_loss:0.0011602252488955855
The modified gen p mean: 0.4417557418346405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612055279314518, decouple_loss:0.0010948661947622895
The modified gen p mean: 0.4468921422958374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02514483965933323, decouple_loss:0.001244910410605371
Iteration: 4970, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44576042890548706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025076553225517273, decouple_loss:0.0013012714916840196
The modified gen p mean: 0.4473346471786499, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025216566398739815, decouple_loss:0.0011960950214415789
The modified gen p mean: 0.4440537691116333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02693629078567028, decouple_loss:0.001164903398603201
2023-05-27 15:56:35 testing...
The modified gen p mean: 0.45043501257896423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03263489902019501, decouple_loss:0.0014311284758150578
The modified gen p mean: 0.4484909474849701, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03306623548269272, decouple_loss:0.0015019302954897285
The modified gen p mean: 0.449928879737854, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03445442020893097, decouple_loss:0.0014568401966243982
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03345835208892822, avg_mse: 0.04573008045554161
current test mse: 0.04573
Iteration: 4971, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44717171788215637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025751592591404915, decouple_loss:0.001190640963613987
The modified gen p mean: 0.4462951719760895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026294823735952377, decouple_loss:0.0011025507701560855
The modified gen p mean: 0.4465057849884033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026136277243494987, decouple_loss:0.0012254933826625347
Iteration: 4972, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445098340511322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025341395288705826, decouple_loss:0.0011464362032711506
The modified gen p mean: 0.44949424266815186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02527150698006153, decouple_loss:0.0012224221136420965
The modified gen p mean: 0.446377158164978, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02432098798453808, decouple_loss:0.0011062638368457556
Iteration: 4973, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466579854488373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027265258133411407, decouple_loss:0.0011418474605306983
The modified gen p mean: 0.4463912546634674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027507102116942406, decouple_loss:0.0010895475279539824
The modified gen p mean: 0.44550931453704834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025622211396694183, decouple_loss:0.0011861727107316256
Iteration: 4974, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478258788585663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026191895827651024, decouple_loss:0.0012327535077929497
The modified gen p mean: 0.44667354226112366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02556951902806759, decouple_loss:0.001206456683576107
The modified gen p mean: 0.44782745838165283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02676941268146038, decouple_loss:0.0011392642045393586
Iteration: 4975, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45001646876335144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025390952825546265, decouple_loss:0.0011657088762149215
The modified gen p mean: 0.45029309391975403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025190673768520355, decouple_loss:0.0011460136156529188
The modified gen p mean: 0.450570672750473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025837475433945656, decouple_loss:0.0011226307833567262
Iteration: 4976, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477490484714508, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025494934991002083, decouple_loss:0.0010573123581707478
The modified gen p mean: 0.45256325602531433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024852624163031578, decouple_loss:0.0012245281832292676
The modified gen p mean: 0.4486091434955597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025192217901349068, decouple_loss:0.001120810629799962
Iteration: 4977, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45260071754455566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025066955015063286, decouple_loss:0.0011581075377762318
The modified gen p mean: 0.4493723213672638, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025667225942015648, decouple_loss:0.001141017652116716
The modified gen p mean: 0.4503462016582489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025202777236700058, decouple_loss:0.0011220922460779548
Iteration: 4978, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44769084453582764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02651212364435196, decouple_loss:0.0010360581800341606
The modified gen p mean: 0.45121729373931885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024400636553764343, decouple_loss:0.001096951076760888
The modified gen p mean: 0.4507211148738861, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025133056566119194, decouple_loss:0.001109207165427506
Iteration: 4979, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44752445816993713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02553136833012104, decouple_loss:0.0011935632210224867
The modified gen p mean: 0.44692906737327576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02621951699256897, decouple_loss:0.0010912198340520263
The modified gen p mean: 0.4481637477874756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025939393788576126, decouple_loss:0.0012631573481485248
Iteration: 4980, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44702449440956116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02451265975832939, decouple_loss:0.0011332932626828551
The modified gen p mean: 0.4484110474586487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024394115433096886, decouple_loss:0.0011605521431192756
The modified gen p mean: 0.44547179341316223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025893116369843483, decouple_loss:0.00113727489951998
2023-05-27 16:00:41 testing...
The modified gen p mean: 0.45073747634887695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032461509108543396, decouple_loss:0.0014308204408735037
The modified gen p mean: 0.4490768015384674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03302501514554024, decouple_loss:0.0014601575676351786
The modified gen p mean: 0.45035073161125183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03431103378534317, decouple_loss:0.001401939895004034
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03333740308880806, avg_mse: 0.04570883512496948
current test mse: 0.045709
Iteration: 4981, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44648391008377075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02523546665906906, decouple_loss:0.0013277567923069
The modified gen p mean: 0.44459301233291626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025393683463335037, decouple_loss:0.0011526485905051231
The modified gen p mean: 0.45028263330459595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02452872507274151, decouple_loss:0.0011096029775217175
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr.npz
NaN value num: 0
Iteration: 4982, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45003947615623474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026306794956326485, decouple_loss:0.0012942008906975389
The modified gen p mean: 0.44675448536872864, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44495558738708496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02631615474820137, decouple_loss:0.0010859030298888683
loss_pred:0.026118185371160507, decouple_loss:0.001324567710980773
Iteration: 4983, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489600658416748, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02573489211499691, decouple_loss:0.0013545731781050563
The modified gen p mean: 0.444099098443985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026330258697271347, decouple_loss:0.0011057726806029677
The modified gen p mean: 0.44519737362861633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026594555005431175, decouple_loss:0.0011207838542759418
Iteration: 4984, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449918270111084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02577827498316765, decouple_loss:0.0011699296301230788
The modified gen p mean: 0.44908714294433594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02496667578816414, decouple_loss:0.0011862379033118486
The modified gen p mean: 0.4503169655799866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026172176003456116, decouple_loss:0.0012514111585915089
Iteration: 4985, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44818803668022156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025420092046260834, decouple_loss:0.0012417931575328112
The modified gen p mean: 0.4455244541168213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028065389022231102, decouple_loss:0.001233410555869341
The modified gen p mean: 0.44673028588294983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027879705652594566, decouple_loss:0.0011960758129134774
Iteration: 4986, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44978466629981995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026887493208050728, decouple_loss:0.0011169525096192956
The modified gen p mean: 0.4484800100326538, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027466870844364166, decouple_loss:0.0011699794558808208
The modified gen p mean: 0.4503593444824219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0269321259111166, decouple_loss:0.0011195241240784526
Iteration: 4987, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476873576641083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026471158489584923, decouple_loss:0.0011841405648738146
The modified gen p mean: 0.447496235370636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026967154815793037, decouple_loss:0.0011462386464700103
The modified gen p mean: 0.45119214057922363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025478705763816833, decouple_loss:0.001218275516293943
Iteration: 4988, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45028653740882874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027172518894076347, decouple_loss:0.0011984276352450252
The modified gen p mean: 0.4484347403049469, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026012953370809555, decouple_loss:0.0011637182906270027
The modified gen p mean: 0.4473392069339752, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027023475617170334, decouple_loss:0.001103714806959033
Iteration: 4989, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44791972637176514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025434166193008423, decouple_loss:0.0012405411107465625
The modified gen p mean: 0.4492875933647156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02702931873500347, decouple_loss:0.0012152099516242743
The modified gen p mean: 0.4490744173526764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02601844258606434, decouple_loss:0.0012514067348092794
Iteration: 4990, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44869184494018555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02548728697001934, decouple_loss:0.0013421286130324006
The modified gen p mean: 0.45126739144325256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02602505125105381, decouple_loss:0.0012363566784188151
The modified gen p mean: 0.44773581624031067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024581030011177063, decouple_loss:0.0012564638163894415
2023-05-27 16:05:22 testing...
The modified gen p mean: 0.449879914522171, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032664310187101364, decouple_loss:0.001469855080358684
The modified gen p mean: 0.4483286738395691, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03311186656355858, decouple_loss:0.0015858964761719108
The modified gen p mean: 0.44956013560295105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03439934924244881, decouple_loss:0.0014293281128630042
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03346659243106842, avg_mse: 0.04586692154407501
current test mse: 0.045867
Iteration: 4991, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460897147655487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02790389582514763, decouple_loss:0.0011539098341017962
The modified gen p mean: 0.44477832317352295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02620287425816059, decouple_loss:0.001127455965615809
The modified gen p mean: 0.4468139708042145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025918204337358475, decouple_loss:0.0011838487116619945
Iteration: 4992, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434455931186676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027279771864414215, decouple_loss:0.0011257935548201203
The modified gen p mean: 0.4458913207054138, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025986919179558754, decouple_loss:0.0011402452364563942
The modified gen p mean: 0.4460098147392273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025156782940030098, decouple_loss:0.0011759467888623476
Iteration: 4993, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44183772802352905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026454662904143333, decouple_loss:0.0010851215338334441
The modified gen p mean: 0.4446311593055725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02700474113225937, decouple_loss:0.001146593946032226
The modified gen p mean: 0.44840237498283386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02718358486890793, decouple_loss:0.0012189472327008843
Iteration: 4994, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475488066673279, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025789927691221237, decouple_loss:0.0011971197091042995
The modified gen p mean: 0.4451726973056793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02524050697684288, decouple_loss:0.0012693203752860427
The modified gen p mean: 0.4441277086734772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02729487046599388, decouple_loss:0.0012110150419175625
Iteration: 4995, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44746893644332886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0257050022482872, decouple_loss:0.001166104106232524
The modified gen p mean: 0.4468565285205841, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025540322065353394, decouple_loss:0.0012866230681538582
The modified gen p mean: 0.44253864884376526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0277506522834301, decouple_loss:0.0011961496202275157
Iteration: 4996, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44652611017227173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02560175396502018, decouple_loss:0.0011397943599149585
The modified gen p mean: 0.44821181893348694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025449028238654137, decouple_loss:0.0011796937324106693
The modified gen p mean: 0.44909125566482544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02701086364686489, decouple_loss:0.0011752946302294731
Iteration: 4997, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449053019285202, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026223964989185333, decouple_loss:0.001176245859824121
The modified gen p mean: 0.4461315870285034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02662535384297371, decouple_loss:0.0011025759158656001
The modified gen p mean: 0.44868195056915283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027371561154723167, decouple_loss:0.0011857864446938038
Iteration: 4998, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4464286267757416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026452237740159035, decouple_loss:0.0011494953650981188
The modified gen p mean: 0.4498573839664459, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02724969945847988, decouple_loss:0.001168827642686665
The modified gen p mean: 0.4461778402328491, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02598232589662075, decouple_loss:0.0011429466539993882
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr.npz
NaN value num: 0
Iteration: 4999, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44679853320121765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026597457006573677, decouple_loss:0.0010725443717092276
The modified gen p mean: 0.4465803802013397, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45144587755203247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02676456980407238, decouple_loss:0.001361525384709239
loss_pred:0.02548440545797348, decouple_loss:0.0012595256557688117
Iteration: 5000, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4535350501537323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026630813255906105, decouple_loss:0.0013626053696498275
The modified gen p mean: 0.44665688276290894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025505563244223595, decouple_loss:0.0011361686047166586
The modified gen p mean: 0.4489670991897583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027127724140882492, decouple_loss:0.0010980265215039253
2023-05-27 16:10:07 testing...
The modified gen p mean: 0.45349785685539246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03258901834487915, decouple_loss:0.0013390725944191217
The modified gen p mean: 0.45207127928733826, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45326530933380127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03297602757811546, decouple_loss:0.0014162390725687146
loss_pred:0.034249354153871536, decouple_loss:0.0013957738410681486
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03334065526723862, avg_mse: 0.04555545374751091
current test mse: 0.045555
Iteration: 5001, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44717493653297424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027475975453853607, decouple_loss:0.0010252760257571936
The modified gen p mean: 0.4510250687599182, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027380404993891716, decouple_loss:0.0013614795170724392
The modified gen p mean: 0.45163628458976746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02618582360446453, decouple_loss:0.0012634561862796545
Iteration: 5002, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45179420709609985, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45419275760650635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025367211550474167, decouple_loss:0.0012459995923563838
loss_pred:0.027455270290374756, decouple_loss:0.0011897848453372717
The modified gen p mean: 0.4504178464412689, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027159517630934715, decouple_loss:0.0013053922448307276
Iteration: 5003, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475816786289215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026619911193847656, decouple_loss:0.0011611849768087268
The modified gen p mean: 0.45300811529159546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02747623808681965, decouple_loss:0.0012554496061056852
The modified gen p mean: 0.44936683773994446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02456963248550892, decouple_loss:0.0011501896660774946
Iteration: 5004, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483587443828583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02623606286942959, decouple_loss:0.0012171178823336959
The modified gen p mean: 0.4510911703109741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026524288579821587, decouple_loss:0.0011689304374158382
The modified gen p mean: 0.449616014957428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02473018504679203, decouple_loss:0.0011951038613915443
Iteration: 5005, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45027193427085876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024722561240196228, decouple_loss:0.0011394197354093194
The modified gen p mean: 0.44852811098098755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026126332581043243, decouple_loss:0.0010911967838183045
The modified gen p mean: 0.4481979310512543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02479298785328865, decouple_loss:0.0011180693982169032
Iteration: 5006, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448037713766098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0264618881046772, decouple_loss:0.0011027600849047303
The modified gen p mean: 0.44779589772224426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028757717460393906, decouple_loss:0.0011523576686158776
The modified gen p mean: 0.44790980219841003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026246828958392143, decouple_loss:0.001089714583940804
Iteration: 5007, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45016998052597046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025343013927340508, decouple_loss:0.0012230798602104187
The modified gen p mean: 0.45275765657424927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026000792160630226, decouple_loss:0.0012466987827792764
The modified gen p mean: 0.44551002979278564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028232896700501442, decouple_loss:0.0012794900685548782
Iteration: 5008, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44675469398498535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026831621304154396, decouple_loss:0.0010936508188024163
The modified gen p mean: 0.44638144969940186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02651907503604889, decouple_loss:0.0010495033347979188
The modified gen p mean: 0.44971221685409546, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026302896440029144, decouple_loss:0.0012051085941493511
Iteration: 5009, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44663262367248535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027001526206731796, decouple_loss:0.001378277433104813
The modified gen p mean: 0.44732412695884705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024816136807203293, decouple_loss:0.0011214602272957563
The modified gen p mean: 0.45000243186950684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02687416970729828, decouple_loss:0.0011304119834676385
Iteration: 5010, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458928108215332, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026690352708101273, decouple_loss:0.0011020706733688712
The modified gen p mean: 0.44724616408348083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026616288349032402, decouple_loss:0.0012436127290129662
The modified gen p mean: 0.44927361607551575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026296554133296013, decouple_loss:0.0013680394040420651
2023-05-27 16:14:13 testing...
The modified gen p mean: 0.4522479474544525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03267115354537964, decouple_loss:0.0013396593276411295
The modified gen p mean: 0.45070019364356995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03315852954983711, decouple_loss:0.0014187365304678679
The modified gen p mean: 0.45210346579551697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0343405045568943, decouple_loss:0.001349847880192101
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03345853090286255, avg_mse: 0.04582267627120018
current test mse: 0.045823
Iteration: 5011, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471510946750641, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026033086702227592, decouple_loss:0.0012523205950856209
The modified gen p mean: 0.45009541511535645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02601918764412403, decouple_loss:0.0011739529436454177
The modified gen p mean: 0.44874101877212524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02735418826341629, decouple_loss:0.0013174442574381828
Iteration: 5012, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44887596368789673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026141788810491562, decouple_loss:0.001122576417401433
The modified gen p mean: 0.44705674052238464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027018554508686066, decouple_loss:0.001186256529763341
The modified gen p mean: 0.4487209618091583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026949359104037285, decouple_loss:0.0012156171724200249
Iteration: 5013, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.453935444355011, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0258175078779459, decouple_loss:0.0011768863769248128
The modified gen p mean: 0.44986236095428467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026264561340212822, decouple_loss:0.0010747389169409871
The modified gen p mean: 0.4523177444934845, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02637982927262783, decouple_loss:0.0012955082347616553
Iteration: 5014, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446686714887619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027649765834212303, decouple_loss:0.001158486120402813
The modified gen p mean: 0.451239675283432, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02639126218855381, decouple_loss:0.001330954604782164
The modified gen p mean: 0.4489518105983734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028245920315384865, decouple_loss:0.0011810886207967997
Iteration: 5015, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44904807209968567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025195477530360222, decouple_loss:0.001188996946439147
The modified gen p mean: 0.4555720388889313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027009639889001846, decouple_loss:0.0013203336857259274
The modified gen p mean: 0.4499361515045166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025130342692136765, decouple_loss:0.001235358533449471
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr.npz
NaN value num: 0
Iteration: 5016, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480573236942291, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02607831172645092, decouple_loss:0.0012364198919385672
The modified gen p mean: 0.4494687616825104, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44829684495925903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024874918162822723, decouple_loss:0.0011274414137005806
loss_pred:0.02785901352763176, decouple_loss:0.0011161727597936988
Iteration: 5017, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45370039343833923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02518797479569912, decouple_loss:0.0012815375812351704
The modified gen p mean: 0.4481639266014099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025973111391067505, decouple_loss:0.001239210832864046
The modified gen p mean: 0.44992709159851074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025334877893328667, decouple_loss:0.0013189483433961868
Iteration: 5018, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44609376788139343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0266744215041399, decouple_loss:0.0011301455087959766
The modified gen p mean: 0.44793882966041565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026448622345924377, decouple_loss:0.0011163390008732677
The modified gen p mean: 0.4476812779903412, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024347882717847824, decouple_loss:0.0012438909616321325
Iteration: 5019, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44957828521728516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025394223630428314, decouple_loss:0.0012667461996898055
The modified gen p mean: 0.44699814915657043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02408316358923912, decouple_loss:0.0011104256846010685
The modified gen p mean: 0.451226145029068, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02478639781475067, decouple_loss:0.0011360915377736092
Iteration: 5020, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44601380825042725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612093836069107, decouple_loss:0.001181835075840354
The modified gen p mean: 0.44631585478782654, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02528679184615612, decouple_loss:0.001140257460065186
The modified gen p mean: 0.44747355580329895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025064019486308098, decouple_loss:0.0011645708000287414
2023-05-27 16:19:00 testing...
The modified gen p mean: 0.4497050344944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032645609229803085, decouple_loss:0.001392704900354147
The modified gen p mean: 0.448025643825531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03315488249063492, decouple_loss:0.0014275971334427595
The modified gen p mean: 0.4495740830898285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034263137727975845, decouple_loss:0.0014550123596563935
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03342580050230026, avg_mse: 0.04572547227144241
current test mse: 0.045725
Iteration: 5021, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4429670572280884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025507787242531776, decouple_loss:0.0011220852611586452
The modified gen p mean: 0.44312170147895813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026798132807016373, decouple_loss:0.0010560337686911225
The modified gen p mean: 0.4444223940372467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026531370356678963, decouple_loss:0.0012152427807450294
Iteration: 5022, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.442548543214798, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026177598163485527, decouple_loss:0.0010343563044443727
The modified gen p mean: 0.44265657663345337, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025845326483249664, decouple_loss:0.0010560258524492383
The modified gen p mean: 0.4465125799179077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025523466989398003, decouple_loss:0.001098331529647112
Iteration: 5023, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44433605670928955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025966132059693336, decouple_loss:0.0009866019245237112
The modified gen p mean: 0.4462535083293915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02547614835202694, decouple_loss:0.0012014361564069986
The modified gen p mean: 0.44391322135925293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025683758780360222, decouple_loss:0.0009916170965880156
Iteration: 5024, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45091912150382996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024120939895510674, decouple_loss:0.0011241970350965858
The modified gen p mean: 0.44411706924438477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027928655967116356, decouple_loss:0.0010934588499367237
The modified gen p mean: 0.44631513953208923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025782214477658272, decouple_loss:0.0011472669430077076
Iteration: 5025, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.446330726146698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024678785353899002, decouple_loss:0.0011247608345001936
The modified gen p mean: 0.4470246732234955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025978652760386467, decouple_loss:0.0011491775512695312
The modified gen p mean: 0.45016393065452576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610917016863823, decouple_loss:0.0011166700860485435
Iteration: 5026, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474624693393707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025832971557974815, decouple_loss:0.0011385194957256317
The modified gen p mean: 0.4468930959701538, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026648955419659615, decouple_loss:0.0011421992676332593
The modified gen p mean: 0.45087969303131104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02370971068739891, decouple_loss:0.001271854736842215
Iteration: 5027, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450406014919281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025363145396113396, decouple_loss:0.001176632009446621
The modified gen p mean: 0.45296066999435425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024635860696434975, decouple_loss:0.0012024079915136099
The modified gen p mean: 0.4466949999332428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026161544024944305, decouple_loss:0.0010444889776408672
Iteration: 5028, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470621347427368, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025705648586153984, decouple_loss:0.0010656011290848255
The modified gen p mean: 0.44978347420692444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025746919214725494, decouple_loss:0.0011125418823212385
The modified gen p mean: 0.4536636471748352, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02415296994149685, decouple_loss:0.0011058921227231622
Iteration: 5029, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534343183040619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02485824190080166, decouple_loss:0.0010637190425768495
The modified gen p mean: 0.4488353431224823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025776714086532593, decouple_loss:0.0011585871689021587
The modified gen p mean: 0.44861072301864624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024440517649054527, decouple_loss:0.0011441025417298079
Iteration: 5030, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44884413480758667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02487303875386715, decouple_loss:0.0010934050660580397
The modified gen p mean: 0.45113489031791687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025851069018244743, decouple_loss:0.001064854091964662
The modified gen p mean: 0.4488469064235687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025543032214045525, decouple_loss:0.0012045711046084762
2023-05-27 16:23:06 testing...
The modified gen p mean: 0.4507632553577423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032696496695280075, decouple_loss:0.0013877054443582892
The modified gen p mean: 0.44908979535102844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03311557695269585, decouple_loss:0.0012733482290059328
The modified gen p mean: 0.45059460401535034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034382496029138565, decouple_loss:0.0013980793301016092
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03346584364771843, avg_mse: 0.04580304026603699
current test mse: 0.045803
Iteration: 5031, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447534382343292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02555747888982296, decouple_loss:0.0012156825978308916
The modified gen p mean: 0.4473877549171448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02643829584121704, decouple_loss:0.0011736166197806597
The modified gen p mean: 0.4514482915401459, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025159504264593124, decouple_loss:0.0010910223936662078
Iteration: 5032, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.444462388753891, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025552215054631233, decouple_loss:0.001192584284581244
The modified gen p mean: 0.4453285038471222, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02579673007130623, decouple_loss:0.001112417783588171
The modified gen p mean: 0.444421648979187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025894176214933395, decouple_loss:0.0010904570808634162
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr.npz
NaN value num: 0
Iteration: 5033, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4433985650539398, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029305381700396538, decouple_loss:0.001186058740131557
The modified gen p mean: 0.4467741847038269, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44510647654533386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028293374925851822, decouple_loss:0.0011111907660961151loss_pred:0.029133135452866554, decouple_loss:0.001179924001917243
Iteration: 5034, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44442570209503174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02858685329556465, decouple_loss:0.0010402710177004337
The modified gen p mean: 0.4435054659843445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029584743082523346, decouple_loss:0.0012426679022610188
The modified gen p mean: 0.4439677894115448, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028393356129527092, decouple_loss:0.0012972007971256971
Iteration: 5035, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483846426010132, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02898477017879486, decouple_loss:0.001192586263641715
The modified gen p mean: 0.4469676911830902, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029657864943146706, decouple_loss:0.0009958732407540083
The modified gen p mean: 0.44841060042381287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028242669999599457, decouple_loss:0.001060354639776051
Iteration: 5036, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45075860619544983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030057543888688087, decouple_loss:0.0011620980221778154
The modified gen p mean: 0.44790366291999817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027739154174923897, decouple_loss:0.0012538793962448835
The modified gen p mean: 0.44835492968559265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02912002243101597, decouple_loss:0.0012245089747011662
Iteration: 5037, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45094552636146545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02870500460267067, decouple_loss:0.0012937760911881924
The modified gen p mean: 0.4512350261211395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026604821905493736, decouple_loss:0.0011995965614914894
The modified gen p mean: 0.45573434233665466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028128448873758316, decouple_loss:0.0012471106601879
Iteration: 5038, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4531099200248718, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029787849634885788, decouple_loss:0.0011630537919700146
The modified gen p mean: 0.45173758268356323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028482938185334206, decouple_loss:0.0012463289313018322
The modified gen p mean: 0.45412108302116394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028975116088986397, decouple_loss:0.0011284099891781807
Iteration: 5039, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45603644847869873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028832782059907913, decouple_loss:0.001078178291209042
The modified gen p mean: 0.45363152027130127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02883554995059967, decouple_loss:0.001130641670897603
The modified gen p mean: 0.4565984308719635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027431847527623177, decouple_loss:0.0011993300868198276
Iteration: 5040, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4560163915157318, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02845407836139202, decouple_loss:0.0012636991450563073
The modified gen p mean: 0.45269575715065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028039224445819855, decouple_loss:0.0010424039792269468
The modified gen p mean: 0.4511549472808838, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028053954243659973, decouple_loss:0.0010874408762902021
2023-05-27 16:28:05 testing...
The modified gen p mean: 0.4532703459262848, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03252150118350983, decouple_loss:0.0013509361306205392
The modified gen p mean: 0.4515504240989685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03288315236568451, decouple_loss:0.001307377009652555
The modified gen p mean: 0.45298779010772705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034292735159397125, decouple_loss:0.0013495745370164514
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03329926356673241, avg_mse: 0.04543444514274597
current test mse: 0.045434
Iteration: 5041, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4515581429004669, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0272966418415308, decouple_loss:0.001322051859460771
The modified gen p mean: 0.45013749599456787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02862631529569626, decouple_loss:0.0010993267642334104
The modified gen p mean: 0.4489028751850128, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02978709526360035, decouple_loss:0.0010710039641708136
Iteration: 5042, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44490519165992737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027639353647828102, decouple_loss:0.0011903729755431414
The modified gen p mean: 0.445345014333725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027987640351057053, decouple_loss:0.0011296627344563603
The modified gen p mean: 0.44643691182136536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027501601725816727, decouple_loss:0.0011792808072641492
Iteration: 5043, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4443191587924957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02706211432814598, decouple_loss:0.0010903476504608989
The modified gen p mean: 0.4427688717842102, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028755804523825645, decouple_loss:0.0011428813450038433
The modified gen p mean: 0.4440855085849762, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029174670577049255, decouple_loss:0.0011975561501458287
Iteration: 5044, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4414404332637787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028656894341111183, decouple_loss:0.001052550389431417
The modified gen p mean: 0.4428408145904541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028952879831194878, decouple_loss:0.0011143089504912496
The modified gen p mean: 0.44201430678367615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02960503287613392, decouple_loss:0.0011857436038553715
Iteration: 5045, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439152479171753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02871759980916977, decouple_loss:0.0011826882837340236
The modified gen p mean: 0.4442863166332245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028124304488301277, decouple_loss:0.0012170246336609125
The modified gen p mean: 0.442424476146698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026673996821045876, decouple_loss:0.0010818821610882878
Iteration: 5046, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508989751338959, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02821556106209755, decouple_loss:0.0013372687390074134
The modified gen p mean: 0.4441642761230469, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0268707275390625, decouple_loss:0.0011624605394899845
The modified gen p mean: 0.44505876302719116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028785008937120438, decouple_loss:0.0010241608833894134
Iteration: 5047, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44988176226615906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028486954048275948, decouple_loss:0.001229106797836721
The modified gen p mean: 0.447939395904541, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03003321774303913, decouple_loss:0.0010805937927216291
The modified gen p mean: 0.4481826424598694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02855604700744152, decouple_loss:0.0010845260694622993
Iteration: 5048, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504396915435791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02757425606250763, decouple_loss:0.0011805628892034292
The modified gen p mean: 0.45255765318870544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027974652126431465, decouple_loss:0.0010737129487097263
The modified gen p mean: 0.4491080939769745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027991075068712234, decouple_loss:0.0011332530993968248
Iteration: 5049, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45406582951545715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028969312086701393, decouple_loss:0.0012152610579505563
The modified gen p mean: 0.452085942029953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027689842507243156, decouple_loss:0.0012441263534128666
The modified gen p mean: 0.45519590377807617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027542807161808014, decouple_loss:0.001264749327674508
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr.npz
NaN value num: 0
Iteration: 5050, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4522753357887268, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029123976826667786, decouple_loss:0.0011979884002357721
The modified gen p mean: 0.45359209179878235, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4516361355781555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029505079612135887, decouple_loss:0.0011929195607081056
loss_pred:0.0286874957382679, decouple_loss:0.001106154639273882
2023-05-27 16:34:27 testing...
The modified gen p mean: 0.4548715054988861, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45299747586250305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032374899834394455, decouple_loss:0.0014887013239786029
loss_pred:0.032964080572128296, decouple_loss:0.0013281030114740133
The modified gen p mean: 0.4545694887638092, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03428652510046959, decouple_loss:0.0014737977180629969
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033280011266469955, avg_mse: 0.045344650745391846
current test mse: 0.045345
Iteration: 5051, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45344263315200806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027195503935217857, decouple_loss:0.0012978591257706285
The modified gen p mean: 0.4496375322341919, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029467785730957985, decouple_loss:0.0011756860185414553
The modified gen p mean: 0.45034369826316833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02875600755214691, decouple_loss:0.0013235809747129679
Iteration: 5052, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44724294543266296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029510561376810074, decouple_loss:0.0011770272394642234
The modified gen p mean: 0.4520622491836548, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027829594910144806, decouple_loss:0.0012822492280974984
The modified gen p mean: 0.44896119832992554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029853729531168938, decouple_loss:0.001245518447831273
Iteration: 5053, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453822076320648, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027783840894699097, decouple_loss:0.0012502102181315422
The modified gen p mean: 0.4487076997756958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02863973192870617, decouple_loss:0.0012623759685084224
The modified gen p mean: 0.4493463337421417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02796907164156437, decouple_loss:0.0011859694495797157
Iteration: 5054, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44600602984428406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028897693380713463, decouple_loss:0.0011951993219554424
The modified gen p mean: 0.44325023889541626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028904402628540993, decouple_loss:0.001213198876939714
The modified gen p mean: 0.4458390474319458, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027821047231554985, decouple_loss:0.0012107295915484428
Iteration: 5055, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445582926273346, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02920646406710148, decouple_loss:0.0011612417874857783
The modified gen p mean: 0.44795453548431396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029124602675437927, decouple_loss:0.0012248606653884053
The modified gen p mean: 0.44758620858192444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028512293472886086, decouple_loss:0.0011490395991131663
Iteration: 5056, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44405806064605713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028292011469602585, decouple_loss:0.001043866272084415
The modified gen p mean: 0.445574551820755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02870877832174301, decouple_loss:0.0012254839530214667
The modified gen p mean: 0.4454023838043213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028444766998291016, decouple_loss:0.0012562093324959278
Iteration: 5057, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442415237426758, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028584497049450874, decouple_loss:0.0011124409502372146
The modified gen p mean: 0.4460526406764984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027194391936063766, decouple_loss:0.0012119845487177372
The modified gen p mean: 0.4458840489387512, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02985115721821785, decouple_loss:0.0011542650172486901
Iteration: 5058, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44749975204467773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028254445642232895, decouple_loss:0.0013446129160001874
The modified gen p mean: 0.44693249464035034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02993558719754219, decouple_loss:0.0011521561536937952
The modified gen p mean: 0.44999754428863525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02779809758067131, decouple_loss:0.001412713434547186
Iteration: 5059, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492914378643036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030034441500902176, decouple_loss:0.0011746753007173538
The modified gen p mean: 0.44990795850753784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028393879532814026, decouple_loss:0.0011970435734838247
The modified gen p mean: 0.44995391368865967, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028871862217783928, decouple_loss:0.00109270925167948
Iteration: 5060, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512695372104645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028905125334858894, decouple_loss:0.0011504478752613068
The modified gen p mean: 0.4508601725101471, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02957897260785103, decouple_loss:0.0012733576586470008
The modified gen p mean: 0.4523719847202301, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02792675606906414, decouple_loss:0.0012015490792691708
2023-05-27 16:38:32 testing...
The modified gen p mean: 0.4543340802192688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03220590576529503, decouple_loss:0.001362024457193911
The modified gen p mean: 0.4523347318172455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032807160168886185, decouple_loss:0.001374024199321866
The modified gen p mean: 0.4540254473686218, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03400242328643799, decouple_loss:0.0013975028414279222
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03307405859231949, avg_mse: 0.0450325645506382
current test mse: 0.045033
Iteration: 5061, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45055773854255676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02879723161458969, decouple_loss:0.001254600239917636
The modified gen p mean: 0.448265939950943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029064737260341644, decouple_loss:0.0011634358670562506
The modified gen p mean: 0.45130300521850586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027365297079086304, decouple_loss:0.001232718350365758
Iteration: 5062, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44827598333358765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028167570009827614, decouple_loss:0.001234467956237495
The modified gen p mean: 0.4514092803001404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028971772640943527, decouple_loss:0.001170156174339354
The modified gen p mean: 0.44820040464401245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028392555192112923, decouple_loss:0.0011780717177316546
Iteration: 5063, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505886435508728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027392303571105003, decouple_loss:0.001285372767597437
The modified gen p mean: 0.44862765073776245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027297554537653923, decouple_loss:0.0012911269441246986
The modified gen p mean: 0.449569433927536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028402170166373253, decouple_loss:0.0014152366202324629
Iteration: 5064, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.449502170085907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026825254783034325, decouple_loss:0.0011846801498904824
The modified gen p mean: 0.445690780878067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029639415442943573, decouple_loss:0.001096618827432394
The modified gen p mean: 0.4461178779602051, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030763564631342888, decouple_loss:0.0011975386878475547
Iteration: 5065, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447018563747406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027353864163160324, decouple_loss:0.0012824685545638204
The modified gen p mean: 0.44591328501701355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028277235105633736, decouple_loss:0.0012092808028683066
The modified gen p mean: 0.4488949477672577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02775365486741066, decouple_loss:0.0012179820332676172
Iteration: 5066, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44455355405807495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02820955589413643, decouple_loss:0.001126746996305883
The modified gen p mean: 0.4464450776576996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027945782989263535, decouple_loss:0.0012199236080050468
The modified gen p mean: 0.4499972462654114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0280874315649271, decouple_loss:0.0013092347653582692
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr.npz
NaN value num: 0
Iteration: 5067, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493286907672882, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02527080476284027, decouple_loss:0.0012324900599196553
The modified gen p mean: 0.4518911838531494, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4467434585094452, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02444252371788025, decouple_loss:0.0012734817573800683loss_pred:0.025229008868336678, decouple_loss:0.0011620426084846258
Iteration: 5068, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459114074707031, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026632260531187057, decouple_loss:0.0011659512529149652
The modified gen p mean: 0.4442816376686096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02599385939538479, decouple_loss:0.0010953437304124236
The modified gen p mean: 0.4487748146057129, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025364162400364876, decouple_loss:0.0012084770714864135
Iteration: 5069, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442172348499298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025621352717280388, decouple_loss:0.001181320403702557
The modified gen p mean: 0.4463474154472351, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02628207392990589, decouple_loss:0.0012127290247008204
The modified gen p mean: 0.44730281829833984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025607246905565262, decouple_loss:0.0011483863927423954
Iteration: 5070, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480321705341339, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025475215166807175, decouple_loss:0.0011791373835876584
The modified gen p mean: 0.4446651041507721, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02400355413556099, decouple_loss:0.001205726177431643
The modified gen p mean: 0.4510258734226227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024733802303671837, decouple_loss:0.0013839488383382559
2023-05-27 16:43:23 testing...
The modified gen p mean: 0.45054563879966736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03275180980563164, decouple_loss:0.0014598643174394965
The modified gen p mean: 0.4485069811344147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03311992064118385, decouple_loss:0.0012814977671951056
The modified gen p mean: 0.4503042697906494, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03442519158124924, decouple_loss:0.0014676728751510382
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03350245952606201, avg_mse: 0.04573393240571022
current test mse: 0.045734
Iteration: 5071, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44717302918434143, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024206098169088364, decouple_loss:0.0011625706683844328
The modified gen p mean: 0.4460538923740387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02526225335896015, decouple_loss:0.001067599980160594
The modified gen p mean: 0.4441598057746887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02556571178138256, decouple_loss:0.0010713324882090092
Iteration: 5072, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4439188241958618, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027167439460754395, decouple_loss:0.0011408590944483876
The modified gen p mean: 0.4468942880630493, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026024989783763885, decouple_loss:0.0011159583227708936
The modified gen p mean: 0.44195201992988586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026349110528826714, decouple_loss:0.0011303863720968366
Iteration: 5073, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497150778770447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024310819804668427, decouple_loss:0.001266236649826169
The modified gen p mean: 0.4424830377101898, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02574629709124565, decouple_loss:0.0011301039485260844
The modified gen p mean: 0.4443449079990387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.023949800059199333, decouple_loss:0.0012691040756180882
Iteration: 5074, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442002475261688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02536151185631752, decouple_loss:0.001192069030366838
The modified gen p mean: 0.4459497630596161, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02510983496904373, decouple_loss:0.0010854597203433514
The modified gen p mean: 0.44483625888824463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02613070048391819, decouple_loss:0.0011223506880924106
Iteration: 5075, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4422703981399536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025455104187130928, decouple_loss:0.0011303481878712773
The modified gen p mean: 0.44405385851860046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025901908054947853, decouple_loss:0.0011366443941369653
The modified gen p mean: 0.4447580873966217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026966096833348274, decouple_loss:0.0011770284036174417
Iteration: 5076, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463663101196289, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025967929512262344, decouple_loss:0.0012039832072332501
The modified gen p mean: 0.4451093375682831, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02587132714688778, decouple_loss:0.001096838735975325
The modified gen p mean: 0.44664984941482544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026331696659326553, decouple_loss:0.0011356632458046079
Iteration: 5077, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44732728600502014, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0264763031154871, decouple_loss:0.0012333207996562123
The modified gen p mean: 0.448470801115036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025152942165732384, decouple_loss:0.0010921017965301871
The modified gen p mean: 0.4527817666530609, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02525724284350872, decouple_loss:0.0013281640131026506
Iteration: 5078, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4564771056175232, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02437332645058632, decouple_loss:0.001284755882807076
The modified gen p mean: 0.448672890663147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026639018207788467, decouple_loss:0.001037261332385242
The modified gen p mean: 0.4497438073158264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025129549205303192, decouple_loss:0.0010566242272034287
Iteration: 5079, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451962411403656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02419477142393589, decouple_loss:0.0013018068857491016
The modified gen p mean: 0.45645755529403687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.023853030055761337, decouple_loss:0.0011535468511283398
The modified gen p mean: 0.45203718543052673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024044359102845192, decouple_loss:0.0013072843430563807
Iteration: 5080, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480842351913452, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026179907843470573, decouple_loss:0.0011486903531476855
The modified gen p mean: 0.44985178112983704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02658076211810112, decouple_loss:0.0011381080839782953
The modified gen p mean: 0.455288827419281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02380753494799137, decouple_loss:0.0011806617258116603
2023-05-27 16:47:31 testing...
The modified gen p mean: 0.453039288520813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03262518346309662, decouple_loss:0.0014031168539077044
The modified gen p mean: 0.45101773738861084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032926544547080994, decouple_loss:0.0013152578612789512
The modified gen p mean: 0.45282885432243347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03434137627482414, decouple_loss:0.0014055308420211077
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03336643427610397, avg_mse: 0.04560737684369087
current test mse: 0.045607
Iteration: 5081, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45150068402290344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0236470028758049, decouple_loss:0.0011070258915424347
The modified gen p mean: 0.44993552565574646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024040160700678825, decouple_loss:0.0011766498209908605
The modified gen p mean: 0.44624969363212585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025595977902412415, decouple_loss:0.0011864539701491594
Iteration: 5082, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44683974981307983, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024485159665346146, decouple_loss:0.0012029189383611083
The modified gen p mean: 0.450312077999115, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.023858176544308662, decouple_loss:0.0011585861211642623
The modified gen p mean: 0.445772647857666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02559185028076172, decouple_loss:0.0010861322516575456
Iteration: 5083, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44155606627464294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025767222046852112, decouple_loss:0.001139161642640829
The modified gen p mean: 0.4407256543636322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026254182681441307, decouple_loss:0.0011252963449805975
The modified gen p mean: 0.44228440523147583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025927089154720306, decouple_loss:0.0010596530046314
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr_shift3.npz
NaN value num: 0
Iteration: 5084, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44337308406829834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026811635121703148, decouple_loss:0.001227239496074617
The modified gen p mean: 0.44192078709602356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028398390859365463, decouple_loss:0.0011973044602200389
The modified gen p mean: 0.44073426723480225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02860989049077034, decouple_loss:0.001103414106182754
Iteration: 5085, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447087049484253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025975489988923073, decouple_loss:0.001183750107884407
The modified gen p mean: 0.44794437289237976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025489995256066322, decouple_loss:0.001082352944649756
The modified gen p mean: 0.44173669815063477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027027076110243797, decouple_loss:0.0011903797276318073
Iteration: 5086, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44509580731391907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027034197002649307, decouple_loss:0.0010640351101756096
The modified gen p mean: 0.44660961627960205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027715686708688736, decouple_loss:0.0010832557454705238
The modified gen p mean: 0.4515928626060486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025374939665198326, decouple_loss:0.0011662858305498958
Iteration: 5087, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44888409972190857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02693866938352585, decouple_loss:0.0012190440902486444
The modified gen p mean: 0.453774094581604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025535734370350838, decouple_loss:0.0011984661687165499
The modified gen p mean: 0.4487120807170868, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026944778859615326, decouple_loss:0.0010745525360107422
Iteration: 5088, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519903063774109, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026318881660699844, decouple_loss:0.0012251996668055654
The modified gen p mean: 0.450928658246994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02649727277457714, decouple_loss:0.001075914828106761
The modified gen p mean: 0.452223539352417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025963082909584045, decouple_loss:0.0013075253227725625
Iteration: 5089, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45304739475250244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025886142626404762, decouple_loss:0.0012102588079869747
The modified gen p mean: 0.45228421688079834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026260903105139732, decouple_loss:0.0011860248632729053
The modified gen p mean: 0.45036864280700684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027572151273489, decouple_loss:0.0011376835172995925
Iteration: 5090, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45098161697387695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02806534804403782, decouple_loss:0.0010797620052471757
The modified gen p mean: 0.45115143060684204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026824934408068657, decouple_loss:0.0012349868193268776
The modified gen p mean: 0.45163047313690186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026809360831975937, decouple_loss:0.0011645331978797913
2023-05-27 16:52:18 testing...
The modified gen p mean: 0.4534531533718109, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03283906728029251, decouple_loss:0.001510912785306573
The modified gen p mean: 0.45132362842559814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033068060874938965, decouple_loss:0.001320069539360702
The modified gen p mean: 0.4531570374965668, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03463174030184746, decouple_loss:0.0014981423737481236
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03358510881662369, avg_mse: 0.04591336101293564
current test mse: 0.045913
Iteration: 5091, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468819200992584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02796284109354019, decouple_loss:0.0012843835866078734
The modified gen p mean: 0.4491128623485565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027124276384711266, decouple_loss:0.0011492583435028791
The modified gen p mean: 0.4487978518009186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026466231793165207, decouple_loss:0.0011628122301772237
Iteration: 5092, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44644492864608765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026004010811448097, decouple_loss:0.0011261056642979383
The modified gen p mean: 0.44567039608955383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027771616354584694, decouple_loss:0.0012404402950778604
The modified gen p mean: 0.4464006721973419, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025766950100660324, decouple_loss:0.0012014429084956646
Iteration: 5093, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478519856929779, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02609339728951454, decouple_loss:0.0013030195841565728
The modified gen p mean: 0.4435104727745056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027230797335505486, decouple_loss:0.0011126567842438817
The modified gen p mean: 0.44289588928222656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02753223292529583, decouple_loss:0.0011650936212390661
Iteration: 5094, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44639214873313904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02548868954181671, decouple_loss:0.0013162114191800356
The modified gen p mean: 0.447433203458786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026105107739567757, decouple_loss:0.0013096606126055121
The modified gen p mean: 0.4441213607788086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0256770309060812, decouple_loss:0.001141660613939166
Iteration: 5095, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44674527645111084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026310408487915993, decouple_loss:0.0012968775117769837
The modified gen p mean: 0.4449402093887329, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02695848047733307, decouple_loss:0.0011930763721466064
The modified gen p mean: 0.448555052280426, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024769945070147514, decouple_loss:0.0011822638334706426
Iteration: 5096, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44249850511550903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026276232674717903, decouple_loss:0.0013694239314645529
The modified gen p mean: 0.44462376832962036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026967575773596764, decouple_loss:0.0014145850436761975
The modified gen p mean: 0.4475386142730713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025609878823161125, decouple_loss:0.0011405822588130832
Iteration: 5097, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44380995631217957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02653736248612404, decouple_loss:0.001291030552238226
The modified gen p mean: 0.44739362597465515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0266246497631073, decouple_loss:0.0012282411335036159
The modified gen p mean: 0.44581612944602966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025529809296131134, decouple_loss:0.0012985033681616187
Iteration: 5098, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45016995072364807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026349345222115517, decouple_loss:0.0012040025321766734
The modified gen p mean: 0.45206043124198914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025907199829816818, decouple_loss:0.0012017476838082075
The modified gen p mean: 0.445751816034317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026675373315811157, decouple_loss:0.0011802244698628783
Iteration: 5099, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44822895526885986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02635352499783039, decouple_loss:0.0011231983080506325
The modified gen p mean: 0.4528408944606781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026190955191850662, decouple_loss:0.0012486826162785292
The modified gen p mean: 0.44803112745285034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026615828275680542, decouple_loss:0.0012016160180792212
Iteration: 5100, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44807517528533936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027371861040592194, decouple_loss:0.0012064521433785558
The modified gen p mean: 0.4489593505859375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026712968945503235, decouple_loss:0.001208083936944604
The modified gen p mean: 0.4486369788646698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026903003454208374, decouple_loss:0.0011493548518046737
2023-05-27 16:56:25 testing...
The modified gen p mean: 0.45494166016578674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03295687586069107, decouple_loss:0.0016481366474181414
The modified gen p mean: 0.4528741240501404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03319479525089264, decouple_loss:0.001390644465573132
The modified gen p mean: 0.45460888743400574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03475143387913704, decouple_loss:0.0016701522981747985
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03371284902095795, avg_mse: 0.046138402074575424
current test mse: 0.046138
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr_shift3.npz
NaN value num: 0
Iteration: 5101, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45123863220214844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027864795178174973, decouple_loss:0.001383255934342742
The modified gen p mean: 0.4519382119178772, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4485253393650055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02799050137400627, decouple_loss:0.0011988449841737747
loss_pred:0.028380535542964935, decouple_loss:0.0013289093039929867
Iteration: 5102, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513278603553772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026755915954709053, decouple_loss:0.0011735964799299836
The modified gen p mean: 0.4488789141178131, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029368199408054352, decouple_loss:0.0010809758678078651
The modified gen p mean: 0.45375436544418335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027043519541621208, decouple_loss:0.0013854603748768568
Iteration: 5103, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44806793332099915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029046887531876564, decouple_loss:0.0011402663076296449
The modified gen p mean: 0.4502650797367096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027619225904345512, decouple_loss:0.0011861866805702448
The modified gen p mean: 0.45461979508399963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02658148668706417, decouple_loss:0.0015538177685812116
Iteration: 5104, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45289337635040283, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02642342448234558, decouple_loss:0.0011528359027579427
The modified gen p mean: 0.45614802837371826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02727166935801506, decouple_loss:0.0013293344527482986
The modified gen p mean: 0.4517679512500763, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02819669060409069, decouple_loss:0.0011552840005606413
Iteration: 5105, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44842809438705444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027608264237642288, decouple_loss:0.001117040286771953
The modified gen p mean: 0.44957274198532104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027126625180244446, decouple_loss:0.0011736262822523713
The modified gen p mean: 0.4498143196105957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02663007378578186, decouple_loss:0.0011923445854336023
Iteration: 5106, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501842260360718, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026684964075684547, decouple_loss:0.0012541336473077536
The modified gen p mean: 0.4490518867969513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028057532384991646, decouple_loss:0.0011190999066457152
The modified gen p mean: 0.45169737935066223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02687196433544159, decouple_loss:0.0012317822547629476
Iteration: 5107, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498118460178375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02708606608211994, decouple_loss:0.0012375479564070702
The modified gen p mean: 0.4463876783847809, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028538212180137634, decouple_loss:0.0012101492611691356
The modified gen p mean: 0.44959986209869385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02675740048289299, decouple_loss:0.001136244973167777
Iteration: 5108, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44647467136383057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027930447831749916, decouple_loss:0.0012198489857837558
The modified gen p mean: 0.45204299688339233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027523240074515343, decouple_loss:0.0012478068238124251
The modified gen p mean: 0.4497167468070984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02728208340704441, decouple_loss:0.0011876897187903523
Iteration: 5109, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494883418083191, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026536330580711365, decouple_loss:0.001192124793305993
The modified gen p mean: 0.44898974895477295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02712423726916313, decouple_loss:0.0012196868192404509
The modified gen p mean: 0.4486456513404846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673354558646679, decouple_loss:0.0012345177819952369
Iteration: 5110, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489429295063019, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02716330625116825, decouple_loss:0.001174133038148284
The modified gen p mean: 0.4458637535572052, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028208673000335693, decouple_loss:0.0011035848874598742
The modified gen p mean: 0.44690361618995667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027638988569378853, decouple_loss:0.0012513105757534504
2023-05-27 17:01:18 testing...
The modified gen p mean: 0.4524650275707245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032626859843730927, decouple_loss:0.0014135523233562708
The modified gen p mean: 0.45037972927093506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03319302573800087, decouple_loss:0.0013236497761681676
The modified gen p mean: 0.45193028450012207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03436318412423134, decouple_loss:0.0014669778756797314
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033464424312114716, avg_mse: 0.04573766887187958
current test mse: 0.045738
Iteration: 5111, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44915488362312317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612222172319889, decouple_loss:0.0011376627953723073
The modified gen p mean: 0.44711601734161377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027805129066109657, decouple_loss:0.0011409417493268847
The modified gen p mean: 0.4518319070339203, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026134388521313667, decouple_loss:0.0012395831290632486
Iteration: 5112, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44606584310531616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02856307104229927, decouple_loss:0.0012017198605462909
The modified gen p mean: 0.45175111293792725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02769605629146099, decouple_loss:0.0012198475887998939
The modified gen p mean: 0.45137113332748413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02603658102452755, decouple_loss:0.0011640910524874926
Iteration: 5113, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492839276790619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027885714545845985, decouple_loss:0.0011904173297807574
The modified gen p mean: 0.4513610303401947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026201123371720314, decouple_loss:0.0012141179759055376
The modified gen p mean: 0.44571810960769653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02895762026309967, decouple_loss:0.0011194213293492794
Iteration: 5114, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44668668508529663, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027848174795508385, decouple_loss:0.0010572493774816394
The modified gen p mean: 0.44621944427490234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028608694672584534, decouple_loss:0.0011264225468039513
The modified gen p mean: 0.4454067647457123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02647084929049015, decouple_loss:0.0012119775637984276
Iteration: 5115, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457881450653076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02754046954214573, decouple_loss:0.001214895979501307
The modified gen p mean: 0.4454938769340515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027797872200608253, decouple_loss:0.0011858528014272451
The modified gen p mean: 0.44607675075531006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027647769078612328, decouple_loss:0.0011356897884979844
Iteration: 5116, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457104206085205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028307152912020683, decouple_loss:0.0011465525021776557
The modified gen p mean: 0.4475414752960205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027373293414711952, decouple_loss:0.0011789386626332998
The modified gen p mean: 0.45004022121429443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027689412236213684, decouple_loss:0.0012807491002604365
Iteration: 5117, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471847116947174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02841986157000065, decouple_loss:0.0012689880095422268
The modified gen p mean: 0.4461172819137573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028270471841096878, decouple_loss:0.001244250568561256
The modified gen p mean: 0.44692176580429077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02717754617333412, decouple_loss:0.0012569109676405787
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr_shift3.npz
NaN value num: 0
Iteration: 5118, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516240656375885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02893543802201748, decouple_loss:0.001374062616378069
The modified gen p mean: 0.45110777020454407, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4495452344417572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027177609503269196, decouple_loss:0.001318858121521771
loss_pred:0.02803965099155903, decouple_loss:0.0012874715030193329
Iteration: 5119, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45048612356185913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027289854362607002, decouple_loss:0.0011196892010048032
The modified gen p mean: 0.4494669437408447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027264904230833054, decouple_loss:0.0014601672301068902
The modified gen p mean: 0.451647013425827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02719905786216259, decouple_loss:0.0013136313064023852
Iteration: 5120, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44919443130493164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027640558779239655, decouple_loss:0.001592273823916912
The modified gen p mean: 0.45423394441604614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02760959230363369, decouple_loss:0.0012478948337957263
The modified gen p mean: 0.4467335343360901, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029033828526735306, decouple_loss:0.001285191741771996
2023-05-27 17:06:03 testing...
The modified gen p mean: 0.4550428092479706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032600823789834976, decouple_loss:0.0014580419519916177
The modified gen p mean: 0.4529553949832916, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4545903205871582, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03306607902050018, decouple_loss:0.0012951121898368
loss_pred:0.03426132723689079, decouple_loss:0.0014625171897932887
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03337967395782471, avg_mse: 0.04562133550643921
current test mse: 0.045621
Iteration: 5121, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4540407359600067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027970021590590477, decouple_loss:0.0012111642863601446
The modified gen p mean: 0.4538167715072632, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02764260210096836, decouple_loss:0.0011688214726746082
The modified gen p mean: 0.450550377368927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029761597514152527, decouple_loss:0.0011599068529903889
Iteration: 5122, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485585689544678, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028582734987139702, decouple_loss:0.001244355458766222
The modified gen p mean: 0.452842652797699, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02669931948184967, decouple_loss:0.0013269768096506596
The modified gen p mean: 0.45301979780197144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027982940897345543, decouple_loss:0.0013188172597438097
Iteration: 5123, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479858875274658, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028917210176587105, decouple_loss:0.0012312944745644927
The modified gen p mean: 0.45094919204711914, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028910091146826744, decouple_loss:0.0011763456277549267
The modified gen p mean: 0.44945356249809265, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028454937040805817, decouple_loss:0.0011776135070249438
Iteration: 5124, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4509606659412384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027245154604315758, decouple_loss:0.001223159022629261
The modified gen p mean: 0.4516134262084961, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027847619727253914, decouple_loss:0.0013031702255830169
The modified gen p mean: 0.45029255747795105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02733006700873375, decouple_loss:0.0012227484257891774
Iteration: 5125, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534900486469269, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026418350636959076, decouple_loss:0.0011992836371064186
The modified gen p mean: 0.4489136040210724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029967792332172394, decouple_loss:0.0011919003445655107
The modified gen p mean: 0.45117995142936707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02867881767451763, decouple_loss:0.0011873318580910563
Iteration: 5126, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503621459007263, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02866673655807972, decouple_loss:0.0011967322789132595
The modified gen p mean: 0.4529542624950409, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027235321700572968, decouple_loss:0.001214184914715588
The modified gen p mean: 0.44651731848716736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02871253341436386, decouple_loss:0.0011914264177903533
Iteration: 5127, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45157188177108765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027484223246574402, decouple_loss:0.0012992230476811528
The modified gen p mean: 0.4506937861442566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028835847973823547, decouple_loss:0.0012180230114609003
The modified gen p mean: 0.44995802640914917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028323296457529068, decouple_loss:0.0012745988788083196
Iteration: 5128, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44692227244377136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028645088896155357, decouple_loss:0.0011128170881420374
The modified gen p mean: 0.44736796617507935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02892245724797249, decouple_loss:0.0013608714798465371
The modified gen p mean: 0.44950157403945923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027876896783709526, decouple_loss:0.0012210579589009285
Iteration: 5129, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44513991475105286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02862357720732689, decouple_loss:0.0013054386945441365
The modified gen p mean: 0.4474005699157715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027860982343554497, decouple_loss:0.0011018650839105248
The modified gen p mean: 0.4480881690979004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02727644518017769, decouple_loss:0.0013331061927601695
Iteration: 5130, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4446374773979187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02865218184888363, decouple_loss:0.0011505566071718931
The modified gen p mean: 0.4445784389972687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027353506535291672, decouple_loss:0.00121256650891155
The modified gen p mean: 0.4443192183971405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028180483728647232, decouple_loss:0.0012504790211096406
2023-05-27 17:10:10 testing...
The modified gen p mean: 0.45190882682800293, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03252105787396431, decouple_loss:0.0015322963008657098
The modified gen p mean: 0.4512080252170563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03419474884867668, decouple_loss:0.001442188280634582
The modified gen p mean: 0.44963330030441284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03291947394609451, decouple_loss:0.001363606657832861
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03328406438231468, avg_mse: 0.045429933816194534
current test mse: 0.04543
Iteration: 5131, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44834840297698975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02642359957098961, decouple_loss:0.0012714879121631384
The modified gen p mean: 0.4461328387260437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02846195176243782, decouple_loss:0.0013170186430215836
The modified gen p mean: 0.44598764181137085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028678253293037415, decouple_loss:0.0012250785948708653
Iteration: 5132, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44821375608444214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026316925883293152, decouple_loss:0.0012760554673150182
The modified gen p mean: 0.4453592002391815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027920223772525787, decouple_loss:0.0011816152837127447
The modified gen p mean: 0.4453677535057068, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028903719037771225, decouple_loss:0.0011473371414467692
Iteration: 5133, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445407897233963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028798457235097885, decouple_loss:0.0012008509365841746
The modified gen p mean: 0.4473753273487091, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028284501284360886, decouple_loss:0.0010616430081427097
The modified gen p mean: 0.44898658990859985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028252240270376205, decouple_loss:0.0012268949067220092
Iteration: 5134, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450933635234833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027615688741207123, decouple_loss:0.001140991342253983
The modified gen p mean: 0.44644084572792053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02858235500752926, decouple_loss:0.0010850379476323724
The modified gen p mean: 0.4463464021682739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02935262955725193, decouple_loss:0.0012203189544379711
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr.npz
NaN value num: 0
Iteration: 5135, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4531446397304535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024929851293563843, decouple_loss:0.0013435775181278586
The modified gen p mean: 0.45190584659576416, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4480797350406647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02507784776389599, decouple_loss:0.0013961477670818567
loss_pred:0.02544117160141468, decouple_loss:0.0012148364912718534
Iteration: 5136, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45050695538520813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02632841467857361, decouple_loss:0.0012347681913524866
The modified gen p mean: 0.4472652077674866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02841292694211006, decouple_loss:0.0011761202476918697
The modified gen p mean: 0.4506329596042633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025295022875070572, decouple_loss:0.0011508037569001317
Iteration: 5137, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485178291797638, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02621307410299778, decouple_loss:0.0013492919970303774
The modified gen p mean: 0.44809767603874207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0266881063580513, decouple_loss:0.0012115564895793796
The modified gen p mean: 0.4455838203430176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027589866891503334, decouple_loss:0.0012313647894188762
Iteration: 5138, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4440041482448578, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027083590626716614, decouple_loss:0.0011939109535887837
The modified gen p mean: 0.44411593675613403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02796364203095436, decouple_loss:0.0011916281655430794
The modified gen p mean: 0.4499591588973999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024334322661161423, decouple_loss:0.0011159388814121485
Iteration: 5139, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44373512268066406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02612643502652645, decouple_loss:0.0011469728779047728
The modified gen p mean: 0.4441696107387543, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02468232996761799, decouple_loss:0.0012929483782500029
The modified gen p mean: 0.4436592757701874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02679263986647129, decouple_loss:0.0011895097559317946
Iteration: 5140, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44564560055732727, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025928448885679245, decouple_loss:0.0011130808852612972
The modified gen p mean: 0.4450887143611908, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027348432689905167, decouple_loss:0.0011806089896708727
The modified gen p mean: 0.4462074935436249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025560319423675537, decouple_loss:0.001193507225252688
2023-05-27 17:15:10 testing...
The modified gen p mean: 0.4477936923503876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03274338319897652, decouple_loss:0.0014478913508355618
The modified gen p mean: 0.44567856192588806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033037398010492325, decouple_loss:0.0013859529281035066
The modified gen p mean: 0.44718265533447266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034344229847192764, decouple_loss:0.0014156856341287494
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033445827662944794, avg_mse: 0.045793820172548294
current test mse: 0.045794
Iteration: 5141, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457085430622101, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025668781250715256, decouple_loss:0.0012379554100334644
The modified gen p mean: 0.44134023785591125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0261269211769104, decouple_loss:0.001212798641063273
The modified gen p mean: 0.44426289200782776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025109533220529556, decouple_loss:0.001281557371839881
Iteration: 5142, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44217875599861145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025492003187537193, decouple_loss:0.0011356296017765999
The modified gen p mean: 0.44543081521987915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02565896324813366, decouple_loss:0.0012677627382799983
The modified gen p mean: 0.446601003408432, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025685671716928482, decouple_loss:0.0011632469249889255
Iteration: 5143, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44626253843307495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027231238782405853, decouple_loss:0.001173469121567905
The modified gen p mean: 0.44720259308815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02696355991065502, decouple_loss:0.0012384032597765326
The modified gen p mean: 0.4446043372154236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028281189501285553, decouple_loss:0.0012931304518133402
Iteration: 5144, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45042020082473755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024905674159526825, decouple_loss:0.0013582160463556647
The modified gen p mean: 0.44915953278541565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02613811194896698, decouple_loss:0.001154675497673452
The modified gen p mean: 0.4481395184993744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024356957525014877, decouple_loss:0.0012196904281154275
Iteration: 5145, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44811180233955383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02785681001842022, decouple_loss:0.0011168685741722584
The modified gen p mean: 0.4521919786930084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026106826961040497, decouple_loss:0.0012208258267492056
The modified gen p mean: 0.44951674342155457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02814544178545475, decouple_loss:0.0011824140092357993
Iteration: 5146, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4512194097042084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025047454982995987, decouple_loss:0.0011594515526667237
The modified gen p mean: 0.4494595527648926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026391180232167244, decouple_loss:0.0011093802750110626
The modified gen p mean: 0.45076388120651245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02541639842092991, decouple_loss:0.0012344546848908067
Iteration: 5147, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45145049691200256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02620662748813629, decouple_loss:0.001138465479016304
The modified gen p mean: 0.454904705286026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02462727762758732, decouple_loss:0.0014408996794372797
The modified gen p mean: 0.4520934820175171, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02714443765580654, decouple_loss:0.0012300102971494198
Iteration: 5148, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4532786011695862, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024777334183454514, decouple_loss:0.0010938788764178753
The modified gen p mean: 0.4529294967651367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024545449763536453, decouple_loss:0.0011647879146039486
The modified gen p mean: 0.4501531720161438, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02671338990330696, decouple_loss:0.001196603523567319
Iteration: 5149, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491472542285919, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025988737121224403, decouple_loss:0.0011627053609117866
The modified gen p mean: 0.4484591484069824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025743866339325905, decouple_loss:0.0011240593157708645
The modified gen p mean: 0.44937267899513245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025930779054760933, decouple_loss:0.001145078451372683
Iteration: 5150, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44817620515823364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027508359402418137, decouple_loss:0.0011014565825462341
The modified gen p mean: 0.44853276014328003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026259614154696465, decouple_loss:0.001052858424372971
The modified gen p mean: 0.4495159089565277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02471853420138359, decouple_loss:0.0011110950727015734
2023-05-27 17:19:14 testing...
The modified gen p mean: 0.451962411403656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032595306634902954, decouple_loss:0.001303933560848236
The modified gen p mean: 0.4498150646686554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03273448720574379, decouple_loss:0.0013061080826446414
The modified gen p mean: 0.4514128565788269, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03407495841383934, decouple_loss:0.0013198714004829526
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03320041298866272, avg_mse: 0.04536467418074608
current test mse: 0.045365
Iteration: 5151, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4487743079662323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024671653285622597, decouple_loss:0.0010399448219686747
The modified gen p mean: 0.44656825065612793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02423803322017193, decouple_loss:0.0010989016154780984
The modified gen p mean: 0.4499594569206238, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026410739868879318, decouple_loss:0.0011340634664520621
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr_shift3.npz
NaN value num: 0
Iteration: 5152, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44284090399742126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02816503308713436, decouple_loss:0.0009809007169678807
The modified gen p mean: 0.4489222764968872, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44761529564857483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027014214545488358, decouple_loss:0.001129529788158834
loss_pred:0.02596118673682213, decouple_loss:0.001178145408630371
Iteration: 5153, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44463810324668884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027962297201156616, decouple_loss:0.0011577630648389459
The modified gen p mean: 0.4499819278717041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02786046825349331, decouple_loss:0.001132449833676219
The modified gen p mean: 0.4444485604763031, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026811594143509865, decouple_loss:0.0010820962488651276
Iteration: 5154, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508862793445587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026602566242218018, decouple_loss:0.00133042992092669
The modified gen p mean: 0.4451844096183777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02614591084420681, decouple_loss:0.0011507776798680425
The modified gen p mean: 0.44472718238830566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029219329357147217, decouple_loss:0.001152185956016183
Iteration: 5155, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45078524947166443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02725806087255478, decouple_loss:0.0012490079971030354
The modified gen p mean: 0.4501650631427765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02668606862425804, decouple_loss:0.0012517108116298914
The modified gen p mean: 0.44619324803352356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02803124114871025, decouple_loss:0.001182461273856461
Iteration: 5156, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44842562079429626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026920314878225327, decouple_loss:0.001050818245857954
The modified gen p mean: 0.4488247036933899, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028537336736917496, decouple_loss:0.001126489951275289
The modified gen p mean: 0.45470303297042847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026813017204403877, decouple_loss:0.0012530937092378736
Iteration: 5157, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45175033807754517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026518946513533592, decouple_loss:0.0010970169678330421
The modified gen p mean: 0.45486244559288025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02669491246342659, decouple_loss:0.0012334489729255438
The modified gen p mean: 0.4552331864833832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026467494666576385, decouple_loss:0.0011185858165845275
Iteration: 5158, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508203864097595, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026185527443885803, decouple_loss:0.0012837267713621259
The modified gen p mean: 0.4532971978187561, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027386540547013283, decouple_loss:0.0012787916930392385
The modified gen p mean: 0.45163100957870483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026793532073497772, decouple_loss:0.001244032522663474
Iteration: 5159, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4542645812034607, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0251675583422184, decouple_loss:0.001268174615688622
The modified gen p mean: 0.45259642601013184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025044256821274757, decouple_loss:0.001273005036637187
The modified gen p mean: 0.4519677758216858, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02560536563396454, decouple_loss:0.0013244915753602982
Iteration: 5160, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45591917634010315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02684236317873001, decouple_loss:0.0011224668705835938
The modified gen p mean: 0.4486164152622223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02640507183969021, decouple_loss:0.001239919918589294
The modified gen p mean: 0.4561178386211395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027403565123677254, decouple_loss:0.001159447943791747
2023-05-27 17:23:58 testing...
The modified gen p mean: 0.45181623101234436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032937053591012955, decouple_loss:0.0014549650950357318
The modified gen p mean: 0.4495846629142761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03329731896519661, decouple_loss:0.0014547022292390466
The modified gen p mean: 0.45137983560562134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03458602726459503, decouple_loss:0.001415207632817328
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03367888182401657, avg_mse: 0.04617609083652496
current test mse: 0.046176
Iteration: 5161, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469350278377533, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025344189256429672, decouple_loss:0.0011828785063698888
The modified gen p mean: 0.4482017159461975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025114314630627632, decouple_loss:0.0012572966516017914
The modified gen p mean: 0.4505061209201813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026458941400051117, decouple_loss:0.0011633047834038734
Iteration: 5162, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4508853256702423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026272008195519447, decouple_loss:0.0013487967662513256
The modified gen p mean: 0.4434690475463867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026676872745156288, decouple_loss:0.0011900298995897174
The modified gen p mean: 0.4438588619232178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025850443169474602, decouple_loss:0.0011251696851104498
Iteration: 5163, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4433681070804596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026233825832605362, decouple_loss:0.0012793813366442919
The modified gen p mean: 0.44124165177345276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02720431238412857, decouple_loss:0.0012102682376280427
The modified gen p mean: 0.4409841299057007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02679252065718174, decouple_loss:0.0012310676975175738
Iteration: 5164, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44502875208854675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027514111250638962, decouple_loss:0.0013078410411253572
The modified gen p mean: 0.4439041316509247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026073001325130463, decouple_loss:0.0011616316623985767
The modified gen p mean: 0.44333529472351074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026961350813508034, decouple_loss:0.0013203449780121446
Iteration: 5165, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447933554649353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026956185698509216, decouple_loss:0.001240394776687026
The modified gen p mean: 0.4481419622898102, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026598505675792694, decouple_loss:0.0012700047809630632
The modified gen p mean: 0.4442524313926697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025310266762971878, decouple_loss:0.0012853192165493965
Iteration: 5166, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44625699520111084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02705994062125683, decouple_loss:0.0010682117426767945
The modified gen p mean: 0.4494191110134125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024846045300364494, decouple_loss:0.001222624210640788
The modified gen p mean: 0.4501647651195526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027628285810351372, decouple_loss:0.0013533949386328459
Iteration: 5167, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477255046367645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026681164279580116, decouple_loss:0.001119163236580789
The modified gen p mean: 0.45014119148254395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02751265838742256, decouple_loss:0.0012713547330349684
The modified gen p mean: 0.4515855312347412, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02587013691663742, decouple_loss:0.001195624703541398
Iteration: 5168, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470157325267792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028581198304891586, decouple_loss:0.0012008891208097339
The modified gen p mean: 0.44817647337913513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02692391537129879, decouple_loss:0.0013334373943507671
The modified gen p mean: 0.4485582113265991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02629156783223152, decouple_loss:0.0011378696653991938
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr.npz
NaN value num: 0
Iteration: 5169, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4546344578266144, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44799304008483887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024729236960411072, decouple_loss:0.0013613949995487928
The modified gen p mean: 0.4474523961544037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02682863362133503, decouple_loss:0.001102343201637268
loss_pred:0.02583407051861286, decouple_loss:0.0011443202383816242
Iteration: 5170, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45185452699661255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02567225508391857, decouple_loss:0.0012697904603555799
The modified gen p mean: 0.449591726064682, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02551436237990856, decouple_loss:0.0012364331632852554
The modified gen p mean: 0.450892835855484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026540305465459824, decouple_loss:0.0011210024822503328
2023-05-27 17:29:01 testing...
The modified gen p mean: 0.45414113998413086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03292170166969299, decouple_loss:0.0014223684556782246
The modified gen p mean: 0.4521007537841797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0331803523004055, decouple_loss:0.0014925699215382338
The modified gen p mean: 0.4535823166370392, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03466669097542763, decouple_loss:0.0013412847183644772
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03366052359342575, avg_mse: 0.04608427360653877
current test mse: 0.046084
Iteration: 5171, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44843289256095886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026384450495243073, decouple_loss:0.0011995484819635749
The modified gen p mean: 0.44773322343826294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026358408853411674, decouple_loss:0.0011808682465925813
The modified gen p mean: 0.4474506676197052, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027423450723290443, decouple_loss:0.0012575392611324787
Iteration: 5172, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459056854248047, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026979021728038788, decouple_loss:0.001192243187688291
The modified gen p mean: 0.4471184313297272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02702709473669529, decouple_loss:0.0012290553422644734
The modified gen p mean: 0.44783031940460205, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027343308553099632, decouple_loss:0.0011122553842142224
Iteration: 5173, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45252200961112976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02566424198448658, decouple_loss:0.001231541158631444
The modified gen p mean: 0.44952285289764404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025408921763300896, decouple_loss:0.00124654290266335
The modified gen p mean: 0.4469042122364044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027439868077635765, decouple_loss:0.0012144052889198065
Iteration: 5174, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44960877299308777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026077723130583763, decouple_loss:0.0011523200664669275
The modified gen p mean: 0.44690433144569397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025622501969337463, decouple_loss:0.0011440737871453166
The modified gen p mean: 0.44746118783950806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025265203788876534, decouple_loss:0.0011620698496699333
Iteration: 5175, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471583068370819, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02609725296497345, decouple_loss:0.0012672068551182747
The modified gen p mean: 0.4472019374370575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026312515139579773, decouple_loss:0.0011212005047127604
The modified gen p mean: 0.4462738335132599, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025981375947594643, decouple_loss:0.0011832283344119787
Iteration: 5176, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44838809967041016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025787966325879097, decouple_loss:0.0010237634414806962
The modified gen p mean: 0.45215046405792236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02461318112909794, decouple_loss:0.0010914694285020232
The modified gen p mean: 0.44669848680496216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026304643601179123, decouple_loss:0.0011286457302048802
Iteration: 5177, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45009279251098633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025666585192084312, decouple_loss:0.0011800593929365277
The modified gen p mean: 0.44973185658454895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025357674807310104, decouple_loss:0.0011405590921640396
The modified gen p mean: 0.44975727796554565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026210637763142586, decouple_loss:0.0010989548172801733
Iteration: 5178, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4485097825527191, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026827499270439148, decouple_loss:0.0012352478224784136
The modified gen p mean: 0.44941025972366333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02631845697760582, decouple_loss:0.001204495201818645
The modified gen p mean: 0.4509427845478058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02479781024158001, decouple_loss:0.0012847068719565868
Iteration: 5179, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44981226325035095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025994902476668358, decouple_loss:0.0011903158156201243
The modified gen p mean: 0.44849270582199097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026635028421878815, decouple_loss:0.0010339295258745551
The modified gen p mean: 0.45145824551582336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025583675131201744, decouple_loss:0.0012222229270264506
Iteration: 5180, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45019063353538513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025354400277137756, decouple_loss:0.0010885171359404922
The modified gen p mean: 0.4473613202571869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026181660592556, decouple_loss:0.0011343254009261727
The modified gen p mean: 0.446448415517807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026537014171481133, decouple_loss:0.0010810003150254488
2023-05-27 17:33:06 testing...
The modified gen p mean: 0.4525485634803772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03275127336382866, decouple_loss:0.0013281152350828052
The modified gen p mean: 0.45188188552856445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03445112332701683, decouple_loss:0.0012721676612272859
The modified gen p mean: 0.450339138507843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033065199851989746, decouple_loss:0.0012911747908219695
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03348739072680473, avg_mse: 0.045890793204307556
current test mse: 0.045891
Iteration: 5181, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44548776745796204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783025987446308, decouple_loss:0.0010970254661515355
The modified gen p mean: 0.4471360743045807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026781413704156876, decouple_loss:0.0010813444387167692
The modified gen p mean: 0.4505807161331177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02489614300429821, decouple_loss:0.0010889660334214568
Iteration: 5182, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510517418384552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025366285815835, decouple_loss:0.0011778452899307013
The modified gen p mean: 0.4464941620826721, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026006903499364853, decouple_loss:0.0010745422914624214
The modified gen p mean: 0.44696590304374695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024752818048000336, decouple_loss:0.0011041734833270311
Iteration: 5183, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44517579674720764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02609073929488659, decouple_loss:0.001077468041330576
The modified gen p mean: 0.4503372013568878, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025701627135276794, decouple_loss:0.0011044478742405772
The modified gen p mean: 0.44695040583610535, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025305310264229774, decouple_loss:0.001172621501609683
Iteration: 5184, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501383602619171, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025258896872401237, decouple_loss:0.0010494081070646644
The modified gen p mean: 0.44807255268096924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02492615208029747, decouple_loss:0.0011661285534501076
The modified gen p mean: 0.452833890914917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02420150116086006, decouple_loss:0.0011010796297341585
Iteration: 5185, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450473815202713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025670118629932404, decouple_loss:0.0010552993044257164
The modified gen p mean: 0.447976291179657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0259111225605011, decouple_loss:0.0011359176132827997
The modified gen p mean: 0.45310160517692566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024772783741354942, decouple_loss:0.001042837044224143
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr_shift3.npz
NaN value num: 0
Iteration: 5186, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44688478112220764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02711299993097782, decouple_loss:0.0010470717679709196
The modified gen p mean: 0.4482530951499939, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44707560539245605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0263086948543787, decouple_loss:0.0011357407784089446
loss_pred:0.02891530469059944, decouple_loss:0.0010603518458083272
Iteration: 5187, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491870105266571, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025898192077875137, decouple_loss:0.0012409472838044167
The modified gen p mean: 0.44794365763664246, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025834383442997932, decouple_loss:0.0010149040026590228
The modified gen p mean: 0.4488391578197479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027650723233819008, decouple_loss:0.0011513395002111793
Iteration: 5188, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44856441020965576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027680369094014168, decouple_loss:0.0011910097673535347
The modified gen p mean: 0.4474193751811981, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027304837480187416, decouple_loss:0.0012258414644747972
The modified gen p mean: 0.44885703921318054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02800547145307064, decouple_loss:0.0010876141022890806
Iteration: 5189, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44597214460372925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026507191359996796, decouple_loss:0.0010335940169170499
The modified gen p mean: 0.445919394493103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02869807742536068, decouple_loss:0.001158913946710527
The modified gen p mean: 0.44956275820732117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026098081842064857, decouple_loss:0.0011042682453989983
Iteration: 5190, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44835948944091797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026445718482136726, decouple_loss:0.00106676178984344
The modified gen p mean: 0.4521935284137726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025086335837841034, decouple_loss:0.0012336501386016607
The modified gen p mean: 0.45085757970809937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024884674698114395, decouple_loss:0.0012007351033389568
2023-05-27 17:37:46 testing...
The modified gen p mean: 0.4533711373806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03247826173901558, decouple_loss:0.001329496968537569
The modified gen p mean: 0.4509132206439972, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03292154520750046, decouple_loss:0.0012930934317409992
The modified gen p mean: 0.4527687132358551, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03422253578901291, decouple_loss:0.0012904055183753371
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03327266499400139, avg_mse: 0.04553426429629326
current test mse: 0.045534
Iteration: 5191, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499172568321228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027703827247023582, decouple_loss:0.0011518275132402778
The modified gen p mean: 0.44779109954833984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027361128479242325, decouple_loss:0.001220658072270453
The modified gen p mean: 0.4483570158481598, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025992656126618385, decouple_loss:0.001097387634217739
Iteration: 5192, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471931457519531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026095760986208916, decouple_loss:0.0011792846489697695
The modified gen p mean: 0.44928622245788574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025567036122083664, decouple_loss:0.0011770540149882436
The modified gen p mean: 0.44465315341949463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02781856618821621, decouple_loss:0.00120529904961586
Iteration: 5193, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44413718581199646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025995030999183655, decouple_loss:0.0011099393013864756
The modified gen p mean: 0.4473140239715576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02586132474243641, decouple_loss:0.0012235110625624657
The modified gen p mean: 0.4456040561199188, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027301577851176262, decouple_loss:0.0011930294567719102
Iteration: 5194, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441545903682709, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028295131400227547, decouple_loss:0.0011308445828035474
The modified gen p mean: 0.44470101594924927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02704467810690403, decouple_loss:0.0011438466608524323
The modified gen p mean: 0.4470435082912445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02503642998635769, decouple_loss:0.0011810966534540057
Iteration: 5195, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44642120599746704, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02580903470516205, decouple_loss:0.00115179643034935
The modified gen p mean: 0.4451315402984619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025447864085435867, decouple_loss:0.0010970395524054766
The modified gen p mean: 0.4484354853630066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02541734278202057, decouple_loss:0.0012878819834440947
Iteration: 5196, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44777053594589233, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02569042332470417, decouple_loss:0.0011482073459774256
The modified gen p mean: 0.4462904930114746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027502361685037613, decouple_loss:0.0011975488159805536
The modified gen p mean: 0.4441075325012207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026935994625091553, decouple_loss:0.0011857793433591723
Iteration: 5197, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434051811695099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0271472055464983, decouple_loss:0.0011787314433604479
The modified gen p mean: 0.44371235370635986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02772812359035015, decouple_loss:0.0012682985980063677
The modified gen p mean: 0.44615787267684937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025158653035759926, decouple_loss:0.0012045465409755707
Iteration: 5198, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470919370651245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025266917422413826, decouple_loss:0.0012756920186802745
The modified gen p mean: 0.44530919194221497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026027550920844078, decouple_loss:0.0013558913487941027
The modified gen p mean: 0.4442198574542999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0273787472397089, decouple_loss:0.0011675013229250908
Iteration: 5199, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442926347255707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026237446814775467, decouple_loss:0.001183514017611742
The modified gen p mean: 0.4472918212413788, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02490132860839367, decouple_loss:0.0011667809449136257
The modified gen p mean: 0.44638097286224365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025362100452184677, decouple_loss:0.0011439044028520584
Iteration: 5200, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44926050305366516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025000067427754402, decouple_loss:0.0012123945634812117
The modified gen p mean: 0.4446812570095062, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026659345254302025, decouple_loss:0.0012358669191598892
The modified gen p mean: 0.445339560508728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024990379810333252, decouple_loss:0.001319564413279295
2023-05-27 17:41:53 testing...
The modified gen p mean: 0.451478511095047, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03268604353070259, decouple_loss:0.0014818808995187283
The modified gen p mean: 0.44901666045188904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03306470811367035, decouple_loss:0.0013939967611804605
The modified gen p mean: 0.45085063576698303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03433888405561447, decouple_loss:0.0014521320117637515
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03343534469604492, avg_mse: 0.04577358439564705
current test mse: 0.045774
Iteration: 5201, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44593510031700134, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025526726618409157, decouple_loss:0.0011627229396253824
The modified gen p mean: 0.44411391019821167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027591926977038383, decouple_loss:0.0011986313620582223
The modified gen p mean: 0.4457257091999054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025321384891867638, decouple_loss:0.0011636334238573909
Iteration: 5202, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4441467821598053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026841038838028908, decouple_loss:0.0011715993750840425
The modified gen p mean: 0.4494323432445526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026014424860477448, decouple_loss:0.0012841155985370278
The modified gen p mean: 0.4450250566005707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025561554357409477, decouple_loss:0.0011359488125890493
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr.npz
NaN value num: 0
Iteration: 5203, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448142945766449, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44818124175071716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026833655312657356, decouple_loss:0.0010795859852805734
loss_pred:0.025527851656079292, decouple_loss:0.0013527809642255306
The modified gen p mean: 0.4484778940677643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027493173256516457, decouple_loss:0.0012498375726863742
Iteration: 5204, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44938579201698303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02552531659603119, decouple_loss:0.001256170915439725
The modified gen p mean: 0.44732850790023804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027636924758553505, decouple_loss:0.0012887094635516405
The modified gen p mean: 0.4511609971523285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027808019891381264, decouple_loss:0.0011956196976825595
Iteration: 5205, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505370855331421, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02506287395954132, decouple_loss:0.0013080559438094497
The modified gen p mean: 0.45042094588279724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027578266337513924, decouple_loss:0.001271961722522974
The modified gen p mean: 0.4497053325176239, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025334397330880165, decouple_loss:0.0012931221863254905
Iteration: 5206, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45151928067207336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02554379589855671, decouple_loss:0.0012482911115512252
The modified gen p mean: 0.44965416193008423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02655111998319626, decouple_loss:0.0011323888320475817
The modified gen p mean: 0.4552048146724701, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026126254349946976, decouple_loss:0.0010862384224310517
Iteration: 5207, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4516628384590149, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025116033852100372, decouple_loss:0.0012819197727367282
The modified gen p mean: 0.45579203963279724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025717493146657944, decouple_loss:0.0012002990115433931
The modified gen p mean: 0.4504852890968323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024620087817311287, decouple_loss:0.0011421063682064414
Iteration: 5208, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503813683986664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026165790855884552, decouple_loss:0.0012346329167485237
The modified gen p mean: 0.4564526379108429, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02625386416912079, decouple_loss:0.0012084930203855038
The modified gen p mean: 0.4493904113769531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026220791041851044, decouple_loss:0.0011071715271100402
Iteration: 5209, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4474649429321289, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02609793096780777, decouple_loss:0.001073317020200193
The modified gen p mean: 0.4520977735519409, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02588029019534588, decouple_loss:0.0012585398508235812
The modified gen p mean: 0.4494044780731201, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026630355045199394, decouple_loss:0.0011888726148754358
Iteration: 5210, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4482124447822571, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027535196393728256, decouple_loss:0.0012783808633685112
The modified gen p mean: 0.44891324639320374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027275802567601204, decouple_loss:0.00118284544441849
The modified gen p mean: 0.4541880488395691, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025591842830181122, decouple_loss:0.0011937757954001427
2023-05-27 17:46:50 testing...
The modified gen p mean: 0.45493969321250916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03264997899532318, decouple_loss:0.001590573345310986
The modified gen p mean: 0.45254790782928467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03308350592851639, decouple_loss:0.0013763649621978402
The modified gen p mean: 0.45434820652008057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03439145162701607, decouple_loss:0.0015680327778682113
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03345056250691414, avg_mse: 0.045821309089660645
current test mse: 0.045821
Iteration: 5211, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44885754585266113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02608148381114006, decouple_loss:0.001208293135277927
The modified gen p mean: 0.4513784945011139, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025583356618881226, decouple_loss:0.001294027199037373
The modified gen p mean: 0.4485795795917511, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024100864306092262, decouple_loss:0.0011642902391031384
Iteration: 5212, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492224156856537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02643072046339512, decouple_loss:0.001262122648768127
The modified gen p mean: 0.45154085755348206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02706029638648033, decouple_loss:0.0011821715161204338
The modified gen p mean: 0.4522496163845062, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025742705911397934, decouple_loss:0.0013220750261098146
Iteration: 5213, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4539124369621277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02364240027964115, decouple_loss:0.0011547221802175045
The modified gen p mean: 0.44987282156944275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026356294751167297, decouple_loss:0.00109559774864465
The modified gen p mean: 0.4532983601093292, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02548196166753769, decouple_loss:0.001280205906368792
Iteration: 5214, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450985848903656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027127239853143692, decouple_loss:0.0012121754698455334
The modified gen p mean: 0.45322349667549133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0251355841755867, decouple_loss:0.0012417399557307363
The modified gen p mean: 0.44946378469467163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026223380118608475, decouple_loss:0.0011996006360277534
Iteration: 5215, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45165494084358215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027066633105278015, decouple_loss:0.0011337453033775091
The modified gen p mean: 0.4496016204357147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025795556604862213, decouple_loss:0.001127350376918912
The modified gen p mean: 0.45285099744796753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026312023401260376, decouple_loss:0.0012582446215674281
Iteration: 5216, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45477718114852905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02435997687280178, decouple_loss:0.0012147726956754923
The modified gen p mean: 0.45227113366127014, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02658950164914131, decouple_loss:0.0011512276250869036
The modified gen p mean: 0.45202067494392395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026400767266750336, decouple_loss:0.0012712102616205812
Iteration: 5217, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44966742396354675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027425648644566536, decouple_loss:0.0011045451974496245
The modified gen p mean: 0.4507530629634857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0262900423258543, decouple_loss:0.001070616184733808
The modified gen p mean: 0.45086488127708435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027270684018731117, decouple_loss:0.0011550927301868796
Iteration: 5218, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45290955901145935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025282874703407288, decouple_loss:0.0012660709908232093
The modified gen p mean: 0.4478904902935028, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025933589786291122, decouple_loss:0.0010323721216991544
The modified gen p mean: 0.4514523446559906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02640531212091446, decouple_loss:0.0012364713475108147
Iteration: 5219, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4491855204105377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025246256962418556, decouple_loss:0.0011416941415518522
The modified gen p mean: 0.44613221287727356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025858094915747643, decouple_loss:0.0011278731981292367
The modified gen p mean: 0.4457175135612488, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026489239186048508, decouple_loss:0.0011382254306226969
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr_shift3.npz
NaN value num: 0
Iteration: 5220, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44633156061172485, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44968706369400024, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028812266886234283, decouple_loss:0.0010658713290467858
The modified gen p mean: 0.4461047947406769, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02707747370004654, decouple_loss:0.001174025353975594
loss_pred:0.028300808742642403, decouple_loss:0.0010584027040749788
2023-05-27 17:51:33 testing...
The modified gen p mean: 0.45143136382102966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032590724527835846, decouple_loss:0.0013543893583118916
The modified gen p mean: 0.44902387261390686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03294823318719864, decouple_loss:0.0012983507476747036
The modified gen p mean: 0.45103853940963745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034295231103897095, decouple_loss:0.0013117467751726508
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03334413841366768, avg_mse: 0.04567296802997589
current test mse: 0.045673
Iteration: 5221, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460364282131195, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0291634239256382, decouple_loss:0.0011636445997282863
The modified gen p mean: 0.44742265343666077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028628233820199966, decouple_loss:0.0012394590303301811
The modified gen p mean: 0.4469197392463684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028393762186169624, decouple_loss:0.0010934937745332718
Iteration: 5222, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44878295063972473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028443576768040657, decouple_loss:0.0010980261722579598
The modified gen p mean: 0.44734713435173035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02961813472211361, decouple_loss:0.0011099770199507475
The modified gen p mean: 0.4470716416835785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02855702117085457, decouple_loss:0.0011476546060293913
Iteration: 5223, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.447086900472641, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0286281518638134, decouple_loss:0.0012066656490787864
The modified gen p mean: 0.4493255317211151, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027123481035232544, decouple_loss:0.0011506776791065931
The modified gen p mean: 0.44752511382102966, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028310075402259827, decouple_loss:0.001142186694778502
Iteration: 5224, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4470556378364563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027843253687024117, decouple_loss:0.0010995261836797
The modified gen p mean: 0.447875052690506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029852693900465965, decouple_loss:0.0011172961676493287
The modified gen p mean: 0.45206859707832336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027313480153679848, decouple_loss:0.001131162280216813
Iteration: 5225, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44573456048965454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027773909270763397, decouple_loss:0.0012014438398182392
The modified gen p mean: 0.45133885741233826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028203085064888, decouple_loss:0.001197237055748701
The modified gen p mean: 0.44987013936042786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027127886191010475, decouple_loss:0.0012323890114203095
Iteration: 5226, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4465637803077698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029090430587530136, decouple_loss:0.0012196928728371859
The modified gen p mean: 0.44571933150291443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02767866849899292, decouple_loss:0.0010667556198313832
The modified gen p mean: 0.4497944116592407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02857450395822525, decouple_loss:0.001184895052574575
Iteration: 5227, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44739606976509094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02893219329416752, decouple_loss:0.001112118479795754
The modified gen p mean: 0.4479540288448334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026477668434381485, decouple_loss:0.0011125252349302173
The modified gen p mean: 0.4485381543636322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027489127591252327, decouple_loss:0.001110978308133781
Iteration: 5228, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45180782675743103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027987394481897354, decouple_loss:0.0012082565808668733
The modified gen p mean: 0.44656261801719666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027210291475057602, decouple_loss:0.0012095252750441432
The modified gen p mean: 0.44943809509277344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028715213760733604, decouple_loss:0.0011700739851221442
Iteration: 5229, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44650301337242126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028472255915403366, decouple_loss:0.0010256037348881364
The modified gen p mean: 0.4534153938293457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027804933488368988, decouple_loss:0.001192845986224711
The modified gen p mean: 0.44833868741989136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027238493785262108, decouple_loss:0.0011822712840512395
Iteration: 5230, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460178017616272, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4479736387729645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02780451625585556, decouple_loss:0.0010994243202731013
loss_pred:0.028082340955734253, decouple_loss:0.0011984732700511813
The modified gen p mean: 0.45131391286849976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027496367692947388, decouple_loss:0.0012867288896813989
2023-05-27 17:55:39 testing...
The modified gen p mean: 0.4520348012447357, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254370763897896, decouple_loss:0.0014343668008223176
The modified gen p mean: 0.45176851749420166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03427516296505928, decouple_loss:0.0013978704810142517
The modified gen p mean: 0.4496711790561676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03296799212694168, decouple_loss:0.0013421165058389306
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03333186358213425, avg_mse: 0.04556542634963989
current test mse: 0.045565
Iteration: 5231, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44673672318458557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02867959812283516, decouple_loss:0.0011155604152008891
The modified gen p mean: 0.4465475082397461, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027956541627645493, decouple_loss:0.0012628453550860286
The modified gen p mean: 0.4491213858127594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02681780233979225, decouple_loss:0.0011827284470200539
Iteration: 5232, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44780176877975464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02743823640048504, decouple_loss:0.0011802047956734896
The modified gen p mean: 0.4488591253757477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027114760130643845, decouple_loss:0.0011667164508253336
The modified gen p mean: 0.4497467875480652, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028531862422823906, decouple_loss:0.0011288392124697566
Iteration: 5233, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45106273889541626, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4473949372768402, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027652505785226822, decouple_loss:0.0011380494106560946
loss_pred:0.0295413751155138, decouple_loss:0.001105022500269115
The modified gen p mean: 0.44902896881103516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029417742043733597, decouple_loss:0.0011090459302067757
Iteration: 5234, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44917795062065125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027488550171256065, decouple_loss:0.001164844841696322
The modified gen p mean: 0.4498054087162018, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02637082152068615, decouple_loss:0.0011522091226652265
The modified gen p mean: 0.45203378796577454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028249796479940414, decouple_loss:0.001067138509824872
Iteration: 5235, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451935738325119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02848782390356064, decouple_loss:0.001076424727216363
The modified gen p mean: 0.45248904824256897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027032604441046715, decouple_loss:0.0012850783532485366
The modified gen p mean: 0.4516393542289734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029680941253900528, decouple_loss:0.0012547675287351012
Iteration: 5236, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478038549423218, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029114745557308197, decouple_loss:0.0012005140306428075
The modified gen p mean: 0.448880136013031, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028340764343738556, decouple_loss:0.0013078371994197369
The modified gen p mean: 0.4500153064727783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02655799314379692, decouple_loss:0.001196177676320076
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr.npz
NaN value num: 0
Iteration: 5237, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44850897789001465, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026881368830800056, decouple_loss:0.0011940902331843972
The modified gen p mean: 0.4474204480648041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026412764564156532, decouple_loss:0.001149447401985526
The modified gen p mean: 0.448871910572052, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024329310283064842, decouple_loss:0.0011281492188572884
Iteration: 5238, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459070861339569, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4480699598789215, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02661929465830326, decouple_loss:0.0012348705204203725
loss_pred:0.026730598881840706, decouple_loss:0.001385877258144319
The modified gen p mean: 0.4443918466567993, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025770705193281174, decouple_loss:0.0012489386135712266
Iteration: 5239, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44875413179397583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02553870901465416, decouple_loss:0.0014698166633024812
The modified gen p mean: 0.44409728050231934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026513468474149704, decouple_loss:0.001210048678331077
The modified gen p mean: 0.44563528895378113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024323632940649986, decouple_loss:0.0011901898542419076
Iteration: 5240, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4437071681022644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0259958878159523, decouple_loss:0.0010694727534428239
The modified gen p mean: 0.4443075656890869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026700634509325027, decouple_loss:0.0012936854036524892
The modified gen p mean: 0.4453694820404053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025538722053170204, decouple_loss:0.0011796333128586411
2023-05-27 18:00:24 testing...
The modified gen p mean: 0.4497328996658325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261644393205643, decouple_loss:0.001447455259039998
The modified gen p mean: 0.44746676087379456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03301052376627922, decouple_loss:0.0013683059951290488
The modified gen p mean: 0.4493744969367981, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034322045743465424, decouple_loss:0.001378280925564468
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0333862379193306, avg_mse: 0.04566207900643349
current test mse: 0.045662
Iteration: 5241, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44764089584350586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025263220071792603, decouple_loss:0.0012317425571382046
The modified gen p mean: 0.446014404296875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026622692123055458, decouple_loss:0.0013090629363432527
The modified gen p mean: 0.44880637526512146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025603506714105606, decouple_loss:0.0012258327333256602
Iteration: 5242, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484241306781769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02479485236108303, decouple_loss:0.001172838150523603
The modified gen p mean: 0.4431876838207245, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026312390342354774, decouple_loss:0.0012174769071862102
The modified gen p mean: 0.4441301226615906, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02523135580122471, decouple_loss:0.00128697429317981
Iteration: 5243, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45064279437065125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02523854374885559, decouple_loss:0.0012395435478538275
The modified gen p mean: 0.4445141553878784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02573876827955246, decouple_loss:0.0013214302016422153
The modified gen p mean: 0.44693294167518616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025064710527658463, decouple_loss:0.0013469833647832274
Iteration: 5244, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483342468738556, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44618791341781616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025026097893714905, decouple_loss:0.0010491390712559223
loss_pred:0.026514165103435516, decouple_loss:0.001250991364941001
The modified gen p mean: 0.447123646736145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024467023089528084, decouple_loss:0.0012851828942075372
Iteration: 5245, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453667104244232, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026405490934848785, decouple_loss:0.0011549715418368578
The modified gen p mean: 0.44635578989982605, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02615095116198063, decouple_loss:0.0011204397305846214
The modified gen p mean: 0.45036113262176514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025537095963954926, decouple_loss:0.0012196123134344816
Iteration: 5246, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510749876499176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024930093437433243, decouple_loss:0.0011096663074567914
The modified gen p mean: 0.4518492817878723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026555374264717102, decouple_loss:0.0011559053091332316
The modified gen p mean: 0.45303964614868164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02367635816335678, decouple_loss:0.0012697061756625772
Iteration: 5247, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477667510509491, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44879207015037537, gen p mean: 0.0, mean p set: 0.448loss_pred:0.026494085788726807, decouple_loss:0.0011332595022395253
loss_pred:0.026609428226947784, decouple_loss:0.0011473260819911957
The modified gen p mean: 0.4541439414024353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024644307792186737, decouple_loss:0.00120215630158782
Iteration: 5248, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45042794942855835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026310963556170464, decouple_loss:0.0014852136373519897
The modified gen p mean: 0.44857850670814514, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025337612256407738, decouple_loss:0.0010828411905094981
The modified gen p mean: 0.45055651664733887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02439766749739647, decouple_loss:0.0013115080073475838
Iteration: 5249, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45063516497612, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024853333830833435, decouple_loss:0.0011995068052783608
The modified gen p mean: 0.45091545581817627, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024954305961728096, decouple_loss:0.001134891645051539
The modified gen p mean: 0.4502381980419159, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026450904086232185, decouple_loss:0.0011877305805683136
Iteration: 5250, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44729945063591003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02659154124557972, decouple_loss:0.0010998761281371117
The modified gen p mean: 0.4517688453197479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02435447834432125, decouple_loss:0.0012162886559963226
The modified gen p mean: 0.44584420323371887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025957679376006126, decouple_loss:0.0010271042119711637
2023-05-27 18:04:29 testing...
The modified gen p mean: 0.4515591263771057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03248831257224083, decouple_loss:0.0013884440995752811
The modified gen p mean: 0.4492607116699219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03298579901456833, decouple_loss:0.0012599288020282984
The modified gen p mean: 0.4511364698410034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0342743806540966, decouple_loss:0.0012786977458745241
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03331494703888893, avg_mse: 0.045624028891325
current test mse: 0.045624
Iteration: 5251, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484235346317291, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025179719552397728, decouple_loss:0.0010967155685648322
The modified gen p mean: 0.44491371512413025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024906987324357033, decouple_loss:0.001115027698688209
The modified gen p mean: 0.4492114186286926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02465086057782173, decouple_loss:0.0011662691831588745
Iteration: 5252, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4445666968822479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026283904910087585, decouple_loss:0.0012436893302947283
The modified gen p mean: 0.4441768229007721, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026605578139424324, decouple_loss:0.0011562153231352568
The modified gen p mean: 0.44832533597946167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026520483195781708, decouple_loss:0.0010831106919795275
Iteration: 5253, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.443510502576828, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025154586881399155, decouple_loss:0.0010481077479198575
The modified gen p mean: 0.4453226625919342, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024614622816443443, decouple_loss:0.0011381013318896294
The modified gen p mean: 0.4446009397506714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02662903629243374, decouple_loss:0.0010426834924146533
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr_shift3.npz
NaN value num: 0
Iteration: 5254, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44511184096336365, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44600552320480347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027357202023267746, decouple_loss:0.0012545910431072116
The modified gen p mean: 0.44606277346611023, gen p mean: 0.0, mean p set: 0.448loss_pred:0.028346793726086617, decouple_loss:0.001156406244263053
loss_pred:0.03014225699007511, decouple_loss:0.0011718787718564272
Iteration: 5255, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45098379254341125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029433300718665123, decouple_loss:0.001080986112356186
The modified gen p mean: 0.44830557703971863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028080308809876442, decouple_loss:0.001062616240233183
The modified gen p mean: 0.4466281533241272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02755444496870041, decouple_loss:0.0010595933999866247
Iteration: 5256, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501727521419525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027117252349853516, decouple_loss:0.0012333471095189452
The modified gen p mean: 0.45075857639312744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027974437922239304, decouple_loss:0.0012109243543818593
The modified gen p mean: 0.4503447413444519, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028732087463140488, decouple_loss:0.0012715396005660295
Iteration: 5257, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45236989855766296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028260715305805206, decouple_loss:0.0010733838425949216
The modified gen p mean: 0.4483398497104645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030469253659248352, decouple_loss:0.0010947943665087223
The modified gen p mean: 0.4522770643234253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02876092866063118, decouple_loss:0.001200348138809204
Iteration: 5258, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451640248298645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028643876314163208, decouple_loss:0.0010578235378488898
The modified gen p mean: 0.452851265668869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027623215690255165, decouple_loss:0.0011410713195800781
The modified gen p mean: 0.4504809081554413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02786932699382305, decouple_loss:0.0010980854276567698
Iteration: 5259, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4549329876899719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027227869257330894, decouple_loss:0.0011343678925186396
The modified gen p mean: 0.4543588161468506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029172208160161972, decouple_loss:0.0011153010418638587
The modified gen p mean: 0.4558369219303131, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028777211904525757, decouple_loss:0.0012216197792440653
Iteration: 5260, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534764289855957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027296841144561768, decouple_loss:0.0012141842162236571
The modified gen p mean: 0.45194211602211, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029116570949554443, decouple_loss:0.0011249450035393238
The modified gen p mean: 0.4520127773284912, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02779361419379711, decouple_loss:0.001077929395250976
2023-05-27 18:09:19 testing...
The modified gen p mean: 0.4545885920524597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03238258510828018, decouple_loss:0.0014723738422617316
The modified gen p mean: 0.4540966749191284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03414570540189743, decouple_loss:0.0013962972443550825
The modified gen p mean: 0.4520805776119232, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03285665437579155, decouple_loss:0.0013052212307229638
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033197879791259766, avg_mse: 0.0452510267496109
current test mse: 0.045251
Iteration: 5261, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44870293140411377, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028125930577516556, decouple_loss:0.0010927693219855428
The modified gen p mean: 0.4511297643184662, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029365621507167816, decouple_loss:0.0011523610446602106
The modified gen p mean: 0.4525180160999298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027588700875639915, decouple_loss:0.0011762306094169617
Iteration: 5262, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476531147956848, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02776290662586689, decouple_loss:0.0011008537840098143
The modified gen p mean: 0.44898104667663574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028890367597341537, decouple_loss:0.0011104780714958906
The modified gen p mean: 0.4466375708580017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02788408473134041, decouple_loss:0.001039368798956275
Iteration: 5263, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478667676448822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028241164982318878, decouple_loss:0.0012052989332005382
The modified gen p mean: 0.4465423822402954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02873966656625271, decouple_loss:0.0011077197268605232
The modified gen p mean: 0.4462487995624542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02742801606655121, decouple_loss:0.0011730599217116833
Iteration: 5264, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44992050528526306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028097281232476234, decouple_loss:0.0012222541263327003
The modified gen p mean: 0.4449487328529358, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028292139992117882, decouple_loss:0.0011106203310191631
The modified gen p mean: 0.4439333379268646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027987880632281303, decouple_loss:0.0010849344544112682
Iteration: 5265, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44611266255378723, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027623016387224197, decouple_loss:0.0011674599954858422
The modified gen p mean: 0.4456688165664673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027859320864081383, decouple_loss:0.0011165774194523692
The modified gen p mean: 0.4441441297531128, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028658755123615265, decouple_loss:0.0010918468469753861
Iteration: 5266, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497810900211334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02563399448990822, decouple_loss:0.001045196782797575
The modified gen p mean: 0.44667255878448486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029050303623080254, decouple_loss:0.0010705343447625637
The modified gen p mean: 0.44810888171195984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027057262137532234, decouple_loss:0.0012703250395134091
Iteration: 5267, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45096921920776367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02674342505633831, decouple_loss:0.0011390894651412964
The modified gen p mean: 0.4490131437778473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02893901988863945, decouple_loss:0.0011197167914360762
The modified gen p mean: 0.4450497329235077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028163092210888863, decouple_loss:0.0011343173682689667
Iteration: 5268, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4463691711425781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02822941541671753, decouple_loss:0.0011616152478381991
The modified gen p mean: 0.4468846619129181, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02916533499956131, decouple_loss:0.001143028261139989
The modified gen p mean: 0.45162737369537354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026608221232891083, decouple_loss:0.0010809660889208317
Iteration: 5269, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481397271156311, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028175149112939835, decouple_loss:0.0011343798832967877
The modified gen p mean: 0.45398905873298645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02931312657892704, decouple_loss:0.0010922371875494719
The modified gen p mean: 0.44922173023223877, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028811942785978317, decouple_loss:0.0012721387902274728
Iteration: 5270, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45364660024642944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026492629200220108, decouple_loss:0.0011431907769292593
The modified gen p mean: 0.45371413230895996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02841183915734291, decouple_loss:0.0012177241733297706
The modified gen p mean: 0.45248186588287354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028934074565768242, decouple_loss:0.001162616303190589
2023-05-27 18:13:25 testing...
The modified gen p mean: 0.4534667730331421, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032612044364213943, decouple_loss:0.00145675428211689
The modified gen p mean: 0.4527643322944641, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034281015396118164, decouple_loss:0.0014202797319740057
The modified gen p mean: 0.45092692971229553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033093225210905075, decouple_loss:0.0013295921962708235
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03339887410402298, avg_mse: 0.045606035739183426
current test mse: 0.045606
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr.npz
NaN value num: 0
Iteration: 5271, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44738972187042236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02494354546070099, decouple_loss:0.0011924331774935126
The modified gen p mean: 0.45074689388275146, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44964322447776794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024689266458153725, decouple_loss:0.0012991527328267694
loss_pred:0.027156805619597435, decouple_loss:0.0012842463329434395
Iteration: 5272, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461217224597931, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02635219693183899, decouple_loss:0.0012588711688295007
The modified gen p mean: 0.4487738311290741, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024912996217608452, decouple_loss:0.0012841600691899657
The modified gen p mean: 0.44683995842933655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026609865948557854, decouple_loss:0.0011768520344048738
Iteration: 5273, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44879159331321716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02453749068081379, decouple_loss:0.0011590337380766869
The modified gen p mean: 0.44427987933158875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02782755345106125, decouple_loss:0.001171840587630868
The modified gen p mean: 0.44564440846443176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02574167028069496, decouple_loss:0.0010922371875494719
Iteration: 5274, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466632306575775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026921017095446587, decouple_loss:0.001106284442357719
The modified gen p mean: 0.44785475730895996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026324769482016563, decouple_loss:0.001153370481915772
The modified gen p mean: 0.448294460773468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026567615568637848, decouple_loss:0.0012109900126233697
Iteration: 5275, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4469461143016815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024586984887719154, decouple_loss:0.001107290736399591
The modified gen p mean: 0.44561052322387695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027192238718271255, decouple_loss:0.0011515779187902808
The modified gen p mean: 0.44782984256744385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026991993188858032, decouple_loss:0.0011988467304036021
Iteration: 5276, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44523823261260986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02640952356159687, decouple_loss:0.0011934911599382758
The modified gen p mean: 0.44777488708496094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026793168857693672, decouple_loss:0.0010519707575440407
The modified gen p mean: 0.4470869302749634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02564752846956253, decouple_loss:0.0011567516485229135
Iteration: 5277, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44945237040519714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.023976221680641174, decouple_loss:0.0011756367748603225
The modified gen p mean: 0.4459036886692047, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026518013328313828, decouple_loss:0.0010970804141834378
The modified gen p mean: 0.4471617341041565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026827072724699974, decouple_loss:0.0011571600334718823
Iteration: 5278, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459594190120697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025594346225261688, decouple_loss:0.0010694765951484442
The modified gen p mean: 0.44733962416648865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024638570845127106, decouple_loss:0.0011017845245078206
The modified gen p mean: 0.44526177644729614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02633454091846943, decouple_loss:0.0013157568173483014
Iteration: 5279, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44637176394462585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025058139115571976, decouple_loss:0.0011774268932640553
The modified gen p mean: 0.44717997312545776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025012556463479996, decouple_loss:0.0011248522205278277
The modified gen p mean: 0.446259468793869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028212770819664, decouple_loss:0.0011056638322770596
Iteration: 5280, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44621437788009644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025008687749505043, decouple_loss:0.0010385469067841768
The modified gen p mean: 0.4470251798629761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025101998820900917, decouple_loss:0.0011608313070610166
The modified gen p mean: 0.4477137327194214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024952424690127373, decouple_loss:0.0011362532386556268
2023-05-27 18:18:23 testing...
The modified gen p mean: 0.45347896218299866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03254137188196182, decouple_loss:0.0014841355150565505
The modified gen p mean: 0.45109036564826965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03290687873959541, decouple_loss:0.0012409348273649812
The modified gen p mean: 0.45277726650238037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03413726016879082, decouple_loss:0.001355765271000564
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.0332631841301918, avg_mse: 0.04552619159221649
current test mse: 0.045526
Iteration: 5281, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4456040859222412, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0254338588565588, decouple_loss:0.0011178122367709875
The modified gen p mean: 0.4499768316745758, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025059325620532036, decouple_loss:0.0011370574356988072
The modified gen p mean: 0.45014870166778564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02521594986319542, decouple_loss:0.001101457397453487
Iteration: 5282, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44832295179367065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026392776519060135, decouple_loss:0.0011695855064317584
The modified gen p mean: 0.4493449330329895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024334149435162544, decouple_loss:0.0010640932014212012
The modified gen p mean: 0.4494682848453522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02473641000688076, decouple_loss:0.0011765927774831653
Iteration: 5283, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4483499526977539, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025373170152306557, decouple_loss:0.0011083431309089065
The modified gen p mean: 0.45021912455558777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0252457857131958, decouple_loss:0.0012002441799268126
The modified gen p mean: 0.45176705718040466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024563085287809372, decouple_loss:0.0012247621780261397
Iteration: 5284, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4493541121482849, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02687361277639866, decouple_loss:0.0011333776637911797
The modified gen p mean: 0.4506482779979706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024681907147169113, decouple_loss:0.001022276934236288
The modified gen p mean: 0.4469674825668335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02717302180826664, decouple_loss:0.001072156010195613
Iteration: 5285, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44733962416648865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026966342702507973, decouple_loss:0.0011927398154512048
The modified gen p mean: 0.450655072927475, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024877116084098816, decouple_loss:0.0011319522745907307
The modified gen p mean: 0.4481915533542633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024977851659059525, decouple_loss:0.0010510347783565521
Iteration: 5286, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44715115427970886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02634243853390217, decouple_loss:0.001122744637541473
The modified gen p mean: 0.4487527310848236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02392813004553318, decouple_loss:0.0011474548373371363
The modified gen p mean: 0.4459870159626007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024720409885048866, decouple_loss:0.0010954170720651746
Iteration: 5287, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4455241560935974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02593434602022171, decouple_loss:0.0011251994874328375
The modified gen p mean: 0.4443078637123108, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02737574651837349, decouple_loss:0.0010672734351828694
The modified gen p mean: 0.4471200108528137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02542770281434059, decouple_loss:0.0012953340774402022
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr.npz
NaN value num: 0
Iteration: 5288, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478028416633606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027923529967665672, decouple_loss:0.0010868699755519629
The modified gen p mean: 0.444873571395874, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44505688548088074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02843707986176014, decouple_loss:0.0011590233771130443
loss_pred:0.02822457253932953, decouple_loss:0.0010993106989189982
Iteration: 5289, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4486767053604126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02685989812016487, decouple_loss:0.0011971697676926851
The modified gen p mean: 0.44490742683410645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02873801812529564, decouple_loss:0.0011225823545828462
The modified gen p mean: 0.44461989402770996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028031645342707634, decouple_loss:0.001083982759155333
Iteration: 5290, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4477611482143402, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027031952515244484, decouple_loss:0.0011188475182279944
The modified gen p mean: 0.4489407241344452, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02907153218984604, decouple_loss:0.001309391693212092
The modified gen p mean: 0.4482407867908478, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026405543088912964, decouple_loss:0.0011865036794915795
2023-05-27 18:23:07 testing...
The modified gen p mean: 0.45428675413131714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03230227902531624, decouple_loss:0.001366698881611228
The modified gen p mean: 0.4520469009876251, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03276104852557182, decouple_loss:0.001214930904097855
The modified gen p mean: 0.4537302255630493, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03395300358533859, decouple_loss:0.0012819386320188642
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03306984156370163, avg_mse: 0.04513735696673393
current test mse: 0.045137
Iteration: 5291, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44716569781303406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028404081240296364, decouple_loss:0.0010460682678967714
The modified gen p mean: 0.454592227935791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027071665972471237, decouple_loss:0.0011226605856791139
The modified gen p mean: 0.45002198219299316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026955652981996536, decouple_loss:0.0012524339836090803
Iteration: 5292, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45045897364616394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02821327932178974, decouple_loss:0.0011383017990738153
The modified gen p mean: 0.45380422472953796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690170332789421, decouple_loss:0.0011795463506132364
The modified gen p mean: 0.4493080675601959, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029299378395080566, decouple_loss:0.0011104021687060595
Iteration: 5293, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.454020231962204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028293099254369736, decouple_loss:0.001161048305220902
The modified gen p mean: 0.453380823135376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028408076614141464, decouple_loss:0.0013020576443523169
The modified gen p mean: 0.4544684588909149, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02736584097146988, decouple_loss:0.0011494482168927789
Iteration: 5294, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4543812870979309, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028139878064393997, decouple_loss:0.0012424449669197202
The modified gen p mean: 0.45369985699653625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027885934337973595, decouple_loss:0.0011403383687138557
The modified gen p mean: 0.45396533608436584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027938611805438995, decouple_loss:0.0011467162985354662
Iteration: 5295, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4563177525997162, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027834322303533554, decouple_loss:0.0012235587928444147
The modified gen p mean: 0.454773485660553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0281713604927063, decouple_loss:0.0010355167323723435
The modified gen p mean: 0.45403972268104553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02656172588467598, decouple_loss:0.0011745004449039698
Iteration: 5296, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4556123912334442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02582298219203949, decouple_loss:0.001077603898011148
The modified gen p mean: 0.45530810952186584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028170980513095856, decouple_loss:0.0011944281868636608
The modified gen p mean: 0.4568706750869751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026705773547291756, decouple_loss:0.0011391754960641265
Iteration: 5297, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500419795513153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02702975645661354, decouple_loss:0.0012622312642633915
The modified gen p mean: 0.45032504200935364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027326909825205803, decouple_loss:0.001177918747998774
The modified gen p mean: 0.44946548342704773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027966078370809555, decouple_loss:0.001139179919846356
Iteration: 5298, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478762149810791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025710560381412506, decouple_loss:0.0011307501699775457
The modified gen p mean: 0.44523006677627563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02932971529662609, decouple_loss:0.0011949439067393541
The modified gen p mean: 0.4485051929950714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026987537741661072, decouple_loss:0.0011934806825593114
Iteration: 5299, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466417133808136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027764474973082542, decouple_loss:0.001157652703113854
The modified gen p mean: 0.4461304843425751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0273277685046196, decouple_loss:0.0011393314925953746
The modified gen p mean: 0.4413571059703827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028057759627699852, decouple_loss:0.0012422404251992702
Iteration: 5300, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4424506723880768, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02687099017202854, decouple_loss:0.0012002413859590888
The modified gen p mean: 0.44374486804008484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026682406663894653, decouple_loss:0.0012006200850009918
The modified gen p mean: 0.4429234564304352, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783915400505066, decouple_loss:0.001062424504198134
2023-05-27 18:27:15 testing...
The modified gen p mean: 0.4478591978549957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032525356858968735, decouple_loss:0.0013868090463802218
The modified gen p mean: 0.4454411268234253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033059436827898026, decouple_loss:0.0012396798701956868
The modified gen p mean: 0.44724318385124207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03402191773056984, decouple_loss:0.0013492563739418983
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03326850011944771, avg_mse: 0.04547504708170891
current test mse: 0.045475
Iteration: 5301, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44134238362312317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027598483487963676, decouple_loss:0.0010859731119126081
The modified gen p mean: 0.4439729154109955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026068033650517464, decouple_loss:0.0012110330862924457
The modified gen p mean: 0.4407510459423065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026675624772906303, decouple_loss:0.001122191664762795
Iteration: 5302, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4428305923938751, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027964763343334198, decouple_loss:0.0011429168516770005
The modified gen p mean: 0.44436824321746826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028134698048233986, decouple_loss:0.0012907745549455285
The modified gen p mean: 0.4436207115650177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0284013319760561, decouple_loss:0.001049492391757667
Iteration: 5303, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45064595341682434, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02659122459590435, decouple_loss:0.0012935589766129851
The modified gen p mean: 0.44820845127105713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026895388960838318, decouple_loss:0.001259540906175971
The modified gen p mean: 0.44622284173965454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027948014438152313, decouple_loss:0.0012127036461606622
Iteration: 5304, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4496094286441803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028233347460627556, decouple_loss:0.0012449052883312106
The modified gen p mean: 0.45264747738838196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02900136262178421, decouple_loss:0.0012677250197157264
The modified gen p mean: 0.44757089018821716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028220243752002716, decouple_loss:0.0011774369049817324
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr_shift3.npz
NaN value num: 0
Iteration: 5305, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44987940788269043, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4536571800708771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029315494000911713, decouple_loss:0.0012842949945479631
loss_pred:0.02864064835011959, decouple_loss:0.0011186620686203241
The modified gen p mean: 0.45083653926849365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02780795656144619, decouple_loss:0.0010700378334149718
Iteration: 5306, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45225048065185547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028955215588212013, decouple_loss:0.0010655560763552785
The modified gen p mean: 0.4539332687854767, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02843848243355751, decouple_loss:0.0012574794236570597
The modified gen p mean: 0.45200636982917786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027498438954353333, decouple_loss:0.0011741513153538108
Iteration: 5307, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45557013154029846, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028448838740587234, decouple_loss:0.0012069937074556947
The modified gen p mean: 0.4558680057525635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027428124099969864, decouple_loss:0.0011766469106078148
The modified gen p mean: 0.4532489478588104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028699291869997978, decouple_loss:0.0011889827437698841
Iteration: 5308, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45141494274139404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028103459626436234, decouple_loss:0.001015891321003437
The modified gen p mean: 0.45035287737846375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027529286220669746, decouple_loss:0.001054646447300911
The modified gen p mean: 0.4524765610694885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02781110443174839, decouple_loss:0.001183025073260069
Iteration: 5309, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44775062799453735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028409378603100777, decouple_loss:0.0011670473031699657
The modified gen p mean: 0.4522465467453003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0289267860352993, decouple_loss:0.0011521384585648775
The modified gen p mean: 0.45262014865875244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0286321472376585, decouple_loss:0.0011048407759517431
Iteration: 5310, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458085000514984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028442934155464172, decouple_loss:0.001168718095868826
The modified gen p mean: 0.45013710856437683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02835751697421074, decouple_loss:0.0011499832617118955
The modified gen p mean: 0.45067253708839417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027727151289582253, decouple_loss:0.0011792258592322469
2023-05-27 18:32:04 testing...
The modified gen p mean: 0.4483371675014496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03226780518889427, decouple_loss:0.001379632274620235
The modified gen p mean: 0.44608062505722046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032804738730192184, decouple_loss:0.0012875982793048024
The modified gen p mean: 0.44773533940315247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0339045524597168, decouple_loss:0.0013220467371866107
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03305885195732117, avg_mse: 0.04508877918124199
current test mse: 0.045089
Iteration: 5311, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4462473690509796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026981733739376068, decouple_loss:0.0011271692346781492
The modified gen p mean: 0.4430716335773468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02876230515539646, decouple_loss:0.0011898726224899292
The modified gen p mean: 0.44279634952545166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029715998098254204, decouple_loss:0.001161266933195293
Iteration: 5312, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44229617714881897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02876778319478035, decouple_loss:0.0012730361195281148
The modified gen p mean: 0.4406808316707611, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027869412675499916, decouple_loss:0.0011337230680510402
The modified gen p mean: 0.4464203715324402, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028936564922332764, decouple_loss:0.0011022717226296663
Iteration: 5313, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4415346086025238, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028245976194739342, decouple_loss:0.0011158165289089084
The modified gen p mean: 0.44144320487976074, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027502011507749557, decouple_loss:0.001112567842938006
The modified gen p mean: 0.44043707847595215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029443874955177307, decouple_loss:0.0011130367638543248
Iteration: 5314, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44722017645835876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02774891071021557, decouple_loss:0.0011225823545828462
The modified gen p mean: 0.4462710916996002, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027189459651708603, decouple_loss:0.0011664845515042543
The modified gen p mean: 0.4445517063140869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028910137712955475, decouple_loss:0.0011669768719002604
Iteration: 5315, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.450418621301651, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027182770892977715, decouple_loss:0.0011404622346162796
The modified gen p mean: 0.44654250144958496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027227189391851425, decouple_loss:0.001073398976586759
The modified gen p mean: 0.4449923634529114, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029204877093434334, decouple_loss:0.0010624326532706618
Iteration: 5316, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507547616958618, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0288865864276886, decouple_loss:0.0010853074491024017
The modified gen p mean: 0.4481334686279297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028940899297595024, decouple_loss:0.0011537236860021949
The modified gen p mean: 0.44819268584251404, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028648201376199722, decouple_loss:0.001119496300816536
Iteration: 5317, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4488503038883209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02864389307796955, decouple_loss:0.0011846680426970124
The modified gen p mean: 0.44864651560783386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028968973085284233, decouple_loss:0.0011258645681664348
The modified gen p mean: 0.45028743147850037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027832165360450745, decouple_loss:0.00116272724699229
Iteration: 5318, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4551410377025604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028356052935123444, decouple_loss:0.0011470525059849024
The modified gen p mean: 0.4527563750743866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02788248285651207, decouple_loss:0.001161054940894246
The modified gen p mean: 0.4511687159538269, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027778584510087967, decouple_loss:0.0011402752716094255
Iteration: 5319, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4549292027950287, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028254438191652298, decouple_loss:0.0012989710085093975
The modified gen p mean: 0.45486295223236084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029153775423765182, decouple_loss:0.0012412236537784338
The modified gen p mean: 0.4514726996421814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02821199595928192, decouple_loss:0.001114075304940343
Iteration: 5320, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4539552330970764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027185481041669846, decouple_loss:0.0012126779183745384
The modified gen p mean: 0.4508470594882965, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02901536226272583, decouple_loss:0.001179819810204208
The modified gen p mean: 0.45053282380104065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028757868334650993, decouple_loss:0.0010779252042993903
2023-05-27 18:36:11 testing...
The modified gen p mean: 0.45232540369033813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0324123241007328, decouple_loss:0.0014037559740245342
The modified gen p mean: 0.4501722455024719, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032899387180805206, decouple_loss:0.0013836947036907077
The modified gen p mean: 0.45175471901893616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03409017622470856, decouple_loss:0.0013505289098247886
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03320293128490448, avg_mse: 0.04529629647731781
current test mse: 0.045296
Iteration: 5321, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4497063457965851, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02655228227376938, decouple_loss:0.0011975832749158144
The modified gen p mean: 0.4504396617412567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028455644845962524, decouple_loss:0.0011965185403823853
The modified gen p mean: 0.44943010807037354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027436649426817894, decouple_loss:0.001095426152460277
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr_shift3.npz
NaN value num: 0
Iteration: 5322, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457363486289978, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02720055915415287, decouple_loss:0.00126848672516644
The modified gen p mean: 0.4435589015483856, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44723010063171387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02551085501909256, decouple_loss:0.0011681991163641214
loss_pred:0.02739385887980461, decouple_loss:0.00126021564938128
Iteration: 5323, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4444805085659027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026728913187980652, decouple_loss:0.0012355505023151636
The modified gen p mean: 0.44281038641929626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027251511812210083, decouple_loss:0.0011511847842484713
The modified gen p mean: 0.4411461651325226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025469068437814713, decouple_loss:0.0012914987746626139
Iteration: 5324, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4425131678581238, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024932406842708588, decouple_loss:0.0012147966772317886
The modified gen p mean: 0.4434783160686493, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025496583431959152, decouple_loss:0.0011486432049423456
The modified gen p mean: 0.4447535574436188, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025936424732208252, decouple_loss:0.0011129723861813545
Iteration: 5325, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44349128007888794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02566509135067463, decouple_loss:0.001150544616393745
The modified gen p mean: 0.4434329867362976, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025944678112864494, decouple_loss:0.001077926717698574
The modified gen p mean: 0.44146162271499634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02698710560798645, decouple_loss:0.0011187997879460454
Iteration: 5326, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44207412004470825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026026930660009384, decouple_loss:0.001087458455003798
The modified gen p mean: 0.4431455135345459, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025431765243411064, decouple_loss:0.0011657982831820846
The modified gen p mean: 0.4461020827293396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026752006262540817, decouple_loss:0.001266973209567368
Iteration: 5327, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4507787525653839, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02412017248570919, decouple_loss:0.0012403022265061736
The modified gen p mean: 0.44772204756736755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025070952251553535, decouple_loss:0.00124777527526021
The modified gen p mean: 0.4477926790714264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025451675057411194, decouple_loss:0.0010607137810438871
Iteration: 5328, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4478282928466797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024619728326797485, decouple_loss:0.001059112953953445
The modified gen p mean: 0.44658344984054565, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02725983038544655, decouple_loss:0.0011831128504127264
The modified gen p mean: 0.4514980912208557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024729661643505096, decouple_loss:0.0012760026147589087
Iteration: 5329, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4535427689552307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025742968544363976, decouple_loss:0.001170044532045722
The modified gen p mean: 0.4506727457046509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02671041153371334, decouple_loss:0.0011752728605642915
The modified gen p mean: 0.45143306255340576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024955229833722115, decouple_loss:0.0010758893331512809
Iteration: 5330, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44748395681381226, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02606457844376564, decouple_loss:0.0010912589496001601
The modified gen p mean: 0.4483485519886017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025902410969138145, decouple_loss:0.0010158662917092443
The modified gen p mean: 0.4502246379852295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02641383744776249, decouple_loss:0.00136101758107543
2023-05-27 18:40:58 testing...
The modified gen p mean: 0.45363959670066833, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03272351622581482, decouple_loss:0.0014710951363667846
The modified gen p mean: 0.45158281922340393, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4531295597553253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03304269164800644, decouple_loss:0.0013383268378674984
loss_pred:0.03454558923840523, decouple_loss:0.0014026211574673653
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033507466316223145, avg_mse: 0.04584488645195961
current test mse: 0.045845
Iteration: 5331, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44621923565864563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026504097506403923, decouple_loss:0.0011372470762580633
The modified gen p mean: 0.4503043591976166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02542058937251568, decouple_loss:0.0010711757931858301
The modified gen p mean: 0.4509449303150177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026923885568976402, decouple_loss:0.0011231431271880865
Iteration: 5332, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44667482376098633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026494622230529785, decouple_loss:0.0010021842317655683
The modified gen p mean: 0.44641876220703125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025576705113053322, decouple_loss:0.001046364544890821
The modified gen p mean: 0.45353710651397705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024747652933001518, decouple_loss:0.001221788115799427
Iteration: 5333, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44657209515571594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026594242081046104, decouple_loss:0.0011899273376911879
The modified gen p mean: 0.4457964301109314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02568071335554123, decouple_loss:0.001230822061188519
The modified gen p mean: 0.4469980299472809, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0265011265873909, decouple_loss:0.0011236465070396662
Iteration: 5334, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4513077735900879, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025579698383808136, decouple_loss:0.0011798989726230502
The modified gen p mean: 0.4460229277610779, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026119166985154152, decouple_loss:0.0010883654467761517
The modified gen p mean: 0.4509074091911316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02662002667784691, decouple_loss:0.0010427245870232582
Iteration: 5335, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45079243183135986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025506852194666862, decouple_loss:0.0013166682329028845
The modified gen p mean: 0.4488624632358551, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02444157935678959, decouple_loss:0.0011712661944329739
The modified gen p mean: 0.4519886374473572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024870846420526505, decouple_loss:0.0012224611127749085
Iteration: 5336, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44659116864204407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026896696537733078, decouple_loss:0.00103681196924299
The modified gen p mean: 0.4468787610530853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026711318641901016, decouple_loss:0.001144043984822929
The modified gen p mean: 0.4463483393192291, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02639412321150303, decouple_loss:0.0012001385912299156
Iteration: 5337, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466162919998169, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025556357577443123, decouple_loss:0.0011080001713708043
The modified gen p mean: 0.44803115725517273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025362398475408554, decouple_loss:0.001269541447982192
The modified gen p mean: 0.4460960030555725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026227779686450958, decouple_loss:0.0010951062431558967
Iteration: 5338, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44585782289505005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026541447266936302, decouple_loss:0.0011431070743128657
The modified gen p mean: 0.4511639475822449, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02562960609793663, decouple_loss:0.001191889401525259
The modified gen p mean: 0.4462549090385437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025747112929821014, decouple_loss:0.0010909636039286852
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr.npz
NaN value num: 0
Iteration: 5339, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44818660616874695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0254370030015707, decouple_loss:0.001240036217495799
The modified gen p mean: 0.446363240480423, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4448891282081604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02510468102991581, decouple_loss:0.0011481082765385509
loss_pred:0.02649291604757309, decouple_loss:0.0012218781048431993
Iteration: 5340, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44851863384246826, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025260504335165024, decouple_loss:0.0011562088038772345
The modified gen p mean: 0.44736331701278687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026261797174811363, decouple_loss:0.0011986314784735441
The modified gen p mean: 0.4451082646846771, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025302063673734665, decouple_loss:0.0012255128240212798
2023-05-27 18:45:46 testing...
The modified gen p mean: 0.4490826427936554, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03278956934809685, decouple_loss:0.0014354160521179438
The modified gen p mean: 0.44867536425590515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034480202943086624, decouple_loss:0.0014053022023290396
The modified gen p mean: 0.44722577929496765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03311692550778389, decouple_loss:0.0013210783945396543
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03353159874677658, avg_mse: 0.04590432718396187
current test mse: 0.045904
Iteration: 5341, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4431608319282532, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026478655636310577, decouple_loss:0.0010712228249758482
The modified gen p mean: 0.44423457980155945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025091523304581642, decouple_loss:0.0012443620944395661
The modified gen p mean: 0.44083794951438904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027456816285848618, decouple_loss:0.0010260517010465264
Iteration: 5342, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467245936393738, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025866568088531494, decouple_loss:0.0012955446727573872
The modified gen p mean: 0.4431830942630768, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026877276599407196, decouple_loss:0.0011550643248483539
The modified gen p mean: 0.44152671098709106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027285676449537277, decouple_loss:0.001137257437221706
Iteration: 5343, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44093987345695496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025345217436552048, decouple_loss:0.0012218388728797436
The modified gen p mean: 0.44493648409843445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0259384885430336, decouple_loss:0.0012467113556340337
The modified gen p mean: 0.4426465630531311, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025768613442778587, decouple_loss:0.0012104952475056052
Iteration: 5344, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44269976019859314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025021664798259735, decouple_loss:0.0012954972917214036
The modified gen p mean: 0.44510969519615173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02541659213602543, decouple_loss:0.0011845934204757214
The modified gen p mean: 0.4433259665966034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027341898530721664, decouple_loss:0.0011579395504668355
Iteration: 5345, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44213294982910156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02729884907603264, decouple_loss:0.0011909391032531857
The modified gen p mean: 0.4430607259273529, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025739630684256554, decouple_loss:0.0011719150934368372
The modified gen p mean: 0.4446619153022766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0245813000947237, decouple_loss:0.0012261192314326763
Iteration: 5346, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44514167308807373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027051657438278198, decouple_loss:0.0012031232472509146
The modified gen p mean: 0.4489687979221344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025238005444407463, decouple_loss:0.0011755406158044934
The modified gen p mean: 0.44517844915390015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026572441682219505, decouple_loss:0.00134480488486588
Iteration: 5347, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498417377471924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02467949315905571, decouple_loss:0.0011727106757462025
The modified gen p mean: 0.4471184015274048, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024850724264979362, decouple_loss:0.0012672586599364877
The modified gen p mean: 0.4445117712020874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027034396305680275, decouple_loss:0.00133835943415761
Iteration: 5348, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481295347213745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025019817054271698, decouple_loss:0.0011708886595442891
The modified gen p mean: 0.4457910358905792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026655614376068115, decouple_loss:0.0011980659328401089
The modified gen p mean: 0.448953241109848, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02595314010977745, decouple_loss:0.0011513124918565154
Iteration: 5349, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44789421558380127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027140315622091293, decouple_loss:0.001116175320930779
The modified gen p mean: 0.44945672154426575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024962347000837326, decouple_loss:0.0011411939049139619
The modified gen p mean: 0.44638678431510925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02518540993332863, decouple_loss:0.001083633629605174
Iteration: 5350, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472781717777252, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02688509039580822, decouple_loss:0.0009869009954854846
The modified gen p mean: 0.44762054085731506, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02706874907016754, decouple_loss:0.0011729435063898563
The modified gen p mean: 0.4458548426628113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026275575160980225, decouple_loss:0.001135929487645626
2023-05-27 18:49:54 testing...
The modified gen p mean: 0.4522206485271454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03261158615350723, decouple_loss:0.0015143824275583029
The modified gen p mean: 0.4502556622028351, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03294384479522705, decouple_loss:0.001330661354586482
The modified gen p mean: 0.4517399072647095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03436708822846413, decouple_loss:0.0014576954999938607
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033379219472408295, avg_mse: 0.045636992901563644
current test mse: 0.045637
Iteration: 5351, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44876164197921753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02524946816265583, decouple_loss:0.0011712209088727832
The modified gen p mean: 0.4481383264064789, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024480065330863, decouple_loss:0.0012517314171418548
The modified gen p mean: 0.44973209500312805, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025126684457063675, decouple_loss:0.0012315480271354318
Iteration: 5352, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454438090324402, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027054591104388237, decouple_loss:0.0010983793763443828
The modified gen p mean: 0.449072003364563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025296665728092194, decouple_loss:0.0011194009566679597
The modified gen p mean: 0.4456966817378998, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025316819548606873, decouple_loss:0.0011247305665165186
Iteration: 5353, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44516292214393616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026994792744517326, decouple_loss:0.001068830955773592
The modified gen p mean: 0.44394251704216003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02739100530743599, decouple_loss:0.0011490251636132598
The modified gen p mean: 0.44436565041542053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026865500956773758, decouple_loss:0.0010787518694996834
Iteration: 5354, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44290921092033386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02702736295759678, decouple_loss:0.0011945540318265557
The modified gen p mean: 0.44439277052879333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02568957582116127, decouple_loss:0.000993544701486826
The modified gen p mean: 0.4452223479747772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025218931958079338, decouple_loss:0.0011817984050139785
Iteration: 5355, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44074133038520813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027578230947256088, decouple_loss:0.0010788108920678496
The modified gen p mean: 0.4384581744670868, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027417216449975967, decouple_loss:0.0011134742526337504
The modified gen p mean: 0.4399665892124176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026493266224861145, decouple_loss:0.0010555643821135163
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr.npz
NaN value num: 0
Iteration: 5356, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4399925470352173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026170602068305016, decouple_loss:0.0011190914083272219
The modified gen p mean: 0.44006073474884033, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4437199532985687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025751443579792976, decouple_loss:0.0011048344895243645
loss_pred:0.025400159880518913, decouple_loss:0.0012203408405184746
Iteration: 5357, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4414392411708832, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026689529418945312, decouple_loss:0.0012863073498010635
The modified gen p mean: 0.443215012550354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027185656130313873, decouple_loss:0.0012378206010907888
The modified gen p mean: 0.4425549805164337, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025569837540388107, decouple_loss:0.0011535267112776637
Iteration: 5358, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44926658272743225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02483593486249447, decouple_loss:0.0012285890989005566
The modified gen p mean: 0.4431019723415375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02561311610043049, decouple_loss:0.0011185156181454659
The modified gen p mean: 0.4449136257171631, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025016289204359055, decouple_loss:0.0011167745105922222
Iteration: 5359, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44991710782051086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025283083319664, decouple_loss:0.0011638232972472906
The modified gen p mean: 0.4448569715023041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02739233337342739, decouple_loss:0.0011973074870184064
The modified gen p mean: 0.444161057472229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026136387139558792, decouple_loss:0.0010155977215617895
Iteration: 5360, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44703438878059387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02613147534430027, decouple_loss:0.0011748861288651824
The modified gen p mean: 0.4485931694507599, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02466472052037716, decouple_loss:0.0012030439684167504
The modified gen p mean: 0.4459269940853119, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02494749054312706, decouple_loss:0.0010234019719064236
2023-05-27 18:54:41 testing...
The modified gen p mean: 0.45488235354423523, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03257893770933151, decouple_loss:0.0014642991591244936
The modified gen p mean: 0.4543367028236389, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03450886905193329, decouple_loss:0.0014217091957107186
The modified gen p mean: 0.4526887834072113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03305337578058243, decouple_loss:0.0013016072334721684
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033450186252593994, avg_mse: 0.04585184529423714
current test mse: 0.045852
Iteration: 5361, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44794681668281555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026290444657206535, decouple_loss:0.0010789810912683606
The modified gen p mean: 0.4519183337688446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024583345279097557, decouple_loss:0.0012503676116466522
The modified gen p mean: 0.44762352108955383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025891181081533432, decouple_loss:0.0010154845658689737
Iteration: 5362, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44880837202072144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025944462046027184, decouple_loss:0.0010957615450024605
The modified gen p mean: 0.44855624437332153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02693355828523636, decouple_loss:0.001110691693611443
The modified gen p mean: 0.45081713795661926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025764573365449905, decouple_loss:0.0011744521325454116
Iteration: 5363, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44711461663246155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026439154520630836, decouple_loss:0.0010537025518715382
The modified gen p mean: 0.45082995295524597, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02481267601251602, decouple_loss:0.0012287854915484786
The modified gen p mean: 0.44879546761512756, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0258014053106308, decouple_loss:0.001179737038910389
Iteration: 5364, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44651007652282715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025553787127137184, decouple_loss:0.0010931240394711494
The modified gen p mean: 0.4464724659919739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02611014060676098, decouple_loss:0.0011544986627995968
The modified gen p mean: 0.44977036118507385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025014908984303474, decouple_loss:0.0010927895782515407
Iteration: 5365, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44647037982940674, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02720188908278942, decouple_loss:0.0011032242327928543
The modified gen p mean: 0.4516529440879822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024992046877741814, decouple_loss:0.0012193620204925537
The modified gen p mean: 0.44929584860801697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024809759110212326, decouple_loss:0.0011082584969699383
Iteration: 5366, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44291120767593384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025916818529367447, decouple_loss:0.001148087321780622
The modified gen p mean: 0.4464440941810608, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025231389328837395, decouple_loss:0.0011723027564585209
The modified gen p mean: 0.44693881273269653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024838652461767197, decouple_loss:0.0011183797614648938
Iteration: 5367, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4430052936077118, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025882737711071968, decouple_loss:0.0011108734179288149
The modified gen p mean: 0.44359925389289856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024838969111442566, decouple_loss:0.001197751727886498
The modified gen p mean: 0.4432491064071655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026235638186335564, decouple_loss:0.001089847064577043
Iteration: 5368, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4425985813140869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02554025501012802, decouple_loss:0.001010595471598208
The modified gen p mean: 0.4433499574661255, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02548159845173359, decouple_loss:0.0010528676211833954
The modified gen p mean: 0.4441254138946533, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025303414091467857, decouple_loss:0.0011388167040422559
Iteration: 5369, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.442082017660141, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02600191719830036, decouple_loss:0.001061192830093205
The modified gen p mean: 0.4453760087490082, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025443170219659805, decouple_loss:0.0011874205665662885
The modified gen p mean: 0.4465600252151489, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02465386874973774, decouple_loss:0.0011801481014117599
Iteration: 5370, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4454793632030487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02539808489382267, decouple_loss:0.0011087899329140782
The modified gen p mean: 0.44885656237602234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024925922974944115, decouple_loss:0.0011171496007591486
The modified gen p mean: 0.44773855805397034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024608667939901352, decouple_loss:0.001188834779895842
2023-05-27 18:58:49 testing...
The modified gen p mean: 0.45174944400787354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032502852380275726, decouple_loss:0.0014465120621025562
The modified gen p mean: 0.4512616991996765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03440388664603233, decouple_loss:0.0014588594203814864
The modified gen p mean: 0.44958436489105225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032982468605041504, decouple_loss:0.0012589198304340243
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03336580842733383, avg_mse: 0.04570208489894867
current test mse: 0.045702
Iteration: 5371, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44589391350746155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025718441233038902, decouple_loss:0.0012132303090766072
The modified gen p mean: 0.44740065932273865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024648750200867653, decouple_loss:0.001109249540604651
The modified gen p mean: 0.44371476769447327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025889713317155838, decouple_loss:0.0010996324708685279
Iteration: 5372, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44890809059143066, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02486712671816349, decouple_loss:0.0011511076008901
The modified gen p mean: 0.4456520080566406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02463778480887413, decouple_loss:0.001105920528061688
The modified gen p mean: 0.4461404085159302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02721499837934971, decouple_loss:0.0011002885876223445
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr.npz
NaN value num: 0
Iteration: 5373, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44658079743385315, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02634940855205059, decouple_loss:0.0010740985162556171
The modified gen p mean: 0.44997820258140564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026119330897927284, decouple_loss:0.001091205165721476
The modified gen p mean: 0.45162683725357056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02504907362163067, decouple_loss:0.0010630791075527668
Iteration: 5374, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4526616036891937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024067852646112442, decouple_loss:0.0011088228784501553
The modified gen p mean: 0.445995569229126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0261838436126709, decouple_loss:0.0010626961011439562
The modified gen p mean: 0.4464643895626068, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026637375354766846, decouple_loss:0.0011436303611844778
Iteration: 5375, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468427002429962, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026492483913898468, decouple_loss:0.0011491994373500347
The modified gen p mean: 0.4484550654888153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026039691641926765, decouple_loss:0.001188364578410983
The modified gen p mean: 0.44669631123542786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02673753723502159, decouple_loss:0.0012422435684129596
Iteration: 5376, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4510371685028076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025425003841519356, decouple_loss:0.0011782700894400477
The modified gen p mean: 0.45012614130973816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02464704029262066, decouple_loss:0.0010928077390417457
The modified gen p mean: 0.44716596603393555, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026726778596639633, decouple_loss:0.0010960795916616917
Iteration: 5377, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44644540548324585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026295829564332962, decouple_loss:0.001241439487785101
The modified gen p mean: 0.4469546377658844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026232628151774406, decouple_loss:0.0011187002528458834
The modified gen p mean: 0.4455144703388214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026444097980856895, decouple_loss:0.00108359195291996
Iteration: 5378, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4467807710170746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026571979746222496, decouple_loss:0.001159855630248785
The modified gen p mean: 0.4493175446987152, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02566687762737274, decouple_loss:0.0012165684020146728
The modified gen p mean: 0.4479430615901947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025569217279553413, decouple_loss:0.001193078001961112
Iteration: 5379, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4471350312232971, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026667870581150055, decouple_loss:0.0010273568332195282
The modified gen p mean: 0.451253205537796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02587394043803215, decouple_loss:0.001124624628573656
The modified gen p mean: 0.44726961851119995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027238497510552406, decouple_loss:0.0010600065579637885
Iteration: 5380, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4542408585548401, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024171046912670135, decouple_loss:0.0011078667594119906
The modified gen p mean: 0.4497774541378021, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0243588387966156, decouple_loss:0.0012263997923582792
The modified gen p mean: 0.4480408728122711, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026374340057373047, decouple_loss:0.0012006507022306323
2023-05-27 19:03:36 testing...
The modified gen p mean: 0.4550641179084778, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03245643898844719, decouple_loss:0.001431104727089405
The modified gen p mean: 0.45290255546569824, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4546757638454437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032901618629693985, decouple_loss:0.0012051992816850543
loss_pred:0.03433680161833763, decouple_loss:0.0014256761642172933
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03329932317137718, avg_mse: 0.0455973818898201
current test mse: 0.045597
Iteration: 5381, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45057469606399536, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02547895722091198, decouple_loss:0.0011081767734140158
The modified gen p mean: 0.45239174365997314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026071254163980484, decouple_loss:0.0012149311369284987
The modified gen p mean: 0.4510180354118347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02595749869942665, decouple_loss:0.0012020363938063383
Iteration: 5382, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45025938749313354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.023683777078986168, decouple_loss:0.001156134414486587
The modified gen p mean: 0.45064014196395874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025328101590275764, decouple_loss:0.0011268991511315107
The modified gen p mean: 0.4497816264629364, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0267135389149189, decouple_loss:0.0011225412599742413
Iteration: 5383, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45152172446250916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02507064864039421, decouple_loss:0.001145207672379911
The modified gen p mean: 0.4493614435195923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025709228590130806, decouple_loss:0.0012867056066170335
The modified gen p mean: 0.45292291045188904, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024697495624423027, decouple_loss:0.0011466388823464513
Iteration: 5384, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4506007134914398, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02528369426727295, decouple_loss:0.0011244621127843857
The modified gen p mean: 0.45011118054389954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024376561865210533, decouple_loss:0.001113241072744131
The modified gen p mean: 0.4494291841983795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02547776699066162, decouple_loss:0.0010971574811264873
Iteration: 5385, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4500758945941925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02519220858812332, decouple_loss:0.0012199863558635116
The modified gen p mean: 0.4490634799003601, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025184649974107742, decouple_loss:0.0011669025989249349
The modified gen p mean: 0.44636228680610657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02694309502840042, decouple_loss:0.0011971356580033898
Iteration: 5386, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.452411949634552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02420761249959469, decouple_loss:0.001053759129717946
The modified gen p mean: 0.44647300243377686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026559993624687195, decouple_loss:0.0010406563524156809
The modified gen p mean: 0.4464571177959442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026359770447015762, decouple_loss:0.0011406026314944029
Iteration: 5387, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44660964608192444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025836359709501266, decouple_loss:0.0011468615848571062
The modified gen p mean: 0.44866079092025757, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0256942231208086, decouple_loss:0.0011239309096708894
The modified gen p mean: 0.4456305205821991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.023739397525787354, decouple_loss:0.001107454183511436
Iteration: 5388, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44640764594078064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.023827966302633286, decouple_loss:0.0010923912050202489
The modified gen p mean: 0.44926121830940247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025406938046216965, decouple_loss:0.001100190682336688
The modified gen p mean: 0.4495999217033386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024839799851179123, decouple_loss:0.0011844526743516326
Iteration: 5389, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44759896397590637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02540794014930725, decouple_loss:0.0013325517065823078
The modified gen p mean: 0.4468700885772705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025913480669260025, decouple_loss:0.001138703664764762
The modified gen p mean: 0.44891175627708435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02554655447602272, decouple_loss:0.0012178870383650064
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr_shift3.npz
NaN value num: 0
Iteration: 5390, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45123979449272156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02690647542476654, decouple_loss:0.0010962046217173338
The modified gen p mean: 0.450918972492218, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0270682405680418, decouple_loss:0.001101390807889402
The modified gen p mean: 0.4480784833431244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028243429958820343, decouple_loss:0.0012833239743486047
2023-05-27 19:08:22 testing...
The modified gen p mean: 0.45350876450538635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03253805637359619, decouple_loss:0.0014361490029841661
The modified gen p mean: 0.4513832926750183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03306439146399498, decouple_loss:0.0012095124693587422
The modified gen p mean: 0.45315688848495483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03438280522823334, decouple_loss:0.0014201771700754762
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03339618444442749, avg_mse: 0.04579121246933937
current test mse: 0.045791
Iteration: 5391, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451272577047348, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02831999398767948, decouple_loss:0.0011596340918913484
The modified gen p mean: 0.45189517736434937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02515922673046589, decouple_loss:0.0012462654849514365
The modified gen p mean: 0.4509313106536865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02593531459569931, decouple_loss:0.0012479641009122133
Iteration: 5392, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476489722728729, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02845841832458973, decouple_loss:0.0012116916477680206
The modified gen p mean: 0.45262688398361206, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025944486260414124, decouple_loss:0.0011374304303899407
The modified gen p mean: 0.4533826410770416, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02680070511996746, decouple_loss:0.0012354912469163537
Iteration: 5393, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4534471333026886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027716990560293198, decouple_loss:0.0012096778955310583
The modified gen p mean: 0.450977087020874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02580719254910946, decouple_loss:0.0011269132373854518
The modified gen p mean: 0.45030975341796875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02719811536371708, decouple_loss:0.0012188168475404382
Iteration: 5394, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44733190536499023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027198264375329018, decouple_loss:0.001159305451437831
The modified gen p mean: 0.44727975130081177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026673799380660057, decouple_loss:0.0012322507100179791
The modified gen p mean: 0.4481830596923828, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026374641805887222, decouple_loss:0.0011642049066722393
Iteration: 5395, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445085734128952, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026001766324043274, decouple_loss:0.0010839093010872602
The modified gen p mean: 0.44359061121940613, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026658881455659866, decouple_loss:0.0011519930558279157
The modified gen p mean: 0.4480954110622406, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02553907223045826, decouple_loss:0.0011045600986108184
Iteration: 5396, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44646862149238586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025762980803847313, decouple_loss:0.001137679093517363
The modified gen p mean: 0.44699108600616455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026114940643310547, decouple_loss:0.0011877620127052069
The modified gen p mean: 0.4460342228412628, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028073212131857872, decouple_loss:0.0010876113083213568
Iteration: 5397, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.445461630821228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025848835706710815, decouple_loss:0.0011685610515996814
The modified gen p mean: 0.4444330334663391, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02671208418905735, decouple_loss:0.0011190071236342192
The modified gen p mean: 0.4455127418041229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02618652954697609, decouple_loss:0.001184737659059465
Iteration: 5398, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44316214323043823, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027071772143244743, decouple_loss:0.0011520176194608212
The modified gen p mean: 0.44555240869522095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027525372803211212, decouple_loss:0.0012685065157711506
The modified gen p mean: 0.44589853286743164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027516786009073257, decouple_loss:0.0011996915563941002
Iteration: 5399, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44427570700645447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025913022458553314, decouple_loss:0.001219043042510748
The modified gen p mean: 0.4399474561214447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02822846919298172, decouple_loss:0.001093110186047852
The modified gen p mean: 0.44166260957717896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02711988054215908, decouple_loss:0.0011679567396640778
Iteration: 5400, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44653868675231934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026254788041114807, decouple_loss:0.0012324501294642687
The modified gen p mean: 0.4457656443119049, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025702331215143204, decouple_loss:0.0012685924302786589
The modified gen p mean: 0.4437128007411957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025345411151647568, decouple_loss:0.001092978985980153
2023-05-27 19:12:31 testing...
The modified gen p mean: 0.44941771030426025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03293390944600105, decouple_loss:0.0014801539946347475
The modified gen p mean: 0.44904205203056335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0344729870557785, decouple_loss:0.0014251148095354438
The modified gen p mean: 0.44723570346832275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03324722498655319, decouple_loss:0.001436983933672309
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033623747527599335, avg_mse: 0.046032898128032684
current test mse: 0.046033
Iteration: 5401, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4438278377056122, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026319561526179314, decouple_loss:0.0011014984920620918
The modified gen p mean: 0.4471551775932312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02586612105369568, decouple_loss:0.0012929715448990464
The modified gen p mean: 0.44230931997299194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026599595323204994, decouple_loss:0.001135221216827631
Iteration: 5402, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44496604800224304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027967283502221107, decouple_loss:0.0012376089580357075
The modified gen p mean: 0.4495559334754944, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026204789057374, decouple_loss:0.001305966405197978
The modified gen p mean: 0.4494795501232147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027104219421744347, decouple_loss:0.0011835633777081966
Iteration: 5403, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44579771161079407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027096904814243317, decouple_loss:0.0011725940275937319
The modified gen p mean: 0.45052433013916016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025916194543242455, decouple_loss:0.001200509024783969
The modified gen p mean: 0.4463208317756653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02698051743209362, decouple_loss:0.0012055527186021209
Iteration: 5404, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489368796348572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02484283782541752, decouple_loss:0.00115288351662457
The modified gen p mean: 0.44654420018196106, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026340939104557037, decouple_loss:0.0010976727353408933
The modified gen p mean: 0.45024794340133667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0255726370960474, decouple_loss:0.0012626458192244172
Iteration: 5405, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45061346888542175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025257904082536697, decouple_loss:0.0012744157575070858
The modified gen p mean: 0.448443740606308, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025186939164996147, decouple_loss:0.001334776054136455
The modified gen p mean: 0.4497261047363281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02688559517264366, decouple_loss:0.001197200850583613
Iteration: 5406, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4479341208934784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027658801525831223, decouple_loss:0.0012518932344391942
The modified gen p mean: 0.44534462690353394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026125401258468628, decouple_loss:0.001141132554039359
The modified gen p mean: 0.44769611954689026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025659307837486267, decouple_loss:0.001136699691414833
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr.npz
NaN value num: 0
Iteration: 5407, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447372257709503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027623042464256287, decouple_loss:0.0011619024444371462
The modified gen p mean: 0.4448007643222809, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4451443552970886, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02669445425271988, decouple_loss:0.0012005280004814267
loss_pred:0.025513390079140663, decouple_loss:0.001190646318718791
Iteration: 5408, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458303153514862, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02692594937980175, decouple_loss:0.0011056449729949236
The modified gen p mean: 0.4457458555698395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024994628503918648, decouple_loss:0.001179112819954753
The modified gen p mean: 0.44663888216018677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025830429047346115, decouple_loss:0.0011342179495841265
Iteration: 5409, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44881677627563477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024765722453594208, decouple_loss:0.0011826192494481802
The modified gen p mean: 0.4494152069091797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025990717113018036, decouple_loss:0.0011865439591929317
The modified gen p mean: 0.44633883237838745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02595863863825798, decouple_loss:0.0011108840117231011
Iteration: 5410, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44679829478263855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024836618453264236, decouple_loss:0.001209481619298458
The modified gen p mean: 0.4469831585884094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025312980636954308, decouple_loss:0.001062676659785211
The modified gen p mean: 0.44971558451652527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024878105148673058, decouple_loss:0.0013472525170072913
2023-05-27 19:17:17 testing...
The modified gen p mean: 0.4538103938102722, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032938152551651, decouple_loss:0.0013955013127997518
The modified gen p mean: 0.45326942205429077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03451221436262131, decouple_loss:0.0013696225360035896
The modified gen p mean: 0.45170319080352783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03322215378284454, decouple_loss:0.0013736719265580177
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033626489341259, avg_mse: 0.04606666788458824
current test mse: 0.046067
Iteration: 5411, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4523078501224518, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024198725819587708, decouple_loss:0.0012566116638481617
The modified gen p mean: 0.45148247480392456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026355354115366936, decouple_loss:0.0011761689092963934
The modified gen p mean: 0.4479368329048157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025232365354895592, decouple_loss:0.0010867444798350334
Iteration: 5412, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4528583586215973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024746065959334373, decouple_loss:0.0011994503438472748
The modified gen p mean: 0.4521348178386688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02584826387465, decouple_loss:0.0011197561398148537
The modified gen p mean: 0.4471556544303894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026952771469950676, decouple_loss:0.0011840484803542495
Iteration: 5413, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45082372426986694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024932414293289185, decouple_loss:0.0011745637748390436
The modified gen p mean: 0.4497445821762085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025965295732021332, decouple_loss:0.0011961676646023989
The modified gen p mean: 0.4467795193195343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024480117484927177, decouple_loss:0.00105666380841285
Iteration: 5414, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519440829753876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02610466443002224, decouple_loss:0.001147985109128058
The modified gen p mean: 0.45054012537002563, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026257891207933426, decouple_loss:0.0011302665807306767
The modified gen p mean: 0.4464350938796997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025702405720949173, decouple_loss:0.001106001203879714
Iteration: 5415, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44839540123939514, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4460178017616272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024809233844280243, decouple_loss:0.0010585864074528217
loss_pred:0.026713071390986443, decouple_loss:0.0010684765875339508
The modified gen p mean: 0.450560986995697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025122279301285744, decouple_loss:0.0011476603103801608
Iteration: 5416, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44990065693855286, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024928955361247063, decouple_loss:0.0011329085100442171
The modified gen p mean: 0.44554978609085083, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027241887524724007, decouple_loss:0.0011381949298083782
The modified gen p mean: 0.4444027543067932, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02707003802061081, decouple_loss:0.0011348733678460121
Iteration: 5417, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44646090269088745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025637852028012276, decouple_loss:0.001050422666594386
The modified gen p mean: 0.44753947854042053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025185033679008484, decouple_loss:0.001070569735020399
The modified gen p mean: 0.44662702083587646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025509996339678764, decouple_loss:0.001087032724171877
Iteration: 5418, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44549593329429626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02455618791282177, decouple_loss:0.0010428954847157001
The modified gen p mean: 0.4464891850948334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02531394362449646, decouple_loss:0.0010767029598355293
The modified gen p mean: 0.44846320152282715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.023645102977752686, decouple_loss:0.0011749404948204756
Iteration: 5419, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466303586959839, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024226738139986992, decouple_loss:0.0011174003593623638
The modified gen p mean: 0.44475308060646057, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026067500934004784, decouple_loss:0.001182846026495099
The modified gen p mean: 0.4464292526245117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026408864185214043, decouple_loss:0.0011049072491005063
Iteration: 5420, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4453871548175812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026240337640047073, decouple_loss:0.0011545593151822686
The modified gen p mean: 0.44595572352409363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02606050670146942, decouple_loss:0.001044294098392129
The modified gen p mean: 0.44509291648864746, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.023740943521261215, decouple_loss:0.0010610551107674837
2023-05-27 19:21:26 testing...
The modified gen p mean: 0.45232194662094116, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03269759938120842, decouple_loss:0.0013574258191511035
The modified gen p mean: 0.4502066969871521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0329812653362751, decouple_loss:0.0013370647793635726
The modified gen p mean: 0.4517187774181366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03432076796889305, decouple_loss:0.0013258758699521422
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033400218933820724, avg_mse: 0.04573620855808258
current test mse: 0.045736
Iteration: 5421, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4476538598537445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024136750027537346, decouple_loss:0.0011619396973401308
The modified gen p mean: 0.4486769735813141, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026288926601409912, decouple_loss:0.0011655476409941912
The modified gen p mean: 0.4493418037891388, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026381472125649452, decouple_loss:0.001181323896162212
Iteration: 5422, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44892528653144836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02534358948469162, decouple_loss:0.0011340499622747302
The modified gen p mean: 0.447796493768692, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02517153136432171, decouple_loss:0.0011106544407084584
The modified gen p mean: 0.44569751620292664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02569047547876835, decouple_loss:0.0011365669779479504
Iteration: 5423, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466019868850708, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025808215141296387, decouple_loss:0.0010806680656969547
The modified gen p mean: 0.4472772479057312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025933321565389633, decouple_loss:0.001094599487259984
The modified gen p mean: 0.44950637221336365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025062810629606247, decouple_loss:0.001037005102261901
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr_shift3.npz
NaN value num: 0
Iteration: 5424, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45153680443763733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025249997153878212, decouple_loss:0.0012423823354765773
The modified gen p mean: 0.45063215494155884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025838728994131088, decouple_loss:0.0011218583676964045
The modified gen p mean: 0.44793692231178284, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026400025933980942, decouple_loss:0.001324334996752441
Iteration: 5425, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44732144474983215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026215719059109688, decouple_loss:0.0010348758660256863
The modified gen p mean: 0.44831016659736633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026003748178482056, decouple_loss:0.0010637992527335882
The modified gen p mean: 0.44704532623291016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026371195912361145, decouple_loss:0.0010586981661617756
Iteration: 5426, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4459344744682312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026788808405399323, decouple_loss:0.0010774279944598675
The modified gen p mean: 0.4524345099925995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025764290243387222, decouple_loss:0.0011571311624720693
The modified gen p mean: 0.4478459358215332, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026755191385746002, decouple_loss:0.001100890338420868
Iteration: 5427, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489165246486664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025084663182497025, decouple_loss:0.0011584804160520434
The modified gen p mean: 0.4491754472255707, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02685249224305153, decouple_loss:0.0012620792258530855
The modified gen p mean: 0.44662606716156006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02651866152882576, decouple_loss:0.001177499769255519
Iteration: 5428, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4503653645515442, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02458018809556961, decouple_loss:0.0012345007853582501
The modified gen p mean: 0.44945505261421204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.023972639814019203, decouple_loss:0.0012040211586281657
The modified gen p mean: 0.448574036359787, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027160415425896645, decouple_loss:0.0010655573569238186
Iteration: 5429, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4495844542980194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02493944950401783, decouple_loss:0.0011069494066759944
The modified gen p mean: 0.44761893153190613, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027036195620894432, decouple_loss:0.0011161229340359569
The modified gen p mean: 0.448165625333786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02757876366376877, decouple_loss:0.0010977220954373479
Iteration: 5430, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489321708679199, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02507157251238823, decouple_loss:0.0010987863643094897
The modified gen p mean: 0.45083439350128174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025020306929945946, decouple_loss:0.0011966293677687645
The modified gen p mean: 0.4460947513580322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025853261351585388, decouple_loss:0.0010969234863296151
2023-05-27 19:26:12 testing...
The modified gen p mean: 0.4533102512359619, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03281749039888382, decouple_loss:0.0013512327568605542
The modified gen p mean: 0.45091724395751953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03305864706635475, decouple_loss:0.0013352100504562259
The modified gen p mean: 0.45272746682167053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03442273288965225, decouple_loss:0.0013872928684577346
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033500853925943375, avg_mse: 0.04590514674782753
current test mse: 0.045905
Iteration: 5431, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4436952769756317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026827728375792503, decouple_loss:0.0012455438263714314
The modified gen p mean: 0.4466014802455902, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026674553751945496, decouple_loss:0.001170376199297607
The modified gen p mean: 0.4484104514122009, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024387158453464508, decouple_loss:0.0011771488934755325
Iteration: 5432, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4461086094379425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026981504634022713, decouple_loss:0.0011400403454899788
The modified gen p mean: 0.4510830044746399, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025985144078731537, decouple_loss:0.0011561127612367272
The modified gen p mean: 0.44377097487449646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026381202042102814, decouple_loss:0.001196454162709415
Iteration: 5433, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448716938495636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02557806670665741, decouple_loss:0.001180106308311224
The modified gen p mean: 0.44621554017066956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026439230889081955, decouple_loss:0.0010942680528387427
The modified gen p mean: 0.4460045397281647, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02577793411910534, decouple_loss:0.001260018558241427
Iteration: 5434, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472278952598572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026087358593940735, decouple_loss:0.0011478215456008911
The modified gen p mean: 0.44963502883911133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02497182786464691, decouple_loss:0.0010462830541655421
The modified gen p mean: 0.44735032320022583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02458599954843521, decouple_loss:0.0011801824439316988
Iteration: 5435, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4481177031993866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025522923097014427, decouple_loss:0.00115453009493649
The modified gen p mean: 0.4503401815891266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02475765161216259, decouple_loss:0.0011871070601046085
The modified gen p mean: 0.44637835025787354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02629346400499344, decouple_loss:0.0010858868481591344
Iteration: 5436, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4442319869995117, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026276234537363052, decouple_loss:0.0010574563639238477
The modified gen p mean: 0.4436074495315552, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027090752497315407, decouple_loss:0.0012040085857734084
The modified gen p mean: 0.4484572112560272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024615267291665077, decouple_loss:0.001318343449383974
Iteration: 5437, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4447349011898041, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0259731262922287, decouple_loss:0.0010833463165909052
The modified gen p mean: 0.44679465889930725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025914547964930534, decouple_loss:0.0012178695760667324
The modified gen p mean: 0.44742804765701294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025648092851042747, decouple_loss:0.001105329836718738
Iteration: 5438, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4457770586013794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025396838784217834, decouple_loss:0.001167827402241528
The modified gen p mean: 0.44896233081817627, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02439233660697937, decouple_loss:0.0012305497657507658
The modified gen p mean: 0.44992920756340027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024120721966028214, decouple_loss:0.001196514698676765
Iteration: 5439, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44972431659698486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025173652917146683, decouple_loss:0.0013494701124727726
The modified gen p mean: 0.44909778237342834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0252627432346344, decouple_loss:0.0012426910689100623
The modified gen p mean: 0.4453660845756531, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02689538337290287, decouple_loss:0.001177008030936122
Iteration: 5440, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44448497891426086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026611652225255966, decouple_loss:0.001122104818932712
The modified gen p mean: 0.4475959539413452, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025704793632030487, decouple_loss:0.001252123387530446
The modified gen p mean: 0.4507630467414856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025144536048173904, decouple_loss:0.0012568497331812978
2023-05-27 19:30:17 testing...
The modified gen p mean: 0.4531041085720062, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032895803451538086, decouple_loss:0.0014405151596292853
The modified gen p mean: 0.45074382424354553, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03323300555348396, decouple_loss:0.001334954402409494
The modified gen p mean: 0.45240432024002075, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034571800380945206, decouple_loss:0.0015353098278865218
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.033638715744018555, avg_mse: 0.046094827353954315
current test mse: 0.046095
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr_shift3.npz
NaN value num: 0
Iteration: 5441, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4472709894180298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027665726840496063, decouple_loss:0.0011201102752238512
The modified gen p mean: 0.4511890411376953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027503814548254013, decouple_loss:0.0012351054465398192
The modified gen p mean: 0.4482327401638031, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027981184422969818, decouple_loss:0.001213044859468937
Iteration: 5442, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4480915367603302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02917798049747944, decouple_loss:0.0012398301623761654
The modified gen p mean: 0.45035457611083984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029196722432971, decouple_loss:0.0011320235207676888
The modified gen p mean: 0.4521705210208893, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026653088629245758, decouple_loss:0.001164304674603045
Iteration: 5443, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4484770596027374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02834279276430607, decouple_loss:0.0013530603609979153
The modified gen p mean: 0.4517422020435333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029126780107617378, decouple_loss:0.0012874261010438204
The modified gen p mean: 0.4474072754383087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028538556769490242, decouple_loss:0.001185423694550991
Iteration: 5444, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44944527745246887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028066812083125114, decouple_loss:0.0011885317508131266
The modified gen p mean: 0.450977623462677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028069328516721725, decouple_loss:0.001272011548280716
The modified gen p mean: 0.451253205537796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029577406123280525, decouple_loss:0.0012528097722679377
Iteration: 5445, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4533555805683136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028675196692347527, decouple_loss:0.0011432062601670623
The modified gen p mean: 0.449876993894577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028281887993216515, decouple_loss:0.001217153389006853
The modified gen p mean: 0.45058104395866394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029303379356861115, decouple_loss:0.0012084590271115303
Iteration: 5446, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519536793231964, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4486607611179352, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027742184698581696, decouple_loss:0.0012245825491845608
loss_pred:0.028585104271769524, decouple_loss:0.0011450968449935317
The modified gen p mean: 0.4515117108821869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027216248214244843, decouple_loss:0.0012011375511065125
Iteration: 5447, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4494365155696869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783425711095333, decouple_loss:0.0013266743626445532
The modified gen p mean: 0.45096632838249207, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028109293431043625, decouple_loss:0.001301876618526876
The modified gen p mean: 0.44967037439346313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028558271005749702, decouple_loss:0.0013182322727516294
Iteration: 5448, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468761384487152, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02808394841849804, decouple_loss:0.0011155684478580952
The modified gen p mean: 0.45003753900527954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027385827153921127, decouple_loss:0.0013049416011199355
The modified gen p mean: 0.4473666548728943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028697438538074493, decouple_loss:0.001266183448024094
Iteration: 5449, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4499989449977875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027755629271268845, decouple_loss:0.0013107855338603258
The modified gen p mean: 0.4478291869163513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028426002711057663, decouple_loss:0.0012027510674670339
The modified gen p mean: 0.4459173083305359, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02922392450273037, decouple_loss:0.0011048057349398732
Iteration: 5450, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4450758099555969, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029341774061322212, decouple_loss:0.0010992035968229175
The modified gen p mean: 0.44794079661369324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027864230796694756, decouple_loss:0.0013321241131052375
The modified gen p mean: 0.44815438985824585, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02862323261797428, decouple_loss:0.0010208028834313154
2023-05-27 19:35:10 testing...
The modified gen p mean: 0.44933661818504333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.032691895961761475, decouple_loss:0.001470749732106924
The modified gen p mean: 0.44695183634757996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033086732029914856, decouple_loss:0.0014481345424428582
The modified gen p mean: 0.44849660992622375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03439312055706978, decouple_loss:0.0014236461138352752
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03346296027302742, avg_mse: 0.04575441777706146
current test mse: 0.045754
Iteration: 5451, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4435540735721588, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02955343946814537, decouple_loss:0.001103070331737399
The modified gen p mean: 0.44618600606918335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026873644441366196, decouple_loss:0.0012341956607997417
The modified gen p mean: 0.4445817768573761, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02928548865020275, decouple_loss:0.001094915671274066
Iteration: 5452, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4431980848312378, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03004876710474491, decouple_loss:0.001172876451164484
The modified gen p mean: 0.44679537415504456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02647317200899124, decouple_loss:0.0011836987687274814
The modified gen p mean: 0.4439969062805176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028979238122701645, decouple_loss:0.0011891113827005029
Iteration: 5453, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44827544689178467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028607409447431564, decouple_loss:0.0012046339688822627
The modified gen p mean: 0.44679510593414307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027401456609368324, decouple_loss:0.0011931959306821227
The modified gen p mean: 0.4450867474079132, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02854795753955841, decouple_loss:0.001243984093889594
Iteration: 5454, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44666406512260437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02824484556913376, decouple_loss:0.0012342265108600259
The modified gen p mean: 0.44710278511047363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028390513733029366, decouple_loss:0.0012932918034493923
The modified gen p mean: 0.44681864976882935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028092745691537857, decouple_loss:0.0011332747526466846
Iteration: 5455, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44773051142692566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.030401866883039474, decouple_loss:0.0013012189883738756
The modified gen p mean: 0.448171466588974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028004799038171768, decouple_loss:0.0011523476568982005
The modified gen p mean: 0.44878247380256653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028882579877972603, decouple_loss:0.0011486646253615618
Iteration: 5456, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45121315121650696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027541298419237137, decouple_loss:0.0012892605736851692
The modified gen p mean: 0.4530342221260071, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02771531417965889, decouple_loss:0.0013457241002470255
The modified gen p mean: 0.45288515090942383, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027853302657604218, decouple_loss:0.0012442510342225432
Iteration: 5457, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44846659898757935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028988169506192207, decouple_loss:0.0011939126998186111
The modified gen p mean: 0.4498123824596405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028105342760682106, decouple_loss:0.001102245645597577
The modified gen p mean: 0.4499529302120209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0289352685213089, decouple_loss:0.0012573980493471026
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr.npz
NaN value num: 0
Iteration: 5458, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4492025673389435, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03033621609210968, decouple_loss:0.001115139340981841
The modified gen p mean: 0.45016393065452576, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4487418830394745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029935454949736595, decouple_loss:0.0012637111358344555
loss_pred:0.02803594246506691, decouple_loss:0.0013288466725498438
Iteration: 5459, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45090535283088684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02782009355723858, decouple_loss:0.001255476730875671
The modified gen p mean: 0.4487899839878082, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028777165338397026, decouple_loss:0.0011673441622406244
The modified gen p mean: 0.45040708780288696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02995157428085804, decouple_loss:0.0012713554315268993
Iteration: 5460, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4498887360095978, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02885819412767887, decouple_loss:0.0011372495209798217
The modified gen p mean: 0.4494759142398834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02885165996849537, decouple_loss:0.0012233523884788156
The modified gen p mean: 0.44762927293777466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0291557889431715, decouple_loss:0.0011679820017889142
2023-05-27 19:39:56 testing...
The modified gen p mean: 0.45497018098831177, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03248024731874466, decouple_loss:0.0014321759808808565
The modified gen p mean: 0.45425453782081604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0343366414308548, decouple_loss:0.001347878249362111
The modified gen p mean: 0.4526556432247162, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.033023275434970856, decouple_loss:0.0014067310839891434
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03334983438253403, avg_mse: 0.0455855168402195
current test mse: 0.045586
Iteration: 5461, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4501815140247345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028543610125780106, decouple_loss:0.001202289597131312
The modified gen p mean: 0.45123469829559326, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02828982099890709, decouple_loss:0.0011544390581548214
The modified gen p mean: 0.45346006751060486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02836724743247032, decouple_loss:0.0012153058778494596
Iteration: 5462, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.451975017786026, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027851911261677742, decouple_loss:0.0012588270474225283
The modified gen p mean: 0.45179131627082825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02833964116871357, decouple_loss:0.001206127810291946
The modified gen p mean: 0.45257332921028137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026215512305498123, decouple_loss:0.0011218397412449121
Iteration: 5463, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4527283012866974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027963027358055115, decouple_loss:0.001239792793057859
The modified gen p mean: 0.4474746584892273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028191154822707176, decouple_loss:0.0011586316395550966
The modified gen p mean: 0.45142051577568054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02818545699119568, decouple_loss:0.0011563844745978713
Iteration: 5464, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45041561126708984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027752038091421127, decouple_loss:0.0013487779069691896
The modified gen p mean: 0.4481394290924072, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028403539210557938, decouple_loss:0.0011995014501735568
The modified gen p mean: 0.4500023126602173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02877706289291382, decouple_loss:0.00131358637008816
Iteration: 5465, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4468364119529724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029292955994606018, decouple_loss:0.00134554342366755
The modified gen p mean: 0.4469316303730011, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029675384983420372, decouple_loss:0.0012216741451993585
The modified gen p mean: 0.4517824947834015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026798179373145103, decouple_loss:0.0011731728445738554
Iteration: 5466, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44952160120010376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026500605046749115, decouple_loss:0.0011420282535254955
The modified gen p mean: 0.4472096562385559, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027007868513464928, decouple_loss:0.0012577360030263662
The modified gen p mean: 0.447424978017807, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028311647474765778, decouple_loss:0.0011779650812968612
Iteration: 5467, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489622414112091, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027254028245806694, decouple_loss:0.001326712896116078
The modified gen p mean: 0.44679543375968933, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02735527791082859, decouple_loss:0.0011909969616681337
The modified gen p mean: 0.4486027657985687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026914646849036217, decouple_loss:0.0012665776303038
Iteration: 5468, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44886475801467896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028945783153176308, decouple_loss:0.0011342595098540187
The modified gen p mean: 0.44403716921806335, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02859509550035, decouple_loss:0.001127256196923554
The modified gen p mean: 0.4452570080757141, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02881454862654209, decouple_loss:0.0012843562290072441
Iteration: 5469, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.448738694190979, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028822947293519974, decouple_loss:0.0011293927673250437
The modified gen p mean: 0.44901400804519653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027216041460633278, decouple_loss:0.0011201362358406186
The modified gen p mean: 0.44286903738975525, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028088092803955078, decouple_loss:0.0010792965767905116
Iteration: 5470, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4475955665111542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027065593749284744, decouple_loss:0.001157713937573135
The modified gen p mean: 0.44974085688591003, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027529248967766762, decouple_loss:0.001259631710126996
The modified gen p mean: 0.4471895098686218, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02783999778330326, decouple_loss:0.0011889062589034438
2023-05-27 19:44:02 testing...
The modified gen p mean: 0.4513137638568878, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03247959166765213, decouple_loss:0.0013894268777221441
The modified gen p mean: 0.4506210684776306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03437685966491699, decouple_loss:0.001317045302130282
The modified gen p mean: 0.44903764128685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03292882442474365, decouple_loss:0.001272920984774828
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03332808241248131, avg_mse: 0.045550912618637085
current test mse: 0.045551
Iteration: 5471, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44688934087753296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029994050040841103, decouple_loss:0.0011189073557034135
The modified gen p mean: 0.44665610790252686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028137002140283585, decouple_loss:0.0012418091064319015
The modified gen p mean: 0.4491316080093384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028979482129216194, decouple_loss:0.001251193112693727
Iteration: 5472, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4466879665851593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.029868699610233307, decouple_loss:0.001258973847143352
The modified gen p mean: 0.4495842456817627, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026988986879587173, decouple_loss:0.0011874819174408913
The modified gen p mean: 0.45119884610176086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027190381661057472, decouple_loss:0.001290653832256794
Iteration: 5473, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4525461196899414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02599099650979042, decouple_loss:0.0011931044282391667
The modified gen p mean: 0.44958436489105225, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027516687288880348, decouple_loss:0.0011716245207935572
The modified gen p mean: 0.4487537145614624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028373684734106064, decouple_loss:0.0011827804846689105
Iteration: 5474, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4489230811595917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028320061042904854, decouple_loss:0.001296516042202711
The modified gen p mean: 0.4520914554595947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027438074350357056, decouple_loss:0.001229837886057794
The modified gen p mean: 0.45004525780677795, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02709014154970646, decouple_loss:0.0012168018147349358
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr_shift3.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr_shift3.npz
NaN value num: 0
Iteration: 5475, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45029979944229126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027893641963601112, decouple_loss:0.0010906989919021726
The modified gen p mean: 0.4505472779273987, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.450092613697052, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028515959158539772, decouple_loss:0.001136111211962998
loss_pred:0.02582372911274433, decouple_loss:0.0011500067776069045
Iteration: 5476, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4505493640899658, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0257074274122715, decouple_loss:0.001248891232535243
The modified gen p mean: 0.45056185126304626, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025467514991760254, decouple_loss:0.001384233357384801
The modified gen p mean: 0.44956326484680176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.028163624927401543, decouple_loss:0.0011722375638782978
Iteration: 5477, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45311102271080017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027115296572446823, decouple_loss:0.0011817743070423603
The modified gen p mean: 0.4535289704799652, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0256387609988451, decouple_loss:0.0010317874839529395
The modified gen p mean: 0.44886696338653564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026682838797569275, decouple_loss:0.0010442708153277636
Iteration: 5478, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4504488408565521, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45072656869888306, gen p mean: 0.0, mean p set: 0.448loss_pred:0.02659592591226101, decouple_loss:0.0011386489495635033
loss_pred:0.027703432366251945, decouple_loss:0.001210819580592215
The modified gen p mean: 0.44745832681655884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027549179270863533, decouple_loss:0.001184294931590557
Iteration: 5479, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44762614369392395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026902776211500168, decouple_loss:0.001201434526592493
The modified gen p mean: 0.44823911786079407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02761351503431797, decouple_loss:0.0011932402849197388
The modified gen p mean: 0.4474236071109772, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027636457234621048, decouple_loss:0.0011494762729853392
Iteration: 5480, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4434691369533539, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026822460815310478, decouple_loss:0.0011684235651046038
The modified gen p mean: 0.446510374546051, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026180053129792213, decouple_loss:0.001205233740620315
The modified gen p mean: 0.4462908208370209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026608211919665337, decouple_loss:0.0012077828869223595
2023-05-27 19:48:55 testing...
The modified gen p mean: 0.45024001598358154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03272585570812225, decouple_loss:0.001440116437152028
The modified gen p mean: 0.44805654883384705, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44969484210014343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.03307705000042915, decouple_loss:0.0013047291431576014
loss_pred:0.03442090004682541, decouple_loss:0.0013847111258655787
WV_1_PC_0_EH_0_PS_40_6hrs, loss: 0.03347676247358322, avg_mse: 0.04582628980278969
current test mse: 0.045826
Iteration: 5481, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44790464639663696, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02672954462468624, decouple_loss:0.0012846201425418258
The modified gen p mean: 0.44393786787986755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026301216334104538, decouple_loss:0.0011095969239249825
The modified gen p mean: 0.4444902241230011, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027679918333888054, decouple_loss:0.0010508415289223194
Iteration: 5482, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4460250735282898, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027176890522241592, decouple_loss:0.0011000668164342642
The modified gen p mean: 0.4454549252986908, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02647530287504196, decouple_loss:0.0010394114069640636
The modified gen p mean: 0.4452568590641022, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0276345107704401, decouple_loss:0.0010796061251312494
Iteration: 5483, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4458577334880829, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02805769070982933, decouple_loss:0.0011670402018353343
The modified gen p mean: 0.44782450795173645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025280265137553215, decouple_loss:0.001248526037670672
The modified gen p mean: 0.45034798979759216, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027309581637382507, decouple_loss:0.0013390732929110527
Iteration: 5484, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44902339577674866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025046858936548233, decouple_loss:0.0011641690507531166
The modified gen p mean: 0.4488580822944641, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02586517482995987, decouple_loss:0.0011177737032994628
The modified gen p mean: 0.448700875043869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.025214802473783493, decouple_loss:0.0011386359110474586
Iteration: 5485, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44745978713035583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027493847534060478, decouple_loss:0.0010590532328933477
The modified gen p mean: 0.45312148332595825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02686222270131111, decouple_loss:0.001202092389576137
The modified gen p mean: 0.4477962553501129, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027258429676294327, decouple_loss:0.0012117308797314763
Iteration: 5486, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.44784852862358093, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026357756927609444, decouple_loss:0.001157280639745295
The modified gen p mean: 0.45302340388298035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02763800136744976, decouple_loss:0.0011583550367504358
The modified gen p mean: 0.4476182460784912, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02622799202799797, decouple_loss:0.0011468074517324567
Iteration: 5487, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4526292085647583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02524362877011299, decouple_loss:0.0012128493981435895
The modified gen p mean: 0.45057982206344604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02657991088926792, decouple_loss:0.00114300730638206
The modified gen p mean: 0.45040416717529297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027966134250164032, decouple_loss:0.001106786890886724
Iteration: 5488, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.45307427644729614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027003999799489975, decouple_loss:0.0011348732514306903
The modified gen p mean: 0.45047813653945923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0270414799451828, decouple_loss:0.0011417067144066095
The modified gen p mean: 0.45110926032066345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027010800316929817, decouple_loss:0.0011342171346768737
Iteration: 5489, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4519210755825043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02636086381971836, decouple_loss:0.0010813173139467835
The modified gen p mean: 0.45135077834129333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02543485537171364, decouple_loss:0.0012243289966136217
The modified gen p mean: 0.4484400153160095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027052387595176697, decouple_loss:0.0011304618092253804
Iteration: 5490, ims.shape: (3, 56, 3, 720, 1440)
The modified gen p mean: 0.4527806341648102, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02511364221572876, decouple_loss:0.0012545955833047628
The modified gen p mean: 0.45179834961891174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024865401908755302, decouple_loss:0.001203514519147575
The modified gen p mean: 0.4524507522583008, gen p mean: 0.0, mean p set: 0.448
