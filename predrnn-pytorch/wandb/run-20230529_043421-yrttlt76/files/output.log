/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1979_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1980_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1981_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1982_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1983_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1984_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1985_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1986_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1987_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1988_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1989_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1990_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1991_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1992_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1993_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1994_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1995_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1996_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1997_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1998_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_1999_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2000_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2001_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2002_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2004_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2005_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2006_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2007_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2008_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2009_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2010_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2011_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2012_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2013_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2014_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2015_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2016_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2017_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2018_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2019_3_24hr_shift3.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2020_3_24hr_shift3.npz
train_data_files nums: 84
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset_6hrs/era5_train_2022_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset_6hrs/era5_train_2003_3_24hr.npz
NaN value num: 0
load model: /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_2_PC_0_EH_0_PS_40_6hrs/model_init_6hrs.ckpt
2023-05-29 04:36:15 testing...
loss_pred:0.04546215012669563, decouple_loss:0.0016575435874983668
loss_pred:0.042668215930461884, decouple_loss:0.0015784797724336386
loss_pred:0.042944397777318954, decouple_loss:0.001467144931666553
WV_2_PC_0_EH_0_PS_40_6hrs, loss: 0.04376997798681259, avg_mse: 0.043718308210372925
Loaded model test mse: 0.04371799901127815
Iteration: 1, ims.shape: (3, 56, 3, 720, 1440)
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
loss_pred:0.0390653982758522, decouple_loss:0.0016365809133276343
loss_pred:0.0375337116420269, decouple_loss:0.0016019962495192885
loss_pred:0.03732853755354881, decouple_loss:0.0014409234281629324
Iteration: 2, ims.shape: (3, 56, 3, 720, 1440)
loss_pred:0.0374627411365509, decouple_loss:0.0016587203135713935
loss_pred:0.03640773519873619, decouple_loss:0.0016675471561029553
loss_pred:0.03679666295647621, decouple_loss:0.0016156984493136406
Iteration: 3, ims.shape: (3, 56, 3, 720, 1440)
loss_pred:0.03798998147249222, decouple_loss:0.002245265757665038
loss_pred:0.03382282331585884, decouple_loss:0.0017010355368256569
loss_pred:0.03675860911607742, decouple_loss:0.001553925801999867
Iteration: 4, ims.shape: (3, 56, 3, 720, 1440)
loss_pred:0.03606763482093811, decouple_loss:0.0017055865610018373
loss_pred:0.03543153032660484, decouple_loss:0.0014072206104174256
loss_pred:0.03526309132575989, decouple_loss:0.001681312918663025
Iteration: 5, ims.shape: (3, 56, 3, 720, 1440)
loss_pred:0.03523164242506027, decouple_loss:0.002077494515106082
loss_pred:0.03529760614037514, decouple_loss:0.0016787387430667877
loss_pred:0.03614232316613197, decouple_loss:0.0016562278615310788
Iteration: 6, ims.shape: (3, 56, 3, 720, 1440)
loss_pred:0.035186707973480225, decouple_loss:0.0015726749552413821
loss_pred:0.03475990146398544, decouple_loss:0.0016151390736922622
loss_pred:0.035147275775671005, decouple_loss:0.0019258237443864346
Iteration: 7, ims.shape: (3, 56, 3, 720, 1440)
loss_pred:0.034383248537778854, decouple_loss:0.0017017669742926955
loss_pred:0.036617573350667953, decouple_loss:0.0017898529767990112
loss_pred:0.03448861464858055, decouple_loss:0.0018800065154209733
Iteration: 8, ims.shape: (3, 56, 3, 720, 1440)
loss_pred:0.03714023157954216, decouple_loss:0.0018917463021352887
loss_pred:0.03513706102967262, decouple_loss:0.00181315909139812
loss_pred:0.035814255475997925, decouple_loss:0.001751601928845048
Iteration: 9, ims.shape: (3, 56, 3, 720, 1440)
loss_pred:0.03366350755095482, decouple_loss:0.0016734645469114184
loss_pred:0.036524273455142975, decouple_loss:0.0019821387249976397
loss_pred:0.03670864179730415, decouple_loss:0.0021754291374236345
Iteration: 10, ims.shape: (3, 56, 3, 720, 1440)
loss_pred:0.034323129802942276, decouple_loss:0.0019835049752146006
loss_pred:0.0357658676803112, decouple_loss:0.0019952692091464996
loss_pred:0.037958912551403046, decouple_loss:0.001853941474109888
2023-05-29 04:38:44 testing...
loss_pred:0.044475238770246506, decouple_loss:0.001745471265166998
loss_pred:0.044440679252147675, decouple_loss:0.001622394542209804
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 423, in <module>
    train_wrapper(model)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 308, in train_wrapper
    test_err = trainer.validate(model, test_input_handle, extra_var_test, args, 'val_result')
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/trainer.py", line 50, in validate
    avg_mse, loss = model.test(test_ims, real_input_flag, extra_var)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/models/model_factory_multiGPU.py", line 101, in test
    next_frames, loss, _, _ = self.network(frames_tensor, mask_tensor, extra_var_tensor, istrain=False)
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/data_parallel.py", line 168, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/data_parallel.py", line 178, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/parallel_apply.py", line 86, in parallel_apply
    output.reraise()
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
RuntimeError: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/models/predrnn_mgpu.py", line 252, in forward
    frames_tensor = self.wv_to_img(frames_tensor)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/models/predrnn_mgpu.py", line 326, in wv_to_img
    img_tensor = self.ifm((Yl, Yh))
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/pytorch_wavelets/dwt/transform2d.py", line 146, in forward
    ll = lowlevel.SFB2D.apply(
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/pytorch_wavelets/dwt/lowlevel.py", line 679, in forward
    y = sfb1d(lo, hi, g0_row, g1_row, mode=mode, dim=3)
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/pytorch_wavelets/dwt/lowlevel.py", line 266, in sfb1d
    y = F.conv_transpose2d(lo, g0, stride=s, padding=pad, groups=C) + \
RuntimeError: CUDA out of memory. Tried to allocate 1.95 GiB (GPU 0; 39.42 GiB total capacity; 31.75 GiB already allocated; 1.23 GiB free; 36.43 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF