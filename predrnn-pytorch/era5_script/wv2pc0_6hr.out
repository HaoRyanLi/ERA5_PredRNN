2023-05-26 20:20:39.534442: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-05-26 20:20:46.144913: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/apps/cuda11_4/nccl/2.11.4/lib:/opt/apps/cuda11_4/cudnn/8.2.4/lib64:/opt/apps/cuda/11.4/lib64:/opt/apps/pmix/3.2.3/lib:/opt/apps/intel19/python3/3.9.7/lib:/opt/intel/compilers_and_libraries_2020.4.304/linux/mpi/intel64/libfabric/lib:/opt/intel/compilers_and_libraries_2020.4.304/linux/mpi/intel64/lib/release:/opt/intel/compilers_and_libraries_2020.4.304/linux/mpi/intel64/lib:/opt/intel/debugger_2020/libipt/intel64/lib:/opt/intel/compilers_and_libraries_2020.1.217/linux/daal/lib/intel64_lin:/opt/intel/compilers_and_libraries_2020.1.217/linux/tbb/lib/intel64_lin/gcc4.8:/opt/intel/compilers_and_libraries_2020.1.217/linux/mkl/lib/intel64_lin:/opt/intel/compilers_and_libraries_2020.1.217/linux/ipp/lib/intel64:/opt/intel/compilers_and_libraries_2020.1.217/linux/compiler/lib/intel64_lin:/opt/apps/gcc/9.4.0/lib64:/opt/apps/gcc/9.4.0/lib:/usr/lib64
2023-05-26 20:20:46.145506: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/apps/cuda11_4/nccl/2.11.4/lib:/opt/apps/cuda11_4/cudnn/8.2.4/lib64:/opt/apps/cuda/11.4/lib64:/opt/apps/pmix/3.2.3/lib:/opt/apps/intel19/python3/3.9.7/lib:/opt/intel/compilers_and_libraries_2020.4.304/linux/mpi/intel64/libfabric/lib:/opt/intel/compilers_and_libraries_2020.4.304/linux/mpi/intel64/lib/release:/opt/intel/compilers_and_libraries_2020.4.304/linux/mpi/intel64/lib:/opt/intel/debugger_2020/libipt/intel64/lib:/opt/intel/compilers_and_libraries_2020.1.217/linux/daal/lib/intel64_lin:/opt/intel/compilers_and_libraries_2020.1.217/linux/tbb/lib/intel64_lin/gcc4.8:/opt/intel/compilers_and_libraries_2020.1.217/linux/mkl/lib/intel64_lin:/opt/intel/compilers_and_libraries_2020.1.217/linux/ipp/lib/intel64:/opt/intel/compilers_and_libraries_2020.1.217/linux/compiler/lib/intel64_lin:/opt/apps/gcc/9.4.0/lib64:/opt/apps/gcc/9.4.0/lib:/usr/lib64
2023-05-26 20:20:46.145518: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Loading model from: /work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/lpips/weights/v0.1/alex.pth
model.num_hidden length: 4
args.run_name: bs_3_opt_Adam_lr_0.0002_lr_sch_no_
We need the pretrained_model: /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_2_PC_0_EH_0_PS_40/model_init.ckpt
Initializing models
configs.time_step: 1 hour
load model: /work/09012/haoli1/ls6/PredRNN_checkpoints/WV_2_PC_0_EH_0_PS_40/model_init.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 126
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012021_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500727355480194, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44988760352134705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016397148370742798, decouple_loss:0.0007678796537220478
The modified gen p mean: 0.450531929731369, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016491128131747246, decouple_loss:0.0008105476736091077
loss_pred:0.016320398077368736, decouple_loss:0.0006531217368319631
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4383111000061035, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4393894076347351, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4436689019203186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.051612675189971924, decouple_loss:0.017579494044184685
loss_pred:0.047745127230882645, decouple_loss:0.016517940908670425
loss_pred:0.049055758863687515, decouple_loss:0.016539311036467552
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43956804275512695, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4435131549835205, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4395373463630676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.04011799767613411, decouple_loss:0.011523977853357792
loss_pred:0.04140443354845047, decouple_loss:0.011819696985185146
loss_pred:0.040599800646305084, decouple_loss:0.011150912381708622
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46592316031455994, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.46809467673301697, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.46892493963241577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.034334976226091385, decouple_loss:0.011073485016822815
loss_pred:0.03284652531147003, decouple_loss:0.010311075486242771
loss_pred:0.033123698085546494, decouple_loss:0.010801201686263084
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45997464656829834, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45935502648353577, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45676904916763306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.027836021035909653, decouple_loss:0.010659727267920971
loss_pred:0.028380000963807106, decouple_loss:0.011159252375364304
loss_pred:0.028844570741057396, decouple_loss:0.011036375537514687
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43952813744544983, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4401097595691681, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026879647746682167, decouple_loss:0.010498641058802605
The modified gen p mean: 0.4402337074279785, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026642469689249992, decouple_loss:0.009961827658116817
loss_pred:0.0262483861297369, decouple_loss:0.009955919347703457
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4246990382671356, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.42263367772102356, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.423790842294693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02574276365339756, decouple_loss:0.00873495452105999
loss_pred:0.025314899161458015, decouple_loss:0.009052280336618423
loss_pred:0.02440759353339672, decouple_loss:0.008533966727554798
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4405703544616699, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.438852459192276, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44250887632369995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02523886226117611, decouple_loss:0.009571418166160583
loss_pred:0.025232765823602676, decouple_loss:0.007710886653512716
loss_pred:0.025866400450468063, decouple_loss:0.008744860999286175
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45603278279304504, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4515044093132019, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45129138231277466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024904176592826843, decouple_loss:0.006040498148649931
loss_pred:0.02437339350581169, decouple_loss:0.005958441644906998
loss_pred:0.024902280420064926, decouple_loss:0.0064065963961184025
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4395221471786499, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44476643204689026, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44420740008354187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.023908216506242752, decouple_loss:0.006097635719925165
loss_pred:0.024335810914635658, decouple_loss:0.005610414315015078
loss_pred:0.02495441399514675, decouple_loss:0.005966406315565109
2023-05-26 20:24:53 testing...
The modified gen p mean: 0.4344812333583832, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4347253143787384, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.43517136573791504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.026333825662732124, decouple_loss:0.004744414705783129
loss_pred:0.026446791365742683, decouple_loss:0.00473135756328702
loss_pred:0.02613265998661518, decouple_loss:0.004536978434771299
WV_2_PC_0_EH_0_PS_40, loss: 0.026537969708442688, avg_mse: 0.03281325101852417
Best test mse: 0.025, current test mse: 0.03281300142407417
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4412877857685089, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.43465879559516907, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.43506622314453125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.024471748620271683, decouple_loss:0.005095745902508497
loss_pred:0.024208959192037582, decouple_loss:0.0048008086159825325
loss_pred:0.024961333721876144, decouple_loss:0.004820202011615038
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086145401000977, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.450541615486145, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45183441042900085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02291998639702797, decouple_loss:0.00548295583575964
loss_pred:0.022994263097643852, decouple_loss:0.004991143010556698
loss_pred:0.023495731875300407, decouple_loss:0.004863986279815435
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45452770590782166, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4529883563518524, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4546491801738739, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02344699203968048, decouple_loss:0.004561976995319128
loss_pred:0.023098090663552284, decouple_loss:0.004630556330084801
loss_pred:0.02347433939576149, decouple_loss:0.004441157914698124
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43907293677330017, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.43673235177993774, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.43739551305770874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.023254461586475372, decouple_loss:0.003877148265019059
loss_pred:0.02314790152013302, decouple_loss:0.0034636962227523327
loss_pred:0.022667307406663895, decouple_loss:0.0034348785411566496
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4376824200153351, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4347496032714844, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.43380942940711975, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.022998299449682236, decouple_loss:0.003577740164473653
loss_pred:0.022710604593157768, decouple_loss:0.0038381079211831093
loss_pred:0.022720979526638985, decouple_loss:0.0036701022181659937
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461100697517395, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44591304659843445, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4421789050102234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.021891728043556213, decouple_loss:0.0038263241294771433
loss_pred:0.02282707393169403, decouple_loss:0.0035860841162502766
loss_pred:0.022301867604255676, decouple_loss:0.0033088831696659327
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709262251853943, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44415542483329773, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44477328658103943, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.021916065365076065, decouple_loss:0.0029251701198518276
loss_pred:0.02268042229115963, decouple_loss:0.0034524023067206144
loss_pred:0.02224249392747879, decouple_loss:0.0028440654277801514
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4428633749485016, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4438988268375397, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4420199692249298, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.021178852766752243, decouple_loss:0.0031738693360239267
loss_pred:0.021364610642194748, decouple_loss:0.0029780305922031403
loss_pred:0.020760364830493927, decouple_loss:0.003123025642707944
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44612032175064087, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4482739269733429, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44665810465812683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.021205240860581398, decouple_loss:0.003216315293684602
loss_pred:0.0212261863052845, decouple_loss:0.0029652954544872046
loss_pred:0.02125599794089794, decouple_loss:0.0028520298656076193
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956421852111816, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4481479525566101, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4497390687465668, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02110317535698414, decouple_loss:0.002809087513014674
loss_pred:0.021842967718839645, decouple_loss:0.0030014305375516415
loss_pred:0.021770929917693138, decouple_loss:0.0028036676812916994
2023-05-26 20:27:14 testing...
The modified gen p mean: 0.44103941321372986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.023188192397356033, decouple_loss:0.002427330706268549
The modified gen p mean: 0.44131502509117126, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.44125980138778687, gen p mean: 0.0, mean p set: 0.448

loss_pred:0.023052379488945007, decouple_loss:0.0025184820406138897
loss_pred:0.023343371227383614, decouple_loss:0.0025003948248922825
WV_2_PC_0_EH_0_PS_40, loss: 0.02331875078380108, avg_mse: 0.030183512717485428
Best test mse: 0.025, current test mse: 0.030184000730514526
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450197219848633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02100694179534912, decouple_loss:0.0027609453536570072
The modified gen p mean: 0.4474591314792633, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4445527195930481, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.021020900458097458, decouple_loss:0.002412347123026848
loss_pred:0.020138759166002274, decouple_loss:0.002965569496154785
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44416528940200806, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4412476420402527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.021234270185232162, decouple_loss:0.002748203929513693
The modified gen p mean: 0.44070693850517273, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.020711654797196388, decouple_loss:0.0027893742080777884
loss_pred:0.020162228494882584, decouple_loss:0.002916542114689946
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533635973930359, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45276713371276855, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4549465477466583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.020015940070152283, decouple_loss:0.002526221564039588
loss_pred:0.020362144336104393, decouple_loss:0.0025298551190644503
loss_pred:0.020385604351758957, decouple_loss:0.0022748468909412622
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4424215853214264, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4420119822025299, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44439396262168884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019714873284101486, decouple_loss:0.002164656762033701
loss_pred:0.019449885934591293, decouple_loss:0.0023140290286391973
loss_pred:0.0194059070199728, decouple_loss:0.0022176920901983976
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454805552959442, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44521236419677734, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4420620799064636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019662369042634964, decouple_loss:0.002367006614804268
loss_pred:0.01924682781100273, decouple_loss:0.0024550745729357004
loss_pred:0.01961919479072094, decouple_loss:0.002147807739675045
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526238739490509, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4536161422729492, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.450697660446167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01975388452410698, decouple_loss:0.0020386045798659325
loss_pred:0.019224155694246292, decouple_loss:0.002186309779062867
loss_pred:0.019926978275179863, decouple_loss:0.0019909092225134373
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45197194814682007, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45203927159309387, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4506930112838745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01992453634738922, decouple_loss:0.0019075035816058517
loss_pred:0.019475726410746574, decouple_loss:0.0020061731338500977
loss_pred:0.019473394379019737, decouple_loss:0.001962923677638173
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44620031118392944, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4482870399951935, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4481945335865021, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01918952539563179, decouple_loss:0.0018535119015723467
loss_pred:0.018682144582271576, decouple_loss:0.0020809497218579054
loss_pred:0.01890072040259838, decouple_loss:0.002171299885958433
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449358195066452, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4519747495651245, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4479616582393646, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018498998135328293, decouple_loss:0.0024369140155613422
loss_pred:0.01933329366147518, decouple_loss:0.002028750954195857
loss_pred:0.018606770783662796, decouple_loss:0.0019387269858270884
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500655233860016, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45070213079452515, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44810950756073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019030021503567696, decouple_loss:0.002184096956625581
loss_pred:0.01903454400599003, decouple_loss:0.0023602712899446487
loss_pred:0.019300196319818497, decouple_loss:0.0019073321018368006
2023-05-26 20:30:15 testing...
The modified gen p mean: 0.44300177693367004, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44309449195861816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.021485939621925354, decouple_loss:0.001977287232875824
The modified gen p mean: 0.4432360827922821, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.021530920639634132, decouple_loss:0.0019386549247428775
loss_pred:0.021723056212067604, decouple_loss:0.0020478132646530867
WV_2_PC_0_EH_0_PS_40, loss: 0.021679367870092392, avg_mse: 0.028619669377803802
Best test mse: 0.025, current test mse: 0.028620000928640366
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485033452510834, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4474409520626068, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4492618143558502, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018256982788443565, decouple_loss:0.00185283028986305
loss_pred:0.018776947632431984, decouple_loss:0.0018585355719551444
loss_pred:0.018163258209824562, decouple_loss:0.0017218454740941525
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496992826461792, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4477856755256653, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4473561942577362, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01857069879770279, decouple_loss:0.0018807601882144809
loss_pred:0.01803254336118698, decouple_loss:0.0018463045125827193
loss_pred:0.01853286847472191, decouple_loss:0.001678536762483418
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930848479270935, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44933655858039856, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4474874436855316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017624199390411377, decouple_loss:0.0017047360306605697
loss_pred:0.018977830186486244, decouple_loss:0.0015503065660595894
loss_pred:0.01890348084270954, decouple_loss:0.0017456795321777463
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030421018600464, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4517953097820282, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4494839906692505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01871807873249054, decouple_loss:0.0016716186655685306
loss_pred:0.018641874194145203, decouple_loss:0.002129679312929511
loss_pred:0.018734633922576904, decouple_loss:0.0021269298158586025
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767993688583374, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44724345207214355, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01800820790231228, decouple_loss:0.0020125529263168573
loss_pred:0.018227048218250275, decouple_loss:0.0017676213756203651
The modified gen p mean: 0.44861096143722534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017909718677401543, decouple_loss:0.0016677043167874217
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500628113746643, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45060548186302185, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4517258107662201, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01786882057785988, decouple_loss:0.001923248404636979
loss_pred:0.018154259771108627, decouple_loss:0.002030882053077221
loss_pred:0.01792924664914608, decouple_loss:0.0018190547125414014
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45207515358924866, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4492091238498688, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45057108998298645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017482511699199677, decouple_loss:0.0016124809626489878
loss_pred:0.01823086105287075, decouple_loss:0.0016034978907555342
loss_pred:0.017748674377799034, decouple_loss:0.0014692634576931596
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45090460777282715, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4496506452560425, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45002833008766174, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018414827063679695, decouple_loss:0.0015880266437307
loss_pred:0.017405608668923378, decouple_loss:0.0017003961838781834
loss_pred:0.017984604462981224, decouple_loss:0.001527448883280158
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481523931026459, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4497394859790802, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4492432177066803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017312144860625267, decouple_loss:0.0015262216329574585
loss_pred:0.017695734277367592, decouple_loss:0.0017215675907209516
loss_pred:0.017017273232340813, decouple_loss:0.001555964001454413
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
NaN value num: 0
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911742210388184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01960485801100731, decouple_loss:0.0017799902707338333
The modified gen p mean: 0.4481883943080902, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4437146782875061, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018841249868273735, decouple_loss:0.0017681354656815529
loss_pred:0.018415164202451706, decouple_loss:0.0018025008030235767
2023-05-26 20:33:16 testing...
The modified gen p mean: 0.44377490878105164, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44369199872016907, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.020528700202703476, decouple_loss:0.001871044747531414
The modified gen p mean: 0.4440150558948517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.020534412935376167, decouple_loss:0.0017923556733876467
loss_pred:0.02073528803884983, decouple_loss:0.0019866072107106447
WV_2_PC_0_EH_0_PS_40, loss: 0.020693635568022728, avg_mse: 0.027556978166103363
Best test mse: 0.025, current test mse: 0.027557000517845154
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459613561630249, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4470493197441101, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44532597064971924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018795710057020187, decouple_loss:0.0015244578244164586
loss_pred:0.01861460879445076, decouple_loss:0.0017077554948627949
loss_pred:0.019065959379076958, decouple_loss:0.001826753607019782
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4410853981971741, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4399172365665436, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.43889275193214417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019396116957068443, decouple_loss:0.0016515397001057863
loss_pred:0.018584227189421654, decouple_loss:0.0015373665373772383
loss_pred:0.018850069493055344, decouple_loss:0.001743687898851931
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44425418972969055, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44259876012802124, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44254589080810547, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018728680908679962, decouple_loss:0.0015943573089316487
loss_pred:0.01890488713979721, decouple_loss:0.0015491204103454947
loss_pred:0.01871531642973423, decouple_loss:0.0018795488867908716
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452523410320282, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4513740539550781, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4504259526729584, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019119340926408768, decouple_loss:0.0013560490915551782
loss_pred:0.018507806584239006, decouple_loss:0.0013894961448386312
loss_pred:0.018430037423968315, decouple_loss:0.0013730298960581422
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502444565296173, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4484245479106903, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4501489996910095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01865585334599018, decouple_loss:0.0015965893398970366
loss_pred:0.01884380169212818, decouple_loss:0.0014536415692418814
loss_pred:0.018119804561138153, decouple_loss:0.0014723694184795022
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44092047214508057, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4426986575126648, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4416142702102661, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019318977370858192, decouple_loss:0.0013052596477791667
loss_pred:0.018355876207351685, decouple_loss:0.0013461445923894644
loss_pred:0.017562739551067352, decouple_loss:0.0012088362127542496
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725489616394043, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4438616633415222, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4473819434642792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018868235871195793, decouple_loss:0.0012958330335095525
loss_pred:0.018413811922073364, decouple_loss:0.0014492955524474382
loss_pred:0.018517469987273216, decouple_loss:0.0014441015664488077
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768980145454407, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44456225633621216, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44832703471183777, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019068656489253044, decouple_loss:0.0015254996251314878
loss_pred:0.018165862187743187, decouple_loss:0.0016450285911560059
loss_pred:0.01861600950360298, decouple_loss:0.0018111971439793706
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909238815307617, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4470500648021698, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4446149468421936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018237944692373276, decouple_loss:0.001353863044641912
loss_pred:0.018163738772273064, decouple_loss:0.0016330736689269543
loss_pred:0.01847672276198864, decouple_loss:0.0012541231699287891
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.439644992351532, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4398277997970581, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4417308568954468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018254751339554787, decouple_loss:0.00140574446413666
loss_pred:0.01837063767015934, decouple_loss:0.0016575714107602835
loss_pred:0.018239647150039673, decouple_loss:0.0015765627613291144
2023-05-26 20:35:40 testing...
The modified gen p mean: 0.445355087518692, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02006729319691658, decouple_loss:0.0011852947063744068
The modified gen p mean: 0.44499504566192627, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44556406140327454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.02000056579709053, decouple_loss:0.001271952292881906
loss_pred:0.020256947726011276, decouple_loss:0.0012324106646701694
WV_2_PC_0_EH_0_PS_40, loss: 0.020169764757156372, avg_mse: 0.02710106410086155
Best test mse: 0.025, current test mse: 0.027101000770926476
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454726278781891, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44808340072631836, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4485072195529938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017625093460083008, decouple_loss:0.0011774168815463781
loss_pred:0.018284130841493607, decouple_loss:0.0013144012773409486
loss_pred:0.017894359305500984, decouple_loss:0.0011164068710058928
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538019299507141, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4545409381389618, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45159098505973816, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018597019836306572, decouple_loss:0.0012476807460188866
loss_pred:0.01872410997748375, decouple_loss:0.0013074821326881647
loss_pred:0.0182497501373291, decouple_loss:0.0013154004700481892
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44446805119514465, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4387363791465759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018530234694480896, decouple_loss:0.0015057818964123726
loss_pred:0.018160149455070496, decouple_loss:0.001372936530970037
The modified gen p mean: 0.4407183527946472, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017804373055696487, decouple_loss:0.0014918920351192355
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4398045539855957, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44156908988952637, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44256025552749634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018287481740117073, decouple_loss:0.0015065832994878292
loss_pred:0.01769237034022808, decouple_loss:0.001375276013277471
loss_pred:0.017653800547122955, decouple_loss:0.0014748361427336931
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494735300540924, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45033299922943115, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4498006999492645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017603280022740364, decouple_loss:0.0012817305978387594
loss_pred:0.01742556318640709, decouple_loss:0.0013828470837324858
loss_pred:0.01763385534286499, decouple_loss:0.0013133714674040675
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45047956705093384, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4510553777217865, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45072847604751587, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01804696023464203, decouple_loss:0.0013092600274831057
loss_pred:0.018072444945573807, decouple_loss:0.0014295349828898907
loss_pred:0.01826653815805912, decouple_loss:0.0012185695813968778
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4440602660179138, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4411238431930542, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4428938925266266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018016556277871132, decouple_loss:0.0011908110463991761
loss_pred:0.018147163093090057, decouple_loss:0.0012165303342044353
loss_pred:0.01758837327361107, decouple_loss:0.0013849027454853058
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4421752095222473, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4416620433330536, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.444527268409729, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017802204936742783, decouple_loss:0.001046677934937179
loss_pred:0.01771663874387741, decouple_loss:0.001088509219698608
loss_pred:0.018838409334421158, decouple_loss:0.0010855388827621937
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961658120155334, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4510314166545868, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44838201999664307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017906827852129936, decouple_loss:0.0011042277328670025
loss_pred:0.018430521711707115, decouple_loss:0.0011579100973904133
loss_pred:0.018188832327723503, decouple_loss:0.0010778059950098395
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462507665157318, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017741667106747627, decouple_loss:0.001276640803553164
The modified gen p mean: 0.44429901242256165, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4462244510650635, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018578140065073967, decouple_loss:0.00134220439940691
loss_pred:0.017895540222525597, decouple_loss:0.0011071843327954412
2023-05-26 20:38:46 testing...
The modified gen p mean: 0.44689634442329407, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4467686414718628, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019661443307995796, decouple_loss:0.001599190989509225
The modified gen p mean: 0.44685307145118713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019594918936491013, decouple_loss:0.0015829416224732995
loss_pred:0.01993144303560257, decouple_loss:0.0016560747753828764
WV_2_PC_0_EH_0_PS_40, loss: 0.01980990543961525, avg_mse: 0.026753133162856102
Best test mse: 0.025, current test mse: 0.026753000915050507
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4438360333442688, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44803181290626526, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4441167712211609, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018421128392219543, decouple_loss:0.0021744046825915575
loss_pred:0.018069719895720482, decouple_loss:0.0010852881241589785
loss_pred:0.018584920093417168, decouple_loss:0.001206692075356841
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543105661869049, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4524414837360382, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45604366064071655, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018796216696500778, decouple_loss:0.0019888593815267086
loss_pred:0.017656855285167694, decouple_loss:0.0012911598896607757
loss_pred:0.018024573102593422, decouple_loss:0.001568181556649506
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44286948442459106, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4476482570171356, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44989675283432007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01826712116599083, decouple_loss:0.001116235856898129
loss_pred:0.01823447458446026, decouple_loss:0.0012181567726656795
loss_pred:0.018559381365776062, decouple_loss:0.0014867349527776241
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43908435106277466, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4444851875305176, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4426596760749817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017943620681762695, decouple_loss:0.0015918123535811901
loss_pred:0.01855139061808586, decouple_loss:0.001370409969240427
loss_pred:0.017742088064551353, decouple_loss:0.0016487411921843886
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484131336212158, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44727107882499695, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4460480809211731, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01795487478375435, decouple_loss:0.001077628810890019
loss_pred:0.018764544278383255, decouple_loss:0.0011508953757584095
loss_pred:0.01834866590797901, decouple_loss:0.0010517914779484272
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508798122406006, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45085689425468445, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45135000348091125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01722411997616291, decouple_loss:0.0011283614439889789
loss_pred:0.01803027279675007, decouple_loss:0.0012305445270612836
loss_pred:0.017420902848243713, decouple_loss:0.0010300412541255355
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4428125023841858, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44436484575271606, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4467117190361023, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018465962260961533, decouple_loss:0.0015565137146040797
loss_pred:0.01767949014902115, decouple_loss:0.0015520427841693163
loss_pred:0.017246324568986893, decouple_loss:0.0014124404406175017
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44500741362571716, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4448223114013672, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4441337585449219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018176622688770294, decouple_loss:0.001113745616748929
loss_pred:0.017506927251815796, decouple_loss:0.0010980891529470682
loss_pred:0.017261482775211334, decouple_loss:0.0011763443471863866
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789496064186096, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44970232248306274, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44685423374176025, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017058715224266052, decouple_loss:0.001168151618912816
loss_pred:0.017031216993927956, decouple_loss:0.0010314323008060455
loss_pred:0.017130721360445023, decouple_loss:0.0011021491372957826
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503892660140991, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4501414895057678, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4520278573036194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01730118878185749, decouple_loss:0.000967162661254406
loss_pred:0.016668736934661865, decouple_loss:0.0009988340316340327
loss_pred:0.01731865666806698, decouple_loss:0.0011106873862445354
2023-05-26 20:41:09 testing...
The modified gen p mean: 0.4484894871711731, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44902512431144714, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01931788958609104, decouple_loss:0.0011428353609517217
The modified gen p mean: 0.4485182762145996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019668053835630417, decouple_loss:0.001299138879403472
loss_pred:0.01927187852561474, decouple_loss:0.001152270007878542
WV_2_PC_0_EH_0_PS_40, loss: 0.0194791778922081, avg_mse: 0.026358800008893013
Best test mse: 0.025, current test mse: 0.02635899931192398
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872739911079407, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4490167200565338, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4476509392261505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017756404355168343, decouple_loss:0.0013640301767736673
loss_pred:0.017521189525723457, decouple_loss:0.0010712961666285992
loss_pred:0.017842421308159828, decouple_loss:0.0010297896806150675
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459376633167267, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4437538683414459, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4454420506954193, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017718655988574028, decouple_loss:0.0012484921608120203
loss_pred:0.01758711226284504, decouple_loss:0.0010513176675885916
loss_pred:0.017701271921396255, decouple_loss:0.001150610507465899
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44572651386260986, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4486464262008667, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44907695055007935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0179070346057415, decouple_loss:0.0009801062988117337
loss_pred:0.017794612795114517, decouple_loss:0.0009856991237029433
loss_pred:0.017227375879883766, decouple_loss:0.0010150711750611663
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728150963783264, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44776129722595215, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4483238160610199, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017714761197566986, decouple_loss:0.0012603163486346602
loss_pred:0.017962176352739334, decouple_loss:0.0011960476404055953
loss_pred:0.018191151320934296, decouple_loss:0.0011245538480579853
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451051354408264, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44352155923843384, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44619476795196533, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017911415547132492, decouple_loss:0.0011184198083356023
loss_pred:0.017293235287070274, decouple_loss:0.0011244791094213724
loss_pred:0.017598291859030724, decouple_loss:0.0010679642437025905
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470289945602417, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44608744978904724, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4455220103263855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017500409856438637, decouple_loss:0.0010202708654105663
loss_pred:0.0174602959305048, decouple_loss:0.0011120758717879653
loss_pred:0.01750298961997032, decouple_loss:0.0010437032906338573
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499901235103607, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44957882165908813, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4502924084663391, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01789674535393715, decouple_loss:0.0008888447191566229
loss_pred:0.01721455715596676, decouple_loss:0.0011433092877268791
loss_pred:0.017285825684666634, decouple_loss:0.0010105399414896965
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44604164361953735, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4476947486400604, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44972941279411316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01781781204044819, decouple_loss:0.0010256263194605708
loss_pred:0.017933012917637825, decouple_loss:0.0010053941514343023
loss_pred:0.017904631793498993, decouple_loss:0.0009893932146951556
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456101655960083, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44352084398269653, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44444432854652405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017616430297493935, decouple_loss:0.0012156086741015315
loss_pred:0.01747438684105873, decouple_loss:0.0011899484088644385
loss_pred:0.017348336055874825, decouple_loss:0.0012089834781363606
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494040608406067, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017404431477189064, decouple_loss:0.001677221735008061
The modified gen p mean: 0.4495012164115906, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.444436252117157, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017145195975899696, decouple_loss:0.0017208836507052183
loss_pred:0.018180886283516884, decouple_loss:0.0012378882383927703
2023-05-26 20:44:10 testing...
The modified gen p mean: 0.45098793506622314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019051840528845787, decouple_loss:0.001197847188450396
The modified gen p mean: 0.4509578347206116, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4514630138874054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019107088446617126, decouple_loss:0.0010958985658362508
loss_pred:0.019432546570897102, decouple_loss:0.0011498277308419347
WV_2_PC_0_EH_0_PS_40, loss: 0.019254550337791443, avg_mse: 0.026084594428539276
Best test mse: 0.025, current test mse: 0.02608500048518181
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497532546520233, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45266103744506836, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45231711864471436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017566489055752754, decouple_loss:0.0012468872591853142
loss_pred:0.01725243777036667, decouple_loss:0.0011201107408851385
loss_pred:0.017118025571107864, decouple_loss:0.0009628338739275932
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104318857192993, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4496326744556427, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44654741883277893, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016783669590950012, decouple_loss:0.0010365383932366967
loss_pred:0.018201708793640137, decouple_loss:0.001179420854896307
loss_pred:0.017345385625958443, decouple_loss:0.0013343429891392589
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470269978046417, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4452868103981018, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4458954930305481, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015983106568455696, decouple_loss:0.0011316625168547034
loss_pred:0.017474627122282982, decouple_loss:0.0010025318479165435
loss_pred:0.01739492267370224, decouple_loss:0.0009572075796313584
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695210456848145, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44795164465904236, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4465843439102173, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01649874821305275, decouple_loss:0.0010087013943120837
loss_pred:0.01726989820599556, decouple_loss:0.0011117351241409779
loss_pred:0.01723928563296795, decouple_loss:0.0011190490331500769
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501092731952667, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45015639066696167, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45175713300704956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018292304128408432, decouple_loss:0.0011215071426704526
loss_pred:0.018431199714541435, decouple_loss:0.0011528620962053537
loss_pred:0.017564397305250168, decouple_loss:0.001013791305013001
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479215145111084, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44423145055770874, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4474393427371979, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01746460422873497, decouple_loss:0.001208660309202969
loss_pred:0.017949935048818588, decouple_loss:0.001270074862986803
loss_pred:0.018448958173394203, decouple_loss:0.00115056405775249
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443749189376831, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44325751066207886, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4444226920604706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017541317269206047, decouple_loss:0.0011542256688699126
loss_pred:0.017587000504136086, decouple_loss:0.0010693093063309789
loss_pred:0.017076639458537102, decouple_loss:0.001249262597411871
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45248496532440186, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45268118381500244, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4498685598373413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01673947647213936, decouple_loss:0.0012772920308634639
loss_pred:0.01721937395632267, decouple_loss:0.001227692817337811
loss_pred:0.017276108264923096, decouple_loss:0.0011588954366743565
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788968563079834, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45193061232566833, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4497552812099457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017244065180420876, decouple_loss:0.0012360039399936795
loss_pred:0.01660945825278759, decouple_loss:0.0011981335701420903
loss_pred:0.01716751977801323, decouple_loss:0.00112795305904001
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464513659477234, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4450484812259674, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44814544916152954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01688886433839798, decouple_loss:0.0011916884686797857
loss_pred:0.01731264963746071, decouple_loss:0.0009978354210034013
loss_pred:0.017285337671637535, decouple_loss:0.0011831040028482676
2023-05-26 20:46:33 testing...
The modified gen p mean: 0.44676873087882996, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019015522673726082, decouple_loss:0.0010989239672198892
The modified gen p mean: 0.4468206465244293, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.446904718875885, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019029568880796432, decouple_loss:0.001254409085959196
loss_pred:0.019404755905270576, decouple_loss:0.0011518155224621296
WV_2_PC_0_EH_0_PS_40, loss: 0.01920836977660656, avg_mse: 0.026058120653033257
Best test mse: 0.025, current test mse: 0.026057999581098557
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481700360774994, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44821956753730774, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44997867941856384, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017963610589504242, decouple_loss:0.0011221880558878183
loss_pred:0.01809956505894661, decouple_loss:0.0010952303418889642
loss_pred:0.017331929877400398, decouple_loss:0.0011650261003524065
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479578733444214, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4502425789833069, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44761502742767334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017723172903060913, decouple_loss:0.0011856256751343608
loss_pred:0.017220037057995796, decouple_loss:0.0012532296823337674
loss_pred:0.01763223297894001, decouple_loss:0.0014925725990906358
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450899660587311, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4458684027194977, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44549331068992615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017348874360322952, decouple_loss:0.0010491503635421395
loss_pred:0.016518019139766693, decouple_loss:0.0008490199688822031
loss_pred:0.017086166888475418, decouple_loss:0.000960511330049485
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744789600372314, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488409757614136, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44851237535476685, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015930084511637688, decouple_loss:0.0014873025938868523
loss_pred:0.017090143635869026, decouple_loss:0.0010994789190590382
loss_pred:0.01645829901099205, decouple_loss:0.0014068767195567489
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901806116104126, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4486372172832489, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4504668414592743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015802349895238876, decouple_loss:0.001392641686834395
loss_pred:0.017086142674088478, decouple_loss:0.0010940999491140246
loss_pred:0.01805594563484192, decouple_loss:0.0009028855711221695
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482400715351105, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44693896174430847, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44890958070755005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017033139243721962, decouple_loss:0.0010271284263581038
loss_pred:0.01763499341905117, decouple_loss:0.0013619987294077873
loss_pred:0.016888154670596123, decouple_loss:0.0012839979026466608
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507322907447815, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45152270793914795, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44836100935935974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015998147428035736, decouple_loss:0.0014921885449439287
loss_pred:0.01805446296930313, decouple_loss:0.0010616140207275748
loss_pred:0.01710086688399315, decouple_loss:0.0010041428031399846
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853025674819946, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.448128879070282, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44915878772735596, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016514776274561882, decouple_loss:0.0009450757061131299
loss_pred:0.017061667516827583, decouple_loss:0.0010739561403170228
loss_pred:0.01770196110010147, decouple_loss:0.0008527269237674773
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484630525112152, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44645628333091736, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4484879970550537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017359336838126183, decouple_loss:0.001160189276561141
loss_pred:0.017588598653674126, decouple_loss:0.0011919836979359388
loss_pred:0.01711905747652054, decouple_loss:0.0012284440454095602
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
NaN value num: 0
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914790987968445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016354847699403763, decouple_loss:0.0011024624109268188
The modified gen p mean: 0.44503629207611084, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4491986930370331, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016096917912364006, decouple_loss:0.000916872697416693
loss_pred:0.016598252579569817, decouple_loss:0.001089182449504733
2023-05-26 20:49:38 testing...
The modified gen p mean: 0.4476710259914398, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018903449177742004, decouple_loss:0.0010059691267088056
The modified gen p mean: 0.44801655411720276, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4480261504650116, gen p mean: 0.0, mean p set: 0.448

loss_pred:0.018919242545962334, decouple_loss:0.0009738357039168477
loss_pred:0.019237622618675232, decouple_loss:0.0010684422450140119
WV_2_PC_0_EH_0_PS_40, loss: 0.019070908427238464, avg_mse: 0.02589287981390953
Best test mse: 0.025, current test mse: 0.02589300088584423
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45242393016815186, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4523007869720459, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4537779688835144, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016863849014043808, decouple_loss:0.0011203029425814748
loss_pred:0.016930818557739258, decouple_loss:0.0010113054886460304
loss_pred:0.01673506200313568, decouple_loss:0.0009270264417864382
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45600056648254395, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4527437388896942, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4548144042491913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017226804047822952, decouple_loss:0.0009203245281241834
loss_pred:0.01650763675570488, decouple_loss:0.0010468530235812068
loss_pred:0.017021525651216507, decouple_loss:0.0012668127892538905
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822654128074646, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45211565494537354, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45138564705848694, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016028784215450287, decouple_loss:0.0010160126257687807
loss_pred:0.015567883849143982, decouple_loss:0.0009679117938503623
loss_pred:0.01636192388832569, decouple_loss:0.0009454889805056155
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476831555366516, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44847142696380615, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45082801580429077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016020232811570168, decouple_loss:0.0008256679284386337
loss_pred:0.016364600509405136, decouple_loss:0.0010127431014552712
loss_pred:0.016296198591589928, decouple_loss:0.0013001580955460668
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4544767141342163, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4583064913749695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01657942682504654, decouple_loss:0.0008904412388801575
The modified gen p mean: 0.4533962607383728, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016631199046969414, decouple_loss:0.001127499039284885
loss_pred:0.016385376453399658, decouple_loss:0.0009123526397161186
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511939585208893, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45014652609825134, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45297911763191223, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016088493168354034, decouple_loss:0.0012270276201888919
loss_pred:0.016609109938144684, decouple_loss:0.0009646473918110132
loss_pred:0.01654776558279991, decouple_loss:0.001009486149996519
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488624632358551, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.450130820274353, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4480592608451843, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016447357833385468, decouple_loss:0.0009945015190169215
loss_pred:0.016528746113181114, decouple_loss:0.0012191433925181627
loss_pred:0.016364717856049538, decouple_loss:0.001083885203115642
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45426276326179504, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45413556694984436, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45339277386665344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017467621713876724, decouple_loss:0.0012027969351038337
loss_pred:0.016221126541495323, decouple_loss:0.001175281242467463
loss_pred:0.016527511179447174, decouple_loss:0.0013146138517186046
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4561993181705475, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4521424472332001, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45628535747528076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01641405001282692, decouple_loss:0.0009184408700093627
loss_pred:0.016573790460824966, decouple_loss:0.0009256157209165394
loss_pred:0.015884961932897568, decouple_loss:0.0009447530028410256
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933876395225525, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466293454170227, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471571743488312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01688210852444172, decouple_loss:0.0008291581179946661
loss_pred:0.016148878261446953, decouple_loss:0.001087476615794003
loss_pred:0.017105400562286377, decouple_loss:0.0011276403674855828
2023-05-26 20:52:02 testing...
The modified gen p mean: 0.4473629295825958, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019276335835456848, decouple_loss:0.0009495531558059156
The modified gen p mean: 0.4475756287574768, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478656053543091, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019171133637428284, decouple_loss:0.0010031124111264944
loss_pred:0.019557343795895576, decouple_loss:0.0009717480279505253
WV_2_PC_0_EH_0_PS_40, loss: 0.01938367635011673, avg_mse: 0.026284201070666313
Best test mse: 0.025, current test mse: 0.026283999904990196
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45110058784484863, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4528696537017822, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44972220063209534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016754820942878723, decouple_loss:0.0013645184226334095
loss_pred:0.016869867220520973, decouple_loss:0.0011461630929261446
loss_pred:0.016222679987549782, decouple_loss:0.001171523705124855
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45269209146499634, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4541279673576355, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4525582194328308, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016523825004696846, decouple_loss:0.0011540056439116597
loss_pred:0.016207925975322723, decouple_loss:0.0010311165824532509
loss_pred:0.016430646181106567, decouple_loss:0.0012894797837361693
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468885064125061, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.449660986661911, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44917258620262146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016669513657689095, decouple_loss:0.0011894847266376019
loss_pred:0.01677543669939041, decouple_loss:0.0011210578959435225
loss_pred:0.016668761149048805, decouple_loss:0.0012272552121430635
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071858167648315, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.454874187707901, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45332974195480347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016369348391890526, decouple_loss:0.0009107259684242308
loss_pred:0.0167583916336298, decouple_loss:0.001129101263359189
loss_pred:0.017382940277457237, decouple_loss:0.0010802085744217038
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45299032330513, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44914427399635315, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45343104004859924, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01652713492512703, decouple_loss:0.0010584373958408833
loss_pred:0.01669752039015293, decouple_loss:0.0011961048003286123
loss_pred:0.017415618523955345, decouple_loss:0.0008817021735012531
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452810138463974, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45015016198158264, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45110800862312317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016660848632454872, decouple_loss:0.0010908754775300622
loss_pred:0.016509506851434708, decouple_loss:0.0011530008632689714
loss_pred:0.016440391540527344, decouple_loss:0.0010799026349559426
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134663581848145, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45158886909484863, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4505496621131897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016765352338552475, decouple_loss:0.0009298818768002093
loss_pred:0.016243552789092064, decouple_loss:0.0009691860759630799
loss_pred:0.015890851616859436, decouple_loss:0.0009826680179685354
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45298057794570923, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45169538259506226, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45233154296875, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01616121456027031, decouple_loss:0.0011880635283887386
loss_pred:0.016666291281580925, decouple_loss:0.0010669477051123977
loss_pred:0.01611679419875145, decouple_loss:0.0010295871179550886
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482232630252838, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4484344720840454, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4485483169555664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01646830327808857, decouple_loss:0.0009806969901546836
loss_pred:0.01632469706237316, decouple_loss:0.0009074106928892434
loss_pred:0.015853233635425568, decouple_loss:0.000856077007483691
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
NaN value num: 0
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516977369785309, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016606653109192848, decouple_loss:0.0012603189097717404
The modified gen p mean: 0.4547394812107086, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45020416378974915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01748993806540966, decouple_loss:0.0011644880287349224
loss_pred:0.01735224388539791, decouple_loss:0.0010991685558110476
2023-05-26 20:55:17 testing...
The modified gen p mean: 0.4483199119567871, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488011300563812, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018962165340781212, decouple_loss:0.0011370977154001594
The modified gen p mean: 0.44867560267448425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018915710970759392, decouple_loss:0.0011041532270610332
loss_pred:0.019320940598845482, decouple_loss:0.0012343339622020721
WV_2_PC_0_EH_0_PS_40, loss: 0.01912420056760311, avg_mse: 0.02602887898683548
Best test mse: 0.025, current test mse: 0.02602900005877018
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529877305030823, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45257675647735596, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4510018825531006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016305390745401382, decouple_loss:0.0008600258734077215
loss_pred:0.01614716835319996, decouple_loss:0.0009130131220445037
loss_pred:0.016780978068709373, decouple_loss:0.000900958722922951
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542776644229889, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4560977518558502, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45380082726478577, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0172671340405941, decouple_loss:0.0013300847494974732
loss_pred:0.01744864322245121, decouple_loss:0.0010598731460049748
loss_pred:0.01679953560233116, decouple_loss:0.0009684677352197468
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263972878456116, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45084333419799805, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45360279083251953, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016766192391514778, decouple_loss:0.0009738569497130811
loss_pred:0.016284696757793427, decouple_loss:0.0008829247090034187
loss_pred:0.01694347709417343, decouple_loss:0.0011032080510631204
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.443492591381073, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44567883014678955, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44449716806411743, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01703050546348095, decouple_loss:0.0010735346004366875
loss_pred:0.01687648892402649, decouple_loss:0.0009060665615834296
loss_pred:0.016029590740799904, decouple_loss:0.0007928978884592652
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484485983848572, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44738689064979553, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45053213834762573, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016562271863222122, decouple_loss:0.0008225200581364334
loss_pred:0.017118114978075027, decouple_loss:0.0011052764020860195
loss_pred:0.017191162332892418, decouple_loss:0.0008354869205504656
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523119628429413, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45552778244018555, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45319026708602905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01627667061984539, decouple_loss:0.0008421253296546638
loss_pred:0.017447616904973984, decouple_loss:0.0008287448436021805
loss_pred:0.0174784567207098, decouple_loss:0.000900464307051152
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45594465732574463, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4559329152107239, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45446234941482544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017397113144397736, decouple_loss:0.0007854983559809625
loss_pred:0.017796333879232407, decouple_loss:0.0009717021021060646
loss_pred:0.016902657225728035, decouple_loss:0.0007863669306971133
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44434472918510437, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44687893986701965, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471840560436249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01650645211338997, decouple_loss:0.001029748935252428
loss_pred:0.01670791581273079, decouple_loss:0.0009432428632862866
loss_pred:0.01711011491715908, decouple_loss:0.0009683077223598957
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981685280799866, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4455420970916748, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44716641306877136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017126884311437607, decouple_loss:0.0009424069430679083
loss_pred:0.01714046113193035, decouple_loss:0.0008293618448078632
loss_pred:0.015913106501102448, decouple_loss:0.0010516210459172726
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535335898399353, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4536066949367523, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4506736993789673, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01648179069161415, decouple_loss:0.0008000284433364868
loss_pred:0.017551206052303314, decouple_loss:0.0007360255694948137
loss_pred:0.016998374834656715, decouple_loss:0.0008784493547864258
2023-05-26 20:57:39 testing...
The modified gen p mean: 0.4490983486175537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018888773396611214, decouple_loss:0.001076999120414257
The modified gen p mean: 0.4493248462677002, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4496748745441437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018809325993061066, decouple_loss:0.000983858946710825
loss_pred:0.01920965313911438, decouple_loss:0.0011925488943234086
WV_2_PC_0_EH_0_PS_40, loss: 0.01902347430586815, avg_mse: 0.025943662971258163
Best test mse: 0.025, current test mse: 0.025944000110030174
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45091402530670166, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45279404520988464, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4539279341697693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01646718569099903, decouple_loss:0.0008768789120949805
loss_pred:0.015973016619682312, decouple_loss:0.000903941981960088
loss_pred:0.01619049534201622, decouple_loss:0.000789009383879602
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739314913749695, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44968530535697937, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44776466488838196, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01629682630300522, decouple_loss:0.000971488596405834
loss_pred:0.016413085162639618, decouple_loss:0.0009252775926142931
loss_pred:0.016348794102668762, decouple_loss:0.0008294301806017756
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496699869632721, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4519859850406647, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4500132203102112, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01635000854730606, decouple_loss:0.0007399250753223896
loss_pred:0.01691249944269657, decouple_loss:0.0007779501029290259
loss_pred:0.01680663973093033, decouple_loss:0.0007583442493341863
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45297324657440186, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.452903151512146, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4499987065792084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016869021579623222, decouple_loss:0.0007790384697727859
loss_pred:0.017709432169795036, decouple_loss:0.0008046776056289673
loss_pred:0.015922503545880318, decouple_loss:0.0009063861798495054
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519774913787842, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45171913504600525, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45055001974105835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017235860228538513, decouple_loss:0.0010410904651507735
loss_pred:0.01695951446890831, decouple_loss:0.0007560584926977754
loss_pred:0.016225604340434074, decouple_loss:0.0008583631133660674
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485897123813629, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4473417103290558, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45229610800743103, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01721850410103798, decouple_loss:0.0008359072380699217
loss_pred:0.016942566260695457, decouple_loss:0.0009337306837551296
loss_pred:0.01703706569969654, decouple_loss:0.0008518549730069935
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494047164916992, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4514024555683136, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44947725534439087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016304269433021545, decouple_loss:0.0008308781543746591
loss_pred:0.017107689753174782, decouple_loss:0.0008687509107403457
loss_pred:0.017331503331661224, decouple_loss:0.0007769614458084106
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530718922615051, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4541644752025604, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4510178864002228, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01671684719622135, decouple_loss:0.0008161700097844005
loss_pred:0.01661388948559761, decouple_loss:0.0007342298049479723
loss_pred:0.01619267836213112, decouple_loss:0.0009144702926278114
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
NaN value num: 0
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45232918858528137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018121257424354553, decouple_loss:0.0008932895725592971
The modified gen p mean: 0.4498043954372406, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4544753134250641, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016959216445684433, decouple_loss:0.0010050305863842368
loss_pred:0.01708650030195713, decouple_loss:0.0009865432512015104
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027706027030945, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4501710534095764, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4524562656879425, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017109464854002, decouple_loss:0.0008218529401347041
loss_pred:0.01751805655658245, decouple_loss:0.0008583737653680146
loss_pred:0.017733149230480194, decouple_loss:0.0007589528686366975
2023-05-26 21:00:46 testing...
The modified gen p mean: 0.4466460645198822, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01874060370028019, decouple_loss:0.0009608773980289698
The modified gen p mean: 0.4467506408691406, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44742393493652344, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01871517486870289, decouple_loss:0.0010135119082406163
loss_pred:0.019051825627684593, decouple_loss:0.0009406665340065956
WV_2_PC_0_EH_0_PS_40, loss: 0.018884452059864998, avg_mse: 0.025762053206562996
Best test mse: 0.025, current test mse: 0.025761999189853668
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922158122062683, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4497063159942627, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45148876309394836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01762109249830246, decouple_loss:0.0008048039162531495
loss_pred:0.018121037632226944, decouple_loss:0.0010488443076610565
loss_pred:0.018163515254855156, decouple_loss:0.0010053091682493687
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895654916763306, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4495387673377991, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4500184953212738, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017935844138264656, decouple_loss:0.000788411358371377
loss_pred:0.01669335924088955, decouple_loss:0.0008158785058185458
loss_pred:0.017008736729621887, decouple_loss:0.0007822329644113779
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486692547798157, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45121529698371887, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4481443166732788, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017160210758447647, decouple_loss:0.000764381664339453
loss_pred:0.01857060194015503, decouple_loss:0.0009208185947500169
loss_pred:0.017852814868092537, decouple_loss:0.0009328080923296511
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499213397502899, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45146065950393677, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45372670888900757, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01805408112704754, decouple_loss:0.0008160310098901391
loss_pred:0.01756242848932743, decouple_loss:0.0008494718931615353
loss_pred:0.01841464266180992, decouple_loss:0.0008570293430238962
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499012529850006, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45107778906822205, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45125338435173035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017022138461470604, decouple_loss:0.0008617252460680902
loss_pred:0.01741042733192444, decouple_loss:0.0008176236879080534
loss_pred:0.01821499690413475, decouple_loss:0.0008672754629515111
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687288999557495, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4468837082386017, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4492739737033844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017384110018610954, decouple_loss:0.0008468303713016212
loss_pred:0.017089776694774628, decouple_loss:0.0008871531463228166
loss_pred:0.01818757690489292, decouple_loss:0.0008482555276714265
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186933875083923, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.448827862739563, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45022574067115784, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017819739878177643, decouple_loss:0.0008844322292134166
loss_pred:0.017568770796060562, decouple_loss:0.0007597821531817317
loss_pred:0.01722760498523712, decouple_loss:0.0009940977906808257
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513847231864929, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45334115624427795, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45152443647384644, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016795514151453972, decouple_loss:0.0010019902838394046
loss_pred:0.017298685386776924, decouple_loss:0.0007668589241802692
loss_pred:0.016842225566506386, decouple_loss:0.0007865788647904992
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45329806208610535, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4523371160030365, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4534456729888916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017496276646852493, decouple_loss:0.000771317514590919
loss_pred:0.017062805593013763, decouple_loss:0.0008536375826224685
loss_pred:0.017807379364967346, decouple_loss:0.0008670078823342919
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636911153793335, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4489448070526123, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4500502645969391, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018351862207055092, decouple_loss:0.001254527480341494
loss_pred:0.017202449962496758, decouple_loss:0.0008010141318663955
loss_pred:0.0178257804363966, decouple_loss:0.0008167941123247147
2023-05-26 21:03:10 testing...
The modified gen p mean: 0.4459993243217468, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4463239312171936, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01870940625667572, decouple_loss:0.001015468966215849
loss_pred:0.018682150170207024, decouple_loss:0.0010100017534568906
The modified gen p mean: 0.44691458344459534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019020874053239822, decouple_loss:0.0010814093984663486
WV_2_PC_0_EH_0_PS_40, loss: 0.018855925649404526, avg_mse: 0.02574535459280014
Best test mse: 0.025, current test mse: 0.025745000690221786
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487092196941376, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4491340219974518, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44942277669906616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017138170078396797, decouple_loss:0.0008641521562822163
loss_pred:0.017769023776054382, decouple_loss:0.0008711418486200273
loss_pred:0.017009960487484932, decouple_loss:0.0009871093789115548
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474552273750305, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4507291913032532, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4483337700366974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016945283859968185, decouple_loss:0.0007814926211722195
loss_pred:0.017869802191853523, decouple_loss:0.0007663764990866184
loss_pred:0.017808694392442703, decouple_loss:0.0008322466164827347
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535801112651825, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45168542861938477, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4522987902164459, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01656295172870159, decouple_loss:0.0011883871629834175
loss_pred:0.017118822783231735, decouple_loss:0.0006738640367984772
loss_pred:0.01740987040102482, decouple_loss:0.0007904419908300042
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524703919887543, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4518146514892578, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45350244641304016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017191676422953606, decouple_loss:0.0010123213287442923
loss_pred:0.016755063086748123, decouple_loss:0.000861421984154731
loss_pred:0.017049618065357208, decouple_loss:0.0014197169803082943
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900572299957275, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4513278305530548, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4521070718765259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016827311366796494, decouple_loss:0.0010072208242490888
loss_pred:0.017794866114854813, decouple_loss:0.0007812184048816562
loss_pred:0.01709960773587227, decouple_loss:0.0007324308971874416
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44927406311035156, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44964295625686646, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.448216050863266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017142334952950478, decouple_loss:0.0013384271878749132
loss_pred:0.01771908812224865, decouple_loss:0.0009621950448490679
loss_pred:0.0170188769698143, decouple_loss:0.0012674632016569376
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477161467075348, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4493052363395691, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45096009969711304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018203474581241608, decouple_loss:0.0009649607818573713
loss_pred:0.016821445897221565, decouple_loss:0.0008841369999572635
loss_pred:0.016984647139906883, decouple_loss:0.0008216269197873771
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531703293323517, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45310962200164795, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4520687460899353, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017018720507621765, decouple_loss:0.0009376799571327865
loss_pred:0.01735553704202175, decouple_loss:0.0007274535018950701
loss_pred:0.017171446233987808, decouple_loss:0.0007864811923354864
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44610294699668884, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017400352284312248, decouple_loss:0.0015422466676682234
The modified gen p mean: 0.44779208302497864, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478418231010437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016924837604165077, decouple_loss:0.0013381774770095944
loss_pred:0.016795288771390915, decouple_loss:0.001444880268536508
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453139901161194, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4460313320159912, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471675753593445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01624632626771927, decouple_loss:0.001280672149732709
loss_pred:0.01613348163664341, decouple_loss:0.0011001998791471124
loss_pred:0.017797455191612244, decouple_loss:0.0012533729895949364
2023-05-26 21:06:19 testing...
The modified gen p mean: 0.44580087065696716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018780214712023735, decouple_loss:0.0012015248648822308
The modified gen p mean: 0.4459367096424103, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44700902700424194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01874764822423458, decouple_loss:0.0011380617506802082
loss_pred:0.01910536177456379, decouple_loss:0.0011880104430019855
WV_2_PC_0_EH_0_PS_40, loss: 0.018936535343527794, avg_mse: 0.02590910717844963
Best test mse: 0.025, current test mse: 0.025908999145030975
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475778341293335, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4453946352005005, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4450346827507019, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016613326966762543, decouple_loss:0.0011295286240056157
loss_pred:0.017602959647774696, decouple_loss:0.0013039452023804188
loss_pred:0.016683341935276985, decouple_loss:0.0015202617505565286
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465214014053345, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44872358441352844, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4499180018901825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017614707350730896, decouple_loss:0.0014023612020537257
loss_pred:0.017232542857527733, decouple_loss:0.0014061661204323173
loss_pred:0.017112456262111664, decouple_loss:0.0015582304913550615
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930991530418396, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.448494553565979, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4495887756347656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016779053956270218, decouple_loss:0.0009233130258508027
loss_pred:0.016827017068862915, decouple_loss:0.001015261048451066
loss_pred:0.016703007742762566, decouple_loss:0.0009102201438508928
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457757771015167, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4467526972293854, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44390982389450073, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016575945541262627, decouple_loss:0.0011220616288483143
loss_pred:0.01693730615079403, decouple_loss:0.001230924273841083
loss_pred:0.016732677817344666, decouple_loss:0.000967912026681006
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44542890787124634, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4472937285900116, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44401785731315613, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017394104972481728, decouple_loss:0.001147933304309845
loss_pred:0.01636863499879837, decouple_loss:0.0008642475586384535
loss_pred:0.016265809535980225, decouple_loss:0.000813961960375309
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45004206895828247, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4498845338821411, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4502176344394684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016160910949110985, decouple_loss:0.0007905833190307021
loss_pred:0.01717997156083584, decouple_loss:0.0007546402048319578
loss_pred:0.01622724160552025, decouple_loss:0.0008843173272907734
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505464434623718, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44744735956192017, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44675156474113464, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017832132056355476, decouple_loss:0.0008482777629978955
loss_pred:0.0171958077698946, decouple_loss:0.0009612908470444381
loss_pred:0.01621571183204651, decouple_loss:0.0008379422943107784
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730210304260254, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.446978896856308, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4464515745639801, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01663963682949543, decouple_loss:0.0009389495826326311
loss_pred:0.016909092664718628, decouple_loss:0.000983135192655027
loss_pred:0.01657433621585369, decouple_loss:0.0012951170792803168
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44590476155281067, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44705888628959656, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4450022280216217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01644347980618477, decouple_loss:0.0007724270108155906
loss_pred:0.016960879787802696, decouple_loss:0.0009393779910169542
loss_pred:0.017247259616851807, decouple_loss:0.0010875285370275378
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451328217983246, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44562098383903503, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4456481635570526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017405396327376366, decouple_loss:0.0008090626215562224
loss_pred:0.01622493751347065, decouple_loss:0.0008459612727165222
loss_pred:0.01614811085164547, decouple_loss:0.001183050568215549
2023-05-26 21:08:46 testing...
The modified gen p mean: 0.4478990435600281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018625684082508087, decouple_loss:0.0009831569623202085
The modified gen p mean: 0.44818225502967834, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44887611269950867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018704576417803764, decouple_loss:0.0008426715503446758
loss_pred:0.018986087292432785, decouple_loss:0.0010834633139893413
WV_2_PC_0_EH_0_PS_40, loss: 0.01882060430943966, avg_mse: 0.025746909901499748
Best test mse: 0.025, current test mse: 0.02574699930846691
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672489166259766, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4509456753730774, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44703853130340576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016571098938584328, decouple_loss:0.0011163349263370037
loss_pred:0.01711021363735199, decouple_loss:0.0007593540940433741
loss_pred:0.01617535389959812, decouple_loss:0.0009061435703188181
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483507573604584, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44967684149742126, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44721296429634094, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01651775650680065, decouple_loss:0.0008903871639631689
loss_pred:0.01732192002236843, decouple_loss:0.0011885497951880097
loss_pred:0.016657616943120956, decouple_loss:0.0009539893362671137
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766464829444885, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4474605321884155, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44651123881340027, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016644950956106186, decouple_loss:0.0008639227598905563
loss_pred:0.016955841332674026, decouple_loss:0.0009516791324131191
loss_pred:0.017083313316106796, decouple_loss:0.0009274018229916692
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472520649433136, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478510916233063, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4480564296245575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016989389434456825, decouple_loss:0.0009547470253892243
loss_pred:0.016516031697392464, decouple_loss:0.0006986712105572224
loss_pred:0.01785844936966896, decouple_loss:0.0008923431159928441
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4442084729671478, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44777143001556396, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44754302501678467, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01582619734108448, decouple_loss:0.0008811256848275661
loss_pred:0.017009025439620018, decouple_loss:0.0007120213122107089
loss_pred:0.01613873988389969, decouple_loss:0.0007268947083503008
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865882396698, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4477718770503998, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4480530321598053, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01818143017590046, decouple_loss:0.0007260542479343712
loss_pred:0.017030661925673485, decouple_loss:0.0007032728171907365
loss_pred:0.017135033383965492, decouple_loss:0.0007297526462934911
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721877574920654, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471471309661865, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4472316801548004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01650693267583847, decouple_loss:0.0007952118758112192
loss_pred:0.016548680141568184, decouple_loss:0.0009016052936203778
loss_pred:0.016285981982946396, decouple_loss:0.0009188672411255538
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458633065223694, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4484022259712219, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4479060173034668, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016414955258369446, decouple_loss:0.0008824774995446205
loss_pred:0.01682267151772976, decouple_loss:0.0007056926842778921
loss_pred:0.016681931912899017, decouple_loss:0.0008199064759537578
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
NaN value num: 0
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483028054237366, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017879430204629898, decouple_loss:0.0009767975425347686
The modified gen p mean: 0.4490104615688324, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4489169716835022, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018299493938684464, decouple_loss:0.0012154693249613047
loss_pred:0.01758640632033348, decouple_loss:0.0012966382782906294
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448106050491333, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45017534494400024, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4501442313194275, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01808016560971737, decouple_loss:0.0008341317879967391
loss_pred:0.01766258291900158, decouple_loss:0.0007538800709880888
loss_pred:0.018244387581944466, decouple_loss:0.0008993195951916277
2023-05-26 21:11:51 testing...
The modified gen p mean: 0.4464360177516937, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471385180950165, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01862301118671894, decouple_loss:0.0021727662533521652
The modified gen p mean: 0.44702595472335815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018914643675088882, decouple_loss:0.002243845025077462
loss_pred:0.018603917211294174, decouple_loss:0.0020984963048249483
WV_2_PC_0_EH_0_PS_40, loss: 0.01882244274020195, avg_mse: 0.025660455226898193
Best test mse: 0.025, current test mse: 0.02566000074148178
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983190298080444, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4503059387207031, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45006948709487915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018181437626481056, decouple_loss:0.0010384346824139357
loss_pred:0.017028089612722397, decouple_loss:0.0012043023016303778
loss_pred:0.017953254282474518, decouple_loss:0.0009805824374780059
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541957378387451, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4553368091583252, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45469218492507935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0182546004652977, decouple_loss:0.0013351708184927702
loss_pred:0.01680564321577549, decouple_loss:0.0010474701412022114
loss_pred:0.016953347250819206, decouple_loss:0.0012244939571246505
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536525011062622, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45402219891548157, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4531124532222748, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01774531975388527, decouple_loss:0.0014434625627472997
loss_pred:0.01723824255168438, decouple_loss:0.0010221819393336773
loss_pred:0.017963571473956108, decouple_loss:0.0012688097776845098
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682592153549194, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44761624932289124, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4469829499721527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018152553588151932, decouple_loss:0.0010440960759297013
loss_pred:0.01699078269302845, decouple_loss:0.0010495278984308243
loss_pred:0.01834997348487377, decouple_loss:0.0009844484739005566
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933974742889404, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.447702556848526, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4440425634384155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016605127602815628, decouple_loss:0.0009437824483029544
loss_pred:0.018247704952955246, decouple_loss:0.0009728748118504882
loss_pred:0.017309097573161125, decouple_loss:0.0008910304168239236
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4570556879043579, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4560220539569855, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4558016359806061, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016764862462878227, decouple_loss:0.0009268058929592371
loss_pred:0.017388055101037025, decouple_loss:0.0008685496868565679
loss_pred:0.018222613260149956, decouple_loss:0.0009782464476302266
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45450204610824585, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4540616571903229, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45336124300956726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018101954832673073, decouple_loss:0.0009437755797989666
loss_pred:0.0174883846193552, decouple_loss:0.0009655902977101505
loss_pred:0.016809068620204926, decouple_loss:0.0009022432495839894
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726160168647766, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44176551699638367, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44666042923927307, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01756512001156807, decouple_loss:0.0007569504086859524
loss_pred:0.017656583338975906, decouple_loss:0.000880502921063453
loss_pred:0.0180842112749815, decouple_loss:0.000790970167145133
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701457023620605, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44877710938453674, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4493906497955322, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017457861453294754, decouple_loss:0.0010725987376645207
loss_pred:0.01669539511203766, decouple_loss:0.0009284279076382518
loss_pred:0.01740710437297821, decouple_loss:0.0007391632534563541
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45450159907341003, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45463648438453674, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4533980190753937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018479742109775543, decouple_loss:0.0008844391559250653
loss_pred:0.01738111861050129, decouple_loss:0.0008209242951124907
loss_pred:0.017601119354367256, decouple_loss:0.0010126824490725994
2023-05-26 21:14:12 testing...
The modified gen p mean: 0.45006075501441956, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.450628399848938, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018737446516752243, decouple_loss:0.0021594141144305468
The modified gen p mean: 0.45046094059944153, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018652215600013733, decouple_loss:0.0021065135952085257
loss_pred:0.018949147313833237, decouple_loss:0.0021877724211663008
WV_2_PC_0_EH_0_PS_40, loss: 0.018887165933847427, avg_mse: 0.02581215277314186
Best test mse: 0.025, current test mse: 0.025812000036239624
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45346400141716003, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45093438029289246, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.452151894569397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017086375504732132, decouple_loss:0.0007318216958083212
loss_pred:0.01727869175374508, decouple_loss:0.0007524312823079526
loss_pred:0.01789158023893833, decouple_loss:0.0007100811926648021
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805672764778137, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44730088114738464, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4477924704551697, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016930613666772842, decouple_loss:0.0006752338958904147
loss_pred:0.017873024567961693, decouple_loss:0.0007534459582529962
loss_pred:0.017880141735076904, decouple_loss:0.0008058439707383513
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758978486061096, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4483676552772522, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471050202846527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01750587671995163, decouple_loss:0.0007179490057751536
loss_pred:0.01728038489818573, decouple_loss:0.000844702881295234
loss_pred:0.017560720443725586, decouple_loss:0.0006966306245885789
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45152968168258667, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45320168137550354, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45061400532722473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01786062680184841, decouple_loss:0.0007503826636821032
loss_pred:0.01775267720222473, decouple_loss:0.0007759879226796329
loss_pred:0.017755206674337387, decouple_loss:0.000723835953976959
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453421026468277, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4526904821395874, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017777323722839355, decouple_loss:0.0006355531513690948
loss_pred:0.018302256241440773, decouple_loss:0.0006605908274650574
The modified gen p mean: 0.45325127243995667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01773667521774769, decouple_loss:0.0006813496584072709
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801169633865356, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4508230984210968, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4501977562904358, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017638057470321655, decouple_loss:0.0009523263433948159
loss_pred:0.017433922737836838, decouple_loss:0.0007458581821992993
loss_pred:0.017300864681601524, decouple_loss:0.0006586340605281293
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458850622177124, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4495924711227417, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4485262632369995, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018039211630821228, decouple_loss:0.0007538550416938961
loss_pred:0.017719004303216934, decouple_loss:0.0007209519972093403
loss_pred:0.017259659245610237, decouple_loss:0.0009412358049303293
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45136475563049316, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4519340395927429, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45040392875671387, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017773449420928955, decouple_loss:0.0008263260242529213
loss_pred:0.017886964604258537, decouple_loss:0.0006891255616210401
loss_pred:0.0179990716278553, decouple_loss:0.0008499623509123921
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920051097869873, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016628123819828033, decouple_loss:0.0009267806890420616
The modified gen p mean: 0.4505569636821747, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44787850975990295, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017095206305384636, decouple_loss:0.0011043668491765857
loss_pred:0.01705150306224823, decouple_loss:0.0012022721348330379
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482465088367462, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4498390555381775, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45030447840690613, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017096025869250298, decouple_loss:0.0007848091190680861
loss_pred:0.01706830784678459, decouple_loss:0.0009827548637986183
loss_pred:0.017226016148924828, decouple_loss:0.0009406062890775502
2023-05-26 21:17:15 testing...
The modified gen p mean: 0.4493426978588104, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4501476287841797, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018640130758285522, decouple_loss:0.0008387272246181965
The modified gen p mean: 0.4496382772922516, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01856980472803116, decouple_loss:0.0008190798689611256
loss_pred:0.01886862702667713, decouple_loss:0.0008555547683499753
WV_2_PC_0_EH_0_PS_40, loss: 0.01873474381864071, avg_mse: 0.025669239461421967
Best test mse: 0.025, current test mse: 0.025668999180197716
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866225123405457, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4477318227291107, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44844672083854675, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016946202144026756, decouple_loss:0.0011969476472586393
loss_pred:0.017162615433335304, decouple_loss:0.0009303322294726968
loss_pred:0.017294079065322876, decouple_loss:0.001338578062132001
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754523038864136, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4511047601699829, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4500752091407776, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016888964921236038, decouple_loss:0.0011933579808101058
loss_pred:0.017881613224744797, decouple_loss:0.0011432787869125605
loss_pred:0.017635609954595566, decouple_loss:0.000986048486083746
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45133253931999207, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4510321617126465, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45081815123558044, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017540650442242622, decouple_loss:0.0009203117224387825
loss_pred:0.017665445804595947, decouple_loss:0.0011493456549942493
loss_pred:0.01710835099220276, decouple_loss:0.0007984820986166596
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44506341218948364, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44621741771698, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471268653869629, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017414232715964317, decouple_loss:0.0008378965430893004
loss_pred:0.016767635941505432, decouple_loss:0.000746776582673192
loss_pred:0.017451219260692596, decouple_loss:0.0011486371513456106
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4415571093559265, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44534552097320557, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44287070631980896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017134185880422592, decouple_loss:0.00099572807084769
loss_pred:0.017197323963046074, decouple_loss:0.0010660906555131078
loss_pred:0.017374880611896515, decouple_loss:0.0009382595308125019
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471138119697571, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45006871223449707, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45059725642204285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016753628849983215, decouple_loss:0.0008890324388630688
loss_pred:0.01733880490064621, decouple_loss:0.0008514997316524386
loss_pred:0.0173028614372015, decouple_loss:0.0009512609103694558
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520251452922821, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45490404963493347, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45435190200805664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01660149171948433, decouple_loss:0.0008360613137483597
loss_pred:0.017048494890332222, decouple_loss:0.0008207178907468915
loss_pred:0.016924401745200157, decouple_loss:0.0007177120423875749
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788506627082825, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44490864872932434, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44665464758872986, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017537027597427368, decouple_loss:0.0008002417162060738
loss_pred:0.017022717744112015, decouple_loss:0.0008043544949032366
loss_pred:0.01728830672800541, decouple_loss:0.0007848462555557489
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4411444067955017, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44611093401908875, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4435643255710602, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016826767474412918, decouple_loss:0.0007751269731670618
loss_pred:0.01709732972085476, decouple_loss:0.0009706408600322902
loss_pred:0.017920874059200287, decouple_loss:0.0009281675447709858
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478432238101959, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44699662923812866, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4494105577468872, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016784364357590675, decouple_loss:0.0007855952717363834
loss_pred:0.016644367948174477, decouple_loss:0.000895230914466083
loss_pred:0.017060015350580215, decouple_loss:0.0008101282292045653
2023-05-26 21:19:42 testing...
The modified gen p mean: 0.44826507568359375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018579671159386635, decouple_loss:0.0008924046996980906
The modified gen p mean: 0.4487294852733612, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44923555850982666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018484661355614662, decouple_loss:0.0010447206441313028
loss_pred:0.018844695761799812, decouple_loss:0.0009803439024835825
WV_2_PC_0_EH_0_PS_40, loss: 0.01868496835231781, avg_mse: 0.025588182732462883
Best test mse: 0.025, current test mse: 0.02558800019323826
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45167529582977295, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45035746693611145, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44879812002182007, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01694360002875328, decouple_loss:0.0013493882725015283
loss_pred:0.01676327921450138, decouple_loss:0.0009213417069986463
loss_pred:0.01723308302462101, decouple_loss:0.0010055559687316418
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482353925704956, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44996240735054016, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44727256894111633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016802038997411728, decouple_loss:0.00119539606384933
loss_pred:0.017014607787132263, decouple_loss:0.0008153358940035105
loss_pred:0.01679665967822075, decouple_loss:0.0010337528074160218
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833728671073914, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4522058069705963, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4508703649044037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016879351809620857, decouple_loss:0.000806481868494302
loss_pred:0.01759372465312481, decouple_loss:0.0008147883345372975
loss_pred:0.016824934631586075, decouple_loss:0.0008852630853652954
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649502635002136, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4492371082305908, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4486750662326813, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017097273841500282, decouple_loss:0.0011225142516195774
loss_pred:0.016942519694566727, decouple_loss:0.0009095776476897299
loss_pred:0.016564402729272842, decouple_loss:0.0010449448600411415
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461098909378052, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44704145193099976, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4501982033252716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017260972410440445, decouple_loss:0.0008614183752797544
loss_pred:0.01661079376935959, decouple_loss:0.0008629823569208384
loss_pred:0.01703246310353279, decouple_loss:0.0009190079872496426
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685083627700806, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466923177242279, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44939857721328735, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017386220395565033, decouple_loss:0.0011895174393430352
loss_pred:0.016674062237143517, decouple_loss:0.0013286697212606668
loss_pred:0.01719820499420166, decouple_loss:0.0010827991645783186
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763946533203125, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4486844539642334, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44674134254455566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017138557508587837, decouple_loss:0.0010322468588128686
loss_pred:0.017027005553245544, decouple_loss:0.0013058027252554893
loss_pred:0.017048509791493416, decouple_loss:0.0011018177028745413
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44950971007347107, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.453284353017807, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45166125893592834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01683027483522892, decouple_loss:0.0007470032433047891
loss_pred:0.017022239044308662, decouple_loss:0.0008115536766126752
loss_pred:0.016470862552523613, decouple_loss:0.000804868817795068
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
NaN value num: 0
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923490285873413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016161276027560234, decouple_loss:0.0012848605401813984
The modified gen p mean: 0.45207276940345764, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.45023494958877563, gen p mean: 0.0, mean p set: 0.448

loss_pred:0.016493020579218864, decouple_loss:0.0011477036168798804
loss_pred:0.01738588698208332, decouple_loss:0.0012803057907149196
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44614851474761963, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44689086079597473, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471721649169922, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01589800789952278, decouple_loss:0.0013008421519771218
loss_pred:0.017393480986356735, decouple_loss:0.0009874071693047881
loss_pred:0.016450699418783188, decouple_loss:0.0010075110476464033
2023-05-26 21:22:50 testing...
The modified gen p mean: 0.44468995928764343, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01856178604066372, decouple_loss:0.0013848376693204045
The modified gen p mean: 0.44549277424812317, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4454815685749054, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01847059652209282, decouple_loss:0.001319546950981021
loss_pred:0.01886148378252983, decouple_loss:0.0014161227736622095
WV_2_PC_0_EH_0_PS_40, loss: 0.01869996450841427, avg_mse: 0.025573672726750374
Best test mse: 0.025, current test mse: 0.02557400055229664
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446926474571228, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44471606612205505, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44548317790031433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017046350985765457, decouple_loss:0.00099929329007864
loss_pred:0.01601254753768444, decouple_loss:0.0007492986042052507
loss_pred:0.01635497622191906, decouple_loss:0.0009683467214927077
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173612236976624, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4539080262184143, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44987621903419495, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016982126981019974, decouple_loss:0.0009297995129600167
loss_pred:0.017244642600417137, decouple_loss:0.0012740567326545715
loss_pred:0.01600782759487629, decouple_loss:0.001040272880345583
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530811011791229, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4500463902950287, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4524921476840973, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016359293833374977, decouple_loss:0.0010727220214903355
loss_pred:0.01737332157790661, decouple_loss:0.0009931474924087524
loss_pred:0.0166168212890625, decouple_loss:0.0011782904621213675
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459618031978607, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44658583402633667, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44596633315086365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016291340813040733, decouple_loss:0.0007969612488523126
loss_pred:0.016914093866944313, decouple_loss:0.0009158197790384293
loss_pred:0.016371477395296097, decouple_loss:0.0008568729972466826
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726139307022095, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44731801748275757, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4461176097393036, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016212912276387215, decouple_loss:0.0007155858911573887
loss_pred:0.015965094789862633, decouple_loss:0.0006729384185746312
loss_pred:0.016808807849884033, decouple_loss:0.0008678320446051657
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488157629966736, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44705185294151306, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4479866027832031, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016362376511096954, decouple_loss:0.0009645651443861425
loss_pred:0.016044246032834053, decouple_loss:0.0007616920629516244
loss_pred:0.016946494579315186, decouple_loss:0.0006978936144150794
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45226308703422546, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4521864354610443, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45122942328453064, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017200589179992676, decouple_loss:0.000855522055644542
loss_pred:0.01694297231733799, decouple_loss:0.0010892937425523996
loss_pred:0.016179800033569336, decouple_loss:0.0007623457349836826
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452533096075058, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4513818323612213, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4526546597480774, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016906391829252243, decouple_loss:0.0007311910740099847
loss_pred:0.01621769554913044, decouple_loss:0.0007064904784783721
loss_pred:0.016360925510525703, decouple_loss:0.0008149798377417028
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471395015716553, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4496992528438568, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4465857446193695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01667514629662037, decouple_loss:0.0010369858937337995
loss_pred:0.017649605870246887, decouple_loss:0.0008134415256790817
loss_pred:0.017481930553913116, decouple_loss:0.0007552754832431674
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44603273272514343, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471530318260193, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4462805390357971, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016196005046367645, decouple_loss:0.00112320261541754
loss_pred:0.016103334724903107, decouple_loss:0.0009347959421575069
loss_pred:0.017641639336943626, decouple_loss:0.0009278460056520998
2023-05-26 21:25:16 testing...
The modified gen p mean: 0.4474489986896515, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44792264699935913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018920782953500748, decouple_loss:0.0014724144712090492
loss_pred:0.018874768167734146, decouple_loss:0.0013723303563892841
The modified gen p mean: 0.4480191767215729, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019215229898691177, decouple_loss:0.0015675050672143698
WV_2_PC_0_EH_0_PS_40, loss: 0.019077133387327194, avg_mse: 0.026073787361383438
Best test mse: 0.025, current test mse: 0.02607399970293045
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502933919429779, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45185667276382446, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44857093691825867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016095830127596855, decouple_loss:0.0008957758545875549
loss_pred:0.016677016392350197, decouple_loss:0.001223879517056048
loss_pred:0.017399733886122704, decouple_loss:0.000707091938238591
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512387812137604, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45111382007598877, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4494417607784271, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016613025218248367, decouple_loss:0.0008624615729786456
loss_pred:0.01695777289569378, decouple_loss:0.0007975075859576464
loss_pred:0.01653498411178589, decouple_loss:0.0008738134056329727
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504304826259613, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44991111755371094, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44947654008865356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016762111335992813, decouple_loss:0.000809686491265893
loss_pred:0.01614965684711933, decouple_loss:0.0009678017231635749
loss_pred:0.016361277550458908, decouple_loss:0.0007219088729470968
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459875822067261, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44846779108047485, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44715064764022827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0162647757679224, decouple_loss:0.0010573401814326644
loss_pred:0.017204830422997475, decouple_loss:0.0008739869808778167
loss_pred:0.01612147130072117, decouple_loss:0.0008669262169860303
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470877945423126, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4493272006511688, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44755566120147705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016254030168056488, decouple_loss:0.0009140277397818863
loss_pred:0.017503486946225166, decouple_loss:0.0009057207498699427
loss_pred:0.016594113782048225, decouple_loss:0.0009308300213888288
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977325201034546, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44880804419517517, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44992876052856445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016321426257491112, decouple_loss:0.0010288633638992906
loss_pred:0.01648603193461895, decouple_loss:0.0008082793792709708
loss_pred:0.016654936596751213, decouple_loss:0.0007724760216660798
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489390552043915, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4479692280292511, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44837602972984314, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01744695007801056, decouple_loss:0.0008374633034691215
loss_pred:0.016418764367699623, decouple_loss:0.0008045422146096826
loss_pred:0.016633393242955208, decouple_loss:0.0010075275786221027
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478309750556946, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44805219769477844, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4483391344547272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016410889104008675, decouple_loss:0.0011867074063047767
loss_pred:0.016286298632621765, decouple_loss:0.0011727835517376661
loss_pred:0.016718275845050812, decouple_loss:0.00129818101413548
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483734369277954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017410848289728165, decouple_loss:0.0013635725481435657
The modified gen p mean: 0.44947704672813416, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4472286105155945, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01761213131248951, decouple_loss:0.0010625936556607485
loss_pred:0.017219211906194687, decouple_loss:0.0011700220638886094
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767385721206665, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44708937406539917, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4461691975593567, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01692141592502594, decouple_loss:0.0010172310285270214
loss_pred:0.016784029081463814, decouple_loss:0.0009049526415765285
loss_pred:0.01689712516963482, decouple_loss:0.0011244680499657989
2023-05-26 21:28:26 testing...
The modified gen p mean: 0.4495156705379486, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4503720700740814, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0187159962952137, decouple_loss:0.0016678976826369762
The modified gen p mean: 0.4500000476837158, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018668944016098976, decouple_loss:0.0019020667532458901
loss_pred:0.019058801233768463, decouple_loss:0.0016213767230510712
WV_2_PC_0_EH_0_PS_40, loss: 0.018901104107499123, avg_mse: 0.025825969874858856
Best test mse: 0.025, current test mse: 0.025825999677181244
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44976624846458435, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478398561477661, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45116111636161804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017054209485650063, decouple_loss:0.0014518311945721507
loss_pred:0.01647907868027687, decouple_loss:0.0015916068805381656
loss_pred:0.01750488020479679, decouple_loss:0.00162953429389745
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449764221906662, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4482375979423523, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44946983456611633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01645740680396557, decouple_loss:0.001249648630619049
loss_pred:0.016898352652788162, decouple_loss:0.0010583199327811599
loss_pred:0.01645088754594326, decouple_loss:0.0012186464155092835
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484001696109772, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488597512245178, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4450775384902954, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01663411408662796, decouple_loss:0.0009219708736054599
loss_pred:0.016283299773931503, decouple_loss:0.0008196833077818155
loss_pred:0.016819072887301445, decouple_loss:0.0009273726027458906
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456506371498108, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44651874899864197, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4454486072063446, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016148755326867104, decouple_loss:0.0013563494430854917
loss_pred:0.016918880864977837, decouple_loss:0.0014656106941401958
loss_pred:0.016905782744288445, decouple_loss:0.001175390207208693
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445831835269928, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44651687145233154, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44534698128700256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016662217676639557, decouple_loss:0.001114927465096116
loss_pred:0.017211174592375755, decouple_loss:0.0012617650208994746
loss_pred:0.01726355217397213, decouple_loss:0.0008203107281588018
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489993453025818, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4490414559841156, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44796067476272583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016546955332159996, decouple_loss:0.0010612308979034424
loss_pred:0.016576893627643585, decouple_loss:0.0011490336619317532
loss_pred:0.017300564795732498, decouple_loss:0.001188429188914597
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468972980976105, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4477507472038269, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44739601016044617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016665931791067123, decouple_loss:0.0010969397844746709
loss_pred:0.016322610899806023, decouple_loss:0.0012809825129806995
loss_pred:0.016813186928629875, decouple_loss:0.0010744492756202817
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888579845428467, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44956663250923157, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44790297746658325, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016948983073234558, decouple_loss:0.001045305747538805
loss_pred:0.01657908968627453, decouple_loss:0.0010996926575899124
loss_pred:0.01716218702495098, decouple_loss:0.0009910592343658209
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483470022678375, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44948500394821167, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44754984974861145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016480712220072746, decouple_loss:0.0012175320880487561
loss_pred:0.016704443842172623, decouple_loss:0.0012779044918715954
loss_pred:0.016915835440158844, decouple_loss:0.0010841130279004574
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487797021865845, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44884514808654785, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45137181878089905, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016724668443202972, decouple_loss:0.0013057154137641191
loss_pred:0.01718035340309143, decouple_loss:0.0010531579609960318
loss_pred:0.017100851982831955, decouple_loss:0.0012907263590022922
2023-05-26 21:30:51 testing...
The modified gen p mean: 0.44537413120269775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01861840859055519, decouple_loss:0.0008937690872699022
The modified gen p mean: 0.4459799826145172, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4460214078426361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018584853038191795, decouple_loss:0.0008126787724904716
loss_pred:0.018932616338133812, decouple_loss:0.0009286360582336783
WV_2_PC_0_EH_0_PS_40, loss: 0.018755877390503883, avg_mse: 0.025705209001898766
Best test mse: 0.025, current test mse: 0.02570500038564205
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654569029808044, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4440847635269165, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4463035762310028, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01684654876589775, decouple_loss:0.0010469754924997687
loss_pred:0.017186712473630905, decouple_loss:0.0009626889950595796
loss_pred:0.016683703288435936, decouple_loss:0.0010165221756324172
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4446907937526703, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44674378633499146, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4479525089263916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01612846925854683, decouple_loss:0.0009415671811439097
loss_pred:0.016702210530638695, decouple_loss:0.0008489135652780533
loss_pred:0.016784314066171646, decouple_loss:0.0009238020284101367
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827350974082947, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44573739171028137, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4479329288005829, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01764976978302002, decouple_loss:0.0009347962331958115
loss_pred:0.01610628142952919, decouple_loss:0.000809309771284461
loss_pred:0.01674354448914528, decouple_loss:0.0008841644739732146
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449885755777359, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4486581087112427, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44910871982574463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016247814521193504, decouple_loss:0.0008084794390015304
loss_pred:0.016449443995952606, decouple_loss:0.0008352893055416644
loss_pred:0.016880454495549202, decouple_loss:0.0007450548000633717
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482036232948303, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4492102563381195, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44922733306884766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017698178067803383, decouple_loss:0.000805713701993227
loss_pred:0.016767270863056183, decouple_loss:0.0008489348110742867
loss_pred:0.01718500442802906, decouple_loss:0.0008304830407723784
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693976640701294, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4464593231678009, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4477534890174866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016673607751727104, decouple_loss:0.0006809934857301414
loss_pred:0.016053853556513786, decouple_loss:0.0007020941702648997
loss_pred:0.016737263649702072, decouple_loss:0.0007175356149673462
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476015567779541, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45002710819244385, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4499328136444092, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016647618263959885, decouple_loss:0.001147656817920506
loss_pred:0.01585804671049118, decouple_loss:0.0009609711123630404
loss_pred:0.016880018636584282, decouple_loss:0.0009790718322619796
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606131315231323, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44849538803100586, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4482191801071167, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016546012833714485, decouple_loss:0.0007392546394839883
loss_pred:0.017166325822472572, decouple_loss:0.0006957697332836688
loss_pred:0.017417727038264275, decouple_loss:0.0007077627233229578
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
NaN value num: 0
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962719082832336, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016838328912854195, decouple_loss:0.000917318684514612
The modified gen p mean: 0.4475894868373871, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44968119263648987, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016887851059436798, decouple_loss:0.0010613864287734032
loss_pred:0.01628587394952774, decouple_loss:0.0012083940673619509
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466021656990051, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4510315954685211, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4474518299102783, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016269950196146965, decouple_loss:0.0011196298291906714
loss_pred:0.016818122938275337, decouple_loss:0.001375840394757688
loss_pred:0.016793783754110336, decouple_loss:0.0012909555807709694
2023-05-26 21:33:59 testing...
The modified gen p mean: 0.44321662187576294, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01861405000090599, decouple_loss:0.0019097549375146627
The modified gen p mean: 0.443761944770813, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4437096416950226, gen p mean: 0.0, mean p set: 0.448

loss_pred:0.018549157306551933, decouple_loss:0.0017355895834043622
loss_pred:0.018837036564946175, decouple_loss:0.001855584792792797
WV_2_PC_0_EH_0_PS_40, loss: 0.01875843107700348, avg_mse: 0.02558877505362034
Best test mse: 0.025, current test mse: 0.025589000433683395
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44627198576927185, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44737717509269714, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4468029737472534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016380244866013527, decouple_loss:0.0010203019483014941
loss_pred:0.016041358932852745, decouple_loss:0.0008729281253181398
loss_pred:0.01611086167395115, decouple_loss:0.0007573544862680137
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873949885368347, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44740599393844604, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45286405086517334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01639476791024208, decouple_loss:0.001447084709070623
loss_pred:0.01601138338446617, decouple_loss:0.001490351976826787
loss_pred:0.016825109720230103, decouple_loss:0.00108616822399199
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45230934023857117, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45270687341690063, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4531363546848297, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016258705407381058, decouple_loss:0.0015385197475552559
loss_pred:0.015603314153850079, decouple_loss:0.0015675575705245137
loss_pred:0.016000960022211075, decouple_loss:0.001597892725840211
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500463902950287, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.448230504989624, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44872716069221497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01603180170059204, decouple_loss:0.0016255107475444674
loss_pred:0.01674964278936386, decouple_loss:0.0016605207929387689
loss_pred:0.01628171280026436, decouple_loss:0.0013493011938408017
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455936849117279, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44914984703063965, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4460657238960266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01607024483382702, decouple_loss:0.0009581120684742928
loss_pred:0.01692899316549301, decouple_loss:0.0010020904010161757
loss_pred:0.01607663370668888, decouple_loss:0.0014713729033246636
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513685405254364, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4520776569843292, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4506956934928894, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015685470774769783, decouple_loss:0.0010101679945364594
loss_pred:0.016009986400604248, decouple_loss:0.0013355062110349536
loss_pred:0.016551584005355835, decouple_loss:0.0013227008748799562
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521465003490448, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44947490096092224, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4511495530605316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01615685038268566, decouple_loss:0.0012421064311638474
loss_pred:0.015904517844319344, decouple_loss:0.001278119278140366
loss_pred:0.015373372472822666, decouple_loss:0.0009157180902548134
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469328820705414, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44905486702919006, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45109042525291443, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01579384133219719, decouple_loss:0.0011322360951453447
loss_pred:0.015418574213981628, decouple_loss:0.0010427082888782024
loss_pred:0.015868982300162315, decouple_loss:0.0011234964476898313
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478693902492523, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44805753231048584, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4475088119506836, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015633363276720047, decouple_loss:0.0011092678178101778
loss_pred:0.015670696273446083, decouple_loss:0.0012235967442393303
loss_pred:0.015894567593932152, decouple_loss:0.0009973242413252592
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487714469432831, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44610944390296936, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44738754630088806, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015214403159916401, decouple_loss:0.0010284726740792394
loss_pred:0.01665492169559002, decouple_loss:0.0013162796385586262
loss_pred:0.016158156096935272, decouple_loss:0.0011886567808687687
2023-05-26 21:36:25 testing...
The modified gen p mean: 0.44654580950737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018692314624786377, decouple_loss:0.001621786504983902
The modified gen p mean: 0.44740960001945496, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471558630466461, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018547438085079193, decouple_loss:0.0016227441374212503
loss_pred:0.01883816346526146, decouple_loss:0.0015149634564295411
WV_2_PC_0_EH_0_PS_40, loss: 0.018771963194012642, avg_mse: 0.02573586441576481
Best test mse: 0.025, current test mse: 0.025736000388860703
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151910185813904, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44831815361976624, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45233863592147827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015502292662858963, decouple_loss:0.0015342111000791192
loss_pred:0.01612192578613758, decouple_loss:0.0011199817527085543
loss_pred:0.01574784889817238, decouple_loss:0.0014978783437982202
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494331181049347, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45073434710502625, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4480109214782715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0167598407715559, decouple_loss:0.0009040316799655557
loss_pred:0.016499333083629608, decouple_loss:0.0007117007626220584
loss_pred:0.015733039006590843, decouple_loss:0.0008901744149625301
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820475578308105, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4444176256656647, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4458659291267395, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01609036512672901, decouple_loss:0.0010887590469792485
loss_pred:0.01609858125448227, decouple_loss:0.001058693858794868
loss_pred:0.01623496226966381, decouple_loss:0.0010921981884166598
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512453079223633, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4476533532142639, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4474430978298187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01583307795226574, decouple_loss:0.0012645366368815303
loss_pred:0.01629951223731041, decouple_loss:0.0015054111136123538
loss_pred:0.016257168725132942, decouple_loss:0.0013866921653971076
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45061689615249634, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4545488655567169, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44915148615837097, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01630312390625477, decouple_loss:0.0012291957391425967
loss_pred:0.01574191078543663, decouple_loss:0.0010678090620785952
loss_pred:0.016034221276640892, decouple_loss:0.0011429247679188848
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734126329421997, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45261359214782715, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4519703984260559, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016086995601654053, decouple_loss:0.0009604921797290444
loss_pred:0.016383018344640732, decouple_loss:0.0012121022446081042
loss_pred:0.015753204002976418, decouple_loss:0.0009423791780136526
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.444784551858902, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.446381151676178, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44578200578689575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016049422323703766, decouple_loss:0.0011817236663773656
loss_pred:0.016766710206866264, decouple_loss:0.0010152930626645684
loss_pred:0.01649285852909088, decouple_loss:0.001279141753911972
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450383186340332, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44542402029037476, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4464429020881653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01576819457113743, decouple_loss:0.0007925204699859023
loss_pred:0.01606052555143833, decouple_loss:0.0008210273808799684
loss_pred:0.016519542783498764, decouple_loss:0.0008791381842456758
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
NaN value num: 0
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525371193885803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0169744361191988, decouple_loss:0.0011469763703644276
The modified gen p mean: 0.4524343013763428, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44767534732818604, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016642272472381592, decouple_loss:0.0012980959145352244
loss_pred:0.016034111380577087, decouple_loss:0.0010530698345974088
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155298709869385, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4505999684333801, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016389064490795135, decouple_loss:0.0009587201639078557
The modified gen p mean: 0.4524141550064087, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016119733452796936, decouple_loss:0.0008594856481067836
loss_pred:0.017234696075320244, decouple_loss:0.001170883304439485
2023-05-26 21:39:36 testing...
The modified gen p mean: 0.4465930759906769, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01853315718472004, decouple_loss:0.0016525688115507364
The modified gen p mean: 0.447496622800827, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44747528433799744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018424296751618385, decouple_loss:0.0015364839928224683
loss_pred:0.018723737448453903, decouple_loss:0.0014556944370269775
WV_2_PC_0_EH_0_PS_40, loss: 0.01863780990242958, avg_mse: 0.025523047894239426
Best test mse: 0.025, current test mse: 0.025522999465465546
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45177140831947327, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45297205448150635, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45028918981552124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01629108376801014, decouple_loss:0.0009872729424387217
loss_pred:0.015739869326353073, decouple_loss:0.0009746022406034172
loss_pred:0.0158733781427145, decouple_loss:0.0008161921869032085
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449922114610672, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4498164653778076, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44802412390708923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016126682981848717, decouple_loss:0.0010804430348798633
loss_pred:0.016974465921521187, decouple_loss:0.0011618247954174876
loss_pred:0.01683700829744339, decouple_loss:0.0016847583465278149
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44650623202323914, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4451735317707062, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44328123331069946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016253875568509102, decouple_loss:0.0008010702440515161
loss_pred:0.01582692191004753, decouple_loss:0.0008240424212999642
loss_pred:0.01662415638566017, decouple_loss:0.0008754321024753153
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955575466156006, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4494480788707733, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45190465450286865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01620194874703884, decouple_loss:0.0008159438148140907
loss_pred:0.016488855704665184, decouple_loss:0.0010164668783545494
loss_pred:0.016896499320864677, decouple_loss:0.0009248890564776957
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45552340149879456, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4517824351787567, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4561190903186798, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016137119382619858, decouple_loss:0.0010522390948608518
loss_pred:0.016080357134342194, decouple_loss:0.0009016094845719635
loss_pred:0.016842978075146675, decouple_loss:0.0007492223521694541
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041558146476746, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45186886191368103, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.453424334526062, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016049185767769814, decouple_loss:0.0011530793271958828
loss_pred:0.016207080334424973, decouple_loss:0.0013191452017053962
loss_pred:0.016285840421915054, decouple_loss:0.0013709129998460412
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486154317855835, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478573799133301, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44804224371910095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015682296827435493, decouple_loss:0.0010824992787092924
loss_pred:0.015963107347488403, decouple_loss:0.0008877651998773217
loss_pred:0.015867603942751884, decouple_loss:0.000832128687761724
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44351664185523987, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44545304775238037, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44836053252220154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015881408005952835, decouple_loss:0.0008029176387935877
loss_pred:0.016406619921326637, decouple_loss:0.0009285751730203629
loss_pred:0.015939932316541672, decouple_loss:0.0009191501885652542
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502069652080536, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.451227068901062, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4485730230808258, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015823552384972572, decouple_loss:0.0007069433922879398
loss_pred:0.016911888495087624, decouple_loss:0.0009398364345543087
loss_pred:0.016393737867474556, decouple_loss:0.0009481451124884188
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45621660351753235, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4573323428630829, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4541820287704468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016192933544516563, decouple_loss:0.0007926401449367404
loss_pred:0.016505926847457886, decouple_loss:0.0008022433030419052
loss_pred:0.015875816345214844, decouple_loss:0.0007507678819820285
2023-05-26 21:42:02 testing...
The modified gen p mean: 0.44301837682724, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4438660740852356, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01863531768321991, decouple_loss:0.001493326504714787
loss_pred:0.018519658595323563, decouple_loss:0.0012566887307912111
The modified gen p mean: 0.4437521696090698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018826747313141823, decouple_loss:0.001317095011472702
WV_2_PC_0_EH_0_PS_40, loss: 0.018728360533714294, avg_mse: 0.02569059282541275
Best test mse: 0.025, current test mse: 0.025691000744700432
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102769136428833, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4470328986644745, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4468245208263397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015992242842912674, decouple_loss:0.0009386369492858648
loss_pred:0.015968212857842445, decouple_loss:0.0009087388752959669
loss_pred:0.016264913603663445, decouple_loss:0.0010854562278836966
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4438264071941376, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44595491886138916, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4449104070663452, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017360452562570572, decouple_loss:0.0006648331764154136
loss_pred:0.0166156068444252, decouple_loss:0.0007562802056781948
loss_pred:0.016974251717329025, decouple_loss:0.0006653628079220653
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492393136024475, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44976434111595154, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4494084119796753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016566721722483635, decouple_loss:0.0009183617075905204
loss_pred:0.016596997156739235, decouple_loss:0.000851607823278755
loss_pred:0.016051780432462692, decouple_loss:0.0008194510592147708
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45559003949165344, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4551698565483093, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45510369539260864, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017070632427930832, decouple_loss:0.0009103344054892659
loss_pred:0.01603420451283455, decouple_loss:0.0007980059017427266
loss_pred:0.017018500715494156, decouple_loss:0.0009284294792450964
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031222701072693, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45049968361854553, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4499166011810303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016199778765439987, decouple_loss:0.0007523632375523448
loss_pred:0.01692015305161476, decouple_loss:0.0008576072286814451
loss_pred:0.016857154667377472, decouple_loss:0.0008983236039057374
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.444655179977417, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44552484154701233, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4485742747783661, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01676388829946518, decouple_loss:0.0007068898994475603
loss_pred:0.017661726102232933, decouple_loss:0.0008297484600916505
loss_pred:0.016499169170856476, decouple_loss:0.0006916355341672897
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472660422325134, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4472857713699341, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45016562938690186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017540868371725082, decouple_loss:0.0006504898192360997
loss_pred:0.01687726564705372, decouple_loss:0.0006215137545950711
loss_pred:0.015835169702768326, decouple_loss:0.0006382910069078207
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962069392204285, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45248132944107056, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4504319429397583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015831442549824715, decouple_loss:0.0007829922833479941
loss_pred:0.015874840319156647, decouple_loss:0.001134829013608396
loss_pred:0.015691496431827545, decouple_loss:0.0009381684940308332
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
NaN value num: 0
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45111283659935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016496453434228897, decouple_loss:0.0009955307468771935
The modified gen p mean: 0.45272624492645264, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45046475529670715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017122680321335793, decouple_loss:0.0010932197328656912
loss_pred:0.01701592095196247, decouple_loss:0.0011309109395369887
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499475657939911, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44908615946769714, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45700061321258545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015904108062386513, decouple_loss:0.0011057667434215546
loss_pred:0.016560545191168785, decouple_loss:0.001014815759845078
loss_pred:0.015998492017388344, decouple_loss:0.000729723775293678
2023-05-26 21:45:17 testing...
The modified gen p mean: 0.44401898980140686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018559744581580162, decouple_loss:0.0009640000062063336
The modified gen p mean: 0.44460529088974, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44470128417015076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018519490957260132, decouple_loss:0.0009601681958884001
loss_pred:0.018824990838766098, decouple_loss:0.0008418493089266121
WV_2_PC_0_EH_0_PS_40, loss: 0.018680842593312263, avg_mse: 0.025658898055553436
Best test mse: 0.025, current test mse: 0.025659000501036644
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534704387187958, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4497837722301483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015829816460609436, decouple_loss:0.0007937246118672192
loss_pred:0.017307765781879425, decouple_loss:0.0007868277607485652
The modified gen p mean: 0.45432302355766296, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015618524514138699, decouple_loss:0.0007751240045763552
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445559024810791, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.445780485868454, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44914230704307556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016213838011026382, decouple_loss:0.001143281115218997
loss_pred:0.01695340685546398, decouple_loss:0.0008735330193303525
loss_pred:0.01641009747982025, decouple_loss:0.001035391236655414
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516220986843109, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4544202983379364, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45611220598220825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01643707975745201, decouple_loss:0.0006706855492666364
loss_pred:0.016015129163861275, decouple_loss:0.0006644282257184386
loss_pred:0.016140839084982872, decouple_loss:0.0008555909735150635
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45444855093955994, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45371225476264954, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4559401273727417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01618402637541294, decouple_loss:0.0009176578023470938
loss_pred:0.01611405611038208, decouple_loss:0.0010474312584847212
loss_pred:0.015896696597337723, decouple_loss:0.0007040381315164268
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502546787261963, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45044687390327454, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4506438970565796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017212651669979095, decouple_loss:0.001223366940394044
loss_pred:0.016304869204759598, decouple_loss:0.0010740956058725715
loss_pred:0.01660425402224064, decouple_loss:0.0012934068217873573
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45428717136383057, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4484882354736328, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4505805969238281, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01583768054842949, decouple_loss:0.0007857290911488235
loss_pred:0.017148934304714203, decouple_loss:0.0009833724470809102
loss_pred:0.01663799211382866, decouple_loss:0.0009316178620792925
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449887216091156, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45326316356658936, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4506332278251648, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016705961897969246, decouple_loss:0.0009499226580373943
loss_pred:0.016480663791298866, decouple_loss:0.0007962175877764821
loss_pred:0.016697674989700317, decouple_loss:0.0008032161276787519
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477614462375641, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4516412317752838, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016815531998872757, decouple_loss:0.0010365747148171067
loss_pred:0.015908583998680115, decouple_loss:0.0008109866175800562
The modified gen p mean: 0.4488537311553955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01675737090408802, decouple_loss:0.0007376529392786324
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485253095626831, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4527006447315216, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44586315751075745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017256075516343117, decouple_loss:0.0007479565683752298
loss_pred:0.015647253021597862, decouple_loss:0.0006602053763344884
loss_pred:0.0172700397670269, decouple_loss:0.0006557040032930672
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533287584781647, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4492937922477722, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45039549469947815, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01588553749024868, decouple_loss:0.0007334892870858312
loss_pred:0.017062345519661903, decouple_loss:0.0007562640239484608
loss_pred:0.016048463061451912, decouple_loss:0.0008403663523495197
2023-05-26 21:47:45 testing...
The modified gen p mean: 0.44709786772727966, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4475695788860321, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01854841038584709, decouple_loss:0.0007602161495015025
The modified gen p mean: 0.44817695021629333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018517378717660904, decouple_loss:0.000749991275370121
loss_pred:0.01882694847881794, decouple_loss:0.0008046726579777896
WV_2_PC_0_EH_0_PS_40, loss: 0.018669493496418, avg_mse: 0.025667984038591385
Best test mse: 0.025, current test mse: 0.025668000802397728
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536179006099701, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4484756290912628, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4521390497684479, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01707521267235279, decouple_loss:0.0006448447820730507
loss_pred:0.016156518831849098, decouple_loss:0.0008209152729250491
loss_pred:0.016590462997555733, decouple_loss:0.0006725522107444704
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489338994026184, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4518105685710907, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44987767934799194, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016030408442020416, decouple_loss:0.0008239854942075908
loss_pred:0.015668047592043877, decouple_loss:0.001003228360787034
loss_pred:0.016506562009453773, decouple_loss:0.0009818318067118526
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498447775840759, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4524518847465515, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45399394631385803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01719326339662075, decouple_loss:0.0011435056803748012
loss_pred:0.0169586930423975, decouple_loss:0.0009101742180064321
loss_pred:0.016550110653042793, decouple_loss:0.0008727774838916957
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033660531044006, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4495867192745209, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4543077349662781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016162084415555, decouple_loss:0.0008678825688548386
loss_pred:0.016973624005913734, decouple_loss:0.000877097831107676
loss_pred:0.01658307947218418, decouple_loss:0.0011281589977443218
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769957661628723, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44839540123939514, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4516524076461792, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016552334651350975, decouple_loss:0.0008720708428882062
loss_pred:0.016655176877975464, decouple_loss:0.0009927264181897044
loss_pred:0.01600455492734909, decouple_loss:0.0011352875735610723
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497695863246918, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4500483572483063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016374779865145683, decouple_loss:0.000877644750289619
loss_pred:0.016210537403821945, decouple_loss:0.0008155531249940395
The modified gen p mean: 0.44995707273483276, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01735779643058777, decouple_loss:0.0008891078759916127
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499291777610779, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45420730113983154, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01576125994324684, decouple_loss:0.0008298386819660664
loss_pred:0.015471328049898148, decouple_loss:0.0007251930655911565
The modified gen p mean: 0.4529804587364197, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0162646621465683, decouple_loss:0.0008240315946750343
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484122395515442, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4493809938430786, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4476589262485504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015623584389686584, decouple_loss:0.000686832529027015
loss_pred:0.016513800248503685, decouple_loss:0.000699578900821507
loss_pred:0.016386283561587334, decouple_loss:0.0006714801420457661
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
NaN value num: 0
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487311840057373, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01804349385201931, decouple_loss:0.0006959057645872235
The modified gen p mean: 0.44725704193115234, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44848668575286865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017382919788360596, decouple_loss:0.0008010733872652054
loss_pred:0.018203362822532654, decouple_loss:0.0008240228635258973
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475882649421692, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45000702142715454, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4487578868865967, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017742851749062538, decouple_loss:0.0007448865799233317
loss_pred:0.017128247767686844, decouple_loss:0.0010523729724809527
loss_pred:0.017489055171608925, decouple_loss:0.0009796360973268747
2023-05-26 21:50:55 testing...
The modified gen p mean: 0.44616052508354187, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466032087802887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01846233382821083, decouple_loss:0.0008317554602399468
The modified gen p mean: 0.44712579250335693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018411586061120033, decouple_loss:0.0009938882431015372
loss_pred:0.018705617636442184, decouple_loss:0.0009653142187744379
WV_2_PC_0_EH_0_PS_40, loss: 0.018573028966784477, avg_mse: 0.025485528632998466
Best test mse: 0.025, current test mse: 0.025485999882221222
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782549142837524, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.449592649936676, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44769594073295593, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017702553421258926, decouple_loss:0.0008614189573563635
loss_pred:0.01720927096903324, decouple_loss:0.0008392934687435627
loss_pred:0.017763972282409668, decouple_loss:0.0009243234526365995
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44350922107696533, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4460033178329468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01793690398335457, decouple_loss:0.0010603399714455009
loss_pred:0.01751265674829483, decouple_loss:0.0009641022188588977
The modified gen p mean: 0.4458267092704773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017261244356632233, decouple_loss:0.001193628879263997
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44508522748947144, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4442669749259949, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.446662575006485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01791633479297161, decouple_loss:0.0007556125638075173
loss_pred:0.016960561275482178, decouple_loss:0.001093185623176396
loss_pred:0.017264211550354958, decouple_loss:0.0010680380510166287
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082440972328186, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4485238194465637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01677757129073143, decouple_loss:0.0009274143958464265
loss_pred:0.017905209213495255, decouple_loss:0.0010736602125689387
The modified gen p mean: 0.44976648688316345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017104294151067734, decouple_loss:0.0010013143764808774
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488944113254547, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488072693347931, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4457724094390869, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016741398721933365, decouple_loss:0.00092025549383834
loss_pred:0.017090801149606705, decouple_loss:0.0008563824812881649
loss_pred:0.0164781641215086, decouple_loss:0.0006573544233106077
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667848944664, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4491686522960663, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44618597626686096, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017657026648521423, decouple_loss:0.000901771301869303
loss_pred:0.01660114713013172, decouple_loss:0.0008632004610262811
loss_pred:0.017783867195248604, decouple_loss:0.0007998531800694764
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44534870982170105, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4452987611293793, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4474625885486603, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01828186586499214, decouple_loss:0.0010688595939427614
loss_pred:0.01651490479707718, decouple_loss:0.000992323039099574
loss_pred:0.0171955693513155, decouple_loss:0.0009898018324747682
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956454634666443, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488183856010437, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44730502367019653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01783796027302742, decouple_loss:0.0007212947821244597
loss_pred:0.017452877014875412, decouple_loss:0.0007042190409265459
loss_pred:0.016423692926764488, decouple_loss:0.0005891000619158149
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449873685836792, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4509877860546112, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45034778118133545, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017255917191505432, decouple_loss:0.0007206656155176461
loss_pred:0.017685316503047943, decouple_loss:0.000879904255270958
loss_pred:0.016204247251152992, decouple_loss:0.0008979931590147316
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455224871635437, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4463545083999634, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4453867971897125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01776709035038948, decouple_loss:0.0006664277752861381
loss_pred:0.016939155757427216, decouple_loss:0.0008350193384103477
loss_pred:0.01655436120927334, decouple_loss:0.0009243889944627881
2023-05-26 21:53:17 testing...
The modified gen p mean: 0.44460487365722656, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44491517543792725, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01856308802962303, decouple_loss:0.0006209065904840827
The modified gen p mean: 0.44533130526542664, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018625807017087936, decouple_loss:0.0008017970831133425
loss_pred:0.018821047618985176, decouple_loss:0.0006827883189544082
WV_2_PC_0_EH_0_PS_40, loss: 0.01870507374405861, avg_mse: 0.025758804753422737
Best test mse: 0.025, current test mse: 0.025759000331163406
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459841251373291, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44464680552482605, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4449406564235687, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01697431318461895, decouple_loss:0.0009316731011494994
loss_pred:0.018140405416488647, decouple_loss:0.0006084637134335935
loss_pred:0.01648765802383423, decouple_loss:0.0006805129232816398
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010021328926086, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44862550497055054, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45117321610450745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017941445112228394, decouple_loss:0.000912520510610193
loss_pred:0.016705282032489777, decouple_loss:0.0007493705488741398
loss_pred:0.01817852258682251, decouple_loss:0.0008006252464838326
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457493722438812, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4470868408679962, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44596990942955017, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017458036541938782, decouple_loss:0.0006920404848642647
loss_pred:0.016404112800955772, decouple_loss:0.0006831080536358058
loss_pred:0.017723331227898598, decouple_loss:0.0008400934166274965
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462469220161438, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44844990968704224, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44673866033554077, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01767570897936821, decouple_loss:0.000819852517452091
loss_pred:0.016880225390195847, decouple_loss:0.0013047287939116359
loss_pred:0.018139930441975594, decouple_loss:0.000742188305594027
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466247260570526, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4477841258049011, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44855034351348877, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01622682809829712, decouple_loss:0.0007440165500156581
loss_pred:0.0164150670170784, decouple_loss:0.0009207288385368884
loss_pred:0.01791311986744404, decouple_loss:0.0009929824154824018
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448641300201416, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4514319598674774, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488014876842499, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01721358858048916, decouple_loss:0.0007283175364136696
loss_pred:0.017172375693917274, decouple_loss:0.00085230398690328
loss_pred:0.01667747087776661, decouple_loss:0.0008091395138762891
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44583097100257874, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478263854980469, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017372632399201393, decouple_loss:0.0008633814286440611
The modified gen p mean: 0.446655809879303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0167301744222641, decouple_loss:0.000835973012726754
loss_pred:0.017742149531841278, decouple_loss:0.0007566867861896753
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4446026384830475, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4476240575313568, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4444466829299927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017712119966745377, decouple_loss:0.0006330146570689976
loss_pred:0.016732944175601006, decouple_loss:0.0007251878269016743
loss_pred:0.016762755811214447, decouple_loss:0.0006006686598993838
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977784156799316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017173677682876587, decouple_loss:0.0008277975139208138
The modified gen p mean: 0.44798243045806885, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4503319561481476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017534688115119934, decouple_loss:0.0009821803541854024
loss_pred:0.017143499106168747, decouple_loss:0.001185412984341383
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668838381767273, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44834011793136597, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45101693272590637, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016294753178954124, decouple_loss:0.0007192668272182345
loss_pred:0.016289982944726944, decouple_loss:0.0009028875501826406
loss_pred:0.01720440573990345, decouple_loss:0.0007357964059337974
2023-05-26 21:56:24 testing...
The modified gen p mean: 0.4453546106815338, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44578906893730164, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01847085729241371, decouple_loss:0.0007933324668556452
The modified gen p mean: 0.44582268595695496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018447859212756157, decouple_loss:0.0007949966820888221
loss_pred:0.018720116466283798, decouple_loss:0.000947970780543983
WV_2_PC_0_EH_0_PS_40, loss: 0.01858855038881302, avg_mse: 0.02553587034344673
Best test mse: 0.025, current test mse: 0.025536000728607178
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44515401124954224, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4481559693813324, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44961386919021606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016872186213731766, decouple_loss:0.0009531312389299273
loss_pred:0.01635291799902916, decouple_loss:0.0006604712689295411
loss_pred:0.017204727977514267, decouple_loss:0.0007338384166359901
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460484981536865, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4461917281150818, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44410040974617004, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01659238338470459, decouple_loss:0.0007610831526108086
loss_pred:0.015885448083281517, decouple_loss:0.0007692758808843791
loss_pred:0.016334418207406998, decouple_loss:0.0008581011206842959
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076990127563477, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45273658633232117, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44914594292640686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017016611993312836, decouple_loss:0.0007259403355419636
loss_pred:0.016134113073349, decouple_loss:0.0007806576322764158
loss_pred:0.01615508273243904, decouple_loss:0.0005449646851047873
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906535744667053, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478318393230438, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016534456983208656, decouple_loss:0.000893591670319438
The modified gen p mean: 0.44991710782051086, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01698729209601879, decouple_loss:0.0007983463583514094
loss_pred:0.016292307525873184, decouple_loss:0.0006613256991840899
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008227229118347, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4509296417236328, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4481487274169922, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016814688220620155, decouple_loss:0.0007902861689217389
loss_pred:0.016796009615063667, decouple_loss:0.0007500514038838446
loss_pred:0.016398010775446892, decouple_loss:0.0008351865108124912
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44517871737480164, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44744518399238586, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44631847739219666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016380801796913147, decouple_loss:0.0006010650540702045
loss_pred:0.01717839017510414, decouple_loss:0.0006460161530412734
loss_pred:0.016872292384505272, decouple_loss:0.0006624246016144753
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44513118267059326, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488665461540222, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44465041160583496, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016042446717619896, decouple_loss:0.0006200032657943666
loss_pred:0.016951914876699448, decouple_loss:0.0006061585736460984
loss_pred:0.01656150259077549, decouple_loss:0.000686305109411478
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499940276145935, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44825294613838196, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44857949018478394, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016377722844481468, decouple_loss:0.0006867586052976549
loss_pred:0.016107503324747086, decouple_loss:0.0007531024166382849
loss_pred:0.016984784975647926, decouple_loss:0.0008486097794957459
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934678077697754, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4481066167354584, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4547664523124695, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017034543678164482, decouple_loss:0.000610306509770453
loss_pred:0.016187269240617752, decouple_loss:0.0006559277535416186
loss_pred:0.01715789921581745, decouple_loss:0.0005659161834046245
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464229643344879, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4472998082637787, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4491649270057678, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016383105888962746, decouple_loss:0.0006897522252984345
loss_pred:0.015937864780426025, decouple_loss:0.00063499336829409
loss_pred:0.01655173860490322, decouple_loss:0.0006020530709065497
2023-05-26 21:58:49 testing...
The modified gen p mean: 0.4452012777328491, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018465334549546242, decouple_loss:0.0006102129118517041
The modified gen p mean: 0.4457269012928009, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4459708034992218, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01846453733742237, decouple_loss:0.0007215820369310677
loss_pred:0.018791332840919495, decouple_loss:0.0006445947219617665
WV_2_PC_0_EH_0_PS_40, loss: 0.018606675788760185, avg_mse: 0.025590630248188972
Best test mse: 0.025, current test mse: 0.02559100091457367
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446962833404541, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466380178928375, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.447359561920166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016939638182520866, decouple_loss:0.0006050827796570957
loss_pred:0.016856128349900246, decouple_loss:0.0006095533608458936
loss_pred:0.01621374860405922, decouple_loss:0.0005963772418908775
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890663027763367, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44749608635902405, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45021355152130127, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016948863863945007, decouple_loss:0.0007570642628706992
loss_pred:0.01658957079052925, decouple_loss:0.0006121184560470283
loss_pred:0.016770729795098305, decouple_loss:0.0006824712618254125
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472174048423767, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45011526346206665, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4477924406528473, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017076704651117325, decouple_loss:0.000693738751579076
loss_pred:0.01712772250175476, decouple_loss:0.0006927153444848955
loss_pred:0.016771944239735603, decouple_loss:0.0005661598406732082
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722476601600647, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44965624809265137, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4479127526283264, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01600997895002365, decouple_loss:0.0006443177699111402
loss_pred:0.0170064028352499, decouple_loss:0.0006287291180342436
loss_pred:0.016595354303717613, decouple_loss:0.0006986981607042253
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827383756637573, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4497724771499634, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44834890961647034, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016216671094298363, decouple_loss:0.000625890213996172
loss_pred:0.015950676053762436, decouple_loss:0.0006124192150309682
loss_pred:0.016464436426758766, decouple_loss:0.0006650924915447831
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870585203170776, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45175763964653015, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4479883313179016, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016859926283359528, decouple_loss:0.0007964621181599796
loss_pred:0.01669987104833126, decouple_loss:0.000836895895190537
loss_pred:0.016939137130975723, decouple_loss:0.0008075214573182166
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505194425582886, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4501780867576599, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45083481073379517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017369842156767845, decouple_loss:0.0005354321328923106
loss_pred:0.01609080098569393, decouple_loss:0.0007083361851982772
loss_pred:0.01697162166237831, decouple_loss:0.0006640107603743672
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4436586797237396, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44543975591659546, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4453701376914978, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016340011730790138, decouple_loss:0.0007886805688031018
loss_pred:0.016715440899133682, decouple_loss:0.0007682410650886595
loss_pred:0.01604394242167473, decouple_loss:0.000792287290096283
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
NaN value num: 0
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478646516799927, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01915747858583927, decouple_loss:0.0008184168254956603
The modified gen p mean: 0.4475865364074707, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4463118314743042, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017603224143385887, decouple_loss:0.0007871915586292744
loss_pred:0.017657531425356865, decouple_loss:0.000751083716750145
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45257890224456787, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4520460367202759, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45113497972488403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01734575442969799, decouple_loss:0.0008667031652294099
loss_pred:0.01755879446864128, decouple_loss:0.0009637541952542961
loss_pred:0.017706578597426414, decouple_loss:0.0006211232393980026
2023-05-26 22:02:08 testing...
The modified gen p mean: 0.4479704201221466, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4489445984363556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018384383991360664, decouple_loss:0.000875851372256875
The modified gen p mean: 0.4485976994037628, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018376309424638748, decouple_loss:0.0009753360645845532
loss_pred:0.018665513023734093, decouple_loss:0.0010036637540906668
WV_2_PC_0_EH_0_PS_40, loss: 0.01852298341691494, avg_mse: 0.025417720898985863
Best test mse: 0.025, current test mse: 0.025418000295758247
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511193335056305, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488877058029175, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44968926906585693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017554793506860733, decouple_loss:0.0008768225088715553
loss_pred:0.01736888475716114, decouple_loss:0.0007600961835123599
loss_pred:0.017426546663045883, decouple_loss:0.000863135966937989
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4437492787837982, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44344523549079895, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44317862391471863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017772071063518524, decouple_loss:0.00076910579809919
loss_pred:0.01761012338101864, decouple_loss:0.0008491501794196665
loss_pred:0.01651715114712715, decouple_loss:0.0011193902464583516
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448793828487396, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44373130798339844, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4425843060016632, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017746014520525932, decouple_loss:0.0006843914743512869
loss_pred:0.017341505736112595, decouple_loss:0.001028180355206132
loss_pred:0.016777537763118744, decouple_loss:0.0007283496088348329
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987714290618896, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44861409068107605, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488861858844757, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016725784167647362, decouple_loss:0.0006253372994251549
loss_pred:0.01715659536421299, decouple_loss:0.0008742534555494785
loss_pred:0.017483072355389595, decouple_loss:0.0007868699613027275
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827383756637573, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45028918981552124, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45012709498405457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017602860927581787, decouple_loss:0.000956150412093848
loss_pred:0.016803806647658348, decouple_loss:0.0007490115240216255
loss_pred:0.017550254240632057, decouple_loss:0.000696266652084887
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481763243675232, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4493153691291809, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4484502673149109, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01688569039106369, decouple_loss:0.0007723273010924459
loss_pred:0.017661476507782936, decouple_loss:0.0008425532141700387
loss_pred:0.01753372699022293, decouple_loss:0.0008029414457269013
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445097953081131, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4470321238040924, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4474075138568878, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017605310305953026, decouple_loss:0.0008135624811984599
loss_pred:0.01766069047152996, decouple_loss:0.0006796953384764493
loss_pred:0.01753563992679119, decouple_loss:0.0006137161981314421
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44487378001213074, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4456734359264374, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.444577693939209, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01905307173728943, decouple_loss:0.0006604515365324914
loss_pred:0.01654183864593506, decouple_loss:0.0007046589162200689
loss_pred:0.01698775589466095, decouple_loss:0.0005936701782047749
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488513767719269, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.447427362203598, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4479184150695801, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018753081560134888, decouple_loss:0.0008482643752358854
loss_pred:0.01853175275027752, decouple_loss:0.0007967374986037612
loss_pred:0.01763584464788437, decouple_loss:0.0006044143228791654
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44916102290153503, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488541781902313, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4516959488391876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018215185031294823, decouple_loss:0.0005803886451758444
loss_pred:0.01693694479763508, decouple_loss:0.0006279522203840315
loss_pred:0.01733577437698841, decouple_loss:0.0005918797687627375
2023-05-26 22:04:33 testing...
The modified gen p mean: 0.44768574833869934, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018493015319108963, decouple_loss:0.0008818264468573034
The modified gen p mean: 0.44842755794525146, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4486800730228424, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018502365797758102, decouple_loss:0.0009838681435212493
loss_pred:0.018744073808193207, decouple_loss:0.0009237597114406526
WV_2_PC_0_EH_0_PS_40, loss: 0.01862630993127823, avg_mse: 0.025608139112591743
Best test mse: 0.025, current test mse: 0.02560799941420555
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485495090484619, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44819459319114685, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44994059205055237, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01729224994778633, decouple_loss:0.0007615491049364209
loss_pred:0.017755882814526558, decouple_loss:0.0007595205097459257
loss_pred:0.016341999173164368, decouple_loss:0.0007711884682066739
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459232687950134, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44862833619117737, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466293454170227, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01678909733891487, decouple_loss:0.0008183902828022838
loss_pred:0.017278781160712242, decouple_loss:0.0006165079539641738
loss_pred:0.01745346002280712, decouple_loss:0.0007815134013071656
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452781081199646, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44546666741371155, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44687071442604065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.019077932462096214, decouple_loss:0.0006402014405466616
loss_pred:0.0176375862210989, decouple_loss:0.0006363192806020379
loss_pred:0.01712998002767563, decouple_loss:0.0006532562547363341
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474199414253235, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4456164836883545, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44913819432258606, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01623842678964138, decouple_loss:0.0009162353817373514
loss_pred:0.01659512333571911, decouple_loss:0.0006039537256583571
loss_pred:0.016932327300310135, decouple_loss:0.0007579096709378064
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894570112228394, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4483514428138733, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.450070858001709, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01728074997663498, decouple_loss:0.0007880613557063043
loss_pred:0.016616707667708397, decouple_loss:0.0007115513435564935
loss_pred:0.017300637438893318, decouple_loss:0.0007776851416565478
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973134994506836, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4495474696159363, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44841983914375305, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016707928851246834, decouple_loss:0.000576070393435657
loss_pred:0.01746710203588009, decouple_loss:0.0008085313020274043
loss_pred:0.019025499001145363, decouple_loss:0.000844249501824379
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461597204208374, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4460941255092621, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4464629292488098, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017485782504081726, decouple_loss:0.0007033157744444907
loss_pred:0.017374834045767784, decouple_loss:0.0005210203235037625
loss_pred:0.01743495836853981, decouple_loss:0.0005001145764254034
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44393429160118103, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4461836814880371, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4445149004459381, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016662156209349632, decouple_loss:0.0007016190211288631
loss_pred:0.016711579635739326, decouple_loss:0.0011405493132770061
loss_pred:0.017205093055963516, decouple_loss:0.0006734348717145622
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485654830932617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0171949602663517, decouple_loss:0.0006273031467571855
The modified gen p mean: 0.4493168890476227, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4498198330402374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017156900838017464, decouple_loss:0.0006016534753143787
loss_pred:0.017279811203479767, decouple_loss:0.0006653498276136816
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449064165353775, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44902417063713074, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4502784013748169, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016937246546149254, decouple_loss:0.0004946131375618279
loss_pred:0.016972526907920837, decouple_loss:0.0008231974788941443
loss_pred:0.017661472782492638, decouple_loss:0.0006161236669868231
2023-05-26 22:07:57 testing...
The modified gen p mean: 0.44567233324050903, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018493512645363808, decouple_loss:0.0006468435749411583
The modified gen p mean: 0.44636598229408264, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4466223120689392, gen p mean: 0.0, mean p set: 0.448

loss_pred:0.018496250733733177, decouple_loss:0.0006367834866978228
loss_pred:0.01869203895330429, decouple_loss:0.0007083259406499565
WV_2_PC_0_EH_0_PS_40, loss: 0.0185938011854887, avg_mse: 0.0255832951515913
Best test mse: 0.025, current test mse: 0.025583000853657722
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482676088809967, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44769522547721863, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44513440132141113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017281176522374153, decouple_loss:0.0006967347580939531
loss_pred:0.017353130504488945, decouple_loss:0.0006290810997597873
loss_pred:0.017032738775014877, decouple_loss:0.000751651416067034
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450945258140564, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44654229283332825, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4447157382965088, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01731402426958084, decouple_loss:0.0006270023295655847
loss_pred:0.0172831229865551, decouple_loss:0.0006006767507642508
loss_pred:0.017663152888417244, decouple_loss:0.0006043071625754237
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483247697353363, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4476962685585022, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44502201676368713, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017134375870227814, decouple_loss:0.0005869598826393485
loss_pred:0.01751665212213993, decouple_loss:0.0006373386131599545
loss_pred:0.017011843621730804, decouple_loss:0.0006481874734163284
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501418471336365, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45401838421821594, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4505835473537445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01727524772286415, decouple_loss:0.0005705889197997749
loss_pred:0.01733003370463848, decouple_loss:0.0006362613057717681
loss_pred:0.017355822026729584, decouple_loss:0.0005271068657748401
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956454634666443, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4494933784008026, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44857218861579895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017458120360970497, decouple_loss:0.000540188339073211
loss_pred:0.017201941460371017, decouple_loss:0.0005711509729735553
loss_pred:0.017060765996575356, decouple_loss:0.0005355059984140098
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4439970850944519, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44264480471611023, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4439171254634857, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01714363321661949, decouple_loss:0.0006221135845407844
loss_pred:0.017264164984226227, decouple_loss:0.0006045551272109151
loss_pred:0.017209889367222786, decouple_loss:0.0005292784771881998
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445992112159729, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4434133768081665, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4452875554561615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016993388533592224, decouple_loss:0.0006928868242539465
loss_pred:0.01749556139111519, decouple_loss:0.000612931908108294
loss_pred:0.01733952946960926, decouple_loss:0.000620938022620976
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159173011779785, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4516623318195343, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45185351371765137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016764404252171516, decouple_loss:0.0006070348317734897
loss_pred:0.017685379832983017, decouple_loss:0.0006268156575970352
loss_pred:0.017602579668164253, decouple_loss:0.0006275280029512942
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968143105506897, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44909870624542236, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44945821166038513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017559625208377838, decouple_loss:0.0005904196877963841
loss_pred:0.017259178683161736, decouple_loss:0.0006207892438396811
loss_pred:0.017046760767698288, decouple_loss:0.0005580910365097225
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463871717453003, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44494256377220154, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466032385826111, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017057107761502266, decouple_loss:0.0006170652923174202
loss_pred:0.017149752005934715, decouple_loss:0.0006196669419296086
loss_pred:0.017215119674801826, decouple_loss:0.0005401189555414021
2023-05-26 22:10:22 testing...
The modified gen p mean: 0.44365182518959045, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01841791532933712, decouple_loss:0.0006781646516174078
The modified gen p mean: 0.44477978348731995, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44451987743377686, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018419109284877777, decouple_loss:0.0007059472263790667
loss_pred:0.01870332658290863, decouple_loss:0.0007715710089541972
WV_2_PC_0_EH_0_PS_40, loss: 0.018549378961324692, avg_mse: 0.02550511062145233
Best test mse: 0.025, current test mse: 0.025505000725388527
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4439545273780823, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44540855288505554, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4443172216415405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016866488382220268, decouple_loss:0.0007318045827560127
loss_pred:0.016947465017437935, decouple_loss:0.0007579317898489535
loss_pred:0.01712842471897602, decouple_loss:0.0008232460240833461
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891056418418884, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4473743438720703, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478466510772705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0171292033046484, decouple_loss:0.0006586929666809738
loss_pred:0.016580624505877495, decouple_loss:0.0006716126808896661
loss_pred:0.01705239899456501, decouple_loss:0.0005420852685347199
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811928272247314, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4503489136695862, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4480019211769104, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017137449234724045, decouple_loss:0.0005857333890162408
loss_pred:0.017055479809641838, decouple_loss:0.0007037108298391104
loss_pred:0.017090758308768272, decouple_loss:0.0007538035861216486
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44550222158432007, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478277266025543, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4461611211299896, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01713487319648266, decouple_loss:0.0006715510971844196
loss_pred:0.01738603226840496, decouple_loss:0.0006941108149476349
loss_pred:0.01738644950091839, decouple_loss:0.0005995879764668643
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634631276130676, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44577187299728394, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.447445809841156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017382442951202393, decouple_loss:0.0007543939282186329
loss_pred:0.016920240595936775, decouple_loss:0.0007319950964301825
loss_pred:0.01675586774945259, decouple_loss:0.0007351074600592256
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649258255958557, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44776901602745056, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44983983039855957, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016818100586533546, decouple_loss:0.000605517125222832
loss_pred:0.017557593062520027, decouple_loss:0.0005830314476042986
loss_pred:0.016761260107159615, decouple_loss:0.0006482423632405698
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493926763534546, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44909432530403137, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4481988549232483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01713934727013111, decouple_loss:0.0007574690971523523
loss_pred:0.01776212453842163, decouple_loss:0.0006252388120628893
loss_pred:0.01715042255818844, decouple_loss:0.0007181460387073457
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481113851070404, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44701144099235535, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4457184970378876, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017007265239953995, decouple_loss:0.0007602688856422901
loss_pred:0.01727467216551304, decouple_loss:0.0007088618585839868
loss_pred:0.01680677756667137, decouple_loss:0.0007903642253950238
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
NaN value num: 0
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45144128799438477, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01677754521369934, decouple_loss:0.0008557943510822952
The modified gen p mean: 0.454319566488266, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45091280341148376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016139723360538483, decouple_loss:0.0012095706770196557
loss_pred:0.016953399404883385, decouple_loss:0.0007737278938293457
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529939293861389, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44996628165245056, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.448283851146698, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017289912328124046, decouple_loss:0.0008522455464117229
loss_pred:0.016968345269560814, decouple_loss:0.0006939822342246771
loss_pred:0.017242498695850372, decouple_loss:0.0010399980237707496
2023-05-26 22:13:27 testing...
The modified gen p mean: 0.4420988857746124, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4432699680328369, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018498945981264114, decouple_loss:0.0012585794320330024
loss_pred:0.018405219539999962, decouple_loss:0.0012403206201270223
The modified gen p mean: 0.44309917092323303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018702516332268715, decouple_loss:0.0012822240823879838
WV_2_PC_0_EH_0_PS_40, loss: 0.01859857887029648, avg_mse: 0.025536339730024338
Best test mse: 0.025, current test mse: 0.025536000728607178
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920849800109863, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44924452900886536, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44875600934028625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016917968168854713, decouple_loss:0.0009857761906459928
loss_pred:0.016889315098524094, decouple_loss:0.0007565076812170446
loss_pred:0.01714695431292057, decouple_loss:0.000701121345628053
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820746779441833, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44721439480781555, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44597846269607544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01684558019042015, decouple_loss:0.0006556028965860605
loss_pred:0.016841934993863106, decouple_loss:0.0007155187777243555
loss_pred:0.01688046008348465, decouple_loss:0.0006469361251220107
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486590623855591, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4511989653110504, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44985824823379517, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016924040392041206, decouple_loss:0.0008200586889870465
loss_pred:0.016459675505757332, decouple_loss:0.0008895999053493142
loss_pred:0.016545258462429047, decouple_loss:0.0007740252767689526
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45162415504455566, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45045214891433716, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4501803517341614, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01686774007976055, decouple_loss:0.000840407214127481
loss_pred:0.015999598428606987, decouple_loss:0.0008850084850564599
loss_pred:0.016187146306037903, decouple_loss:0.0008583441958762705
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523029327392578, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45563411712646484, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4535754323005676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016502520069479942, decouple_loss:0.000915223325137049
loss_pred:0.016582613810896873, decouple_loss:0.0008398282807320356
loss_pred:0.016739729791879654, decouple_loss:0.0008217798313125968
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486652612686157, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44981104135513306, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4492505192756653, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016293885186314583, decouple_loss:0.0007784553454257548
loss_pred:0.01549331471323967, decouple_loss:0.0009321816614829004
loss_pred:0.0166543647646904, decouple_loss:0.0009410035563632846
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847366213798523, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44864141941070557, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471050202846527, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01658013090491295, decouple_loss:0.0008480805554427207
loss_pred:0.017114536836743355, decouple_loss:0.0007857215823605657
loss_pred:0.015588006936013699, decouple_loss:0.0006672714953310788
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507179260253906, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45138514041900635, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45060595870018005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016178280115127563, decouple_loss:0.0011241185711696744
loss_pred:0.017211470752954483, decouple_loss:0.0007684578304179013
loss_pred:0.016438130289316177, decouple_loss:0.0009708061697892845
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534403383731842, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45059823989868164, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.451023131608963, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01701231859624386, decouple_loss:0.0007472738507203758
loss_pred:0.016344573348760605, decouple_loss:0.0009282774990424514
loss_pred:0.016705090180039406, decouple_loss:0.0010827525984495878
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484330713748932, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44969719648361206, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4481315016746521, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017123105004429817, decouple_loss:0.0006900051957927644
loss_pred:0.01679268851876259, decouple_loss:0.0007930552819743752
loss_pred:0.016591627150774002, decouple_loss:0.0007201155531220138
2023-05-26 22:15:53 testing...
The modified gen p mean: 0.44312208890914917, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018647532910108566, decouple_loss:0.0012412305222824216
The modified gen p mean: 0.444323867559433, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44388678669929504, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018520835787057877, decouple_loss:0.0011932378401979804
loss_pred:0.018854418769478798, decouple_loss:0.0012618909822776914
WV_2_PC_0_EH_0_PS_40, loss: 0.018735868856310844, avg_mse: 0.02578834816813469
Best test mse: 0.025, current test mse: 0.025787999853491783
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44952958822250366, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45145097374916077, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4511886239051819, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016947146505117416, decouple_loss:0.0008938576793298125
loss_pred:0.017143379896879196, decouple_loss:0.0009173405123874545
loss_pred:0.016035130247473717, decouple_loss:0.0008075535297393799
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186975598335266, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44960740208625793, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4515613615512848, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016156205907464027, decouple_loss:0.0008008063887245953
loss_pred:0.016612285748124123, decouple_loss:0.0007602880359627306
loss_pred:0.016145329922437668, decouple_loss:0.0008106146706268191
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491593837738037, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44902047514915466, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4501574635505676, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016603311523795128, decouple_loss:0.0007613907218910754
loss_pred:0.016316400840878487, decouple_loss:0.0007655755034647882
loss_pred:0.016692059114575386, decouple_loss:0.0008075642981566489
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037874579429626, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44880032539367676, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4493173062801361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01676115021109581, decouple_loss:0.0007694688974879682
loss_pred:0.016951926052570343, decouple_loss:0.0009103590855374932
loss_pred:0.016786133870482445, decouple_loss:0.0008947968017309904
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450678288936615, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4545744061470032, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45239225029945374, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016134433448314667, decouple_loss:0.0006120490725152194
loss_pred:0.01587771810591221, decouple_loss:0.0009681702358648181
loss_pred:0.016479600220918655, decouple_loss:0.0009198866900987923
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458942413330078, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4492902457714081, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4463092088699341, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016236621886491776, decouple_loss:0.0011171564692631364
loss_pred:0.016446687281131744, decouple_loss:0.0007985557313077152
loss_pred:0.0166991725564003, decouple_loss:0.0009935667039826512
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509211778640747, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45089221000671387, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4474853575229645, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016499390825629234, decouple_loss:0.0008079520193859935
loss_pred:0.01529255323112011, decouple_loss:0.0007261869614012539
loss_pred:0.01639527454972267, decouple_loss:0.0008940767729654908
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487438201904297, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4506242871284485, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4514838755130768, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01585034281015396, decouple_loss:0.0007898563053458929
loss_pred:0.01605524867773056, decouple_loss:0.0009003334562294185
loss_pred:0.016960790380835533, decouple_loss:0.000760266266297549
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
NaN value num: 0
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477212429046631, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016716428101062775, decouple_loss:0.0008158193086273968
The modified gen p mean: 0.45191535353660583, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4527585804462433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016283346340060234, decouple_loss:0.0007467772229574621
loss_pred:0.016370084136724472, decouple_loss:0.0007569086737930775
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45034533739089966, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4475027322769165, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45031416416168213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016552859917283058, decouple_loss:0.0008303173817694187
loss_pred:0.017230670899152756, decouple_loss:0.001136101083829999
loss_pred:0.01663190871477127, decouple_loss:0.0010324252070859075
2023-05-26 22:18:59 testing...
The modified gen p mean: 0.4435868263244629, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4447695314884186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018623653799295425, decouple_loss:0.0008312094141729176
loss_pred:0.018501130864024162, decouple_loss:0.0007444634102284908
The modified gen p mean: 0.4443203806877136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01883019134402275, decouple_loss:0.0008969259797595441
WV_2_PC_0_EH_0_PS_40, loss: 0.018692869693040848, avg_mse: 0.025769170373678207
Best test mse: 0.025, current test mse: 0.025769000872969627
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482690691947937, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45242753624916077, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4519118368625641, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016169460490345955, decouple_loss:0.0007706781034357846
loss_pred:0.016661688685417175, decouple_loss:0.0009161484194919467
loss_pred:0.01647183671593666, decouple_loss:0.0008008753065951169
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510776400566101, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44928446412086487, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4485834538936615, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0161618459969759, decouple_loss:0.0008722478523850441
loss_pred:0.01682089827954769, decouple_loss:0.0008589599747210741
loss_pred:0.015865257009863853, decouple_loss:0.0007828233647160232
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446374773979187, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44647452235221863, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4448474049568176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016412930563092232, decouple_loss:0.0007059185300022364
loss_pred:0.016299521550536156, decouple_loss:0.0008917207014746964
loss_pred:0.016263451427221298, decouple_loss:0.0008781671640463173
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44419845938682556, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44968971610069275, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44564470648765564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016899896785616875, decouple_loss:0.0008080617408268154
loss_pred:0.01641278713941574, decouple_loss:0.000701958080753684
loss_pred:0.016183391213417053, decouple_loss:0.0008193703833967447
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45421379804611206, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45578938722610474, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45302581787109375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016713641583919525, decouple_loss:0.000790226913522929
loss_pred:0.01654963567852974, decouple_loss:0.0008300428162328899
loss_pred:0.016515016555786133, decouple_loss:0.0008701516781002283
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45092537999153137, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4497048854827881, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4502432346343994, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016207922250032425, decouple_loss:0.0008054451318457723
loss_pred:0.017008159309625626, decouple_loss:0.0007028028485365212
loss_pred:0.01589329168200493, decouple_loss:0.0007319746073335409
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44324690103530884, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44459402561187744, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44532978534698486, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016307754442095757, decouple_loss:0.0008290658006444573
loss_pred:0.016206836327910423, decouple_loss:0.000833765254355967
loss_pred:0.016704432666301727, decouple_loss:0.0007708086050115526
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467312693595886, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44993504881858826, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44911542534828186, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016115346923470497, decouple_loss:0.0006379163241945207
loss_pred:0.016494465991854668, decouple_loss:0.0006925611523911357
loss_pred:0.01618286967277527, decouple_loss:0.0007792640244588256
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4559314250946045, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45624902844429016, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4575810730457306, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01634187437593937, decouple_loss:0.000746571458876133
loss_pred:0.01619476079940796, decouple_loss:0.0006884523318149149
loss_pred:0.016291504725813866, decouple_loss:0.0006876945844851434
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102956891059875, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45078811049461365, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.452595055103302, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017344040796160698, decouple_loss:0.0007518664351664484
loss_pred:0.016090689226984978, decouple_loss:0.0008496044320054352
loss_pred:0.016017058864235878, decouple_loss:0.0009454209357500076
2023-05-26 22:21:23 testing...
The modified gen p mean: 0.44170165061950684, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44304904341697693, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018667977303266525, decouple_loss:0.0010720334248617291
loss_pred:0.01851915754377842, decouple_loss:0.0009121991461142898
The modified gen p mean: 0.4418224096298218, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018837086856365204, decouple_loss:0.001102947979234159
WV_2_PC_0_EH_0_PS_40, loss: 0.018726196140050888, avg_mse: 0.025763100013136864
Best test mse: 0.025, current test mse: 0.025762999430298805
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664469361305237, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4442041516304016, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4485201835632324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016974901780486107, decouple_loss:0.0007254000520333648
loss_pred:0.016894280910491943, decouple_loss:0.000631756498478353
loss_pred:0.016843758523464203, decouple_loss:0.0008380725630559027
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469260275363922, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4469144642353058, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4457591474056244, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015919910743832588, decouple_loss:0.0006880623404867947
loss_pred:0.016886604949831963, decouple_loss:0.0008529165061190724
loss_pred:0.015858514234423637, decouple_loss:0.0007035403978079557
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45236462354660034, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4494785964488983, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45356038212776184, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016552118584513664, decouple_loss:0.0010028277756646276
loss_pred:0.01682797633111477, decouple_loss:0.000670259352773428
loss_pred:0.016123907640576363, decouple_loss:0.0007024884107522666
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537789523601532, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45087742805480957, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4473811686038971, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01619950495660305, decouple_loss:0.0007559384102933109
loss_pred:0.016961276531219482, decouple_loss:0.000801613787189126
loss_pred:0.01633046567440033, decouple_loss:0.0007940367213450372
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714128971099854, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4460269808769226, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.444812536239624, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015982219949364662, decouple_loss:0.0007832745905034244
loss_pred:0.016460811719298363, decouple_loss:0.0007212219061329961
loss_pred:0.016782362014055252, decouple_loss:0.0007500191568396986
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4444116950035095, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4475039541721344, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44679710268974304, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017138350754976273, decouple_loss:0.0007982732495293021
loss_pred:0.016310833394527435, decouple_loss:0.0006356182275339961
loss_pred:0.015942607074975967, decouple_loss:0.0008447151049040258
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523761570453644, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44968312978744507, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4508865475654602, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016622822731733322, decouple_loss:0.0006216076435521245
loss_pred:0.016696373000741005, decouple_loss:0.00064201740315184
loss_pred:0.016313791275024414, decouple_loss:0.0008018657099455595
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511982202529907, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4483855664730072, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4508393406867981, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015502453781664371, decouple_loss:0.0007993239560164511
loss_pred:0.016728239133954048, decouple_loss:0.0006857459666207433
loss_pred:0.01639508455991745, decouple_loss:0.0007105692056939006
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44550031423568726, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018021181225776672, decouple_loss:0.0008686718647368252
The modified gen p mean: 0.44582411646842957, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4447593092918396, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017437344416975975, decouple_loss:0.0009104869095608592
loss_pred:0.01715746708214283, decouple_loss:0.00102117785718292
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454214870929718, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4467070400714874, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4475581645965576, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017069697380065918, decouple_loss:0.0006709870649501681
loss_pred:0.018180549144744873, decouple_loss:0.000739473442081362
loss_pred:0.01735018752515316, decouple_loss:0.0007235656375996768
2023-05-26 22:24:34 testing...
The modified gen p mean: 0.4457542896270752, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44689416885375977, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01844007894396782, decouple_loss:0.0008299029432237148
loss_pred:0.018368234857916832, decouple_loss:0.0010034472215920687
The modified gen p mean: 0.4461393654346466, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01867976412177086, decouple_loss:0.0009131178958341479
WV_2_PC_0_EH_0_PS_40, loss: 0.01854180172085762, avg_mse: 0.025494059547781944
Best test mse: 0.025, current test mse: 0.02549399994313717
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44496503472328186, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4484492540359497, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44579461216926575, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01725747250020504, decouple_loss:0.0009215272730216384
loss_pred:0.01738026924431324, decouple_loss:0.0008855767082422972
loss_pred:0.017203837633132935, decouple_loss:0.0008428802830167115
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44439414143562317, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44677576422691345, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44587117433547974, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017560606822371483, decouple_loss:0.000690452114213258
loss_pred:0.01763664372265339, decouple_loss:0.0007826799992471933
loss_pred:0.016908835619688034, decouple_loss:0.0007215241785161197
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4438224136829376, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4452463388442993, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44611966609954834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017509685829281807, decouple_loss:0.0007470303680747747
loss_pred:0.017548810690641403, decouple_loss:0.0007773559773340821
loss_pred:0.016633857041597366, decouple_loss:0.0008648665389046073
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475440979003906, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44765138626098633, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4470754563808441, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017171623185276985, decouple_loss:0.0009020094294101
loss_pred:0.01705458015203476, decouple_loss:0.0007849137182347476
loss_pred:0.01743951626121998, decouple_loss:0.0007241055718623102
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468502700328827, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017130814492702484, decouple_loss:0.0008483747369609773
The modified gen p mean: 0.4478188455104828, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44671502709388733, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017817514017224312, decouple_loss:0.0007774022524245083
loss_pred:0.01785195618867874, decouple_loss:0.0008796920883469284
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480664134025574, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466572403907776, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4456564486026764, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016937559470534325, decouple_loss:0.000864910427480936
loss_pred:0.01751636154949665, decouple_loss:0.0007583565893583
loss_pred:0.018047967925667763, decouple_loss:0.0007735062390565872
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44445744156837463, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4460427165031433, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4429653584957123, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01811615750193596, decouple_loss:0.0007261540740728378
loss_pred:0.01785311847925186, decouple_loss:0.0007805177010595798
loss_pred:0.017203157767653465, decouple_loss:0.0007506145047955215
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816097617149353, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4489646255970001, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478943645954132, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016854725778102875, decouple_loss:0.0007489194977097213
loss_pred:0.0170133113861084, decouple_loss:0.000617921119555831
loss_pred:0.017849672585725784, decouple_loss:0.0007706063915975392
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44365397095680237, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44446882605552673, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4454360902309418, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016728082671761513, decouple_loss:0.0006961825420148671
loss_pred:0.017334552481770515, decouple_loss:0.0007583172409795225
loss_pred:0.01722240447998047, decouple_loss:0.0006770947948098183
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464759826660156, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4468133747577667, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4473859667778015, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01736673153936863, decouple_loss:0.0006553279818035662
loss_pred:0.016732003539800644, decouple_loss:0.0006884078029543161
loss_pred:0.017191316932439804, decouple_loss:0.0007346871425397694
2023-05-26 22:26:58 testing...
The modified gen p mean: 0.44671037793159485, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018549935892224312, decouple_loss:0.0006202988442964852
The modified gen p mean: 0.44741091132164, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44785839319229126, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01850753277540207, decouple_loss:0.0007485304959118366
loss_pred:0.01874883472919464, decouple_loss:0.0007718260167166591
WV_2_PC_0_EH_0_PS_40, loss: 0.018637780100107193, avg_mse: 0.025692230090498924
Best test mse: 0.025, current test mse: 0.02569199912250042
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772204756736755, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44663819670677185, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.448472797870636, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017115626484155655, decouple_loss:0.0006500521558336914
loss_pred:0.017375992611050606, decouple_loss:0.0006370190531015396
loss_pred:0.016892876476049423, decouple_loss:0.0006245537661015987
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470657706260681, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44610288739204407, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4447261691093445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017435437068343163, decouple_loss:0.0007507886621169746
loss_pred:0.01788972318172455, decouple_loss:0.0007107806741259992
loss_pred:0.017428219318389893, decouple_loss:0.0005942865391261876
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450349807739258, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4462551176548004, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44680318236351013, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017285779118537903, decouple_loss:0.0005646315403282642
loss_pred:0.01814834214746952, decouple_loss:0.0007229228504002094
loss_pred:0.017877282574772835, decouple_loss:0.0007032380090095103
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485183358192444, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4482303261756897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017082376405596733, decouple_loss:0.0010182494297623634
The modified gen p mean: 0.44715172052383423, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01833617500960827, decouple_loss:0.0008066330337896943
loss_pred:0.01794314756989479, decouple_loss:0.0008402040111832321
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486176371574402, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4489785134792328, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488165080547333, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01810990273952484, decouple_loss:0.0006544921780005097
loss_pred:0.01666928082704544, decouple_loss:0.0006511911051347852
loss_pred:0.017820533365011215, decouple_loss:0.0006400304264388978
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459646940231323, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4452838599681854, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44463086128234863, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017624307423830032, decouple_loss:0.0007931764121167362
loss_pred:0.018644489347934723, decouple_loss:0.00069635477848351
loss_pred:0.0173480324447155, decouple_loss:0.0008371573640033603
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628071784973145, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44413942098617554, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44461822509765625, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016746101900935173, decouple_loss:0.0006747051957063377
loss_pred:0.016836225986480713, decouple_loss:0.0007053327281028032
loss_pred:0.01730439066886902, decouple_loss:0.000550267577636987
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642913341522217, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44562575221061707, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4464985728263855, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016906052827835083, decouple_loss:0.0005703308852389455
loss_pred:0.017052145674824715, decouple_loss:0.0006944898632355034
loss_pred:0.016858553513884544, decouple_loss:0.0006494150729849935
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
NaN value num: 0
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503263831138611, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016335370019078255, decouple_loss:0.0011233369586989284
The modified gen p mean: 0.4502660632133484, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45245084166526794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016333574429154396, decouple_loss:0.001340277143754065
loss_pred:0.016648229211568832, decouple_loss:0.0011035928037017584
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089221000671387, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44886213541030884, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44952109456062317, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016200944781303406, decouple_loss:0.0007402890478260815
loss_pred:0.015947887673974037, decouple_loss:0.000907574431039393
loss_pred:0.01727541908621788, decouple_loss:0.0006757560768164694
2023-05-26 22:30:03 testing...
The modified gen p mean: 0.4459231197834015, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44706884026527405, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018453195691108704, decouple_loss:0.0012105057248845696
loss_pred:0.01843741349875927, decouple_loss:0.0010788164800032973
The modified gen p mean: 0.4468289911746979, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018709609284996986, decouple_loss:0.0011821751249954104
WV_2_PC_0_EH_0_PS_40, loss: 0.01859126426279545, avg_mse: 0.02555025741457939
Best test mse: 0.025, current test mse: 0.025550000369548798
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484623968601227, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478200376033783, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44862642884254456, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016574550420045853, decouple_loss:0.0008487488958053291
loss_pred:0.017266808077692986, decouple_loss:0.0010245215380564332
loss_pred:0.016160817816853523, decouple_loss:0.000989452120848
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508391320705414, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45169755816459656, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44996562600135803, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015281607396900654, decouple_loss:0.0007980375085026026
loss_pred:0.01542236190289259, decouple_loss:0.001073372084647417
loss_pred:0.01599317230284214, decouple_loss:0.0010851576225832105
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45324063301086426, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4541183412075043, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45419245958328247, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0163363516330719, decouple_loss:0.0007805586792528629
loss_pred:0.015183690935373306, decouple_loss:0.0008233926491811872
loss_pred:0.016399482265114784, decouple_loss:0.000793600338511169
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449074387550354, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4499439597129822, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4509492516517639, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01706649363040924, decouple_loss:0.0009993563871830702
loss_pred:0.01704520545899868, decouple_loss:0.0007912383298389614
loss_pred:0.01530611515045166, decouple_loss:0.0007873275317251682
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854044914245605, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.448396235704422, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45069414377212524, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01583939418196678, decouple_loss:0.0010049096308648586
loss_pred:0.016337290406227112, decouple_loss:0.0009268867434002459
loss_pred:0.01525716483592987, decouple_loss:0.0010635023936629295
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523630142211914, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4518485963344574, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45300647616386414, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01555455382913351, decouple_loss:0.0007847504457458854
loss_pred:0.016295313835144043, decouple_loss:0.0006490257219411433
loss_pred:0.016058877110481262, decouple_loss:0.0007891968707554042
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511075019836426, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44806936383247375, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4510181248188019, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01642887108027935, decouple_loss:0.0007390222162939608
loss_pred:0.01628347672522068, decouple_loss:0.0008629349176771939
loss_pred:0.015532377175986767, decouple_loss:0.0009128797682933509
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475838541984558, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44750887155532837, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45100080966949463, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01626172475516796, decouple_loss:0.0008336887112818658
loss_pred:0.017024429515004158, decouple_loss:0.0009196956525556743
loss_pred:0.015072709880769253, decouple_loss:0.0009365255245938897
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45070356130599976, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45195692777633667, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44901785254478455, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01611524075269699, decouple_loss:0.0009672868764027953
loss_pred:0.01474213320761919, decouple_loss:0.000895172415766865
loss_pred:0.01675313152372837, decouple_loss:0.0007561559323221445
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452644407749176, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4510877728462219, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4517151117324829, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016628703102469444, decouple_loss:0.0007254561060108244
loss_pred:0.017300723120570183, decouple_loss:0.0008890016470104456
loss_pred:0.016366606578230858, decouple_loss:0.0008462828700430691
2023-05-26 22:32:22 testing...
The modified gen p mean: 0.44945019483566284, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45038217306137085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01854001358151436, decouple_loss:0.0011234583798795938
The modified gen p mean: 0.4508293569087982, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018528494983911514, decouple_loss:0.0010119823273271322
loss_pred:0.018772583454847336, decouple_loss:0.0011341937351971865
WV_2_PC_0_EH_0_PS_40, loss: 0.018668193370103836, avg_mse: 0.025721266865730286
Best test mse: 0.025, current test mse: 0.025721000507473946
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45196405053138733, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4537757337093353, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4548913836479187, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016071666032075882, decouple_loss:0.0007549066212959588
loss_pred:0.01658385992050171, decouple_loss:0.0008274444844573736
loss_pred:0.015462802723050117, decouple_loss:0.0008423366816714406
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496608376502991, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44839537143707275, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4464187026023865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01572977565228939, decouple_loss:0.0007748777861706913
loss_pred:0.01592240296304226, decouple_loss:0.0007381041650660336
loss_pred:0.015937678515911102, decouple_loss:0.0009145125513896346
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475683569908142, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44870272278785706, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44849100708961487, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016625139862298965, decouple_loss:0.0008386403205804527
loss_pred:0.016669023782014847, decouple_loss:0.0007448920514434576
loss_pred:0.01602252759039402, decouple_loss:0.0008193888352252543
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023831725120544, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45095372200012207, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4501117467880249, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016175825148820877, decouple_loss:0.0006654970347881317
loss_pred:0.016958201304078102, decouple_loss:0.0006255123880691826
loss_pred:0.016253765672445297, decouple_loss:0.0006630859570577741
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978368282318115, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4512091279029846, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4461349844932556, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016894130036234856, decouple_loss:0.0008806759724393487
loss_pred:0.01683393307030201, decouple_loss:0.0007855559233576059
loss_pred:0.01719980686903, decouple_loss:0.0008687348454259336
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469262361526489, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45144495368003845, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44656530022621155, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016379056498408318, decouple_loss:0.0006608922267332673
loss_pred:0.014653799124062061, decouple_loss:0.0007740894798189402
loss_pred:0.015962455421686172, decouple_loss:0.0006661348161287606
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502241909503937, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45006445050239563, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4511650502681732, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01672956347465515, decouple_loss:0.0007172602345235646
loss_pred:0.016694389283657074, decouple_loss:0.0006642582593485713
loss_pred:0.01632859744131565, decouple_loss:0.0007508460548706353
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45175889134407043, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44862857460975647, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44982320070266724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016014840453863144, decouple_loss:0.0006143462378531694
loss_pred:0.016925053671002388, decouple_loss:0.000595909426920116
loss_pred:0.01649073138833046, decouple_loss:0.0007812317344360054
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621914625167847, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01650138758122921, decouple_loss:0.0009492406388744712
The modified gen p mean: 0.44453004002571106, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44547441601753235, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01699868030846119, decouple_loss:0.0009714221814647317
loss_pred:0.01716562733054161, decouple_loss:0.0010303251910954714
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45086124539375305, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4472212493419647, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45167776942253113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017204197123646736, decouple_loss:0.0008962082210928202
loss_pred:0.01719256117939949, decouple_loss:0.0008029370219446719
loss_pred:0.016867157071828842, decouple_loss:0.0008577756234444678
2023-05-26 22:35:24 testing...
The modified gen p mean: 0.4469793438911438, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478771686553955, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018436558544635773, decouple_loss:0.0008502572309225798
The modified gen p mean: 0.44814175367355347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018431752920150757, decouple_loss:0.000989135354757309
loss_pred:0.01869957707822323, decouple_loss:0.0009256396442651749
WV_2_PC_0_EH_0_PS_40, loss: 0.01856871321797371, avg_mse: 0.025546327233314514
Best test mse: 0.025, current test mse: 0.02554599940776825
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864124059677124, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44949403405189514, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44548559188842773, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01687532290816307, decouple_loss:0.0012170692207291722
loss_pred:0.016940344125032425, decouple_loss:0.0009161383495666087
loss_pred:0.016510095447301865, decouple_loss:0.0008300489280372858
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508557617664337, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45014119148254395, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4489067494869232, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01754787378013134, decouple_loss:0.0010948790004476905
loss_pred:0.016953367739915848, decouple_loss:0.0009264487307518721
loss_pred:0.01639314368367195, decouple_loss:0.0010392508702352643
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677141308784485, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4428287744522095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017038026824593544, decouple_loss:0.0007164647104218602
loss_pred:0.016497910022735596, decouple_loss:0.0006395801901817322
The modified gen p mean: 0.4461565911769867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016579311341047287, decouple_loss:0.0006970299291424453
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473777115345001, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4475000202655792, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4460083544254303, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01744988188147545, decouple_loss:0.0008897589286789298
loss_pred:0.017585061490535736, decouple_loss:0.0009014669340103865
loss_pred:0.01676217094063759, decouple_loss:0.0010732486844062805
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480324685573578, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44567370414733887, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0173493605107069, decouple_loss:0.0008075937512330711
loss_pred:0.016559695824980736, decouple_loss:0.0011130919447168708
The modified gen p mean: 0.4468191862106323, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016633499413728714, decouple_loss:0.0010369328083470464
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45133328437805176, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45106610655784607, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4521854519844055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016450803726911545, decouple_loss:0.0007704344461672008
loss_pred:0.017486069351434708, decouple_loss:0.0008030953467823565
loss_pred:0.017106793820858, decouple_loss:0.0006590188713744283
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513998329639435, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4480174779891968, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488464593887329, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01704327203333378, decouple_loss:0.0009866016916930676
loss_pred:0.016980336979031563, decouple_loss:0.0009258947102352977
loss_pred:0.017157118767499924, decouple_loss:0.0011455914936959743
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793349504470825, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4452713131904602, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4459604024887085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016608018428087234, decouple_loss:0.0007025876548141241
loss_pred:0.016637036576867104, decouple_loss:0.0005951255443505943
loss_pred:0.01612176187336445, decouple_loss:0.0006082251784391701
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661590456962585, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44573575258255005, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44591230154037476, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017451709136366844, decouple_loss:0.0007469109841622412
loss_pred:0.01684221811592579, decouple_loss:0.0008808791171759367
loss_pred:0.016831163316965103, decouple_loss:0.0007086171535775065
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475461542606354, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44843193888664246, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4498669505119324, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016813065856695175, decouple_loss:0.0006803428404964507
loss_pred:0.016287321224808693, decouple_loss:0.0006955627468414605
loss_pred:0.017183072865009308, decouple_loss:0.0007604355341754854
2023-05-26 22:37:46 testing...
The modified gen p mean: 0.45005807280540466, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4508632719516754, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018386660143733025, decouple_loss:0.0006891397060826421
The modified gen p mean: 0.45073390007019043, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018441857770085335, decouple_loss:0.000703717116266489
loss_pred:0.018717972561717033, decouple_loss:0.000823825306724757
WV_2_PC_0_EH_0_PS_40, loss: 0.018552443012595177, avg_mse: 0.025526560842990875
Best test mse: 0.025, current test mse: 0.025527000427246094
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045194029808044, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4506048560142517, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44991472363471985, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01772679202258587, decouple_loss:0.0006714729242958128
loss_pred:0.016396669670939445, decouple_loss:0.0007068660343065858
loss_pred:0.016274655237793922, decouple_loss:0.0006258017383515835
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484841823577881, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44958361983299255, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44685572385787964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017000503838062286, decouple_loss:0.0007568757864646614
loss_pred:0.017133383080363274, decouple_loss:0.0009145446238107979
loss_pred:0.01679813861846924, decouple_loss:0.0007009090040810406
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4428752362728119, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4427597224712372, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44155144691467285, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01664109341800213, decouple_loss:0.0009807831374928355
loss_pred:0.016067394986748695, decouple_loss:0.0010108202695846558
loss_pred:0.016103822737932205, decouple_loss:0.0009694542968645692
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489701986312866, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45262062549591064, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44795188307762146, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017190076410770416, decouple_loss:0.0007986475247889757
loss_pred:0.016822107136249542, decouple_loss:0.0007732984377071261
loss_pred:0.01692534051835537, decouple_loss:0.0006497251451946795
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45088332891464233, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45121487975120544, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.451043039560318, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016628392040729523, decouple_loss:0.0008493653731420636
loss_pred:0.017108503729104996, decouple_loss:0.0008129455964080989
loss_pred:0.017208941280841827, decouple_loss:0.0009999630274251103
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457344710826874, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4468739330768585, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4499901533126831, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01616794988512993, decouple_loss:0.0008252265979535878
loss_pred:0.0169113427400589, decouple_loss:0.001016370952129364
loss_pred:0.01682022400200367, decouple_loss:0.000570343341678381
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588759541511536, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44728752970695496, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4452376067638397, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01682198978960514, decouple_loss:0.0006628022529184818
loss_pred:0.01667178049683571, decouple_loss:0.0009285346022807062
loss_pred:0.016774090006947517, decouple_loss:0.0007060233619995415
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451516270637512, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44575929641723633, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4460000693798065, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01726563833653927, decouple_loss:0.0007383184274658561
loss_pred:0.016553496941924095, decouple_loss:0.0006780097028240561
loss_pred:0.01632900908589363, decouple_loss:0.0009074389818124473
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
NaN value num: 0
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45280155539512634, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017370231449604034, decouple_loss:0.0009663001401349902
The modified gen p mean: 0.4531305134296417, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45310819149017334, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016797713935375214, decouple_loss:0.0009258339996449649
loss_pred:0.01760982722043991, decouple_loss:0.0007754132966510952
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449388712644577, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44999730587005615, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4481607973575592, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017421811819076538, decouple_loss:0.0008129267953336239
loss_pred:0.017630629241466522, decouple_loss:0.0008956878446042538
loss_pred:0.016421740874648094, decouple_loss:0.0009912108071148396
2023-05-26 22:40:48 testing...
The modified gen p mean: 0.4449485242366791, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4454338550567627, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44581538438796997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01843085326254368, decouple_loss:0.0006442121812142432
loss_pred:0.018382107838988304, decouple_loss:0.0005979898269288242
loss_pred:0.018739968538284302, decouple_loss:0.00073335348861292
WV_2_PC_0_EH_0_PS_40, loss: 0.01855056919157505, avg_mse: 0.025523653253912926
Best test mse: 0.025, current test mse: 0.025523999705910683
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470365643501282, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44685623049736023, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44821834564208984, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01810683310031891, decouple_loss:0.0006522739422507584
loss_pred:0.01781764067709446, decouple_loss:0.0007449505501426756
loss_pred:0.01696169748902321, decouple_loss:0.0006465836195275187
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4449344277381897, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.445048063993454, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44529253244400024, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017318518832325935, decouple_loss:0.0009077095310203731
loss_pred:0.017039604485034943, decouple_loss:0.0009554735734127462
loss_pred:0.01750052347779274, decouple_loss:0.0007144886185415089
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493691921234131, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4474268853664398, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44799700379371643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017236124724149704, decouple_loss:0.0007399112801067531
loss_pred:0.01727583445608616, decouple_loss:0.0006744042038917542
loss_pred:0.01784460060298443, decouple_loss:0.0006887828349135816
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519421458244324, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45125406980514526, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4517354667186737, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017706356942653656, decouple_loss:0.0006304215639829636
loss_pred:0.016570527106523514, decouple_loss:0.0006239129579626024
loss_pred:0.01740732602775097, decouple_loss:0.0007508433191105723
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867202639579773, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44708943367004395, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44719764590263367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016967851668596268, decouple_loss:0.0008728386601433158
loss_pred:0.017885945737361908, decouple_loss:0.0010179406963288784
loss_pred:0.016860801726579666, decouple_loss:0.000760990718845278
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44488590955734253, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44414007663726807, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44578829407691956, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018068499863147736, decouple_loss:0.0006443059537559748
loss_pred:0.017531605437397957, decouple_loss:0.0007792387623339891
loss_pred:0.017239324748516083, decouple_loss:0.0006463692407123744
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486129581928253, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44838589429855347, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4472287893295288, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018347706645727158, decouple_loss:0.000848032592330128
loss_pred:0.017290476709604263, decouple_loss:0.0009102935437113047
loss_pred:0.016575327143073082, decouple_loss:0.0006440944853238761
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514274001121521, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45320677757263184, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45141327381134033, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01775697059929371, decouple_loss:0.000819938606582582
loss_pred:0.016970252618193626, decouple_loss:0.0008276139269582927
loss_pred:0.01659087836742401, decouple_loss:0.0007744507165625691
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447998970746994, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45062798261642456, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44874662160873413, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01717986911535263, decouple_loss:0.0007888971595093608
loss_pred:0.01678752526640892, decouple_loss:0.0006682584644295275
loss_pred:0.017058948054909706, decouple_loss:0.0008198080467991531
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4445735812187195, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4434422254562378, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4449445307254791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017435641959309578, decouple_loss:0.0008019861998036504
loss_pred:0.017671337351202965, decouple_loss:0.0008857488282956183
loss_pred:0.017190657556056976, decouple_loss:0.000839818618260324
2023-05-26 22:43:08 testing...
The modified gen p mean: 0.447414368391037, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44786903262138367, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01851046271622181, decouple_loss:0.0010734309908002615
loss_pred:0.018505146726965904, decouple_loss:0.0008849360165186226
The modified gen p mean: 0.4476877748966217, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0187910757958889, decouple_loss:0.001258484902791679
WV_2_PC_0_EH_0_PS_40, loss: 0.018655844032764435, avg_mse: 0.025699077174067497
Best test mse: 0.025, current test mse: 0.02569900080561638
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894906878471375, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45088234543800354, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4486055374145508, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017771512269973755, decouple_loss:0.0011196678970009089
loss_pred:0.01706136204302311, decouple_loss:0.0009508560760878026
loss_pred:0.018217740580439568, decouple_loss:0.001011452404782176
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881317019462585, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4498825967311859, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4499330222606659, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016782568767666817, decouple_loss:0.0008530473569408059
loss_pred:0.017103878781199455, decouple_loss:0.0010798982111737132
loss_pred:0.016663003712892532, decouple_loss:0.0008840142982080579
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953569769859314, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4493539035320282, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4468040466308594, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017547080293297768, decouple_loss:0.0007696665124967694
loss_pred:0.01786419376730919, decouple_loss:0.0006612995639443398
loss_pred:0.01610240526497364, decouple_loss:0.0006886078626848757
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634953141212463, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4456644058227539, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4459802806377411, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017482366412878036, decouple_loss:0.000904249434825033
loss_pred:0.01706598699092865, decouple_loss:0.0010684279259294271
loss_pred:0.017922956496477127, decouple_loss:0.0009907431667670608
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44601869583129883, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44607165455818176, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44797053933143616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016458064317703247, decouple_loss:0.0011572035728022456
loss_pred:0.017766959965229034, decouple_loss:0.001195792923681438
loss_pred:0.016444314271211624, decouple_loss:0.0011191790690645576
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972124695777893, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4507863521575928, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45113855600357056, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017309945076704025, decouple_loss:0.0010840294416993856
loss_pred:0.01725286804139614, decouple_loss:0.0013253496726974845
loss_pred:0.017470570281147957, decouple_loss:0.001144537003710866
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009350776672363, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44970226287841797, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44946298003196716, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016693908721208572, decouple_loss:0.0007843130151741207
loss_pred:0.016183331608772278, decouple_loss:0.0006844014278613031
loss_pred:0.017798665910959244, decouple_loss:0.0007495866157114506
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744715094566345, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466153085231781, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4465205669403076, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017845584079623222, decouple_loss:0.0009537959704175591
loss_pred:0.0174631979316473, decouple_loss:0.0012336784275248647
loss_pred:0.016889499500393867, decouple_loss:0.00091377436183393
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
NaN value num: 0
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471665024757385, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016040196642279625, decouple_loss:0.0008060012478381395
The modified gen p mean: 0.44589072465896606, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44551968574523926, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016815844923257828, decouple_loss:0.0008695179130882025
loss_pred:0.017265310510993004, decouple_loss:0.0010683900909498334
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45374763011932373, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45307856798171997, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45151737332344055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015702111646533012, decouple_loss:0.0006360887200571597
loss_pred:0.016136420890688896, decouple_loss:0.0007664739969186485
loss_pred:0.016659311950206757, decouple_loss:0.0007516432669945061
2023-05-26 22:46:25 testing...
The modified gen p mean: 0.45036572217941284, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4507518708705902, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018465375527739525, decouple_loss:0.0006972589180804789
loss_pred:0.018417533487081528, decouple_loss:0.0007178292726166546
The modified gen p mean: 0.4510781764984131, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018767070025205612, decouple_loss:0.0007898434996604919
WV_2_PC_0_EH_0_PS_40, loss: 0.018586743623018265, avg_mse: 0.025602519512176514
Best test mse: 0.025, current test mse: 0.025603000074625015
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45398181676864624, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45434850454330444, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4516502916812897, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016437629237771034, decouple_loss:0.0008809074060991406
loss_pred:0.017307424917817116, decouple_loss:0.0009835362434387207
loss_pred:0.016494160518050194, decouple_loss:0.0006279590306803584
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508970379829407, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4491969645023346, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44936129450798035, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01739749312400818, decouple_loss:0.0010489898268133402
loss_pred:0.017414811998605728, decouple_loss:0.000779378111474216
loss_pred:0.016560383141040802, decouple_loss:0.0006311626057140529
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454549252986908, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.447427362203598, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4493809938430786, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016561314463615417, decouple_loss:0.0008010383462533355
loss_pred:0.016346117481589317, decouple_loss:0.0007253250223584473
loss_pred:0.016622859984636307, decouple_loss:0.0005927027086727321
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106828212738037, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4541364014148712, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4516026973724365, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016926582902669907, decouple_loss:0.0007227995083667338
loss_pred:0.017759904265403748, decouple_loss:0.0005548958433791995
loss_pred:0.017028706148266792, decouple_loss:0.0006522100884467363
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45212817192077637, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4495216906070709, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4509407877922058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01787988655269146, decouple_loss:0.0007022599456831813
loss_pred:0.01634468324482441, decouple_loss:0.000790010264609009
loss_pred:0.017349548637866974, decouple_loss:0.0007545473636128008
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477652609348297, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4510163962841034, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4503380358219147, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017015282064676285, decouple_loss:0.0006311894976533949
loss_pred:0.017619112506508827, decouple_loss:0.0006999240722507238
loss_pred:0.017452040687203407, decouple_loss:0.0005655747372657061
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488263428211212, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44975292682647705, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.450811505317688, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016486341133713722, decouple_loss:0.0006193657754920423
loss_pred:0.01633782498538494, decouple_loss:0.0005688846576958895
loss_pred:0.016657279804348946, decouple_loss:0.0007023942889645696
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484271705150604, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4524937868118286, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45018500089645386, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016894804313778877, decouple_loss:0.0005698681343346834
loss_pred:0.01624077931046486, decouple_loss:0.0007093402673490345
loss_pred:0.017331790179014206, decouple_loss:0.0006203987868502736
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45156893134117126, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4482174515724182, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4533991515636444, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01736539602279663, decouple_loss:0.0006876111146993935
loss_pred:0.01672498695552349, decouple_loss:0.0005932251806370914
loss_pred:0.017084240913391113, decouple_loss:0.0007126753334887326
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512019157409668, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4524540603160858, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45390740036964417, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017604194581508636, decouple_loss:0.0006082566687837243
loss_pred:0.016185212880373, decouple_loss:0.0005245437496341765
loss_pred:0.016956476494669914, decouple_loss:0.0006558262975886464
2023-05-26 22:48:46 testing...
The modified gen p mean: 0.44449716806411743, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44506895542144775, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01853886991739273, decouple_loss:0.0007817003061063588
loss_pred:0.018523015081882477, decouple_loss:0.0007426684605889022
The modified gen p mean: 0.44549018144607544, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01877177692949772, decouple_loss:0.0008499274263158441
WV_2_PC_0_EH_0_PS_40, loss: 0.01865079253911972, avg_mse: 0.02571474201977253
Best test mse: 0.025, current test mse: 0.025715000927448273
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903403520584106, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44741812348365784, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4491165280342102, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016784973442554474, decouple_loss:0.0005998623673804104
loss_pred:0.016480548307299614, decouple_loss:0.0006079630693420768
loss_pred:0.015689667314291, decouple_loss:0.0008004930568858981
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940367341041565, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4491732120513916, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44948649406433105, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01705925352871418, decouple_loss:0.0009717289358377457
loss_pred:0.01732766069471836, decouple_loss:0.0006177540635690093
loss_pred:0.016505638137459755, decouple_loss:0.0006439925637096167
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531460404396057, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45680975914001465, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4539124667644501, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0175671074539423, decouple_loss:0.0005960508133284748
loss_pred:0.017227178439497948, decouple_loss:0.0005294481525197625
loss_pred:0.01664581708610058, decouple_loss:0.0005902586271986365
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520953297615051, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4522719085216522, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4528968632221222, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017231181263923645, decouple_loss:0.0005568862543441355
loss_pred:0.01644456945359707, decouple_loss:0.0005268420791253448
loss_pred:0.017334939911961555, decouple_loss:0.0005444895359687507
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477774500846863, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4495050311088562, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44458991289138794, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017342224717140198, decouple_loss:0.0005051594343967736
loss_pred:0.01723109744489193, decouple_loss:0.0006396490498445928
loss_pred:0.016383185982704163, decouple_loss:0.0006130633992142975
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44567787647247314, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4488111138343811, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4474225342273712, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01645267754793167, decouple_loss:0.0006569558172486722
loss_pred:0.017535222694277763, decouple_loss:0.0005549824563786387
loss_pred:0.01673279143869877, decouple_loss:0.0005469401949085295
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171478390693665, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45123565196990967, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4516977071762085, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017359280958771706, decouple_loss:0.0005731299170292914
loss_pred:0.01674870401620865, decouple_loss:0.0006084894994273782
loss_pred:0.01652686856687069, decouple_loss:0.0006584833026863635
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45269688963890076, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4510175585746765, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4510776400566101, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017516031861305237, decouple_loss:0.0006498353905044496
loss_pred:0.017453791573643684, decouple_loss:0.0006782940472476184
loss_pred:0.01638747565448284, decouple_loss:0.0006400936399586499
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459584355354309, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01775604486465454, decouple_loss:0.0009175394661724567
The modified gen p mean: 0.44521352648735046, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4451073706150055, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017339782789349556, decouple_loss:0.0008444932173006237
loss_pred:0.017281532287597656, decouple_loss:0.0009224051609635353
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468991160392761, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4452211558818817, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44632652401924133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016857154667377472, decouple_loss:0.0006162378122098744
loss_pred:0.016473690047860146, decouple_loss:0.0006807642639614642
loss_pred:0.01662958413362503, decouple_loss:0.0005778542254120111
2023-05-26 22:51:46 testing...
The modified gen p mean: 0.4503476023674011, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4511614441871643, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01840987801551819, decouple_loss:0.0008978224941529334
The modified gen p mean: 0.4511285126209259, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018431279808282852, decouple_loss:0.0009946206118911505
loss_pred:0.018667815253138542, decouple_loss:0.0008029103628359735
WV_2_PC_0_EH_0_PS_40, loss: 0.018547913059592247, avg_mse: 0.025527948513627052
Best test mse: 0.025, current test mse: 0.02552800066769123
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514199197292328, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4523484706878662, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4517289102077484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017117006704211235, decouple_loss:0.0008443290716968477
loss_pred:0.01673046313226223, decouple_loss:0.0007140322122722864
loss_pred:0.0174679234623909, decouple_loss:0.0007943558157421649
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484979212284088, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4475906789302826, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4516081213951111, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01680239662528038, decouple_loss:0.0006275607156567276
loss_pred:0.016697481274604797, decouple_loss:0.0006103699561208487
loss_pred:0.017675252631306648, decouple_loss:0.0006759046227671206
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445941299200058, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.445329874753952, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4464133679866791, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016146784648299217, decouple_loss:0.0008509171311743557
loss_pred:0.01672372967004776, decouple_loss:0.000780309084802866
loss_pred:0.017447806894779205, decouple_loss:0.0008319906191900373
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856032729148865, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44893187284469604, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4495394229888916, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016090096905827522, decouple_loss:0.000901191437151283
loss_pred:0.01684786193072796, decouple_loss:0.0007791725802235305
loss_pred:0.016690358519554138, decouple_loss:0.0007126532145775855
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501879811286926, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4462110996246338, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4498082995414734, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01638909988105297, decouple_loss:0.0008328025578521192
loss_pred:0.01615704596042633, decouple_loss:0.0006144805811345577
loss_pred:0.016595343127846718, decouple_loss:0.0009572923881933093
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496292471885681, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4487665891647339, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4470396339893341, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017204472795128822, decouple_loss:0.0009155700099654496
loss_pred:0.015769056975841522, decouple_loss:0.0007999802473932505
loss_pred:0.016971534118056297, decouple_loss:0.0010842635529115796
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485367238521576, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44685909152030945, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44875046610832214, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01609482243657112, decouple_loss:0.0006535412976518273
loss_pred:0.016217505559325218, decouple_loss:0.0008204601472243667
loss_pred:0.01741342432796955, decouple_loss:0.0005740252090618014
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509027600288391, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44991496205329895, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4499913156032562, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01673833094537258, decouple_loss:0.00062812544638291
loss_pred:0.015873052179813385, decouple_loss:0.0007869426626712084
loss_pred:0.016560666263103485, decouple_loss:0.0007280195713974535
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721126556396484, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44469135999679565, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44500377774238586, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016874194145202637, decouple_loss:0.0006394253578037024
loss_pred:0.016578294336795807, decouple_loss:0.0006605986272916198
loss_pred:0.016713138669729233, decouple_loss:0.0007710586651228368
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911348819732666, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4467048645019531, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4473460912704468, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01711188443005085, decouple_loss:0.0007639679242856801
loss_pred:0.01637461967766285, decouple_loss:0.0009314446360804141
loss_pred:0.01699127070605755, decouple_loss:0.0007463578367605805
2023-05-26 22:54:06 testing...
The modified gen p mean: 0.44696274399757385, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4479729235172272, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01844235509634018, decouple_loss:0.0006581286434084177
loss_pred:0.01835767738521099, decouple_loss:0.0008279368630610406
The modified gen p mean: 0.4477941393852234, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018651219084858894, decouple_loss:0.0006487267091870308
WV_2_PC_0_EH_0_PS_40, loss: 0.018519332632422447, avg_mse: 0.025484953075647354
Best test mse: 0.025, current test mse: 0.025484999641776085
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482603669166565, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4470997750759125, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45068126916885376, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017064649611711502, decouple_loss:0.0006881424924358726
loss_pred:0.016746578738093376, decouple_loss:0.0006592985009774566
loss_pred:0.016634562984108925, decouple_loss:0.000516984611749649
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486645758152008, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44890496134757996, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44886356592178345, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016691187396645546, decouple_loss:0.0008710912661626935
loss_pred:0.017319070175290108, decouple_loss:0.0011286205844953656
loss_pred:0.016251929104328156, decouple_loss:0.000785868673119694
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767436385154724, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.444804847240448, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4465240240097046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016361473128199577, decouple_loss:0.000651699781883508
loss_pred:0.017034733667969704, decouple_loss:0.0009782867273315787
loss_pred:0.016612907871603966, decouple_loss:0.0008608465432189405
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505772292613983, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45022886991500854, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44907957315444946, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016080783680081367, decouple_loss:0.0010036577004939318
loss_pred:0.017108410596847534, decouple_loss:0.0007727762567810714
loss_pred:0.01687825284898281, decouple_loss:0.0008676165016368032
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508723318576813, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45344260334968567, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4506468176841736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017444005236029625, decouple_loss:0.0010114822071045637
loss_pred:0.016949838027358055, decouple_loss:0.0009009954519569874
loss_pred:0.016822608187794685, decouple_loss:0.0010055340826511383
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44351866841316223, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4432409107685089, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44504669308662415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016173072159290314, decouple_loss:0.0009656735928729177
loss_pred:0.01681508868932724, decouple_loss:0.001030295854434371
loss_pred:0.016491921618580818, decouple_loss:0.000984450802206993
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471919536590576, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44562509655952454, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01613442599773407, decouple_loss:0.0008453354239463806
The modified gen p mean: 0.4446083903312683, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01533929817378521, decouple_loss:0.0007029434200376272
loss_pred:0.016792766749858856, decouple_loss:0.00084113230695948
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45190393924713135, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4516755938529968, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4512897729873657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016754865646362305, decouple_loss:0.0010120011866092682
loss_pred:0.017324456945061684, decouple_loss:0.0010722455335780978
loss_pred:0.016208123415708542, decouple_loss:0.001037267385981977
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448403537273407, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016931980848312378, decouple_loss:0.0008259329479187727
The modified gen p mean: 0.4470575749874115, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4482511281967163, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016680415719747543, decouple_loss:0.0009130993857979774
loss_pred:0.017207425087690353, decouple_loss:0.0008562025614082813
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468596577644348, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44635868072509766, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017422806471586227, decouple_loss:0.0007820439641363919
loss_pred:0.016780728474259377, decouple_loss:0.0008526717429049313
The modified gen p mean: 0.4446621537208557, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017219698056578636, decouple_loss:0.0010336304549127817
2023-05-26 22:57:15 testing...
The modified gen p mean: 0.44595032930374146, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4467354118824005, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018373578786849976, decouple_loss:0.0006171675631776452
The modified gen p mean: 0.4470905661582947, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018378036096692085, decouple_loss:0.0009035037946887314
loss_pred:0.01863471418619156, decouple_loss:0.0006282581598497927
WV_2_PC_0_EH_0_PS_40, loss: 0.018497927114367485, avg_mse: 0.025441929697990417
Best test mse: 0.025, current test mse: 0.025442000478506088
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844934344291687, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44433003664016724, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016782348975539207, decouple_loss:0.0006312880432233214
loss_pred:0.01642228290438652, decouple_loss:0.0007677771500311792
The modified gen p mean: 0.44683167338371277, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016412118449807167, decouple_loss:0.0005592088564299047
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500032067298889, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44918587803840637, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4483003616333008, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01662898249924183, decouple_loss:0.0007495301542803645
loss_pred:0.016488678753376007, decouple_loss:0.0008533141808584332
loss_pred:0.017312899231910706, decouple_loss:0.0007620134274475276
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035892724990845, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478173553943634, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.449678897857666, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01616899110376835, decouple_loss:0.0005980068817734718
loss_pred:0.016828620806336403, decouple_loss:0.0007743375608697534
loss_pred:0.016265196725726128, decouple_loss:0.0005872167530469596
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44501668214797974, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4452163875102997, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016880135983228683, decouple_loss:0.0008140740101225674
loss_pred:0.018106548115611076, decouple_loss:0.0007141982205212116
The modified gen p mean: 0.44636452198028564, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016445284709334373, decouple_loss:0.0008052408811636269
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453478157520294, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44383081793785095, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4439755082130432, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01693633385002613, decouple_loss:0.0008416180498898029
loss_pred:0.01714131236076355, decouple_loss:0.0007170069147832692
loss_pred:0.016394248232245445, decouple_loss:0.0008229914237745106
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481137692928314, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44939497113227844, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.450006902217865, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01682492159307003, decouple_loss:0.0006948859663680196
loss_pred:0.01670258678495884, decouple_loss:0.0008154632523655891
loss_pred:0.01663413643836975, decouple_loss:0.0007473747828043997
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106664299964905, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4506082832813263, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4494869112968445, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01609005033969879, decouple_loss:0.0006804821314290166
loss_pred:0.016323283314704895, decouple_loss:0.0007755275582894683
loss_pred:0.01682889461517334, decouple_loss:0.0007073380402289331
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460214376449585, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466525912284851, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44581103324890137, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016731876879930496, decouple_loss:0.0011079374235123396
loss_pred:0.016719043254852295, decouple_loss:0.0008626603521406651
loss_pred:0.017358679324388504, decouple_loss:0.0009732601465657353
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445995956659317, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4447917938232422, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44557255506515503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016952726989984512, decouple_loss:0.0008548148907721043
loss_pred:0.01641744375228882, decouple_loss:0.0008357251645065844
loss_pred:0.016939891502261162, decouple_loss:0.0008227390353567898
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743993878364563, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4496363401412964, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4498710632324219, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016646210104227066, decouple_loss:0.0008276997250504792
loss_pred:0.015938738361001015, decouple_loss:0.0007970022270455956
loss_pred:0.01756567321717739, decouple_loss:0.0005479359533637762
2023-05-26 22:59:36 testing...
The modified gen p mean: 0.44670000672340393, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44767916202545166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018426936119794846, decouple_loss:0.0006046589114703238
loss_pred:0.018420785665512085, decouple_loss:0.0008346122922375798
The modified gen p mean: 0.44738849997520447, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018680771812796593, decouple_loss:0.0009536634897813201
WV_2_PC_0_EH_0_PS_40, loss: 0.01854938082396984, avg_mse: 0.025556543841958046
Best test mse: 0.025, current test mse: 0.025557000190019608
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448955237865448, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4482053816318512, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4477890431880951, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01687444932758808, decouple_loss:0.0009031813242472708
loss_pred:0.016535945236682892, decouple_loss:0.000890156370587647
loss_pred:0.016669010743498802, decouple_loss:0.0009438306442461908
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44393298029899597, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4447956681251526, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016934840008616447, decouple_loss:0.0007890239940024912
loss_pred:0.016842864453792572, decouple_loss:0.0008641081512905657
The modified gen p mean: 0.44443461298942566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016911251470446587, decouple_loss:0.0007957833586260676
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461289346218109, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44685521721839905, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44753333926200867, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01698620617389679, decouple_loss:0.0007057652692310512
loss_pred:0.01655876822769642, decouple_loss:0.0008247129735536873
loss_pred:0.016808761283755302, decouple_loss:0.0005982713191770017
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500797688961029, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44895800948143005, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44931426644325256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01632695458829403, decouple_loss:0.0006774020148441195
loss_pred:0.016632119193673134, decouple_loss:0.0007141875685192645
loss_pred:0.016849899664521217, decouple_loss:0.0006545558571815491
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507184326648712, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45106709003448486, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45102640986442566, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016672460362315178, decouple_loss:0.0008935005171224475
loss_pred:0.016268150880932808, decouple_loss:0.000762138282880187
loss_pred:0.016350403428077698, decouple_loss:0.0009845404420047998
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44415223598480225, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4427025318145752, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44250819087028503, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01571429893374443, decouple_loss:0.0006682677776552737
loss_pred:0.017334839329123497, decouple_loss:0.00070951011730358
loss_pred:0.016676533967256546, decouple_loss:0.0006169362459331751
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452393054962158, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44399869441986084, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017050260677933693, decouple_loss:0.0006365568842738867
The modified gen p mean: 0.44237184524536133, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016845738515257835, decouple_loss:0.0006711085443384945
loss_pred:0.017111705616116524, decouple_loss:0.0007964071701280773
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502370059490204, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4481240212917328, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4482170045375824, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017197011038661003, decouple_loss:0.000581953558139503
loss_pred:0.016566453501582146, decouple_loss:0.0006562733324244618
loss_pred:0.016573306173086166, decouple_loss:0.0007598003721795976
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480668008327484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01751624420285225, decouple_loss:0.0008820510120131075
The modified gen p mean: 0.4492684602737427, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4509340524673462, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01724364422261715, decouple_loss:0.0007285646861419082
loss_pred:0.01770198345184326, decouple_loss:0.0008326946408487856
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495348334312439, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4501710832118988, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4492410123348236, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01733967289328575, decouple_loss:0.0005937449168413877
loss_pred:0.01700761541724205, decouple_loss:0.0005900157266296446
loss_pred:0.017987821251153946, decouple_loss:0.0007516389596275985
2023-05-26 23:02:47 testing...
The modified gen p mean: 0.44723987579345703, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44816720485687256, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018341554328799248, decouple_loss:0.0006675036856904626
The modified gen p mean: 0.4480818510055542, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018300965428352356, decouple_loss:0.0008505097357556224
loss_pred:0.01860661245882511, decouple_loss:0.000719113857485354
WV_2_PC_0_EH_0_PS_40, loss: 0.01845366321504116, avg_mse: 0.025379879400134087
Best test mse: 0.025, current test mse: 0.025380000472068787
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447478711605072, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478439390659332, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4466237425804138, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01703345589339733, decouple_loss:0.0009384597069583833
loss_pred:0.017122693359851837, decouple_loss:0.0007237843237817287
loss_pred:0.017350392416119576, decouple_loss:0.0007393644191324711
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028287172317505, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44811543822288513, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017056744545698166, decouple_loss:0.0007716866675764322
loss_pred:0.016733409836888313, decouple_loss:0.0009809482144191861
The modified gen p mean: 0.4503536820411682, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016668252646923065, decouple_loss:0.0006730412133038044
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858574867248535, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4520149827003479, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44873112440109253, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017485737800598145, decouple_loss:0.0007711776997894049
loss_pred:0.016582461073994637, decouple_loss:0.0010034898295998573
loss_pred:0.016842268407344818, decouple_loss:0.0009658774361014366
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944602251052856, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44893118739128113, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44931548833847046, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017792819067835808, decouple_loss:0.0006142541533336043
loss_pred:0.017127808183431625, decouple_loss:0.0007116716587916017
loss_pred:0.016592275351285934, decouple_loss:0.000861553882714361
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622358679771423, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44592633843421936, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44754910469055176, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01724449172616005, decouple_loss:0.0006724241538904607
loss_pred:0.01711972989141941, decouple_loss:0.0008077927050180733
loss_pred:0.016549065709114075, decouple_loss:0.0009431469370611012
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749200344085693, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44827985763549805, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4462684094905853, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017577849328517914, decouple_loss:0.000795661355368793
loss_pred:0.017134713008999825, decouple_loss:0.0006671141600236297
loss_pred:0.017031017690896988, decouple_loss:0.0007070080609992146
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505748152732849, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44851985573768616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017161253839731216, decouple_loss:0.0008273433777503669
loss_pred:0.017325708642601967, decouple_loss:0.0006688091671094298
The modified gen p mean: 0.44883882999420166, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017364501953125, decouple_loss:0.0006446141633205116
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508552551269531, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4529877305030823, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45440152287483215, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016632329672574997, decouple_loss:0.0008599331486038864
loss_pred:0.017716828733682632, decouple_loss:0.0007211457705125213
loss_pred:0.016603047028183937, decouple_loss:0.0009210433345288038
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793227314949036, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4517498016357422, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4494413733482361, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01735554449260235, decouple_loss:0.0007681299466639757
loss_pred:0.01711238920688629, decouple_loss:0.0006745451828464866
loss_pred:0.01708955131471157, decouple_loss:0.0008713738061487675
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481915831565857, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4462367296218872, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4472602307796478, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016669806092977524, decouple_loss:0.000708762847352773
loss_pred:0.016945738345384598, decouple_loss:0.0006873092497698963
loss_pred:0.017203480005264282, decouple_loss:0.0008469803142361343
2023-05-26 23:05:08 testing...
The modified gen p mean: 0.4457269608974457, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4464285373687744, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01845076121389866, decouple_loss:0.0006141436751931906
loss_pred:0.01833271235227585, decouple_loss:0.0006204958190210164
The modified gen p mean: 0.446696013212204, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018628673627972603, decouple_loss:0.000760488270316273
WV_2_PC_0_EH_0_PS_40, loss: 0.01850396953523159, avg_mse: 0.02548004500567913
Best test mse: 0.025, current test mse: 0.02548000030219555
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658082723617554, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4459284842014313, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44512510299682617, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0168099794536829, decouple_loss:0.0008070612675510347
loss_pred:0.017026958987116814, decouple_loss:0.0008646200294606388
loss_pred:0.016927272081375122, decouple_loss:0.0008422297541983426
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45273634791374207, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4535787105560303, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4507656991481781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01714254543185234, decouple_loss:0.001238422584719956
loss_pred:0.017321091145277023, decouple_loss:0.0011295737931504846
loss_pred:0.017619149759411812, decouple_loss:0.0010094867320731282
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878607988357544, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44749587774276733, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44865354895591736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017683174461126328, decouple_loss:0.0007607075967825949
loss_pred:0.017536651343107224, decouple_loss:0.0009054101537913084
loss_pred:0.01649441011250019, decouple_loss:0.0008916423539631069
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4430762231349945, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4443335235118866, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4436452388763428, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01780291274189949, decouple_loss:0.0010167252039536834
loss_pred:0.017571281641721725, decouple_loss:0.0010339056607335806
loss_pred:0.01686113514006138, decouple_loss:0.0007589462329633534
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672060012817383, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4479854702949524, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44816678762435913, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017492545768618584, decouple_loss:0.0009383071446791291
loss_pred:0.017474977299571037, decouple_loss:0.0007711669895797968
loss_pred:0.017314596101641655, decouple_loss:0.0007380304741673172
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118507742881775, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45086684823036194, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4497566819190979, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017143504694104195, decouple_loss:0.0008227813523262739
loss_pred:0.016476444900035858, decouple_loss:0.000749015249311924
loss_pred:0.01750093512237072, decouple_loss:0.0007203003042377532
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518013894557953, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45218709111213684, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4522363543510437, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01707158051431179, decouple_loss:0.0007541037630289793
loss_pred:0.017266569659113884, decouple_loss:0.0006482189055532217
loss_pred:0.017283588647842407, decouple_loss:0.0008339956402778625
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479787349700928, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4467408061027527, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4468745291233063, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016843831166625023, decouple_loss:0.0006459182477556169
loss_pred:0.016806792467832565, decouple_loss:0.0006156482850201428
loss_pred:0.01689651794731617, decouple_loss:0.0006067664944566786
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731083512306213, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016770223155617714, decouple_loss:0.0006903669564053416
The modified gen p mean: 0.4476664066314697, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44749003648757935, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016316154971718788, decouple_loss:0.000779495167080313
loss_pred:0.01709652692079544, decouple_loss:0.0006987557862885296
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45066210627555847, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45019111037254333, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44699379801750183, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016963768750429153, decouple_loss:0.0005623447359539568
loss_pred:0.016714150086045265, decouple_loss:0.0006730938330292702
loss_pred:0.016505280509591103, decouple_loss:0.0006878513959236443
2023-05-26 23:08:11 testing...
The modified gen p mean: 0.4455857276916504, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4463598132133484, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0184316523373127, decouple_loss:0.0006364724249579012
loss_pred:0.018342815339565277, decouple_loss:0.0006624030647799373
The modified gen p mean: 0.446828693151474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018658945336937904, decouple_loss:0.0007171048782765865
WV_2_PC_0_EH_0_PS_40, loss: 0.01851140521466732, avg_mse: 0.025501279160380363
Best test mse: 0.025, current test mse: 0.02550099976360798
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768470525741577, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4469691216945648, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4459340572357178, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016479389742016792, decouple_loss:0.0007225656881928444
loss_pred:0.01689295284450054, decouple_loss:0.0006820723647251725
loss_pred:0.016850575804710388, decouple_loss:0.0006270307931117713
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936999678611755, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44990256428718567, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44775038957595825, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01696348935365677, decouple_loss:0.0006073197000660002
loss_pred:0.016632143408060074, decouple_loss:0.0006207396509125829
loss_pred:0.016930080950260162, decouple_loss:0.0005670068203471601
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466240704059601, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.447827011346817, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01705079711973667, decouple_loss:0.0007126698619686067
loss_pred:0.01741376705467701, decouple_loss:0.0005301318597048521
The modified gen p mean: 0.44780585169792175, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016567567363381386, decouple_loss:0.000582908745855093
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479537904262543, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4457740783691406, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44722312688827515, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016883766278624535, decouple_loss:0.000608714937698096
loss_pred:0.01627568155527115, decouple_loss:0.0006017825216986239
loss_pred:0.016597414389252663, decouple_loss:0.0006464820471592247
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479518532752991, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.448609322309494, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4475310444831848, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01675521582365036, decouple_loss:0.0006062687607482076
loss_pred:0.01603611186146736, decouple_loss:0.0006690638838335872
loss_pred:0.016539927572011948, decouple_loss:0.0006085931090638041
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531944990158081, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4505671560764313, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016757037490606308, decouple_loss:0.00048138914280571043
loss_pred:0.017146995291113853, decouple_loss:0.0006162724457681179
The modified gen p mean: 0.4518510401248932, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01695084758102894, decouple_loss:0.0005373783642426133
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479520618915558, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44710156321525574, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016902102157473564, decouple_loss:0.0006955353892408311
loss_pred:0.016588587313890457, decouple_loss:0.0007041165954433382
The modified gen p mean: 0.44950708746910095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01635081134736538, decouple_loss:0.0005827925633639097
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44350966811180115, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44414058327674866, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01667378470301628, decouple_loss:0.0006158550386317074
loss_pred:0.01667504757642746, decouple_loss:0.000609323033131659
The modified gen p mean: 0.4451954662799835, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01693587191402912, decouple_loss:0.0006209927378222346
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467274248600006, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4464375078678131, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4459364414215088, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01664125919342041, decouple_loss:0.0005588192725554109
loss_pred:0.016745969653129578, decouple_loss:0.0005489286850206554
loss_pred:0.016645975410938263, decouple_loss:0.0006509569357149303
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45265236496925354, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4504011571407318, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4520379900932312, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01699177734553814, decouple_loss:0.0006102569750510156
loss_pred:0.01699732430279255, decouple_loss:0.000675613060593605
loss_pred:0.017043985426425934, decouple_loss:0.0006512917461805046
2023-05-26 23:10:33 testing...
The modified gen p mean: 0.4505457878112793, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01844390109181404, decouple_loss:0.0008408739231526852
The modified gen p mean: 0.45114800333976746, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4518182575702667, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01837947592139244, decouple_loss:0.001002162229269743
loss_pred:0.01866685040295124, decouple_loss:0.0007026960956864059
WV_2_PC_0_EH_0_PS_40, loss: 0.018539171665906906, avg_mse: 0.025547455996274948
Best test mse: 0.025, current test mse: 0.025546999648213387
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45238789916038513, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45181673765182495, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45336416363716125, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016556207090616226, decouple_loss:0.0009156666346825659
loss_pred:0.0172873567789793, decouple_loss:0.0007679566624574363
loss_pred:0.01664942316710949, decouple_loss:0.0007635285146534443
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4427359998226166, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4443247318267822, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4444330930709839, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016645977273583412, decouple_loss:0.0007958855712786317
loss_pred:0.017038404941558838, decouple_loss:0.0007176627404987812
loss_pred:0.01622169464826584, decouple_loss:0.0007469863630831242
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466293454170227, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4464668035507202, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44656237959861755, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016700273379683495, decouple_loss:0.000718930212315172
loss_pred:0.016559921205043793, decouple_loss:0.000715801608748734
loss_pred:0.016560066491365433, decouple_loss:0.0006214543245732784
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499046206474304, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4493045508861542, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4509289860725403, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01634642295539379, decouple_loss:0.0006555787986144423
loss_pred:0.01704544387757778, decouple_loss:0.000813852995634079
loss_pred:0.017005763947963715, decouple_loss:0.0006839887937530875
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102444291114807, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45171403884887695, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45224812626838684, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016848841682076454, decouple_loss:0.000593193166423589
loss_pred:0.01680857501924038, decouple_loss:0.0005669081583619118
loss_pred:0.016778146848082542, decouple_loss:0.0007701354334130883
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469640851020813, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4483475387096405, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471893608570099, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01699482835829258, decouple_loss:0.000554804049897939
loss_pred:0.016937997192144394, decouple_loss:0.0006830671336501837
loss_pred:0.016557728871703148, decouple_loss:0.0007681557326577604
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745510816574097, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.444778710603714, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44705694913864136, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016715018078684807, decouple_loss:0.0006846628384664655
loss_pred:0.016766032204031944, decouple_loss:0.0005363428499549627
loss_pred:0.016870437189936638, decouple_loss:0.0006200065254233778
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462457597255707, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44716185331344604, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471133053302765, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017000019550323486, decouple_loss:0.0005901018739677966
loss_pred:0.01681351102888584, decouple_loss:0.0005943530704826117
loss_pred:0.017002984881401062, decouple_loss:0.000568083138205111
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
NaN value num: 0
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45287710428237915, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01624097116291523, decouple_loss:0.0009190880809910595
The modified gen p mean: 0.45197319984436035, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4518374502658844, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01711338385939598, decouple_loss:0.0008919932879507542
loss_pred:0.01694144681096077, decouple_loss:0.0007655859808437526
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45290347933769226, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.450248658657074, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45363062620162964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01642889343202114, decouple_loss:0.0008429642184637487
loss_pred:0.016206488013267517, decouple_loss:0.000714671507012099
loss_pred:0.01650749333202839, decouple_loss:0.0009666256955824792
2023-05-26 23:13:34 testing...
The modified gen p mean: 0.44446468353271484, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.444933146238327, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01851326785981655, decouple_loss:0.001300431089475751
loss_pred:0.018484441563487053, decouple_loss:0.0014003454707562923
The modified gen p mean: 0.44538256525993347, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018756888806819916, decouple_loss:0.001239377656020224
WV_2_PC_0_EH_0_PS_40, loss: 0.018650535494089127, avg_mse: 0.02570401318371296
Best test mse: 0.025, current test mse: 0.025704000145196915
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44941645860671997, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4499497711658478, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4469836950302124, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01624254696071148, decouple_loss:0.0010367027716711164
loss_pred:0.016271190717816353, decouple_loss:0.0006888306234031916
loss_pred:0.016267430037260056, decouple_loss:0.001101595931686461
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45649102330207825, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4527266025543213, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45522385835647583, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016332337632775307, decouple_loss:0.0006201366195455194
loss_pred:0.01653573103249073, decouple_loss:0.000823270354885608
loss_pred:0.016525767743587494, decouple_loss:0.0006616138271056116
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4544571042060852, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4538423717021942, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4538201093673706, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015952827408909798, decouple_loss:0.0005756617174483836
loss_pred:0.0162242092192173, decouple_loss:0.0006374406511895359
loss_pred:0.016224076971411705, decouple_loss:0.0010192658519372344
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44456160068511963, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44843196868896484, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.446681946516037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0165751613676548, decouple_loss:0.0005448220763355494
loss_pred:0.01553669385612011, decouple_loss:0.0008549871272407472
loss_pred:0.01686105690896511, decouple_loss:0.0006130156689323485
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449903279542923, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4505351185798645, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.451229989528656, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016606997698545456, decouple_loss:0.000688001629896462
loss_pred:0.016509518027305603, decouple_loss:0.0007078523049131036
loss_pred:0.016308706253767014, decouple_loss:0.0008106351015157998
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45832276344299316, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45752274990081787, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4552152454853058, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016090283170342445, decouple_loss:0.0006716508069075644
loss_pred:0.016095086932182312, decouple_loss:0.0008188163046725094
loss_pred:0.016056189313530922, decouple_loss:0.0009420017595402896
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525076448917389, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4548778831958771, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45129504799842834, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016572289168834686, decouple_loss:0.0008150135981850326
loss_pred:0.016296477988362312, decouple_loss:0.0006191743887029588
loss_pred:0.015626700595021248, decouple_loss:0.0008621212327852845
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448967307806015, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4489421844482422, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44879934191703796, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01601250283420086, decouple_loss:0.0008361412328667939
loss_pred:0.01581946387887001, decouple_loss:0.0006877999985590577
loss_pred:0.016212372109293938, decouple_loss:0.0006632874719798565
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45216280221939087, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44839659333229065, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4511122405529022, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016241231933236122, decouple_loss:0.0006463445606641471
loss_pred:0.01625349000096321, decouple_loss:0.0006096206489019096
loss_pred:0.016411004588007927, decouple_loss:0.0006110735121183097
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527583420276642, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4552205502986908, gen p mean: 0.0, mean p set: 0.448

loss_pred:0.01621740497648716, decouple_loss:0.0007071501458995044
The modified gen p mean: 0.450332373380661, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01635015942156315, decouple_loss:0.0006420448771677911
loss_pred:0.015998315066099167, decouple_loss:0.0008170291548594832
2023-05-26 23:15:56 testing...
The modified gen p mean: 0.44751179218292236, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.448537677526474, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018668795004487038, decouple_loss:0.00138240831438452
The modified gen p mean: 0.44789624214172363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01851155236363411, decouple_loss:0.00128756498452276
loss_pred:0.018892163410782814, decouple_loss:0.001385800656862557
WV_2_PC_0_EH_0_PS_40, loss: 0.018758434802293777, avg_mse: 0.025908948853611946
Best test mse: 0.025, current test mse: 0.025908999145030975
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45391592383384705, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4530535042285919, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015721255913376808, decouple_loss:0.0007507725385949016
loss_pred:0.01590781845152378, decouple_loss:0.0005282933707349002
The modified gen p mean: 0.4507554769515991, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01576128974556923, decouple_loss:0.0006960648461245
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494781494140625, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4534982144832611, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4534881114959717, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016422944143414497, decouple_loss:0.0006208253325894475
loss_pred:0.016319820657372475, decouple_loss:0.0007476718164980412
loss_pred:0.016441168263554573, decouple_loss:0.0006934106932021677
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508936405181885, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4521484076976776, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4512917399406433, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016161562874913216, decouple_loss:0.0006165559170767665
loss_pred:0.016644608229398727, decouple_loss:0.0006543989293277264
loss_pred:0.01569332927465439, decouple_loss:0.0006821851129643619
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45429402589797974, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4513958692550659, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45169204473495483, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016162751242518425, decouple_loss:0.0007195306243374944
loss_pred:0.016263114288449287, decouple_loss:0.0007464492227882147
loss_pred:0.01565549150109291, decouple_loss:0.0007700545829720795
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497328996658325, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4511219561100006, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4477537274360657, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016102300956845284, decouple_loss:0.0005381489754654467
loss_pred:0.016030292958021164, decouple_loss:0.0006232783780433238
loss_pred:0.01638874039053917, decouple_loss:0.0007950844010338187
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45188212394714355, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45230457186698914, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4532913267612457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015794051811099052, decouple_loss:0.0006630026618950069
loss_pred:0.01611650548875332, decouple_loss:0.0005544686573557556
loss_pred:0.01593267172574997, decouple_loss:0.0009231476578861475
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543231725692749, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4533851444721222, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45455363392829895, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015757355839014053, decouple_loss:0.000672816822770983
loss_pred:0.01612948812544346, decouple_loss:0.0007824276108294725
loss_pred:0.016477910801768303, decouple_loss:0.0006651654839515686
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45190954208374023, gen p mean: 0.0, mean p set: 0.448The modified gen p mean: 0.4520171880722046, gen p mean: 0.0, mean p set: 0.448

loss_pred:0.015994850546121597, decouple_loss:0.0006312825134955347
loss_pred:0.015639029443264008, decouple_loss:0.0007725652540102601
The modified gen p mean: 0.4496813714504242, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016723325476050377, decouple_loss:0.0008327634423039854
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041242241859436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017404969781637192, decouple_loss:0.0009866476757451892
The modified gen p mean: 0.44802868366241455, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4477139413356781, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017184490337967873, decouple_loss:0.001316773472353816
loss_pred:0.016463950276374817, decouple_loss:0.0009403174044564366
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44501233100891113, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4447892904281616, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016963612288236618, decouple_loss:0.001025630277581513
loss_pred:0.01676691137254238, decouple_loss:0.0010203964775428176
The modified gen p mean: 0.44707387685775757, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017065512016415596, decouple_loss:0.000812622660305351
2023-05-26 23:19:07 testing...
The modified gen p mean: 0.4464171230792999, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01851825974881649, decouple_loss:0.0007119437213987112
The modified gen p mean: 0.4471813440322876, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4472237229347229, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01838584430515766, decouple_loss:0.0008128597401082516
loss_pred:0.018735121935606003, decouple_loss:0.0008806735277175903
WV_2_PC_0_EH_0_PS_40, loss: 0.018586501479148865, avg_mse: 0.0256346482783556
Best test mse: 0.025, current test mse: 0.025635000318288803
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447189062833786, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4468809962272644, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44718775153160095, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01689532957971096, decouple_loss:0.0009903021855279803
loss_pred:0.01693740114569664, decouple_loss:0.0012007576879113913
loss_pred:0.01650620438158512, decouple_loss:0.0008539180853404105
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45029518008232117, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44939273595809937, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01679849997162819, decouple_loss:0.0010110328439623117
loss_pred:0.016289284452795982, decouple_loss:0.0011740508489310741
The modified gen p mean: 0.4505341947078705, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016978787258267403, decouple_loss:0.0010435468284413218
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463178515434265, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4467049241065979, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478457570075989, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017389332875609398, decouple_loss:0.0012329374440014362
loss_pred:0.016555028036236763, decouple_loss:0.0006687667919322848
loss_pred:0.017291055992245674, decouple_loss:0.0014082526322454214
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4437651038169861, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4415629208087921, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4452120363712311, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016627296805381775, decouple_loss:0.0014759727055206895
loss_pred:0.01673666574060917, decouple_loss:0.0010588039876893163
loss_pred:0.016459902748465538, decouple_loss:0.0008653494878672063
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470829665660858, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4496288299560547, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44642847776412964, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01694546826183796, decouple_loss:0.001060117268934846
loss_pred:0.017527248710393906, decouple_loss:0.0010662558488547802
loss_pred:0.01677856780588627, decouple_loss:0.0010426270309835672
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518911838531494, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44917726516723633, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01640700362622738, decouple_loss:0.0012029448989778757
loss_pred:0.016735868528485298, decouple_loss:0.0007171966135501862
The modified gen p mean: 0.4505811929702759, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01694212295114994, decouple_loss:0.0010416064178571105
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749435782432556, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4473017752170563, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4491449296474457, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016902882605791092, decouple_loss:0.0009587655076757073
loss_pred:0.01683114282786846, decouple_loss:0.0009836760582402349
loss_pred:0.017387010157108307, decouple_loss:0.0010871208505705
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44618096947669983, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4460564851760864, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44545483589172363, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016967125236988068, decouple_loss:0.000841208326164633
loss_pred:0.017350533977150917, decouple_loss:0.0009068521321751177
loss_pred:0.016902556642889977, decouple_loss:0.0007798871374689043
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44394922256469727, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4441317021846771, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4443230926990509, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016889875754714012, decouple_loss:0.0011645709164440632
loss_pred:0.01657574623823166, decouple_loss:0.0009292445611208677
loss_pred:0.016785604879260063, decouple_loss:0.00112772302236408
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475654363632202, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4485352635383606, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.447112500667572, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017247699201107025, decouple_loss:0.0010895212180912495
loss_pred:0.016744593158364296, decouple_loss:0.0010707208421081305
loss_pred:0.016912642866373062, decouple_loss:0.0006888346979394555
2023-05-26 23:21:28 testing...
The modified gen p mean: 0.4492339789867401, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4495382606983185, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01845579221844673, decouple_loss:0.0009157094755209982
The modified gen p mean: 0.45034414529800415, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018343620002269745, decouple_loss:0.0009589814580976963
loss_pred:0.018681179732084274, decouple_loss:0.0008781415526755154
WV_2_PC_0_EH_0_PS_40, loss: 0.018539411947131157, avg_mse: 0.025528306141495705
Best test mse: 0.025, current test mse: 0.02552800066769123
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987279176712036, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.451094388961792, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4484435021877289, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016756290569901466, decouple_loss:0.0011810421710833907
loss_pred:0.016182949766516685, decouple_loss:0.0007074737222865224
loss_pred:0.016964323818683624, decouple_loss:0.0009971881518140435
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462464153766632, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4464775621891022, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44606056809425354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016718244180083275, decouple_loss:0.0008339636842720211
loss_pred:0.016439655795693398, decouple_loss:0.0007454784354194999
loss_pred:0.01644698530435562, decouple_loss:0.0010468376567587256
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463680386543274, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44797593355178833, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44764161109924316, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016760345548391342, decouple_loss:0.0006768939201720059
loss_pred:0.01692122220993042, decouple_loss:0.001182402134872973
loss_pred:0.016725637018680573, decouple_loss:0.0008531080675311387
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494802951812744, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44628530740737915, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4468243718147278, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017221979796886444, decouple_loss:0.0007426123484037817
loss_pred:0.016888268291950226, decouple_loss:0.0006270330050028861
loss_pred:0.01619124226272106, decouple_loss:0.0006458457210101187
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736596941947937, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4478476941585541, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4472615420818329, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016406407579779625, decouple_loss:0.0013304275926202536
loss_pred:0.01658611372113228, decouple_loss:0.0009724060073494911
loss_pred:0.016544442623853683, decouple_loss:0.0010850601829588413
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903168082237244, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44854244589805603, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4485204517841339, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017440253868699074, decouple_loss:0.0012208538828417659
loss_pred:0.016916275024414062, decouple_loss:0.0009484087931923568
loss_pred:0.016572386026382446, decouple_loss:0.000954749877564609
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477359652519226, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44815120100975037, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.448024719953537, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.0166360754519701, decouple_loss:0.0007489979034289718
loss_pred:0.016240950673818588, decouple_loss:0.0009001778671517968
loss_pred:0.01691838726401329, decouple_loss:0.000763225310947746
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461515545845032, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44817668199539185, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471580386161804, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016455721110105515, decouple_loss:0.0005407630233094096
loss_pred:0.016239020973443985, decouple_loss:0.0007139696390368044
loss_pred:0.016547519713640213, decouple_loss:0.000672933820169419
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477130174636841, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017055975273251534, decouple_loss:0.001135383266955614
The modified gen p mean: 0.44805946946144104, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44506001472473145, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016697432845830917, decouple_loss:0.0006694382755085826
loss_pred:0.01675926335155964, decouple_loss:0.000926533539313823
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4449847340583801, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4454159736633301, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44715747237205505, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016427654772996902, decouple_loss:0.0008939777035266161
loss_pred:0.015304096974432468, decouple_loss:0.0008100341656245291
loss_pred:0.016321688890457153, decouple_loss:0.0008156589465215802
2023-05-26 23:24:33 testing...
The modified gen p mean: 0.4489719271659851, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4500342011451721, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018509462475776672, decouple_loss:0.000850351934786886
loss_pred:0.018443971872329712, decouple_loss:0.000932142895180732
The modified gen p mean: 0.449355810880661, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01872517354786396, decouple_loss:0.0009136953158304095
WV_2_PC_0_EH_0_PS_40, loss: 0.018604472279548645, avg_mse: 0.025668548420071602
Best test mse: 0.025, current test mse: 0.025668999180197716
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45229271054267883, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4481888711452484, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4477553069591522, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01602955535054207, decouple_loss:0.0006170875276438892
loss_pred:0.01613902859389782, decouple_loss:0.000684276339598
loss_pred:0.017054162919521332, decouple_loss:0.0007142201066017151
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759202003479004, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44908541440963745, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44984832406044006, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01626819185912609, decouple_loss:0.0006479172734543681
loss_pred:0.016286056488752365, decouple_loss:0.0006614807643927634
loss_pred:0.01720156893134117, decouple_loss:0.0006201717187650502
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736677408218384, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4475804567337036, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44703909754753113, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01692076586186886, decouple_loss:0.0007552894530817866
loss_pred:0.016370495781302452, decouple_loss:0.0006221981020644307
loss_pred:0.015737395733594894, decouple_loss:0.0007376907742582262
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495449662208557, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471006691455841, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4481028616428375, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016391968354582787, decouple_loss:0.0008039444219321012
loss_pred:0.01639547571539879, decouple_loss:0.0007233600481413305
loss_pred:0.01645895652472973, decouple_loss:0.000717711343895644
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027396082878113, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44794565439224243, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44815129041671753, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01582711935043335, decouple_loss:0.0005150041542947292
loss_pred:0.015512395650148392, decouple_loss:0.000681500299833715
loss_pred:0.01567530818283558, decouple_loss:0.0005825184634886682
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806984066963196, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44618573784828186, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44582685828208923, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016706692054867744, decouple_loss:0.000851460499688983
loss_pred:0.016490962356328964, decouple_loss:0.0009023979073390365
loss_pred:0.01614999771118164, decouple_loss:0.0007123667164705694
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774380326271057, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45026010274887085, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44956061244010925, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016000788658857346, decouple_loss:0.0006304701091721654
loss_pred:0.016478167846798897, decouple_loss:0.0006463559693656862
loss_pred:0.016632091253995895, decouple_loss:0.000610193470492959
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812312722206116, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4495837986469269, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4480653703212738, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016277674585580826, decouple_loss:0.0005963335279375315
loss_pred:0.016843540593981743, decouple_loss:0.0008582569425925612
loss_pred:0.01669025979936123, decouple_loss:0.0006575839943252504
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44580739736557007, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.446010023355484, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44516193866729736, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016450881958007812, decouple_loss:0.001093281083740294
loss_pred:0.016626911237835884, decouple_loss:0.0009021669975481927
loss_pred:0.016124092042446136, decouple_loss:0.0008218167931772768
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4446704387664795, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44720739126205444, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4468477666378021, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01566757820546627, decouple_loss:0.0008938052342273295
loss_pred:0.01646309904754162, decouple_loss:0.0006873634993098676
loss_pred:0.01634361408650875, decouple_loss:0.0005677028093487024
2023-05-26 23:26:57 testing...
The modified gen p mean: 0.44804465770721436, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018486328423023224, decouple_loss:0.000950436748098582
The modified gen p mean: 0.4492822587490082, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44858527183532715, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.018347352743148804, decouple_loss:0.001031666761264205
loss_pred:0.018686462193727493, decouple_loss:0.0009275382617488503
WV_2_PC_0_EH_0_PS_40, loss: 0.018555209040641785, avg_mse: 0.02556944638490677
Best test mse: 0.025, current test mse: 0.025568999350070953
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479977786540985, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44781193137168884, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44701817631721497, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01621386408805847, decouple_loss:0.0007351983804255724
loss_pred:0.015547527000308037, decouple_loss:0.0007449683034792542
loss_pred:0.016382860019803047, decouple_loss:0.0007804299239069223
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45254015922546387, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4527885317802429, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4516465663909912, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016459250822663307, decouple_loss:0.000738960865419358
loss_pred:0.01661977730691433, decouple_loss:0.0008799279457889497
loss_pred:0.016222167760133743, decouple_loss:0.0006939353188499808
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44363194704055786, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4482879042625427, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4471549689769745, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01631392352283001, decouple_loss:0.0005869892193004489
loss_pred:0.016752902418375015, decouple_loss:0.000510600337292999
loss_pred:0.016152273863554, decouple_loss:0.0005984120070934296
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44370946288108826, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44625741243362427, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4468421936035156, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016132604330778122, decouple_loss:0.0005929935141466558
loss_pred:0.016034336760640144, decouple_loss:0.000908926478587091
loss_pred:0.01627044938504696, decouple_loss:0.0007956774206832051
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449795126914978, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.45090746879577637, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.449074387550354, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01573783904314041, decouple_loss:0.0005666141514666378
loss_pred:0.015810132026672363, decouple_loss:0.000641867343802005
loss_pred:0.016507765278220177, decouple_loss:0.0005763001972809434
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145583152770996, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4493664503097534, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01556167472153902, decouple_loss:0.0006805675802752376
loss_pred:0.016264107078313828, decouple_loss:0.0008187462808564305
The modified gen p mean: 0.45005685091018677, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015438558533787727, decouple_loss:0.000761358649469912
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474622905254364, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4464699923992157, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44583186507225037, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.016658887267112732, decouple_loss:0.0006227813428267837
loss_pred:0.01596260815858841, decouple_loss:0.0008581746369600296
loss_pred:0.015784306451678276, decouple_loss:0.0007412441191263497
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445806086063385, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44682633876800537, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.4464420974254608, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.015959519892930984, decouple_loss:0.0006469179643318057
loss_pred:0.016714811325073242, decouple_loss:0.0006145546794869006
loss_pred:0.01652548462152481, decouple_loss:0.0005934856599196792
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
NaN value num: 0
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45125940442085266, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.017948776483535767, decouple_loss:0.0013733240775763988
The modified gen p mean: 0.4512438476085663, gen p mean: 0.0, mean p set: 0.448
The modified gen p mean: 0.44999533891677856, gen p mean: 0.0, mean p set: 0.448
loss_pred:0.01815551519393921, decouple_loss:0.0014786350075155497
loss_pred:0.01806749776005745, decouple_loss:0.0012703530956059694
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
